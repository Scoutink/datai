import{L as se,i as l2,b6 as Y,bi as q,bP as le,cl as ne,fM as e0,aB as ge,gm as j2,cq as J0,j as me,e as Q,d5 as de,fk as et,da as $,f0 as Q0,cm as ce,ck as er,bv as t0,gf as yt,gd as tr,c5 as bt,g0 as U2,ea as r0,k as Ee,dZ as ee,g6 as rr,g7 as nr,aw as Et,bm as j,bo as we,b7 as It,bf as ir,fA as sr,gb as n0,bp as ar,f$ as i0,g8 as Ve,bB as fe,bq as lr,g9 as B2,dU as s0,eb as or,fO as ur,C as cr}from"./index-BI8deSNo.js";import{f6 as bs}from"./index-BI8deSNo.js";import{hm as re,K as We,gP as v2,gI as C2,cp as dr,am as hr,cA as gr,bL as mr,bI as fr,bN as vr,bu as Cr,co as pr,ch as wr,bf as xr,X as yr,Y as tt,al as Dr,aj as br,b$ as Er,p as a0,R as Ir,ab as Ut,hW as Fr,bW as ct,i4 as l0,hj as _r,z as o0,h as u0,b as c0,$ as d0,V as Sr,n as dt,m as Tr,aT as ht,cr as Rr,ee as Ft,i1 as Ar,d$ as Mr,gB as O2,a2 as Nr,hZ as kr,b8 as Ur,f3 as Vr,b0 as Lr,b3 as jr,f as h0,E as g0,i7 as m0}from"./facade-BslPbXnu.js";import{a2 as te,ay as Br,o as Vt,i as Lt,E as Or,aF as $r,b_ as f0,bh as Pr}from"./index-BBqjqAkl.js";import{b1 as v0,cw as qr,a0 as Hr,b8 as C0,aa as p0}from"./index-DnxWP_AP.js";import{b as w0}from"./bufferTime-Dc1Jgi3q.js";import{aF as Wr,ao as Zr,ba as Gr,bt as K,aj as x0,bw as zr,aa as Kr,by as Yr,bz as rt,w as Xr,ad as Jr}from"./index-BeEHzc6r.js";import{aj as p,ak as h,p as ye,Z as jt,E as Bt,S as Qr,a4 as ae,c as _t,T as Ze,u as $2,J as en,o as Ot,f as Le,Y as tn,r as rn}from"./index-BmfxE5KL.js";import{d as nn,N as nt,f as sn,v as an}from"./index-Dd27tKdG.js";import{O as ln}from"./facade-bHpds0ZF.js";import"./index-C5GuqOxb.js";import"./index-GTTB9Gpg.js";import"./takeUntil-BWepI5Pd.js";import"./index-u4QJ_A0o.js";import"./shareReplay-DR2HpNHE.js";import"./isObservable-DLg0_x3m.js";var on=Object.defineProperty,un=(t,e,r)=>e in t?on(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,G=(t,e,r)=>un(t,typeof e!="symbol"?e+"":e,r);const Ge="SHEET_CONDITIONAL_FORMATTING_PLUGIN";var B=(t=>(t.beginsWith="beginsWith",t.endsWith="endsWith",t.containsText="containsText",t.notContainsText="notContainsText",t.equal="equal",t.notEqual="notEqual",t.containsBlanks="containsBlanks",t.notContainsBlanks="notContainsBlanks",t.containsErrors="containsErrors",t.notContainsErrors="notContainsErrors",t))(B||{}),J=(t=>(t.today="today",t.yesterday="yesterday",t.tomorrow="tomorrow",t.last7Days="last7Days",t.thisMonth="thisMonth",t.lastMonth="lastMonth",t.nextMonth="nextMonth",t.thisWeek="thisWeek",t.lastWeek="lastWeek",t.nextWeek="nextWeek",t))(J||{}),_=(t=>(t.greaterThan="greaterThan",t.greaterThanOrEqual="greaterThanOrEqual",t.lessThan="lessThan",t.lessThanOrEqual="lessThanOrEqual",t.notBetween="notBetween",t.between="between",t.equal="equal",t.notEqual="notEqual",t))(_||{}),b=(t=>(t.highlightCell="highlightCell",t.dataBar="dataBar",t.colorScale="colorScale",t.iconSet="iconSet",t))(b||{}),I=(t=>(t.uniqueValues="uniqueValues",t.duplicateValues="duplicateValues",t.rank="rank",t.text="text",t.timePeriod="timePeriod",t.number="number",t.average="average",t.formula="formula",t))(I||{}),M=(t=>(t.num="num",t.min="min",t.max="max",t.percent="percent",t.percentile="percentile",t.formula="formula",t))(M||{});const cn="#fff",dn="#000000",ke=()=>({cfId:void 0,ranges:[],stopIfTrue:!1,rule:{type:"highlightCell",subType:"text",operator:"containsText"}}),P2=(t,e)=>{switch(t){case"text":{if(["beginsWith","containsText","endsWith","equal","notContainsText","notEqual"].includes(e))return"";break}case"number":return["between","notBetween"].includes(e)?[10,100]:10}return""},m2=(t,e)=>{switch(t){case"formula":return"=";case"max":case"min":return"";case"percent":case"percentile":case"num":return e!==void 0?e:10}return""},je=(t,e,r)=>{if(!e)return null;const n=e.findIndex(i=>r(i)===t.id);if(n<0)return null;switch(t.type){case"after":return n+1;case"before":return n-1;case"self":return n}},hn=(t,e,r,n)=>{if(!r)return null;const i=je(t,r,n);let s=je(e,r,n);if(i===null||s===null||i===s)return;const a=r.splice(i,1)[0];switch(i<s&&(s=je(e,r,n)),e.type){case"before":{r.splice(s+1,0,a);break}case"self":case"after":{r.splice(s,0,a);break}}},y0=(t,e,r,n)=>{if(t.type==="after"&&["after","before"].includes(e.type))return[t,e];const i={...t},s={...e};if(i.type!=="after"){const a=je(i,r,n);if(a===null)return null;if(a-1<0){const l=r[a+1];if(l)i.id=n(l),i.type="before";else return null}else{const l=n(r[a-1]);i.id=l,i.type="after"}}if(!["after","before"].includes(s.type)){const a=je(s,r,n);if(a===null)return null;if(a===0)s.type="before";else if(a-1>=0){const l=n(r[a-1]);s.id=l,s.type="after"}else if(a+1<=r.length-1){const l=n(r[a+1]);s.id=l,s.type="before"}else return null}return i.id===s.id&&i.type===s.type?null:[i,s]},gn=(t,e)=>{if(["after","before"].includes(e.type)){if(t.type==="after")return[e,t];if(t.type==="before")return[e,{...t,type:"self"}]}return null},Cs=(t,e)=>t.id===e.id&&t.type===e.type,Fe=()=>`${r0(8)}`;class P{constructor(){G(this,"_model",new Map),G(this,"_ruleChange$",new j2),G(this,"$ruleChange",this._ruleChange$.asObservable())}_ensureList(e,r){let n=this.getSubunitRules(e,r);if(!n){n=[];let i=this._model.get(e);i||(i=new Map,this._model.set(e,i)),i.set(r,n)}return n}getRule(e,r,n){const i=this.getSubunitRules(e,r);return i?i.find(s=>s.cfId===n):null}getUnitRules(e){return this._model.get(e)||null}getSubunitRules(e,r){var n;return((n=this._model.get(e))==null?void 0:n.get(r))||null}getAll(){return this._model}deleteRule(e,r,n){const i=this.getSubunitRules(e,r);if(i){const s=i.findIndex(l=>l.cfId===n),a=i[s];a&&(i.splice(s,1),this._ruleChange$.next({rule:a,subUnitId:r,unitId:e,type:"delete"}))}}setRule(e,r,n,i){const s=this._ensureList(e,r).find(a=>a.cfId===i);if(s){const a=de.deepClone(s);Object.assign(s,n),this._ruleChange$.next({rule:s,subUnitId:r,unitId:e,type:"set",oldRule:a})}}addRule(e,r,n){const i=this._ensureList(e,r);i.find(s=>s.cfId===n.cfId)||i.unshift(n),this._ruleChange$.next({rule:n,subUnitId:r,unitId:e,type:"add"})}moveRulePriority(e,r,n,i){const s=this._ensureList(e,r),a=je(n,s,o=>o.cfId),l=je(i,s,o=>o.cfId);if(l===null||a===null||l===a)return;const c=s[a];c&&(hn(n,i,s,o=>o.cfId),this._ruleChange$.next({rule:c,subUnitId:r,unitId:e,type:"sort"}))}createCfId(e,r){return Fe()}deleteUnitId(e){this._model.delete(e)}}const qe={type:se.MUTATION,id:"sheet.mutation.move-conditional-rule",handler(t,e){if(!e)return!1;const{unitId:r,subUnitId:n,start:i,end:s}=e;return t.get(P).moveRulePriority(r,n,i,s),!0}},mn=t=>{const{unitId:e,subUnitId:r}=t,n=gn(t.start,t.end);if(!n)return[];const[i,s]=n;return[{id:qe.id,params:{unitId:e,subUnitId:r,start:i,end:s}}]},_e=(t,e)=>{const r=t.get(P),{unitId:n,subUnitId:i,cfId:s}=e,a=[...r.getSubunitRules(n,i)||[]],l=a.findIndex(o=>o.cfId===s),c=a[l-1];if(l>-1){const o=a[l],u=[{id:ie.id,params:{unitId:n,subUnitId:i,rule:de.deepClone(o)}}];if(a.splice(l,1),l!==0){const d=a[0];if(d){const g=y0({id:d.cfId,type:"before"},{id:c.cfId,type:"after"},a,x=>x.cfId);if(!g)return u;const[m,f]=g,w={unitId:n,subUnitId:i,start:m,end:f};u.push({id:qe.id,params:w})}}return u}return[]},he={type:se.MUTATION,id:"sheet.mutation.delete-conditional-rule",handler(t,e){if(!e)return!1;const{unitId:r,subUnitId:n,cfId:i}=e;return t.get(P).deleteRule(r,n,i),!0}},I2=(t,e)=>({id:he.id,params:{unitId:e.unitId,subUnitId:e.subUnitId,cfId:e.rule.cfId}}),ie={type:se.MUTATION,id:"sheet.mutation.add-conditional-rule",handler(t,e){if(!e)return!1;const{unitId:r,subUnitId:n,rule:i}=e;return t.get(P).addRule(r,n,i),!0}},F2={type:se.COMMAND,id:"sheet.command.add-conditional-rule",handler(t,e){if(!e)return!1;const{rule:r}=e,n=t.get(l2),i=t.get(Y),s=t.get(P),a=t.get(q),l=re(a,e);if(!l)return!1;const{unitId:c,subUnitId:o}=l,u=s.createCfId(c,o),d={unitId:c,subUnitId:o,rule:{...r,cfId:r.cfId||u}},g=I2(t,d),m=i.syncExecuteCommand(ie.id,d);return m&&n.pushUndoRedo({unitID:c,redoMutations:[{id:ie.id,params:d}],undoMutations:[g]}),m}},pe={type:se.MUTATION,id:"sheet.mutation.set-conditional-rule",handler(t,e){if(!e)return!1;const{unitId:r,subUnitId:n,rule:i}=e,s=e.cfId||e.rule.cfId;return t.get(P).setRule(r,n,i,s),!0}},Re=(t,e)=>{const r=t.get(P),{unitId:n,subUnitId:i}=e,s=e.cfId||e.rule.cfId,a=r.getRule(n,i,s);return a?[{id:pe.id,params:{unitId:n,subUnitId:i,cfId:s,rule:de.deepClone(a)}}]:[]},St={type:se.COMMAND,id:"sheet.command.clear-range-conditional-rule",handler(t,e){var r;if(!e)return!1;const n=t.get(P),i=t.get(q),s=t.get(Y),a=t.get(l2),l=t.get(We),c=re(i,e);if(!c)return!1;const{unitId:o,subUnitId:u}=c,d=((r=l.getCurrentSelections())==null?void 0:r.map(x=>x.range))||[],g=n.getSubunitRules(o,u);if(!(g!=null&&g.length)||!d.length)return!1;const m=[],f=[];g.forEach(x=>{const y=new le;x.ranges.forEach(E=>{ne.foreach(E,(F,C)=>{y.setValue(F,C,1)})}),d.forEach(E=>{ne.foreach(E,(F,C)=>{y.realDeleteValue(F,C)})});const R=v2(C2(y));if(R.length){const E={...x,ranges:R},F={unitId:o,subUnitId:u,rule:E},C=Re(t,F);m.push({id:pe.id,params:F}),f.push(...C)}else{const E={unitId:o,subUnitId:u,cfId:x.cfId},F=_e(t,E);m.push({id:he.id,params:E}),f.push(...F)}});const w=e0(m,s).result;return w&&a.pushUndoRedo({unitID:o,redoMutations:m,undoMutations:f}),w}},it={type:se.COMMAND,id:"sheet.command.clear-worksheet-conditional-rule",handler(t,e){const r=t.get(P),n=t.get(q),i=t.get(Y),s=t.get(l2),a=re(n,e);if(!a)return!1;const{unitId:l,subUnitId:c}=a,o=r.getSubunitRules(l,c);if(!(o!=null&&o.length))return!1;const u=o.map(f=>({cfId:f.cfId,unitId:l,subUnitId:c})),d=u.map(f=>({id:he.id,params:f})),g=u.map(f=>_e(t,f)[0]),m=e0(d,i).result;return m&&s.pushUndoRedo({unitID:l,redoMutations:d,undoMutations:g}),m}},p2={type:se.COMMAND,id:"sheet.command.delete-conditional-rule",handler(t,e){if(!e)return!1;const r=t.get(l2),n=t.get(Y),i=t.get(q),s=re(i,e);if(!s)return!1;const{unitId:a,subUnitId:l}=s,c={unitId:a,subUnitId:l,cfId:e.cfId},o=_e(t,c),u=n.syncExecuteCommand(he.id,c);return u&&r.pushUndoRedo({unitID:a,undoMutations:o,redoMutations:[{id:he.id,params:c}]}),u}},st={type:se.COMMAND,id:"sheet.command.move-conditional-rule",handler(t,e){if(!e)return!1;const r=t.get(l2),n=t.get(Y),i=t.get(q),s=t.get(P),a=re(i,e);if(!a)return!1;const{unitId:l,subUnitId:c}=a,o=y0(e.start,e.end,s.getSubunitRules(l,c)||[],w=>w.cfId);if(!o)return!1;const[u,d]=o,g={unitId:l,subUnitId:c,start:u,end:d},m=mn(g),f=n.syncExecuteCommand(qe.id,g);return f&&r.pushUndoRedo({unitID:l,redoMutations:[{id:qe.id,params:g}],undoMutations:m}),f}},at={type:se.COMMAND,id:"sheet.command.set-conditional-rule",handler(t,e){if(!e)return!1;const r=t.get(l2),n=t.get(Y),i=t.get(q),s=re(i,e);if(!s)return!1;const{unitId:a,subUnitId:l}=s,c={unitId:a,subUnitId:l,rule:e.rule,cfId:e.cfId},o=Re(t,c),u=n.syncExecuteCommand(pe.id,c);return u&&r.pushUndoRedo({unitID:a,undoMutations:o,redoMutations:[{id:pe.id,params:c}]}),u}};var fn=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},$t=(t,e)=>(r,n)=>e(r,n,t);let s2=class extends ge{constructor(t,e){super(),G(this,"_formulaMap",new Map),G(this,"_result$",new j2),G(this,"result$",this._result$.asObservable()),this._registerOtherFormulaService=t,this._conditionalFormattingRuleModel=e,this._initFormulaResultChange(),this._initRuleChange()}_initRuleChange(){const t=e=>{switch(e.type){case b.colorScale:return e.config.some(r=>r.value.type===M.formula);case b.dataBar:return[e.config.max,e.config.min].some(r=>r.type===M.formula);case b.iconSet:return e.config.some(r=>r.value.type===M.formula)}};this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(e=>{const{unitId:r,subUnitId:n,rule:i,oldRule:s}=e;e.type==="delete"&&this._removeFormulaByCfId(r,n,i.cfId),e.type==="set"&&(t(i.rule)||s&&t(s.rule))&&this._removeFormulaByCfId(r,n,i.cfId),e.type==="add"&&this._registerRuleFormulas(r,n,i)}))}_registerRuleFormulas(t,e,r){switch(r.rule.type){case b.highlightCell:{if(r.rule.subType===I.formula){const n=r.rule.value;n&&this.registerFormulaWithRange(t,e,r.cfId,n,r.ranges)}break}}}_initFormulaResultChange(){this.disposeWithMe(this._registerOtherFormulaService.formulaResult$.subscribe(t=>{for(const e in t)for(const r in t[e]){const n=t[e][r];for(const i of n){const s=this._ensureSubunitFormulaMap(e,r).getValue(i.formulaId,["formulaId"]);if(!s)continue;const a=this._getAllFormulaResultByCfId(e,r,s.cfId).every(l=>{const c=this._registerOtherFormulaService.getFormulaValueSync(e,r,l.formulaId);return c?.status===te.SUCCESS});this._result$.next({...s,isAllFinished:a})}}}))}_ensureSubunitFormulaMap(t,e){let r=this._formulaMap.get(t);r||(r=new Map,this._formulaMap.set(t,r));let n=r.get(e);return n||(n=new J0([],["formulaId","id"]),r.set(e,n)),n}getSubUnitFormulaMap(t,e){var r;return(r=this._formulaMap.get(t))==null?void 0:r.get(e)}registerFormulaWithRange(t,e,r,n,i=[{startRow:0,endRow:0,startColumn:0,endColumn:0}]){const s=this._ensureSubunitFormulaMap(t,e),a=this.createCFormulaId(r,n);if(s.getValue(a,["id"]))return;const l=this._registerOtherFormulaService.registerFormulaWithRange(t,e,n,i,void 0,Br.CONDITIONAL_FORMATTING,r);s.addValue({formulaText:n,unitId:t,subUnitId:e,cfId:r,id:a,formulaId:l})}_removeFormulaByCfId(t,e,r){const n=this.deleteCache(t,e,r).map(i=>i.formulaId);this._registerOtherFormulaService.deleteFormula(t,e,n)}getFormulaResultWithCoords(t,e,r,n,i=0,s=0){var a;const l=this.getSubUnitFormulaMap(t,e);if(!l)return{status:te.NOT_REGISTER};const c=l.getValue(this.createCFormulaId(r,n),["id"]);if(!c)return{status:te.NOT_REGISTER};const o=this._registerOtherFormulaService.getFormulaValueSync(t,e,c.formulaId);if(!o)return{status:te.NOT_REGISTER};if(o.status===te.SUCCESS&&o.result){const u=(a=o.result[i])==null?void 0:a[s];return{result:this._getCellValue(u),status:te.SUCCESS}}return{status:o.status}}getFormulaMatrix(t,e,r,n){const i=this.getSubUnitFormulaMap(t,e);if(!i)return{status:te.NOT_REGISTER};const s=i.getValue(this.createCFormulaId(r,n),["id"]);if(!s)return{status:te.NOT_REGISTER};const a=this._registerOtherFormulaService.getFormulaValueSync(t,e,s.formulaId);if(!a)return{status:te.NOT_REGISTER};if(a.status===te.SUCCESS&&a.result){const l=new le;return new le(a.result).forValue((c,o,u)=>{l.setValue(c,o,this._getCellValue(u))}),{result:l,status:te.SUCCESS}}return{status:a.status}}_getCellValue(t){if(!t||!t[0]||!t[0][0])return!1;const e=t[0][0];return e?.t===me.BOOLEAN?e.v===Q.TRUE||e.v===!0:e?.v}deleteCache(t,e,r,n){const i=this.getSubUnitFormulaMap(t,e);if(!i)return[];if(n){const s=this.createCFormulaId(r,n);return i.deleteValue(s,["id"]),[]}else{const s=i.getValues().filter(a=>a.cfId===r);return s.forEach(a=>{i.deleteValue(a.formulaId,["formulaId"])}),s}}_getAllFormulaResultByCfId(t,e,r){const n=this.getSubUnitFormulaMap(t,e);return n?n.getValues().filter(i=>i.cfId===r):[]}createCFormulaId(t,e){return`${t}_${e}`}};s2=fn([$t(0,j($r)),$t(1,j(P))],s2);var Ie=(t=>(t.preComputingStart="preComputingStart",t.preComputing="preComputing",t.preComputingEnd="preComputingEnd",t.preComputingError="preComputingError",t))(Ie||{});class lt{constructor(e){G(this,"_cache"),G(this,"_preComputingStatus$",new rr("preComputingStart")),G(this,"preComputingStatus$",this._preComputingStatus$.asObservable().pipe(nr())),G(this,"_preComputingCache"),G(this,"_rule"),this._context=e,this._cache=new t0(e.limit),this._rule=e.rule,this._preComputingCache=null,this._initClearCacheListener()}setCacheLength(e){this._cache.limit=e}clearCache(){this._cache.clear()}resetPreComputingCache(){this._preComputingStatus$.next("preComputingStart"),this._preComputingCache=null}updateRule(e){this._rule=e,this.resetPreComputingCache()}getCell(e,r){const n=this._createKey(e,r);if(this._preComputingStatus$.getValue()==="preComputing")return this._cache.get(n);let i=this.getPreComputingResult(e,r);if(i===null&&(this._preComputingStatus$.next("preComputingStart"),this.preComputing(e,r,this._getContext()),i=this.getPreComputingResult(e,r),i===null))return this._cache.get(n);if(this._preComputingStatus$.next("preComputingEnd"),this._cache.has(n))return this._cache.get(n);const s=this.getCellResult(e,r,i,this._getContext());return s!==null&&this._setCache(e,r,s),s}setPreComputingCache(e){this._preComputingCache=e}getPreComputingResult(e,r){return this._preComputingCache}_createKey(e,r){return`${e}_${r}`}_setCache(e,r,n){const i=this._createKey(e,r);this._cache.set(i,n)}_getContext(){return{...this._context,rule:this._rule}}_initClearCacheListener(){this.preComputingStatus$.subscribe(e=>{e==="preComputingEnd"&&this.clearCache()})}}class vn extends lt{preComputing(e,r,n){const i=n.rule,s=n.worksheet,a=new le;!i.rule.config.every(c=>c.value.type===M.num)&&ot(i.ranges,s.getMaxRows()-1,s.getMaxColumns()-1).forEach(c=>{ne.foreach(c,(o,u)=>{const d=n.getCellValue(o,u),g=d&&d.v;if(!ue(g)&&d?.t===me.NUMBER){const m=Number(g);!Number.isNaN(m)&&a.setValue(o,u,m)}})});const l=[...i.rule.config].sort((c,o)=>c.index-o.index).map(c=>({value:H2(c.value,a,{...n,cfId:i.cfId}),color:new Ee(c.color)}));if(!l.some(c=>qr(c.value)?c.value.status!==te.SUCCESS:!1)){const c=l.map(o=>o.color).reduce((o,u,d)=>(o.result.push({color:u,value:o.sortValue[d]}),o),{result:[],sortValue:l.map(o=>o.value.result).sort((o,u)=>o-u)}).result;this.setPreComputingCache(c),this._preComputingStatus$.next(Ie.preComputingEnd);return}this._preComputingStatus$.next(Ie.preComputing)}getCellResult(e,r,n,i){if(!n)return null;const s=i.getCellValue(e,r);if(s.t===me.NUMBER){const a=Number(s.v);if(!Number.isNaN(a))return D0(n,a)}}}const Cn="sheet-conditional-rule-data-bar",Be="#ffbe38",Oe="#abd91a",pn="#000",wn=34,xn=t=>{const{startRow:e,endRow:r,startColumn:n,endColumn:i}=t;return`${e}-${r}-${n}-${i}`};class yn extends v0{constructor(){super(...arguments),G(this,"_paddingRightAndLeft",2),G(this,"_paddingTopAndBottom",2),G(this,"uKey",Cn),G(this,"Z_INDEX",wn),G(this,"_radius",1)}draw(e,r,n,i){const{worksheet:s}=n;if(!s)return!1;const a=new Set;e.save(),ne.foreach(n.rowColumnSegment,(l,c)=>{if(!s.getRowVisible(l)||!s.getColVisible(c))return;const o=n.getCellWithCoordByIndex(l,c,!1),{isMerged:u,isMergedMainCell:d,mergeInfo:g}=o;let m=s.getCell(l,c);if(u&&(m=s.getCell(g.startRow,g.startColumn)),!(m!=null&&m.dataBar)||!this.isRenderDiffRangesByCell(g,i))return;if(u||d){const k=xn(g);if(a.has(k))return;a.add(k)}const{color:f,value:w,startPoint:x,isGradient:y}=m.dataBar,{startX:R,endX:E,startY:F,endY:C}=u||d?g:o,D=E-R,S=C+Hr-F,A=D-this._paddingRightAndLeft*2,U=S-this._paddingTopAndBottom*2;if(w>0){const k=Math.max(A*(1-x/100)*w/100,1),V=R+this._paddingRightAndLeft+x/100*A,L=F+this._paddingTopAndBottom;if(y){const v=e.createLinearGradient(V,L,V+k,L);v.addColorStop(0,f),v.addColorStop(1,"rgb(255 255 255)"),e.fillStyle=v,e.strokeStyle=f,e.lineWidth=1}else e.fillStyle=f;this._drawRectWithRoundedCorner(e,V,L,k,U,!1,!0,!0,!1),y&&e.stroke()}else{const k=Math.max(A*x/100*Math.abs(w)/100,1),V=R+this._paddingRightAndLeft+x/100*A-k,L=F+this._paddingTopAndBottom;if(y){const v=e.createLinearGradient(V,L,V+k,L);v.addColorStop(0,"rgb(255 255 255)"),v.addColorStop(1,f),e.fillStyle=v,e.strokeStyle=f,e.lineWidth=1}else e.fillStyle=f;this._drawRectWithRoundedCorner(e,V,L,k,U,!0,!1,!1,!0),y&&e.stroke()}}),e.restore()}_drawRectWithRoundedCorner(e,r,n,i,s,a,l,c,o){const u=this._radius;!s||!i||(e.beginPath(),e.moveTo(r+u,n),e.lineTo(r+i-u,n),l?e.arcTo(r+i,n,r+i,n+u,u):e.lineTo(r+i,n),e.lineTo(r+i,n+s-u),c?e.arcTo(r+i,n+s,r+i-u,n+s,u):e.lineTo(r+i,n+s),e.lineTo(r+u,n+s),o?e.arcTo(r,n+s,r,n+s-u,u):e.lineTo(r,n+s),e.lineTo(r,n+u),a?e.arcTo(r,n,r+u,n,u):e.lineTo(r,n),e.closePath(),e.fill())}}C0.add(yn);const T2=t=>Math.max(Math.min(100,t),0),Dn=(t,e,r)=>{const n=r(t,e);if(n&&n.t===me.NUMBER){const i=Number(n.v);return Number.isNaN(i)?null:i}return null};class bn extends lt{preComputing(e,r,n){const i=n.rule,s=i.rule,a=n.worksheet,l=new le;![i.rule.config.max,i.rule.config.min].every(g=>g.type===M.num)&&ot(i.ranges,a.getMaxRows()-1,a.getMaxColumns()-1).forEach(g=>{ne.foreach(g,(m,f)=>{const w=n.getCellValue(m,f),x=w&&w.v;if(!ue(x)&&w?.t===me.NUMBER){const y=Number(x);!Number.isNaN(y)&&l.setValue(m,f,y)}})});const c=H2(s.config.min,l,{...n,cfId:i.cfId}),o=H2(s.config.max,l,{...n,cfId:i.cfId});let u=0,d=0;if(c.status===te.SUCCESS){const g=Number(c.result);u=Number.isNaN(g)?0:g}else{this._preComputingStatus$.next(Ie.preComputing);return}if(o.status===te.SUCCESS){const g=Number(o.result),m=Number.isNaN(g)?0:g;d=Math.max(m,u),u=Math.min(m,u);let f=50;if(u<0&&d<=0)f=100;else if(u<0&&d>0){const w=Math.abs(d)+Math.abs(u);f=Math.abs(u)/w*100}else u>=0&&d>0&&(f=0);this.setPreComputingCache({min:u,max:d,startPoint:f}),this._preComputingStatus$.next(Ie.preComputingEnd);return}this._preComputingStatus$.next(Ie.preComputing)}getCellResult(e,r,n,i){const{min:s,max:a,startPoint:l}=n,c=i.rule.rule,o=c.isShowValue,u=c.config.isGradient,d=Dn(e,r,i.getCellValue);if(!(d===null||d<s||s===a||a<s)){if(d===0)return{color:pn,startPoint:l,value:0,isGradient:u,isShowValue:o};if(s<0&&a<=0){const g=a-s,m=T2((a-d)/g*100);return m===0?void 0:{color:c.config.nativeColor||Oe,startPoint:l,value:-m,isGradient:u,isShowValue:o}}else if(s<0&&a>0)if(d>0){const g=T2(Math.min(d/a,1)*100);return g===0?void 0:{color:c.config.positiveColor||Be,startPoint:l,value:g,isGradient:u,isShowValue:o}}else{const g=T2(Math.min(Math.abs(d)/Math.abs(s),1)*100);return g===0?void 0:{color:c.config.nativeColor||Oe,startPoint:l,value:-g,isGradient:u,isShowValue:o}}else if(s>=0&&a>0){const g=a-s,m=0,f=T2((1-(a-d)/g)*100);return f===0?void 0:{color:c.config.positiveColor||Be,startPoint:m,value:f,isGradient:u,isShowValue:o}}}}}class En extends lt{preComputing(e,r,n){const i=n.rule.rule,s=ot(n.rule.ranges,n.worksheet.getMaxRows()-1,n.worksheet.getMaxColumns()-1),a=(()=>{switch(i.subType){case I.average:{let l=0,c=0;return s.forEach(o=>{ne.foreach(o,(u,d)=>{const g=n.getCellValue(u,d),m=Te(g);g&&g.t===me.NUMBER&&!ue(m)&&(l+=Number(m)||0,c++)})}),{value:l/c,type:i.subType}}case I.uniqueValues:case I.duplicateValues:{const l=new Map;return s.forEach(c=>{ne.foreach(c,(o,u)=>{const d=n.getCellValue(o,u),g=Te(d);if(!ue(g)){const m=l.get(g);m?l.set(g,m+1):l.set(g,1)}})}),{value:l,type:i.subType}}case I.rank:{let l=[];s.forEach(u=>{ne.foreach(u,(d,g)=>{const m=n.getCellValue(d,g),f=Te(m);m&&m.t===me.NUMBER&&!ue(f)&&l.push(Number(f)||0)})}),l.sort((u,d)=>d-u);const c=n.rule.rule;if(c.isPercent){c.isBottom&&(l=l.toReversed());const u=de.clamp(c.value,0,100)/100,d=Math.floor(u*l.length),g=de.clamp(d-1,0,l.length-1);return{value:l[g],type:i.subType}}const o=Math.floor(de.clamp(c.isBottom?c.value-1:c.value,0,l.length));return c.isBottom?{value:l[l.length-o-1],type:i.subType}:{value:l[Math.max(o-1,0)],type:i.subType}}case I.formula:{const l=i,c=n.accessor.get(s2);c.registerFormulaWithRange(n.unitId,n.subUnitId,n.rule.cfId,l.value,n.rule.ranges);const o=c.getFormulaMatrix(n.unitId,n.subUnitId,n.rule.cfId,l.value);return o&&o.status===te.SUCCESS?(this._preComputingStatus$.next(Ie.preComputingEnd),{value:o.result,type:i.subType}):(this._preComputingStatus$.next(Ie.preComputing),null)}case I.timePeriod:switch(i.operator){case J.last7Days:return{value:{start:ee().subtract(7,"day").valueOf(),end:ee().valueOf()},type:i.subType};case J.lastMonth:return{value:{start:ee().startOf("month").subtract(1,"month").valueOf(),end:ee().endOf("month").subtract(1,"month").valueOf()},type:i.subType};case J.lastWeek:return{value:{start:ee().startOf("week").subtract(1,"week").valueOf(),end:ee().endOf("week").subtract(1,"week").valueOf()},type:i.subType};case J.nextMonth:return{value:{start:ee().startOf("month").add(1,"month").valueOf(),end:ee().endOf("month").add(1,"month").valueOf()},type:i.subType};case J.nextWeek:return{value:{start:ee().startOf("week").add(1,"week").valueOf(),end:ee().endOf("week").add(1,"week").valueOf()},type:i.subType};case J.thisMonth:return{value:{start:ee().startOf("month").valueOf(),end:ee().endOf("month").valueOf()},type:i.subType};case J.thisWeek:return{value:{start:ee().startOf("week").valueOf(),end:ee().endOf("week").valueOf()},type:i.subType};case J.today:return{value:{start:ee().startOf("day").valueOf(),end:ee().endOf("day").valueOf()},type:i.subType};case J.tomorrow:return{value:{start:ee().startOf("day").add(1,"day").valueOf(),end:ee().endOf("day").add(1,"day").valueOf()},type:i.subType};case J.yesterday:return{value:{start:ee().startOf("day").subtract(1,"day").valueOf(),end:ee().endOf("day").subtract(1,"day").valueOf()},type:i.subType}}}})();this.setPreComputingCache(a)}getCellResult(e,r,n,i){const s=i.getCellValue(e,r),a=i.rule.rule;return(()=>{switch(a.subType){case I.number:{const l=s&&Number(s.v),c=s?.t===me.NUMBER,o=a;return c?ue(l)||Number.isNaN(l)?void 0:i2({operator:o.operator,value:o.value||0},l||0):!![_.notEqual,_.notBetween].includes(o.operator)}case I.text:{const l=a,c=Te(s),o=ue(c)?"":String(c),u=l.value||"";switch(l.operator){case B.beginsWith:return o.startsWith(u);case B.containsBlanks:return/^\s*$/.test(o);case B.notContainsBlanks:return!/^\s*$/.test(o);case B.containsErrors:return Lt.has(o);case B.notContainsErrors:return!Lt.has(o);case B.containsText:return o.indexOf(u)>-1;case B.notContainsText:return o.indexOf(u)===-1;case B.endsWith:return o.endsWith(u);case B.equal:return o===u;case B.notEqual:return o!==u;default:return!1}}case I.timePeriod:{const l=Te(s);if(ue(l)||Number.isNaN(Number(l))||s?.t!==me.NUMBER||!n)return;const c=Tn(Number(l)),{start:o,end:u}=n.value;return c>=o&&c<=u}case I.average:{const l=s&&s.v,c=Number(l),o=s?.t===me.NUMBER,u=a;if(!o)return _.notEqual===u.operator;if(ue(l)||Number.isNaN(c)||!n)return!1;const d=n.value;switch(u.operator){case _.greaterThan:return c>d;case _.greaterThanOrEqual:return c>=d;case _.lessThan:return c<d;case _.lessThanOrEqual:return c<=d;case _.equal:return q2(c,d);case _.notEqual:return!q2(c,d);default:return!1}}case I.rank:{const l=Te(s),c=Number(l);if(ue(l)||Number.isNaN(c)||s?.t!==me.NUMBER||!n)return!1;const o=n.value;return a.isBottom?c<=o:c>=o}case I.uniqueValues:{const l=Te(s);return ue(l)||!n?!1:n.value.get(l)===1}case I.duplicateValues:{const l=Te(s);if(ue(l)||!n)return!1;const c=n.value.get(l);return c&&c!==1}case I.formula:{const l=n?.value;if(l){const c=i.rule.ranges[0],o=e-c.startRow,u=r-c.startColumn;return l.getValue(o,u)===!0}return!1}}})()?a.style:{}}}const In=(t,e,r)=>{const n=r(t,e);if(n&&n.t===me.NUMBER){const i=Number(n.v);return Number.isNaN(i)?null:i}return null};class Fn extends lt{preComputing(e,r,n){const i=n.rule.rule,s=n.worksheet,a=new le;!i.config.every(c=>c.value.type===M.num)&&ot(n.rule.ranges,s.getMaxRows()-1,s.getMaxColumns()-1).forEach(c=>{ne.foreach(c,(o,u)=>{const d=n.getCellValue(o,u),g=d&&d.v;if(!ue(g)&&d?.t===me.NUMBER){const m=Number(g);!Number.isNaN(m)&&a.setValue(o,u,m)}})});const l=i.config.map(c=>H2(c.value,a,{...n,cfId:n.rule.cfId}));if(!l.some(c=>c.status!==te.SUCCESS)){const c=l.map((o,u)=>({operator:i.config[u].operator,value:Number(o.result)||0})).reduce((o,u,d,g)=>{const m=i.config[d];if(!d||d===g.length-1)o.push({...u,iconId:m.iconId,iconType:m.iconType});else{const f=g[d-1];i2(f,u.value)||o.push({...u,iconId:m.iconId,iconType:m.iconType})}return o},[]);this.setPreComputingCache(c),this._preComputingStatus$.next(Ie.preComputingEnd);return}this._preComputingStatus$.next(Ie.preComputing)}getCellResult(e,r,n,i){if(!n)return null;const s=In(e,r,i.getCellValue);if(s===null)return;const a=i.rule.rule,l=a.isShowValue===void 0?!0:!!a.isShowValue;for(let c=0;c<n.length;c++){const o=n[c],u={...o},d={...o},{iconId:g,iconType:m}=o;if(c===0){if(i2(o,s))return{iconId:g,iconType:m,isShowValue:l}}else{if(c===n.length-1)return{iconId:g,iconType:m,isShowValue:l};{const f=n[c-1];if(d.operator=W2(f.operator),d.value=f.value,i2(u,s)&&i2(d,s))return{iconId:g,iconType:m,isShowValue:l}}}}}}var _n=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},R2=(t,e)=>(r,n)=>e(r,n,t);const V2=1e3*3*3;let be=class extends ge{constructor(t,e,r,n){super(),G(this,"_calculateUnitManagers",new Map),G(this,"_rTreeManager",new er),G(this,"_cellCache",new t0(V2)),G(this,"_markDirty$",new j2),G(this,"markDirty$",this._markDirty$.asObservable()),G(this,"_markRuleDirtyAtOnce",(i,s,a,l=!0)=>{if(this._cellCache.clear(),l){const c=this._ensureCalculateUnitManager(i,s).get(a);c&&c.resetPreComputingCache()}this._markDirty$.next({unitId:i,subUnitId:s,cfId:a})}),G(this,"markRuleDirty",(()=>{const i=new j2;return this.disposeWithMe(i.pipe(w0(100),yt(s=>!!s.length),tr(s=>{const a=new Set,l=[];return s.forEach(c=>{const o=`${c.unitId}_${c.subUnitId}_${c.cfId}`;if(a.has(o)){if(c.isNeedResetPreComputingCache){const u=l.find(d=>d.cfId===c.cfId);u.isNeedResetPreComputingCache=!0}return}a.add(o),l.push({...c})}),l})).subscribe(s=>{s.forEach(a=>{this._markRuleDirtyAtOnce(a.unitId,a.subUnitId,a.cfId,a.isNeedResetPreComputingCache)})})),(s,a,l,c=!0)=>{i.next({unitId:s,subUnitId:a,cfId:l,isNeedResetPreComputingCache:c})}})()),this._injector=t,this._conditionalFormattingRuleModel=e,this._conditionalFormattingFormulaService=r,this._univerInstanceService=n,this._initRuleListener(),this._handleCustomFormulasSeparately(),this._initCFFormulaListener()}_initCFFormulaListener(){this.disposeWithMe(this._conditionalFormattingFormulaService.result$.subscribe(({unitId:t,subUnitId:e,cfId:r,isAllFinished:n})=>{n&&this._markRuleDirtyAtOnce(t,e,r,n)}))}getCellCfs(t,e,r,n){const i=this._createCacheKey(t,e,r,n);if(this._cellCache.has(i))return this._cellCache.get(i);const s=this._getCellCfs(t,e,r,n);return s.length&&this._cellCache.set(i,s),s}_getCellCfs(t,e,r,n){var i;const s=(i=this._conditionalFormattingRuleModel.getSubunitRules(t,e))!=null?i:[],a=this._ensureCalculateUnitManager(t,e),l=this._rTreeManager.bulkSearch([{unitId:t,sheetId:e,range:{startColumn:n,endColumn:n,startRow:r,endRow:r}}]),c=s.filter(o=>l.has(o.cfId));return c.length?c.map(o=>{const u=a.get(o.cfId);return u?{cfId:o.cfId,result:u.getCell(r,n)}:null}).filter(o=>!!o).map((o,u)=>({...o,priority:u})):[]}dispose(){this.clearCache(),super.dispose()}clearCache(){this._calculateUnitManagers.clear(),this._cellCache.clear(),this._rTreeManager.clear()}_handleCustomFormulasSeparately(){this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(t=>{if(t.type==="set"){const{unitId:e,subUnitId:r}=t,n=t.oldRule;n.rule.type===b.highlightCell&&n.rule.subType===I.formula&&this._conditionalFormattingFormulaService.deleteCache(e,r,n.cfId)}}))}_initRuleListener(){this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(t=>{const{unitId:e,subUnitId:r,rule:n}=t,{cfId:i,ranges:s}=n,a=this._ensureCalculateUnitManager(e,r);switch(this.markRuleDirty(e,r,i),t.type){case"add":{this._rTreeManager.bulkInsert(s.map(c=>({unitId:e,sheetId:r,id:i,range:c})));const l=this._createRuleCalculateUnitInstance(e,r,n);if(!l)return;a.set(n.cfId,l);break}case"delete":{this._rTreeManager.bulkRemove(s.map(l=>({unitId:e,sheetId:r,id:i,range:l}))),a.delete(n.cfId);break}case"set":{const l=t.oldRule;if(this._rTreeManager.bulkRemove(l.ranges.map(c=>({unitId:e,sheetId:r,id:l.cfId,range:c}))),this._rTreeManager.bulkInsert(s.map(c=>({unitId:e,sheetId:r,id:i,range:c}))),l.rule.type!==n.rule.type){const c=this._createRuleCalculateUnitInstance(e,r,n);if(!c)return;a.delete(l.cfId),a.set(n.cfId,c)}else{const c=a.get(l.cfId);if(!c)return;c.updateRule(n)}}}}))}_ensureCalculateUnitManager(t,e){let r=this._calculateUnitManagers.get(t);r||(r=new Map,this._calculateUnitManagers.set(t,r));let n=r.get(e);return n||(n=new Map,r.set(e,n)),n}_createRuleCalculateUnitInstance(t,e,r){const n=this._univerInstanceService.getUnit(t),i=n?.getSheetBySheetId(e);if(!n||!i)return;const s={workbook:n,worksheet:i,unitId:t,subUnitId:e,accessor:this._injector,rule:r,limit:V2,getCellValue:(a,l)=>i.getCellRaw(a,l)||{}};switch(r.rule.type){case b.colorScale:return new vn(s);case b.dataBar:return new bn(s);case b.highlightCell:return new En(s);case b.iconSet:return new Fn(s)}}_createCacheKey(t,e,r,n){return`${t}_${e}_${r}_${n}`}setCacheLength(t=V2){this._cellCache.limit!==t&&(this._cellCache.limit=t,this._calculateUnitManagers.forEach(e=>{e.forEach(r=>{r.forEach(n=>{n.setCacheLength(t)})})}))}};be=_n([R2(0,j(we)),R2(1,j(P)),R2(2,j(s2)),R2(3,q)],be);function q2(t,e){return Math.abs(t-e)<Number.EPSILON}const ue=t=>t==null||typeof t=="string"&&t.trim()==="",Te=t=>{var e,r;if(!t)return null;if(t.t===me.BOOLEAN)return t.v===Q.TRUE?Vt.TRUE:Vt.FALSE;const n=t.v,i=(r=(e=t.p)==null?void 0:e.body)==null?void 0:r.dataStream.replace(/\r\n$/,"");return ue(n)?ue(i)?null:i:n},gt=86400;function Sn(t,e=!0){if(e&&t>=0){if(t===0)return[1900,1,0];if(t===60)return[1900,2,29];if(t<60)return[1900,t<32?1:2,(t-1)%31+1]}let r=t+68569+2415019;const n=Math.floor(4*r/146097);r=r-Math.floor((146097*n+3)/4);const i=Math.floor(4e3*(r+1)/1461001);r=r-Math.floor(1461*i/4)+31;const s=Math.floor(80*r/2447),a=r-Math.floor(2447*s/80);r=Math.floor(s/11);const l=s+2-12*r;return[100*(n-49)+i+r|0,l|0,a|0]}const Tn=t=>{let e=t|0;const r=gt*(t-e);let n=Math.floor(r);r-n>.9999&&(n+=1,n===gt&&(n=0,e+=1));const i=n<0?gt+n:n,[s,a,l]=Sn(t,!0),c=Math.floor(i/60/60)%60,o=Math.floor(i/60)%60,u=Math.floor(i)%60;return ee(`${s}/${a}/${l} ${c}:${o}:${u}`).valueOf()},H2=(t,e,r)=>{switch(t.type){case M.max:{let n=0;return e.forValue((i,s,a)=>{a>n&&(n=a)}),{status:te.SUCCESS,result:n}}case M.min:{let n;return e.forValue((i,s,a)=>{n===void 0&&(n=a),a<n&&(n=a)}),{status:te.SUCCESS,result:n}}case M.percent:{let n,i;e.forValue((l,c,o)=>{(n===void 0||i===void 0)&&(n=o,i=o),o>n&&(n=o),o<i&&(i=o)});const s=(n||0)-(i||0),a=Math.max(Math.min(Number(t.value)||0,100),0);return{status:te.SUCCESS,result:s*(a/100)+(i||0)}}case M.percentile:{const n=e.toNativeArray().sort((o,u)=>o-u),i=Math.max(Math.min(Number(t.value)||0,100),0),s=(n.length-1)*i/100,a=Math.floor(s),l=s-a,c=n[a]+(n[Math.min(a+1,n.length-1)]-n[a])*l;return{status:te.SUCCESS,result:c}}case M.formula:{const{accessor:n,unitId:i,subUnitId:s,cfId:a}=r,l=String(t.value),c=n.get(s2);return c.registerFormulaWithRange(i,s,a,l),c.getFormulaResultWithCoords(i,s,a,l)}case M.num:default:{const n=Number(t.value);return{status:te.SUCCESS,result:Number.isNaN(n)?0:n}}}},ps=(t,e,r,n)=>{const{accessor:i}=n,s=i.get(be),a=new le;return r.ranges.forEach(l=>{ne.foreach(l,(c,o)=>{const u=s.getCellCfs(t,e,c,o);if(u){const d=u.find(g=>g.cfId===r.cfId);d!=null&&d.result&&a.setValue(c,o,d.result)}})}),a},i2=(t,e)=>{switch(t.operator){case _.between:{if(typeof t.value!="object"||!t.value.length)return;const r=Math.min(...t.value),n=Math.max(...t.value);return e>=r&&e<=n}case _.notBetween:{if(typeof t.value!="object"||!t.value.length)return;const r=Math.min(...t.value),n=Math.max(...t.value);return!(e>=r&&e<=n)}case _.equal:{const r=t.value||0;return q2(r,e)}case _.notEqual:{const r=t.value||0;return!q2(r,e)}case _.greaterThan:{const r=t.value||0;return e>r}case _.greaterThanOrEqual:{const r=t.value||0;return e>=r}case _.lessThan:{const r=t.value||0;return e<r}case _.lessThanOrEqual:{const r=t.value||0;return e<=r}default:return!1}},W2=t=>{switch(t){case _.greaterThan:return _.lessThanOrEqual;case _.greaterThanOrEqual:return _.lessThan;case _.lessThan:return _.greaterThanOrEqual;case _.lessThanOrEqual:return _.greaterThan}return t},D0=(t,e)=>{const r=s=>s.a!==void 0?s:{...s,a:1},n=t.findIndex(s=>s.value>=e),i=n-1;if(n===0)return t[0].color.toRgbString();if(i>=0){const s=t[i],a=t[n];if(s.color.isValid&&a.color.isValid){const l=r(s.color.toRgb()),c=r(a.color.toRgb()),o=a.value-s.value,u=(e-s.value)/o,d=["r","g","b","a"].reduce((g,m)=>{const f=l[m];return g[m]=(c[m]-f)*u+f,g},{});return new Ee(d).toRgbString()}}else return t[t.length-1].color.toRgbString()},ot=(t,e,r)=>t.map(n=>{if(n.startColumn>r||n.startRow>e)return null;const i={...n};return i.endRow=Math.min(i.endRow,e),i.endColumn=Math.min(i.endColumn,r),i}).filter(n=>!!n);function ws(t){let e=0;return new le(t).forValue((r,n,i)=>{e=Math.max(Number.isNaN(e)?0:e,Number(i))}),e}const Rn={mistake:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%227.03704%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.87359%206.87332C6.6146%207.13231%206.6146%207.55221%206.87359%207.8112L9.062%209.99961L6.87356%2012.188C6.61457%2012.447%206.61457%2012.8669%206.87356%2013.1259C7.13255%2013.3849%207.55245%2013.3849%207.81144%2013.1259L9.99987%2010.9375L12.1882%2013.1258C12.4472%2013.3848%2012.8671%2013.3848%2013.1261%2013.1258C13.3851%2012.8669%2013.3851%2012.447%2013.1261%2012.188L10.9378%209.99961L13.1261%207.81127C13.3851%207.55228%2013.3851%207.13238%2013.1261%206.87339C12.8671%206.61441%2012.4472%206.61441%2012.1882%206.87339L9.99987%209.06173L7.81147%206.87332C7.55248%206.61433%207.13257%206.61433%206.87359%206.87332Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A",warn:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%227.03704%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3Cpath%20d%3D%22M9.16817%206.67735C9.16646%206.61745%209.1656%206.5875%209.16653%206.56236C9.18103%206.16817%209.49136%205.84883%209.88497%205.82306C9.91008%205.82141%209.94004%205.82141%209.99996%205.82141V5.82141C10.0599%205.82141%2010.0899%205.82141%2010.115%205.82306C10.5086%205.84883%2010.8189%206.16817%2010.8334%206.56236C10.8343%206.5875%2010.8335%206.61745%2010.8318%206.67735L10.7043%2011.131C10.6934%2011.5121%2010.3812%2011.8154%209.99995%2011.8154V11.8154C9.61866%2011.8154%209.30655%2011.5121%209.29564%2011.131L9.16817%206.67735Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3Crect%20x%3D%229.31488%22%20y%3D%2212.8086%22%20width%3D%221.37006%22%20height%3D%221.37006%22%20rx%3D%220.685032%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A",correct:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M17.037%2010C17.037%2013.8865%2013.8864%2017.0371%209.99999%2017.0371C6.11354%2017.0371%202.96295%2013.8865%202.96295%2010C2.96295%206.1136%206.11354%202.96301%209.99999%202.96301C13.8864%202.96301%2017.037%206.1136%2017.037%2010Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3Cpath%20d%3D%22M13.9239%207.17477C13.6638%206.91472%2013.2422%206.91472%2012.9821%207.17477L8.74433%2011.4126L7.01786%209.6861C6.75781%209.42606%206.33619%209.42606%206.07614%209.6861C5.81609%209.94615%205.81609%2010.3678%206.07614%2010.6278L8.27349%2012.8252C8.53354%2013.0852%208.95516%2013.0852%209.21521%2012.8252L9.2195%2012.8209L13.9239%208.1165C14.1839%207.85645%2014.1839%207.43482%2013.9239%207.17477Z%22%20fill%3D%22%23FFFFFF%22%2F%3E%0A%3C%2Fsvg%3E%0A"},An={starEmpty:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.8451%207.0699%2012.2165%207.33978%2012.6421%207.36863L16.2362%207.61233C16.5693%207.63492%2016.7048%208.05202%2016.4486%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.215%2011.2859%2013.319%2011.6996L14.1979%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6418%2015.5971L10.5908%2013.6817C10.2296%2013.4549%209.77045%2013.4549%209.40924%2013.6817L6.35828%2015.5971C6.07553%2015.7746%205.72072%2015.5168%205.80217%2015.1931L6.68105%2011.6996C6.7851%2011.2859%206.64322%2010.8493%206.31592%2010.5758L3.55145%208.26607C3.29525%208.05202%203.43078%207.63492%203.76386%207.61233L7.358%207.36863C7.78352%207.33978%208.15498%207.0699%208.31391%206.67412L9.65633%203.3312C9.78074%203.0214%2010.2193%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23fff%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A",starIncomplete:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.845%207.0699%2012.2165%207.33978%2012.642%207.36863L16.2361%207.61233C16.5692%207.63492%2016.7047%208.05202%2016.4485%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.2149%2011.2859%2013.3189%2011.6996L14.1978%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6417%2015.5971L10.5908%2013.6817C10.2295%2013.4549%209.77039%2013.4549%209.40918%2013.6817L6.35822%2015.5971C6.07547%2015.7746%205.72066%2015.5168%205.80211%2015.1931L6.68098%2011.6996C6.78504%2011.2859%206.64316%2010.8493%206.31586%2010.5758L3.55139%208.26607C3.29519%208.05202%203.43072%207.63492%203.7638%207.61233L7.35793%207.36863C7.78346%207.33978%208.15491%207.0699%208.31385%206.67412L9.65627%203.3312C9.78068%203.0214%2010.2192%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23fff%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cmask%20id%3D%22mask1_613_177%22%20style%3D%22mask-type%3Aalpha%22%20maskUnits%3D%22userSpaceOnUse%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2210%22%20height%3D%2220%22%3E%0A%3Crect%20width%3D%2210%22%20height%3D%2220%22%20fill%3D%22%23C4C4C4%22%2F%3E%0A%3C%2Fmask%3E%0A%3Cg%20mask%3D%22url(%23mask1_613_177)%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.845%207.0699%2012.2165%207.33978%2012.642%207.36863L16.2361%207.61233C16.5692%207.63492%2016.7047%208.05202%2016.4485%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.2149%2011.2859%2013.3189%2011.6996L14.1978%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6417%2015.5971L10.5908%2013.6817C10.2295%2013.4549%209.77039%2013.4549%209.40918%2013.6817L6.35822%2015.5971C6.07547%2015.7746%205.72066%2015.5168%205.80211%2015.1931L6.68098%2011.6996C6.78504%2011.2859%206.64316%2010.8493%206.31586%2010.5758L3.55139%208.26607C3.29519%208.05202%203.43072%207.63492%203.7638%207.61233L7.35793%207.36863C7.78346%207.33978%208.15491%207.0699%208.31385%206.67412L9.65627%203.3312C9.78068%203.0214%2010.2192%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A",starFull:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.3437%203.3312L11.6861%206.67412C11.8451%207.0699%2012.2165%207.33978%2012.6421%207.36863L16.2362%207.61233C16.5693%207.63492%2016.7048%208.05202%2016.4486%208.26608L13.6841%2010.5758C13.3568%2010.8493%2013.215%2011.2859%2013.319%2011.6996L14.1979%2015.1931C14.2793%2015.5168%2013.9245%2015.7746%2013.6418%2015.5971L10.5908%2013.6817C10.2296%2013.4549%209.77045%2013.4549%209.40924%2013.6817L6.35828%2015.5971C6.07553%2015.7746%205.72072%2015.5168%205.80217%2015.1931L6.68105%2011.6996C6.7851%2011.2859%206.64322%2010.8493%206.31592%2010.5758L3.55145%208.26607C3.29525%208.05202%203.43078%207.63492%203.76386%207.61233L7.358%207.36863C7.78352%207.33978%208.15498%207.0699%208.31391%206.67412L9.65633%203.3312C9.78074%203.0214%2010.2193%203.0214%2010.3437%203.3312Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%23FFBD37%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A"},Mn={progress0:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress25:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M16.2963%209.99991C16.2963%209.17307%2016.1335%208.35432%2015.8171%207.59042C15.5006%206.82652%2015.0369%206.13242%2014.4522%205.54776C13.8675%204.96309%2013.1734%204.49931%2012.4095%204.18289C11.6456%203.86647%2010.8269%203.70361%2010%203.70361L10%209.99991H16.2963Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress50:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M10%2016.2962C11.6699%2016.2962%2013.2714%2015.6328%2014.4522%2014.4521C15.633%2013.2713%2016.2963%2011.6698%2016.2963%209.99991C16.2963%208.33003%2015.633%206.72854%2014.4522%205.54776C13.2714%204.36697%2011.6699%203.70361%2010%203.70361L10%209.99991L10%2016.2962Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress75:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Cpath%20d%3D%22M3.70374%209.99991C3.70374%2011.2452%204.07301%2012.4625%204.76485%2013.4979C5.4567%2014.5334%206.44005%2015.3404%207.59054%2015.8169C8.74104%2016.2935%2010.007%2016.4182%2011.2284%2016.1752C12.4497%2015.9323%2013.5716%2015.3326%2014.4522%2014.4521C15.3327%2013.5715%2015.9324%2012.4496%2016.1753%2011.2283C16.4183%2010.0069%2016.2936%208.74092%2015.8171%207.59042C15.3405%206.43992%2014.5335%205.45658%2013.4981%204.76473C12.4626%204.07288%2011.2453%203.70361%2010%203.70361L10%209.99991L3.70374%209.99991Z%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A",progress100:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99993%22%20r%3D%226.66667%22%20stroke%3D%22%237A7A7A%22%20stroke-width%3D%220.740741%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%229.99991%22%20r%3D%226.2963%22%20fill%3D%22%237A7A7A%22%2F%3E%0A%3C%2Fsvg%3E%0A"},Nn={signal0:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal25:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal50:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal75:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93921%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70435%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A",signal100:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%2214.4764%22%20y%3D%222.98926%22%20width%3D%222.3%22%20height%3D%2214.0597%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%2210.7255%22%20y%3D%225.93933%22%20width%3D%222.3%22%20height%3D%2211.1096%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%226.97455%22%20y%3D%229.70447%22%20width%3D%222.3%22%20height%3D%227.3443%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3Crect%20x%3D%223.22363%22%20y%3D%2213.3302%22%20width%3D%222.3%22%20height%3D%223.71851%22%20rx%3D%220.5%22%20fill%3D%22%230493EE%22%2F%3E%0A%3C%2Fsvg%3E%0A"},kn={guffaw:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M16.887%2010C16.887%2013.8037%2013.8036%2016.8871%209.99999%2016.8871C6.19638%2016.8871%203.11295%2013.8037%203.11295%2010C3.11295%206.19644%206.19638%203.11301%209.99999%203.11301C13.8036%203.11301%2016.887%206.19644%2016.887%2010Z%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M12.5355%2013.5821C13.0482%2013.1841%2013.3951%2012.6107%2013.5405%2012.0327C13.5934%2011.8226%2013.5051%2011.6349%2013.3518%2011.5331C13.2036%2011.4346%2013.0031%2011.4203%2012.8265%2011.5131C11.0615%2012.4407%208.94609%2012.4427%207.1828%2011.513C7.00629%2011.4199%206.80602%2011.4343%206.65798%2011.5329C6.50518%2011.6346%206.41701%2011.8217%206.46844%2012.0312C6.61029%2012.609%206.95079%2013.1833%207.46449%2013.5821C8.14361%2014.1093%209.05608%2014.3999%2010%2014.3999C10.9439%2014.3999%2011.8564%2014.1093%2012.5355%2013.5821Z%22%20fill%3D%22white%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.4%22%2F%3E%0A%3C%2Fsvg%3E%0A",smile:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2011.8518C7.03705%2011.8518%207.77779%2013.7037%2010%2013.7037C12.2222%2013.7037%2012.963%2011.8518%2012.963%2011.8518%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",noninductive:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.9259%22%20width%3D%221.48148%22%20height%3D%221.11111%22%20rx%3D%220.555556%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.9259%22%20width%3D%221.48148%22%20height%3D%221.11111%22%20rx%3D%220.555556%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2012.5927C7.03705%2012.5927%208.14816%2012.5927%2010.3704%2012.5927C12.5926%2012.5927%2012.963%2012.5927%2012.963%2012.5927%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",dissatisfied:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.03705%2013.7037C7.03705%2013.7037%207.77779%2011.8519%2010%2011.8519C12.2222%2011.8519%2012.963%2013.7037%2012.963%2013.7037%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.962963%22%20stroke-linecap%3D%22round%22%2F%3E%0A%3C%2Fsvg%3E%0A",impatient:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%229.99999%22%20cy%3D%2210%22%20r%3D%226.88704%22%20fill%3D%22%23FFBD37%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.3%22%2F%3E%0A%3Crect%20x%3D%227.40741%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Crect%20x%3D%2211.1111%22%20y%3D%227.40735%22%20width%3D%221.48148%22%20height%3D%221.48148%22%20rx%3D%220.740741%22%20fill%3D%22%238F5F00%22%2F%3E%0A%3Cpath%20d%3D%22M7.47573%2011.731C6.96306%2012.129%206.61613%2012.7024%206.47071%2013.2804C6.41784%2013.4905%206.50617%2013.6782%206.65942%2013.78C6.80761%2013.8785%207.00813%2013.8928%207.18477%2013.8C8.9498%2012.8724%2011.0652%2012.8704%2012.8285%2013.8002C13.005%2013.8932%2013.2052%2013.8788%2013.3533%2013.7802C13.5061%2013.6785%2013.5942%2013.4914%2013.5428%2013.2819C13.401%2012.7041%2013.0605%2012.1298%2012.5468%2011.731C11.8676%2011.2038%2010.9552%2010.9132%2010.0112%2010.9132C9.06732%2010.9132%208.15485%2011.2038%207.47573%2011.731Z%22%20fill%3D%22white%22%20stroke%3D%22%238F5F00%22%20stroke-width%3D%220.4%22%2F%3E%0A%3C%2Fsvg%3E%0A"},Un=JSON.parse('{"down-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.90467%203.99244C8.84611%204.1338%208.84611%204.31301%208.84611%204.67143V13.716L5.92068%2010.7906C5.66724%2010.5371%205.54052%2010.4104%205.39916%2010.3519C5.21067%2010.2738%204.9989%2010.2738%204.81041%2010.3519C4.66905%2010.4104%204.54233%2010.5371%204.28889%2010.7906C4.03545%2011.044%203.90873%2011.1707%203.85018%2011.3121C3.77211%2011.5006%203.77211%2011.7124%203.85018%2011.9008C3.90873%2012.0422%204.03545%2012.1689%204.28889%2012.4224L9.03476%2017.1682C9.07839%2017.2127%209.12737%2017.2617%209.18231%2017.3166L9.18239%2017.3167L9.18241%2017.3167C9.40545%2017.5398%209.53035%2017.6647%209.65346%2017.7313C9.67085%2017.7408%209.6882%2017.7492%209.70577%2017.7564C9.89425%2017.8345%2010.106%2017.8345%2010.2945%2017.7564C10.4359%2017.6979%2010.5626%2017.5712%2010.816%2017.3177C10.8986%2017.2352%2010.9677%2017.1661%2011.0253%2017.1056L15.7095%2012.4214L15.7095%2012.4213C15.963%2012.1679%2016.0897%2012.0412%2016.1482%2011.8998C16.2263%2011.7114%2016.2263%2011.4996%2016.1482%2011.3111C16.0897%2011.1697%2015.963%2011.043%2015.7095%2010.7896C15.4561%2010.5361%2015.3294%2010.4094%2015.188%2010.3509C14.9995%2010.2728%2014.7878%2010.2728%2014.5993%2010.3509C14.4579%2010.4094%2014.3312%2010.5361%2014.0778%2010.7896L14.0777%2010.7896L11.1538%2013.7135V4.67142C11.1538%204.31301%2011.1538%204.1338%2011.0953%203.99244C11.0172%203.80395%2010.8674%203.6542%2010.6789%203.57613C10.5376%203.51758%2010.3584%203.51758%209.99996%203.51758C9.64154%203.51758%209.46233%203.51758%209.32097%203.57613C9.13249%203.6542%208.98274%203.80395%208.90467%203.99244Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","right-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.32508%2011.7609C3.46644%2011.8194%203.64565%2011.8194%204.00407%2011.8194H13.049L10.1235%2014.745C9.87002%2014.9984%209.7433%2015.1251%209.68475%2015.2665C9.60668%2015.455%209.60668%2015.6668%209.68475%2015.8552C9.7433%2015.9966%209.87002%2016.1233%2010.1235%2016.3768C10.3769%2016.6302%2010.5036%2016.7569%2010.645%2016.8155C10.8335%2016.8935%2011.0452%2016.8935%2011.2337%2016.8155C11.3751%2016.7569%2011.5018%2016.6302%2011.7552%2016.3768L16.5105%2011.6215C16.5524%2011.5803%2016.5983%2011.5344%2016.6493%2011.4834L16.6495%2011.4831C16.8561%2011.2765%2016.9785%2011.1542%2017.0484%2011.0394C17.0648%2011.0128%2017.0782%2010.9866%2017.0893%2010.9599C17.1674%2010.7714%2017.1674%2010.5596%2017.0893%2010.3711C17.0308%2010.2298%2016.904%2010.1031%2016.6506%209.84962C16.5685%209.76752%2016.4997%209.69872%2016.4394%209.64123L11.7542%204.95601C11.5007%204.70257%2011.374%204.57585%2011.2327%204.5173C11.0442%204.43923%2010.8324%204.43923%2010.6439%204.5173C10.5026%204.57585%2010.3758%204.70257%2010.1224%204.95601L10.1224%204.95601C9.86895%205.20945%209.74223%205.33617%209.68368%205.47753C9.60561%205.66601%209.60561%205.87779%209.68368%206.06627C9.74223%206.20764%209.86895%206.33436%2010.1224%206.5878L13.0463%209.51175H4.00407C3.64565%209.51175%203.46644%209.51175%203.32508%209.5703C3.1366%209.64837%202.98685%209.79812%202.90877%209.98661C2.85022%2010.128%202.85022%2010.3072%202.85022%2010.6656C2.85022%2011.024%202.85022%2011.2032%202.90877%2011.3446C2.98685%2011.5331%203.1366%2011.6828%203.32508%2011.7609Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","up-green":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.0936%2017.3406C11.1522%2017.1992%2011.1522%2017.02%2011.1522%2016.6616V7.61701L14.0776%2010.5424C14.3311%2010.7959%2014.4578%2010.9226%2014.5991%2010.9811C14.7876%2011.0592%2014.9994%2011.0592%2015.1879%2010.9811C15.3292%2010.9226%2015.456%2010.7959%2015.7094%2010.5424C15.9628%2010.289%2016.0896%2010.1623%2016.1481%2010.0209C16.2262%209.83243%2016.2262%209.62066%2016.1481%209.43217C16.0896%209.29081%2015.9628%209.16409%2015.7094%208.91065L10.9645%204.16576C10.9207%204.12105%2010.8714%204.07178%2010.8161%204.01648L10.8159%204.0163C10.5916%203.792%2010.4666%203.66696%2010.3428%203.60058C10.3261%203.59154%2010.3094%203.58358%2010.2925%203.57658C10.104%203.49851%209.89226%203.49851%209.70378%203.57658C9.56242%203.63514%209.4357%203.76186%209.18226%204.0153C9.09955%204.09801%209.03034%204.16722%208.97258%204.22785L4.28878%208.91166C4.03534%209.1651%203.90862%209.29182%203.85006%209.43318C3.77199%209.62166%203.77199%209.83344%203.85006%2010.0219C3.90862%2010.1633%204.03534%2010.29%204.28878%2010.5434C4.54221%2010.7969%204.66893%2010.9236%204.8103%2010.9822C4.99878%2011.0602%205.21056%2011.0602%205.39904%2010.9822C5.5404%2010.9236%205.66712%2010.7969%205.92056%2010.5434L5.92056%2010.5434L8.84449%207.61951V16.6616C8.84449%2017.02%208.84449%2017.1992%208.90305%2017.3406C8.98112%2017.5291%209.13087%2017.6788%209.31935%2017.7569C9.46072%2017.8154%209.63992%2017.8154%209.99834%2017.8154C10.3568%2017.8154%2010.536%2017.8154%2010.6773%2017.7569C10.8658%2017.6788%2011.0156%2017.5291%2011.0936%2017.3406Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndDown-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.5062%206.72126C4.56476%206.86262%204.69148%206.98934%204.94492%207.24278L11.3404%2013.6382L7.20313%2013.6382C6.84471%2013.6382%206.66551%2013.6382%206.52414%2013.6968C6.33566%2013.7749%206.18591%2013.9246%206.10784%2014.1131C6.04928%2014.2545%206.04928%2014.4337%206.04928%2014.7921C6.04928%2015.1505%206.04928%2015.3297%206.10784%2015.4711C6.18591%2015.6596%206.33566%2015.8093%206.52414%2015.8874C6.66551%2015.9459%206.84471%2015.9459%207.20313%2015.9459L13.9194%2015.9459C13.9805%2015.9465%2014.0484%2015.9465%2014.1243%2015.9465H14.1243C14.4353%2015.9465%2014.6114%2015.9465%2014.7449%2015.9082C14.7659%2015.9023%2014.7859%2015.8954%2014.8052%2015.8874C14.9937%2015.8093%2015.1434%2015.6596%2015.2215%2015.4711C15.2801%2015.3297%2015.2801%2015.1505%2015.2801%2014.7921C15.2801%2014.6767%2015.2801%2014.5799%2015.2781%2014.497L15.2781%207.86957C15.2781%207.51115%2015.2781%207.33194%2015.2195%207.19058C15.1415%207.0021%2014.9917%206.85235%2014.8032%206.77428C14.6619%206.71572%2014.4827%206.71572%2014.1243%206.71572C13.7658%206.71572%2013.5866%206.71572%2013.4453%206.77428C13.2568%206.85235%2013.107%207.0021%2013.029%207.19058C12.9704%207.33194%2012.9704%207.51115%2012.9704%207.86957L12.9704%2012.0047L6.5767%205.61099C6.32326%205.35755%206.19654%205.23083%206.05518%205.17228C5.8667%205.09421%205.65492%205.09421%205.46644%205.17228C5.32508%205.23083%205.19836%205.35755%204.94492%205.61099C4.69148%205.86443%204.56476%205.99115%204.5062%206.13251C4.42813%206.32099%204.42813%206.53277%204.5062%206.72126Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndUp-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.05431%2016.1597C6.19567%2016.1012%206.32239%2015.9745%206.57583%2015.721L12.9712%209.32568L12.9712%2013.4626C12.9712%2013.821%2012.9712%2014.0002%2013.0297%2014.1416C13.1078%2014.3301%2013.2576%2014.4798%2013.446%2014.5579C13.5874%2014.6164%2013.7666%2014.6164%2014.125%2014.6164C14.4834%2014.6164%2014.6626%2014.6164%2014.804%2014.5579C14.9925%2014.4798%2015.1422%2014.3301%2015.2203%2014.1416C15.2789%2014.0002%2015.2789%2013.821%2015.2789%2013.4626L15.2789%206.75233C15.2795%206.68972%2015.2795%206.62004%2015.2795%206.54182L15.2795%206.54157C15.2795%206.22585%2015.2795%206.04918%2015.2395%205.91495C15.2339%205.89605%2015.2276%205.878%2015.2203%205.86053C15.1422%205.67204%2014.9925%205.52229%2014.804%205.44422C14.6626%205.38567%2014.4834%205.38567%2014.125%205.38567L14.125%205.38567C14.0075%205.38567%2013.9093%205.38567%2013.8254%205.38773L7.20256%205.38773C6.84414%205.38773%206.66493%205.38773%206.52357%205.44628C6.33509%205.52436%206.18534%205.6741%206.10727%205.86259C6.04871%206.00395%206.04871%206.18315%206.04871%206.54156V6.54157L6.04871%206.54159C6.04871%206.9%206.04871%207.0792%206.10727%207.22056C6.18534%207.40905%206.33509%207.55879%206.52357%207.63687C6.66493%207.69542%206.84414%207.69542%207.20256%207.69542H11.3379L4.94405%2014.0892C4.69061%2014.3427%204.56389%2014.4694%204.50533%2014.6108C4.42726%2014.7992%204.42726%2015.011%204.50533%2015.1995C4.56389%2015.3409%204.69061%2015.4676%204.94405%2015.721C5.19749%2015.9745%205.32421%2016.1012%205.46557%2016.1597C5.65405%2016.2378%205.86583%2016.2378%206.05431%2016.1597Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","down-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.90467%203.99244C8.84611%204.1338%208.84611%204.31301%208.84611%204.67143V13.716L5.92068%2010.7906C5.66724%2010.5371%205.54052%2010.4104%205.39916%2010.3519C5.21067%2010.2738%204.9989%2010.2738%204.81041%2010.3519C4.66905%2010.4104%204.54233%2010.5371%204.28889%2010.7906C4.03545%2011.044%203.90873%2011.1707%203.85018%2011.3121C3.77211%2011.5006%203.77211%2011.7124%203.85018%2011.9008C3.90873%2012.0422%204.03545%2012.1689%204.28889%2012.4224L9.03476%2017.1682C9.07839%2017.2127%209.12737%2017.2617%209.18231%2017.3166L9.18239%2017.3167L9.18241%2017.3167C9.40545%2017.5398%209.53035%2017.6647%209.65346%2017.7313C9.67085%2017.7408%209.6882%2017.7492%209.70577%2017.7564C9.89425%2017.8345%2010.106%2017.8345%2010.2945%2017.7564C10.4359%2017.6979%2010.5626%2017.5712%2010.816%2017.3177C10.8986%2017.2352%2010.9677%2017.1661%2011.0253%2017.1056L15.7095%2012.4214L15.7095%2012.4213C15.963%2012.1679%2016.0897%2012.0412%2016.1482%2011.8998C16.2263%2011.7114%2016.2263%2011.4996%2016.1482%2011.3111C16.0897%2011.1697%2015.963%2011.043%2015.7095%2010.7896C15.4561%2010.5361%2015.3294%2010.4094%2015.188%2010.3509C14.9995%2010.2728%2014.7878%2010.2728%2014.5993%2010.3509C14.4579%2010.4094%2014.3312%2010.5361%2014.0778%2010.7896L14.0777%2010.7896L11.1538%2013.7135V4.67142C11.1538%204.31301%2011.1538%204.1338%2011.0953%203.99244C11.0172%203.80395%2010.8674%203.6542%2010.6789%203.57613C10.5376%203.51758%2010.3584%203.51758%209.99996%203.51758C9.64154%203.51758%209.46233%203.51758%209.32097%203.57613C9.13249%203.6542%208.98274%203.80395%208.90467%203.99244Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","right-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M3.32508%2011.7609C3.46644%2011.8194%203.64565%2011.8194%204.00407%2011.8194H13.049L10.1235%2014.745C9.87002%2014.9984%209.7433%2015.1251%209.68475%2015.2665C9.60668%2015.455%209.60668%2015.6668%209.68475%2015.8552C9.7433%2015.9966%209.87002%2016.1233%2010.1235%2016.3768C10.3769%2016.6302%2010.5036%2016.7569%2010.645%2016.8155C10.8335%2016.8935%2011.0452%2016.8935%2011.2337%2016.8155C11.3751%2016.7569%2011.5018%2016.6302%2011.7552%2016.3768L16.5105%2011.6215C16.5524%2011.5803%2016.5983%2011.5344%2016.6493%2011.4834L16.6495%2011.4831C16.8561%2011.2765%2016.9785%2011.1542%2017.0484%2011.0394C17.0648%2011.0128%2017.0782%2010.9866%2017.0893%2010.9599C17.1674%2010.7714%2017.1674%2010.5596%2017.0893%2010.3711C17.0308%2010.2298%2016.904%2010.1031%2016.6506%209.84962C16.5685%209.76752%2016.4997%209.69872%2016.4394%209.64123L11.7542%204.95601C11.5007%204.70257%2011.374%204.57585%2011.2327%204.5173C11.0442%204.43923%2010.8324%204.43923%2010.6439%204.5173C10.5026%204.57585%2010.3758%204.70257%2010.1224%204.95601L10.1224%204.95601C9.86895%205.20945%209.74223%205.33617%209.68368%205.47753C9.60561%205.66601%209.60561%205.87779%209.68368%206.06627C9.74223%206.20764%209.86895%206.33436%2010.1224%206.5878L13.0463%209.51175H4.00407C3.64565%209.51175%203.46644%209.51175%203.32508%209.5703C3.1366%209.64837%202.98685%209.79812%202.90877%209.98661C2.85022%2010.128%202.85022%2010.3072%202.85022%2010.6656C2.85022%2011.024%202.85022%2011.2032%202.90877%2011.3446C2.98685%2011.5331%203.1366%2011.6828%203.32508%2011.7609Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","up-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.0936%2017.3406C11.1522%2017.1992%2011.1522%2017.02%2011.1522%2016.6616V7.61701L14.0776%2010.5424C14.3311%2010.7959%2014.4578%2010.9226%2014.5991%2010.9811C14.7876%2011.0592%2014.9994%2011.0592%2015.1879%2010.9811C15.3292%2010.9226%2015.456%2010.7959%2015.7094%2010.5424C15.9628%2010.289%2016.0896%2010.1623%2016.1481%2010.0209C16.2262%209.83243%2016.2262%209.62066%2016.1481%209.43217C16.0896%209.29081%2015.9628%209.16409%2015.7094%208.91065L10.9645%204.16576C10.9207%204.12105%2010.8714%204.07178%2010.8161%204.01648L10.8159%204.0163C10.5916%203.792%2010.4666%203.66696%2010.3428%203.60058C10.3261%203.59154%2010.3094%203.58358%2010.2925%203.57658C10.104%203.49851%209.89226%203.49851%209.70378%203.57658C9.56242%203.63514%209.4357%203.76186%209.18226%204.0153C9.09955%204.09801%209.03034%204.16722%208.97258%204.22785L4.28878%208.91166C4.03534%209.1651%203.90862%209.29182%203.85006%209.43318C3.77199%209.62166%203.77199%209.83344%203.85006%2010.0219C3.90862%2010.1633%204.03534%2010.29%204.28878%2010.5434C4.54221%2010.7969%204.66893%2010.9236%204.8103%2010.9822C4.99878%2011.0602%205.21056%2011.0602%205.39904%2010.9822C5.5404%2010.9236%205.66712%2010.7969%205.92056%2010.5434L5.92056%2010.5434L8.84449%207.61951V16.6616C8.84449%2017.02%208.84449%2017.1992%208.90305%2017.3406C8.98112%2017.5291%209.13087%2017.6788%209.31935%2017.7569C9.46072%2017.8154%209.63992%2017.8154%209.99834%2017.8154C10.3568%2017.8154%2010.536%2017.8154%2010.6773%2017.7569C10.8658%2017.6788%2011.0156%2017.5291%2011.0936%2017.3406Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndDown-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.5062%206.72126C4.56476%206.86262%204.69148%206.98934%204.94492%207.24278L11.3404%2013.6382L7.20313%2013.6382C6.84471%2013.6382%206.66551%2013.6382%206.52414%2013.6968C6.33566%2013.7749%206.18591%2013.9246%206.10784%2014.1131C6.04928%2014.2545%206.04928%2014.4337%206.04928%2014.7921C6.04928%2015.1505%206.04928%2015.3297%206.10784%2015.4711C6.18591%2015.6596%206.33566%2015.8093%206.52414%2015.8874C6.66551%2015.9459%206.84471%2015.9459%207.20313%2015.9459L13.9194%2015.9459C13.9805%2015.9465%2014.0484%2015.9465%2014.1243%2015.9465H14.1243C14.4353%2015.9465%2014.6114%2015.9465%2014.7449%2015.9082C14.7659%2015.9023%2014.7859%2015.8954%2014.8052%2015.8874C14.9937%2015.8093%2015.1434%2015.6596%2015.2215%2015.4711C15.2801%2015.3297%2015.2801%2015.1505%2015.2801%2014.7921C15.2801%2014.6767%2015.2801%2014.5799%2015.2781%2014.497L15.2781%207.86957C15.2781%207.51115%2015.2781%207.33194%2015.2195%207.19058C15.1415%207.0021%2014.9917%206.85235%2014.8032%206.77428C14.6619%206.71572%2014.4827%206.71572%2014.1243%206.71572C13.7658%206.71572%2013.5866%206.71572%2013.4453%206.77428C13.2568%206.85235%2013.107%207.0021%2013.029%207.19058C12.9704%207.33194%2012.9704%207.51115%2012.9704%207.86957L12.9704%2012.0047L6.5767%205.61099C6.32326%205.35755%206.19654%205.23083%206.05518%205.17228C5.8667%205.09421%205.65492%205.09421%205.46644%205.17228C5.32508%205.23083%205.19836%205.35755%204.94492%205.61099C4.69148%205.86443%204.56476%205.99115%204.5062%206.13251C4.42813%206.32099%204.42813%206.53277%204.5062%206.72126Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","rightAndUp-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.05431%2016.1597C6.19567%2016.1012%206.32239%2015.9745%206.57583%2015.721L12.9712%209.32568L12.9712%2013.4626C12.9712%2013.821%2012.9712%2014.0002%2013.0297%2014.1416C13.1078%2014.3301%2013.2576%2014.4798%2013.446%2014.5579C13.5874%2014.6164%2013.7666%2014.6164%2014.125%2014.6164C14.4834%2014.6164%2014.6626%2014.6164%2014.804%2014.5579C14.9925%2014.4798%2015.1422%2014.3301%2015.2203%2014.1416C15.2789%2014.0002%2015.2789%2013.821%2015.2789%2013.4626L15.2789%206.75233C15.2795%206.68972%2015.2795%206.62004%2015.2795%206.54182L15.2795%206.54157C15.2795%206.22585%2015.2795%206.04918%2015.2395%205.91495C15.2339%205.89605%2015.2276%205.878%2015.2203%205.86053C15.1422%205.67204%2014.9925%205.52229%2014.804%205.44422C14.6626%205.38567%2014.4834%205.38567%2014.125%205.38567L14.125%205.38567C14.0075%205.38567%2013.9093%205.38567%2013.8254%205.38773L7.20256%205.38773C6.84414%205.38773%206.66493%205.38773%206.52357%205.44628C6.33509%205.52436%206.18534%205.6741%206.10727%205.86259C6.04871%206.00395%206.04871%206.18315%206.04871%206.54156V6.54157L6.04871%206.54159C6.04871%206.9%206.04871%207.0792%206.10727%207.22056C6.18534%207.40905%206.33509%207.55879%206.52357%207.63687C6.66493%207.69542%206.84414%207.69542%207.20256%207.69542H11.3379L4.94405%2014.0892C4.69061%2014.3427%204.56389%2014.4694%204.50533%2014.6108C4.42726%2014.7992%204.42726%2015.011%204.50533%2015.1995C4.56389%2015.3409%204.69061%2015.4676%204.94405%2015.721C5.19749%2015.9745%205.32421%2016.1012%205.46557%2016.1597C5.65405%2016.2378%205.86583%2016.2378%206.05431%2016.1597Z%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A"}'),Vn={cross:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%223.70374%22%20y%3D%228.14795%22%20width%3D%2212.5926%22%20height%3D%223.7037%22%20rx%3D%220.740741%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A",up:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M9.44533%205.81157C9.74012%205.47858%2010.2598%205.47858%2010.5546%205.81157L16.2868%2012.2867C16.71%2012.7647%2016.3706%2013.5184%2015.7322%2013.5184H4.26776C3.62933%2013.5184%203.28995%2012.7647%203.71313%2012.2867L9.44533%205.81157Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A",down:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M10.5547%2014.1884C10.2599%2014.5214%209.74019%2014.5214%209.4454%2014.1884L3.71321%207.71335C3.29002%207.23532%203.6294%206.48161%204.26784%206.48161L15.7322%206.48161C16.3707%206.48161%2016.7101%207.23532%2016.2869%207.71335L10.5547%2014.1884Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","rhomboid-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M2.1415%2011.1984C1.8412%2010.9074%201.8412%2010.4256%202.1415%2010.1346L9.48467%203.01785C9.77196%202.73942%2010.2284%202.73942%2010.5157%203.01786L17.8586%2010.1346C18.1589%2010.4256%2018.1589%2010.9074%2017.8586%2011.1984L10.5157%2018.3151C10.2284%2018.5936%209.77196%2018.5936%209.48467%2018.3152L2.1415%2011.1984Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-greed":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-pink":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23FB9D9D%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-gray":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22%23999999%22%2F%3E%0A%3C%2Fsvg%3E%0A","roundness-black":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210.6664%22%20r%3D%227.03704%22%20fill%3D%22black%22%2F%3E%0A%3C%2Fsvg%3E%0A","triangle-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url(%23clip0_613_237)%22%3E%0A%3Cpath%20d%3D%22M9.32308%204.41301C9.58368%203.82623%2010.4164%203.82623%2010.677%204.413L15.9526%2016.2917C16.1701%2016.7815%2015.8115%2017.3331%2015.2756%2017.3331H4.72454C4.18858%2017.3331%203.83002%2016.7815%204.04756%2016.2917L9.32308%204.41301Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_613_237%22%3E%0A%3Crect%20width%3D%2220%22%20height%3D%2220%22%20fill%3D%22white%22%20transform%3D%22translate(0%200.666504)%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A","indicate-greed":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","indicate-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","indicate-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%222.76941%22%20y%3D%222.76941%22%20width%3D%2214.4612%22%20height%3D%2214.4612%22%20rx%3D%223%22%20fill%3D%22black%22%2F%3E%0A%3Ccircle%20cx%3D%2210%22%20cy%3D%2210%22%20r%3D%224.5%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A"},Ln={mistake2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.12194%206.33702C4.1805%206.47839%204.30722%206.6051%204.56066%206.85854L8.36822%2010.6661L4.56062%2014.4737C4.30718%2014.7272%204.18046%2014.8539%204.12191%2014.9952C4.04384%2015.1837%204.04384%2015.3955%204.12191%2015.584C4.18046%2015.7253%204.30718%2015.8521%204.56062%2016.1055C4.81406%2016.3589%204.94078%2016.4857%205.08214%2016.5442C5.27062%2016.6223%205.4824%2016.6223%205.67089%2016.5442C5.81225%2016.4857%205.93897%2016.3589%206.19241%2016.1055L10%2012.2979L13.8074%2016.1053C14.0609%2016.3588%2014.1876%2016.4855%2014.329%2016.544C14.5174%2016.6221%2014.7292%2016.6221%2014.9177%2016.544C15.0591%2016.4855%2015.1858%2016.3588%2015.4392%2016.1053L15.4392%2016.1053C15.6927%2015.8519%2015.8194%2015.7252%2015.8779%2015.5838C15.956%2015.3953%2015.956%2015.1835%2015.8779%2014.9951C15.8194%2014.8537%2015.6927%2014.727%2015.4392%2014.4735L15.4392%2014.4735L11.6318%2010.6661L15.4392%206.85872C15.6926%206.60528%2015.8193%206.47856%2015.8779%206.3372C15.956%206.14871%2015.956%205.93694%2015.8779%205.74845C15.8193%205.60709%2015.6926%205.48037%2015.4392%205.22693C15.1857%204.97349%2015.059%204.84677%2014.9177%204.78822C14.7292%204.71015%2014.5174%204.71015%2014.3289%204.78822C14.1876%204.84677%2014.0608%204.97349%2013.8074%205.22693L10%209.03433L6.19244%205.22676C5.939%204.97332%205.81228%204.8466%205.67092%204.78805C5.48244%204.70997%205.27066%204.70997%205.08218%204.78805C4.94082%204.8466%204.8141%204.97332%204.56066%205.22676L4.56066%205.22676C4.30722%205.4802%204.1805%205.60692%204.12194%205.74828C4.04387%205.93676%204.04387%206.14854%204.12194%206.33702Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A",warn2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M8.49778%205.00963C8.48513%204.56774%208.47881%204.3468%208.56086%204.17746C8.63301%204.02856%208.75124%203.90689%208.89802%203.83052C9.06494%203.74365%209.28597%203.74365%209.72805%203.74365H10.272C10.714%203.74365%2010.9351%203.74365%2011.102%203.83052C11.2488%203.9069%2011.367%204.02856%2011.4392%204.17746C11.5212%204.3468%2011.5149%204.56775%2011.5022%205.00964L11.2644%2013.3173C11.2524%2013.737%2011.2464%2013.9468%2011.1609%2014.1065C11.0857%2014.2471%2010.9687%2014.3609%2010.826%2014.432C10.6639%2014.5129%2010.454%2014.5129%2010.0342%2014.5129H9.96582C9.54601%2014.5129%209.33611%2014.5129%209.17397%2014.432C9.0313%2014.3609%208.91426%2014.2471%208.83904%2014.1065C8.75357%2013.9468%208.74756%2013.737%208.73555%2013.3173L8.49778%205.00963Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3Crect%20x%3D%228.76917%22%20y%3D%2215.2817%22%20width%3D%222.46154%22%20height%3D%222.46154%22%20rx%3D%220.769231%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A",correct2:"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url(%23clip0_613_248)%22%3E%0A%3Cpath%20d%3D%22M15.689%205.69723C15.5476%205.75578%2015.4209%205.8825%2015.1675%206.13594L7.82436%2013.4791L4.83279%2010.4875C4.57935%2010.2341%204.45263%2010.1073%204.31127%2010.0488C4.12278%209.97071%203.91101%209.97071%203.72252%2010.0488C3.58116%2010.1073%203.45444%2010.2341%203.201%2010.4875C2.94756%2010.7409%202.82084%2010.8676%202.76229%2011.009C2.68422%2011.1975%202.68422%2011.4093%202.76229%2011.5978C2.82084%2011.7391%202.94756%2011.8658%203.201%2012.1193L7.0085%2015.9268C7.26194%2016.1802%207.38866%2016.3069%207.53002%2016.3655C7.7185%2016.4436%207.93028%2016.4436%208.11876%2016.3655C8.26013%2016.3069%208.38685%2016.1802%208.64028%2015.9268C8.66387%2015.9032%208.68636%2015.8807%208.7078%2015.8592L16.7993%207.76772C17.0527%207.51428%2017.1794%207.38756%2017.238%207.2462C17.3161%207.05772%2017.3161%206.84594%2017.238%206.65746C17.1794%206.5161%2017.0527%206.38938%2016.7993%206.13594C16.5458%205.8825%2016.4191%205.75578%2016.2777%205.69723C16.0893%205.61915%2015.8775%205.61915%2015.689%205.69723Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_613_248%22%3E%0A%3Crect%20width%3D%2220%22%20height%3D%2220%22%20fill%3D%22white%22%20transform%3D%22translate(0%200.666504)%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%0A"},jn={"flag-green":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%2359D01E%22%2F%3E%0A%3C%2Fsvg%3E%0A","flag-gold":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%23FFBD37%22%2F%3E%0A%3C%2Fsvg%3E%0A","flag-red":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2221%22%20viewBox%3D%220%200%2020%2021%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M15.4274%204.74935C14.0982%205.1012%2013.1363%205.13675%2012.3604%205.03379C11.5776%204.93009%2010.9487%204.68342%2010.2456%204.40416L10.2246%204.39527C9.53411%204.1212%208.76945%203.8175%207.81312%203.69157C6.84279%203.56268%205.71016%203.61898%204.24802%204.0049C4.09343%204.04217%203.95538%204.13393%203.85649%204.26515C3.7576%204.39636%203.70374%204.55925%203.70374%204.72712V17.3197C3.70374%2017.5162%203.79534%2017.7046%203.92654%2017.8435C4.05773%2017.9824%204.25893%2018.0605%204.44448%2018.0605C4.63002%2018.0605%204.84911%2017.9824%204.98031%2017.8435C5.11151%2017.7046%205.18522%2017.5162%205.18522%2017.3197V14.9123V12.5049C6.24649%2012.2738%206.97081%2012.2605%207.63962%2012.3486C8.42246%2012.4523%209.05139%2012.699%209.75448%2012.9782L9.77546%2012.9871C10.466%2013.2612%2011.2306%2013.5649%2012.1869%2013.6908C13.1601%2013.8197%2014.2976%2013.7627%2015.7667%2013.3738C15.8866%2013.3421%2016.0727%2013.2135%2016.1483%2013.111C16.2238%2013.0084%2016.2963%2012.8204%2016.2963%2012.6553V5.46787C16.2963%205.35535%2016.2721%205.24432%2016.2255%205.1432C16.1788%205.04208%2016.1111%204.95353%2016.0274%204.88428C15.9436%204.81502%2015.846%204.76688%2015.7421%204.7435C15.6382%204.72012%2015.494%204.73173%2015.4274%204.74935Z%22%20fill%3D%22%23FE4B4B%22%2F%3E%0A%3C%2Fsvg%3E%0A"},Bn={"cell-0":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-25":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%224.00098%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-50":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-75":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211%22%20y%3D%2211.001%22%20width%3D%225%22%20height%3D%225%22%20rx%3D%221%22%20fill%3D%22%23E5E5E5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A","cell-100":"data:image/svg+xml;charset=utf-8,%3Csvg%20width%3D%2220%22%20height%3D%2220%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%2211.251%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%224.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3Crect%20x%3D%2211.25%22%20y%3D%224.25098%22%20width%3D%224.5%22%20height%3D%224.5%22%20rx%3D%220.75%22%20fill%3D%22%230493EE%22%20stroke%3D%22%230493EE%22%20stroke-width%3D%220.5%22%2F%3E%0A%3C%2Fsvg%3E%0A"},T={feedback:Rn,star:An,progress:Mn,signal:Nn,feeling:kn,arrow:Un,shape:Vn,feedback2:Ln,flag:jn,cell:Bn},b0=[{title:"sheet.cf.iconSet.direction",group:[{name:"3Arrows",list:[T.arrow["up-green"],T.arrow["right-gold"],T.arrow["down-red"]]},{name:"3ArrowsGray",list:[T.arrow["up-gray"],T.arrow["right-gray"],T.arrow["down-gray"]]},{name:"4Arrows",list:[T.arrow["up-green"],T.arrow["rightAndUp-gold"],T.arrow["rightAndDown-gold"],T.arrow["down-red"]]},{name:"4ArrowsGray",list:[T.arrow["up-gray"],T.arrow["rightAndUp-gray"],T.arrow["rightAndDown-gray"],T.arrow["down-gray"]]},{name:"5Arrows",list:[T.arrow["up-green"],T.arrow["rightAndUp-gold"],T.arrow["right-gold"],T.arrow["rightAndDown-gold"],T.arrow["down-red"]]},{name:"5ArrowsGray",list:[T.arrow["up-gray"],T.arrow["rightAndUp-gray"],T.arrow["right-gray"],T.arrow["rightAndDown-gray"],T.arrow["down-gray"]]},{name:"3Triangles",list:[T.shape.up,T.shape.cross,T.shape.down]}]},{title:"sheet.cf.iconSet.shape",group:[{name:"3TrafficLights1",list:[T.shape["roundness-greed"],T.shape["roundness-gold"],T.shape["roundness-red"]]},{name:"3Signs",list:[T.shape["roundness-greed"],T.shape["triangle-gold"],T.shape["rhomboid-red"]]},{name:"3TrafficLights2",list:[T.shape["indicate-greed"],T.shape["indicate-gold"],T.shape["indicate-red"]]},{name:"4RedToBlack",list:[T.shape["roundness-red"],T.shape["roundness-pink"],T.shape["roundness-gray"],T.shape["roundness-black"]]},{name:"4TrafficLights",list:[T.shape["roundness-greed"],T.shape["roundness-gold"],T.shape["roundness-red"],T.shape["roundness-black"]]}]},{title:"sheet.cf.iconSet.mark",group:[{name:"3Symbols",list:[T.feedback.correct,T.feedback.warn,T.feedback.mistake]},{name:"3Symbols2",list:[T.feedback2.correct2,T.feedback2.warn2,T.feedback2.mistake2]},{name:"3Flags",list:[T.flag["flag-green"],T.flag["flag-gold"],T.flag["flag-red"]]}]},{title:"sheet.cf.iconSet.rank",group:[{name:"4Rating",list:[T.signal.signal25,T.signal.signal50,T.signal.signal75,T.signal.signal100]},{name:"5Rating",list:[T.signal.signal0,T.signal.signal25,T.signal.signal50,T.signal.signal75,T.signal.signal100]},{name:"5Quarters",list:[T.progress.progress100,T.progress.progress75,T.progress.progress50,T.progress.progress25,T.progress.progress0]},{name:"_5Felling",list:[T.feeling.guffaw,T.feeling.smile,T.feeling.noninductive,T.feeling.dissatisfied,T.feeling.impatient]},{name:"5Boxes",list:[T.cell["cell-100"],T.cell["cell-75"],T.cell["cell-50"],T.cell["cell-25"],T.cell["cell-0"]]},{name:"3Stars",list:[T.star.starFull,T.star.starIncomplete,T.star.starEmpty]}]}],Ce=b0.reduce((t,e)=>{const{group:r}=e;for(const n of r)t[n.name]=n.list;return t},{});for(const t in Ce){const e=Ce[t];Object.freeze(e)}const f2="EMPTY_ICON_TYPE",On="ssheets-conditional-formatting.config",Pt={};var $n=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},e2=(t,e)=>(r,n)=>e(r,n,t);let $e=class extends ge{constructor(t,e,r,n,i,s){super(),this._conditionalFormattingRuleModel=t,this._injector=e,this._univerInstanceService=r,this._resourceManagerService=n,this._sheetInterceptorService=i,this._commandService=s,this._initCellChange(),this._initSnapshot(),this._initSheetChange()}get _conditionalFormattingViewModelV2(){return this._injector.get(be)}composeStyle(t,e,r,n){const i=this._conditionalFormattingViewModelV2.getCellCfs(t,e,r,n);if(i&&i!=null&&i.length){const s=i.map(l=>this._conditionalFormattingRuleModel.getRule(t,e,l.cfId)).filter(l=>!!l).reverse(),a=s.findIndex(l=>l?.stopIfTrue);return a>-1&&s.splice(a+1),s.reduce((l,c)=>{var o;const u=c.rule.type,d=i.find(g=>g.cfId===c.cfId);if(u===b.highlightCell)d.result&&et(l,{style:d.result});else if(u===b.colorScale){const g=d?.result;g&&typeof g=="string"&&(l.style={...(o=l.style)!=null?o:{},bg:{rgb:g}})}else if(u===b.dataBar){const g=d?.result;g&&(l.dataBar=g,l.isShowValue=g.isShowValue)}else if(u===b.iconSet){const g=d?.result;g&&(l.iconSet=g,l.isShowValue=g.isShowValue)}return l},{})}return null}_initSnapshot(){const t=r=>{const n=this._conditionalFormattingRuleModel.getUnitRules(r),i={};return n?(n.forEach((s,a)=>{i[a]=s}),JSON.stringify(i)):""},e=r=>{if(!r)return{};try{return JSON.parse(r)}catch{return{}}};this.disposeWithMe(this._resourceManagerService.registerPluginResource({pluginName:Ge,businesses:[$.UNIVER_SHEET],toJson:r=>t(r),parseJson:r=>e(r),onUnLoad:r=>{this._conditionalFormattingRuleModel.deleteUnitId(r),!Q0(r)&&this._conditionalFormattingViewModelV2.clearCache()},onLoad:(r,n)=>{Object.keys(n).forEach(i=>{[...n[i]].reverse().forEach(s=>{this._conditionalFormattingRuleModel.addRule(r,i,s)})})}}))}_initSheetChange(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>{if(t.id===dr.id){const e=t.params,r=re(this._univerInstanceService,e);if(!r)return{redos:[],undos:[]};const{unitId:n,subUnitId:i}=r,s=this._conditionalFormattingRuleModel.getSubunitRules(n,i);if(!s)return{redos:[],undos:[]};const a=[],l=[];return s.forEach(c=>{const o={unitId:n,subUnitId:i,cfId:c.cfId};a.push({id:he.id,params:o}),l.push(..._e(this._injector,o))}),{redos:a,undos:l}}else if(t.id===hr.id){const e=t.params,r=re(this._univerInstanceService,e);if(!r)return{redos:[],undos:[]};const{unitId:n,subUnitId:i}=r,{targetSubUnitId:s}=e,a=this._conditionalFormattingRuleModel.getSubunitRules(n,i);if(!a)return{redos:[],undos:[]};const l=[],c=[];return a.forEach(o=>{const u={unitId:n,subUnitId:s,rule:{...o,cfId:this._conditionalFormattingRuleModel.createCfId(n,s)}};l.push({id:ie.id,params:u}),c.push(I2(this._injector,u))}),{redos:l,undos:c}}return{redos:[],undos:[]}}}))}_initCellChange(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{const e=(r,n,i)=>{const s=new Set;return i.forEach(([a,l])=>{const c=this._conditionalFormattingViewModelV2.getCellCfs(r,n,a,l);c?.forEach(o=>s.add(o.cfId))}),[...s].map(a=>this._conditionalFormattingRuleModel.getRule(r,n,a)).filter(a=>!!a)};switch(t.id){case yr.id:{const r=t.params,{subUnitId:n,unitId:i,cellValue:s}=r,a=[];new le(s).forValue((l,c,o)=>{o&&Object.keys(o).some(u=>["p","v"].includes(u))&&a.push([l,c])}),e(i,n,a).forEach(l=>{this._conditionalFormattingViewModelV2.markRuleDirty(i,n,l.cfId)});break}case xr.id:case wr.id:{const r=t.params,n=re(this._univerInstanceService,r);if(!n)return;const{worksheet:i,unitId:s,subUnitId:a}=n,{range:l}=r,c={...l,endColumn:i.getColumnCount()-1},o=this._conditionalFormattingRuleModel.getSubunitRules(s,a);o&&o.filter(u=>u.ranges.some(d=>ce.intersects(d,c))).forEach(u=>{this._conditionalFormattingViewModelV2.markRuleDirty(s,a,u.cfId)});break}case pr.id:case Cr.id:{const r=t.params,n=re(this._univerInstanceService,r);if(!n)return;const{worksheet:i,unitId:s,subUnitId:a}=n,{range:l}=r,c={...l,endRow:i.getRowCount()-1},o=this._conditionalFormattingRuleModel.getSubunitRules(s,a);o&&o.filter(u=>u.ranges.some(d=>ce.intersects(d,c))).forEach(u=>{this._conditionalFormattingViewModelV2.markRuleDirty(s,a,u.cfId)});break}case vr.id:{const r=t.params,n=re(this._univerInstanceService,r);if(!n)return;const{worksheet:i,unitId:s,subUnitId:a}=n,{sourceRange:l,targetRange:c}=r,o={startRow:Math.min(l.startRow,c.startRow),endRow:i.getRowCount()-1,startColumn:0,endColumn:i.getColumnCount()-1},u=this._conditionalFormattingRuleModel.getSubunitRules(s,a);u&&u.filter(d=>d.ranges.some(g=>ce.intersects(g,o))).forEach(d=>{this._conditionalFormattingViewModelV2.markRuleDirty(s,a,d.cfId)});break}case fr.id:{const r=t.params,n=re(this._univerInstanceService,r);if(!n)return;const{worksheet:i,unitId:s,subUnitId:a}=n,{sourceRange:l,targetRange:c}=r,o={startRow:0,endRow:i.getRowCount()-1,startColumn:Math.min(l.startColumn,c.startColumn),endColumn:i.getColumnCount()-1},u=this._conditionalFormattingRuleModel.getSubunitRules(s,a);u&&u.filter(d=>d.ranges.some(g=>ce.intersects(g,o))).forEach(d=>{this._conditionalFormattingViewModelV2.markRuleDirty(s,a,d.cfId)});break}case mr.id:{const{unitId:r,to:n,from:i}=t.params,s=a=>{const l=[];new le(a.value).forValue((c,o)=>{l.push([c,o])}),e(r,a.subUnitId,l).forEach(c=>{this._conditionalFormattingViewModelV2.markRuleDirty(r,a.subUnitId,c.cfId)})};s(n),s(i);break}case gr.id:{const{range:r,unitId:n,subUnitId:i}=t.params,s=this._conditionalFormattingRuleModel.getSubunitRules(n,i);s&&s.filter(a=>a.ranges.some(l=>ce.intersects(l,r))).forEach(a=>{this._conditionalFormattingViewModelV2.markRuleDirty(n,i,a.cfId)});break}}}))}};$e=$n([e2(0,j(P)),e2(1,j(we)),e2(2,j(q)),e2(3,j(ir)),e2(4,j(tt)),e2(5,j(Y))],$e);var Pn=Object.defineProperty,qn=(t,e,r)=>e in t?Pn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hn=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},mt=(t,e)=>(r,n)=>e(r,n,t),E0=(t,e,r)=>qn(t,typeof e!="symbol"?e+"":e,r);let He=class extends bt{constructor(t=Pt,e,r,n){super(),this._config=t,this._injector=e,this._commandService=r,this._configService=n;const{...i}=et({},Pt,this._config);this._configService.setConfig(On,i),[[$e],[s2],[P],[be]].forEach(s=>{this._injector.add(s)}),[F2,St,it,p2,st,at,ie,he,pe,qe].forEach(s=>{this._commandService.registerCommand(s)})}onStarting(){this._injector.get($e),U2(this._injector,[[$e],[be]])}};E0(He,"pluginName",Ge);E0(He,"type",$.UNIVER_SHEET);He=Hn([Et(Or),mt(1,j(we)),mt(2,j(Y)),mt(3,It)],He);const Wn="sheet-conditional-rule-icon",Zn=35,I0=15,F0=2,Gn=t=>{const{startRow:e,endRow:r,startColumn:n,endColumn:i}=t;return`${e}-${r}-${n}-${i}`};class zn extends v0{constructor(){super(),G(this,"_paddingRightAndLeft",F0),G(this,"_width",I0),G(this,"_imageMap",new Map),G(this,"uKey",Wn),G(this,"Z_INDEX",Zn),G(this,"_radius",1),this._init()}draw(e,r,n,i){const{worksheet:s}=n;if(!s)return!1;const a=new Set;e.save(),ne.foreach(n.rowColumnSegment,(l,c)=>{if(!s.getRowVisible(l)||!s.getColVisible(c))return;const o=n.getCellWithCoordByIndex(l,c,!1),{isMerged:u,isMergedMainCell:d,mergeInfo:g}=o;let m=s.getCell(l,c);if(u&&(m=s.getCell(g.startRow,g.startColumn)),!(m!=null&&m.iconSet))return;const{iconType:f,iconId:w}=m.iconSet;if(f===f2)return;const x=this._imageMap.get(this._createKey(f,w));if(!x||!this.isRenderDiffRangesByCell(g,i))return;if(u||d){const A=Gn(g);if(a.has(A))return;a.add(A)}const{startX:y,endX:R,startY:E,endY:F}=u||d?g:o,C=R-y,D=F-E;if(this._width>D||this._width>C+this._paddingRightAndLeft*2)return;const S=(D-this._width)/2+E;e.drawImage(x,y+this._paddingRightAndLeft,S,this._width,this._width)}),e.restore()}_init(){for(const e in Ce)Ce[e].forEach((r,n)=>{const i=this._createKey(e,String(n)),s=new Image;s.onload=()=>{this._imageMap.set(i,s)},s.src=r})}_createKey(e,r){return`${e}_${r}`}}C0.add(zn);function _0(t){if(typeof t!="object"||t===null)return t;const e={};for(const r in t)if(t.hasOwnProperty(r)){const n=_0(t[r]);n!==void 0&&(e[r]=n)}return e}var Kn=Object.defineProperty,Yn=(t,e,r)=>e in t?Kn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ae=(t,e,r)=>Yn(t,typeof e!="symbol"?e+"":e,r);const S0={type:se.COMMAND,id:"sheet.command.add-average-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i,operator:s}=e,a=t.get(P),l=t.get(Y),c=t.get(q),o=re(c);if(!o)return!1;const{unitId:u,subUnitId:d}=o,g=a.createCfId(u,d),m={ranges:r,cfId:g,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.average,operator:s,style:n}};return l.executeCommand(ie.id,{unitId:u,subUnitId:d,rule:m})}},T0={type:se.COMMAND,id:"sheet.command.add-color-scale-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,config:n,stopIfTrue:i}=e,s=t.get(P),a=t.get(Y),l=t.get(q),c=re(l);if(!c)return!1;const{unitId:o,subUnitId:u}=c,d=s.createCfId(o,u),g={ranges:r,cfId:d,stopIfTrue:!!i,rule:{type:b.colorScale,config:n}};return a.executeCommand(ie.id,{unitId:o,subUnitId:u,rule:g})}},R0={type:se.COMMAND,id:"sheet.command.add-data-bar-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,min:n,max:i,nativeColor:s,positiveColor:a,isGradient:l,stopIfTrue:c,isShowValue:o}=e,u=t.get(P),d=t.get(q),g=re(d);if(!g)return!1;const{unitId:m,subUnitId:f}=g,w=t.get(Y),x=u.createCfId(m,f),y={ranges:r,cfId:x,stopIfTrue:!!c,rule:{type:b.dataBar,isShowValue:o,config:{min:n,max:i,nativeColor:s,positiveColor:a,isGradient:l}}};return w.executeCommand(ie.id,{unitId:m,subUnitId:f,rule:y})}},A0={type:se.COMMAND,id:"sheet.command.add-duplicate-values-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i}=e,s=t.get(P),a=t.get(Y),l=t.get(q),c=re(l);if(!c)return!1;const{unitId:o,subUnitId:u}=c,d=s.createCfId(o,u),g={ranges:r,cfId:d,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.duplicateValues,style:n}};return a.executeCommand(ie.id,{unitId:o,subUnitId:u,rule:g})}},M0={type:se.COMMAND,id:"sheet.command.add-number-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i,operator:s,value:a}=e,l=t.get(P),c=t.get(Y),o=t.get(q),u=re(o);if(!u)return!1;const{unitId:d,subUnitId:g}=u,m=l.createCfId(d,g);let f;if([_.between,_.notBetween].includes(s)){const w=a;if(w.length!==2||!Array.isArray(w))return!1;f={ranges:r,cfId:m,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.number,operator:s,style:n,value:w}}}else{const w=a;if(typeof w!="number")return!1;f={ranges:r,cfId:m,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.number,operator:s,style:n,value:w}}}return c.executeCommand(ie.id,{unitId:d,subUnitId:g,rule:f})}},N0={type:se.COMMAND,id:"sheet.command.add-rank-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i,isPercent:s,isBottom:a,value:l}=e,c=t.get(P),o=t.get(q),u=t.get(Y),d=re(o);if(!d)return!1;const{unitId:g,subUnitId:m}=d,f=c.createCfId(g,m),w={ranges:r,cfId:f,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.rank,isPercent:s,isBottom:a,style:n,value:l}};return u.executeCommand(ie.id,{unitId:g,subUnitId:m,rule:w})}},k0={type:se.COMMAND,id:"sheet.command.add-text-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i,operator:s,value:a}=e,l=t.get(P),c=t.get(q),o=re(c);if(!o)return!1;const{unitId:u,subUnitId:d}=o,g=t.get(Y),m=l.createCfId(u,d),f={ranges:r,cfId:m,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.text,operator:s,style:n,value:a}};return g.executeCommand(ie.id,{unitId:u,subUnitId:d,rule:f})}},U0={type:se.COMMAND,id:"sheet.command.add-time-period-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i,operator:s}=e,a=t.get(P),l=t.get(q),c=t.get(Y),o=re(l);if(!o)return!1;const{unitId:u,subUnitId:d}=o,g=a.createCfId(u,d),m={ranges:r,cfId:g,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.timePeriod,operator:s,style:n}};return c.executeCommand(ie.id,{unitId:u,subUnitId:d,rule:m})}},V0={type:se.COMMAND,id:"sheet.command.add-uniqueValues-conditional-rule",handler(t,e){if(!e)return!1;const{ranges:r,style:n,stopIfTrue:i}=e,s=t.get(P),a=t.get(q),l=t.get(Y),c=re(a);if(!c)return!1;const{unitId:o,subUnitId:u}=c,d=s.createCfId(o,u),g={ranges:r,cfId:d,stopIfTrue:!!i,rule:{type:b.highlightCell,subType:I.uniqueValues,style:n}};return l.executeCommand(ie.id,{unitId:o,subUnitId:u,rule:g})}};function De({ref:t,...e}){const{icon:r,id:n,className:i,extend:s,...a}=e,l=`univerjs-icon univerjs-icon-${n} ${i||""}`.trim(),c=p.useRef(`_${Qn()}`);return L0(r,`${n}`,{defIds:r.defIds,idSuffix:c.current},{ref:t,className:l,...a},s)}function L0(t,e,r,n,i){return p.createElement(t.tag,{key:e,...Xn(t,r,i),...n},(Jn(t,r).children||[]).map((s,a)=>L0(s,`${e}-${t.tag}-${a}`,r,void 0,i)))}function Xn(t,e,r){const n={...t.attrs};r!=null&&r.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=r.colorChannel1),t.tag==="mask"&&n.id&&(n.id=n.id+e.idSuffix),Object.entries(n).forEach(([s,a])=>{s==="mask"&&typeof a=="string"&&(n[s]=a.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))});const{defIds:i}=e;return!i||i.length===0||(t.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+e.idSuffix),Object.entries(n).forEach(([s,a])=>{typeof a=="string"&&(n[s]=a.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))})),n}function Jn(t,e){var r;const{defIds:n}=e;return!n||n.length===0?t:t.tag==="defs"&&(r=t.children)!=null&&r.length?{...t,children:t.children.map(i=>typeof i.attrs.id=="string"&&n&&n.includes(i.attrs.id)?{...i,attrs:{...i.attrs,id:i.attrs.id+e.idSuffix}}:i)}:t}function Qn(){return Math.random().toString(36).substring(2,8)}De.displayName="UniverIcon";const ei={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.65791 1.30005C3.77355 1.30005 3.05664 2.01696 3.05664 2.90132V12.8588C3.05664 13.8755 3.88086 14.6998 4.89759 14.6998H9.1016C11.2233 14.6998 12.9433 12.9798 12.9433 10.8581C12.9433 9.13925 11.8145 7.68407 10.2578 7.1934C10.8806 6.56856 11.2655 5.70659 11.2655 4.75472C11.2655 2.84676 9.71883 1.30005 7.81087 1.30005H4.65791ZM4.25664 2.90132C4.25664 2.6797 4.4363 2.50005 4.65791 2.50005H7.81087C9.05609 2.50005 10.0655 3.5095 10.0655 4.75472C10.0655 5.99993 9.05609 7.00938 7.81087 7.00938H4.25664V2.90132ZM4.25664 12.8588V8.21636H9.1016C10.5606 8.21636 11.7433 9.39909 11.7433 10.8581C11.7433 12.317 10.5606 13.4998 9.1016 13.4998H4.89759C4.5436 13.4998 4.25664 13.2128 4.25664 12.8588Z",fillRule:"evenodd",clipRule:"evenodd"}}]},j0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"bold-icon",ref:e,icon:ei}))});j0.displayName="BoldIcon";const ti={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},L2=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"delete-icon",ref:e,icon:ti}))});L2.displayName="DeleteIcon";const ri={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.6 1.99991C8.60001 1.66854 8.33138 1.39991 8.00001 1.3999C7.66864 1.3999 7.40001 1.66853 7.4 1.9999L7.39996 7.3999H1.9999C1.66853 7.3999 1.3999 7.66853 1.3999 7.9999C1.3999 8.33127 1.66853 8.5999 1.9999 8.5999H7.39995L7.3999 13.9999C7.3999 14.3313 7.66853 14.5999 7.9999 14.5999C8.33127 14.5999 8.5999 14.3313 8.5999 13.9999L8.59995 8.5999H13.9999C14.3313 8.5999 14.5999 8.33127 14.5999 7.9999C14.5999 7.66853 14.3313 7.3999 13.9999 7.3999H8.59996L8.6 1.99991Z"}}]},B0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"increase-icon",ref:e,icon:ri}))});B0.displayName="IncreaseIcon";const ni={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M9.80385 1.40005H11.9997C12.3311 1.40005 12.5997 1.66868 12.5997 2.00005C12.5997 2.33143 12.3311 2.60005 11.9997 2.60005H10.1185L7.12251 13.4001H9.33324C9.66461 13.4001 9.93324 13.6687 9.93324 14.0001C9.93324 14.3314 9.66461 14.6001 9.33324 14.6001H6.34785C6.33847 14.6003 6.32905 14.6003 6.31962 14.6001H3.9999C3.66853 14.6001 3.3999 14.3314 3.3999 14.0001C3.3999 13.6687 3.66853 13.4001 3.9999 13.4001H5.87719L8.87322 2.60005H6.66641C6.33504 2.60005 6.06641 2.33143 6.06641 2.00005C6.06641 1.66868 6.33504 1.40005 6.66641 1.40005H9.52916C9.61698 1.37929 9.71064 1.3781 9.80385 1.40005Z"}}]},O0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"italic-icon",ref:e,icon:ni}))});O0.displayName="ItalicIcon";const ii={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.3536 6.14645C11.5488 6.34171 11.5488 6.65829 11.3536 6.85355L8.35355 9.85355C8.15829 10.0488 7.84171 10.0488 7.64645 9.85355L4.64645 6.85355C4.45118 6.65829 4.45118 6.34171 4.64645 6.14645C4.84171 5.95118 5.15829 5.95118 5.35355 6.14645L8 8.79289L10.6464 6.14645C10.8417 5.95118 11.1583 5.95118 11.3536 6.14645Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Tt=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"more-down-icon",ref:e,icon:ii}))});Tt.displayName="MoreDownIcon";const si={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M6 5C6.55228 5 7 4.55228 7 4C7 3.44772 6.55228 3 6 3C5.44772 3 5 3.44772 5 4C5 4.55228 5.44772 5 6 5Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6 9C6.55228 9 7 8.55229 7 8C7 7.44772 6.55228 7 6 7C5.44772 7 5 7.44772 5 8C5 8.55229 5.44772 9 6 9Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M7 12C7 12.5523 6.55228 13 6 13C5.44772 13 5 12.5523 5 12C5 11.4477 5.44772 11 6 11C6.55228 11 7 11.4477 7 12Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10 5C10.5523 5 11 4.55228 11 4C11 3.44772 10.5523 3 10 3C9.44771 3 9 3.44772 9 4C9 4.55228 9.44771 5 10 5Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11 8C11 8.55229 10.5523 9 10 9C9.44771 9 9 8.55229 9 8C9 7.44772 9.44771 7 10 7C10.5523 7 11 7.44772 11 8Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10 13C10.5523 13 11 12.5523 11 12C11 11.4477 10.5523 11 10 11C9.44771 11 9 11.4477 9 12C9 12.5523 9.44771 13 10 13Z"}}]},$0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"sequence-icon",ref:e,icon:si}))});$0.displayName="SequenceIcon";const ai={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.00033 1.20996C6.43345 1.20996 5.23596 1.88077 4.64804 2.94304C4.06338 3.99943 4.15123 5.32084 4.90099 6.47062C5.08199 6.7482 5.45374 6.82648 5.73131 6.64548C6.00888 6.46448 6.08716 6.09273 5.90616 5.81516C5.36418 4.98402 5.35768 4.13897 5.69797 3.52412C6.035 2.91515 6.78176 2.40996 8.00033 2.40996C9.19423 2.40996 10.0017 2.93409 10.5236 3.46755C10.7871 3.73682 10.9756 4.00712 11.0974 4.20903C11.158 4.30951 11.2013 4.39164 11.2284 4.44625C11.2419 4.47351 11.2514 4.49377 11.2568 4.50588L11.2621 4.51771C11.3901 4.82216 11.7407 4.96686 12.046 4.83992C12.3519 4.71267 12.4968 4.36149 12.3695 4.05552L11.8231 4.28278C12.3695 4.05552 12.3697 4.0558 12.3695 4.05552L12.3691 4.05437L12.3685 4.05298L12.367 4.04953L12.3629 4.03993L12.3498 4.01036C12.3388 3.98619 12.3234 3.95326 12.3033 3.91282C12.2632 3.83203 12.2043 3.72072 12.1249 3.58908C11.9666 3.32674 11.7235 2.97805 11.3814 2.62834C10.6921 1.92381 9.59192 1.20996 8.00033 1.20996Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.11953 8.5999H7.88935C10.1109 9.46549 10.5895 10.7649 10.4268 11.6869C10.2475 12.703 9.26939 13.5898 8.00009 13.5898C6.63323 13.5898 5.77631 13.0502 5.25534 12.528C4.99021 12.2623 4.80823 11.9965 4.69365 11.7993C4.63659 11.7011 4.59698 11.6211 4.5727 11.5686C4.56059 11.5424 4.55236 11.5231 4.54774 11.512L4.54352 11.5016C4.4267 11.193 4.0823 11.0363 3.77279 11.1516C3.46228 11.2673 3.30438 11.6129 3.4201 11.9234L3.9649 11.7203C3.4201 11.9234 3.41998 11.9231 3.4201 11.9234L3.4206 11.9247L3.42118 11.9263L3.42262 11.9301L3.42661 11.9403C3.42977 11.9484 3.43394 11.9588 3.43914 11.9713C3.44956 11.9965 3.46418 12.0304 3.48334 12.0719C3.52161 12.1547 3.57828 12.2682 3.65608 12.4021C3.81124 12.6692 4.0534 13.0223 4.40584 13.3756C5.12 14.0914 6.27196 14.7898 8.00009 14.7898C9.82574 14.7898 11.3236 13.5101 11.6085 11.8955C11.812 10.7422 11.3901 9.55402 10.2665 8.5999H13.8804C14.2117 8.5999 14.4803 8.33127 14.4803 7.9999C14.4803 7.66853 14.2117 7.3999 13.8804 7.3999H8.01411C8.0048 7.39968 7.99551 7.39969 7.98625 7.3999H2.11953C1.78816 7.3999 1.51953 7.66853 1.51953 7.9999C1.51953 8.33127 1.78816 8.5999 2.11953 8.5999Z"}}]},P0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"strikethrough-icon",ref:e,icon:ai}))});P0.displayName="StrikethroughIcon";const li={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.46416 2.03237C4.46416 1.701 4.19553 1.43237 3.86416 1.43237C3.53279 1.43237 3.26416 1.701 3.26416 2.03237V7.33338C3.26416 10.0313 5.35834 12.2667 7.9999 12.2667C10.6415 12.2667 12.7356 10.0313 12.7356 7.33338V2.03237C12.7356 1.701 12.467 1.43237 12.1356 1.43237C11.8043 1.43237 11.5356 1.701 11.5356 2.03237V7.33338C11.5356 9.42194 9.92656 11.0667 7.9999 11.0667C6.07325 11.0667 4.46416 9.42194 4.46416 7.33338V2.03237Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.66641 13.4663C2.33504 13.4663 2.06641 13.7349 2.06641 14.0663C2.06641 14.3977 2.33504 14.6663 2.66641 14.6663H13.3331C13.6644 14.6663 13.9331 14.3977 13.9331 14.0663C13.9331 13.7349 13.6644 13.4663 13.3331 13.4663H2.66641Z"}}]},q0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"underline-icon",ref:e,icon:li}))});q0.displayName="UnderlineIcon";const oi={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.3014 1.70389C9.85268 0.479568 8.12109 0.479557 7.67238 1.70389L4.72235 9.75326C4.60832 10.0644 4.76811 10.4091 5.07924 10.5231C5.39038 10.6371 5.73504 10.4773 5.84907 10.1662L6.99975 7.02646C7.03588 7.03324 7.07314 7.03679 7.11123 7.03679H10.9778L12.1247 10.1662C12.2387 10.4773 12.5834 10.6371 12.8945 10.5231C13.2057 10.4091 13.3654 10.0644 13.2514 9.75326L10.3014 1.70389ZM10.538 5.83679L9.17467 2.11682C9.11057 1.94192 8.8632 1.94192 8.7991 2.11682L7.43576 5.83679H10.538Z",fillRule:"evenodd",clipRule:"evenodd"}}]},H0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"font-color-double-icon",ref:e,icon:oi}))});H0.displayName="FontColorDoubleIcon";const ui={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M8.01281 1.36643C8.79386 0.585377 10.0602 0.585378 10.8412 1.36643L12.9223 3.44752C13.7034 4.22857 13.7034 5.4949 12.9223 6.27595L9.36445 9.83383C8.5834 10.6149 7.31707 10.6149 6.53602 9.83383L4.45493 7.75273C3.67388 6.97168 3.67388 5.70535 4.45493 4.9243L8.01281 1.36643ZM9.9927 2.21495C9.68028 1.90253 9.17375 1.90253 8.86133 2.21495L5.30346 5.77283L5.29671 5.77966L10.839 6.66224L12.0738 5.42742C12.3862 5.115 12.3862 4.60847 12.0738 4.29605L9.9927 2.21495Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.5179 9.48875C14.5179 9.99175 14.1101 10.3995 13.607 10.3995C13.1041 10.3995 12.6963 9.99175 12.6963 9.48875C12.6963 9.1773 13.0455 8.59966 13.3114 8.20487C13.4549 7.99177 13.7591 7.99177 13.9027 8.20486C14.1687 8.59965 14.5179 9.1773 14.5179 9.48875Z"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M1.98682 13.4992C1.98682 12.5603 2.74793 11.7992 3.68682 11.7992H14.2868C15.2257 11.7992 15.9868 12.5603 15.9868 13.4992V13.4992C15.9868 14.4381 15.2257 15.1992 14.2868 15.1992H3.68682C2.74793 15.1992 1.98682 14.4381 1.98682 13.4992V13.4992Z"}}]},W0=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"paint-bucket-double-icon",ref:e,icon:ui}))});W0.displayName="PaintBucketDoubleIcon";const ci={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 17 17",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.27177 13.714L13.5855 2.40025L14.434 3.24878L3.1203 14.5625L2.27177 13.714Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"colorChannel1",d:"M4.2603 1.82495L2.89617 1.82495C2.23343 1.82495 1.69617 2.36221 1.69617 3.02495L1.69617 4.38908L3.02617 4.38908L3.02617 3.15495L4.2603 3.15495L4.2603 1.82495ZM15.0092 4.38908L15.0092 3.02495C15.0092 2.36221 14.4719 1.82495 13.8092 1.82495L12.4451 1.82495L12.4451 3.15495L13.6792 3.15495L13.6792 4.38908L15.0092 4.38908ZM6.98856 1.82495L6.98856 3.15495L9.71681 3.15495L9.71681 1.82495L6.98856 1.82495ZM15.0092 7.11734L13.6792 7.11734L13.6792 9.84559L15.0092 9.84559L15.0092 7.11734ZM15.0092 12.5739L13.6792 12.5739L13.6792 13.808L12.4451 13.808L12.4451 15.138L13.8092 15.138C14.4719 15.138 15.0092 14.6007 15.0092 13.938L15.0092 12.5739ZM9.71681 15.138L9.71681 13.808L6.98856 13.808L6.98856 15.138L9.71681 15.138ZM4.2603 15.138L4.2603 13.808L3.02617 13.808L3.02617 12.5739L1.69617 12.5739L1.69617 13.938C1.69617 14.6007 2.23343 15.138 2.89617 15.138L4.2603 15.138ZM1.69617 9.8456L3.02617 9.8456L3.02617 7.11734L1.69617 7.11734L1.69617 9.8456Z",fillRule:"evenodd",clipRule:"evenodd"}}]},_2=p.forwardRef(function(t,e){return p.createElement(De,Object.assign({},t,{id:"slash-double-icon",ref:e,icon:ci}))});_2.displayName="SlashDoubleIcon";const Pe=t=>{const{color:e,onChange:r,disable:n=!1,Icon:i=W0,className:s}=t,a=p.useMemo(()=>new Ee(e),[e]),l=()=>{const c={className:ae("univer-fill-primary-600",n&&s),extend:{colorChannel1:a.isValid?e:""}};return h.jsx(i,{...c})};return n?l():h.jsx(_t,{overlay:h.jsx("div",{className:"univer-rounded-lg univer-p-4",children:h.jsx(rn,{value:e,onChange:r})}),children:h.jsx("span",{className:ae("univer-flex univer-cursor-pointer univer-items-center univer-rounded univer-p-1 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",s),children:l()})})},o2=t=>{var e,r,n,i,s;const a=t.rule;if(!a)return null;const l=p.useMemo(()=>{if(a.type===b.colorScale){const u=a.config.map((g,m)=>({color:new Ee(g.color),value:m})),d=u.length-1;return new Array(5).fill("").map((g,m,f)=>m*d/(f.length-1)).map(g=>D0(u,g))}return null},[a]),c=p.useMemo(()=>{if(a.type===b.iconSet)return a.config.map(u=>{const d=Ce[u.iconType];return d&&d[Number(u.iconId)]})},[a]),o="univer-pointer-events-none univer-flex univer-h-5 univer-min-w-[72px] univer-items-center univer-justify-center univer-text-xs";switch(a.type){case b.dataBar:{const{isGradient:u}=a.config,d=u?`linear-gradient(to right, ${a.config.positiveColor||Be}, rgb(255 255 255))`:a.config.positiveColor,g=u?`linear-gradient(to right,  rgb(255 255 255),${a.config.nativeColor||Oe})`:a.config.nativeColor;return h.jsxs("div",{className:o,children:[h.jsx("div",{className:"univer-h-full univer-w-1/2 univer-border univer-border-solid",style:{background:g,borderColor:(e=a.config.nativeColor)!=null?e:Oe}}),h.jsx("div",{className:"univer-h-full univer-w-1/2 univer-border univer-border-solid",style:{background:d,borderColor:(r=a.config.positiveColor)!=null?r:Be}})]})}case b.colorScale:return l&&h.jsx("div",{className:o,children:l.map((u,d)=>h.jsx("div",{className:"univer-h-full",style:{width:`${100/l.length}%`,background:u}},d))});case b.iconSet:return c&&h.jsx("div",{className:o,children:c.map((u,d)=>u?h.jsx("img",{className:"univer-h-full",src:u,draggable:!1},d):h.jsx(_2,{},d))});case b.highlightCell:{const{ul:u,st:d,it:g,bl:m,bg:f,cl:w}=a.style,x=u?.s===Q.TRUE,y=d?.s===Q.TRUE,R=g===Q.TRUE,E=m===Q.TRUE,F=(n=f?.rgb)!=null?n:cn,C=(i=w?.rgb)!=null?i:dn,D={textDecoration:(s=`${x?"underline":""} ${y?"line-through":""}`.replace(/^ /,""))!=null?s:void 0,backgroundColor:F,color:C};return h.jsx("div",{className:ae(o,{"univer-font-bold":E,"univer-italic":R}),style:D,children:"123"})}}},S2=ae("univer-mt-5 univer-px-1 univer-py-2 univer-rounded",Ze),Ue=(t,e)=>({label:e.t(`sheet.cf.valueType.${t}`),value:t}),ft=t=>{var e;const{type:r,className:n,onChange:i,id:s,value:a}=t,l=K(q),c=l.getCurrentUnitForType($.UNIVER_SHEET).getUnitId(),o=(e=l.getCurrentUnitForType($.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId(),u=p.useMemo(()=>String(a).startsWith("=")?String(a):"=",[a]),d=p.useMemo(()=>[M.max,M.min,"none"].includes(r)?{disabled:!0}:[M.percent,M.percentile].includes(r)?{min:0,max:100}:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},[r]),g=p.useRef(null),[m,f]=p.useState(!1);return rt(w=>{var x;(x=g.current)!=null&&x.isClickOutSide(w)&&f(!1)}),r===M.formula?h.jsx("div",{className:"univer-ml-1 univer-w-full",children:h.jsx(nt,{ref:g,className:ae("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent",Ze),initValue:u,unitId:c,subUnitId:o,isFocus:m,onChange:(w="")=>{i(w||"")},onFocus:()=>f(!0)})}):h.jsx(Le,{className:n,value:Number(t.value)||0,onChange:w=>t.onChange(w||0),...d})},di=t=>{var e;const{interceptorManager:r}=t,n=K(fe),i=((e=t.rule)==null?void 0:e.type)===b.colorScale?t.rule:void 0,s=[Ue(M.num,n),Ue(M.percent,n),Ue(M.percentile,n),Ue(M.formula,n)],a=[Ue(M.min,n),...s],l=[Ue("none",n),...s],c=[Ue(M.max,n),...s],[o,u]=p.useState(()=>{var v;const N=M.min;return i&&((v=i.config[0])==null?void 0:v.value.type)||N}),[d,g]=p.useState(()=>{var v;const N="none";return!i||i.config.length!==3?N:((v=i.config[1])==null?void 0:v.value.type)||N}),[m,f]=p.useState(()=>{var v;const N=M.max;return i&&((v=i.config[i.config.length-1])==null?void 0:v.value.type)||N}),[w,x]=p.useState(()=>{if(!i)return 10;const v=i.config[0];return v?.value.value===void 0?10:v?.value.value}),[y,R]=p.useState(()=>{var v;if(!i||i.config.length!==3)return 50;const N=(v=i.config[1])==null?void 0:v.value.value;return N===void 0?50:N}),[E,F]=p.useState(()=>{var v;if(!i)return 90;const N=(v=i.config[i.config.length-1])==null?void 0:v.value.value;return N===void 0?90:N}),[C,D]=p.useState(()=>{var v;return i&&((v=i.config[0])==null?void 0:v.color)||"#d0d9fb"}),[S,A]=p.useState(()=>{var v;const N="#7790f3";return!i||i.config.length!==3?N:((v=i.config[1])==null?void 0:v.color)||N}),[U,k]=p.useState(()=>{var v;return i&&((v=i.config[i.config.length-1])==null?void 0:v.color)||"#2e55ef"}),V=p.useMemo(()=>v=>{const{minType:N,medianType:xe,maxType:Ke,minValue:Ye,medianValue:Se,maxValue:Xe,minColor:Je,medianColor:O,maxColor:W}=v,H=[];return H.push({color:Je,value:{type:N,value:Ye}}),xe!=="none"&&H.push({color:O,value:{type:xe,value:Se}}),H.push({color:W,value:{type:Ke,value:Xe}}),{config:H.map((X,oe)=>({...X,index:oe})),type:b.colorScale}},[]);p.useEffect(()=>r.intercept(r.getInterceptPoints().submit,{handler(){return V({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:E,minColor:C,medianColor:S,maxColor:U})}}),[V,o,d,m,w,y,E,C,S,U,r]);const L=v=>{t.onChange(V(v))};return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.panel.styleRule")}),h.jsx("div",{className:S2,children:h.jsx(o2,{rule:V({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:E,minColor:C,medianColor:S,maxColor:U})})}),h.jsx("div",{className:"univer-mt-3 univer-text-xs univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.valueType.min")}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-h-8 univer-items-center",children:[h.jsx(ye,{className:"univer-flex-shrink-0",options:a,value:o,onChange:v=>{u(v);const N=m2(v,10);x(N),L({minType:v,medianType:d,maxType:m,minValue:N,medianValue:y,maxValue:E,minColor:C,medianColor:S,maxColor:U})}}),h.jsx(ft,{id:"min",className:"univer-ml-1",value:w,type:o,onChange:v=>{x(v),L({minType:o,medianType:d,maxType:m,minValue:v,medianValue:y,maxValue:E,minColor:C,medianColor:S,maxColor:U})}}),h.jsx(Pe,{className:"univer-ml-1",color:C,onChange:v=>{D(v),L({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:E,minColor:v,medianColor:S,maxColor:U})}})]}),h.jsx("div",{className:"univer-text-gray-600dark:!univer-text-gray-200 univer-mt-3 univer-text-xs",children:n.t("sheet.cf.panel.medianValue")}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-h-8 univer-items-center",children:[h.jsx(ye,{className:"univer-flex-shrink-0",options:l,value:d,onChange:v=>{g(v);const N=m2(v,50);R(N),L({minType:o,medianType:v,maxType:m,minValue:w,medianValue:N,maxValue:E,minColor:C,medianColor:S,maxColor:U})}}),h.jsx(ft,{id:"median",className:"univer-ml-1",value:y,type:d,onChange:v=>{R(v),L({minType:o,medianType:d,maxType:m,minValue:w,medianValue:v,maxValue:E,minColor:C,medianColor:S,maxColor:U})}}),d!=="none"&&h.jsx(Pe,{className:"univer-ml-1",color:S,onChange:v=>{A(v),L({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:E,minColor:C,medianColor:v,maxColor:U})}})]}),h.jsx("div",{className:"univer-mt-3 univer-text-xs univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.valueType.max")}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-h-8 univer-items-center",children:[h.jsx(ye,{className:"univer-flex-shrink-0",options:c,value:m,onChange:v=>{f(v);const N=m2(v,90);F(N),L({minType:o,medianType:d,maxType:v,minValue:w,medianValue:y,maxValue:N,minColor:C,medianColor:S,maxColor:U})}}),h.jsx(ft,{id:"max",className:"univer-ml-1",value:E,type:m,onChange:v=>{F(v),L({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:v,minColor:C,medianColor:S,maxColor:U})}}),h.jsx(Pe,{className:"univer-ml-1",color:U,onChange:v=>{k(v),L({minType:o,medianType:d,maxType:m,minValue:w,medianValue:y,maxValue:E,minColor:C,medianColor:S,maxColor:v})}})]})]})},t2=(t,e)=>({label:e.t(`sheet.cf.valueType.${t}`),value:t}),qt=t=>{var e;const{onChange:r,className:n,value:i,type:s,id:a,disabled:l=!1}=t,c=K(q),o=c.getCurrentUnitOfType($.UNIVER_SHEET).getUnitId(),u=(e=c.getCurrentUnitOfType($.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId(),d=p.useRef(null),[g,m]=p.useState(!1);rt(x=>{var y;(y=d.current)!=null&&y.isClickOutSide(x)&&m(!1)});const f=p.useRef(i),w=p.useMemo(()=>[M.percentile,M.percent].includes(s)?{max:100,min:0}:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},[s]);if(s===M.formula){const x=String(f.current).startsWith("=")?String(f.current)||"":"=";return h.jsx("div",{className:"univer-ml-3 univer-w-full",children:h.jsx(nt,{ref:d,className:ae("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent",Ze),initValue:x,unitId:o,subUnitId:u,isFocus:g,onChange:(y="")=>{r(y||"")},onFocus:()=>m(!0)})})}return h.jsx(Le,{className:n,value:Number(i)||0,disabled:l,onChange:x=>{r(x||0)},...w})},hi=t=>{var e;const{interceptorManager:r}=t,n=K(fe),i=((e=t.rule)==null?void 0:e.type)===b.dataBar?t.rule:void 0,[s,a]=p.useState(()=>{var v;return i&&(v=i.config)!=null&&v.isGradient?"1":"0"}),[l,c]=p.useState(()=>{var v;return i&&((v=i.config)==null?void 0:v.positiveColor)||Be}),[o,u]=p.useState(()=>{var v;return i&&((v=i.config)==null?void 0:v.nativeColor)||Oe}),d=[t2(M.num,n),t2(M.percent,n),t2(M.percentile,n),t2(M.formula,n)],g=[t2(M.min,n),...d],m=[t2(M.max,n),...d],[f,w]=p.useState(()=>{var v;const N=g[0].value;return i&&((v=i.config)==null?void 0:v.min.type)||N}),[x,y]=p.useState(()=>{var v;const N=m[0].value;return i&&((v=i.config)==null?void 0:v.max.type)||N}),[R,E]=p.useState(()=>{var v;if(!i)return 0;const N=((v=i.config)==null?void 0:v.min)||{};return N.type===M.formula?N.value||"=":N.value||0}),[F,C]=p.useState(()=>{var v;if(!i)return 100;const N=((v=i.config)==null?void 0:v.max)||{};return N.type===M.formula?N.value||"=":N.value===void 0?100:N.value}),[D,S]=p.useState(()=>i?i.isShowValue===void 0?!0:!!i.isShowValue:!0),A=v=>({config:{min:{type:v.minValueType,value:v.minValue},max:{type:v.maxValueType,value:v.maxValue},isGradient:v.isGradient==="1",positiveColor:v.positiveColor||Be,nativeColor:v.nativeColor||Oe},type:b.dataBar,isShowValue:v.isShowValue});p.useEffect(()=>r.intercept(r.getInterceptPoints().submit,{handler(){return A({isGradient:s,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})}}),[s,R,f,F,x,l,o,r,D]);const U=v=>{t.onChange(A(v))},k=v=>{c(v),U({isGradient:s,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:v,nativeColor:o,isShowValue:D})},V=v=>{u(v),U({isGradient:s,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:v,isShowValue:D})},L=v=>d.map(N=>N.value).includes(v);return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.panel.styleRule")}),h.jsx("div",{className:S2,children:h.jsx(o2,{rule:A({isGradient:s,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})})}),h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.panel.fillType")}),h.jsxs("div",{className:"univer-ml-1 univer-mt-3 univer-flex univer-items-center",children:[h.jsxs(en,{value:s,onChange:v=>{a(v),U({isGradient:v,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})},children:[h.jsx(Ot,{value:"0",children:h.jsx("span",{className:"univer-text-xs",children:n.t("sheet.cf.panel.pureColor")})}),h.jsx(Ot,{value:"1",children:h.jsx("span",{className:"univer-text-xs",children:n.t("sheet.cf.panel.gradient")})})]}),h.jsxs("div",{className:"univer-ml-6 univer-flex univer-items-center univer-text-xs",children:[h.jsx($2,{checked:!D,onChange:v=>{S(!v),U({isGradient:v,minValue:R,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:!v})}}),n.t("sheet.cf.panel.onlyShowDataBar")]})]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.panel.colorSet")}),h.jsxs("div",{className:"univer-ml-1 univer-mt-3 univer-flex univer-items-center",children:[h.jsxs("div",{className:"univer-flex univer-items-center",children:[h.jsx("div",{className:"univer-text-xs",children:n.t("sheet.cf.panel.native")}),h.jsx(Pe,{color:o,onChange:V})]}),h.jsxs("div",{className:"univer-ml-3 univer-flex univer-items-center",children:[h.jsx("div",{className:"univer-text-xs",children:n.t("sheet.cf.panel.positive")}),h.jsx(Pe,{color:l,onChange:k})]})]})]}),h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.valueType.min")}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center",children:[h.jsx(ye,{className:"univer-w-1/2 univer-flex-shrink-0",options:g,value:f,onChange:v=>{w(v);const N=m2(v,10);E(N),U({isGradient:s,minValue:N,minValueType:v,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})}}),h.jsx(qt,{id:"min",className:"univer-ml-3",disabled:!L(f),type:f,value:R,onChange:v=>{E(v||0),U({isGradient:s,minValue:v||0,minValueType:f,maxValue:F,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})}})]}),h.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:n.t("sheet.cf.valueType.max")}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center",children:[h.jsx(ye,{className:"univer-w-1/2 univer-flex-shrink-0",options:m,value:x,onChange:v=>{y(v);const N=m2(v,90);C(N),U({isGradient:s,minValue:R,minValueType:f,maxValue:N,maxValueType:v,positiveColor:l,nativeColor:o,isShowValue:D})}}),h.jsx(qt,{className:"univer-ml-3",disabled:!L(x),id:"max",type:x,value:F,onChange:v=>{C(v||0),U({isGradient:s,minValue:R,minValueType:f,maxValue:v||0,maxValueType:x,positiveColor:l,nativeColor:o,isShowValue:D})}})]})]})]})},A2=t=>[Q.FALSE,void 0].includes(t)?Q.TRUE:Q.FALSE,M2=t=>t!==Q.FALSE,Rt=t=>{const{style:e,onChange:r,className:n}=t,[i,s]=p.useState(()=>{if(e!=null&&e.bl)return e.bl}),[a,l]=p.useState(()=>{if(e!=null&&e.it)return e.it}),[c,o]=p.useState(()=>{if(e!=null&&e.ul)return e.ul.s}),[u,d]=p.useState(()=>{if(e!=null&&e.st)return e.st.s}),[g,m]=p.useState(()=>{var y;return(y=e?.cl)!=null&&y.rgb?e.cl.rgb:"#2f56ef"}),[f,w]=p.useState(()=>{var y;return(y=e?.bg)!=null&&y.rgb?e.bg.rgb:"#e8ecfc"});p.useEffect(()=>{const y={bl:i,it:a};g!==void 0&&(y.cl={rgb:g}),f!==void 0&&(y.bg={rgb:f}),u!==void 0&&(y.st={s:u}),c!==void 0&&(y.ul={s:c}),r(_0(y))},[i,a,c,u,g,f]);const x="univer-flex univer-cursor-pointer univer-items-center univer-rounded univer-px-1";return h.jsxs("div",{className:ae("univer-my-2.5 univer-flex univer-justify-between",n),children:[h.jsx("div",{className:ae(x,{"univer-bg-gray-100 dark:!univer-bg-gray-700":M2(i||Q.FALSE)}),onClick:()=>s(A2(i)),children:h.jsx(j0,{})}),h.jsx("div",{className:ae(x,{"univer-bg-gray-100 dark:!univer-bg-gray-700":M2(a||Q.FALSE)}),onClick:()=>l(A2(a)),children:h.jsx(O0,{})}),h.jsx("div",{className:ae(x,{"univer-bg-gray-100 dark:!univer-bg-gray-700":M2(c||Q.FALSE)}),onClick:()=>o(A2(c)),children:h.jsx(q0,{})}),h.jsx("div",{className:ae(x,{"univer-bg-gray-100 dark:!univer-bg-gray-700":M2(u||Q.FALSE)}),onClick:()=>d(A2(u)),children:h.jsx(P0,{})}),h.jsx(Pe,{color:g,onChange:m,Icon:H0}),h.jsx(Pe,{color:f,onChange:w})]})},gi=t=>{var e;const{onChange:r,interceptorManager:n}=t,i=K(fe),s=K(q).getCurrentUnitForType($.UNIVER_SHEET),a=s.getActiveSheet(),l=((e=t.rule)==null?void 0:e.type)===b.highlightCell?t.rule:void 0,c=p.useRef(null),[o,u]=p.useState(!1),d=p.useRef(null),[g,m]=p.useState({}),[f,w]=p.useState(()=>l?.subType===I.formula?l.value:"="),[x,y]=p.useState(void 0),R=F=>({style:F.style,value:f,type:b.highlightCell,subType:I.formula});p.useEffect(()=>n.intercept(n.getInterceptPoints().submit,{handler(){return R({style:g})}}),[g,f,n]),p.useEffect(()=>n.intercept(n.getInterceptPoints().beforeSubmit,{handler:(F,C,D)=>x||f.length===1||!f.startsWith("=")?(y(i.t("sheet.cf.errorMessage.formulaError")),!1):D(F)}),[x,f]);const E=F=>{r(R(F))};return rt(F=>{var C;(C=d.current)!=null&&C.isClickOutSide(F)&&u(!1)}),h.jsxs("div",{ref:c,children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.cf.panel.styleRule")}),h.jsx("div",{className:"univer-mt-3",children:h.jsx(nt,{ref:d,className:ae("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent",Ze),errorText:x,isFocus:o,initValue:f,unitId:s.getUnitId(),subUnitId:a?.getSheetId(),onFocus:()=>{u(!0)},onChange:F=>{w(F),E({style:g})},onVerify:(F,C)=>{!F||C.length===1?y(i.t("sheet.cf.errorMessage.formulaError")):y(void 0)}})}),h.jsx("div",{className:S2,children:h.jsx(o2,{rule:R({style:g})})}),h.jsx(Rt,{style:l?.style,className:"univer-mt-3",onChange:F=>{m(F),E({style:F})}})]})},N2=t=>h.jsxs("div",{className:"univer-relative",children:[h.jsx("div",{className:"univer-absolute univer-bottom-[-13px] univer-z-[999] univer-text-[10px] univer-text-red-500",children:t.errorText}),t.children]}),z=(t,e)=>({label:e.t(`sheet.cf.operator.${t}`),value:t}),mi=t=>{const{type:e,operator:r,onChange:n,value:i,interceptorManager:s}=t,a=K(fe),[l,c]=p.useState(()=>typeof i=="number"?i:0),[o,u]=p.useState(""),[d,g]=p.useState(()=>typeof i=="string"?i:""),[m,f]=p.useState(""),[w,x]=p.useState(()=>Array.isArray(i)?i[0]===void 0?0:i[0]:0),[y,R]=p.useState(""),[E,F]=p.useState(()=>Array.isArray(i)?i[1]===void 0?100:i[1]:100),[C,D]=p.useState("");switch(p.useEffect(()=>{switch(e){case I.text:{[B.beginsWith,B.endsWith,B.containsText,B.notContainsText,B.equal,B.notEqual].includes(r)&&n(d);break}case I.number:{[_.equal,_.notEqual,_.greaterThan,_.greaterThanOrEqual,_.lessThan,_.lessThanOrEqual].includes(r)&&n(l),[_.between,_.notBetween].includes(r)&&n([w,E]);break}}},[e]),p.useEffect(()=>{const S=s.intercept(s.getInterceptPoints().beforeSubmit,{handler:(A,U,k)=>{switch(e){case I.text:if([B.beginsWith,B.containsText,B.endsWith,B.notEqual,B.notContainsText,B.equal].includes(r))return d?k(A):(f(a.t("sheet.cf.errorMessage.notBlank")),!1)}return k(A)}});return()=>{S()}},[e,l,d,r]),e){case I.text:{if([B.beginsWith,B.endsWith,B.containsText,B.notContainsText,B.equal,B.notEqual].includes(r)){const S=A=>{g(A),n(A)};return h.jsx("div",{className:"univer-mt-3",children:h.jsx(N2,{errorText:m,children:h.jsx(tn,{value:d,onChange:A=>{f(""),S(A)}})})})}break}case I.number:{if([_.equal,_.notEqual,_.greaterThan,_.greaterThanOrEqual,_.lessThan,_.lessThanOrEqual].includes(r)){const S=A=>{c(A||0),n(A||0),u("")};return h.jsx("div",{className:"univer-mt-3",children:h.jsx(N2,{errorText:o,children:h.jsx(Le,{className:"univer-w-full",min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,value:l,onChange:S})})})}if([_.between,_.notBetween].includes(r)){const S=U=>{x(U||0),n([U||0,E]),R("")},A=U=>{F(U||0),n([w,U||0]),D("")};return h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center",children:[h.jsx(N2,{errorText:y,children:h.jsx(Le,{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,value:w,onChange:S})}),h.jsx(N2,{errorText:C,children:h.jsx(Le,{className:"univer-ml-3",min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,value:E,onChange:A})})]})}}}return null},Ht=(t,e)=>{switch(t){case I.text:return[z(B.containsText,e),z(B.notContainsText,e),z(B.beginsWith,e),z(B.endsWith,e),z(B.equal,e),z(B.notEqual,e),z(B.containsBlanks,e),z(B.notContainsBlanks,e),z(B.containsErrors,e),z(B.notContainsErrors,e)];case I.number:return[z(_.between,e),z(_.notBetween,e),z(_.equal,e),z(_.notEqual,e),z(_.greaterThan,e),z(_.greaterThanOrEqual,e),z(_.lessThan,e),z(_.lessThanOrEqual,e)];case I.timePeriod:return[z(J.yesterday,e),z(J.today,e),z(J.tomorrow,e),z(J.last7Days,e),z(J.lastWeek,e),z(J.thisWeek,e),z(J.nextWeek,e),z(J.lastMonth,e),z(J.thisMonth,e),z(J.nextMonth,e)]}},Wt=t=>{var e;const{interceptorManager:r,onChange:n}=t,i=K(fe),s=((e=t.rule)==null?void 0:e.type)===b.highlightCell?t.rule:void 0,[a,l]=p.useState(()=>{const C=I.text;return s&&s.subType||C}),c=[{value:I.text,label:i.t("sheet.cf.subRuleType.text")},{value:I.number,label:i.t("sheet.cf.subRuleType.number")},{value:I.timePeriod,label:i.t("sheet.cf.subRuleType.timePeriod")},{value:I.duplicateValues,label:i.t("sheet.cf.subRuleType.duplicateValues")},{value:I.uniqueValues,label:i.t("sheet.cf.subRuleType.uniqueValues")}],o=p.useMemo(()=>Ht(a,i),[a]),[u,d]=p.useState(()=>{const C=o?o[0].value:void 0;return s&&s.operator||C}),[g,m]=p.useState(()=>{var C;return s?(C=s.value)!=null?C:P2(s.subType,s.operator):""}),[f,w]=p.useState({}),x=p.useMemo(()=>C=>{var D,S,A,U,k,V,L,v,N,xe,Ke,Ye,Se,Xe,Je;switch(C.subType||a){case I.text:{if([B.beginsWith,B.endsWith,B.containsText,B.notContainsText,B.equal,B.notEqual].includes(u))return{type:b.highlightCell,subType:(D=C.subType)!=null?D:a,operator:(S=C.operator)!=null?S:u,style:(A=C.style)!=null?A:f,value:(U=C.value)!=null?U:g};break}case I.number:{if([_.equal,_.notEqual,_.greaterThan,_.greaterThanOrEqual,_.lessThan,_.lessThanOrEqual].includes(u))return{type:b.highlightCell,subType:(k=C.subType)!=null?k:a,operator:(V=C.operator)!=null?V:u,style:(L=C.style)!=null?L:f,value:(v=C.value)!=null?v:g};if([_.between,_.notBetween].includes(u))return{type:b.highlightCell,subType:(N=C.subType)!=null?N:a,operator:(xe=C.operator)!=null?xe:u,style:(Ke=C.style)!=null?Ke:f,value:(Ye=C.value)!=null?Ye:g};break}}return{type:b.highlightCell,subType:(Se=C.subType)!=null?Se:a,operator:(Xe=C.operator)!=null?Xe:u,style:(Je=C.style)!=null?Je:f}},[a,u,g,f]);p.useEffect(()=>r.intercept(r.getInterceptPoints().submit,{handler(){return x({})}}),[x,r]),p.useEffect(()=>{c.some(C=>C.value===a)||l(c[0].value)},[c]);const y=C=>{const D=C,S=Ht(D,i),A=S&&S[0].value;l(D),d(A),A&&m(P2(D,A)),n(x({subType:D,operator:A}))},R=C=>{const D=C;d(D),n(x({operator:D}))},E=C=>{m(C),n(x({value:C}))},F=p.useMemo(()=>`${a}_${u}_${Math.random()}`,[a,u]);return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.cf.panel.styleRule")}),h.jsxs("div",{className:"univer-flex univer-justify-between univer-gap-4",children:[h.jsx(ye,{className:"univer-mt-3 univer-w-full",onChange:y,value:a,options:c}),o?.length&&h.jsx(ye,{className:"univer-mt-3 univer-w-full",onChange:R,value:u||"",options:o})]}),h.jsx(mi,{value:g,interceptorManager:r,type:a,operator:u,rule:s,onChange:E},F),h.jsx("div",{className:S2,children:h.jsx(o2,{rule:x({})})}),h.jsx(Rt,{style:s?.style,className:"univer-ml-1",onChange:C=>{w(C),n(x({style:C}))}})]})},Z0=(t,e)=>(Ce[t]||[])[Number(e)]||"",fi=t=>{var e;const{error:r,type:n,onChange:i}=t,s=K(q),a=s.getCurrentUnitForType($.UNIVER_SHEET).getUnitId(),l=(e=s.getCurrentUnitForType($.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId(),c=p.useRef(null),[o,u]=p.useState(!1);return rt(d=>{var g;(g=c.current)!=null&&g.isClickOutSide(d)&&u(!1)}),h.jsx("div",{className:"univer-relative",children:n!==M.formula?h.jsxs(h.Fragment,{children:[h.jsx(Le,{className:ae({"univer-border-red-500":r}),value:Number(t.value)||0,onChange:d=>i(d??0)}),r&&h.jsx("div",{className:"univer-absolute univer-text-xs univer-text-red-500",children:r})]}):h.jsx("div",{className:"univer-w-full",children:h.jsx(nt,{ref:c,className:ae("univer-box-border univer-h-8 univer-w-full univer-cursor-pointer univer-items-center univer-rounded-lg univer-bg-white univer-pt-2 univer-transition-colors hover:univer-border-primary-600 dark:!univer-bg-gray-700 dark:!univer-text-white [&>div:first-child]:univer-px-2.5 [&>div]:univer-h-5 [&>div]:univer-ring-transparent",Ze),initValue:String(t.value),unitId:a,subUnitId:l,isFocus:o,onChange:(d="")=>{i(d||"")},onFocus:()=>u(!0)})})})},Zt=(t,e,r)=>({operator:_.greaterThan,value:{type:M.num,value:(r.length-1-e)*10},iconType:t,iconId:String(e)}),vi=p.forwardRef((t,e)=>{const{onClick:r}=t,n=K(fe),i=s=>{r(s)};return h.jsx("div",{ref:e,className:"univer-w-80",children:b0.map((s,a)=>h.jsxs("div",{className:"univer-mb-3",children:[h.jsx("div",{className:"univer-mb-1 univer-text-sm",children:n.t(s.title)}),h.jsx("div",{className:"univer-flex univer-flex-wrap",children:s.group.map(l=>h.jsx("div",{className:"univer-mb-1 univer-flex univer-w-1/2 univer-items-center",onClick:()=>{i(l.name)},children:h.jsx("a",{className:"univer-flex univer-cursor-pointer univer-rounded hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",children:l.list.map((c,o)=>h.jsx("img",{className:"univer-size-5",src:c,draggable:!1},o))})},l.name))})]},a))})}),Ci=t=>{const{onClick:e}=t,r=p.useMemo(()=>{const i=[];for(const s in Ce){const a=Ce[s],l=s;a.forEach((c,o)=>{i.push({iconType:l,base64:c,iconId:String(o)})})}return i},[]),n=i=>{e(i.iconType,i.iconId)};return h.jsxs("div",{children:[h.jsxs("div",{className:"univer-mb-2.5 univer-flex univer-cursor-pointer univer-items-center univer-pl-1",onClick:()=>n({iconType:f2,iconId:""}),children:[h.jsx(_2,{className:"univer-size-5"}),h.jsx("span",{className:"univer-ml-2",children:""})]}),h.jsx("div",{className:"univer-flex univer-w-64 univer-flex-wrap",children:r.map(i=>h.jsx("div",{className:"univer-mb-2 univer-mr-2 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",children:h.jsx("img",{className:"univer-size-5",src:i.base64,draggable:!1,onClick:()=>n(i)})},`${i.iconType}_${i.iconId}`))})]})},pi=t=>{const{onChange:e,configList:r,errorMap:n={}}=t,i=K(fe),s=[{label:i.t(`sheet.cf.symbol.${_.greaterThan}`),value:_.greaterThan},{label:i.t(`sheet.cf.symbol.${_.greaterThanOrEqual}`),value:_.greaterThanOrEqual}],a=[{label:i.t(`sheet.cf.valueType.${M.num}`),value:M.num},{label:i.t(`sheet.cf.valueType.${M.percent}`),value:M.percent},{label:i.t(`sheet.cf.valueType.${M.percentile}`),value:M.percentile},{label:i.t(`sheet.cf.valueType.${M.formula}`),value:M.formula}],l=(u,d)=>{e([String(d),"value","value"],u)},c=(u,d)=>{e([String(d),"operator"],u);const g=P2(I.number,u);l(g,d)},o=(u,d)=>{e([String(d),"value","type"],u);const g=r[d],m=P2(I.number,g.operator);l(m,d)};return p.useMemo(()=>r.map((u,d)=>{const g=n[d],m=Z0(u.iconType,u.iconId),f=d===r.length-1,w=d===0,x=r[d-1],y=x?.value.type===M.formula?i.t("sheet.cf.valueType.formula"):x?.value.value,R=(E,F)=>{const C={...u,iconId:F,iconType:E};e([String(d)],C)};return h.jsxs("div",{className:d?"univer-mt-6":"univer-mt-3",children:[h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center univer-justify-between univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:[h.jsxs("div",{className:"univer-w-[45%]",children:[i.t("sheet.cf.iconSet.icon"),d+1]}),h.jsx("div",{className:"univer-w-[45%]",children:h.jsxs(h.Fragment,{children:[!w&&!f&&i.t("sheet.cf.iconSet.rule"),!w&&!f&&h.jsxs("span",{className:"univer-font-medium univer-text-gray-600 dark:!univer-text-gray-200",children:[i.t("sheet.cf.iconSet.when"),i.t(`sheet.cf.symbol.${W2(x.operator)}`),y,f?"":` ${i.t("sheet.cf.iconSet.and")} `]})]})})]}),h.jsxs("div",{className:"univer-mt-3 univer-grid univer-grid-cols-2 univer-gap-4",children:[h.jsx("div",{className:"univer-flex univer-items-center",children:h.jsx(_t,{overlay:h.jsx("div",{className:"univer-rounded-lg univer-p-4",children:h.jsx(Ci,{onClick:R,iconId:u.iconId,iconType:u.iconType})}),children:h.jsxs("div",{className:ae("univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-between univer-rounded-md univer-bg-white univer-px-4 univer-py-2 univer-text-xs univer-text-gray-600 univer-transition-all hover:univer-border-primary-600 dark:!univer-text-gray-200",Ze),children:[m?h.jsx("img",{src:m,className:"univer-size-4",draggable:!1}):h.jsx(_2,{className:"univer-size-4"}),h.jsx(Tt,{})]})})}),f?h.jsxs("div",{className:"univer-mt-0 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:[i.t("sheet.cf.iconSet.rule"),h.jsxs("span",{className:"univer-font-medium",children:[i.t("sheet.cf.iconSet.when"),i.t(`sheet.cf.symbol.${W2(x.operator)}`),y,f?"":` ${i.t("sheet.cf.iconSet.and")} `]})]}):h.jsx(ye,{options:s,value:u.operator,onChange:E=>{c(E,d)}})]}),f?h.jsx("div",{}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"univer-mt-3 univer-grid univer-grid-cols-2 univer-gap-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:[h.jsx("div",{children:i.t("sheet.cf.iconSet.type")}),h.jsx("div",{children:i.t("sheet.cf.iconSet.value")})]}),h.jsxs("div",{className:"univer-mt-3 univer-grid univer-grid-cols-2 univer-gap-4",children:[h.jsx(ye,{options:a,value:u.value.type,onChange:E=>{o(E,d)}}),h.jsx(fi,{id:d,type:u.value.type,error:g,value:u.value.value||"",onChange:E=>{l(E,d)}})]})]})]},d)}),[r,n])},wi=t=>{var e;const{interceptorManager:r}=t,n=((e=t.rule)==null?void 0:e.type)===b.iconSet?t.rule:void 0,i=K(fe),[s,a]=p.useState({}),[l,c]=p.useState(()=>{const C=Object.keys(Ce)[0];if(n&&n.config.length){const D=n.config[0].iconType;if(!n.config.some(S=>S.iconType!==D))return D}return C}),[o,u]=p.useState(()=>{if(n&&n.config.length)return de.deepClone(n?.config);const C=Ce[l]||[];return new Array(C.length).fill("").map((D,S,A)=>S===A.length-1?{operator:_.lessThanOrEqual,value:{type:M.num,value:Number.MAX_SAFE_INTEGER},iconType:l,iconId:String(S)}:Zt(l,S,A))}),[d,g]=p.useState(()=>n?!!n.isShowValue:!0),m=p.useMemo(()=>{const C=o.map(D=>Z0(D.iconType,D.iconId));return h.jsx("div",{className:"univer-flex univer-items-center",children:C.map((D,S)=>D?h.jsx("img",{className:"univer-size-5",src:D},S):h.jsx(_2,{className:"univer-size-5"},S))})},[o]),f=C=>{if(C.reduce((D,S,A)=>D.preType&&!D.result||C.length-1===A?D:S.value.type===M.formula?{preType:M.formula,result:!1}:D.preType?{result:D.preType===S.value.type,preType:S.value.type}:{result:!0,preType:S.value.type},{result:!0,preType:""}).result&&[M.num,M.percent,M.percentile].includes(C[0].value.type)){const D={};return C.forEach((S,A,U)=>{if(A-1<0||A===U.length-1)return;const k=C[A-1],V=W2(k.operator);i2({operator:V,value:k.value.value},S.value.value)||(D[A]=`${i.t(`sheet.cf.form.${V}`,String(k.value.value))} `)}),D}return{}},w=(C,D)=>{or(o,C)!==D&&(ur(o,C,D),u([...o]),a(f(o)))},x=C=>{c(C);const D=Ce[C]||[],S=new Array(D.length).fill("").map((A,U,k)=>Zt(C,U,k));u(S),a(f(S))};p.useEffect(()=>{const C=r.intercept(r.getInterceptPoints().submit,{handler(){return{type:b.iconSet,isShowValue:d,config:o}}});return()=>{C()}},[d,o,r]),p.useEffect(()=>{const C=r.intercept(r.getInterceptPoints().beforeSubmit,{handler(){return Object.keys(s).length===0}});return()=>{C()}},[d,o,r,s]);const y=()=>{const C=o.map(D=>({...D}));o.forEach((D,S)=>{const A=o.length-1-S,U=C[A];D.iconId=U.iconId,D.iconType=U.iconType}),u([...o])},R=K(Kr),[E,F]=p.useState();return Yr(E,R.rootContainerElement),h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600",children:i.t("sheet.cf.panel.styleRule")}),h.jsx("div",{className:"univer-mt-3",children:h.jsx(_t,{overlay:h.jsx("div",{className:"univer-rounded-lg univer-p-4",children:h.jsx(vi,{ref:C=>{!E&&C&&F(C)},iconType:l,onClick:x})}),children:h.jsxs("div",{className:ae("univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-between univer-rounded-md univer-bg-white univer-px-4 univer-py-2 univer-text-xs univer-text-gray-600 univer-transition-all hover:univer-border-primary-600",Ze),children:[m,h.jsx(Tt,{})]})})}),h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center univer-text-xs",children:[h.jsxs("div",{className:"univer-flex univer-items-center univer-text-xs",children:[h.jsx($2,{onChange:y}),i.t("sheet.cf.iconSet.reverseIconOrder")]}),h.jsxs("div",{className:"univer-ml-6 univer-flex univer-items-center univer-text-xs",children:[h.jsx($2,{checked:!d,onChange:C=>{g(!C)}}),i.t("sheet.cf.iconSet.onlyShowIcon")]})]}),h.jsx(pi,{errorMap:s,onChange:w,configList:o})]})},xi=t=>{var e;const{onChange:r,interceptorManager:n}=t,i=K(fe),s=((e=t.rule)==null?void 0:e.type)===b.highlightCell?t.rule:void 0,a=[{label:i.t("sheet.cf.panel.isNotBottom"),value:"isNotBottom"},{label:i.t("sheet.cf.panel.isBottom"),value:"isBottom"},{label:i.t("sheet.cf.panel.greaterThanAverage"),value:"greaterThanAverage"},{label:i.t("sheet.cf.panel.lessThanAverage"),value:"lessThanAverage"}],[l,c]=p.useState(()=>{const y=a[0].value,R=s?.type;if(!s)return y;switch(R){case b.highlightCell:switch(s.subType){case I.average:return[_.greaterThan,_.greaterThanOrEqual].includes(s.operator)?"greaterThanAverage":[_.lessThan,_.lessThanOrEqual].includes(s.operator)?"lessThanAverage":y;case I.rank:return s.isBottom?"isBottom":"isNotBottom"}}return y}),[o,u]=p.useState(()=>{const y=s?.type;if(!s)return 10;switch(y){case b.highlightCell:if(s.subType===I.rank)return s.value||10}return 10}),[d,g]=p.useState(()=>{const y=s?.type;if(!s)return!1;switch(y){case b.highlightCell:if(s.subType===I.rank)return s.isPercent||!1}return!1}),[m,f]=p.useState({}),w=y=>{const{type:R,isPercent:E,value:F,style:C}=y;if(R==="isNotBottom")return{type:b.highlightCell,subType:I.rank,isPercent:E,isBottom:!1,value:F,style:C};if(R==="isBottom")return{type:b.highlightCell,subType:I.rank,isPercent:E,isBottom:!0,value:F,style:C};if(R==="greaterThanAverage")return{type:b.highlightCell,subType:I.average,operator:_.greaterThan,style:C};if(R==="lessThanAverage")return{type:b.highlightCell,subType:I.average,operator:_.lessThan,style:C}};p.useEffect(()=>n.intercept(n.getInterceptPoints().submit,{handler(){return w({type:l,isPercent:d,value:o,style:m})}}),[l,d,o,m,n]);const x=y=>{r(w(y))};return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.cf.panel.styleRule")}),h.jsx(ye,{className:"univer-mt-3 univer-w-full",value:l,options:a,onChange:y=>{c(y),x({type:y,isPercent:d,value:o,style:m})}}),["isNotBottom","isBottom"].includes(l)&&h.jsxs("div",{className:"univer-mt-3 univer-flex univer-items-center",children:[h.jsx(Le,{min:1,max:1e3,value:o,onChange:y=>{const R=y||0;u(R),x({type:l,isPercent:d,value:R,style:m})}}),h.jsxs("div",{className:"univer-ml-3 univer-flex univer-items-center univer-text-xs",children:[h.jsx($2,{checked:d,onChange:y=>{g(!!y),x({type:l,isPercent:!!y,value:o,style:m})}}),i.t("sheet.cf.valueType.percent")]})]}),h.jsx("div",{className:S2,children:h.jsx(o2,{rule:w({type:l,isPercent:d,value:o,style:m})})}),h.jsx(Rt,{style:s?.style,className:"univer-mt-3",onChange:y=>{f(y),x({type:l,isPercent:d,value:o,style:y})}})]})},yi=s0("beforeSubmit"),Di=s0("submit"),Gt=t=>t.getCurrentUnitForType($.UNIVER_SHEET).getUnitId(),zt=t=>{var e;return(e=t.getCurrentUnitForType($.UNIVER_SHEET).getActiveSheet())==null?void 0:e.getSheetId()},bi=t=>{var e,r,n;const i=K(fe),s=K(Y),a=K(q),l=K(P),c=K(We),o=Gt(a),u=zt(a),[d,g]=p.useState(void 0),m=p.useRef((r=(e=t.rule)==null?void 0:e.ranges)!=null?r:[]),f=p.useMemo(()=>{var k,V,L;let v=(k=t.rule)==null?void 0:k.ranges;return v!=null&&v.length||(v=(L=(V=c.getCurrentSelections())==null?void 0:V.map(N=>N.range))!=null?L:[]),m.current=v,v!=null&&v.length?v.map(N=>{const xe=f0(N);return xe==="NaN"?"":xe}).filter(N=>!!N).join(","):""},[t.rule]),w=[{label:i.t("sheet.cf.ruleType.highlightCell"),value:"1"},{label:i.t("sheet.cf.panel.rankAndAverage"),value:"2"},{label:i.t("sheet.cf.ruleType.dataBar"),value:"3"},{label:i.t("sheet.cf.ruleType.colorScale"),value:"4"},{label:i.t("sheet.cf.ruleType.formula"),value:"5"},{label:i.t("sheet.cf.ruleType.iconSet"),value:"6"}],[x,y]=p.useState(()=>{var k,V;const L=(k=t.rule)==null?void 0:k.rule.type,v=w[0].value;if(!L)return v;switch(L){case b.highlightCell:{switch((V=t.rule)==null?void 0:V.rule.subType){case I.number:case I.text:case I.duplicateValues:case I.uniqueValues:case I.timePeriod:return"1";case I.average:case I.rank:return"2";case I.formula:return"5"}break}case b.dataBar:return"3";case b.colorScale:return"4";case b.iconSet:return"6"}return v}),R=p.useRef(void 0),E=p.useMemo(()=>new lr({beforeSubmit:yi,submit:Di}),[]),F=p.useMemo(()=>{switch(x){case"1":return Wt;case"2":return xi;case"3":return hi;case"4":return di;case"5":return gi;case"6":return wi;default:return Wt}},[x]);p.useEffect(()=>{const k=s.onCommandExecuted(V=>{if(V.id===Rr.id){const L=V.params;L.subUnitId===u&&L.unitId===o&&t.onCancel()}V.id===Ft.id&&t.onCancel()});return()=>k.dispose()},[]);const C=k=>{R.current=k},D=k=>{const V=k.split(",").filter(L=>!!L).map(Pr).map(L=>L.range);m.current=V},S=()=>{if(d)return;const k=(()=>{const V=a.getCurrentUnitForType($.UNIVER_SHEET).getActiveSheet();if(!V)throw new Error("No active sheet found");return m.current.map(L=>kr(L,V.getRowCount(),V.getColumnCount())).filter(L=>!(Number.isNaN(L.startRow)||Number.isNaN(L.startColumn)))})();if(E.fetchThroughInterceptors(E.getInterceptPoints().beforeSubmit)(!0,null)){const V=E.fetchThroughInterceptors(E.getInterceptPoints().submit)(null,null);if(V){const L=Gt(a),v=zt(a);if(!L||!v)throw new Error("No active sheet found");let N={};t.rule&&t.rule.cfId?(N={...t.rule,ranges:k,rule:V},s.executeCommand(at.id,{unitId:L,subUnitId:v,rule:N}),t.onCancel()):(N={cfId:l.createCfId(L,v),ranges:k,rule:V,stopIfTrue:!1},s.executeCommand(F2.id,{unitId:L,subUnitId:v,rule:N}),t.onCancel())}}},A=()=>{t.onCancel()},U=(k,V)=>{k?V.length<1?g(i.t("sheet.cf.errorMessage.rangeError")):g(void 0):g(i.t("sheet.cf.errorMessage.rangeError"))};return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.cf.panel.range")}),h.jsxs("div",{className:"univer-mt-4",children:[h.jsx(nn,{unitId:o,subUnitId:u,initialValue:f,onChange:(k,V)=>D(V),onVerify:U}),d&&h.jsx("div",{className:"univer-mt-1 univer-text-xs univer-text-red-500",children:d})]}),h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:i.t("sheet.cf.panel.styleType")}),h.jsx(ye,{className:"univer-mt-4 univer-w-full",value:x,options:w,onChange:k=>y(k)}),h.jsx(F,{interceptorManager:E,rule:(n=t.rule)==null?void 0:n.rule,onChange:C}),h.jsxs("div",{className:"univer-mt-4 univer-flex univer-justify-end",children:[h.jsx(jt,{onClick:A,children:i.t("sheet.cf.panel.cancel")}),h.jsx(jt,{className:"univer-ml-3",variant:"primary",onClick:S,children:i.t("sheet.cf.panel.submit")})]})]})};var Ei=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},Ii=(t,e)=>(r,n)=>e(r,n,t);let a2=class extends ge{constructor(t){super(),Ae(this,"_initLocal",()=>{}),Ae(this,"_findReplaceIndex",e=>{const r=/\{([^}]+)?\}/g,n=[];let i=r.exec(e);for(;i;)n.push({startIndex:i.index,key:Number(i[1]),endIndex:i.index+i[0].length-1}),i=r.exec(e);return n}),this._localeService=t,this._initLocal()}tWithReactNode(t,...e){const r=this._localeService.getLocales(),n=t.split("."),i=r&&this._localeService.resolveKeyPath(r,n);if(typeof i=="string"){const s=[];return this._findReplaceIndex(i).forEach((a,l,c)=>{const o=c[l-1]||{endIndex:-1};if(o.endIndex+1<a.startIndex){const u=i.slice(o.endIndex+1,a.startIndex);u&&s.push(u)}if(e[a.key]&&s.push(e[a.key]),l===c.length-1){const u=i.slice(a.endIndex+1);u&&s.push(u)}}),s}return[]}};a2=Ei([Ii(0,j(fe))],a2);const Fi=(t,e)=>{const r=t.rule;switch(r.type){case b.colorScale:return e.t("sheet.cf.ruleType.colorScale");case b.dataBar:return e.t("sheet.cf.ruleType.dataBar");case b.iconSet:return e.t("sheet.cf.ruleType.iconSet");case b.highlightCell:switch(r.subType){case I.average:{const n=r.operator;return e.t(`sheet.cf.preview.describe.${n}`,e.t("sheet.cf.subRuleType.average"))}case I.duplicateValues:return e.t("sheet.cf.subRuleType.duplicateValues");case I.uniqueValues:return e.t("sheet.cf.subRuleType.uniqueValues");case I.number:{const n=r.operator;return e.t(`sheet.cf.preview.describe.${n}`,...Array.isArray(r.value)?r.value.map(i=>String(i)):[String(r.value||"")])}case I.text:{const n=r.operator;return e.t(`sheet.cf.preview.describe.${n}`,r.value||"")}case I.timePeriod:{const n=r.operator;return e.t(`sheet.cf.preview.describe.${n}`)}case I.rank:return r.isPercent?r.isBottom?e.t("sheet.cf.preview.describe.bottomNPercent",String(r.value)):e.t("sheet.cf.preview.describe.topNPercent",String(r.value)):r.isBottom?e.t("sheet.cf.preview.describe.bottomN",String(r.value)):e.t("sheet.cf.preview.describe.topN",String(r.value));case I.formula:return e.t("sheet.cf.ruleType.formula")}}};let Kt=0;const _i=t=>{const{onClick:e}=t,r=K(P),n=K(q),i=K(We),s=K(Y),a=K(fe),l=K(we),c=K(x0),o=K(a2),u=zr(()=>n.getCurrentTypeOfUnit$($.UNIVER_SHEET),void 0,void 0,[]),d=u.getUnitId(),g=u.getActiveSheet();if(!g)throw new Error("No active sheet found");const m=g.getSheetId(),[f,w]=p.useState([]),[x,y]=p.useState("2"),[R,E]=p.useState(0),[F,C]=p.useState(-1),[D,S]=p.useState(Kt),A=p.useRef(null),U=[{label:a.t("sheet.cf.panel.workSheet"),value:"2"},{label:a.t("sheet.cf.panel.selectedRange"),value:"1"}],k=()=>{const O=r.getSubunitRules(d,m);if(!O||!O.length)return[];if(x==="1"){const W=i.getCurrentLastSelection();if(!W)return[];const H=W.range;return O.filter(X=>X.ranges.some(oe=>ce.intersects(oe,H)))}else if(x==="2")return[...O];return[]},[V,L]=p.useState(k);Ar(f),p.useEffect(()=>{const O=s.onCommandExecuted(W=>{W.id===Ft.id&&E(Math.random())});return()=>O.dispose()}),p.useEffect(()=>{L(k)},[x,R,d,m]),p.useEffect(()=>{if(x==="2")return;const O=new Ve(W=>{const H=[Mr.id,ie.id,pe.id,he.id,qe.id],X=s.onCommandExecuted(oe=>{const{id:Me,params:Ne}=oe,Qe=n.getCurrentUnitOfType($.UNIVER_SHEET).getUnitId();H.includes(Me)&&Ne.unitId===Qe&&W.next(null)});return()=>X.dispose()}).pipe(B2(16)).subscribe(()=>{L(k)});return()=>{O.unsubscribe()}},[n,x,d,m]),p.useEffect(()=>{const O=r.$ruleChange.subscribe(()=>{E(Math.random())});return()=>O.unsubscribe()},[r]),p.useEffect(()=>{const O=()=>{var H,X;const oe=Math.max(0,((X=(H=A.current)==null?void 0:H.getBoundingClientRect().width)!=null?X:0)-8);return Kt=oe,oe},W=new Ve(H=>{const X=c.getContainer();if(X){let oe=setTimeout(()=>{H.next(void 0)},150);const Me=()=>{oe&&clearTimeout(oe),oe=null},Ne=Qe=>{Qe.propertyName==="width"&&(Me(),H.next(void 0))};return X.addEventListener("transitionend",Ne),()=>{Me(),X.removeEventListener("transitionend",Ne)}}}).pipe(B2(16)).subscribe(()=>{S(O())});return()=>{W.unsubscribe()}},[]);const v=O=>{var W;const H=n.getCurrentUnitOfType($.UNIVER_SHEET).getUnitId(),X=(W=n.getCurrentUnitOfType($.UNIVER_SHEET).getActiveSheet())==null?void 0:W.getSheetId();if(!H||!X)throw new Error("No active sheet found");s.executeCommand(p2.id,{unitId:H,subUnitId:X,cfId:O.cfId})},N=(O,W)=>{C(W.y)},xe=(O,W,H)=>{var X;C(-1);const oe=n.getCurrentUnitOfType($.UNIVER_SHEET).getUnitId(),Me=(X=n.getCurrentUnitOfType($.UNIVER_SHEET).getActiveSheet())==null?void 0:X.getSheetId();if(!oe||!Me)throw new Error("No active sheet found");const Ne=Y0=>{const X0=V.length;return Math.min(X0-1,Math.max(0,Y0))},Qe=V[Ne(W.y)].cfId,kt=V[Ne(H.y)].cfId;Qe!==kt&&s.executeCommand(st.id,{unitId:oe,subUnitId:Me,start:{id:Qe,type:"self"},end:{id:kt,type:H.y>W.y?"after":"before"}})},Ke=()=>{t.onCreate()},Ye=()=>{x==="2"?s.executeCommand(it.id):x==="1"&&V.map(O=>({unitId:d,subUnitId:m,cfId:O.cfId})).forEach(O=>{s.executeCommand(p2.id,O)})},Se=p.useMemo(()=>{const O=n.getCurrentUnitOfType($.UNIVER_SHEET),W=O.getActiveSheet();return V.filter(H=>{const X=H.ranges;return O2(l,O.getUnitId(),W.getSheetId(),X)})},[V]),Xe=Se.map((O,W)=>({i:O.cfId,x:0,w:12,y:W,h:1,isResizable:!1})),Je=p.useMemo(()=>{const O=n.getCurrentUnitOfType($.UNIVER_SHEET),W=O.getActiveSheet();return V.every(H=>{const X=H.ranges;return O2(l,O.getUnitId(),W.getSheetId(),X)})},[V]);return h.jsxs("div",{children:[h.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2 univer-text-sm",children:[h.jsx("div",{className:"univer-flex univer-items-center univer-gap-2",children:o.tWithReactNode("sheet.cf.panel.managerRuleSelect",h.jsx(ye,{className:"univer-w-36",options:U,value:x,onChange:O=>{y(O)}})).map((O,W)=>h.jsx("span",{children:O},W))}),h.jsxs("div",{className:"univer-flex univer-justify-end",children:[h.jsx(Bt,{title:a.t("sheet.cf.panel.createRule"),placement:"bottom",children:h.jsx("a",{className:"univer-size-5 univer-cursor-pointer",onClick:Ke,children:h.jsx(B0,{})})}),V.length&&Je?h.jsx(Bt,{title:a.t("sheet.cf.panel.clear"),placement:"bottom",children:h.jsx("a",{className:"univer-size-5 univer-cursor-pointer",onClick:Ye,children:h.jsx(L2,{className:"univer-text-red-500"})})}):h.jsx("div",{children:h.jsx(L2,{className:"univer-text-gray-300"})})]})]}),h.jsx("div",{ref:A,children:D>0&&h.jsx(Qr,{className:"[&_.react-grid-item]:univer-transition-none [&_.react-grid-placeholder]:univer-rounded [&_.react-grid-placeholder]:!univer-bg-gray-200",draggableHandle:".draggableHandle",layout:Xe,cols:12,rowHeight:60,width:D,margin:[0,10],onDragStop:xe,onDragStart:N,children:Se?.map((O,W)=>h.jsx("div",{children:h.jsxs("div",{className:ae("univer-group univer-relative univer-flex univer-items-center univer-justify-between univer-rounded univer-py-2 univer-pl-5 univer-pr-8 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",{"univer-bg-gray-100 dark:!univer-bg-gray-700":F===W}),onMouseMove:()=>{O.ranges!==f&&w(O.ranges)},onMouseLeave:()=>w([]),onClick:()=>{e(O)},children:[h.jsx("div",{className:ae("univer-absolute univer-left-0 univer-hidden univer-size-5 univer-cursor-grab univer-items-center univer-justify-center univer-rounded group-hover:univer-flex","draggableHandle"),onClick:H=>H.stopPropagation(),children:h.jsx($0,{})}),h.jsxs("div",{className:"univer-min-w-0 univer-max-w-full univer-flex-shrink univer-overflow-hidden",children:[h.jsx("div",{className:"univer-text-sm univer-text-gray-900 dark:!univer-text-white",children:Fi(O,a)}),h.jsx("div",{className:"univer-text-xs univer-text-gray-400",children:O.ranges.map(H=>f0(H)).join(",")})]}),h.jsx("div",{children:h.jsx(o2,{rule:O.rule})}),h.jsx("div",{className:ae("univer-absolute univer-right-1 univer-hidden univer-size-6 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded group-hover:univer-flex hover:univer-bg-gray-200",{"univer-flex univer-items-center univer-justify-center":F===W}),onClick:H=>{H.stopPropagation(),v(O),w([])},children:h.jsx(L2,{})})]})},`${O.cfId}`))})})]})},Si=t=>{const[e,r]=p.useState(t.rule),[n,i]=p.useState(!!t.rule);return h.jsx("div",{className:"univer-flex univer-h-full univer-flex-col univer-justify-between univer-py-4",children:n?h.jsx(bi,{onCancel:()=>{i(!1),r(void 0)},rule:e}):h.jsx(_i,{onClick:s=>{r(s),i(!0)},onCreate:()=>{i(!0)}})})};var Ti=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},u2=(t,e)=>(r,n)=>e(r,n,t);const k2="sheet.conditional.formatting.panel";let w2=class extends ge{constructor(t,e,r,n,i){super(),Ae(this,"_sidebarDisposable",null),this._univerInstanceService=t,this._injector=e,this._componentManager=r,this._sidebarService=n,this._localeService=i,this._initPanel(),this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$($.UNIVER_SHEET).subscribe(s=>{var a;s||(a=this._sidebarDisposable)==null||a.dispose()})),this.disposeWithMe(this._sidebarService.sidebarOptions$.subscribe(s=>{s.id===k2&&(s.visible||setTimeout(()=>{this._sidebarService.sidebarOptions$.next({visible:!1})}))}))}openPanel(t){const e={id:k2,header:{title:this._localeService.t("sheet.cf.title")},children:{label:k2,rule:t,key:r0(4)},onClose:()=>this._sidebarDisposable=null};this._sidebarDisposable=this._sidebarService.open(e)}_initPanel(){this.disposeWithMe(this._componentManager.register(k2,Si))}};w2=Ti([u2(0,q),u2(1,j(we)),u2(2,j(Xr)),u2(3,j(x0)),u2(4,j(fe))],w2);var ve=(t=>(t[t.createRule=1]="createRule",t[t.viewRule=2]="viewRule",t[t.highlightCell=3]="highlightCell",t[t.rank=4]="rank",t[t.formula=5]="formula",t[t.colorScale=6]="colorScale",t[t.dataBar=7]="dataBar",t[t.icon=8]="icon",t[t.clearRangeRules=9]="clearRangeRules",t[t.clearWorkSheetRules=10]="clearWorkSheetRules",t))(ve||{});const ut={id:"sheet.operation.open.conditional.formatting.panel",type:se.OPERATION,handler:(t,e)=>{var r;const n=t.get(w2),i=t.get(We),s=t.get(Y),a=((r=i.getCurrentSelections())==null?void 0:r.map(l=>l.range))||[];switch(e.value){case 3:{n.openPanel({...ke(),ranges:a});break}case 4:{const l={...ke,ranges:a,rule:{type:b.highlightCell,subType:I.rank}};n.openPanel(l);break}case 5:{const l={...ke,ranges:a,rule:{type:b.highlightCell,subType:I.formula,value:"="}};n.openPanel(l);break}case 6:{const l={...ke,ranges:a,rule:{type:b.colorScale,config:[]}};n.openPanel(l);break}case 7:{const l={...ke,ranges:a,rule:{type:b.dataBar,isShowValue:!0}};n.openPanel(l);break}case 8:{const l={...ke,ranges:a,rule:{type:b.iconSet,config:[],isShowValue:!0}};n.openPanel(l);break}case 2:{n.openPanel();break}case 1:{n.openPanel({...ke(),ranges:a});break}case 9:{s.executeCommand(St.id,{ranges:a});break}case 10:{s.executeCommand(it.id);break}}return!0}};var Ri=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},c2=(t,e)=>(r,n)=>e(r,n,t);let Z2=class extends ge{constructor(t,e,r,n,i){super(),this._injector=t,this._univerInstanceService=e,this._sheetInterceptorService=r,this._selectionManagerService=n,this._conditionalFormattingRuleModel=i,this._init()}_init(){this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations:t=>{var e;const r=[],n=[],i={redos:r,undos:n};if([Dr.id,br.id].includes(t.id)){const s=(e=this._selectionManagerService.getCurrentSelections())==null?void 0:e.map(m=>m.range);if(!s)return i;const a=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET),l=a.getActiveSheet();if(!l)return i;const c=a.getUnitId(),o=l.getSheetId(),u=this._conditionalFormattingRuleModel.getSubunitRules(c,o);if(!u||!u.length)return i;const{redos:d,undos:g}=Yt(this._injector,u,s,c,o);r.push(...d),n.push(...g)}return i}})),this.disposeWithMe(this._sheetInterceptorService.interceptRanges({getMutations:({unitId:t,subUnitId:e,ranges:r})=>{const n=[],i=[],s={redos:n,undos:i};if(!r||!r.length)return s;const a=this._conditionalFormattingRuleModel.getSubunitRules(t,e);if(!a||!a.length)return s;const{redos:l,undos:c}=Yt(this._injector,a,r,t,e);return n.push(...l),i.push(...c),s}}))}};Z2=Ri([c2(0,j(we)),c2(1,j(q)),c2(2,j(tt)),c2(3,j(We)),c2(4,j(P))],Z2);function Yt(t,e,r,n,i){const s=[],a=[];return e.filter(l=>r.some(c=>l.ranges.some(o=>ce.getIntersects(o,c)))).forEach(l=>{const c=new Er().add(...l.ranges).subtract(...r).merge();if(c.length){const o={id:pe.id,params:{unitId:n,subUnitId:i,rule:{...l,ranges:c}}},u=Re(t,o.params);s.push(o),a.push(...u)}else{const o={id:he.id,params:{unitId:n,subUnitId:i,cfId:l.cfId}},u=_e(t,o.params);s.push(o),a.push(...u)}}),{redos:s,undos:a}}var Ai=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},vt=(t,e)=>(r,n)=>e(r,n,t);let x2=class extends ge{constructor(t,e,r){super(),Ae(this,"_disposableMap",new Map),this._conditionalFormattingRuleModel=t,this._formulaRefRangeService=e,this._injector=r,this._initRefRange()}_getIdWithUnitId(t,e,r){return`${t}_${e}_${r}`}_getRuleFormulas(t){const e=[],r=t.rule;switch(r.type){case b.highlightCell:r.subType===I.formula&&e.push(r.value);break;case b.dataBar:{const n=r;n.config.min.type===M.formula&&e.push(n.config.min.value),n.config.max.type===M.formula&&e.push(n.config.max.value);break}case b.colorScale:{r.config.forEach(n=>{n.value.type===M.formula&&e.push(n.value.value)});break}case b.iconSet:{r.config.forEach(n=>{n.value.type===M.formula&&e.push(n.value.value)});break}}return e}_updateRuleFormulas(t,e){const r=de.deepClone(t),n=r.rule;let i=0;switch(n.type){case b.highlightCell:n.subType===I.formula&&(n.value=e[i++]);break;case b.dataBar:{const s=n;s.config.min.type===M.formula&&(s.config.min.value=e[i++]),s.config.max.type===M.formula&&(s.config.max.value=e[i++]);break}case b.colorScale:{n.config.forEach(s=>{s.value.type===M.formula&&(s.value.value=e[i++])});break}case b.iconSet:{n.config.forEach(s=>{s.value.type===M.formula&&(s.value.value=e[i++])});break}}return r}register(t,e,r){const n=r.ranges,i=this._getRuleFormulas(r),s=this._formulaRefRangeService.registerRangeFormula(t,e,n,i,l=>{if(l.length===0)return{undos:[{id:ie.id,params:{unitId:t,subUnitId:e,rule:r}}],redos:[{id:he.id,params:{unitId:t,subUnitId:e,cfId:r.cfId}}]};const c=[],o=[],u=l[0],d=this._updateRuleFormulas(r,u.formulas);d.ranges=u.ranges,c.push({id:pe.id,params:{unitId:t,subUnitId:e,cfId:r.cfId,rule:d}}),o.push(...Re(this._injector,{unitId:t,subUnitId:e,cfId:r.cfId,rule:d}));for(let g=1;g<l.length;g++){const m=l[g],f=Fe(),w=this._updateRuleFormulas(r,m.formulas);w.cfId=f,w.ranges=m.ranges,c.push({id:ie.id,params:{unitId:t,subUnitId:e,rule:w}}),o.push(I2(this._injector,{unitId:t,subUnitId:e,rule:w}))}return{undos:o,redos:c}}),a=this._getIdWithUnitId(t,e,r.cfId);this._disposableMap.set(a,s)}_initRefRange(){const t=this._conditionalFormattingRuleModel.getAll();for(const[e,r]of t)for(const[n,i]of r)for(const s of i)this.register(e,n,s);this.disposeWithMe(this._conditionalFormattingRuleModel.$ruleChange.subscribe(e=>{const{unitId:r,subUnitId:n,rule:i}=e;switch(e.type){case"add":{this.register(r,n,i);break}case"delete":{const s=this._getIdWithUnitId(r,n,i.cfId),a=this._disposableMap.get(s);a&&(a.dispose(),this._disposableMap.delete(s));break}case"set":{const s=this._getIdWithUnitId(r,n,i.cfId),a=this._disposableMap.get(s);a&&(a.dispose(),this._disposableMap.delete(s)),this.register(r,n,i);break}}})),this.disposeWithMe(i0(()=>{this._disposableMap.forEach(e=>{e.dispose()}),this._disposableMap.clear()}))}};x2=Ai([vt(0,j(P)),vt(1,j(an)),vt(2,j(we))],x2);var Mi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},d2=(t,e)=>(r,n)=>e(r,n,t);let y2=class extends ge{constructor(t,e,r,n,i){super(),Ae(this,"_copyInfo"),this._sheetClipboardService=t,this._conditionalFormattingRuleModel=e,this._injector=r,this._conditionalFormattingViewModel=n,this._univerInstanceService=i,this._initClipboardHook()}_initClipboardHook(){this.disposeWithMe(this._sheetClipboardService.addClipboardHook({id:Ge,onBeforeCopy:(t,e,r)=>this._collectConditionalRule(t,e,r),onPasteCells:(t,e,r,n)=>{const{copyType:i=Ut.COPY,pasteType:s}=n,{range:a}=t||{},{range:l}=e;return this._generateConditionalFormattingMutations(l,{copyType:i,pasteType:s,copyRange:a})}}))}_collectConditionalRule(t,e,r){const n=new le,i={};this._copyInfo={matrix:n,info:{unitId:t,subUnitId:e,cfMap:i}};const s=this._injector.invoke(o=>Fr(r,o,t,e));if(!s)return;const{rows:a,cols:l}=s,c=new Set;a.forEach((o,u)=>{l.forEach((d,g)=>{const m=this._conditionalFormattingViewModel.getCellCfs(t,e,o,d);m&&(m.forEach(f=>c.add(f.cfId)),n.setValue(u,g,m.map(f=>f.cfId)))})}),c.forEach(o=>{const u=this._conditionalFormattingRuleModel.getRule(t,e,o);u&&(i[o]=u.rule)})}_generateConditionalFormattingMutations(t,e){const r=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET),n=r.getActiveSheet(),i=r.getUnitId();if(!n)return{redos:[],undos:[]};const s=n.getSheetId();if(e.copyType===Ut.CUT)return this._copyInfo=null,{redos:[],undos:[]};if(!this._copyInfo||!e.copyRange)return{redos:[],undos:[]};if(![ct.SPECIAL_PASTE_FORMAT,ct.DEFAULT_PASTE,ct.SPECIAL_PASTE_BESIDES_BORDER].includes(e.pasteType))return{redos:[],undos:[]};const{ranges:[a,l],mapFunc:c}=l0([e.copyRange,t]),o=_r(a,l,!0),u={};ne.foreach(l,(E,F)=>{const{row:C,col:D}=c(E,F),S=this._conditionalFormattingViewModel.getCellCfs(i,s,C,D);S&&S.forEach(A=>{if(!u[A.cfId]){const U=new le;u[A.cfId]=U;const k=this._conditionalFormattingRuleModel.getRule(i,s,A.cfId);k?.ranges.forEach(V=>{ne.foreach(V,(L,v)=>{U.setValue(L,v,1)})})}u[A.cfId].realDeleteValue(C,D)})});const{matrix:d,info:g}=this._copyInfo,m=[];let f=this._conditionalFormattingRuleModel.createCfId(i,s);const w={},x=E=>{if(w[E])return w[E];const F=g?.cfMap[E],C=[...this._conditionalFormattingRuleModel.getSubunitRules(i,s)||[],...m].find(D=>de.diffValue(D.rule,F));if(C)return w[E]=C,C;{const D={rule:F,cfId:f,ranges:[],stopIfTrue:!1};return w[E]=D,m.push(D),f=`${Number(f)+1}`,D}};o.forEach(E=>{d&&d.forValue((F,C,D)=>{const S=ce.getPositionRange({startRow:F,endRow:F,startColumn:C,endColumn:C},E.startRange),{row:A,col:U}=c(S.startRow,S.startColumn);D.forEach(k=>{if(!u[k]){const V=x(k),L=new le;u[k]=L,V.ranges.forEach(v=>{ne.foreach(v,(N,xe)=>{L.setValue(N,xe,1)})})}u[k].setValue(A,U,1)})})});const y=[],R=[];for(const E in u){const F=u[E],C=v2(C2(F));if(!C.length){const D={unitId:i,subUnitId:s,cfId:E};y.push({id:he.id,params:D}),R.push(..._e(this._injector,D))}if(m.some(D=>D.cfId===E)){const D=x(E),S={unitId:i,subUnitId:s,rule:{...D,ranges:C}};y.push({id:ie.id,params:S}),R.push(I2(this._injector,S))}else{const D=this._conditionalFormattingRuleModel.getRule(i,s,E);if(!D)continue;const S={unitId:i,subUnitId:s,rule:{...D,ranges:C}};y.push({id:pe.id,params:S}),R.push(...Re(this._injector,S))}}return{redos:y,undos:R}}};y2=Mi([d2(0,j(Ur)),d2(1,j(P)),d2(2,j(we)),d2(3,j(be)),d2(4,j(q))],y2);var Ni=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},Ct=(t,e)=>(r,n)=>e(r,n,t);let D2=class extends ge{constructor(t,e,r){super(),this._localeService=t,this._commandService=e,this._sheetPermissionCheckController=r,this._commandExecutedListener()}_commandExecutedListener(){this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{if(t.id===F2.id){const{unitId:e,subUnitId:r,rule:{ranges:n}}=t.params;this._sheetPermissionCheckController.permissionCheckWithRanges({workbookTypes:[d0],rangeTypes:[c0],worksheetTypes:[o0,u0]},n,e,r)||this._sheetPermissionCheckController.blockExecuteWithoutPermission(this._localeService.t("permission.dialog.setStyleErr"))}}))}};D2=Ni([Ct(0,j(fe)),Ct(1,Y),Ct(2,j(Vr))],D2);var ki=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},r2=(t,e)=>(r,n)=>e(r,n,t);let b2=class extends ge{constructor(t,e,r,n,i,s){super(),Ae(this,"_ruleChangeCacheMap",new Map),this._sheetInterceptorService=t,this._conditionalFormattingService=e,this._univerInstanceService=r,this._renderManagerService=n,this._conditionalFormattingViewModel=i,this._conditionalFormattingRuleModel=s,this._initViewModelInterceptor(),this._initSkeleton(),this.disposeWithMe(()=>{this._ruleChangeCacheMap.clear()})}_markDirtySkeleton(){var t,e,r;const n=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET).getUnitId();(t=this._renderManagerService.getRenderById(n))==null||t.with(a0).reCalculate(),(r=(e=this._renderManagerService.getRenderById(n))==null?void 0:e.mainComponent)==null||r.makeDirty()}_initSkeleton(){this.disposeWithMe(n0(this._conditionalFormattingRuleModel.$ruleChange,this._conditionalFormattingViewModel.markDirty$).pipe(w0(16),yt(t=>!!t.length),yt(t=>{const e=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET);if(!e)return!1;const r=e.getActiveSheet();return r?t.filter(n=>n.unitId===e.getUnitId()&&n.subUnitId===r.getSheetId()).length>0:!1})).subscribe(()=>this._markDirtySkeleton()))}_initViewModelInterceptor(){this.disposeWithMe(this._sheetInterceptorService.intercept(Ir.CELL_CONTENT,{effect:ar.Style,handler:(t,e,r)=>{const n=this._conditionalFormattingService.composeStyle(e.unitId,e.subUnitId,e.row,e.col);if(!n)return r(t);const i=e.workbook.getStyles(),s=(typeof t?.s=="string"?i.get(t?.s):t?.s)||{},a=t===e.rawData?{...e.rawData}:t;if(n.style){const l={...s,...n.style};Object.assign(a,{s:l})}return a.fontRenderExtension||(a.fontRenderExtension={},n.isShowValue!==void 0&&(a.fontRenderExtension.isSkip=!n.isShowValue)),n.dataBar&&(a.dataBar=n.dataBar),n.iconSet&&(a.iconSet=n.iconSet,a.fontRenderExtension.leftOffset=F0+I0),r(a)},priority:10}))}};b2=ki([r2(0,j(tt)),r2(1,j($e)),r2(2,j(q)),r2(3,j(p0)),r2(4,j(be)),r2(5,j(P))],b2);const G0="sheets-conditional-formatting-ui.config",G2={};var Ui=Object.defineProperty,Vi=(t,e,r)=>e in t?Ui(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Li=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},pt=(t,e)=>(r,n)=>e(r,n,t),z0=(t,e,r)=>Vi(t,typeof e!="symbol"?e+"":e,r);let z2=class extends bt{constructor(t=G2,e,r,n){super(),this._config=t,this._injector=e,this._commandService=r,this._configService=n;const{menu:i,...s}=et({},G2,this._config);i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(G0,s),this._initCommand(),this._injector.add([b2]),this._injector.add([y2]),this._injector.add([D2]),this._injector.add([a2]),this._injector.add([x2])}_initCommand(){[S0,T0,R0,A0,M0,N0,k0,U0,V0,ut].forEach(t=>{this._commandService.registerCommand(t)})}};z0(z2,"pluginName",`${Ge}_MOBILE_UI_PLUGIN`);z0(z2,"type",$.UNIVER_SHEET);z2=Li([Et(He),pt(1,j(we)),pt(2,j(Y)),pt(3,It)],z2);var ji=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},h2=(t,e)=>(r,n)=>e(r,n,t);let K2=class extends ge{constructor(t,e,r,n,i){super(),this._injector=t,this._univerInstanceService=e,this._autoFillService=r,this._conditionalFormattingRuleModel=n,this._conditionalFormattingViewModel=i,this._initAutoFill()}_initAutoFill(){const t=()=>({redos:[],undos:[]}),e=(i,s,a,l,c)=>{var o;const u=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET).getUnitId(),d=(o=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET).getActiveSheet())==null?void 0:o.getSheetId();if(!u||!d)return;const g={startRow:i.row,startColumn:i.col,endColumn:i.col,endRow:i.row},m={startRow:s.row,startColumn:s.col,endColumn:s.col,endRow:s.row};ne.foreach(a,(f,w)=>{const x=ce.getPositionRange({startRow:f,startColumn:w,endColumn:w,endRow:f},g),y=ce.getPositionRange({startRow:f,startColumn:w,endColumn:w,endRow:f},m),{row:R,col:E}=c(x.startRow,x.startColumn),F=this._conditionalFormattingViewModel.getCellCfs(u,d,R,E),{row:C,col:D}=c(y.startRow,y.startColumn),S=this._conditionalFormattingViewModel.getCellCfs(u,d,C,D);S&&S.forEach(A=>{let U=l.get(A.cfId);if(!l.get(A.cfId)){const k=this._conditionalFormattingRuleModel.getRule(u,d,A.cfId);if(!k)return;U=new le,k.ranges.forEach(V=>{ne.foreach(V,(L,v)=>{U.setValue(L,v,1)})}),l.set(A.cfId,U)}U.realDeleteValue(C,D)}),F&&F.forEach(A=>{let U=l.get(A.cfId);if(!l.get(A.cfId)){const k=this._conditionalFormattingRuleModel.getRule(u,d,A.cfId);if(!k)return;U=new le,k.ranges.forEach(V=>{ne.foreach(V,(L,v)=>{U.setValue(L,v,1)})}),l.set(A.cfId,U)}U.setValue(C,D,1)})})},r=(i,s)=>{var a,l,c;const o=(a=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:a.getUnitId(),u=(c=(l=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:l.getActiveSheet())==null?void 0:c.getSheetId(),d=new Map,g=[],m=[];if(!o||!u)return t();const f=l0([i,s]),[w,x]=f.ranges,{mapFunc:y}=f,R={row:w.startRow,col:w.startColumn};return Nr.getAutoFillRepeatRange(w,x).forEach(E=>{e(R,E.repeatStartCell,E.relativeRange,d,y)}),d.forEach((E,F)=>{const C=this._conditionalFormattingRuleModel.getRule(o,u,F);if(!C)return;const D=v2(C2(E));if(D.length){const S={unitId:o,subUnitId:u,rule:{...C,ranges:D}};g.push({id:pe.id,params:S}),m.push(...Re(this._injector,S))}else{const S={unitId:o,subUnitId:u,cfId:C.cfId};g.push({id:he.id,params:S}),m.push(..._e(this._injector,S))}}),{undos:m,redos:g}},n={id:Ge,onFillData:(i,s,a)=>{if(a===dt.COPY||a===dt.ONLY_FORMAT||a===dt.SERIES){const{source:l,target:c}=i;return r(l,c)}return t()}};this.disposeWithMe(this._autoFillService.addHook(n))}};K2=ji([h2(0,j(we)),h2(1,j(q)),h2(2,j(Lr)),h2(3,j(P)),h2(4,j(be))],K2);var Bi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},Xt=(t,e)=>(r,n)=>e(r,n,t);let Y2=class extends ge{constructor(t,e){super(),this._sheetInterceptorService=t,this._conditionalFormattingService=e,this._initInterceptorEditorEnd()}_initInterceptorEditorEnd(){this.disposeWithMe(i0(this._sheetInterceptorService.writeCellInterceptor.intercept(Sr,{handler:(t,e,r)=>{var n,i,s;t||r(t);const a=this._conditionalFormattingService.composeStyle(e.unitId,e.subUnitId,e.row,e.col),l=(n=a?.style)!=null?n:{},c=Object.keys(l);if(t!=null&&t.p)return(s=(i=t.p.body)==null?void 0:i.textRuns)==null||s.forEach(o=>{o.ts&&c.forEach(u=>{var d;(d=o.ts)==null||delete d[u]})}),r(t);{const o={...(typeof t?.s=="string"?e.workbook.getStyles().get(t.s):t?.s)||{}};c.forEach(d=>{delete o[d]});const u={...t,s:{...o}};return r(u)}}})))}};Y2=Bi([Xt(0,j(tt)),Xt(1,j($e))],Y2);const Jt=[Ft.id,ie.id,pe.id,he.id,qe.id],g2=[{label:{name:"sheet.cf.ruleType.highlightCell",selectable:!1},value:ve.highlightCell},{label:{name:"sheet.cf.panel.rankAndAverage",selectable:!1},value:ve.rank},{label:{name:"sheet.cf.ruleType.formula",selectable:!1},value:ve.formula},{label:{name:"sheet.cf.ruleType.colorScale",selectable:!1},value:ve.colorScale},{label:{name:"sheet.cf.ruleType.dataBar",selectable:!1},value:ve.dataBar},{label:{name:"sheet.cf.ruleType.iconSet",selectable:!1},value:ve.icon},{label:{name:"sheet.cf.menu.manageConditionalFormatting",selectable:!1},value:ve.viewRule},{label:{name:"sheet.cf.menu.createConditionalFormatting",selectable:!1},value:ve.createRule},{label:{name:"sheet.cf.menu.clearRangeRules",selectable:!1},value:ve.clearRangeRules,disabled:!1},{label:{name:"sheet.cf.menu.clearWorkSheetRules",selectable:!1},value:ve.clearWorkSheetRules}],Oi=t=>{const e=t.get(We),r=t.get(Y),n=t.get(q),i=t.get(P),s=new Ve(c=>n0(e.selectionMoveEnd$,e.selectionSet$,new Ve(o=>{const u=r.onCommandExecuted(d=>{var g;const{id:m,params:f}=d,w=(g=n.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:g.getUnitId();Jt.includes(m)&&f.unitId===w&&o.next(null)});return()=>u.dispose()})).pipe(B2(16)).subscribe(()=>{var o;const u=((o=e.getCurrentSelections())==null?void 0:o.map(f=>f.range))||[],d=n.getCurrentUnitForType($.UNIVER_SHEET);if(!d)return;const g=d.getActiveSheet();if(!g)return;const m=(i.getSubunitRules(d.getUnitId(),g.getSheetId())||[]).filter(f=>f.ranges.some(w=>u.some(x=>ce.intersects(x,w)))).map(f=>f.ranges).every(f=>O2(t,d.getUnitId(),g.getSheetId(),f));c.next(m)})),a=new Ve(c=>new Ve(o=>{const u=r.onCommandExecuted(d=>{var g;const{id:m,params:f}=d,w=(g=n.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:g.getUnitId();Jt.includes(m)&&f.unitId===w&&o.next(null)});return()=>u.dispose()}).pipe(B2(16)).subscribe(()=>{const o=n.getCurrentUnitForType($.UNIVER_SHEET);if(!o)return;const u=o.getActiveSheet();if(!u)return;const d=i.getSubunitRules(o.getUnitId(),u.getSheetId())||[];if(!d.length)return c.next(!1),!1;const g=d.map(m=>m.ranges).every(m=>O2(t,o.getUnitId(),u.getSheetId(),m));c.next(g)})),l=new Ve(c=>{s.subscribe(o=>{const u=g2.find(d=>d.value===ve.clearRangeRules);u&&(u.disabled=!o,c.next(g2))}),a.subscribe(o=>{const u=g2.find(d=>d.value===ve.clearWorkSheetRules);u&&(u.disabled=!o,c.next(g2))}),c.next(g2)});return{id:ut.id,type:Zr.SELECTOR,icon:"ConditionsDoubleIcon",tooltip:"sheet.cf.title",selections:l,hidden$:Gr(t,$.UNIVER_SHEET),disabled$:Tr(t,{workbookTypes:[d0],worksheetTypes:[u0,o0],rangeTypes:[c0]})}},$i={[Wr.RULES]:{[ut.id]:{order:1,menuItemFactory:Oi}}};var Pi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},Qt=(t,e)=>(r,n)=>e(r,n,t);let X2=class extends ge{constructor(t,e){super(),Ae(this,"_sidebarDisposable",null),this._injector=t,this._menuManagerService=e,this._menuManagerService.mergeMenu($i)}};X2=Pi([Qt(0,j(we)),Qt(1,Jr)],X2);var qi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},n2=(t,e)=>(r,n)=>e(r,n,t);const Hi=(t,e)=>{const r=u=>u.endRow-u.startRow+1,n=u=>u.endColumn-u.startColumn+1,i=r(e)%r(t),s=n(e)%n(t),a=Math.floor(r(e)/r(t)),l=Math.floor(n(e)/n(t)),c=[],o={startRow:0,endRow:r(t)-1,startColumn:0,endColumn:n(t)-1};if(r(e)===1&&n(e)===1){const u={startRow:e.startRow,endRow:e.startRow,startColumn:e.startColumn,endColumn:e.startColumn};return c.push({repeatRelativeRange:o,startRange:u}),c}for(let u=0;u<a+(i?.1:0);u++)for(let d=0;d<l+(s?.1:0);d++){const g=r(t)*u,m=n(t)*d,f={startRow:g+e.startRow,endRow:g+e.startRow,startColumn:m+e.startColumn,endColumn:m+e.startColumn};let w=o;u===a&&i&&(w={...w},w.endRow=w.endRow-(r(t)-i)),d===l&&s&&(w={...w},w.endColumn=w.endColumn-(n(t)-s)),c.push({repeatRelativeRange:w,startRange:f})}return c};let J2=class extends ge{constructor(t,e,r,n,i,s){super(),Ae(this,"_painterConfig",null),this._injector=t,this._univerInstanceService=e,this._formatPainterService=r,this._sheetsSelectionsService=n,this._conditionalFormattingRuleModel=i,this._conditionalFormattingViewModel=s,this._initFormattingPainter()}_initFormattingPainter(){const t=()=>({redos:[],undos:[]}),e=(i,s,a,l,c)=>{const{unitId:o,subUnitId:u}=this._painterConfig,{targetUnitId:d,targetSubUnitId:g}=c,m={startRow:i.row,startColumn:i.col,endColumn:i.col,endRow:i.row},f={startRow:s.row,startColumn:s.col,endColumn:s.col,endRow:s.row};ne.foreach(a,(w,x)=>{const y=ce.getPositionRange({startRow:w,startColumn:x,endColumn:x,endRow:w},m),R=ce.getPositionRange({startRow:w,startColumn:x,endColumn:x,endRow:w},f),E=this._conditionalFormattingViewModel.getCellCfs(o,u,y.startRow,y.startColumn),F=this._conditionalFormattingViewModel.getCellCfs(d,g,R.startRow,R.startColumn);F&&F.forEach(C=>{let D=l.get(C.cfId);if(!l.get(C.cfId)){const S=this._conditionalFormattingRuleModel.getRule(d,g,C.cfId);if(!S)return;D=new le,S.ranges.forEach(A=>{ne.foreach(A,(U,k)=>{D.setValue(U,k,1)})}),l.set(C.cfId,D)}D.realDeleteValue(R.startRow,R.startColumn)}),E&&E.forEach(C=>{const D=l.get(C.cfId);D&&D.setValue(R.startRow,R.startColumn,1)})})},r=(i,s,a)=>{var l;const{range:c,unitId:o,subUnitId:u}=this._painterConfig,d=i!==o||u!==s,g=new Map,m=[],f=[];if(!i||!s||!o||!u)return t();const w=(l=this._conditionalFormattingRuleModel.getSubunitRules(o,u))!=null?l:[];w?.forEach(y=>{const{ranges:R,cfId:E}=y;if(R.some(F=>ce.intersects(c,F))){const F=new le;d||R.forEach(C=>{ne.foreach(C,(D,S)=>{F.setValue(D,S,1)})}),g.set(E,F)}});const x={row:c.startRow,col:c.startColumn};return Hi(c,a).forEach(y=>{e(x,{row:y.startRange.startRow,col:y.startRange.startColumn},y.repeatRelativeRange,g,{targetUnitId:i,targetSubUnitId:s})}),g.forEach((y,R)=>{if(d){const E=this._conditionalFormattingRuleModel.getRule(i,s,R),F=v2(C2(y));if(E)if(F.length){const C={unitId:i,subUnitId:s,rule:{...E,ranges:F}};m.push({id:pe.id,params:C}),f.push(...Re(this._injector,C))}else{const C={unitId:i,subUnitId:s,cfId:E.cfId};m.push({id:he.id,params:C}),f.push(..._e(this._injector,C))}else if(F.length){const C=this._conditionalFormattingRuleModel.getRule(o,u,R);if(C){const D={unitId:i,subUnitId:s,rule:{...de.deepClone(C),cfId:this._conditionalFormattingRuleModel.createCfId(i,s),ranges:F}};m.push({id:ie.id,params:D}),f.push(I2(this._injector,D))}}}else{const E=this._conditionalFormattingRuleModel.getRule(o,u,R);if(!E)return;const F=v2(C2(y));if(F.length){const C={unitId:o,subUnitId:u,rule:{...E,ranges:F}};m.push({id:pe.id,params:C}),f.push(...Re(this._injector,C))}else{const C={unitId:o,subUnitId:u,cfId:E.cfId};m.push({id:he.id,params:C}),f.push(..._e(this._injector,C))}}}),{undos:f,redos:m}},n={id:Ge,onStatusChange:i=>{var s,a,l;switch(i){case ht.INFINITE:case ht.ONCE:{const c=(s=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:s.getUnitId(),o=(l=(a=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET))==null?void 0:a.getActiveSheet())==null?void 0:l.getSheetId(),u=this._sheetsSelectionsService.getCurrentLastSelection(),d=u?.range;c&&o&&d&&(this._painterConfig={unitId:c,subUnitId:o,range:d});break}case ht.OFF:{this._painterConfig=null;break}}},onApply:(i,s,a)=>this._painterConfig?r(i,s,a):{redos:[],undos:[]}};this._formatPainterService.addHook(n)}};J2=qi([n2(0,j(we)),n2(1,j(q)),n2(2,j(jr)),n2(3,j(We)),n2(4,j(P)),n2(5,j(be))],J2);var Wi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},wt=(t,e)=>(r,n)=>e(r,n,t);let Q2=class extends ge{constructor(t,e,r){super(),this._conditionalFormattingViewModel=t,this._univerInstanceService=e,this._renderManagerService=r,this._init()}_init(){const t=this._univerInstanceService.getCurrentUnitForType($.UNIVER_SHEET),e=r=>{const n=r.getUnitId(),i=this._renderManagerService.getRenderById(n);if(!i)return;const s=i.with(a0);this.disposeWithMe(s.currentSkeleton$.subscribe(a=>{if(a){const l=a.skeleton.rowColumnSegment,c=l.endColumn-l.startColumn+1,o=(l.endRow-l.startRow+1)*c*9,u=Math.max(V2,o);this._conditionalFormattingViewModel.setCacheLength(u)}}))};t&&e(t),this._univerInstanceService.getCurrentTypeOfUnit$($.UNIVER_SHEET).subscribe(r=>{r&&e(r)})}};Q2=Wi([wt(0,j(be)),wt(1,q),wt(2,p0)],Q2);var Zi=Object.defineProperty,Gi=(t,e,r)=>e in t?Zi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zi=(t,e,r,n)=>{for(var i=e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=a(i)||i);return i},xt=(t,e)=>(r,n)=>e(r,n,t),K0=(t,e,r)=>Gi(t,typeof e!="symbol"?e+"":e,r);let E2=class extends bt{constructor(t=G2,e,r,n){super(),this._config=t,this._injector=e,this._commandService=r,this._configService=n;const{menu:i,...s}=et({},G2,this._config);i&&this._configService.setConfig("menu",i,{merge:!0}),this._configService.setConfig(G0,s),this._initCommand()}onStarting(){sr(this._injector,[[b2],[y2],[K2],[D2],[w2],[X2],[a2],[Y2],[Z2],[J2],[Q2],[x2]]),U2(this._injector,[[b2],[x2]])}onReady(){U2(this._injector,[[X2],[w2]])}onRendered(){U2(this._injector,[[K2],[Z2],[y2],[Y2],[a2],[J2],[D2],[Q2]])}_initCommand(){[S0,T0,R0,A0,M0,N0,k0,U0,V0,ut].forEach(t=>{this._commandService.registerCommand(t)})}};K0(E2,"pluginName",`${Ge}_UI_PLUGIN`);K0(E2,"type",$.UNIVER_SHEET);E2=zi([Et(He,sn),xt(1,j(we)),xt(2,j(Y)),xt(3,It)],E2);var Ki=Object.defineProperty,Yi=(t,e,r)=>e in t?Ki(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xi=(t,e,r)=>Yi(t,e+"",r);class ze{constructor(e={}){Xi(this,"_rule",{}),this._rule=e,this._ensureAttr(this._rule,["rule"])}get _ruleConfig(){return this._rule.rule||null}_getDefaultConfig(e=b.highlightCell){switch(e){case b.colorScale:return{type:e,config:[{index:0,color:new Ee("").toRgbString(),value:{type:M.min}},{index:0,color:new Ee("green").toRgbString(),value:{type:M.max}}]};case b.dataBar:return{type:e,isShowValue:!0,config:{min:{type:M.min},max:{type:M.max},positiveColor:new Ee("green").toRgbString(),nativeColor:new Ee("").toRgbString(),isGradient:!1}};case b.highlightCell:return{type:e,subType:I.text,operator:B.containsText,value:"abc",style:{}};case b.iconSet:return{type:e,isShowValue:!0,config:[{operator:_.greaterThanOrEqual,value:{type:M.min},iconType:f2,iconId:""},{operator:_.greaterThanOrEqual,value:{type:M.percentile,value:.5},iconType:f2,iconId:""},{operator:_.lessThanOrEqual,value:{type:M.max},iconType:f2,iconId:""}]}}}_ensureAttr(e,r){return r.reduce((n,i)=>(n[i]||(n[i]={}),n[i]),e),e}build(){var e;this._rule.cfId||(this._rule.cfId=Fe()),this._rule.ranges||(this._rule.ranges=[]),this._rule.stopIfTrue===void 0&&(this._rule.stopIfTrue=!1),(e=this._rule.rule)!=null&&e.type||(this._rule.rule.type=b.highlightCell,this._ensureAttr(this._rule,["rule","style"]));const r=this._getDefaultConfig(this._rule.rule.type);return{...this._rule,rule:{...r,...this._rule.rule}}}copy(){const e=de.deepClone(this._rule);return e.cfId&&(e.cfId=Fe()),new ze(e)}getRanges(){return this._rule.ranges||[]}getIconMap(){return Ce}createCfId(){return Fe()}setRanges(e){return this._rule.ranges=e,this}}class Z extends ze{constructor(e={}){super(e),this._ensureAttr(this._rule,["rule","style"])}copy(){const e=de.deepClone(this._rule);return e.cfId&&(e.cfId=Fe()),new Z(e)}setAverage(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.average,r.operator=e,this}setUniqueValues(){const e=this._ruleConfig;return e.type=b.highlightCell,e.subType=I.uniqueValues,this}setDuplicateValues(){const e=this._ruleConfig;return e.type=b.highlightCell,e.subType=I.duplicateValues,this}setRank(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.rank,r.isBottom=e.isBottom,r.isPercent=e.isPercent,r.value=e.value,this}setBackground(e){var r;if(((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell)if(e){this._ensureAttr(this._ruleConfig,["style","bg"]);const n=new Ee(e);this._ruleConfig.style.bg.rgb=n.toRgbString()}else delete this._ruleConfig.style.bg;return this}setBold(e){var r;return((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell&&(this._ensureAttr(this._ruleConfig,["style"]),this._ruleConfig.style.bl=e?Q.TRUE:Q.FALSE),this}setFontColor(e){var r;if(((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell)if(e){const n=new Ee(e);this._ensureAttr(this._ruleConfig,["style","cl"]),this._ruleConfig.style.cl.rgb=n.toRgbString()}else delete this._ruleConfig.style.cl;return this}setItalic(e){var r;return((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell&&(this._ensureAttr(this._ruleConfig,["style"]),this._ruleConfig.style.it=e?Q.TRUE:Q.FALSE),this}setStrikethrough(e){var r;return((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell&&(this._ensureAttr(this._ruleConfig,["style","st"]),this._ruleConfig.style.st.s=e?Q.TRUE:Q.FALSE),this}setUnderline(e){var r;return((r=this._ruleConfig)==null?void 0:r.type)===b.highlightCell&&(this._ensureAttr(this._ruleConfig,["style","ul"]),this._ruleConfig.style.ul.s=e?Q.TRUE:Q.FALSE),this}whenCellEmpty(){const e=this._ruleConfig;return e.type=b.highlightCell,e.subType=I.text,e.value="",e.operator=B.equal,this}whenCellNotEmpty(){const e=this._ruleConfig;return e.type=b.highlightCell,e.subType=I.text,e.value="",e.operator=B.notEqual,this}whenDate(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.timePeriod,r.operator=e,this}whenFormulaSatisfied(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.formula,r.value=e,this}whenNumberBetween(e,r){const n=Math.min(e,r),i=Math.max(e,r),s=this._ruleConfig;return s.type=b.highlightCell,s.subType=I.number,s.value=[n,i],s.operator=_.between,this}whenNumberEqualTo(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.equal,this}whenNumberGreaterThan(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.greaterThan,this}whenNumberGreaterThanOrEqualTo(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.greaterThanOrEqual,this}whenNumberLessThan(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.lessThan,this}whenNumberLessThanOrEqualTo(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.lessThanOrEqual,this}whenNumberNotBetween(e,r){const n=Math.min(e,r),i=Math.max(e,r),s=this._ruleConfig;return s.type=b.highlightCell,s.subType=I.number,s.value=[n,i],s.operator=_.notBetween,this}whenNumberNotEqualTo(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.number,r.value=e,r.operator=_.notEqual,this}whenTextContains(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.text,r.value=e,r.operator=B.containsText,this}whenTextDoesNotContain(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.text,r.value=e,r.operator=B.notContainsText,this}whenTextEndsWith(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.text,r.value=e,r.operator=B.endsWith,this}whenTextEqualTo(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.text,r.value=e,r.operator=B.equal,this}whenTextStartsWith(e){const r=this._ruleConfig;return r.type=b.highlightCell,r.subType=I.text,r.value=e,r.operator=B.beginsWith,this}}class At extends ze{copy(){const e=de.deepClone(this._rule);return e.cfId&&(e.cfId=Fe()),new At(e)}setDataBar(e){const r=this._ruleConfig;return r.type=b.dataBar,r.isShowValue=!!e.isShowValue,r.config={min:e.min,max:e.max,positiveColor:e.positiveColor,nativeColor:e.nativeColor,isGradient:!!e.isGradient},this}}class Mt extends ze{copy(){const e=de.deepClone(this._rule);return e.cfId&&(e.cfId=Fe()),new Mt(e)}setColorScale(e){const r=this._ruleConfig;return r.type=b.colorScale,r.config=e,this}}class Nt extends ze{copy(){const e=de.deepClone(this._rule);return e.cfId&&(e.cfId=Fe()),new Nt(e)}setIconSet(e){const r=this._ruleConfig;return r.type=b.iconSet,r.config=e.iconConfigs,r.isShowValue=e.isShowValue,this}}class Dt{constructor(e={}){this._initConfig=e}build(){return new ze(this._initConfig).build()}setAverage(e){return new Z(this._initConfig).setAverage(e)}setUniqueValues(){return new Z(this._initConfig).setUniqueValues()}setDuplicateValues(){return new Z(this._initConfig).setDuplicateValues()}setRank(e){return new Z(this._initConfig).setRank(e)}getIconMap(){return Ce}setIconSet(e){return new Nt(this._initConfig).setIconSet(e)}setColorScale(e){return new Mt(this._initConfig).setColorScale(e)}setDataBar(e){return new At(this._initConfig).setDataBar(e)}setBackground(e){return new Z(this._initConfig).setBackground(e)}setBold(e){return new Z(this._initConfig).setBold(e)}setFontColor(e){return new Z(this._initConfig).setFontColor(e)}setItalic(e){return new Z(this._initConfig).setItalic(e)}setStrikethrough(e){return new Z(this._initConfig).setStrikethrough(e)}setUnderline(e){return new Z(this._initConfig).setUnderline(e)}whenCellEmpty(){return new Z(this._initConfig).whenCellEmpty()}whenCellNotEmpty(){return new Z(this._initConfig).whenCellNotEmpty()}whenDate(e){return new Z(this._initConfig).whenDate(e)}whenFormulaSatisfied(e){return new Z(this._initConfig).whenFormulaSatisfied(e)}whenNumberBetween(e,r){return new Z(this._initConfig).whenNumberBetween(e,r)}whenNumberEqualTo(e){return new Z(this._initConfig).whenNumberEqualTo(e)}whenNumberGreaterThan(e){return new Z(this._initConfig).whenNumberGreaterThan(e)}whenNumberGreaterThanOrEqualTo(e){return new Z(this._initConfig).whenNumberGreaterThanOrEqualTo(e)}whenNumberLessThan(e){return new Z(this._initConfig).whenNumberLessThan(e)}whenNumberLessThanOrEqualTo(e){return new Z(this._initConfig).whenNumberLessThanOrEqualTo(e)}whenNumberNotBetween(e,r){return new Z(this._initConfig).whenNumberNotBetween(e,r)}whenNumberNotEqualTo(e){return new Z(this._initConfig).whenNumberNotEqualTo(e)}whenTextContains(e){return new Z(this._initConfig).whenTextContains(e)}whenTextDoesNotContain(e){return new Z(this._initConfig).whenTextDoesNotContain(e)}whenTextEndsWith(e){return new Z(this._initConfig).whenTextEndsWith(e)}whenTextEqualTo(e){return new Z(this._initConfig).whenTextEqualTo(e)}whenTextStartsWith(e){return new Z(this._initConfig).whenTextStartsWith(e)}}class Ji extends h0{_getConditionalFormattingRuleModel(){return this._injector.get(P)}getConditionalFormattingRules(){return[...this._getConditionalFormattingRuleModel().getSubunitRules(this._workbook.getUnitId(),this._worksheet.getSheetId())||[]].filter(e=>e.ranges.some(r=>ce.intersects(r,this._range)))}createConditionalFormattingRule(){return new Dt({ranges:[this._range]})}addConditionalFormattingRule(e){const r={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:e};return this._commandService.syncExecuteCommand(F2.id,r),this}deleteConditionalFormattingRule(e){const r={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e};return this._commandService.syncExecuteCommand(p2.id,r),this}moveConditionalFormattingRule(e,r,n="after"){const i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),start:{id:e,type:"self"},end:{id:r,type:n}};return this._commandService.syncExecuteCommand(st.id,i),this}setConditionalFormattingRule(e,r){const n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:r,cfId:e};return this._commandService.syncExecuteCommand(at.id,n),this}clearConditionalFormatRules(){const e={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),ranges:[this._range]};return this._commandService.syncExecuteCommand(St.id,e),this}}h0.extend(Ji);class Qi extends g0{newColor(){return new cr}}g0.extend(Qi);class es extends m0{_getConditionalFormattingRuleModel(){return this._injector.get(P)}getConditionalFormattingRules(){return[...this._getConditionalFormattingRuleModel().getSubunitRules(this._workbook.getUnitId(),this._worksheet.getSheetId())||[]]}createConditionalFormattingRule(){return new Dt}newConditionalFormattingRule(){return new Dt}addConditionalFormattingRule(e){const r={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),rule:e};return this._commandService.syncExecuteCommand(F2.id,r),this}deleteConditionalFormattingRule(e){const r={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e};return this._commandService.syncExecuteCommand(p2.id,r),this}moveConditionalFormattingRule(e,r,n="after"){const i={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),start:{id:e,type:"self"},end:{id:r,type:n}};return this._commandService.syncExecuteCommand(st.id,i),this}setConditionalFormattingRule(e,r){const n={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),cfId:e,rule:r};return this._commandService.syncExecuteCommand(at.id,n),this}clearConditionalFormatRules(){const e={unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId()};return this._commandService.syncExecuteCommand(it.id,e),this}}m0.extend(es);class ts{get ConditionFormatNumberOperatorEnum(){return _}get ConditionFormatTimePeriodOperatorEnum(){return J}}ln.extend(ts);function xs(){return{plugins:[He,E2].filter(t=>!!t)}}export{S0 as AddAverageCfCommand,F2 as AddCfCommand,T0 as AddColorScaleConditionalRuleCommand,ie as AddConditionalRuleMutation,I2 as AddConditionalRuleMutationUndoFactory,R0 as AddDataBarConditionalRuleCommand,A0 as AddDuplicateValuesCfCommand,M0 as AddNumberCfCommand,N0 as AddRankCfCommand,k0 as AddTextCfCommand,U0 as AddTimePeriodCfCommand,V0 as AddUniqueValuesCfCommand,_ as CFNumberOperator,b as CFRuleType,I as CFSubRuleType,B as CFTextOperator,J as CFTimePeriodOperator,M as CFValueType,V2 as CONDITIONAL_FORMATTING_VIEWPORT_CACHE_LENGTH,St as ClearRangeCfCommand,it as ClearWorksheetCfCommand,Z2 as ConditionalFormattingClearController,s2 as ConditionalFormattingFormulaService,zn as ConditionalFormattingIcon,P as ConditionalFormattingRuleModel,$e as ConditionalFormattingService,be as ConditionalFormattingViewModel,cn as DEFAULT_BG_COLOR,dn as DEFAULT_FONT_COLOR,F0 as DEFAULT_PADDING,I0 as DEFAULT_WIDTH,yn as DataBar,p2 as DeleteCfCommand,he as DeleteConditionalRuleMutation,_e as DeleteConditionalRuleMutationUndoFactory,f2 as EMPTY_ICON_TYPE,Wn as IconUKey,st as MoveCfCommand,qe as MoveConditionalRuleMutation,mn as MoveConditionalRuleMutationUndoFactory,ut as OpenConditionalFormattingOperator,Ge as SHEET_CONDITIONAL_FORMATTING_PLUGIN,at as SetCfCommand,pe as SetConditionalRuleMutation,z2 as UniverSheetsConditionalFormattingMobileUIPlugin,He as UniverSheetsConditionalFormattingPlugin,xs as UniverSheetsConditionalFormattingPreset,E2 as UniverSheetsConditionalFormattingUIPlugin,gn as anchorUndoFactory,i2 as compareWithNumber,Fe as createCfId,ke as createDefaultRule,P2 as createDefaultValue,m2 as createDefaultValueByValueType,Cn as dataBarUKey,Oe as defaultDataBarNativeColor,Be as defaultDataBarPositiveColor,pn as defaultPlaceholderColor,ot as filterRange,je as findIndexByAnchor,ps as getCacheStyleMatrix,Te as getCellValue,D0 as getColorScaleFromValue,ws as getMaxInFormulaResult,W2 as getOppositeOperator,H2 as getValueByType,b0 as iconGroup,Ce as iconMap,Cs as isAnchorEqual,q2 as isFloatsEqual,ue as isNullable,bs as isRangesEqual,hn as moveByAnchor,_0 as removeUndefinedAttr,Tn as serialTimeToTimestamp,Re as setConditionalRuleMutationUndoFactory,Sn as toYMD_1900,y0 as transformSupportSymmetryAnchor};
