(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))u(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function a(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(t){if(t.ep)return;t.ep=!0;const r=a(t);fetch(t.href,r)}})();function v(){const n=document.getElementById("univer-root");if(!n)throw new Error("Missing #univer-root container.");return n}function E(n){const e=n.getBoundingClientRect();if(e.width<50||e.height<50)throw new Error(`Container size invalid (${e.width}x${e.height}). Fix CSS so #univer-root has real size before mounting.`)}function L(n){window.addEventListener("error",e=>{console.error(`[${n}] window.error`,e.error||e.message,e)}),window.addEventListener("unhandledrejection",e=>{console.error(`[${n}] unhandledrejection`,e.reason,e)})}const w="modulepreload",y=function(n,e){return new URL(n,e).href},p={},P=function(e,a,u){let t=Promise.resolve();if(a&&a.length>0){let g=function(s){return Promise.all(s.map(l=>Promise.resolve(l).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};const o=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),m=i?.nonce||i?.getAttribute("nonce");t=g(a.map(s=>{if(s=y(s,u),s in p)return;p[s]=!0;const l=s.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(u)for(let f=o.length-1;f>=0;f--){const h=o[f];if(h.href===s&&(!l||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${d}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":w,l||(c.as="script"),c.crossOrigin="",c.href=s,m&&c.setAttribute("nonce",m),document.head.appendChild(c),l)return new Promise((f,h)=>{c.addEventListener("load",f),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})}))}function r(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return t.then(o=>{for(const i of o||[])i.status==="rejected"&&r(i.reason);return e().catch(r)})};export{P as _,E as a,L as i,v as m};
