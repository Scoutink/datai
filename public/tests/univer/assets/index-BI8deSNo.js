const ha=Symbol("$$IDENTIFIER_DECORATOR");function Kp(t){return t&&t[ha]===!0}function da(t){return typeof t=="function"}function ui(t){return!!(t&&typeof t.useClass<"u")}function ci(t){return!!(t&&typeof t.useFactory<"u")}function hi(t){return!!(t&&typeof t.useValue<"u")}function Xp(t){return!!(t&&typeof t.useExisting<"u")}function di(t){return!!(t&&typeof t.useAsync<"u")}const cc=Symbol("AsyncHook");function Ms(t){return!!(t&&t.__symbol===cc)}function pe(t){return da(t)&&!t[ha]?t.name:t.toString()}var Re=class extends Error{constructor(t){super(`[redi]: ${t}`)}};let Nt=(function(t){return t.MANY="many",t.OPTIONAL="optional",t.REQUIRED="required",t})({}),Ze=(function(t){return t.SELF="self",t.SKIP_SELF="skipSelf",t})({});const Ol=Symbol("$$TARGET"),fi=Symbol("$$DEPENDENCIES");var Jp=class extends Re{constructor(t,e){const n=`Could not find dependency registered on the ${t} (indexed) parameter of the constructor of "${pe(e)}".`;super(n)}},Qp=class extends Re{constructor(t,e){const n=`It seems that you forgot to provide a parameter to @Required() on the ${e}th parameter of "${pe(t)}"`;super(n)}},qp=class extends Re{constructor(t,e){const n=`It seems that you register "undefined" as dependency on the ${e}th parameter of "${pe(t)}". Please make sure that there is not cyclic dependency among your TypeScript files, or consider using "forwardRef". For more info please visit our website https://redi.wendell.fun/docs/faq#could-not-find-dependency-registered-on`;super(n)}};function hc(t){return t[fi]||[]}function fa(t,e){const r=hc(t).find(s=>s.paramIndex===e);if(!r)throw new Jp(e,t);return r}function go(t,e,n,r=Nt.REQUIRED,s){const o={paramIndex:n,identifier:e,quantity:r,lookUp:s,withNew:!1};if(typeof e>"u")throw new qp(t,n);const i=t;i[Ol]===i?i[fi].push(o):(i[fi]=[o],i[Ol]=i)}const Dl=new Set,Nl=new Map;function ue(t){if(Dl.has(t))return console.error(`Identifier "${t}" already exists. Returning the cached identifier decorator.`),Nl.get(t);const e=function(n,r,s){go(n,e,s)};return e.decoratorName=t,e.toString=()=>e.decoratorName,e[ha]=!0,Dl.add(t),Nl.set(t,e),e}function Zp(t,e,n){const r=fa(t,e);r.lookUp=n}function dc(t){return function e(){return this instanceof e?this:function(n,r,s){Zp(n,s,t)}}}const fc=dc(Ze.SKIP_SELF),pc=dc(Ze.SELF);function tg(t){return t===Nt.OPTIONAL?"0 or 1":"1"}var Ls=class extends Re{constructor(t,e,n){let r=`Expect ${tg(e)} dependency item(s) for id "${pe(t)}" but get ${n}.`;n===0&&(r+=" Did you forget to register it?"),n>1&&(r+=" You register it more than once."),super(r),this.quantity=e,this.actual=n}};function gc(t,e,n){if(e===Nt.OPTIONAL&&n>1||e===Nt.REQUIRED&&n!==1)throw new Ls(t,e,n)}function eg(t,e){return t===Nt.MANY?e:e[0]}function ng(t,e,n){const r=fa(t,e);r.quantity=n}function pa(t){return function e(n){return this instanceof e?this:function(r,s,o){if(n)go(r,n,o,t);else{if(t===Nt.REQUIRED)throw new Qp(r,o);ng(r,o,t)}}}}const mc=pa(Nt.MANY),_c=pa(Nt.OPTIONAL),Ce=pa(Nt.REQUIRED);function yc(t,e=0){return t?t.map((n,r)=>{if(r+=e,!Array.isArray(n))return{paramIndex:r,identifier:n,quantity:Nt.REQUIRED,withNew:!1};const s=n.slice(0,n.length-1),o=n[n.length-1];let i,a=Nt.REQUIRED,l=!1;return s.forEach(u=>{u instanceof pc?i=Ze.SELF:u instanceof fc?i=Ze.SKIP_SELF:u instanceof _c?a=Nt.OPTIONAL:u instanceof mc?a=Nt.MANY:l=!0}),{paramIndex:r,identifier:o,quantity:a,lookUp:i,withNew:l}}):[]}function rg(t,e,n=0){yc(e,n).forEach(s=>{go(t,s.identifier,s.paramIndex,s.quantity,s.lookUp)})}function sg(t){return{unwrap:t}}function og(t){return!!t&&typeof t.unwrap=="function"}function ig(t){return og(t)?t.unwrap():t}function ag(t,e,n){const r=fa(t,e);r.withNew=n}function lg(t){return function e(){return this instanceof e?this:function(n,r,s){ag(n,s,t)}}}const ug=lg(!0);function Ec(t){return!!t&&typeof t.dispose=="function"}function cg(t){return t.length===1}const mo=[];function xl(t){mo.push(t)}function Ml(){mo.pop()}function hg(){mo.length=0}var Ll=class extends Re{constructor(t,e,n){const r=`Cannot find "${pe(e)}" registered by any injector. It is the ${n}th param of "${Kp(t)?pe(t):t.name}".`;super(r)}},Us=class extends Re{constructor(t){const e=`Cannot find "${pe(t)}" registered by any injector. The stack of dependencies is: "${mo.map(n=>pe(n)).join(" -> ")}".`;super(e),hg()}},dg=class{dependencyMap=new Map;constructor(t){this.normalizeDependencies(t).map(e=>this.add(e[0],e[1]))}add(t,e){typeof e>"u"&&(e={useClass:t,lazy:!1});let n=this.dependencyMap.get(t);typeof n>"u"&&(n=[],this.dependencyMap.set(t,n)),n.push(e)}delete(t){this.dependencyMap.delete(t)}get(t,e){const n=this.dependencyMap.get(t);return gc(t,e,n.length),eg(e,n)}has(t){return this.dependencyMap.has(t)}dispose(){this.dependencyMap.clear()}normalizeDependencies(t){return t.map(e=>{const n=e[0];let r;return cg(e)?r={useClass:e[0],lazy:!1}:r=e[1],[n,r]})}},fg=class{resolvedDependencies=new Map;add(t,e){let n=this.resolvedDependencies.get(t);typeof n>"u"&&(n=[],this.resolvedDependencies.set(t,n)),n.push(e)}has(t){return this.resolvedDependencies.has(t)}get(t,e){const n=this.resolvedDependencies.get(t);if(!n)throw new Us(t);return gc(t,e,n.length),e===Nt.MANY?n:n[0]}dispose(){Array.from(this.resolvedDependencies.values()).forEach(t=>{t.forEach(e=>Ec(e)?e.dispose():void 0)}),this.resolvedDependencies.clear()}};let pi;(function(){if(typeof requestIdleCallback<"u"&&typeof cancelIdleCallback<"u")pi=(t,e)=>{const n=requestIdleCallback(t,typeof e=="number"?{timeout:e}:void 0);let r=!1;return()=>{r||(r=!0,cancelIdleCallback(n))}};else{const t=Object.freeze({didTimeout:!0,timeRemaining(){return 15}});pi=e=>{const n=setTimeout(()=>e(t));let r=!1;return()=>{r||(r=!0,clearTimeout(n))}}}})();var pg=class{executor;disposeIdleCallback;didRun=!1;value;error;constructor(t){this.executor=()=>{try{this.value=t()}catch(e){this.error=e}finally{this.didRun=!0}},this.disposeIdleCallback=pi(()=>this.executor())}hasRun(){return this.didRun}dispose(){this.disposeIdleCallback()}getValue(){if(this.didRun||(this.disposeIdleCallback(),this.executor()),this.error)throw this.error;return this.value}};const gg=300,gs=Symbol("$$NOT_INSTANTIATED_SYMBOL");var mg=class extends Re{constructor(t){super(`Detecting cyclic dependency. The last identifier is "${pe(t)}".`)}},_g=class extends Re{constructor(){super("Injector cannot be accessed after it was disposed.")}},yg=class extends Re{constructor(t){super(`Async item "${pe(t)}" returns another async item.`)}},Eg=class extends Re{constructor(t){super(`Cannot get async item "${pe(t)}" from sync api.`)}},Ul=class extends Re{constructor(t){super(`Cannot add dependency "${pe(t)}" after it is already resolved.`)}},vg=class extends Re{constructor(t){super(`Cannot delete dependency "${pe(t)}" when it is already resolved.`)}},_n=class gi{dependencyCollection;resolvedDependencyCollection;children=[];resolutionOngoing=0;disposingCallbacks=new Set;disposed=!1;constructor(e,n=null){this.parent=n,this.dependencyCollection=new dg(e||[]),this.resolvedDependencyCollection=new fg,n&&n.children.push(this)}onDispose(e){return this.disposingCallbacks.add(e),{dispose:()=>this.disposingCallbacks.delete(e)}}createChild(e){return this._ensureInjectorNotDisposed(),new gi(e,this)}dispose(){this.children.forEach(e=>e.dispose()),this.children.length=0,this.dependencyCollection.dispose(),this.resolvedDependencyCollection.dispose(),this.deleteSelfFromParent(),this.disposed=!0,this.disposingCallbacks.forEach(e=>e()),this.disposingCallbacks.clear()}deleteSelfFromParent(){if(this.parent){const e=this.parent.children.indexOf(this);this.parent.children.splice(e,1)}}add(e){this._ensureInjectorNotDisposed();const n=e[0],r=e[1];if(this.resolvedDependencyCollection.has(n))throw new Ul(n);typeof r>"u"?this.dependencyCollection.add(n):di(r)||ui(r)||hi(r)||ci(r)?this.dependencyCollection.add(n,r):this.resolvedDependencyCollection.add(n,r)}replace(e){this._ensureInjectorNotDisposed();const n=e[0];if(this.resolvedDependencyCollection.has(n))throw new Ul(n);this.dependencyCollection.delete(n),this.dependencyCollection.add(n,e[1])}delete(e){if(this._ensureInjectorNotDisposed(),this.resolvedDependencyCollection.has(e))throw new vg(e);this.dependencyCollection.delete(e)}invoke(e,...n){return this._ensureInjectorNotDisposed(),e({get:(s,o,i)=>this._get(s,o,i),has:s=>this.has(s)},...n)}has(e){return this.dependencyCollection.has(e)||this.parent?.has(e)||!1}get(e,n,r){this._ensureInjectorNotDisposed();const s=this._get(e,n,r);if(Array.isArray(s)&&s.some(o=>Ms(o))||Ms(s))throw new Eg(e);return s}_get(e,n,r,s){let o=Nt.REQUIRED;if(n===Nt.REQUIRED||n===Nt.OPTIONAL||n===Nt.MANY?o=n:r=n,!s){const a=this.getValue(e,o,r);if(a!==gs)return a}const i=!s;return this.createDependency(e,o,r,i)}getAsync(e){this._ensureInjectorNotDisposed();const n=this.getValue(e,Nt.REQUIRED);if(n!==gs)return Promise.resolve(n);const r=this.createDependency(e,Nt.REQUIRED);return Ms(r)?r.whenReady():Promise.resolve(r)}createInstance(e,...n){return this._ensureInjectorNotDisposed(),this._resolveClassImpl({useClass:e},...n)}_resolveDependency(e,n,r=!0){let s;xl(e);try{hi(n)?s=this._resolveValueDependency(e,n):ci(n)?s=this._resolveFactory(e,n,r):ui(n)?s=this._resolveClass(e,n,r):Xp(n)?s=this._resolveExisting(e,n):s=this._resolveAsync(e,n),Ml()}catch(o){throw Ml(),o}return s}_resolveExisting(e,n){const r=this.get(n.useExisting);return this.resolvedDependencyCollection.add(e,r),r}_resolveValueDependency(e,n){const r=n.useValue;return this.resolvedDependencyCollection.add(e,r),r}_resolveClass(e,n,r){let s;if(n.lazy){const o=new pg(()=>(this._ensureInjectorNotDisposed(),this._resolveClassImpl(n)));s=new Proxy(Object.create(null),{get(i,a){if(a in i)return i[a];const l=o.getValue();let u=l[a];return typeof u!="function"||(u=u.bind(l),i[a]=u),u},set(i,a,l){return o.getValue()[a]=l,!0}})}else s=this._resolveClassImpl(n);return e&&r&&this.resolvedDependencyCollection.add(e,s),s}_resolveClassImpl(e,...n){const r=e.useClass;this.markNewResolution(r);const s=hc(r).sort((u,c)=>u.paramIndex-c.paramIndex).map(u=>({...u,identifier:ig(u.identifier)})),o=[];for(const u of s)try{const c=this._get(u.identifier,u.quantity,u.lookUp,u.withNew);o.push(c)}catch(c){throw c instanceof Us||c instanceof Ls&&c.actual===0?new Ll(r,u.identifier,u.paramIndex):c}let i=[...n];const a=s.length>0?s[0].paramIndex:i.length;if(i.length!==a){console.warn(`[redi]: Expect ${a} custom parameter(s) of ${pe(r)} but get ${i.length}.`);const u=a-i.length;u>0?i=[...i,...Array.from({length:u}).fill(void 0)]:i=i.slice(0,a)}const l=new r(...i,...o);return e?.onInstantiation?.(l),this.markResolutionCompleted(),l}_resolveFactory(e,n,r){this.markNewResolution(e);const s=yc(n.deps),o=[];for(const a of s)try{const l=this._get(a.identifier,a.quantity,a.lookUp,a.withNew);o.push(l)}catch(l){throw l instanceof Us||l instanceof Ls&&l.actual===0?new Ll(e,a.identifier,a.paramIndex):l}const i=n.useFactory.apply(null,o);return r&&this.resolvedDependencyCollection.add(e,i),this.markResolutionCompleted(),n?.onInstantiation?.(i),i}_resolveAsync(e,n){return{__symbol:cc,whenReady:()=>this._resolveAsyncImpl(e,n)}}_resolveAsyncImpl(e,n){return n.useAsync().then(r=>{const s=this.getValue(e);if(s!==gs)return s;let o;if(Array.isArray(r)){const i=r[1];if(di(i))throw new yg(e);o=this._resolveDependency(e,i)}else da(r)?o=this._resolveClassImpl({useClass:r,onInstantiation:n.onInstantiation}):o=r;return this.resolvedDependencyCollection.add(e,o),o})}getValue(e,n=Nt.REQUIRED,r){const s=()=>this.dependencyCollection.has(e)&&!this.resolvedDependencyCollection.has(e)?gs:this.resolvedDependencyCollection.get(e,n),o=()=>{if(this.parent)return this.parent.getValue(e,n);if(n===Nt.OPTIONAL)return null;if(n===Nt.MANY)return[];throw new Ls(e,Nt.REQUIRED,0)};return r===Ze.SKIP_SELF?o():e===gi?this:r===Ze.SELF||this.resolvedDependencyCollection.has(e)||this.dependencyCollection.has(e)?s():o()}createDependency(e,n,r,s=!0){const o=()=>{const a=this.dependencyCollection.get(e,n);let l=null;return Array.isArray(a)?l=a.map(u=>this._resolveDependency(e,u,s)):l=this._resolveDependency(e,a,s),l},i=()=>{if(this.parent)return this.parent.createDependency(e,n,void 0,s);if(n===Nt.OPTIONAL)return null;if(n===Nt.MANY)return[];throw xl(e),new Us(e)};return r===Ze.SKIP_SELF?i():this.dependencyCollection.has(e)?o():i()}markNewResolution(e){if(this.resolutionOngoing+=1,this.resolutionOngoing>=gg)throw new mg(e)}markResolutionCompleted(){this.resolutionOngoing-=1}_ensureInjectorNotDisposed(){if(this.disposed)throw new _g}};const Cg=function(){return function(e,n,r){go(e,_n,r,Nt.REQUIRED,Ze.SELF)}},Fl=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof global<"u"&&global,kl="REDI_GLOBAL_LOCK",Rg=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;Fl[kl]?Rg||console.error(`[redi]: You are loading scripts of redi more than once! This may cause undesired behavior in your application.
Maybe your dependencies added redi as its dependency and bundled redi to its dist files. Or you import different versions of redi.
For more info please visit our website: https://redi.wendell.fun/en-US/docs/faq#import-scripts-of-redi-more-than-once`):Fl[kl]=!0;var mi=function(t,e){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=r[s])},mi(t,e)};function ze(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mi(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function bg(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function a(c){try{u(r.next(c))}catch(h){i(h)}}function l(c){try{u(r.throw(c))}catch(h){i(h)}}function u(c){c.done?o(c.value):s(c.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function vc(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(r=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],s=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function lr(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gr(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,o=[],i;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)o.push(s.value)}catch(a){i={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function Yr(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,o;r<s;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function or(t){return this instanceof or?(this.v=t,this):new or(t)}function Tg(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),s[Symbol.asyncIterator]=function(){return this},s;function i(f){return function(p){return Promise.resolve(p).then(f,h)}}function a(f,p){r[f]&&(s[f]=function(m){return new Promise(function(R,S){o.push([f,m,R,S])>1||l(f,m)})},p&&(s[f]=p(s[f])))}function l(f,p){try{u(r[f](p))}catch(m){d(o[0][3],m)}}function u(f){f.value instanceof or?Promise.resolve(f.value.v).then(c,h):d(o[0][2],f)}function c(f){l("next",f)}function h(f){l("throw",f)}function d(f,p){f(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function Ig(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof lr=="function"?lr(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(i){return new Promise(function(a,l){i=t[o](i),s(a,l,i.done,i.value)})}}function s(o,i,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},i)}}function Kt(t){return typeof t=="function"}function ga(t){var e=function(r){Error.call(r),r.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Po=ga(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Ws(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var dr=(function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,r,s,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=lr(i),l=a.next();!l.done;l=a.next()){var u=l.value;u.remove(this)}}catch(m){e={error:m}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(Kt(c))try{c()}catch(m){o=m instanceof Po?m.errors:[m]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=lr(h),f=d.next();!f.done;f=d.next()){var p=f.value;try{Pl(p)}catch(m){o=o??[],m instanceof Po?o=Yr(Yr([],Gr(o)),Gr(m.errors)):o.push(m)}}}catch(m){r={error:m}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(r)throw r.error}}}if(o)throw new Po(o)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)Pl(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Ws(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Ws(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=(function(){var e=new t;return e.closed=!0,e})(),t})(),Cc=dr.EMPTY;function Rc(t){return t instanceof dr||t&&"closed"in t&&Kt(t.remove)&&Kt(t.add)&&Kt(t.unsubscribe)}function Pl(t){Kt(t)?t():t.unsubscribe()}var wg={Promise:void 0},Sg={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,Yr([t,e],Gr(n)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function bc(t){Sg.setTimeout(function(){throw t})}function Bl(){}function Fs(t){t()}var ma=(function(t){ze(e,t);function e(n){var r=t.call(this)||this;return r.isStopped=!1,n?(r.destination=n,Rc(n)&&n.add(r)):r.destination=Dg,r}return e.create=function(n,r,s){return new Vs(n,r,s)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(dr),Ag=(function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){ms(r)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){ms(r)}else ms(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){ms(n)}},t})(),Vs=(function(t){ze(e,t);function e(n,r,s){var o=t.call(this)||this,i;return Kt(n)||!n?i={next:n??void 0,error:r??void 0,complete:s??void 0}:i=n,o.destination=new Ag(i),o}return e})(ma);function ms(t){bc(t)}function Og(t){throw t}var Dg={closed:!0,next:Bl,error:Og,complete:Bl},_a=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Un(t){return t}function IT(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Tc(t)}function Tc(t){return t.length===0?Un:t.length===1?t[0]:function(n){return t.reduce(function(r,s){return s(r)},n)}}var ee=(function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,r){var s=this,o=xg(e)?e:new Vs(e,n,r);return Fs(function(){var i=s,a=i.operator,l=i.source;o.add(a?a.call(o,l):l?s._subscribe(o):s._trySubscribe(o))}),o},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var r=this;return n=$l(n),new n(function(s,o){var i=new Vs({next:function(a){try{e(a)}catch(l){o(l),i.unsubscribe()}},error:o,complete:s});r.subscribe(i)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[_a]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return Tc(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=$l(e),new e(function(r,s){var o;n.subscribe(function(i){return o=i},function(i){return s(i)},function(){return r(o)})})},t.create=function(e){return new t(e)},t})();function $l(t){var e;return(e=t??wg.Promise)!==null&&e!==void 0?e:Promise}function Ng(t){return t&&Kt(t.next)&&Kt(t.error)&&Kt(t.complete)}function xg(t){return t&&t instanceof ma||Ng(t)&&Rc(t)}function Mg(t){return Kt(t?.lift)}function Be(t){return function(e){if(Mg(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Oe(t,e,n,r,s){return new Lg(t,e,n,r,s)}var Lg=(function(t){ze(e,t);function e(n,r,s,o,i,a){var l=t.call(this,n)||this;return l.onFinalize=i,l.shouldUnsubscribe=a,l._next=r?function(u){try{r(u)}catch(c){n.error(c)}}:t.prototype._next,l._error=o?function(u){try{o(u)}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=s?function(){try{s()}catch(u){n.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e})(ma),Ug=ga(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),se=(function(t){ze(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new Hl(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new Ug},e.prototype.next=function(n){var r=this;Fs(function(){var s,o;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var i=lr(r.currentObservers),a=i.next();!a.done;a=i.next()){var l=a.value;l.next(n)}}catch(u){s={error:u}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(s)throw s.error}}}})},e.prototype.error=function(n){var r=this;Fs(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var s=r.observers;s.length;)s.shift().error(n)}})},e.prototype.complete=function(){var n=this;Fs(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,s=this,o=s.hasError,i=s.isStopped,a=s.observers;return o||i?Cc:(this.currentObservers=null,a.push(n),new dr(function(){r.currentObservers=null,Ws(a,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,s=r.hasError,o=r.thrownError,i=r.isStopped;s?n.error(o):i&&n.complete()},e.prototype.asObservable=function(){var n=new ee;return n.source=this,n},e.create=function(n,r){return new Hl(n,r)},e})(ee),Hl=(function(t){ze(e,t);function e(n,r){var s=t.call(this)||this;return s.destination=n,s.source=r,s}return e.prototype.next=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,n)},e.prototype.error=function(n){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&s!==void 0?s:Cc},e})(se),ie=(function(t){ze(e,t);function e(n){var r=t.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=t.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,s=n.thrownError,o=n._value;if(r)throw s;return this._throwIfClosed(),o},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e})(se),ya={now:function(){return(ya.delegate||Date).now()},delegate:void 0},Fg=(function(t){ze(e,t);function e(n,r,s){n===void 0&&(n=1/0),r===void 0&&(r=1/0),s===void 0&&(s=ya);var o=t.call(this)||this;return o._bufferSize=n,o._windowTime=r,o._timestampProvider=s,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=r===1/0,o._bufferSize=Math.max(1,n),o._windowTime=Math.max(1,r),o}return e.prototype.next=function(n){var r=this,s=r.isStopped,o=r._buffer,i=r._infiniteTimeWindow,a=r._timestampProvider,l=r._windowTime;s||(o.push(n),!i&&o.push(a.now()+l)),this._trimBuffer(),t.prototype.next.call(this,n)},e.prototype._subscribe=function(n){this._throwIfClosed(),this._trimBuffer();for(var r=this._innerSubscribe(n),s=this,o=s._infiniteTimeWindow,i=s._buffer,a=i.slice(),l=0;l<a.length&&!n.closed;l+=o?1:2)n.next(a[l]);return this._checkFinalizedStatuses(n),r},e.prototype._trimBuffer=function(){var n=this,r=n._bufferSize,s=n._timestampProvider,o=n._buffer,i=n._infiniteTimeWindow,a=(i?1:2)*r;if(r<1/0&&a<o.length&&o.splice(0,o.length-a),!i){for(var l=s.now(),u=0,c=1;c<o.length&&o[c]<=l;c+=2)u=c;u&&o.splice(0,u+1)}},e})(se),kg=(function(t){ze(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e})(dr),jl={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,Yr([t,e],Gr(n)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},Pg=(function(t){ze(e,t);function e(n,r){var s=t.call(this,n,r)||this;return s.scheduler=n,s.work=r,s.pending=!1,s}return e.prototype.schedule=function(n,r){var s;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(i,this.id,r),this},e.prototype.requestAsyncId=function(n,r,s){return s===void 0&&(s=0),jl.setInterval(n.flush.bind(n,this),s)},e.prototype.recycleAsyncId=function(n,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;r!=null&&jl.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(n,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var s=!1,o;try{this.work(n)}catch(i){s=!0,o=i||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),o},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,s=n.scheduler,o=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Ws(o,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e})(kg),Wl=(function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=ya.now,t})(),Bg=(function(t){ze(e,t);function e(n,r){r===void 0&&(r=Wl.now);var s=t.call(this,n,r)||this;return s.actions=[],s._active=!1,s}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var s;this._active=!0;do if(s=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,s){for(;n=r.shift();)n.unsubscribe();throw s}},e})(Wl),Ic=new Bg(Pg),$g=Ic,wc=new ee(function(t){return t.complete()});function Sc(t){return t&&Kt(t.schedule)}function Ea(t){return t[t.length-1]}function Hg(t){return Kt(Ea(t))?t.pop():void 0}function va(t){return Sc(Ea(t))?t.pop():void 0}function jg(t,e){return typeof Ea(t)=="number"?t.pop():e}var Ac=(function(t){return t&&typeof t.length=="number"&&typeof t!="function"});function Oc(t){return Kt(t?.then)}function Dc(t){return Kt(t[_a])}function Nc(t){return Symbol.asyncIterator&&Kt(t?.[Symbol.asyncIterator])}function xc(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Wg(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Mc=Wg();function Lc(t){return Kt(t?.[Mc])}function Uc(t){return Tg(this,arguments,function(){var n,r,s,o;return vc(this,function(i){switch(i.label){case 0:n=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,or(n.read())];case 3:return r=i.sent(),s=r.value,o=r.done,o?[4,or(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,or(s)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function Fc(t){return Kt(t?.getReader)}function fr(t){if(t instanceof ee)return t;if(t!=null){if(Dc(t))return Vg(t);if(Ac(t))return Gg(t);if(Oc(t))return Yg(t);if(Nc(t))return kc(t);if(Lc(t))return zg(t);if(Fc(t))return Kg(t)}throw xc(t)}function Vg(t){return new ee(function(e){var n=t[_a]();if(Kt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Gg(t){return new ee(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function Yg(t){return new ee(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,bc)})}function zg(t){return new ee(function(e){var n,r;try{for(var s=lr(t),o=s.next();!o.done;o=s.next()){var i=o.value;if(e.next(i),e.closed)return}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}e.complete()})}function kc(t){return new ee(function(e){Xg(t,e).catch(function(n){return e.error(n)})})}function Kg(t){return kc(Uc(t))}function Xg(t,e){var n,r,s,o;return bg(this,void 0,void 0,function(){var i,a;return vc(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=Ig(t),l.label=1;case 1:return[4,n.next()];case 2:if(r=l.sent(),!!r.done)return[3,4];if(i=r.value,e.next(i),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=l.sent(),s={error:a},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function cn(t,e,n,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var o=e.schedule(function(){n(),s?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!s)return o}function Pc(t,e){return e===void 0&&(e=0),Be(function(n,r){n.subscribe(Oe(r,function(s){return cn(r,t,function(){return r.next(s)},e)},function(){return cn(r,t,function(){return r.complete()},e)},function(s){return cn(r,t,function(){return r.error(s)},e)}))})}function Bc(t,e){return e===void 0&&(e=0),Be(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function Jg(t,e){return fr(t).pipe(Bc(e),Pc(e))}function Qg(t,e){return fr(t).pipe(Bc(e),Pc(e))}function qg(t,e){return new ee(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Zg(t,e){return new ee(function(n){var r;return cn(n,e,function(){r=t[Mc](),cn(n,e,function(){var s,o,i;try{s=r.next(),o=s.value,i=s.done}catch(a){n.error(a);return}i?n.complete():n.next(o)},0,!0)}),function(){return Kt(r?.return)&&r.return()}})}function $c(t,e){if(!t)throw new Error("Iterable cannot be null");return new ee(function(n){cn(n,e,function(){var r=t[Symbol.asyncIterator]();cn(n,e,function(){r.next().then(function(s){s.done?n.complete():n.next(s.value)})},0,!0)})})}function tm(t,e){return $c(Uc(t),e)}function em(t,e){if(t!=null){if(Dc(t))return Jg(t,e);if(Ac(t))return qg(t,e);if(Oc(t))return Qg(t,e);if(Nc(t))return $c(t,e);if(Lc(t))return Zg(t,e);if(Fc(t))return tm(t,e)}throw xc(t)}function _o(t,e){return e?em(t,e):fr(t)}function _s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=va(t);return _o(t,n)}var Ca=ga(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function nm(t,e){return new Promise(function(n,r){var s=new Vs({next:function(o){n(o),s.unsubscribe()},error:r,complete:function(){r(new Ca)}});t.subscribe(s)})}function rm(t){return t instanceof Date&&!isNaN(t)}function pr(t,e){return Be(function(n,r){var s=0;n.subscribe(Oe(r,function(o){r.next(t.call(e,o,s++))}))})}var sm=Array.isArray;function om(t,e){return sm(e)?t.apply(void 0,Yr([],Gr(e))):t(e)}function im(t){return pr(function(e){return om(t,e)})}var am=Array.isArray,lm=Object.getPrototypeOf,um=Object.prototype,cm=Object.keys;function hm(t){if(t.length===1){var e=t[0];if(am(e))return{args:e,keys:null};if(dm(e)){var n=cm(e);return{args:n.map(function(r){return e[r]}),keys:n}}}return{args:t,keys:null}}function dm(t){return t&&typeof t=="object"&&lm(t)===um}function fm(t,e){return t.reduce(function(n,r,s){return n[r]=e[s],n},{})}function pm(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=va(t),r=Hg(t),s=hm(t),o=s.args,i=s.keys;if(o.length===0)return _o([],n);var a=new ee(gm(o,n,i?function(l){return fm(i,l)}:Un));return r?a.pipe(im(r)):a}function gm(t,e,n){return n===void 0&&(n=Un),function(r){Vl(e,function(){for(var s=t.length,o=new Array(s),i=s,a=s,l=function(c){Vl(e,function(){var h=_o(t[c],e),d=!1;h.subscribe(Oe(r,function(f){o[c]=f,d||(d=!0,a--),a||r.next(n(o.slice()))},function(){--i||r.complete()}))},r)},u=0;u<s;u++)l(u)},r)}}function Vl(t,e,n){t?cn(n,t,e):e()}function mm(t,e,n,r,s,o,i,a){var l=[],u=0,c=0,h=!1,d=function(){h&&!l.length&&!u&&e.complete()},f=function(m){return u<r?p(m):l.push(m)},p=function(m){u++;var R=!1;fr(n(m,c++)).subscribe(Oe(e,function(S){e.next(S)},function(){R=!0},void 0,function(){if(R)try{u--;for(var S=function(){var P=l.shift();i||p(P)};l.length&&u<r;)S();d()}catch(P){e.error(P)}}))};return t.subscribe(Oe(e,f,function(){h=!0,d()})),function(){}}function Hc(t,e,n){return n===void 0&&(n=1/0),Kt(e)?Hc(function(r,s){return pr(function(o,i){return e(r,o,s,i)})(fr(t(r,s)))},n):(typeof e=="number"&&(n=e),Be(function(r,s){return mm(r,s,t,n)}))}function _m(t){return t===void 0&&(t=1/0),Hc(Un,t)}function ym(t,e,n){t===void 0&&(t=0),n===void 0&&(n=$g);var r=-1;return e!=null&&(Sc(e)?n=e:r=e),new ee(function(s){var o=rm(t)?+t-n.now():t;o<0&&(o=0);var i=0;return n.schedule(function(){s.closed||(s.next(i++),0<=r?this.schedule(void 0,r):s.complete())},o)})}function jc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=va(t),r=jg(t,1/0),s=t;return s.length?s.length===1?fr(s[0]):_m(r)(_o(s,n)):wc}function pn(t,e){return Be(function(n,r){var s=0;n.subscribe(Oe(r,function(o){return t.call(e,o,s++)&&r.next(o)}))})}function Wc(t,e){return e===void 0&&(e=Ic),Be(function(n,r){var s=null,o=null,i=null,a=function(){if(s){s.unsubscribe(),s=null;var u=o;o=null,r.next(u)}};function l(){var u=i+t,c=e.now();if(c<u){s=this.schedule(void 0,u-c),r.add(s);return}a()}n.subscribe(Oe(r,function(u){o=u,i=e.now(),s||(s=e.schedule(l,t),r.add(s))},function(){a(),r.complete()},void 0,function(){o=s=null}))})}function Em(t){return Be(function(e,n){var r=!1;e.subscribe(Oe(n,function(s){r=!0,n.next(s)},function(){r||n.next(t),n.complete()}))})}function Vc(t){return t<=0?function(){return wc}:Be(function(e,n){var r=0;e.subscribe(Oe(n,function(s){++r<=t&&(n.next(s),t<=r&&n.complete())}))})}function vm(t,e){return e===void 0&&(e=Un),t=t??Cm,Be(function(n,r){var s,o=!0;n.subscribe(Oe(r,function(i){var a=e(i);(o||!t(s,a))&&(o=!1,s=a,r.next(i))}))})}function Cm(t,e){return t===e}function Rm(t){return t===void 0&&(t=bm),Be(function(e,n){var r=!1;e.subscribe(Oe(n,function(s){r=!0,n.next(s)},function(){return r?n.complete():n.error(t())}))})}function bm(){return new Ca}function Tm(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?pn(function(s,o){return t(s,o,r)}):Un,Vc(1),n?Em(e):Rm(function(){return new Ca}))}}function Gc(t){return pn(function(e,n){return t<=n})}function Gl(t,e,n){var r=Kt(t)||e||n?{next:t,error:e,complete:n}:t;return r?Be(function(s,o){var i;(i=r.subscribe)===null||i===void 0||i.call(r);var a=!0;s.subscribe(Oe(o,function(l){var u;(u=r.next)===null||u===void 0||u.call(r,l),o.next(l)},function(){var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},function(l){var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,l),o.error(l)},function(){var l,u;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Un}const ys={white:"#FFFFFF",black:"#000000",primary:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},gray:{50:"#F9FAFB",100:"#EEEFF1",200:"#E3E5EA",300:"#A8B0BD",400:"#7D8698",500:"#4E5565",600:"#31363F",700:"#272A2F",800:"#1F2124",900:"#1B1C1F"},blue:{50:"#EBF5FF",100:"#E1EFFE",200:"#C3DDFD",300:"#A4CAFE",400:"#76A9FA",500:"#3F83F8",600:"#1C64F2",700:"#1A56DB",800:"#1E429F",900:"#233876"},red:{50:"#FDF2F2",100:"#FDE8E8",200:"#FBD5D5",300:"#F8B4B4",400:"#F98080",500:"#F05252",600:"#E02424",700:"#C81E1E",800:"#9B1C1C",900:"#771D1D"},orange:{50:"#FFF8F1",100:"#FEECDC",200:"#FCD9BD",300:"#FDBA8C",400:"#FF8A4C",500:"#FF5A1F",600:"#D03801",700:"#B43403",800:"#8A2C0D",900:"#771D1D"},yellow:{50:"#FDFCEA",100:"#FFF4B9",200:"#FCDC6A",300:"#FAC815",400:"#F1B312",500:"#D49D0F",600:"#AB7F0E",700:"#9A6D15",800:"#725213",900:"#634312"},green:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},jiqing:{50:"#EDFAFA",100:"#D5F5F6",200:"#AFECEF",300:"#7EDCE2",400:"#16BDCA",500:"#0694A2",600:"#047481",700:"#036672",800:"#05505C",900:"#014451"},indigo:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},purple:{50:"#F6F5FF",100:"#EDEBFE",200:"#DCD7FE",300:"#CABFFD",400:"#AC94FA",500:"#9061F9",600:"#7E3AF2",700:"#6C2BD9",800:"#5521B5",900:"#4A1D96"},pink:{50:"#FDF2F8",100:"#FCE8F3",200:"#FAD1E8",300:"#F8B4D9",400:"#F17EB8",500:"#E74694",600:"#D61F69",700:"#BF125D",800:"#99154B",900:"#751A3D"},"loop-color":{1:"purple.400",2:"green.500",3:"blue.500",4:"yellow.400",5:"pink.300",6:"jiqing.600",7:"orange.400",8:"gray.800",9:"indigo.500",10:"red.300",11:"green.600",12:"yellow.700"}},wT={white:"#FFFFFF",black:"#000000",primary:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},gray:{50:"#F9FAFB",100:"#EEEFF1",200:"#E3E5EA",300:"#A8B0BD",400:"#7D8698",500:"#4E5565",600:"#31363F",700:"#272A2F",800:"#1F2124",900:"#1B1C1F"},blue:{50:"#EBF5FF",100:"#E1EFFE",200:"#C3DDFD",300:"#A4CAFE",400:"#76A9FA",500:"#3F83F8",600:"#1C64F2",700:"#1A56DB",800:"#1E429F",900:"#233876"},red:{50:"#FDF2F2",100:"#FDE8E8",200:"#FBD5D5",300:"#F8B4B4",400:"#F98080",500:"#F05252",600:"#E02424",700:"#C81E1E",800:"#9B1C1C",900:"#771D1D"},orange:{50:"#FFF8F1",100:"#FEECDC",200:"#FCD9BD",300:"#FDBA8C",400:"#FF8A4C",500:"#FF5A1F",600:"#D03801",700:"#B43403",800:"#8A2C0D",900:"#771D1D"},yellow:{50:"#FDFCEA",100:"#FFF4B9",200:"#FCDC6A",300:"#FAC815",400:"#F1B312",500:"#D49D0F",600:"#AB7F0E",700:"#9A6D15",800:"#725213",900:"#634312"},green:{50:"#F3FAF7",100:"#DEF7EC",200:"#BCF0DA",300:"#84E1BC",400:"#31C48D",500:"#0DA471",600:"#057A55",700:"#046C4E",800:"#03543F",900:"#014737"},jiqing:{50:"#EDFAFA",100:"#D5F5F6",200:"#AFECEF",300:"#7EDCE2",400:"#16BDCA",500:"#0694A2",600:"#047481",700:"#036672",800:"#05505C",900:"#014451"},indigo:{50:"#F3F5FF",100:"#E9EDFF",200:"#D2DAFA",300:"#BAC6F8",400:"#6280F9",500:"#466AF7",600:"#2C53F1",700:"#143EE3",800:"#083AD1",900:"#1033BF"},purple:{50:"#F6F5FF",100:"#EDEBFE",200:"#DCD7FE",300:"#CABFFD",400:"#AC94FA",500:"#9061F9",600:"#7E3AF2",700:"#6C2BD9",800:"#5521B5",900:"#4A1D96"},pink:{50:"#FDF2F8",100:"#FCE8F3",200:"#FAD1E8",300:"#F8B4D9",400:"#F17EB8",500:"#E74694",600:"#D61F69",700:"#BF125D",800:"#99154B",900:"#751A3D"},"loop-color":{1:"purple.400",2:"green.500",3:"blue.500",4:"yellow.400",5:"pink.300",6:"jiqing.600",7:"orange.400",8:"gray.800",9:"indigo.500",10:"red.300",11:"green.600",12:"yellow.700"}};var Im=Object.defineProperty,wm=(t,e,n)=>e in t?Im(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e,n)=>wm(t,typeof e!="symbol"?e+"":e,n);function Sm(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const Ge=typeof global<"u"?global:typeof self<"u"?self:window;function Am(){const t=new Map;let e=0;typeof Ge.requestIdleCallback!="function"&&(Ge.requestIdleCallback=function(n){const r=Date.now(),s=++e,o=setTimeout(function(){t.delete(s);const i=Math.max(0,50-(Date.now()-r));n({didTimeout:i===0,timeRemaining(){return i}})},1);return t.set(s,o),s}),typeof Ge.cancelIdleCallback!="function"&&(Ge.cancelIdleCallback=function(n){const r=t.get(n);r!==void 0&&(clearTimeout(r),t.delete(n))})}function Om(){typeof Ge.Array.prototype.findLastIndex!="function"&&(Ge.Array.prototype.findLastIndex=function(t,e){if(this==null)throw new TypeError("Array.prototype.findLastIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");const n=this.length>>>0;for(let r=n-1;r>=0;r--)if(r in this&&t.call(e,this[r],r,this))return r;return-1}),typeof Ge.Array.prototype.findLast!="function"&&(Ge.Array.prototype.findLast=function(t,e){const n=this.findLastIndex(t,e);return n!==-1?this[n]:void 0})}function Dm(){typeof Ge.String.prototype.at!="function"&&(Ge.String.prototype.at=function(t){if(this==null)throw new TypeError("String.prototype.at called on null or undefined");const e=this.length;if(t<0&&(t=e+t),!(t<0||t>=e))return this.charAt(t)})}function Nm(){Am(),Om(),Dm()}function ns(t,e){const n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1}function xm(t){const e=new Set,n=[];for(const r of t)e.has(r)||(e.add(r),n.push(r));return n}function Mm(t,e){const n=new Set,r=[];for(const s of t){const o=e(s);n.has(o)||(n.add(o),r.push(s))}return r}function Lm(t,e){for(let n=t.length-1;n>-1;n--){const r=t[n];if(e(r,n))return r}return null}function Um(t,e){if(t.length===0)return t;const n=e%t.length;return t.slice(n).concat(t.slice(0,n))}function Fm(t,e){const n=new Map;return t.forEach(r=>{const s=e(r);let o=n.get(s);n.has(s)||(o=[],n.set(s,o)),o.push(r)}),n}function km(t){return Array.isArray(t)?t:[t]}function Ne(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Bo,Yl;function Pm(){if(Yl)return Bo;Yl=1;var t=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||t.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||t.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||t.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=t.DEFAULT_MAX_PENDING};return t.DEFAULT_TIMEOUT=0,t.DEFAULT_MAX_OCCUPATION_TIME=0,t.DEFAULT_MAX_EXECUTION_TIME=0,t.DEFAULT_MAX_PENDING=1e3,t.prototype.acquire=function(e,n,r,s){if(Array.isArray(e))return this._acquireBatch(e,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var o=null,i=null,a=null;typeof r!="function"&&(s=r,r=null,a=new this.Promise(function(k,H){o=k,i=H})),s=s||{};var l=!1,u=null,c=null,h=null,d=this,f=function(k,H,C){c&&(clearTimeout(c),c=null),h&&(clearTimeout(h),h=null),k&&(d.queues[e]&&d.queues[e].length===0&&delete d.queues[e],d.domainReentrant&&delete d.domains[e]),l||(a?H?i(H):o(C):typeof r=="function"&&r(H,C),l=!0),k&&d.queues[e]&&d.queues[e].length>0&&d.queues[e].shift()()},p=function(k){if(l)return f(k);u&&(clearTimeout(u),u=null),d.domainReentrant&&k&&(d.domains[e]=process.domain);var H=s.maxExecutionTime||d.maxExecutionTime;if(H&&(h=setTimeout(function(){d.queues[e]&&f(k,new Error("Maximum execution time is exceeded "+e))},H)),n.length===1){var C=!1;try{n(function(b,v){C||(C=!0,f(k,b,v))})}catch(b){C||(C=!0,f(k,b))}}else d._promiseTry(function(){return n()}).then(function(b){f(k,void 0,b)},function(b){f(k,b)})};d.domainReentrant&&process.domain&&(p=process.domain.bind(p));var m=s.maxPending||d.maxPending;if(!d.queues[e])d.queues[e]=[],p(!0);else if(d.domainReentrant&&process.domain&&process.domain===d.domains[e])p(!1);else if(d.queues[e].length>=m)f(!1,new Error("Too many pending tasks in queue "+e));else{var R=function(){p(!0)};s.skipQueue?d.queues[e].unshift(R):d.queues[e].push(R);var S=s.timeout||d.timeout;S&&(u=setTimeout(function(){u=null,f(!1,new Error("async-lock timed out in queue "+e))},S))}var P=s.maxOccupationTime||d.maxOccupationTime;if(P&&(c=setTimeout(function(){d.queues[e]&&f(!1,new Error("Maximum occupation time is exceeded in queue "+e))},P)),a)return a},t.prototype._acquireBatch=function(e,n,r,s){typeof r!="function"&&(s=r,r=null);var o=this,i=function(l,u){return function(c){o.acquire(l,u,c,s)}},a=e.reduceRight(function(l,u){return i(u,l)},n);if(typeof r=="function")a(r);else return new this.Promise(function(l,u){a.length===1?a(function(c,h){c?u(c):l(h)}):l(a())})},t.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0},t.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(n){return this.Promise.reject(n)}},Bo=t,Bo}var zl,Kl;function Bm(){return Kl||(Kl=1,zl=Pm()),zl}var $m=Bm();const Hm=Ne($m),jm=new Set(["true","false"]);function Wm(t){return jm.has(t.toLowerCase())}const gr="__INTERNAL_EDITOR__",Ra=`${gr}DOCS_NORMAL`,ba=`${gr}DOCS_FORMULA_BAR`,Yc=`${gr}ZEN_EDITOR`,zc=`${gr}COMMENT_EDITOR`,Kc=`\r
`,Xc="isRowStylePrecedeColumnStyle",Jc=Symbol("AUTO_HEIGHT_FOR_MERGED_CELLS");function Vm(t){return`${gr}${t}`}function Qc(t){return t.startsWith(gr)}function Gm(t){return t===zc}function Ym(t,e){e.forEach(n=>t.add(n))}function qc(t,e){e.forEach(([n])=>{t.has(n)&&t.get(n)})}function Zc(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;const s=Object.prototype.hasOwnProperty.bind(e);for(let o=0;o<n.length;o++){const i=n[o];if(!s(i))return!1;const a=t[i],l=e[i];if(a!==l)return!1}return!0}class Gs extends Error{constructor(e){super(e),this.name="CustomCommandExecutionError"}}class zm extends Gs{constructor(){super("Canceled by facade"),this.name="CanceledError"}}function Km(t,e=16){let n=0,r=null;return function(...s){const o=Date.now();o-n<e?(r&&clearTimeout(r),r=setTimeout(()=>{n=o,t.apply(this,s)},e)):(n=o,t.apply(this,s))}}var Zn=(t=>(t[t.Style=1]="Style",t[t.Value=2]="Value",t))(Zn||{});function Xm(t){return`sheet_interceptor_${t}`}const th=t=>function(e,n){let r=-1,s=e;for(let o=0;o<=t.length;o++){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=o,o===t.length)return s;const i=t[o];let a=!1;if(s=i.handler(s,n,l=>(a=!0,l)),!a)break}return s};class Jm{constructor(e){_(this,"_interceptorsByName",new Map),_(this,"_interceptorPoints"),this._interceptorPoints=e}fetchThroughInterceptors(e,n){const r=e;let s=this._interceptorsByName.get(r);return n&&(s=s.filter(n)),th(s||[])}intercept(e,n){const r=e;this._interceptorsByName.has(r)||this._interceptorsByName.set(r,[]);const s=this._interceptorsByName.get(r);return s.push(n),this._interceptorsByName.set(r,s.sort((o,i)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)})),()=>ns(this._interceptorsByName.get(r),n)}getInterceptPoints(){return this._interceptorPoints}dispose(){this._interceptorsByName.clear()}}function Qm(t){return`sheet_async_interceptor_${t}`}const qm=t=>async function(e,n){let r=-1,s=e;for(let o=0;o<=t.length;o++){if(o<=r)throw new Error("[SheetInterceptorService]: next() called multiple times!");if(r=o,o===t.length)return s;const i=t[o];let a=!1;if(s=await i.handler(s,n,async l=>(a=!0,l)),!a)break}return s};class Zm{constructor(e){_(this,"_asyncInterceptorsByName",new Map),_(this,"_asyncInterceptorPoints"),this._asyncInterceptorPoints=e}fetchThroughAsyncInterceptors(e,n){const r=e;let s=this._asyncInterceptorsByName.get(r);return n&&(s=s.filter(n)),qm(s||[])}async interceptAsync(e,n){const r=e;this._asyncInterceptorsByName.has(r)||this._asyncInterceptorsByName.set(r,[]);const s=this._asyncInterceptorsByName.get(r);return s.push(n),this._asyncInterceptorsByName.set(r,s.sort((o,i)=>{var a,l;return((a=i.priority)!=null?a:0)-((l=o.priority)!=null?l:0)})),()=>ns(this._asyncInterceptorsByName.get(r),n)}getInterceptPoints(){return this._asyncInterceptorPoints}dispose(){this._asyncInterceptorsByName.clear()}}function eh(t){return t.map(e=>e/255)}function nh(t){return t.map(e=>Math.round(e*255))}function t0([t,e,n]){const r=Math.max(t,e,n),s=Math.min(t,e,n),o=(r+s)/2;let i=0,a=0;if(r!==s){const l=r-s;switch(a=o>.5?l/(2-r-s):l/(r+s),r){case t:i=(e-n)/l+(e<n?6:0);break;case e:i=(n-t)/l+2;break;case n:i=(t-e)/l+4;break}i/=6}return[i,a,o]}function Ys(t,e,n){const r=[t,e,n].map(s=>s<=.03928?s/12.92:((s+.055)/1.055)**2.4);return .2126*r[0]+.7152*r[1]+.0722*r[2]}function Xl(t,e){return(Math.max(t,e)+.05)/(Math.min(t,e)+.05)}function e0(t,e,n){let r,s,o;if(e===0)r=s=o=n;else{const i=(u,c,h)=>{let d=h;return d<0&&(d+=1),d>1&&(d-=1),d<.16666666666666666?u+(c-u)*6*d:d<.5?c:d<.6666666666666666?u+(c-u)*(.6666666666666666-d)*6:u},a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=i(l,a,t+1/3),s=i(l,a,t),o=i(l,a,t-1/3)}return[r,s,o]}const $o={r:1,g:1,b:1},Ho={r:0,g:0,b:0},n0=Ys($o.r,$o.g,$o.b),r0=Ys(Ho.r,Ho.g,Ho.b);function s0(t){const e=Ys(t[0],t[1],t[2]),n=Xl(n0,e),r=t0(t);let s=1-r[2],o,i,a;do o=e0(r[0],r[1],s),i=Ys(o[0],o[1],o[2]),a=Xl(i,r0),s+=.01;while(s<=1&&s>=0&&Math.abs(a-n)<.01);return o}function o0(t){return nh(s0(eh(t)))}const Ie=[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0]];function i0(t){const e=t[0],n=t[1],r=t[2];let s=[Ie[0][0]*e+Ie[0][1]*n+Ie[0][2]*r+Ie[0][4],Ie[1][0]*e+Ie[1][1]*n+Ie[1][2]*r+Ie[1][4],Ie[2][0]*e+Ie[2][1]*n+Ie[2][2]*r+Ie[2][4]];return s=s.map(o=>o>1?1:o<0?0:o),s}function a0(t){return nh(i0(eh(t)))}var rh=typeof global=="object"&&global&&global.Object===Object&&global,l0=typeof self=="object"&&self&&self.Object===Object&&self,Fn=rh||l0||Function("return this")(),ur=Fn.Symbol,sh=Object.prototype,u0=sh.hasOwnProperty,c0=sh.toString,Cr=ur?ur.toStringTag:void 0;function h0(t){var e=u0.call(t,Cr),n=t[Cr];try{t[Cr]=void 0;var r=!0}catch{}var s=c0.call(t);return r&&(e?t[Cr]=n:delete t[Cr]),s}var d0=Object.prototype,f0=d0.toString;function p0(t){return f0.call(t)}var g0="[object Null]",m0="[object Undefined]",Jl=ur?ur.toStringTag:void 0;function rs(t){return t==null?t===void 0?m0:g0:Jl&&Jl in Object(t)?h0(t):p0(t)}function mr(t){return t!=null&&typeof t=="object"}var _0="[object Symbol]";function yo(t){return typeof t=="symbol"||mr(t)&&rs(t)==_0}function y0(t,e){for(var n=-1,r=t==null?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}var cr=Array.isArray,Ql=ur?ur.prototype:void 0,ql=Ql?Ql.toString:void 0;function oh(t){if(typeof t=="string")return t;if(cr(t))return y0(t,oh)+"";if(yo(t))return ql?ql.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var E0=/\s/;function v0(t){for(var e=t.length;e--&&E0.test(t.charAt(e)););return e}var C0=/^\s+/;function R0(t){return t&&t.slice(0,v0(t)+1).replace(C0,"")}function De(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Zl=NaN,b0=/^[-+]0x[0-9a-f]+$/i,T0=/^0b[01]+$/i,I0=/^0o[0-7]+$/i,w0=parseInt;function tu(t){if(typeof t=="number")return t;if(yo(t))return Zl;if(De(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=De(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=R0(t);var n=T0.test(t);return n||I0.test(t)?w0(t.slice(2),n?2:8):b0.test(t)?Zl:+t}function ih(t){return t}var S0="[object AsyncFunction]",A0="[object Function]",O0="[object GeneratorFunction]",D0="[object Proxy]";function Ta(t){if(!De(t))return!1;var e=rs(t);return e==A0||e==O0||e==S0||e==D0}var jo=Fn["__core-js_shared__"],eu=(function(){var t=/[^.]+$/.exec(jo&&jo.keys&&jo.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function N0(t){return!!eu&&eu in t}var x0=Function.prototype,M0=x0.toString;function L0(t){if(t!=null){try{return M0.call(t)}catch{}try{return t+""}catch{}}return""}var U0=/[\\^$.*+?()[\]{}|]/g,F0=/^\[object .+?Constructor\]$/,k0=Function.prototype,P0=Object.prototype,B0=k0.toString,$0=P0.hasOwnProperty,H0=RegExp("^"+B0.call($0).replace(U0,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function j0(t){if(!De(t)||N0(t))return!1;var e=Ta(t)?H0:F0;return e.test(L0(t))}function W0(t,e){return t?.[e]}function Ia(t,e){var n=W0(t,e);return j0(n)?n:void 0}var nu=Object.create,V0=(function(){function t(){}return function(e){if(!De(e))return{};if(nu)return nu(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}})();function G0(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Y0(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var z0=800,K0=16,X0=Date.now;function J0(t){var e=0,n=0;return function(){var r=X0(),s=K0-(r-n);if(n=r,s>0){if(++e>=z0)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Q0(t){return function(){return t}}var zs=(function(){try{var t=Ia(Object,"defineProperty");return t({},"",{}),t}catch{}})(),q0=zs?function(t,e){return zs(t,"toString",{configurable:!0,enumerable:!1,value:Q0(e),writable:!0})}:ih,Z0=J0(q0),t_=9007199254740991,e_=/^(?:0|[1-9]\d*)$/;function wa(t,e){var n=typeof t;return e=e??t_,!!e&&(n=="number"||n!="symbol"&&e_.test(t))&&t>-1&&t%1==0&&t<e}function Sa(t,e,n){e=="__proto__"&&zs?zs(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Eo(t,e){return t===e||t!==t&&e!==e}var n_=Object.prototype,r_=n_.hasOwnProperty;function ah(t,e,n){var r=t[e];(!(r_.call(t,e)&&Eo(r,n))||n===void 0&&!(e in t))&&Sa(t,e,n)}function s_(t,e,n,r){var s=!n;n||(n={});for(var o=-1,i=e.length;++o<i;){var a=e[o],l=void 0;l===void 0&&(l=t[a]),s?Sa(n,a,l):ah(n,a,l)}return n}var ru=Math.max;function o_(t,e,n){return e=ru(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,o=ru(r.length-e,0),i=Array(o);++s<o;)i[s]=r[e+s];s=-1;for(var a=Array(e+1);++s<e;)a[s]=r[s];return a[e]=n(i),G0(t,this,a)}}function i_(t,e){return Z0(o_(t,e,ih),t+"")}var a_=9007199254740991;function lh(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=a_}function Aa(t){return t!=null&&lh(t.length)&&!Ta(t)}function l_(t,e,n){if(!De(n))return!1;var r=typeof e;return(r=="number"?Aa(n)&&wa(e,n.length):r=="string"&&e in n)?Eo(n[e],t):!1}function uh(t){return i_(function(e,n){var r=-1,s=n.length,o=s>1?n[s-1]:void 0,i=s>2?n[2]:void 0;for(o=t.length>3&&typeof o=="function"?(s--,o):void 0,i&&l_(n[0],n[1],i)&&(o=s<3?void 0:o,s=1),e=Object(e);++r<s;){var a=n[r];a&&t(e,a,r,o)}return e})}var u_=Object.prototype;function ch(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||u_;return t===n}function c_(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var h_="[object Arguments]";function su(t){return mr(t)&&rs(t)==h_}var hh=Object.prototype,d_=hh.hasOwnProperty,f_=hh.propertyIsEnumerable,_i=su((function(){return arguments})())?su:function(t){return mr(t)&&d_.call(t,"callee")&&!f_.call(t,"callee")};function p_(){return!1}var dh=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ou=dh&&typeof module=="object"&&module&&!module.nodeType&&module,g_=ou&&ou.exports===dh,iu=g_?Fn.Buffer:void 0,m_=iu?iu.isBuffer:void 0,fh=m_||p_,__="[object Arguments]",y_="[object Array]",E_="[object Boolean]",v_="[object Date]",C_="[object Error]",R_="[object Function]",b_="[object Map]",T_="[object Number]",I_="[object Object]",w_="[object RegExp]",S_="[object Set]",A_="[object String]",O_="[object WeakMap]",D_="[object ArrayBuffer]",N_="[object DataView]",x_="[object Float32Array]",M_="[object Float64Array]",L_="[object Int8Array]",U_="[object Int16Array]",F_="[object Int32Array]",k_="[object Uint8Array]",P_="[object Uint8ClampedArray]",B_="[object Uint16Array]",$_="[object Uint32Array]",Pt={};Pt[x_]=Pt[M_]=Pt[L_]=Pt[U_]=Pt[F_]=Pt[k_]=Pt[P_]=Pt[B_]=Pt[$_]=!0;Pt[__]=Pt[y_]=Pt[D_]=Pt[E_]=Pt[N_]=Pt[v_]=Pt[C_]=Pt[R_]=Pt[b_]=Pt[T_]=Pt[I_]=Pt[w_]=Pt[S_]=Pt[A_]=Pt[O_]=!1;function H_(t){return mr(t)&&lh(t.length)&&!!Pt[rs(t)]}function j_(t){return function(e){return t(e)}}var ph=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jr=ph&&typeof module=="object"&&module&&!module.nodeType&&module,W_=jr&&jr.exports===ph,Wo=W_&&rh.process,au=(function(){try{var t=jr&&jr.require&&jr.require("util").types;return t||Wo&&Wo.binding&&Wo.binding("util")}catch{}})(),lu=au&&au.isTypedArray,gh=lu?j_(lu):H_;function V_(t,e){var n=cr(t),r=!n&&_i(t),s=!n&&!r&&fh(t),o=!n&&!r&&!s&&gh(t),i=n||r||s||o,a=i?c_(t.length,String):[],l=a.length;for(var u in t)i&&(u=="length"||s&&(u=="offset"||u=="parent")||o&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||wa(u,l))||a.push(u);return a}function G_(t,e){return function(n){return t(e(n))}}function Y_(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var z_=Object.prototype,K_=z_.hasOwnProperty;function X_(t){if(!De(t))return Y_(t);var e=ch(t),n=[];for(var r in t)r=="constructor"&&(e||!K_.call(t,r))||n.push(r);return n}function mh(t){return Aa(t)?V_(t):X_(t)}var J_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q_=/^\w*$/;function q_(t,e){if(cr(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||yo(t)?!0:Q_.test(t)||!J_.test(t)||e!=null&&t in Object(e)}var zr=Ia(Object,"create");function Z_(){this.__data__=zr?zr(null):{},this.size=0}function ty(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var ey="__lodash_hash_undefined__",ny=Object.prototype,ry=ny.hasOwnProperty;function sy(t){var e=this.__data__;if(zr){var n=e[t];return n===ey?void 0:n}return ry.call(e,t)?e[t]:void 0}var oy=Object.prototype,iy=oy.hasOwnProperty;function ay(t){var e=this.__data__;return zr?e[t]!==void 0:iy.call(e,t)}var ly="__lodash_hash_undefined__";function uy(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=zr&&e===void 0?ly:e,this}function On(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}On.prototype.clear=Z_;On.prototype.delete=ty;On.prototype.get=sy;On.prototype.has=ay;On.prototype.set=uy;function cy(){this.__data__=[],this.size=0}function vo(t,e){for(var n=t.length;n--;)if(Eo(t[n][0],e))return n;return-1}var hy=Array.prototype,dy=hy.splice;function fy(t){var e=this.__data__,n=vo(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():dy.call(e,n,1),--this.size,!0}function py(t){var e=this.__data__,n=vo(e,t);return n<0?void 0:e[n][1]}function gy(t){return vo(this.__data__,t)>-1}function my(t,e){var n=this.__data__,r=vo(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function en(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}en.prototype.clear=cy;en.prototype.delete=fy;en.prototype.get=py;en.prototype.has=gy;en.prototype.set=my;var _h=Ia(Fn,"Map");function _y(){this.size=0,this.__data__={hash:new On,map:new(_h||en),string:new On}}function yy(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Co(t,e){var n=t.__data__;return yy(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Ey(t){var e=Co(this,t).delete(t);return this.size-=e?1:0,e}function vy(t){return Co(this,t).get(t)}function Cy(t){return Co(this,t).has(t)}function Ry(t,e){var n=Co(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function yn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}yn.prototype.clear=_y;yn.prototype.delete=Ey;yn.prototype.get=vy;yn.prototype.has=Cy;yn.prototype.set=Ry;var by="Expected a function";function Oa(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(by);var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],o=n.cache;if(o.has(s))return o.get(s);var i=t.apply(this,r);return n.cache=o.set(s,i)||o,i};return n.cache=new(Oa.Cache||yn),n}Oa.Cache=yn;var Ty=500;function Iy(t){var e=Oa(t,function(r){return n.size===Ty&&n.clear(),r}),n=e.cache;return e}var wy=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sy=/\\(\\)?/g,Ay=Iy(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(wy,function(n,r,s,o){e.push(s?o.replace(Sy,"$1"):r||n)}),e});function Oy(t){return t==null?"":oh(t)}function yh(t,e){return cr(t)?t:q_(t,e)?[t]:Ay(Oy(t))}function Eh(t){if(typeof t=="string"||yo(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Dy(t,e){e=yh(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[Eh(e[n++])];return n&&n==r?t:void 0}function vh(t,e,n){var r=t==null?void 0:Dy(t,e);return r===void 0?n:r}var Ch=G_(Object.getPrototypeOf,Object),Ny="[object Object]",xy=Function.prototype,My=Object.prototype,Rh=xy.toString,Ly=My.hasOwnProperty,Uy=Rh.call(Object);function Fy(t){if(!mr(t)||rs(t)!=Ny)return!1;var e=Ch(t);if(e===null)return!0;var n=Ly.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Rh.call(n)==Uy}function ky(){this.__data__=new en,this.size=0}function Py(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function By(t){return this.__data__.get(t)}function $y(t){return this.__data__.has(t)}var Hy=200;function jy(t,e){var n=this.__data__;if(n instanceof en){var r=n.__data__;if(!_h||r.length<Hy-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new yn(r)}return n.set(t,e),this.size=n.size,this}function _r(t){var e=this.__data__=new en(t);this.size=e.size}_r.prototype.clear=ky;_r.prototype.delete=Py;_r.prototype.get=By;_r.prototype.has=$y;_r.prototype.set=jy;var bh=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uu=bh&&typeof module=="object"&&module&&!module.nodeType&&module,Wy=uu&&uu.exports===bh,cu=Wy?Fn.Buffer:void 0;cu&&cu.allocUnsafe;function Vy(t,e){return t.slice()}var hu=Fn.Uint8Array;function Gy(t){var e=new t.constructor(t.byteLength);return new hu(e).set(new hu(t)),e}function Yy(t,e){var n=Gy(t.buffer);return new t.constructor(n,t.byteOffset,t.length)}function zy(t){return typeof t.constructor=="function"&&!ch(t)?V0(Ch(t)):{}}function Ky(t){return function(e,n,r){for(var s=-1,o=Object(e),i=r(e),a=i.length;a--;){var l=i[++s];if(n(o[l],l,o)===!1)break}return e}}var Xy=Ky(),Vo=function(){return Fn.Date.now()},Jy="Expected a function",Qy=Math.max,qy=Math.min;function Zy(t,e,n){var r,s,o,i,a,l,u=0,c=!1,h=!1,d=!0;if(typeof t!="function")throw new TypeError(Jy);e=tu(e)||0,De(n)&&(c=!!n.leading,h="maxWait"in n,o=h?Qy(tu(n.maxWait)||0,e):o,d="trailing"in n?!!n.trailing:d);function f(b){var v=r,N=s;return r=s=void 0,u=b,i=t.apply(N,v),i}function p(b){return u=b,a=setTimeout(S,e),c?f(b):i}function m(b){var v=b-l,N=b-u,V=e-v;return h?qy(V,o-N):V}function R(b){var v=b-l,N=b-u;return l===void 0||v>=e||v<0||h&&N>=o}function S(){var b=Vo();if(R(b))return P(b);a=setTimeout(S,m(b))}function P(b){return a=void 0,d&&r?f(b):(r=s=void 0,i)}function k(){a!==void 0&&clearTimeout(a),u=0,r=l=s=a=void 0}function H(){return a===void 0?i:P(Vo())}function C(){var b=Vo(),v=R(b);if(r=arguments,s=this,l=b,v){if(a===void 0)return p(l);if(h)return clearTimeout(a),a=setTimeout(S,e),f(l)}return a===void 0&&(a=setTimeout(S,e)),i}return C.cancel=k,C.flush=H,C}function yi(t,e,n){(n!==void 0&&!Eo(t[e],n)||n===void 0&&!(e in t))&&Sa(t,e,n)}function tE(t){return mr(t)&&Aa(t)}function Ei(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function eE(t){return s_(t,mh(t))}function nE(t,e,n,r,s,o,i){var a=Ei(t,n),l=Ei(e,n),u=i.get(l);if(u){yi(t,n,u);return}var c=o?o(a,l,n+"",t,e,i):void 0,h=c===void 0;if(h){var d=cr(l),f=!d&&fh(l),p=!d&&!f&&gh(l);c=l,d||f||p?cr(a)?c=a:tE(a)?c=Y0(a):f?(h=!1,c=Vy(l)):p?(h=!1,c=Yy(l)):c=[]:Fy(l)||_i(l)?(c=a,_i(a)?c=eE(a):(!De(a)||Ta(a))&&(c=zy(l))):h=!1}h&&(i.set(l,c),s(c,l,r,o,i),i.delete(l)),yi(t,n,c)}function Da(t,e,n,r,s){t!==e&&Xy(e,function(o,i){if(s||(s=new _r),De(o))nE(t,e,i,n,Da,r,s);else{var a=r?r(Ei(t,i),o,i+"",t,e,s):void 0;a===void 0&&(a=o),yi(t,i,a)}},mh)}var rE=uh(function(t,e,n,r){Da(t,e,n,r)}),Ro=uh(function(t,e,n){Da(t,e,n)});function sE(t,e,n,r){if(!De(t))return t;e=yh(e,t);for(var s=-1,o=e.length,i=o-1,a=t;a!=null&&++s<o;){var l=Eh(e[s]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(s!=i){var c=a[l];u=void 0,u===void 0&&(u=De(c)?c:wa(e[s+1])?[]:{})}ah(a,l,u),a=a[l]}return t}function oE(t,e,n){return t==null?t:sE(t,e,n)}class kn{constructor(){_(this,"cursor",0)}reset(){return this.cursor=0,this}moveCursor(e){this.cursor+=e}moveCursorTo(e){this.cursor=e}}function iE(t,e){for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function Th(t){return/^-?\d+(\.\d+)?$/.test(t)}function aE(t){return Th(t)?Number(t)<=Number.MAX_SAFE_INTEGER:!1}function lE(t){return Number(t)>Number.MAX_SAFE_INTEGER||t.length>=18}class Na{constructor(){_(this,"_data",[])}static create(){return new Na}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const n=this._data.indexOf(e);this._data.splice(n,1)}getData(){return this._data}}class xa{constructor(){_(this,"_data",new Map)}static create(){return new xa}add(e,n){this._data.has(e)||this._data.set(e,n)}delete(e){this._data.delete(e)}getData(){return this._data}}function uE(t){const e=new MessageChannel;let n=!1;const r=()=>{n||t()};return e.port1.onmessage=r,e.port2.postMessage(null),()=>{n=!0,e.port1.onmessage=null,e.port1.close(),e.port2.close()}}async function Ih(t){for(const[e,n]of t.entries())try{if(!await n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function wh(t){for(const[e,n]of t.entries())try{if(!n())return{index:e,result:!1}}catch(r){return{index:e,result:!1,error:r}}return{result:!0,index:-1}}function cE(t,e){return e.forEach(n=>t.add(n)),t}function hE(t){return t instanceof dr||t instanceof se||t&&"closed"in t&&typeof t.unsubscribe<"u"}function Wt(t){let e=!1;return t?hE(t)?{dispose:()=>t.unsubscribe()}:typeof t=="function"?{dispose:()=>{e||(e=!0,t())}}:t:Wt(()=>{})}class bo{constructor(){_(this,"_disposables",new Set)}add(e){const n=Wt(e);return this._disposables.add(n),{dispose:(r=!1)=>{r||n.dispose(),this._disposables.delete(n)}}}dispose(){this._disposables.forEach(e=>{e.dispose()}),this._disposables.clear()}}let Xt=class{constructor(){_(this,"_disposed",!1),_(this,"_collection",new bo)}disposeWithMe(e){return this._collection.add(e)}ensureNotDisposed(){if(this._disposed)throw new Error("[Disposable]: object is disposed!")}dispose(){this._disposed||(this._disposed=!0,this._collection.dispose())}};class dE extends Xt{constructor(){super(...arguments),_(this,"dispose$",new se)}dispose(){super.dispose(),this.dispose$.next(),this.dispose$.complete()}}class fE extends Xt{constructor(e){super(),_(this,"_ref",0),this._rootDisposable=e}inc(){if(this._disposed)throw new Error("[RCDisposable]: should not ref to a disposed.");this._ref+=1}dec(){this._ref-=1,this._ref===0&&(this._rootDisposable.dispose(),this.dispose())}}var bt=(t=>(t[t.UNIVER_UNKNOWN=0]="UNIVER_UNKNOWN",t[t.UNIVER_DOC=1]="UNIVER_DOC",t[t.UNIVER_SHEET=2]="UNIVER_SHEET",t[t.UNIVER_SLIDE=3]="UNIVER_SLIDE",t[t.UNIVER_PROJECT=4]="UNIVER_PROJECT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(bt||{}),vt=(t=>(t[t.Reader=0]="Reader",t[t.Editor=1]="Editor",t[t.Owner=2]="Owner",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(vt||{}),vi=(t=>(t[t.SomeCollaborator=0]="SomeCollaborator",t[t.AllCollaborator=1]="AllCollaborator",t[t.OneSelf=2]="OneSelf",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t))(vi||{});class To extends Xt{}const Sh=new Set(["ac","ad","ae","aero","af","ag","ai","al","am","ao","aq","ar","arpa","as","asia","at","au","aw","ax","az","ba","bb","bd","be","bf","bg","bh","bi","biz","bj","bm","bn","bo","br","bs","bt","bv","bw","by","bz","ca","cat","cc","cd","cf","cg","ch","ci","ck","cl","cm","cn","co","com","coop","cr","cu","cv","cw","cx","cy","cz","de","dj","dk","dm","do","dz","ec","edu","ee","eg","er","es","et","eu","fi","fj","fk","fm","fo","fr","ga","gb","gd","ge","gf","gg","gh","gi","gl","gm","gn","gov","gp","gq","gr","gs","gt","gu","gw","gy","hk","hm","hn","hr","ht","hu","id","ie","il","im","in","info","int","io","iq","ir","is","it","je","jm","jo","jobs","jp","ke","kg","kh","ki","km","kn","kp","kr","kw","ky","kz","la","lb","lc","li","lk","lr","ls","lt","lu","lv","ly","ma","mc","md","me","mg","mh","mil","mk","ml","mm","mn","mo","mobi","mp","mq","mr","ms","mt","mu","museum","mv","mw","mx","my","mz","na","name","nc","ne","net","nf","ng","ni","nl","no","np","nr","nu","nz","om","onion","org","pa","pe","pf","pg","ph","pk","pl","pm","pn","post","pr","pro","ps","pt","pw","py","qa","re","ro","rs","ru","rw","sa","sb","sc","sd","se","sg","sh","si","sj","sk","sl","sm","sn","so","sr","ss","st","su","sv","sx","sy","sz","tc","td","tel","tf","tg","th","tj","tk","tl","tm","tn","to","tr","tt","tv","tw","tz","ua","ug","uk","us","uy","uz","va","vc","ve","vg","vi","vn","vu","wf","ws","yt","za","zm","zw"]),pE=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)?(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");function gE(t){if(!Number.isNaN(+t))return!1;if(t.startsWith("http://localhost:3002")||t.startsWith("localhost:3002"))return!0;if(pE.test(t)){if(Ah(t))return!0;try{const e=new URL(Oh(t)).hostname.split(".").pop();if(e&&Sh.has(e))return!0}catch{return!1}}return!1}function Ah(t){return/^[a-zA-Z]+:\/\//.test(t)}function mE(t){return/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(t)}function Oh(t){return Ah(t)?t:mE(t)?`mailto://${t}`:`https://${t}`}function _E(t,e){try{const n=new URL(e),r=n.pathname.endsWith("/")?n.pathname:`${n.pathname}/`,s=t.startsWith("/")?t.substring(1):t;return new URL(s,n.origin+r).toString()}catch(n){return console.error("Error resolving URL with base URL:",n),t}}const yE="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let EE=t=>crypto.getRandomValues(new Uint8Array(t)),vE=(t,e,n)=>{let r=(2<<Math.log2(t.length-1))-1,s=-~(1.6*r*e/t.length);return(o=e)=>{let i="";for(;;){let a=n(s),l=s|0;for(;l--;)if(i+=t[a[l]&r]||"",i.length>=o)return i}}},CE=(t,e=21)=>vE(t,e|0,EE),RE=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=yE[n[t]&63];return e};const on=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function Ma(t,e){const n=q.getValueType(t),r=q.getValueType(e);return n!==r?!1:q.isArray(t)?bE(t,e):q.isObject(t)?TE(t,e):q.isDate(t)?t.getTime()===e.getTime():q.isRegExp(t)?t.toString()===e.toString():t===e}function bE(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++){const s=t[n],o=e[n];if(!Ma(s,o))return!1}return!0}function TE(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(!Ma(o,i))return!1}return!0}class q{static deleteNull(e){for(const n in e)(e[n]===null||e[n]===void 0)&&delete e[n];return e}static stringAt(e){let n="",r=e;for(;r>=on.length;)r/=on.length,r-=1,n+=on[r%on.length];const s=e%on.length;return n+=on[s],n}static indexAt(e){let n=0;for(let r=0;r<e.length-1;r+=1){const s=e.charCodeAt(r)-65,o=e.length-1-r;n+=on.length**o+on.length*s}return n+=e.charCodeAt(e.length-1)-65,n}static deleteBlank(e){return q.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,n=navigator.platform==="Win32"||navigator.platform==="Windows",r=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(r)return"Mac";if(navigator.platform==="X11"&&!n&&!r)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(n){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,n=e.indexOf("Opera")>-1,r=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,s=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(r){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const u=Number.parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return i?"FF":n?"Opera":a?"Safari":l?"Chrome":o?"Edge":s?"IE11":"Unknown browser"}static getClassName(e){return e.constructor.name}static deepMerge(e,...n){n.forEach(i=>i&&o(i));function r(i,a){i.forEach((l,u)=>{var c,h;if(q.isArray(l)){const d=(c=a[u])!=null?c:[];a[u]=d,r(l,d);return}if(q.isObject(l)){const d=(h=a[u])!=null?h:{};a[u]=d,s(l,d);return}a[u]=l})}function s(i,a){Object.keys(i).forEach(l=>{var u,c;const h=i[l];if(q.isObject(h)){const d=(u=a[l])!=null?u:{};a[l]=d,s(h,d);return}if(q.isArray(h)){const d=(c=a[l])!=null?c:[];a[l]=d,r(h,d);return}a[l]=h})}function o(i){Object.keys(i).forEach(a=>{var l,u;const c=i[a];if(q.isArray(c)){const h=(l=e[a])!=null?l:[];e[a]=h,r(c,h);return}if(q.isObject(c)){const h=(u=e[a])!=null?u:{};e[a]=h,s(c,h);return}e[a]=c})}return e}static numberFixed(e,n){return Number(Number(e).toFixed(n))}static diffValue(e,n){return Ma(e,n)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const n=[];return e.forEach((r,s)=>{n[s]=q.deepClone(r)}),n}if(this.isObject(e)){const n={};return Object.keys(e).forEach(r=>{const s=e[r];n[r]=q.deepClone(s)}),Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}return e}static getLanguage(){return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||"en-US"}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(Number.parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const n in e)return!1;return!0}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isLegalUrl(e){return gE(e)}static normalizeUrl(e){return Oh(e)}static topLevelDomainCombiningString(){return[...Sh].join("|")}static removeNull(e){return this.isObject(e)&&Object.keys(e).forEach(n=>{const r=e[n];r==null?delete e[n]:q.removeNull(r)}),e}static fillTwoDimensionalArray(e,n,r){return new Array(e).fill(r).map(s=>new Array(n).fill(r))}static numToWord(e){let n="";for(;e>0;){let r=e%26;r=r===0?r=26:r,n=String.fromCharCode(96+r)+n,e=(e-r)/26}return n.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return Number.NaN;const n=e.toLowerCase().split(""),r=n.length;let s=0,o=0;for(let i=0;i<r;i++)o=n[i].charCodeAt(0)-96,s+=o*26**(r-i-1);return s===0?Number.NaN:s-1}static chatAtABC(e){let n="";for(;e>=0;)n=String.fromCharCode(e%26+97)+n,e=Math.floor(e/26)-1;return n.toUpperCase()}static commonExtend(e,n){const r={};for(const s in e)r[s]=e[s];for(const s in n)n[s]!=null&&(r[s]=n[s]);return r}static hasIntersectionBetweenTwoRanges(e,n,r,s){return n>=r&&s>=e}static isStartValidPosition(e){return/^[A-Za-z--_]/.test(e)}static isValidParameter(e){const n=/[~!@#$%^&*()+=\-{}\[\]\|:;"'<>,?\/ ]+/.test(e),r=e.length<=255;return!n&&r}static clamp(e,n,r){return Math.max(n,Math.min(r,e))}static now(){return performance&&performance.now?performance.now():Date.now()}}function re(t=21,e){return e?CE(e,t)():RE(t)}function wr(...t){const e={},n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s){const o=Object.keys(s);for(const i of o)e[i]===void 0&&(e[i]=s[i])}}return e}const IE=()=>typeof process<"u"&&process.versions!=null&&process.versions.node!=null;function wE(t){const e=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\\\*/g,".*").replace(/\\\?/g,".");return new RegExp(`^${e}$`,"i")}var Dh=(t=>(t[t.DEFAULT_SERIES=0]="DEFAULT_SERIES",t[t.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",t))(Dh||{}),Mt=(t=>(t[t.NONE=0]="NONE",t[t.THIN=1]="THIN",t[t.HAIR=2]="HAIR",t[t.DOTTED=3]="DOTTED",t[t.DASHED=4]="DASHED",t[t.DASH_DOT=5]="DASH_DOT",t[t.DASH_DOT_DOT=6]="DASH_DOT_DOT",t[t.DOUBLE=7]="DOUBLE",t[t.MEDIUM=8]="MEDIUM",t[t.MEDIUM_DASHED=9]="MEDIUM_DASHED",t[t.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",t[t.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",t[t.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",t[t.THICK=13]="THICK",t))(Mt||{}),Nh=(t=>(t.TOP="top",t.BOTTOM="bottom",t.LEFT="left",t.RIGHT="right",t.NONE="none",t.ALL="all",t.OUTSIDE="outside",t.INSIDE="inside",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.TLBR="tlbr",t.TLBC_TLMR="tlbc_tlmr",t.TLBR_TLBC_TLMR="tlbr_tlbc_tlmr",t.BLTR="bl_tr",t.MLTR_BCTR="mltr_bctr",t))(Nh||{}),Se=(t=>(t[t.UNSUPPORTED=0]="UNSUPPORTED",t[t.RGB=1]="RGB",t[t.HEX=2]="HEX",t[t.THEME=3]="THEME",t))(Se||{}),xh=(t=>(t[t.ON=0]="ON",t[t.OFF=1]="OFF",t))(xh||{}),Mh=(t=>(t[t.PASTE_NORMAL=0]="PASTE_NORMAL",t[t.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",t[t.PASTE_FORMAT=2]="PASTE_FORMAT",t[t.PASTE_FORMULA=3]="PASTE_FORMULA",t[t.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",t[t.PASTE_VALUES=5]="PASTE_VALUES",t[t.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",t[t.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",t))(Mh||{}),Lh=(t=>(t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT",t))(Lh||{}),Uh=(t=>(t[t.DOCUMENT=0]="DOCUMENT",t[t.PROJECT=1]="PROJECT",t))(Uh||{}),Fh=(t=>(t[t.COLUMNS=0]="COLUMNS",t[t.ROWS=1]="ROWS",t))(Fh||{}),kh=(t=>(t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t))(kh||{});function SE(t){switch(t){case 3:return 1;case 1:return 3;case 0:return 2;case 2:return 0}}var Ph=(t=>(t[t.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",t[t.MIN=1]="MIN",t[t.MAX=2]="MAX",t[t.NUMBER=3]="NUMBER",t[t.PERCENT=4]="PERCENT",t[t.PERCENTILE=5]="PERCENTILE",t))(Ph||{}),ss=(t=>(t.EN_US="enUS",t.FR_FR="frFR",t.ZH_CN="zhCN",t.RU_RU="ruRU",t.ZH_TW="zhTW",t.VI_VN="viVN",t.FA_IR="faIR",t.JA_JP="jaJP",t.KO_KR="koKR",t.ES_ES="esES",t.CA_ES="caES",t.SK_SK="skSK",t))(ss||{}),Ks=(t=>(t[t.PERSON=0]="PERSON",t[t.FILE=1]="FILE",t[t.DATE=2]="DATE",t[t.LOCATION=3]="LOCATION",t[t.EVENT=4]="EVENT",t))(Ks||{}),Bh=(t=>(t[t.RANGE=0]="RANGE",t[t.SHEET=1]="SHEET",t))(Bh||{}),$h=(t=>(t.Line="line",t.LineInv="lineInv",t.Triangle="triangle",t.RtTriangle="rtTriangle",t.Rect="rect",t.Diamond="diamond",t.Parallelogram="parallelogram",t.Trapezoid="trapezoid",t.NonIsocelesTrapezoid="nonIsocelesTrapezoid",t.Pentagon="pentagon",t.Hexagon="hexagon",t.Heptagon="heptagon",t.Octagon="octagon",t.Decagon="decagon",t.Dodecagon="dodecagon",t.Star4="star4",t.Star5="star5",t.Star6="star6",t.Star7="star7",t.Star8="star8",t.Star10="star10",t.Star12="star12",t.Star16="star16",t.Star24="star24",t.Star32="star32",t.RoundRect="roundRect",t.Round1Rect="round1Rect",t.Round2SameRect="round2SameRect",t.Round2DiagRect="round2DiagRect",t.Ellipse="ellipse",t))($h||{}),Hh=(t=>(t.RightArrow="rightArrow",t.LeftArrow="leftArrow",t.UpArrow="upArrow",t.DownArrow="downArrow",t.LeftRightArrow="leftRightArrow",t.UpDownArrow="upDownArrow",t.QuadArrow="quadArrow",t.LeftRightUpArrow="leftRightUpArrow",t.BentArrow="bentArrow",t.UturnArrow="uturnArrow",t.CircularArrow="circularArrow",t.NotchedRightArrow="notchedRightArrow",t.HomePlate="homePlate",t.Chevron="chevron",t.LeftCircularArrow="leftCircularArrow",t.LeftRightCircularArrow="leftRightCircularArrow",t))(Hh||{}),jh=(t=>(t.Plaque="plaque",t.Can="can",t.Cube="cube",t.Bevel="bevel",t.Donut="donut",t.NoSmoking="noSmoking",t.BlockArc="blockArc",t.FoldedCorner="foldedCorner",t))(jh||{}),Wh=(t=>(t.SmileyFace="smileyFace",t.Heart="heart",t.LightningBolt="lightningBolt",t.Sun="sun",t.Moon="moon",t.Cloud="cloud",t.Arc="arc",t.Backpack="backpack",t.Frame="frame",t.HalfFrame="halfFrame",t.Corner="corner",t.Chord="chord",t.Pie="pie",t.Teardrop="teardrop",t.WedgeRectCallout="wedgeRectCallout",t.WedgeRRectCallout="wedgeRRectCallout",t.WedgeEllipseCallout="wedgeEllipseCallout",t.CloudCallout="cloudCallout",t.BorderCallout1="borderCallout1",t.BorderCallout2="borderCallout2",t.BorderCallout3="borderCallout3",t.AccentCallout1="accentCallout1",t.AccentCallout2="accentCallout2",t.AccentCallout3="accentCallout3",t.Callout1="callout1",t.Callout2="callout2",t.Callout3="callout3",t.ActionButtonBackPrevious="actionButtonBackPrevious",t.ActionButtonEnd="actionButtonEnd",t.ActionButtonForwardNext="actionButtonForwardNext",t.ActionButtonHelp="actionButtonHelp",t.ActionButtonHome="actionButtonHome",t.ActionButtonInformation="actionButtonInformation",t.ActionButtonMovie="actionButtonMovie",t.ActionButtonReturn="actionButtonReturn",t.ActionButtonSound="actionButtonSound",t))(Wh||{}),Vh=(t=>(t[t.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",t[t.PAST_YEAR=1]="PAST_YEAR",t[t.PAST_MONTH=2]="PAST_MONTH",t[t.PAST_WEEK=3]="PAST_WEEK",t[t.YESTERDAY=4]="YESTERDAY",t[t.TODAY=5]="TODAY",t[t.TOMORROW=6]="TOMORROW",t))(Vh||{}),Gh=(t=>(t[t.GRID=0]="GRID",t[t.KANBAN=1]="KANBAN",t[t.GANTT=2]="GANTT",t))(Gh||{}),Kr=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",t[t.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",t))(Kr||{}),Yh=(t=>(t[t.DASH=0]="DASH",t[t.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",t[t.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",t[t.DASHED_HEAVY=3]="DASHED_HEAVY",t[t.DASH_LONG=4]="DASH_LONG",t[t.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",t[t.DOT_DASH=6]="DOT_DASH",t[t.DOT_DOT_DASH=7]="DOT_DOT_DASH",t[t.DOTTED=8]="DOTTED",t[t.DOTTED_HEAVY=9]="DOTTED_HEAVY",t[t.DOUBLE=10]="DOUBLE",t[t.NONE=11]="NONE",t[t.SINGLE=12]="SINGLE",t[t.THICK=13]="THICK",t[t.WAVE=14]="WAVE",t[t.WAVY_DOUBLE=15]="WAVY_DOUBLE",t[t.WAVY_HEAVY=16]="WAVY_HEAVY",t[t.WORDS=17]="WORDS",t))(Yh||{}),Fe=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LEFT=1]="LEFT",t[t.CENTER=2]="CENTER",t[t.RIGHT=3]="RIGHT",t[t.JUSTIFIED=4]="JUSTIFIED",t[t.BOTH=5]="BOTH",t[t.DISTRIBUTED=6]="DISTRIBUTED",t))(Fe||{}),In=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TOP=1]="TOP",t[t.MIDDLE=2]="MIDDLE",t[t.BOTTOM=3]="BOTTOM",t))(In||{}),Dn=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.OVERFLOW=1]="OVERFLOW",t[t.CLIP=2]="CLIP",t[t.WRAP=3]="WRAP",t))(Dn||{}),Xs=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC",t))(Xs||{}),Js=(t=>(t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD",t))(Js||{}),tn=(t=>(t[t.NORMAL=1]="NORMAL",t[t.SUBSCRIPT=2]="SUBSCRIPT",t[t.SUPERSCRIPT=3]="SUPERSCRIPT",t))(tn||{}),ot=(t=>(t[t.FALSE=0]="FALSE",t[t.TRUE=1]="TRUE",t))(ot||{}),hn=(t=>(t[t.STRING=1]="STRING",t[t.NUMBER=2]="NUMBER",t[t.BOOLEAN=3]="BOOLEAN",t[t.FORCE_STRING=4]="FORCE_STRING",t))(hn||{}),ce=(t=>(t[t.DARK1=0]="DARK1",t[t.LIGHT1=1]="LIGHT1",t[t.DARK2=2]="DARK2",t[t.LIGHT2=3]="LIGHT2",t[t.ACCENT1=4]="ACCENT1",t[t.ACCENT2=5]="ACCENT2",t[t.ACCENT3=6]="ACCENT3",t[t.ACCENT4=7]="ACCENT4",t[t.ACCENT5=8]="ACCENT5",t[t.ACCENT6=9]="ACCENT6",t[t.HYPERLINK=10]="HYPERLINK",t[t.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",t))(ce||{}),Io=(t=>(t.OFFICE="Office",t.OFFICE_2007_2010="Office 2007-2010",t.GRAYSCALE="Grayscale",t.BLUE_WARM="Blue Warm",t.BLUE="Blue",t.BLUE_II="Blue II",t.BLUE_GREEN="Blue Green",t.GREEN="Green",t.GREEN_YELLOW="Green Yellow",t.YELLOW="Yellow",t.YELLOW_ORANGE="Yellow Orange",t.ORANGE="Orange",t.ORANGE_RED="Orange Red",t.RED_ORANGE="Red Orange",t.RED="Red",t.RED_VIOLET="Red Violet",t.VIOLET="Violet",t.VIOLET_II="Violet II",t.MEDIAN="Median",t.PAPER="Paper",t.MARQUEE="Marquee",t.SLIPSTREAM="Slipstream",t.Aspect="Aspect",t))(Io||{}),zh=(t=>(t[t.character=0]="character",t[t.paragraph=1]="paragraph",t[t.table=2]="table",t[t.numbering=3]="numbering",t))(zh||{}),Kh=(t=>(t[t.TAB=0]="TAB",t[t.SPACE=1]="SPACE",t[t.NOTHING=2]="NOTHING",t))(Kh||{}),dt=(t=>(t[t.BULLET=0]="BULLET",t[t.NONE=1]="NONE",t[t.DECIMAL=2]="DECIMAL",t[t.DECIMAL_ZERO=3]="DECIMAL_ZERO",t[t.UPPER_LETTER=4]="UPPER_LETTER",t[t.LOWER_LETTER=5]="LOWER_LETTER",t[t.UPPER_ROMAN=6]="UPPER_ROMAN",t[t.LOWER_ROMAN=7]="LOWER_ROMAN",t[t.ORDINAL=8]="ORDINAL",t[t.CARDINAL_TEXT=9]="CARDINAL_TEXT",t[t.ORDINAL_TEXT=10]="ORDINAL_TEXT",t[t.HEX=11]="HEX",t[t.CHICAGO=12]="CHICAGO",t[t.IDEOGRAPH_DIGITAL=13]="IDEOGRAPH_DIGITAL",t[t.JAPANESE_COUNTING=14]="JAPANESE_COUNTING",t[t.AIUEO=15]="AIUEO",t[t.IROHA=16]="IROHA",t[t.DECIMAL_FULL_WIDTH=17]="DECIMAL_FULL_WIDTH",t[t.DECIMAL_HALF_WIDTH=18]="DECIMAL_HALF_WIDTH",t[t.JAPANESE_LEGAL=19]="JAPANESE_LEGAL",t[t.JAPANESE_DIGITAL_TEN_THOUSAND=20]="JAPANESE_DIGITAL_TEN_THOUSAND",t[t.DECIMAL_ENCLOSED_CIRCLE=21]="DECIMAL_ENCLOSED_CIRCLE",t[t.DECIMAL_FULL_WIDTH2=22]="DECIMAL_FULL_WIDTH2",t[t.AIUEO_FULL_WIDTH=23]="AIUEO_FULL_WIDTH",t[t.IROHA_FULL_WIDTH=24]="IROHA_FULL_WIDTH",t[t.GANADA=25]="GANADA",t[t.CHOSUNG=26]="CHOSUNG",t[t.DECIMAL_ENCLOSED_FULLSTOP=27]="DECIMAL_ENCLOSED_FULLSTOP",t[t.DECIMAL_ENCLOSED_PAREN=28]="DECIMAL_ENCLOSED_PAREN",t[t.DECIMAL_ENCLOSED_CIRCLE_CHINESE=29]="DECIMAL_ENCLOSED_CIRCLE_CHINESE",t[t.IDEOGRAPH_ENCLOSED_CIRCLE=30]="IDEOGRAPH_ENCLOSED_CIRCLE",t[t.IDEOGRAPH_TRADITIONAL=31]="IDEOGRAPH_TRADITIONAL",t[t.IDEOGRAPH_ZODIAC=32]="IDEOGRAPH_ZODIAC",t[t.IDEOGRAPH_ZODIAC_TRADITIONAL=33]="IDEOGRAPH_ZODIAC_TRADITIONAL",t[t.TAIWANESE_COUNTING=34]="TAIWANESE_COUNTING",t[t.IDEOGRAPH_LEGAL_TRADITIONAL=35]="IDEOGRAPH_LEGAL_TRADITIONAL",t[t.TAIWANESE_COUNTING_THOUSAND=36]="TAIWANESE_COUNTING_THOUSAND",t[t.TAIWANESE_DIGITAL=37]="TAIWANESE_DIGITAL",t[t.CHINESE_COUNTING=38]="CHINESE_COUNTING",t[t.CHINESE_LEGAL_SIMPLIFIED=39]="CHINESE_LEGAL_SIMPLIFIED",t[t.CHINESE_COUNTING_THOUSAND=40]="CHINESE_COUNTING_THOUSAND",t[t.KOREAN_DIGITAL=41]="KOREAN_DIGITAL",t[t.KOREAN_COUNTING=42]="KOREAN_COUNTING",t[t.KOREAN_LEGAL=43]="KOREAN_LEGAL",t[t.KOREAN_DIGITAL2=44]="KOREAN_DIGITAL2",t[t.VIETNAMESE_COUNTING=45]="VIETNAMESE_COUNTING",t[t.RUSSIAN_LOWER=46]="RUSSIAN_LOWER",t[t.RUSSIAN_UPPER=47]="RUSSIAN_UPPER",t[t.NUMBER_IN_DASH=48]="NUMBER_IN_DASH",t[t.HEBREW1=49]="HEBREW1",t[t.HEBREW2=50]="HEBREW2",t[t.ARABIC_ALPHA=51]="ARABIC_ALPHA",t[t.ARABIC_ABJAD=52]="ARABIC_ABJAD",t[t.HINDI_VOWELS=53]="HINDI_VOWELS",t[t.HINDI_CONSONANTS=54]="HINDI_CONSONANTS",t[t.HINDI_NUMBERS=55]="HINDI_NUMBERS",t[t.HINDI_COUNTING=56]="HINDI_COUNTING",t[t.THAI_LETTERS=57]="THAI_LETTERS",t[t.THAI_NUMBERS=58]="THAI_NUMBERS",t[t.THAI_COUNTING=59]="THAI_COUNTING",t[t.CUSTOM=60]="CUSTOM",t))(dt||{}),os=(t=>(t[t.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t[t.BOTH=4]="BOTH",t))(os||{}),gn=(t=>(t[t.HYPERLINK=0]="HYPERLINK",t[t.FIELD=1]="FIELD",t[t.SDT=2]="SDT",t[t.BOOKMARK=3]="BOOKMARK",t[t.COMMENT=4]="COMMENT",t[t.CUSTOM=5]="CUSTOM",t[t.MENTION=6]="MENTION",t[t.UNI_FORMULA=7]="UNI_FORMULA",t[t.DELTED=9999]="DELTED",t))(gn||{}),wn=(t=>(t[t.COMMENT=0]="COMMENT",t[t.DELETED=9999]="DELETED",t))(wn||{}),Xh=(t=>(t[t.DRAWING=0]="DRAWING",t[t.CUSTOM=1]="CUSTOM",t))(Xh||{}),La=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.TRADITIONAL=1]="TRADITIONAL",t[t.MODERN=2]="MODERN",t))(La||{}),Jh=(t=>(t[t.DEFAULT=0]="DEFAULT",t[t.LINES=1]="LINES",t[t.LINES_AND_CHARS=2]="LINES_AND_CHARS",t[t.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",t))(Jh||{}),Qh=(t=>(t[t.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",t[t.CONTINUOUS=1]="CONTINUOUS",t[t.NEXT_PAGE=2]="NEXT_PAGE",t[t.EVEN_PAGE=3]="EVEN_PAGE",t[t.ODD_PAGE=4]="ODD_PAGE",t))(Qh||{}),qh=(t=>(t[t.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",t[t.NONE=1]="NONE",t[t.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",t))(qh||{}),Zh=(t=>(t[t.NORMAL=0]="NORMAL",t[t.TBRL=1]="TBRL",t[t.LRTBV=2]="LRTBV",t))(Zh||{}),td=(t=>(t[t.TEXT_RUN=0]="TEXT_RUN",t[t.AUTO_TEXT=1]="AUTO_TEXT",t[t.PAGE_BREAK=2]="PAGE_BREAK",t[t.COLUMN_BREAK=3]="COLUMN_BREAK",t[t.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",t[t.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",t[t.EQUATION=6]="EQUATION",t[t.DRAWING=7]="DRAWING",t[t.PERSON=8]="PERSON",t[t.RICH_LINK=9]="RICH_LINK",t))(td||{}),ed=(t=>(t[t.BOTH_SIDES=0]="BOTH_SIDES",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.LARGEST=3]="LARGEST",t))(ed||{}),nd=(t=>(t[t.INLINE=0]="INLINE",t[t.WRAP_NONE=1]="WRAP_NONE",t[t.WRAP_POLYGON=2]="WRAP_POLYGON",t[t.WRAP_SQUARE=3]="WRAP_SQUARE",t[t.WRAP_THROUGH=4]="WRAP_THROUGH",t[t.WRAP_TIGHT=5]="WRAP_TIGHT",t[t.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",t))(nd||{}),Jt=(t=>(t[t.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",t[t.NORMAL_TEXT=1]="NORMAL_TEXT",t[t.TITLE=2]="TITLE",t[t.SUBTITLE=3]="SUBTITLE",t[t.HEADING_1=4]="HEADING_1",t[t.HEADING_2=5]="HEADING_2",t[t.HEADING_3=6]="HEADING_3",t[t.HEADING_4=7]="HEADING_4",t[t.HEADING_5=8]="HEADING_5",t))(Jt||{}),rd=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(rd||{}),sd=(t=>(t[t.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",t[t.SOLID=1]="SOLID",t[t.DOT=2]="DOT",t[t.DASH=3]="DASH",t))(sd||{}),od=(t=>(t[t.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",t[t.START=1]="START",t[t.CENTER=2]="CENTER",t[t.END=3]="END",t))(od||{}),id=(t=>(t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SPECIFIED=1]="SPECIFIED",t))(id||{}),ad=(t=>(t[t.START=0]="START",t[t.CENTER=1]="CENTER",t[t.END=2]="END",t))(ad||{}),ld=(t=>(t[t.AUTO_FIT=0]="AUTO_FIT",t[t.FIXED=1]="FIXED",t))(ld||{}),ud=(t=>(t[t.NONE=0]="NONE",t[t.WRAP=1]="WRAP",t))(ud||{}),cd=(t=>(t[t.AUTO=0]="AUTO",t[t.AT_LEAST=1]="AT_LEAST",t[t.EXACT=2]="EXACT",t))(cd||{}),hd=(t=>(t[t.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",t[t.BOTH=1]="BOTH",t[t.TOP=2]="TOP",t[t.CENTER=3]="CENTER",t[t.BOTTOM=4]="BOTTOM",t))(hd||{}),tr=(t=>(t.NORMAL="normal",t.BOLD="bold",t.ITALIC="italic",t))(tr||{}),dd=(t=>(t[t.PAGE=0]="PAGE",t[t.COLUMN=1]="COLUMN",t[t.CHARACTER=2]="CHARACTER",t[t.MARGIN=3]="MARGIN",t[t.INSIDE_MARGIN=4]="INSIDE_MARGIN",t[t.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",t[t.LEFT_MARGIN=6]="LEFT_MARGIN",t[t.RIGHT_MARGIN=7]="RIGHT_MARGIN",t))(dd||{}),fd=(t=>(t[t.PAGE=0]="PAGE",t[t.PARAGRAPH=1]="PARAGRAPH",t[t.LINE=2]="LINE",t[t.MARGIN=3]="MARGIN",t[t.TOP_MARGIN=4]="TOP_MARGIN",t[t.BOTTOM_MARGIN=5]="BOTTOM_MARGIN",t[t.INSIDE_MARGIN=6]="INSIDE_MARGIN",t[t.OUTSIDE_MARGIN=7]="OUTSIDE_MARGIN",t))(fd||{}),pd=(t=>(t[t.POINT=0]="POINT",t[t.LINE=1]="LINE",t[t.CHARACTER=2]="CHARACTER",t[t.PIXEL=3]="PIXEL",t[t.PERCENT=4]="PERCENT",t))(pd||{}),gd=(t=>(t[t.CENTER=0]="CENTER",t[t.INSIDE=1]="INSIDE",t[t.LEFT=2]="LEFT",t[t.OUTSIDE=3]="OUTSIDE",t[t.RIGHT=4]="RIGHT",t[t.BOTH=5]="BOTH",t[t.DISTRIBUTE=6]="DISTRIBUTE",t))(gd||{}),md=(t=>(t[t.BOTTOM=0]="BOTTOM",t[t.CENTER=1]="CENTER",t[t.INSIDE=2]="INSIDE",t[t.OUTSIDE=3]="OUTSIDE",t[t.TOP=4]="TOP",t))(md||{}),_d=(t=>(t[t.compressPunctuation=0]="compressPunctuation",t[t.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",t[t.doNotCompress=2]="doNotCompress",t))(_d||{}),yd=(t=>(t[t.PORTRAIT=0]="PORTRAIT",t[t.LANDSCAPE=1]="LANDSCAPE",t))(yd||{}),me=(t=>(t.Letter="Letter",t.Tabloid="Tabloid",t.Legal="Legal",t.Statement="Statement",t.Executive="Executive",t.Folio="Folio",t.A3="A3",t.A4="A4",t.A5="A5",t.B4="B4",t.B5="B5",t))(me||{});const AE=["A3","A4","A5","B4","B5","Letter","Tabloid","Legal","Statement","Executive","Folio"];var Ed=(t=>(t[t.forward=0]="forward",t[t.backward=1]="backward",t[t.front=2]="front",t[t.back=3]="back",t))(Ed||{}),vd=(t=>(t[t.UNRECOGNIZED=-1]="UNRECOGNIZED",t[t.DRAWING_IMAGE=0]="DRAWING_IMAGE",t[t.DRAWING_SHAPE=1]="DRAWING_SHAPE",t[t.DRAWING_CHART=2]="DRAWING_CHART",t[t.DRAWING_TABLE=3]="DRAWING_TABLE",t[t.DRAWING_SMART_ART=4]="DRAWING_SMART_ART",t[t.DRAWING_VIDEO=5]="DRAWING_VIDEO",t[t.DRAWING_GROUP=6]="DRAWING_GROUP",t[t.DRAWING_UNIT=7]="DRAWING_UNIT",t[t.DRAWING_DOM=8]="DRAWING_DOM",t))(vd||{}),Ua=(t=>(t[t.SLIDE=0]="SLIDE",t[t.MASTER=1]="MASTER",t[t.LAYOUT=2]="LAYOUT",t[t.HANDOUT_MASTER=3]="HANDOUT_MASTER",t[t.NOTES_MASTER=4]="NOTES_MASTER",t))(Ua||{}),Cd=(t=>(t[t.SHAPE=0]="SHAPE",t[t.IMAGE=1]="IMAGE",t[t.TEXT=2]="TEXT",t[t.SPREADSHEET=3]="SPREADSHEET",t[t.DOCUMENT=4]="DOCUMENT",t[t.SLIDE=5]="SLIDE",t))(Cd||{}),Rd=(t=>(t[t.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",t[t.NEXT_SLIDE=1]="NEXT_SLIDE",t[t.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",t[t.FIRST_SLIDE=3]="FIRST_SLIDE",t[t.LAST_SLIDE=4]="LAST_SLIDE",t))(Rd||{});function OE(t=re(6),e=ss.EN_US,n=""){return{id:t,locale:e,title:n,tableSource:{},drawings:{},drawingsOrder:[],headers:{},footers:{},body:{dataStream:`\r
`,textRuns:[],customBlocks:[],tables:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:5},lineSpacing:1,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]},documentStyle:{pageSize:{width:793.3333333333334,height:1122.6666666666667},documentFlavor:La.TRADITIONAL,marginTop:50,marginBottom:50,marginRight:50,marginLeft:50,renderConfig:{zeroWidthParagraphBreak:ot.FALSE,vertexAngle:0,centerAngle:0,background:{rgb:"#ccc"}},autoHyphenation:ot.TRUE,doNotHyphenateCaps:ot.FALSE,consecutiveHyphenLimit:2,defaultHeaderId:"",defaultFooterId:"",evenPageHeaderId:"",evenPageFooterId:"",firstPageHeaderId:"",firstPageFooterId:"",evenAndOddHeaders:ot.FALSE,useFirstPageHeaderFooter:ot.FALSE,marginHeader:30,marginFooter:30},settings:{}}}var $n={},Es={},vs={},du;function DE(){if(du)return vs;du=1,Object.defineProperty(vs,"__esModule",{value:!0});function t(r,s){if(Array.isArray(s))return!1;for(let o in r)if(!n(r[o],s[o]))return!1;for(let o in s)if(r[o]===void 0)return!1;return!0}function e(r,s){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let o=0;o<r.length;o++)if(!n(r[o],s[o]))return!1;return!0}function n(r,s){return r===s?!0:r===null||s===null||typeof r!="object"||typeof s!="object"?!1:Array.isArray(r)?e(r,s):t(r,s)}return vs.default=n,vs}var Cs={},fu;function NE(){if(fu)return Cs;fu=1,Object.defineProperty(Cs,"__esModule",{value:!0});function t(e){if(e===null)return null;if(Array.isArray(e))return e.map(t);if(typeof e=="object"){const n={};for(let r in e)n[r]=t(e[r]);return n}else return e}return Cs.default=t,Cs}var pu={},gu;function bd(){return gu||(gu=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.eachChildOf=t.advancer=t.readCursor=t.writeCursor=t.WriteCursor=t.ReadCursor=t.isValidPathItem=void 0;function e(c,h){if(!c)throw new Error(h)}const n=c=>c!=null&&typeof c=="object"&&!Array.isArray(c),r=(c,h)=>typeof c==typeof h?c>h:typeof c=="string"&&typeof h=="number";function s(c,h){for(let d in c){const f=d;h.write(f,c[f])}}t.isValidPathItem=c=>typeof c=="number"||typeof c=="string"&&c!=="__proto__";class o{constructor(h=null){this.parents=[],this.indexes=[],this.lcIdx=-1,this.idx=-1,this.container=h}ascend(){e(this.parents.length===this.indexes.length/2),this.idx===0?this.parents.length?(this.lcIdx=this.indexes.pop(),this.container=this.parents.pop(),this.idx=this.indexes.pop()):(this.lcIdx=0,this.idx=-1):(e(this.idx>0),this.idx--,n(this.container[this.idx])&&this.idx--)}getPath(){const h=[];let d=this.container,f=this.parents.length-1,p=this.idx;for(;p>=0;)h.unshift(d[p]),p===0?(p=this.indexes[f*2],d=this.parents[f--]):p-=n(d[p-1])?2:1;return h}}class i extends o{get(){return this.container?this.container.slice(this.idx+1):null}getKey(){return e(this.container!=null,"Invalid call to getKey before cursor descended"),this.container[this.idx]}getComponent(){let h;return this.container&&this.container.length>this.idx+1&&n(h=this.container[this.idx+1])?h:null}descendFirst(){let h=this.idx+1;if(!this.container||h>=this.container.length||n(this.container[h])&&h+1>=this.container.length)return!1;n(this.container[h])&&h++;const d=this.container[h];return Array.isArray(d)?(this.indexes.push(this.idx),this.parents.push(this.container),this.indexes.push(h),this.idx=0,this.container=d):this.idx=h,!0}nextSibling(){if(e(this.parents.length===this.indexes.length/2),this.idx>0||this.parents.length===0)return!1;const h=this.indexes[this.indexes.length-1]+1,d=this.parents[this.parents.length-1];return h>=d.length?!1:(e(!isNaN(h)),this.indexes[this.indexes.length-1]=h,this.container=d[h],!0)}_init(h,d,f,p){this.container=h,this.idx=d,this.parents=f.slice(),this.indexes=p.slice()}clone(){const h=new i;return h._init(this.container,this.idx,this.parents,this.indexes),h}*[Symbol.iterator](){if(this.descendFirst()){do yield this.getKey();while(this.nextSibling());this.ascend()}}traverse(h,d){const f=this.getComponent();f&&d(f,h);for(const p of this)h&&h.descend(p),this.traverse(h,d),h&&h.ascend()}eachPick(h,d){this.traverse(h,(f,p)=>{f.p!=null&&d(f.p,p)})}eachDrop(h,d){this.traverse(h,(f,p)=>{f.d!=null&&d(f.d,p)})}}t.ReadCursor=i;class a extends o{constructor(h=null){super(h),this.pendingDescent=[],this._op=h}flushDescent(){e(this.parents.length===this.indexes.length/2),this.container===null&&(this._op=this.container=[]);for(let h=0;h<this.pendingDescent.length;h++){const d=this.pendingDescent[h];let f=this.idx+1;if(f<this.container.length&&n(this.container[f])&&f++,e(f===this.container.length||!n(this.container[f])),f===this.container.length)this.container.push(d),this.idx=f;else if(this.container[f]===d)this.idx=f;else{if(!Array.isArray(this.container[f])){const p=this.container.splice(f,this.container.length-f);this.container.push(p),this.lcIdx>-1&&(this.lcIdx=f)}for(this.indexes.push(this.idx),this.parents.push(this.container),this.lcIdx!==-1&&(e(r(d,this.container[this.lcIdx][0])),f=this.lcIdx+1,this.lcIdx=-1);f<this.container.length&&r(d,this.container[f][0]);)f++;if(this.indexes.push(f),this.idx=0,f<this.container.length&&this.container[f][0]===d)this.container=this.container[f];else{const p=[d];this.container.splice(f,0,p),this.container=p}}}this.pendingDescent.length=0}reset(){this.lcIdx=-1}getComponent(){this.flushDescent();const h=this.idx+1;if(h<this.container.length&&n(this.container[h]))return this.container[h];{const d={};return this.container.splice(h,0,d),d}}write(h,d){const f=this.getComponent();e(f[h]==null||f[h]===d,"Internal consistency error: Overwritten component. File a bug"),f[h]=d}get(){return this._op}descend(h){if(!t.isValidPathItem(h))throw Error("Invalid JSON key");this.pendingDescent.push(h)}descendPath(h){return this.pendingDescent.push(...h),this}ascend(){this.pendingDescent.length?this.pendingDescent.pop():super.ascend()}mergeTree(h,d=s){if(h===null)return;if(e(Array.isArray(h)),h===this._op)throw Error("Cannot merge into my own tree");const f=this.lcIdx,p=this.parents.length;let m=0;for(let R=0;R<h.length;R++){const S=h[R];typeof S=="string"||typeof S=="number"?(m++,this.descend(S)):Array.isArray(S)?this.mergeTree(S,d):typeof S=="object"&&d(S,this)}for(;m--;)this.ascend();this.lcIdx=this.parents.length===p?f:-1}at(h,d){this.descendPath(h),d(this);for(let f=0;f<h.length;f++)this.ascend();return this}writeAtPath(h,d,f){return this.at(h,()=>this.write(d,f)),this.reset(),this}writeMove(h,d,f=0){return this.writeAtPath(h,"p",f).writeAtPath(d,"d",f)}getPath(){const h=super.getPath();return h.push(...this.pendingDescent),h}}t.WriteCursor=a,t.writeCursor=()=>new a,t.readCursor=c=>new i(c);function l(c,h,d){let f,p;p=f=c?c.descendFirst():!1;function m(R){let S;for(;p;){const P=S=c.getKey();if(R!=null){let k=!1;if(h&&typeof P=="number"&&(S=h(P,c.getComponent()),S<0&&(S=~S,k=!0)),r(S,R))return null;if(S===R&&!k)return c}d&&typeof S=="number"&&d(S,c.getComponent()),p=c.nextSibling()}return null}return m.end=()=>{f&&c.ascend()},m}t.advancer=l;function u(c,h,d){let f,p,m,R;for(f=p=c&&c.descendFirst(),m=R=h&&h.descendFirst();f||m;){let S=f?c.getKey():null,P=m?h.getKey():null;S!==null&&P!==null&&(r(P,S)?P=null:S!==P&&(S=null)),d(S??P,S!=null?c:null,P!=null?h:null),S!=null&&f&&(f=c.nextSibling()),P!=null&&m&&(m=h.nextSibling())}p&&c.ascend(),R&&h.ascend()}t.eachChildOf=u})(pu)),pu}var mu={},_u;function Td(){return _u||(_u=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConflictType=void 0,(function(e){e[e.RM_UNEXPECTED_CONTENT=1]="RM_UNEXPECTED_CONTENT",e[e.DROP_COLLISION=2]="DROP_COLLISION",e[e.BLACKHOLE=3]="BLACKHOLE"})(t.ConflictType||(t.ConflictType={}))})(mu)),mu}var je={},Hn={},yu;function Fa(){return yu||(yu=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.uniToStrPos=Hn.strPosToUni=void 0,Hn.strPosToUni=(t,e=t.length)=>{let n=0,r=0;for(;r<e;r++){const s=t.charCodeAt(r);s>=55296&&s<=57343&&(n++,r++)}if(r!==e)throw Error("Invalid offset - splits unicode bytes");return r-n},Hn.uniToStrPos=(t,e)=>{let n=0;for(;e>0;e--){const r=t.charCodeAt(n);n+=r>=55296&&r<=57343?2:1}return n}),Hn}var Eu={},vu;function Ci(){return vu||(vu=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.uniSlice=t.dlen=t.eachOp=void 0;const e=Fa(),n=C=>{if(!Array.isArray(C))throw Error("Op must be an array of components");let b=null;for(let v=0;v<C.length;v++){const N=C[v];switch(typeof N){case"object":if(typeof N.d!="number"&&typeof N.d!="string")throw Error("Delete must be number or string");if(t.dlen(N.d)<=0)throw Error("Deletes must not be empty");break;case"string":if(!(N.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(N>0))throw Error("Skip components must be >0");if(typeof b=="number")throw Error("Adjacent skip components should be combined");break}b=N}if(typeof b=="number")throw Error("Op has a trailing skip")};function r(C,b){let v=0,N=0;for(let V=0;V<C.length;V++){const Y=C[V];switch(b(Y,v,N),typeof Y){case"object":v+=t.dlen(Y.d);break;case"string":N+=e.strPosToUni(Y);break;case"number":v+=Y,N+=Y;break}}}t.eachOp=r;function s(C,b){const v=[],N=a(v);return r(C,(V,Y,g)=>{N(b(V,Y,g))}),h(v)}const o=C=>C,i=C=>s(C,o);t.dlen=C=>typeof C=="number"?C:e.strPosToUni(C);const a=C=>b=>{if(!(!b||b.d===0||b.d===""))if(C.length===0)C.push(b);else if(typeof b==typeof C[C.length-1])if(typeof b=="object"){const v=C[C.length-1];v.d=typeof v.d=="string"&&typeof b.d=="string"?v.d+b.d:t.dlen(v.d)+t.dlen(b.d)}else C[C.length-1]+=b;else C.push(b)},l=C=>typeof C=="number"?C:typeof C=="string"?e.strPosToUni(C):typeof C.d=="number"?C.d:e.strPosToUni(C.d);t.uniSlice=(C,b,v)=>{const N=e.uniToStrPos(C,b),V=v==null?1/0:e.uniToStrPos(C,v);return C.slice(N,V)};const u=(C,b,v)=>typeof C=="number"?v==null?C-b:Math.min(C,v)-b:t.uniSlice(C,b,v),c=C=>{let b=0,v=0;return{take:(N,V)=>{if(b===C.length)return N===-1?null:N;const Y=C[b];let g;if(typeof Y=="number")return N===-1||Y-v<=N?(g=Y-v,++b,v=0,g):(v+=N,N);if(typeof Y=="string"){if(N===-1||V==="i"||e.strPosToUni(Y.slice(v))<=N)return g=Y.slice(v),++b,v=0,g;{const L=v+e.uniToStrPos(Y.slice(v),N);return g=Y.slice(v,L),v=L,g}}else{if(N===-1||V==="d"||t.dlen(Y.d)-v<=N)return g={d:u(Y.d,v)},++b,v=0,g;{let L=u(Y.d,v,v+N);return v+=N,{d:L}}}},peek:()=>C[b]}},h=C=>(C.length>0&&typeof C[C.length-1]=="number"&&C.pop(),C);function d(C,b,v){if(v!=="left"&&v!=="right")throw Error("side ("+v+") must be 'left' or 'right'");n(C),n(b);const N=[],V=a(N),{take:Y,peek:g}=c(C);for(let E=0;E<b.length;E++){const D=b[E];let w,I;switch(typeof D){case"number":for(w=D;w>0;)I=Y(w,"i"),V(I),typeof I!="string"&&(w-=l(I));break;case"string":v==="left"&&typeof g()=="string"&&V(Y(-1)),V(e.strPosToUni(D));break;case"object":for(w=t.dlen(D.d);w>0;)switch(I=Y(w,"i"),typeof I){case"number":w-=I;break;case"string":V(I);break;case"object":w-=t.dlen(I.d)}break}}let L;for(;L=Y(-1);)V(L);return h(N)}function f(C,b){n(C),n(b);const v=[],N=a(v),{take:V}=c(C);for(let g=0;g<b.length;g++){const L=b[g];let E,D;switch(typeof L){case"number":for(E=L;E>0;)D=V(E,"d"),N(D),typeof D!="object"&&(E-=l(D));break;case"string":N(L);break;case"object":E=t.dlen(L.d);let w=0;for(;w<E;)switch(D=V(E-w,"d"),typeof D){case"number":N({d:u(L.d,w,w+D)}),w+=D;break;case"string":w+=e.strPosToUni(D);break;case"object":N(D)}break}}let Y;for(;Y=V(-1);)N(Y);return h(v)}const p=(C,b)=>{let v=0;for(let N=0;N<b.length&&C>v;N++){const V=b[N];switch(typeof V){case"number":{v+=V;break}case"string":const Y=e.strPosToUni(V);v+=Y,C+=Y;break;case"object":C-=Math.min(t.dlen(V.d),C-v);break}}return C},m=(C,b)=>typeof C=="number"?p(C,b):C.map(v=>p(v,b));function R(C,b,v){return s(C,(N,V)=>typeof N=="object"&&typeof N.d=="number"?{d:v.slice(b,V,V+N.d)}:N)}function S(C){return s(C,b=>{switch(typeof b){case"object":if(typeof b.d=="number")throw Error("Cannot invert text op: Deleted characters missing from operation. makeInvertible must be called first.");return b.d;case"string":return{d:b};case"number":return b}})}function P(C){return s(C,b=>typeof b=="object"&&typeof b.d=="string"?{d:e.strPosToUni(b.d)}:b)}function k(C){let b=!0;return r(C,v=>{typeof v=="object"&&typeof v.d=="number"&&(b=!1)}),b}function H(C){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:h,normalize:i,checkOp:n,create(b=""){if(typeof b!="string")throw Error("Initial data must be a string");return C.create(b)},apply(b,v){n(v);const N=C.builder(b);for(let V=0;V<v.length;V++){const Y=v[V];switch(typeof Y){case"number":N.skip(Y);break;case"string":N.append(Y);break;case"object":N.del(t.dlen(Y.d));break}}return N.build()},transform:d,compose:f,transformPosition:p,transformSelection:m,isInvertible:k,makeInvertible(b,v){return R(b,v,C)},stripInvertible:P,invert:S,invertWithDoc(b,v){return S(R(b,v,C))},isNoop:b=>b.length===0}}t.default=H})(Eu)),Eu}var Rs={},Cu;function xE(){if(Cu)return Rs;Cu=1,Object.defineProperty(Rs,"__esModule",{value:!0});const t=Ci(),e=Fa();function n(r,s){return{get:r,getLength(){return r().length},insert(o,i,a){const l=e.strPosToUni(r(),o);return s([l,i],a)},remove(o,i,a){const l=e.strPosToUni(r(),o);return s([l,{d:i}],a)},_onOp(o){t.eachOp(o,(i,a,l)=>{switch(typeof i){case"string":this.onInsert&&this.onInsert(l,i);break;case"object":const u=t.dlen(i.d);this.onRemove&&this.onRemove(l,u)}})},onInsert:null,onRemove:null}}return Rs.default=n,n.provides={text:!0},Rs}var Ru;function ME(){return Ru||(Ru=1,(function(t){var e=je&&je.__createBinding||(Object.create?(function(d,f,p,m){m===void 0&&(m=p),Object.defineProperty(d,m,{enumerable:!0,get:function(){return f[p]}})}):(function(d,f,p,m){m===void 0&&(m=p),d[m]=f[p]})),n=je&&je.__setModuleDefault||(Object.create?(function(d,f){Object.defineProperty(d,"default",{enumerable:!0,value:f})}):function(d,f){d.default=f}),r=je&&je.__importStar||function(d){if(d&&d.__esModule)return d;var f={};if(d!=null)for(var p in d)Object.hasOwnProperty.call(d,p)&&e(f,d,p);return n(f,d),f},s=je&&je.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(t,"__esModule",{value:!0}),t.type=t.remove=t.insert=void 0;const o=Fa(),i=r(Ci()),a=s(xE()),l={create(d){return d},toString(d){return d},builder(d){if(typeof d!="string")throw Error("Invalid document snapshot: "+d);const f=[];return{skip(p){let m=o.uniToStrPos(d,p);if(m>d.length)throw Error("The op is too long for this document");f.push(d.slice(0,m)),d=d.slice(m)},append(p){f.push(p)},del(p){d=d.slice(o.uniToStrPos(d,p))},build(){return f.join("")+d}}},slice:i.uniSlice},u=i.default(l),c=Object.assign(Object.assign({},u),{api:a.default});t.type=c,t.insert=(d,f)=>f.length===0?[]:d===0?[f]:[d,f],t.remove=(d,f)=>i.dlen(f)===0?[]:d===0?[{d:f}]:[d,{d:f}];var h=Ci();Object.defineProperty(t,"makeType",{enumerable:!0,get:function(){return h.default}})})(je)),je}var bu;function LE(){return bu||(bu=1,(function(t){var e=Es&&Es.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(t,"__esModule",{value:!0}),t.editOp=t.replaceOp=t.insertOp=t.moveOp=t.removeOp=t.type=void 0;const n=e(DE()),r=e(NE()),s=bd(),o=Td();function i(T,M){if(!T)throw new Error(M)}t.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:s.readCursor,writeCursor:s.writeCursor,create:T=>T,isNoop:T=>T==null,setDebug(T){},registerSubtype:S,checkValidOp:V,normalize:Y,apply:g,transformPosition:L,compose:E,tryTransform:x,transform:Q,makeInvertible:I,invert:D,invertWithDoc:A,RM_UNEXPECTED_CONTENT:o.ConflictType.RM_UNEXPECTED_CONTENT,DROP_COLLISION:o.ConflictType.DROP_COLLISION,BLACKHOLE:o.ConflictType.BLACKHOLE,transformNoConflict:(T,M,j)=>lt(()=>!0,T,M,j),typeAllowingConflictsPred:T=>Object.assign(Object.assign({},t.type),{transform:(M,j,W)=>lt(T,M,j,W)})};const a=T=>T?T.getComponent():null;function l(T){return T&&typeof T=="object"&&!Array.isArray(T)}const u=T=>Array.isArray(T)?T.slice():T!==null&&typeof T=="object"?Object.assign({},T):T,c=T=>T&&(T.p!=null||T.r!==void 0),h=T=>T&&(T.d!=null||T.i!==void 0);function d(T,M){return i(T!=null),typeof M=="number"?(i(Array.isArray(T),"Invalid key - child is not an array"),(T=T.slice()).splice(M,1)):(i(l(T),"Invalid key - child is not an object"),delete(T=Object.assign({},T))[M]),T}function f(T,M,j){return typeof M=="number"?(i(T!=null,"Container is missing for key"),i(Array.isArray(T),"Cannot use numerical key for object container"),i(T.length>=M,"Cannot insert into out of bounds index"),T.splice(M,0,j)):(i(l(T),"Cannot insert into missing item"),i(T[M]===void 0,"Trying to overwrite value at key. Your op needs to remove it first"),T[M]=j),j}t.removeOp=(T,M=!0)=>s.writeCursor().writeAtPath(T,"r",M).get(),t.moveOp=(T,M)=>s.writeCursor().writeMove(T,M).get(),t.insertOp=(T,M)=>s.writeCursor().writeAtPath(T,"i",M).get(),t.replaceOp=(T,M,j)=>s.writeCursor().at(T,W=>{W.write("r",M),W.write("i",j)}).get(),t.editOp=(T,M,j,W=!1)=>s.writeCursor().at(T,B=>b(B,M,j,W)).get();const p=(T,M)=>T!=null&&(typeof M=="number"?Array.isArray(T):typeof T=="object"),m=(T,M)=>p(T,M)?T[M]:void 0,R={};function S(T){let M=T.type?T.type:T;M.name&&(R[M.name]=M),M.uri&&(R[M.uri]=M)}const P=T=>{const M=R[T];if(M)return M;throw Error("Missing type: "+T)};S(ME());const k=(T,M)=>T+M;S({name:"number",apply:k,compose:k,invert:T=>-T,transform:T=>T});const H=T=>T==null?null:T.et?P(T.et):T.es?R["text-unicode"]:T.ena!=null?R.number:null,C=T=>T.es?T.es:T.ena!=null?T.ena:T.e,b=(T,M,j,W=!1)=>{const[B,$]=typeof M=="string"?[P(M),M]:[M,M.name];!W&&B.isNoop&&B.isNoop(j)||($==="number"?T.write("ena",j):$==="text-unicode"?T.write("es",j):(T.write("et",$),T.write("e",j)))};function v(T){i(typeof T=="number"),i(T>=0),i(T===(0|T))}function N(T){typeof T=="number"?v(T):i(typeof T=="string")}function V(T){if(T===null)return;const M=new Set,j=new Set,W=$=>{let Z=!0,tt=!1;for(let U in $){const z=$[U];if(Z=!1,i(U==="p"||U==="r"||U==="d"||U==="i"||U==="e"||U==="es"||U==="ena"||U==="et","Invalid component item '"+U+"'"),U==="p")v(z),i(!M.has(z)),M.add(z),i($.r===void 0);else if(U==="d")v(z),i(!j.has(z)),j.add(z),i($.i===void 0);else if(U==="e"||U==="es"||U==="ena"){i(!tt),tt=!0;const X=H($);i(X,"Missing type in edit"),X.checkValidOp&&X.checkValidOp(C($))}}i(!Z)},B=($,Z,tt)=>{if(!Array.isArray($))throw Error("Op must be null or a list");if($.length===0)throw Error("Empty descent");Z||N($[0]);let U=1,z=0,X=0;for(let nt=0;nt<$.length;nt++){const ft=$[nt];if(i(ft!=null),Array.isArray(ft)){const mt=B(ft,!1);if(z){const K=typeof X,ct=typeof mt;K===ct?i(X<mt,"descent keys are not in order"):i(K==="number"&&ct==="string")}X=mt,z++,U=3}else typeof ft=="object"?(i(U===1,`Prev not scalar - instead ${U}`),W(ft),U=2):(i(U!==3),N(ft),i(s.isValidPathItem(ft),"Invalid path key"),U=1)}return i(z!==1,"Operation makes multiple descents. Remove some []"),i(U===2||U===3),$[0]};B(T,!0),i(M.size===j.size,"Mismatched picks and drops in op");for(let $=0;$<M.size;$++)i(M.has($)),i(j.has($))}function Y(T){let M=0,j=[];const W=s.writeCursor();return W.mergeTree(T,(B,$)=>{const Z=H(B);if(Z){const U=C(B);b($,Z,Z.normalize?Z.normalize(U):U)}for(const U of["r","p","i","d"])if(B[U]!==void 0){const z=U==="p"||U==="d"?(tt=B[U],j[tt]==null&&(j[tt]=M++),j[tt]):B[U];$.write(U,z)}var tt}),W.get()}function g(T,M){if(V(M),M===null)return T;const j=[];return(function W(B,$){let Z=B,tt=0,U={root:B},z=0,X=U,nt="root";function ft(){for(;z<tt;z++){let mt=$[z];typeof mt!="object"&&(i(p(X,nt)),X=X[nt]=u(X[nt]),nt=mt)}}for(;tt<$.length;tt++){const mt=$[tt];if(Array.isArray(mt)){const K=W(Z,mt);K!==Z&&K!==void 0&&(ft(),Z=X[nt]=K)}else if(typeof mt=="object"){mt.d!=null?(ft(),Z=f(X,nt,j[mt.d])):mt.i!==void 0&&(ft(),Z=f(X,nt,mt.i));const K=H(mt);if(K)ft(),Z=X[nt]=K.apply(Z,C(mt));else if(mt.e!==void 0)throw Error("Subtype "+mt.et+" undefined")}else Z=m(Z,mt)}return U.root})(T=(function W(B,$){const Z=[];let tt=0;for(;tt<$.length;tt++){const nt=$[tt];if(Array.isArray(nt))break;typeof nt!="object"&&(Z.push(B),B=m(B,nt))}for(let nt=$.length-1;nt>=tt;nt--)B=W(B,$[nt]);for(--tt;tt>=0;tt--){const nt=$[tt];if(typeof nt!="object"){const ft=Z.pop();B=B===m(ft,nt)?ft:B===void 0?d(ft,nt):(z=nt,X=B,(U=u(U=ft))[z]=X,U)}else c(nt)&&(i(B!==void 0,"Cannot pick up or remove undefined"),nt.p!=null&&(j[nt.p]=B),B=void 0)}var U,z,X;return B})(T,M),M)}function L(T,M){T=T.slice(),V(M);const j=s.readCursor(M);let W,B,$=!1;const Z=[];for(let U=0;;U++){const z=T[U],X=j.getComponent();if(X&&(X.r!==void 0?$=!0:X.p!=null&&($=!1,W=X.p,B=U)),U>=T.length)break;let nt=0;const ft=s.advancer(j,void 0,(K,ct)=>{c(ct)&&nt++});Z.unshift(ft);const mt=ft(z);if(typeof z=="number"&&(T[U]-=nt),!mt)break}if(Z.forEach(U=>U.end()),$)return null;const tt=()=>{let U=0;if(W!=null){const z=j.getPath();U=z.length,T=z.concat(T.slice(B))}for(;U<T.length;U++){const z=T[U],X=a(j),nt=H(X);if(nt){const K=C(X);nt.transformPosition&&(T[U]=nt.transformPosition(T[U],K));break}let ft=0;const mt=s.advancer(j,(K,ct)=>h(ct)?~(K-ft):K-ft,(K,ct)=>{h(ct)&&ft++})(z);if(typeof z=="number"&&(T[U]+=ft),!mt)break}};return W!=null?j.eachDrop(null,U=>{U===W&&tt()}):tt(),T}function E(T,M){if(V(T),V(M),T==null)return M;if(M==null)return T;let j=0;const W=s.readCursor(T),B=s.readCursor(M),$=s.writeCursor(),Z=[],tt=[],U=[],z=[],X=[],nt=[],ft=new Set;W.traverse(null,K=>{K.p!=null&&(U[K.p]=W.clone())}),B.traverse(null,K=>{K.d!=null&&(z[K.d]=B.clone())});const mt=s.writeCursor();return(function K(ct,Lt,At,Ct,Bt,Xe,oe,Qt){i(Lt||At);const $t=a(Lt),be=a(At),xe=!!be&&be.r!==void 0,vn=!!$t&&$t.i!==void 0,Te=$t?$t.d:null,ge=be?be.p:null,Je=(Xe||xe)&&ge==null;if(ge!=null)Ct=z[ge],oe=tt[ge]=new s.WriteCursor;else if(be&&be.r!==void 0)Ct=null;else{const st=a(Ct);st&&st.d!=null&&(Ct=null)}const wt=a(Ct);if(Te!=null)if(ct=U[Te],Qt=Z[Te]=new s.WriteCursor,Je)Xe&&!xe&&Qt.write("r",!0);else{const st=X[Te]=j++;oe.write("d",st)}else if($t&&$t.i!==void 0)ct=null;else{const st=a(ct);st&&st.p!=null&&(ct=null)}let at;vn?(i(Bt===void 0),at=$t.i):at=Bt;const yt=(ge==null?!vn||Xe||xe:at===void 0)?null:oe.getComponent();if(ge!=null){if(!(Bt!==void 0||vn)){const st=Te!=null?X[Te]:j++;nt[ge]=st,Qt.write("p",st)}}else xe&&(vn||Bt!==void 0||(be.r,Qt.write("r",be.r)));const ut=Je?null:H($t),rt=H(wt);if((ut||rt)&&(ut&&ut.name,rt&&rt.name),ut&&rt){i(ut===rt);const st=C($t),Et=C(wt),zt=ut.compose(st,Et);b(oe,ut,zt),ft.add(wt)}else ut?b(oe,ut,C($t)):rt&&(b(oe,rt,C(wt)),ft.add(wt));const ht=typeof at=="object"&&at!=null;let It=!1,Tt=0,St=0,Yt=0,Vt=0,Ht=0;const ne=s.advancer(Ct,(st,Et)=>h(Et)?Vt-st-1:st-Vt,(st,Et)=>{h(Et)&&Vt++}),Rt=s.advancer(ct,(st,Et)=>c(Et)?Tt-st-1:st-Tt,(st,Et)=>{c(Et)&&Tt++});if(s.eachChildOf(Lt,At,(st,Et,zt)=>{let ae,Qe,Cn=st,Me=st,vr=st;if(typeof st=="number"){let qt=st+Yt;Qe=ne(qt),Me=qt+Vt;let jt=st+St;ae=Rt(jt),h(a(Qe))&&(ae=null),Cn=jt+Tt,vr=st+Ht,i(Cn>=0,"p1PickKey is negative"),i(Me>=0,"p2DropKey is negative");const Le=h(a(Et)),qe=c(a(zt));(Le||qe&&!Je)&&Ht--,Le&&St--,qe&&Yt--}else ae=Rt(st),Qe=ne(st);Qt.descend(Cn),oe.descend(Me);const Pn=ht&&!h(a(Et))?at[vr]:void 0,$e=K(ae,Et,zt,Qe,Pn,Je,oe,Qt);var He,pt,kt;ht&&!Je?Pn!==$e&&(It||(at=Array.isArray(at)?at.slice():Object.assign({},at),It=!0),He=at,kt=$e,typeof(pt=vr)=="number"?(i(Array.isArray(He)),i(pt<He.length)):(i(!Array.isArray(He)),i(He[pt]!==void 0)),kt===void 0?typeof pt=="number"?He.splice(pt,1):delete He[pt]:He[pt]=kt):i($e===void 0),oe.ascend(),Qt.ascend()}),Rt.end(),ne.end(),yt!=null)yt.i=at;else if(!Xe&&!xe&&ge==null)return at})(W,W.clone(),B,B.clone(),void 0,!1,$,mt),$.reset(),$.mergeTree(mt.get()),$.reset(),$.get(),Z.map(K=>K.get()),tt.map(K=>K.get()),W.traverse($,(K,ct)=>{const Lt=K.p;if(Lt!=null){const At=X[Lt];At!=null&&ct.write("p",At);const Ct=Z[Lt];Ct&&Ct.get(),Ct&&ct.mergeTree(Ct.get())}else K.r!==void 0&&ct.write("r",K.r)}),$.reset(),$.get(),B.traverse($,(K,ct)=>{const Lt=K.d;if(Lt!=null){const Ct=nt[Lt];Ct!=null&&ct.write("d",Ct);const Bt=tt[Lt];Bt&&ct.mergeTree(Bt.get())}else K.i!==void 0&&ct.write("i",K.i);const At=H(K);At&&!ft.has(K)&&b(ct,At,C(K))}),$.get()}function D(T){if(T==null)return null;const M=new s.ReadCursor(T),j=new s.WriteCursor;let W;const B=[],$=[];return(function Z(tt,U,z){const X=tt.getComponent();let nt,ft=!1;if(X){X.p!=null&&(U.write("d",X.p),B[X.p]=tt.clone()),X.r!==void 0&&U.write("i",X.r),X.d!=null&&(U.write("p",X.d),z=void 0),X.i!==void 0&&(z=nt=X.i);const K=H(X);K&&(z===void 0?(W||(W=new Set),W.add(X)):(C(X),z=K.apply(z,C(X)),ft=!0))}let mt=0;for(const K of tt){U.descend(K);const ct=typeof K=="number"?K-mt:K,Lt=m(z,ct);h(tt.getComponent())&&mt++;const At=Z(tt,U,Lt);if(z!==void 0&&At!==void 0){if(ft||(ft=!0,z=u(z)),!p(z,ct))throw Error("Cannot modify child - invalid operation");z[ct]=At}U.ascend()}if(nt===void 0)return ft?z:void 0;U.write("r",z)})(M,j,void 0),W&&(j.reset(),(function Z(tt,U,z){const X=U.getComponent();if(X){const K=X.d;if(K!=null&&(tt=B[K],z=$[K]=s.writeCursor()),W.has(X)){const ct=H(X);if(!ct.invert)throw Error(`Cannot invert subtype ${ct.name}`);b(z,ct,ct.invert(C(X)))}}let nt=0,ft=0;const mt=s.advancer(tt,(K,ct)=>c(ct)?nt-K-1:K-nt,(K,ct)=>{c(ct)&&nt++});for(const K of U)if(typeof K=="number"){const ct=K-ft,Lt=mt(ct),At=ct+nt;z.descend(At),Z(Lt,U,z),h(U.getComponent())&&ft++,z.ascend()}else z.descend(K),Z(mt(K),U,z),z.ascend();mt.end()})(M.clone(),M,j),$.length&&(j.reset(),M.traverse(j,(Z,tt)=>{const U=Z.p;if(U!=null){const z=$[U];z&&z.get(),z&&tt.mergeTree(z.get())}}))),j.get()}const w=(T,M)=>T.some(j=>typeof j=="object"&&(Array.isArray(j)?w(j,M):M(j)));function I(T,M){if(T==null||!w(T,U=>{var z;return U.r!==void 0||((z=H(U))===null||z===void 0?void 0:z.makeInvertible)!=null}))return T;const j=new s.ReadCursor(T),W=new s.WriteCursor;let B=!1;const $=[],Z=[],tt=(U,z,X)=>{const nt=U.getComponent();let ft=!1;if(nt){nt.d!=null&&z.write("d",nt.d),nt.i!==void 0&&z.write("i",nt.i);const K=nt.p;if(K!=null&&($[K]=U.clone(),i(X!==void 0,"Operation picks up at an invalid key"),Z[K]=X,z.write("p",nt.p)),nt.r!==void 0&&X===void 0)throw Error("Invalid doc / op in makeInvertible: removed item missing from doc");const ct=H(nt);ct&&(ct.makeInvertible?B=!0:b(z,ct,C(nt),!0))}let mt=0;for(const K of U){z.descend(K);const ct=typeof K=="number"?K-mt:K,Lt=m(X,ct),At=tt(U,z,Lt);Lt!==At&&(ft||(ft=!0,X=u(X)),At===void 0?(X=d(X,ct),typeof K=="number"&&mt++):X[ct]=At),z.ascend()}return nt&&(nt.r!==void 0?(z.write("r",r.default(X)),X=void 0):nt.p!=null&&(X=void 0)),X};return tt(j,W,M),W.get(),B&&(W.reset(),(function U(z,X,nt,ft,mt){const K=X.getComponent();if(K){K.i!==void 0?(ft=K.i,mt=!0):K.d!=null&&(ft=Z[K.d],z=$[K.d],mt=!1,K.d);let Ct=H(K);if(Ct&&Ct.makeInvertible){const Bt=C(K);b(nt,Ct,Ct.makeInvertible(Bt,ft),!0)}}let ct=0,Lt=0;const At=s.advancer(z,(Ct,Bt)=>c(Bt)?ct-Ct-1:Ct-ct,(Ct,Bt)=>{c(Bt)&&ct++});for(const Ct of X)if(typeof Ct=="number"){const Bt=Ct-Lt,Xe=At(Bt),oe=Bt+ct,Qt=m(ft,mt?Bt:oe);nt.descend(Ct),U(Xe,X,nt,Qt,mt),h(X.getComponent())&&Lt++,nt.ascend()}else{const Bt=m(ft,Ct);nt.descend(Ct),U(At(Ct),X,nt,Bt,mt),nt.ascend()}At.end()})(j.clone(),j,W,M,!1)),W.get()}function A(T,M){return D(I(T,M))}const O=T=>{if(T==null)return null;const M=T.slice();for(let j=0;j<T.length;j++){const W=M[j];Array.isArray(W)&&(M[j]=O(W))}return M};function x(T,M,j){i(j==="left"||j==="right","Direction must be left or right");const W=j==="left"?0:1;if(M==null)return{ok:!0,result:T};V(T),V(M);let B=null;const $=[],Z=[],tt=[],U=[],z=[],X=[],nt=[],ft=[],mt=[],K=[],ct=[],Lt=[],At=[],Ct=[],Bt=[];let Xe=0;const oe=s.readCursor(T),Qt=s.readCursor(M),$t=s.writeCursor();if((function wt(at,yt=null,ut){const rt=a(yt);rt&&(rt.r!==void 0?ut=yt.clone():rt.p!=null&&(ut=null,X[rt.p]=at.clone()));const ht=at.getComponent();let It;ht&&(It=ht.p)!=null&&(z[It]=yt?yt.clone():null,tt[It]=at.clone(),ut&&(K[It]=!0,mt[It]=ut),rt&&rt.p!=null&&(Ct[It]=rt.p));const Tt=s.advancer(yt);for(const St of at)wt(at,Tt(St),ut);Tt.end()})(Qt,oe,null),(function wt(at,yt,ut,rt,ht){const It=ut.getComponent();let Tt,St=!1;It&&((Tt=It.d)!=null?(U[Tt]=ut.clone(),rt!=null&&(Bt[rt]==null&&(Bt[rt]=[]),Bt[rt].push(Tt)),K[Tt],at=z[Tt]||null,yt=tt[Tt]||null,K[Tt]?(ht&&(ct[Tt]=!0),ht=mt[Tt]||null):!ht||W!==1&&Ct[Tt]!=null||B==null&&(B={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(ht.getPath()),op2:t.moveOp(yt.getPath(),ut.getPath())}),St=!0):It.i!==void 0&&(at=yt=null,St=!0,ht&&B==null&&(B={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(ht.getPath()),op2:t.insertOp(ut.getPath(),It.i)})));const Yt=a(at);Yt&&(Yt.r!==void 0?ht=at.clone():Yt.p!=null&&(Yt.p,rt=Yt.p,ht=null));const Vt=H(It);Vt&&ht&&B==null&&(B={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.removeOp(ht.getPath()),op2:t.editOp(ut.getPath(),Vt,C(It),!0)});let Ht=0,ne=0;const Rt=s.advancer(yt,(Et,zt)=>c(zt)?Ht-Et-1:Et-Ht,(Et,zt)=>{c(zt)&&Ht++}),st=s.advancer(at);for(const Et of ut)if(typeof Et=="number"){const zt=Et-ne,ae=Rt(zt);ne+=+wt(st(zt+Ht),ae,ut,rt,ht)}else{const zt=Rt(Et);wt(st(Et),zt,ut,rt,ht)}return Rt.end(),st.end(),St})(oe,Qt,Qt.clone(),null,null),U.map(wt=>wt&&wt.get()),B)return{ok:!1,conflict:B};ct.map(wt=>!!wt);const be=[];let xe=null;(function wt(at,yt,ut,rt,ht){let It=!1;const Tt=a(yt);if(c(Tt)){const Rt=Tt.p;Rt!=null?(ut=U[Rt],rt=Lt[Rt]=s.writeCursor(),It=!0,ht=null):(ut=null,ht=yt.clone())}else h(a(ut))&&(ut=null);const St=at.getComponent();if(St){const Rt=St.p;Rt!=null?(ht&&(ft[Rt]=ht),be[Rt]=ht||W===1&&It?null:rt.getComponent(),$[Rt]=at.clone(),ut&&(nt[Rt]=ut.clone())):St.r!==void 0&&(ht||rt.write("r",!0),(ht||It)&&(xe==null&&(xe=new Set),xe.add(St)))}let Yt=0,Vt=0;const Ht=s.advancer(yt,void 0,(Rt,st)=>{c(st)&&Yt++}),ne=s.advancer(ut,(Rt,st)=>h(st)?~(Rt-Vt):Rt-Vt,(Rt,st)=>{h(st)&&Vt++});if(at)for(const Rt of at)if(typeof Rt=="string"){const st=Ht(Rt),Et=ne(Rt);rt.descend(Rt),wt(at,st,Et,rt,ht),rt.ascend()}else{const st=Ht(Rt),Et=Rt-Yt,zt=c(a(st))?null:ne(Et),ae=Et+Vt;i(ae>=0),rt.descend(ae),wt(at,st,zt,rt,ht),rt.ascend()}Ht.end(),ne.end()})(oe,Qt,Qt.clone(),$t,null),$t.reset();let vn=[];if((function wt(at,yt,ut,rt,ht,It){i(yt);const Tt=yt.getComponent();let St=a(rt),Yt=!1;const Vt=(pt,kt,qt)=>pt?t.moveOp(pt.getPath(),kt.getPath()):t.insertOp(kt.getPath(),qt.i);if(h(Tt)){const pt=Tt.d;pt!=null&&(Z[pt]=yt.clone());const kt=pt!=null?be[pt]:null;let qt=!1;if(Tt.i!==void 0||pt!=null&&kt){let jt;St&&(St.i!==void 0||(jt=St.d)!=null&&!K[jt])&&(qt=jt!=null?pt!=null&&pt===Ct[jt]:n.default(St.i,Tt.i),qt||jt!=null&&W!==1&&Ct[jt]!=null||B==null&&(B={type:o.ConflictType.DROP_COLLISION,op1:Vt(pt!=null?$[pt]:null,yt,Tt),op2:Vt(jt!=null?tt[jt]:null,rt,St)})),qt||(It?B==null&&(B={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:Vt(pt!=null?$[pt]:null,yt,Tt),op2:t.removeOp(It.getPath())}):(pt!=null?(vn[Xe]=pt,ht.write("d",kt.p=Xe++)):ht.write("i",r.default(Tt.i)),Yt=!0))}else if(pt!=null&&!kt){const jt=ft[pt];jt&&(It=jt.clone())}pt!=null?(at=$[pt],ut=X[pt],rt=nt[pt]):Tt.i!==void 0&&(at=ut=null,qt||(rt=null))}else c(a(at))&&(at=ut=rt=null);const Ht=a(at),ne=a(ut);if(c(ne)){const pt=ne.p;ne.r!==void 0&&(!Ht||Ht.r===void 0)||K[pt]?(rt=null,It=ut.clone()):pt!=null&&(rt=U[pt],W!==1&&Ct[pt]!=null||((ht=At[pt])||(ht=At[pt]=s.writeCursor()),ht.reset(),It=null))}else!h(Tt)&&h(St)&&(rt=null);St=rt!=null?rt.getComponent():null;const Rt=H(Tt);if(Rt){const pt=C(Tt);if(It)B==null&&(B={type:o.ConflictType.RM_UNEXPECTED_CONTENT,op1:t.editOp(yt.getPath(),Rt,pt,!0),op2:t.removeOp(It.getPath())});else{const kt=H(St);let qt;if(kt){if(Rt!==kt)throw Error("Transforming incompatible types");const jt=C(St);qt=Rt.transform(pt,jt,j)}else qt=r.default(pt);b(ht,Rt,qt)}}let st=0,Et=0,zt=0,ae=0,Qe=0,Cn=0,Me=at!=null&&at.descendFirst(),vr=Me;const Pn=s.advancer(ut,void 0,(pt,kt)=>{c(kt)&&zt++});let $e=rt!=null&&rt.descendFirst(),He=$e;for(const pt of yt)if(typeof pt=="number"){let kt;const qt=h(yt.getComponent()),jt=pt-Et;{let rn;for(;Me&&typeof(rn=at.getKey())=="number";){rn+=st;const Ue=at.getComponent(),Bn=c(Ue);if(rn>jt||rn===jt&&(!Bn||W===0&&qt))break;if(Bn){st--;const Rn=Ue.p;Ct.includes(Rn),Ue.d,a(At[Ue.d]),c(a(At[Ue.d])),(Ue.r===void 0||xe&&xe.has(Ue))&&(Rn==null||!be[Rn]||W!==1&&Ct.includes(Rn))||Qe--}Me=at.nextSibling()}kt=Me&&rn===jt?at:null}const Le=jt-st;let qe=Pn(Le);const ko=Le-zt;let ps=null;{let rn,Ue;for(;$e&&typeof(rn=rt.getKey())=="number";){Ue=rn-ae;const Bn=rt.getComponent(),Rn=h(Bn);if(Ue>ko)break;if(Ue===ko){if(!Rn){ps=rt;break}{if(W===0&&qt){ps=rt;break}const sn=qe&&c(qe.getComponent());if(W===0&&sn)break}}if(Rn){const sn=Bn.d;K[sn],Ct[sn],Bn.i===void 0&&(K[sn]||Ct[sn]!=null&&W!==1)?(K[sn]||Ct[sn]!=null&&W===0)&&(ae++,Cn--):ae++}$e=rt.nextSibling()}}const Al=ko+ae+Qe+Cn;i(Al>=0,"trying to descend to a negative index"),ht.descend(Al),qt&&(kt=qe=ps=null,Et++),wt(kt,yt,qe,ps,ht,It)&&Cn++,ht.ascend()}else{let kt;for(;Me&&(kt=at.getKey(),typeof kt!="string"||!(kt>pt||kt===pt));)Me=at.nextSibling();const qt=Me&&kt===pt?at:null,jt=Pn(pt);let Le;for(;$e&&(Le=rt.getKey(),typeof Le!="string"||!(Le>pt||Le===pt));)$e=rt.nextSibling();const qe=$e&&Le===pt?rt:null;ht.descend(pt),wt(qt,yt,jt,qe,ht,It),ht.ascend()}return Pn.end(),vr&&at.ascend(),He&&rt.ascend(),Yt})(oe,oe.clone(),Qt,Qt.clone(),$t,null),B)return{ok:!1,conflict:B};$t.reset();const Te=(wt,at,yt)=>wt.traverse(at,(ut,rt)=>{ut.d!=null&&yt(ut.d,wt,rt)});(K.length||Lt.length)&&(Te(Qt,$t,(wt,at,yt)=>{K[wt]&&!ct[wt]&&yt.write("r",!0),Lt[wt]&&yt.mergeTree(Lt[wt].get())}),$t.reset());const ge=[],Je=[];if((At.length||K.length)&&!B){const wt=s.readCursor(O($t.get()));if(Te(wt,null,(at,yt)=>{ge[at]=yt.clone()}),At.forEach(at=>{at&&Te(s.readCursor(at.get()),null,(yt,ut)=>{ge[yt]=ut.clone()})}),(function at(yt,ut,rt,ht,It,Tt){const St=a(ut);if(St&&c(St))if(St.p!=null){const st=St.p;ge[st].getPath(),rt=ge[st],ht=Je[st]=s.writeCursor()}else St.r!==void 0&&(rt=null);else h(a(rt))&&(rt=null);const Yt=yt.getComponent();if(Yt){let st;if((st=Yt.d)!=null){const Et=At[st];Et&&(Et.get(),ht.mergeTree(Et.get()),rt=s.readCursor(Et.get()))}}let Vt=0,Ht=0;const ne=s.advancer(ut,void 0,(st,Et)=>{c(Et)&&Vt--}),Rt=s.advancer(rt,(st,Et)=>h(Et)?-(st-Ht)-1:st-Ht,(st,Et)=>{h(Et)&&Ht++});for(const st of yt)if(typeof st=="number"){const Et=ne(st),zt=st+Vt,ae=Rt(zt),Qe=zt+Ht;ht.descend(Qe),at(yt,Et,ae,ht),ht.ascend()}else ht.descend(st),at(yt,ne(st),Rt(st),ht),ht.ascend();ne.end(),Rt.end()})(Qt,wt,wt.clone(),$t),$t.reset(),B)return{ok:!1,conflict:B};if($t.get(),Je.length){const at=Je.map(ut=>ut?ut.get():null),yt=s.readCursor(O($t.get()));if(Te(yt,$t,(ut,rt,ht)=>{const It=at[ut];It&&(ht.mergeTree(It),at[ut]=null)}),at.find(ut=>ut)){const ut=s.writeCursor(),rt=s.writeCursor();let ht=0,It=0;at.forEach(Tt=>{Tt!=null&&Te(s.readCursor(Tt),null,St=>{const Yt=vn[St];ut.writeMove($[Yt].getPath(),Z[Yt].getPath(),ht++);const Vt=Bt[Yt];Vt&&Vt.forEach(Ht=>{K[Ht]||W!==1&&Ct[Ht]!=null||rt.writeMove(tt[Ht].getPath(),U[Ht].getPath(),It++)})})}),B={type:o.ConflictType.BLACKHOLE,op1:ut.get(),op2:rt.get()}}}}return B?{ok:!1,conflict:B}:{ok:!0,result:$t.get()}}const F=T=>{const M=new Error("Transform detected write conflict");throw M.conflict=T,M.type=M.name="writeConflict",M};function Q(T,M,j){const W=x(T,M,j);if(W.ok)return W.result;F(W.conflict)}const G=T=>{const M=s.writeCursor();return s.readCursor(T).traverse(M,(j,W)=>{(h(j)||H(j))&&W.write("r",!0)}),M.get()},it=(T,M)=>{const{type:j,op1:W,op2:B}=T;switch(j){case o.ConflictType.DROP_COLLISION:return M==="left"?[null,G(B)]:[G(W),null];case o.ConflictType.RM_UNEXPECTED_CONTENT:let $=!1;return s.readCursor(W).traverse(null,Z=>{Z.r!==void 0&&($=!0)}),$?[null,G(B)]:[G(W),null];case o.ConflictType.BLACKHOLE:return[G(W),G(B)];default:throw Error("Unrecognised conflict: "+j)}};function lt(T,M,j,W){let B=null;for(;;){const $=x(M,j,W);if($.ok)return E(B,$.result);{const{conflict:Z}=$;T(Z)||F(Z);const[tt,U]=it(Z,W);M=E(Y(M),tt),j=E(Y(j),U),B=E(B,U)}}}})(Es)),Es}var Tu;function UE(){return Tu||(Tu=1,(function(t){var e=$n&&$n.__createBinding||(Object.create?(function(o,i,a,l){l===void 0&&(l=a),Object.defineProperty(o,l,{enumerable:!0,get:function(){return i[a]}})}):(function(o,i,a,l){l===void 0&&(l=a),o[l]=i[a]})),n=$n&&$n.__exportStar||function(o,i){for(var a in o)a!=="default"&&!i.hasOwnProperty(a)&&e(i,o,a)};Object.defineProperty(t,"__esModule",{value:!0}),n(LE(),t);var r=bd();Object.defineProperty(t,"ReadCursor",{enumerable:!0,get:function(){return r.ReadCursor}}),Object.defineProperty(t,"WriteCursor",{enumerable:!0,get:function(){return r.WriteCursor}});var s=Td();Object.defineProperty(t,"ConflictType",{enumerable:!0,get:function(){return s.ConflictType}})})($n)),$n}var he=UE();const FE=Ne(he),kE=Sm({__proto__:null,default:FE},[he]);var _t=(t=>(t[t.COVER=0]="COVER",t[t.REPLACE=1]="REPLACE",t))(_t||{}),J=(t=>(t.RETAIN="r",t.INSERT="i",t.DELETE="d",t))(J||{});const is=ue("univer.config-service");class Id{constructor(){_(this,"_configChanged$",new se),_(this,"configChanged$",this._configChanged$.asObservable()),_(this,"_config",new Map)}dispose(){this._config.clear(),this._configChanged$.complete()}getConfig(e){return this._config.get(e)}setConfig(e,n,r){var s;const{merge:o=!1}=r||{};let i=(s=this._config.get(e))!=null?s:{};o?i=Ro(i,n):i=n,this._config.set(e,i),this._configChanged$.next({[e]:i})}deleteConfig(e){return this._config.delete(e)}subscribeConfigValue$(e){return new ee(n=>{Object.prototype.hasOwnProperty.call(this._config,e)&&n.next(this._config.get(e));const r=this.configChanged$.pipe(pn(s=>Object.prototype.hasOwnProperty.call(s,e))).subscribe(s=>n.next(s[e]));return()=>r.unsubscribe()})}}const yr=ue("univer.context-service");class wd extends Xt{constructor(){super(...arguments),_(this,"_contextChanged$",new se),_(this,"contextChanged$",this._contextChanged$.asObservable()),_(this,"_contextMap",new Map)}dispose(){super.dispose(),this._contextChanged$.complete(),this._contextMap.clear()}getContextValue(e){var n;return(n=this._contextMap.get(e))!=null?n:!1}setContextValue(e,n){this._contextMap.set(e,n),this._contextChanged$.next({[e]:n})}subscribeContextValue$(e){return new ee(n=>{const r=this._contextChanged$.pipe(pn(s=>typeof s[e]<"u")).subscribe(s=>n.next(s[e]));return this._contextMap.has(e)&&n.next(this._contextMap.get(e)),()=>r.unsubscribe()})}}var Sd=(t=>(t[t.SILENT=0]="SILENT",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.VERBOSE=4]="VERBOSE",t))(Sd||{});const Ee=ue("univer.log");class Ad extends Xt{constructor(){super(...arguments),_(this,"_logLevel",3),_(this,"_deduction",new Set)}dispose(){super.dispose(),this._logLevel=3,this._deduction.clear()}debug(...e){this._logLevel>=4&&this._log(console.debug,...e)}log(...e){this._logLevel>=3&&this._log(console.log,...e)}warn(...e){this._logLevel>=2&&this._log(console.warn,...e)}error(...e){this._logLevel>=1&&this._log(console.error,...e)}deprecate(...e){this._logLevel>=2&&this._logWithDeduplication(console.error,...e)}setLogLevel(e){this._logLevel=e}_log(e,...n){const r=n[0];/^\[(.*?)\]/g.test(r)?e(`\x1B[97;104m${r}\x1B[0m`,...n.slice(1)):e(...n)}_logWithDeduplication(e,...n){const r=PE(...n);this._deduction.has(r)||(this._deduction.add(r),this._log(e,...n))}}function PE(...t){return t.map(e=>JSON.stringify(e)).join("")}var BE=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Go=(t,e)=>(n,r)=>e(n,r,t);const Qs="command.logExecution";var as=(t=>(t[t.COMMAND=0]="COMMAND",t[t.OPERATION=1]="OPERATION",t[t.MUTATION=2]="MUTATION",t))(as||{});const ls=ue("univer.core.command-service");class $E{constructor(){_(this,"_commands",new Map),_(this,"_commandTypes",new Map)}registerCommand(e){if(this._commands.has(e.id))throw new Error(`[CommandRegistry]: command "${e.id}" has been registered before.`);return this._commands.set(e.id,e),this._commandTypes.set(e.id,e.type),Wt(()=>{this.unregisterCommand(e.id)})}unregisterCommand(e){this._commands.delete(e),this._commandTypes.delete(e)}hasCommand(e){return this._commands.has(e)}getCommand(e){return this._commands.has(e)?[this._commands.get(e)]:null}getCommandType(e){return this._commandTypes.get(e)}}const Od={id:"nil",type:0,handler:()=>!0};let qs=class extends Xt{constructor(t,e,n){super(),_(this,"_commandRegistry"),_(this,"_beforeCommandExecutionListeners",[]),_(this,"_commandExecutedListeners",[]),_(this,"_collabMutationListeners",[]),_(this,"_multiCommandDisposables",new Map),_(this,"_commandExecutingLevel",0),_(this,"_commandExecutionStack",[]),this._injector=t,this._logService=e,this._configService=n,this._commandRegistry=new $E,this.registerCommand(Od)}dispose(){super.dispose(),this._commandExecutedListeners.length=0,this._beforeCommandExecutionListeners.length=0,this._collabMutationListeners.length=0}disposed(){return this._disposed}hasCommand(t){return this._commandRegistry.hasCommand(t)}registerCommand(t){return this._commandRegistry.registerCommand(t)}unregisterCommand(t){var e;this._commandRegistry.unregisterCommand(t),(e=this._multiCommandDisposables.get(t))==null||e.dispose()}registerMultipleCommand(t){return this._registerMultiCommand(t)}beforeCommandExecuted(t){if(this._beforeCommandExecutionListeners.indexOf(t)===-1)return this._beforeCommandExecutionListeners.push(t),Wt(()=>{const e=this._beforeCommandExecutionListeners.indexOf(t);this._beforeCommandExecutionListeners.splice(e,1)});throw new Error("[CommandService]: could not add a listener twice.")}onCommandExecuted(t){if(this._commandExecutedListeners.indexOf(t)===-1)return this._commandExecutedListeners.push(t),Wt(()=>{const e=this._commandExecutedListeners.indexOf(t);this._commandExecutedListeners.splice(e,1)});throw new Error("[CommandService]: could not add a listener twice.")}onMutationExecutedForCollab(t){if(this._collabMutationListeners.indexOf(t)===-1)return this._collabMutationListeners.push(t),Wt(()=>{const e=this._collabMutationListeners.indexOf(t);this._collabMutationListeners.splice(e,1)});throw new Error("[CommandService]: could not add a collab mutation listener twice.")}async executeCommand(t,e,n){try{const r=this._commandRegistry.getCommand(t);if(r){const[s]=r,o={id:s.id,type:s.type,params:e},i=this._pushCommandExecutionStack(o),a=n??{};this._beforeCommandExecutionListeners.forEach(u=>u(o,a));const l=await this._execute(s,e,a);return a.syncOnly?s.type===2&&this._collabMutationListeners.forEach(u=>u(o,a)):(this._commandExecutedListeners.forEach(u=>u(o,a)),s.type===2&&this._collabMutationListeners.forEach(u=>u(o,a))),i.dispose(),l}throw new Error(`[CommandService]: command "${t}" is not registered.`)}catch(r){if(r instanceof Gs)return!1;throw r}}syncExecuteCommand(t,e,n){var r;try{const s=this._commandRegistry.getCommand(t);if(s){const[o]=s,i={id:o.id,type:o.type,params:e};if(o.type===2){const c=Lm(this._commandExecutionStack,h=>h.type===0);c&&(i.params=(r=i.params)!=null?r:{},i.params.trigger=c.id)}const a=this._pushCommandExecutionStack(i),l=n??{};this._beforeCommandExecutionListeners.forEach(c=>c(i,l));const u=this._syncExecute(o,e,l);return l.syncOnly?o.type===2&&this._collabMutationListeners.forEach(c=>c(i,l)):(this._commandExecutedListeners.forEach(c=>c(i,l)),o.type===2&&this._collabMutationListeners.forEach(c=>c(i,l))),a.dispose(),u}throw new Error(`[CommandService]: command "${t}" is not registered.`)}catch(s){if(s instanceof Gs)return!1;throw s}}_pushCommandExecutionStack(t){return this._commandExecutionStack.push(t),Wt(()=>ns(this._commandExecutionStack,t))}_registerMultiCommand(t){const e=this._commandRegistry.getCommand(t.id);let n;if(e){if(e[0].multi!==!0)throw new Error("Command has registered as a single command.");n=e[0]}else{n=new HE(t.id);const s=new bo;s.add(this._commandRegistry.registerCommand(n)),s.add(Wt(()=>{this._multiCommandDisposables.delete(t.id)})),this._multiCommandDisposables.set(t.id,s)}const r=n.registerImplementation(t);return Wt(()=>{var s;r.dispose(),n.hasImplementations()||(s=this._multiCommandDisposables.get(t.id))==null||s.dispose()})}async _execute(t,e,n){if(n!=null&&n.syncOnly)return!0;this._configService.getConfig(Qs)!==!1&&this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(this._commandExecutingLevel,0))}executing command "${t.id}"`),this._commandExecutingLevel++;let r;try{r=await this._injector.invoke(t.handler,e,n),this._commandExecutingLevel--}catch(s){throw r=!1,this._commandExecutingLevel=0,s}return r}_syncExecute(t,e,n){if(n!=null&&n.syncOnly)return!0;this._configService.getConfig(Qs)!==!1&&this._logService.debug("[CommandService]",`${"|-".repeat(Math.max(0,this._commandExecutingLevel))}executing command "${t.id}".`),this._commandExecutingLevel++;let r;try{if(r=this._injector.invoke(t.handler,e,n),r instanceof Promise)throw new TypeError("[CommandService]: Command handler should not return a promise.");this._commandExecutingLevel--}catch(s){throw r=!1,this._commandExecutingLevel=0,s}return r}};qs=BE([Go(0,Ce(_n)),Go(1,Ee),Go(2,is)],qs);class HE{constructor(e){_(this,"name"),_(this,"multi",!0),_(this,"type",0),_(this,"priority",0),_(this,"_implementations",[]),_(this,"handler",async(n,r)=>{if(!this._implementations.length)return!1;const s=n.get(Ee),o=n.get(yr),i=n.get(_n);for(const a of this._implementations){const l=a.command.preconditions;if((!l||l&&l(o))&&(s.debug("[MultiCommand]",`executing implementation "${a.command.name}".`),await i.invoke(a.command.handler,r)))return!0}return!1}),this.id=e,this.name=e}registerImplementation(e){const n={command:e};return this._implementations.push(n),this._implementations.sort((r,s)=>s.command.priority-r.command.priority),Wt(()=>{const r=this._implementations.indexOf(n);this._implementations.splice(r,1)})}hasImplementations(){return this._implementations.length>0}}function wo(t,e,n){const r=t.map(s=>()=>e.syncExecuteCommand(s.id,s.params,n));return wh(r)}function jE(t,e,n){const r=t.map(s=>()=>e.executeCommand(s.id,s.params,n));return Ih(r)}function Dd(t){return new ee(e=>{const n=t((...r)=>e.next(r));return()=>n?.dispose()})}function Ri(t){return function(e){return new ee(n=>(e.subscribe({next:r=>{n.next(r),t(r)&&n.complete()},complete:()=>n.complete(),error:r=>n.error(r)}),()=>n.unsubscribe()))}}function WE(t=0){return e=>{let n=[];return e.pipe(Gl(r=>n.push(r)),Wc(t),pr(()=>n),Gl(()=>n=[]))}}function VE(t){const e=new Fg(1);return setTimeout(()=>e.next(),t),e.pipe(Vc(1))}function GE(t,e){const n=new ie(e);return t.subscribe(n),n}const YE=t=>new Promise(e=>{jc(Dd(t.onCommandExecuted.bind(t)).pipe(pn(([n])=>n.type===as.MUTATION)),ym(300)).pipe(Wc(16),Tm()).subscribe(()=>{e()})});function Nd(t,e){let n=0,r=t.length-1;if(e<t[0])return 0;if(e>=t[t.length-1])return t.length-1;for(;n<=r;){if(t[n]===e){for(;n<t.length&&t[n]===e;)n++;return n}if(e>t[n]&&e<t[n+1])return n+1;if(t[r]===e){for(;r<t.length&&t[r]===e;)r++;return r}if(e>t[r-1]&&e<t[r])return r;n++,r--}return-1}function zE(t,e){let n=0,r=t.length-1;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<t[s]&&(s===0||e>=t[s-1]))return s;if(e>=t[s])n=s+1;else if(e<t[s])r=s-1;else return-1}return-1}function xd(t,e){let n=0,r=t.length;for(;n<r;){const s=Math.floor((n+r)/2);t[s]<=e?n=s+1:r=s}return n<t.length?n:t.length-1}function Sr(t,e,n=!1){let r=t.length-1;if(e<0||e<t[0])return 0;if(t.length<40||e<=t[20]||e>=t[r-20]?r=Nd(t,e):r=xd(t,e),n){const s=t[r];return t.indexOf(s)}return r}function KE(t){const e=new Blob([t],{type:"text/javascript"});return window.URL.createObjectURL(e)}const Ar=2,Md=1;function XE(t,e){if(e==null||t==null)return!0;const{left:n=0,top:r=0,height:s=0,width:o=0,angle:i=0}=e,{left:a=0,top:l=0,height:u=0,width:c=0,angle:h=0}=t,d=c,f=u,p=o,m=s;return Math.abs(a-n)>Ar||Math.abs(l-r)>Ar||Math.abs(d-p)>Ar||Math.abs(f-m)>Ar||Math.abs(h-i)>Md}function ks(t,e,n){const{dataStream:r,textRuns:s=[]}=t;let o=e;const i=[];for(const a of s){const{st:l,ed:u}=a;q.hasIntersectionBetweenTwoRanges(e,n,l,u)&&(l>o?(i.push(r.slice(o,l)),i.push(bi(r,{...a,ed:Math.min(u,n)}))):i.push(bi(r,{...a,st:o,ed:Math.min(u,n)}))),o=Math.max(e,Math.min(u,n))}return o!==n&&i.push(r.slice(o,n)),i.join("")}function JE(t,e=!0){var n;if(e&&(n=t.paragraphs)!=null&&n.length){const{dataStream:r,paragraphs:s=[]}=t;let o="",i=-1;for(const a of s){const{startIndex:l,paragraphStyle:u={}}=a,{spaceAbove:c,spaceBelow:h,lineSpacing:d}=u,f=[];c!=null&&(typeof c=="number"?f.push(`margin-top: ${c}px`):f.push(`margin-top: ${c.v}px`)),h!=null&&(typeof h=="number"?f.push(`margin-bottom: ${h}px`):f.push(`margin-bottom: ${h.v}px`)),d!=null&&f.push(`line-height: ${d}`),l>i+1?o+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}>${ks(t,i+1,l)}</p>`:o+=`<p class="UniverNormal" ${f.length?`style="${f.join("; ")};"`:""}></p>`,i=l}return i!==r.length&&(o+=ks(t,i,r.length)),o}else return ks(t,0,t.dataStream.length)}function bi(t,e){const{st:n,ed:r,ts:s={}}=e,{ff:o,fs:i,it:a,bl:l,ul:u,st:c,ol:h,bg:d,cl:f,va:p}=s;let m=t.slice(n,r);const R=[];return a===ot.TRUE&&(m=`<i>${m}</i>`),p===tn.SUPERSCRIPT?m=`<sup>${m}</sup>`:p===tn.SUBSCRIPT&&(m=`<sub>${m}</sub>`),u?.s===ot.TRUE&&(m=`<u>${m}</u>`),c?.s===ot.TRUE&&(m=`<s>${m}</s>`),l===ot.TRUE&&(m=`<strong>${m}</strong>`),o&&R.push(`font-family: ${o}`),f&&R.push(`color: ${f.rgb}`),i&&R.push(`font-size: ${i}pt`),h&&R.push("text-decoration: overline"),d&&R.push(`background: ${d.rgb}`),R.length?`<span style="${R.join("; ")};">${m}</span>`:m}const Ld={[Io.OFFICE]:{[ce.ACCENT1]:"#4472C4",[ce.ACCENT2]:"#ED7D31",[ce.ACCENT3]:"#A5A5A5",[ce.ACCENT4]:"#70AD47",[ce.ACCENT5]:"#5B9BD5",[ce.ACCENT6]:"#70AD47",[ce.DARK1]:"#000000",[ce.DARK2]:"#44546A",[ce.LIGHT1]:"#FFFFFF",[ce.LIGHT2]:"#E7E6E6",[ce.HYPERLINK]:"#0563C1",[ce.FOLLOWED_HYPERLINK]:"#954F72"}};class So{constructor(){_(this,"_themeValue",ce.LIGHT1),_(this,"_themeColors"),_(this,"_themeTint"),_(this,"_rgbValue",""),_(this,"_colorType"),this._colorType=Se.UNSUPPORTED,this._themeColors=Io.OFFICE,this._themeTint=0}asRgbColor(){return new Fd(this._rgbValue,this)}asThemeColor(){return new Pd(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Se.THEME:return this.asThemeColor();case Se.RGB:return this.asRgbColor();case Se.UNSUPPORTED:throw new Error("unsupported color type")}}setRgbColor(e){return this._colorType=Se.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Se.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Se.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Se.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}class Nn{constructor(e){_(this,"_builder"),this._builder=e}static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";const n=+`0x${e[0]}${e[1]}`,r=+`0x${e[2]}${e[3]}`,s=+`0x${e[4]}${e[5]}`;return new So().setRgbColor(`rgb(${n},${r},${s})`).asRgbColor()}static hexToRgbString(e){const n=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(n,(o,i,a,l)=>i+i+a+a+l+l);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s=null;if(r){const o=Number.parseInt(r[1],16),i=Number.parseInt(r[2],16),a=Number.parseInt(r[3],16);s=`rgba(${o},${i},${a})`}return s}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new Nn(this._builder)}equals(e){return!1}}class Ud{constructor(e){_(this,"_saturation",0),_(this,"_hue",0),_(this,"_lightness",0),_(this,"_alpha",0);const n=e.getRed()/255,r=e.getGreen()/255,s=e.getBlue()/255,o=e.getAlpha()/255,i=Math.min(n,Math.min(r,s)),a=Math.max(n,Math.max(r,s)),l=a-i;if(a===i){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(i+a)/2,this._lightness<.5?this._saturation=l/(a+i):this._saturation=l/(2-a-i),n===a&&(this._hue=(r-s)/l),r===a&&(this._hue=2+(s-n)/l),s===a&&(this._hue=4+(n-r)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new So;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let n;this._lightness<.5?n=this._lightness*(1+this._saturation):n=this._lightness+this._saturation-this._lightness*this._saturation;const r=2*this._lightness-n,s=this._hue/360,o=s+1/3,i=this.setColor(n,r,o),a=this.setColor(n,r,s),l=s-1/3,u=this.setColor(n,r,l);return e.setRgbColor(`rgba(${Math.round(i*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,n,r){r<0&&(r+=1),r>1&&(r-=1);let s;return 6*r<1?s=n+(e-n)*6*r:2*r<1?s=e:3*r<2?s=n+(e-n)*(2/3-r)*6:s=n,s}setLightness(e){this._lightness=e}}const Ps=class an extends Nn{constructor(e,n){super(n),_(this,"_cssString"),_(this,"_red"),_(this,"_green"),_(this,"_blue"),_(this,"_alpha");let r=e.match(an.RGBA_EXTRACT);if(r){const s=+r[1],o=+r[2],i=+r[3],a=+r[4];this._cssString=e,this._red=s,this._green=o,this._blue=i,this._alpha=a;return}if(r=e.match(an.RGB_EXTRACT),r){const s=+r[1],o=+r[2],i=+r[3];this._cssString=e,this._red=s,this._green=o,this._blue=i,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return Nn.rgbColorToHexValue(this)}getRed(){let e=this._red+an.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getGreen(){let e=this._green+an.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getBlue(){let e=this._blue+an.RGB_COLOR_AMT;return e>255?e=255:e<0&&(e=0),e}getAlpha(){return this._alpha}getColorType(){return Se.RGB}clone(){return new an(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(e){return e instanceof an?e._red===this._red&&e._blue===this._blue&&e._green===this._green&&e._alpha===this._alpha:!1}getCssString(){return this._cssString}};_(Ps,"RGB_COLOR_AMT",0),_(Ps,"RGBA_EXTRACT",new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*")),_(Ps,"RGB_EXTRACT",new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*"));let Fd=Ps;const kd=class Yn extends Nn{constructor(e,n,r,s){super(s),_(this,"_themeColorType"),_(this,"_themeTint"),_(this,"_themeColors"),this._themeColorType=e,this._themeTint=n,this._themeColors=r}lumValue(e,n){if(e==null)return n;let r;return e<0?r=n*(1+e):r=n*(1-e)+(255-255*(1-e)),r}asRgbColor(){const e=Ld[this._themeColors];if(e==null)throw new Error("not find themeColors type");const n=e[this._themeColorType];if(n==null)throw new Error("not find themeColors value");let r;if(Yn._cacheThemeColor.has(this._themeColors)){if(r=Yn._cacheThemeColor.get(this._themeColors),r.has(this._themeColorType))return r.get(this._themeColorType)}else r=new Map,Yn._cacheThemeColor.set(this._themeColors,r);const s=new Ud(Nn.hexValueToRgbColor(n));s.setLightness(this.lumValue(this._themeTint,s.getLightness()*255)/255);const o=s.asRgbColor();return r.set(this._themeColorType,o),o}clone(){return new Yn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(e){return e instanceof Yn?e._themeColorType===this._themeColorType:!1}getColorType(){return Se.THEME}getThemeColorType(){return this._themeColorType}};_(kd,"_cacheThemeColor",new Map);let Pd=kd;const QE="rgb(",qE="rgba(",Ti={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchealmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],darkyellow:[139,128,0],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midbightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};class we{constructor(e){if(_(this,"_color"),_(this,"_rgbColor"),_(this,"_isValid",!1),e==null){this._setNullColor();return}if(e instanceof we){this._color={...e._color},this._rgbColor={...e._rgbColor};return}const n=Bd(e);if(n==null){this._setNullColor();return}this._color=n;const r=rv(this._color);if(r==null){this._setNullColor();return}this._rgbColor=r,this._isValid=!0}static mix(e,n,r){var s,o;r=Math.min(1,Math.max(0,r));const i=new we(e).toRgb(),a=new we(n).toRgb(),l=(s=i.a)!=null?s:1,u=(o=a.a)!=null?o:1,c={r:(a.r-i.r)*r+i.r,g:(a.g-i.g)*r+i.g,b:(a.b-i.b)*r+i.b,a:(u-l)*r+l};return new we(c)}static getContrastRatio(e,n){const r=new we(e).getLuminance(),s=new we(n).getLuminance();return(Math.max(r,s)+.05)/(Math.min(r,s)+.05)}get isValid(){return this._isValid}toRgb(){return this._rgbColor}toRgbString(){const{r:e,g:n,b:r,a:s=1}=this.toRgb(),o=s<1;return`rgb${o?"a":""}(${e},${n},${r}${o?`,${s}`:""})`}toString(){return this.toRgbString()}toHexString(e){const{r:n,g:r,b:s,a:o=1}=this.toRgb(),i=o<1,a=[bs(Math.round(n).toString(16)),bs(Math.round(r).toString(16)),bs(Math.round(s).toString(16)),bs(Math.round(o*255).toString(16))];return e&&a[0][0]===a[0][1]&&a[1][0]===a[1][1]&&a[2][0]===a[2][1]&&a[3][0]===a[3][1]?i?`#${a[0][0]}${a[1][0]}${a[2][0]}${a[3][0]}`:`#${a[0][0]}${a[1][0]}${a[2][0]}`:i?`#${a[0]}${a[1]}${a[2]}${a[3]}`:`#${a[0]}${a[1]}${a[2]}`}toHsv(){return av(this.toRgb())}toHsl(){return iv(this.toRgb())}lighten(e=10){const n=this.toHsl();return n.l+=e,n.l=Math.min(Math.max(n.l,0),100),new we(n)}darken(e=10){const n=this.toHsl();return n.l-=e,n.l=Math.min(Math.max(n.l,0),100),new we(n)}setAlpha(e){return new we({...this._rgbColor,a:e})}getLuminance(){let{r:e,g:n,b:r}=this.toRgb();return e=Yo(e),n=Yo(n),r=Yo(r),Number((.2126*e+.7152*n+.0722*r).toFixed(3))}getBrightness(){const{r:e,g:n,b:r}=this.toRgb();return(e*299+n*587+r*114)/1e3}getAlpha(){var e;return(e=this._color.a)!=null?e:1}isDark(){return this.getBrightness()<128}isLight(){return!this.isDark()}_setNullColor(){this._isValid=!1,this._color={r:0,g:0,b:0,a:0},this._rgbColor={r:0,g:0,b:0,a:0}}}const bs=t=>t.length===1?`0${t}`:t,Yo=t=>(t/=255,t<=.03928?t/12.92:((t+.055)/1.055)**2.4),Bd=t=>{if(uv(t)){if("r"in t){const r={r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)};return t.a!==void 0&&(r.a=t.a),r}if("l"in t){const r={h:Math.round(t.h),s:t.s,l:t.l};return t.a!==void 0&&(r.a=t.a),r}const n={h:Math.round(t.h),s:t.s,v:t.v};return t.a!==void 0&&(n.a=t.a),n}const e=t.trim().toLowerCase();if(Ti[e]){const n=Ti[e],r={r:Math.round(n[0]),g:Math.round(n[1]),b:Math.round(n[2])};return r.a=n[3]||1,r}if(e.startsWith("#"))return ZE(e);if(e.startsWith("rgb"))return tv(e);if(e.startsWith("hsl"))return ev(e);if(e.startsWith("hsv"))return nv(e)},ZE=t=>{const e=t.substring(1),n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let r=e.match(n);if(!r||r.length<3)throw new Error(`The color '${t}' is illegal hex color`);r[0].length===1&&(r=r.map(o=>o+o));const s={r:Number.parseInt(r[0],16),g:Number.parseInt(r[1],16),b:Number.parseInt(r[2],16)};return r.length>3&&(s.a=Number.parseInt(r[3],16)/255),s},tv=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal rgb color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal rgb color`);const r={r:Number.parseInt(n[0],10),g:Number.parseInt(n[1],10),b:Number.parseInt(n[2],10)};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},ev=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsl color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsl color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),l:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},nv=t=>{const e=t.indexOf("(");if(e===-1)throw new Error(`The color '${t}' is illegal hsv color`);const n=t.substring(e+1,t.length-1).split(",");if(n.length<3)throw new Error(`The color '${t}' is illegal hsv color`);const r={h:Number.parseInt(n[0],10),s:Number.parseFloat(n[1]),v:Number.parseFloat(n[2])};return n.length>3&&(r.a=Number.parseFloat(n[3])),r},rv=t=>{const e=Bd(t);if(e!=null)return"r"in e?e:"l"in e?sv(e):ov(e)},zo=(t,e,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t),sv=t=>{let{h:e,s:n,l:r}=t;e/=360,n/=100,r/=100;let s=0,o=0,i=0;if(n===0)s=o=i=r;else{const l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;s=zo(u,l,e+1/3),o=zo(u,l,e),i=zo(u,l,e-1/3)}const a={r:Math.round(s*255),g:Math.round(o*255),b:Math.round(i*255)};return t.a!==void 0&&(a.a=t.a),a},ov=t=>{let{h:e,s:n,v:r}=t;e=e/360*6,n/=100,r/=100;const s=Math.floor(e),o=e-s,i=r*(1-n),a=r*(1-o*n),l=r*(1-(1-o)*n),u=s%6,c=[r,a,i,i,l,r][u],h=[l,r,r,a,i,i][u],d=[i,i,l,r,r,a][u],f={r:c*255,g:h*255,b:d*255};return t.a!==void 0&&(f.a=t.a),f},iv=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const s=Math.max(e,n,r),o=Math.min(e,n,r),i=(s+o)/2;let a,l;if(s===o)a=l=0;else{const c=s-o;switch(l=i>.5?c/(2-s-o):c/(s+o),s){case e:a=(n-r)/c+(n<r?6:0);break;case n:a=(r-e)/c+2;break;default:a=(e-n)/c+4;break}a/=6}const u={h:Math.round(a*360),s:Math.round(l*100),l:Math.round(i*100)};return t.a!==void 0&&(u.a=t.a),u},av=t=>{let{r:e,g:n,b:r}=t;e/=255,n/=255,r/=255;const s=Math.max(e,n,r),o=Math.min(e,n,r);let i;const a=s,l=s-o,u=s===0?0:l/s;if(s===o)i=0;else{switch(s){case e:i=(n-r)/l+(n<r?6:0);break;case n:i=(r-e)/l+2;break;default:i=(e-n)/l+4;break}i/=6}const c={h:Math.round(i*360),s:Math.round(u*100),v:Math.round(a*100)};return t.a!==void 0&&(c.a=t.a),c},lv=t=>t==null,uv=t=>!lv(t)&&typeof t=="object";function cv(t){const e=/^#(?:[0]{3}|[0]{6})\b/,n=/^rgb\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*\)$/,r=/^rgba\s*\(\s*0+\s*,\s*0+\s*,\s*0+\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*\)$/,o=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*0%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(e.test(t)||n.test(t)||r.test(t)||s.test(t)||o.test(t))}function hv(t){const e=/^#(?:[Ff]{3}|[Ff]{6})\b/,n=/^rgb\s*\(\s*255\s*,\s*255\s*,\s*255\s*\)$/,r=/^rgba\s*\(\s*255\s*,\s*255\s*,\s*255\s*,\s*(1|1\.0*|0?\.\d+)\)$/,s=/^hsl\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*\)$/,o=/^hsla\s*\(\s*0*\s*,\s*0%*\s*,\s*100%*\s*,\s*(1|1\.0*|0?\.\d+)\)$/;return!!(e.test(t)||n.test(t)||r.test(t)||s.test(t)||o.test(t))}function $d(t){return t&&(t.s!==void 0||t.p!==void 0||t.v!==void 0||t.t!==void 0||t.f!==void 0||t.si!==void 0||t.custom!==void 0)}function dv(t){if(t.t!==void 0)return t.t;if(typeof t.v=="string")return hn.STRING;if(typeof t.v=="number")return hn.NUMBER;if(typeof t.v=="boolean")return hn.BOOLEAN}function fv(t){if(t==null)return!0;const{v:e,f:n,si:r,p:s,custom:o}=t;return!(!(e==null||typeof e=="string"&&e.length===0)||n!=null&&n.length>0||r!=null&&r.length>0||s!=null||o!=null)}function Hd(t){return t!=null&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean")}var gt=(t=>(t[t.NORMAL=0]="NORMAL",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(gt||{}),Ot=(t=>(t[t.NONE=0]="NONE",t[t.ROW=1]="ROW",t[t.COLUMN=2]="COLUMN",t[t.ALL=3]="ALL",t))(Ot||{});function pv(t){return[t.startRow,t.startColumn,t.endRow,t.endColumn]}var jd=(t=>(t.NONE="none",t.BACKWARD="backward",t.FORWARD="forward",t))(jd||{}),Wd=(t=>(t.RECT="RECT",t.TEXT="TEXT",t))(Wd||{});function gv(t,e,n){let r=!1,s=!1,o=t,i=e,a=t,l=e;if(n==null)return{actualRow:t,actualColumn:e,isMergedMainCell:s,isMerged:r,endRow:o,endColumn:i,startRow:a,startColumn:l};for(let u=0;u<n.length;u++){const{startRow:c,endRow:h,startColumn:d,endColumn:f}=n[u];if(t===c&&e===d){o=h,i=f,a=c,l=d,s=!0;break}if(t>=c&&t<=h&&e>=d&&e<=f){o=h,i=f,a=c,l=d,r=!0;break}}return{actualRow:t,actualColumn:e,isMergedMainCell:s,isMerged:r,endRow:o,endColumn:i,startRow:a,startColumn:l}}var er=(t=>(t.Raw="raw",t.Intercepted="intercepted",t.Both="both",t))(er||{});const Or=2,Dr=2**2,Bs=2**3,Nr=2**4,xr=2**5,Mr=2**6,Ii=2**7,wi=2**8,Si=2**9,mv=0,_v=2958466,yv=-694324,Ev=35830291,vv=-1,Iu=1,ir=6,ka="general",Pa="hash",ar="zero",Ba="qmark",$a="slash",Xr="group",Zs="scale",Ha="comma",ja="break",Ao="text",Wa="plus",Va="minus",to="point",Ga="space",Ya="percent",Oo="digit",za="calendar",Jr="error",Ka="datetime",Xa="duration",Ja="condition",Qa="dbnum",qa="natnum",Za="locale",tl="color",Vd="modifier",el="ampm",nl="escaped",rl="string",sl="skip",ol="exp",il="fill",al="paren",Do="char",Cv=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],Ai=["","$","","","","","","","","","","","","","","","","","","","","","","","","",""],Oi=new RegExp("["+Ai.join("")+"]"),Ko=Object.freeze({1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"}),Gd=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,nr={},y=(t,e="")=>t.replace(/~/g,e).split(";"),Ft=(t,e=0,n=0)=>(t.mmm||(t.mmm=e<1?t.mmmm.concat():t.mmmm.map(r=>{const s=r.slice(0,e%10);return s+(e<10||r===s?"":".")})),t.ddd||(t.ddd=n<1?t.dddd.concat():t.dddd.map(r=>{const s=r.slice(0,n%10);return s+(n<10||r===s?"":".")})),!t.mmm6&&t.mmmm6&&(t.mmm6=t.mmmm6),t),Rv={group:"",decimal:".",positive:"+",negative:"-",percent:"%",exponent:"E",nan:"NaN",infinity:"",ampm:y("AM;PM"),mmmm6:y("Muharram;Safar;Rabi I;Rabi II;Jumada I;Jumada II;Rajab;Shaban;Ramadan;Shawwal;Dhul-Qidah;Dhul-Hijjah"),mmm6:y("Muh.;Saf.;Rab. I;Rab. II;Jum. I;Jum. II;Raj.;Sha.;Ram.;Shaw.;Dhul-Q.;Dhul-H."),mmmm:y("January;February;March;April;May;June;July;August;September;October;November;December"),mmm:y("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sep;Oct;Nov;Dec"),dddd:y("Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"),ddd:y("Sun;Mon;Tue;Wed;Thu;Fri;Sat"),bool:y("TRUE;FALSE"),preferMDY:!1};function ll(t){const e=Gd.exec(t);if(!e)throw new SyntaxError(`Malformed locale: ${t}`);return{lang:e[1]+(e[2]?"_"+e[2]:""),language:e[1],territory:e[2]||""}}function ul(t){if(typeof t=="number")return Ko[t&65535]||null;const e=parseInt(t,16);return isFinite(e)&&Ko[e&65535]?Ko[e&65535]||null:Gd.test(t)?t:null}function Er(t){const e=ul(t);let n=null;if(e){const r=ll(e);n=nr[r.lang]||nr[r.language]||null}return n}function Di(t){return Object.assign({},Rv,t)}function et(t,e){const n=typeof e=="object"?e:ll(e);return nr[n.lang]=Di(t),n.language!==n.lang&&!nr[n.language]&&(nr[n.language]=Di(t)),nr[n.lang]}const mn=Di({group:",",preferMDY:!0});mn.isDefault=!0;et({group:",",ampm:y(";"),mmmm:y(";;;;;;;;;;;"),mmm:y("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:y("~;~;~;~;~;~;~",""),ddd:y(";;;;;;")},"zh_CN");const cl={group:",",ampm:y(";"),mmmm:y("1;2;3;4;5;6;7;8;9;10;11;12"),mmm:y("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:y("~;~;~;~;~;~;~",""),ddd:y(";;;;;;")};et({...cl,nan:"",dddd:y("~;~;~;~;~;~;~","")},"zh_TW");et({...cl,dddd:y("~;~;~;~;~;~;~","")},"zh_HK");et({...cl,ampm:y(";"),dddd:y("~;~;~;~;~;~;~",""),ddd:y(";;;;;;")},"ja");et({group:",",ampm:y(";"),mmmm:y("1;2;3;4;5;6;7;8;9;10;11;12"),mmm:y("1;2;3;4;5;6;7;8;9;10;11;12"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"ko");et({group:",",ampm:y(";"),mmmm:y("~;;~;;~;;~;~;;~;;~",""),mmm:y("..;..;..;..;..;..;..;..;..;..;..;.."),dddd:y(";;;;;;"),ddd:y(".;.;.;.;.;.;.")},"th");et(Ft({decimal:",",ampm:y("dop.;odp."),mmmm:y("ledna;nora;bezna;dubna;kvtna;ervna;ervence;srpna;z;jna;listopadu;prosince"),mmm:y("I;II;III;IV;V;VI;VII;VIII;IX;X;XI;XII"),dddd:y("nedle;pondl;ter;steda;tvrtek;ptek;sobota"),bool:y("PRAVDA;NEPRAVDA")},-1,2),"cs");et(Ft({group:".",decimal:",",mmmm:y("januar;februar;marts;april;maj;juni;juli;august;september;oktober;november;december"),dddd:y("sn~;man~;tirs~;ons~;tors~;fre~;lr~","dag"),bool:y("SAND;FALSK")},13,13),"da");et(Ft({group:".",decimal:",",ampm:y("a.m.;p.m."),mmmm:y("januari;februari;maart;april;mei;juni;juli;augustus;september;oktober;november;december"),mmm:y("jan.;feb.;mrt.;apr.;mei;jun.;jul.;aug.;sep.;okt.;nov.;dec."),dddd:y("zondag;maandag;dinsdag;woensdag;donderdag;vrijdag;zaterdag"),bool:y("WAAR;ONWAAR")},-1,2),"nl");et({group:",",preferMDY:!0},"en");et({group:",",preferMDY:!0},"en_US");et({group:","},"en_AU");et({group:","},"en_CA");et({group:","},"en_GB");et({group:",",mmm:y("Jan;Feb;Mar;Apr;May;Jun;Jul;Aug;Sept;Oct;Nov;Dec")},"en_IE");et(Ft({decimal:",",nan:"epluku",ampm:y("ap.;ip."),mmmm:y("tammi~;helmi~;maalis~;huhti~;touko~;kes~;hein~;elo~;syys~;loka~;marras~;joulu~","kuuta"),mmm:y("tammik.;helmik.;maalisk.;huhtik.;toukok.;kesk.;heink.;elok.;syysk.;lokak.;marrask.;jouluk."),dddd:y("sunnun~;maanan~;tiis~;keskiviikkona;tors~;perjan~;lauan~","taina"),bool:y("TOSI;EPTOSI")},-1,2),"fi");const hl=Ft({group:"",decimal:",",mmmm:y("janvier;fvrier;mars;avril;mai;juin;juillet;aot;septembre;octobre;novembre;dcembre"),mmm:y("janv.;fvr.;mars;avr.;mai;juin;juil.;aot;sept.;oct.;nov.;dc."),dddd:y("~manche;lun~;mar~;mercre~;jeu~;vendre~;same~","di"),bool:y("VRAI;FAUX")},-1,13);et({...hl},"fr");et({...hl,mmm:y("janv.;fvr.;mars;avr.;mai;juin;juill.;aot;sept.;oct.;nov.;dc.")},"fr_CA");et({group:"'",decimal:".",...hl},"fr_CH");const Yd=Ft({mmmm:y("Januar;Februar;Mrz;April;Mai;Juni;Juli;August;September;Oktober;November;Dezember"),mmm:y("Jan.;Feb.;Mrz;Apr.;Mai;Juni;Juli;Aug.;Sept.;Okt.;Nov.;Dez."),dddd:y("Sonn~;Mon~;Diens~;Mittwoch;Donners~;Frei~;Sams~","tag"),bool:y("WAHR;FALSCH")},-1,12);et({group:".",decimal:",",...Yd},"de");et({group:"'",decimal:".",...Yd},"de_CH");et(Ft({group:".",decimal:",",ampm:y("..;.."),mmmm:y("~;~;~;~;;~;~;;~;~;~;~",""),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;")},-1,3),"el");et({decimal:",",ampm:y("de.;du."),mmmm:y("janur;februr;mrcius;prilis;mjus;jnius;jlius;augusztus;szeptember;oktber;november;december"),mmm:y("jan.;febr.;mrc.;pr.;mj.;jn.;jl.;aug.;szept.;okt.;nov.;dec."),dddd:y("vasrnap;htf;kedd;szerda;cstrtk;pntek;szombat"),ddd:y("V;H;K;Sze;Cs;P;Szo"),bool:y("IGAZ;HAMIS")},"hu");et(Ft({group:".",decimal:",",ampm:y("f.h.;e.h."),mmmm:y("janar;febrar;mars;aprl;ma;jn;jl;gst;september;oktber;nvember;desember"),dddd:y("sunnu~;mnu~;riju~;miviku~;fimmtu~;fstu~;laugar~","dagur")},13,13),"is");et(Ft({group:".",decimal:",",mmmm:y("Januari;Februari;Maret;April;Mei;Juni;Juli;Agustus;September;Oktober;November;Desember"),dddd:y("Minggu;Senin;Selasa;Rabu;Kamis;Jumat;Sabtu")},3,3),"id");const zd=Ft({mmmm:y("gennaio;febbraio;marzo;aprile;maggio;giugno;luglio;agosto;settembre;ottobre;novembre;dicembre"),dddd:y("domenica;luned;marted;mercoled;gioved;venerd;sabato"),bool:y("VERO;FALSO")},3,3);et({group:".",decimal:",",...zd},"it");et({group:"'",decimal:".",...zd},"it_CH");const Kd={decimal:",",ampm:y("a.m.;p.m."),mmmm:y("januar;februar;mars;april;mai;juni;juli;august;september;oktober;november;desember"),mmm:y("jan.;feb.;mar.;apr.;mai;jun.;jul.;aug.;sep.;okt.;nov.;des."),dddd:y("sn~;man~;tirs~;ons~;tors~;fre~;lr~","dag"),bool:y("SANN;USANN")};et(Ft({...Kd},-1,13),"nb");et(Ft({...Kd},-1,13),"no");et(Ft({decimal:",",mmmm:y("stycznia;lutego;marca;kwietnia;maja;czerwca;lipca;sierpnia;wrzenia;padziernika;listopada;grudnia"),dddd:y("niedziela;poniedziaek;wtorek;roda;czwartek;pitek;sobota"),ddd:y("niedz.;pon.;wt.;r.;czw.;pt.;sob."),bool:y("PRAWDA;FASZ")},3,-1),"pl");const Xd={group:".",decimal:",",mmmm:y("janeiro;fevereiro;maro;abril;maio;junho;julho;agosto;setembro;outubro;novembro;dezembro"),dddd:y("domingo;segunda-feira;tera-feira;quarta-feira;quinta-feira;sexta-feira;sbado"),bool:y("VERDADEIRO;FALSO")};et(Ft(Xd,13,13),"pt");et(Ft(Xd,13,13),"pt_BR");et({decimal:",",nan:"",mmmm:y(";;;;;;;;;;;"),mmm:y(".;.;.;.;;.;.;.;.;.;.;."),dddd:y(";;;;;;"),ddd:y(";;;;;;"),mmmm6:y(";;-;-;;--;--;--;--;;;"),mmm6:y(".;.;-.;-.;.;. I;. II;. I;. II;.;.;."),bool:y(";")},"ru");et(Ft({decimal:",",mmmm:y("janura;februra;marca;aprla;mja;jna;jla;augusta;septembra;oktbra;novembra;decembra"),dddd:y("nedea;pondelok;utorok;streda;tvrtok;piatok;sobota")},3,2),"sk");const Ke={group:".",decimal:",",ampm:y("a.m.;p.m."),mmmm:y("enero;febrero;marzo;abril;mayo;junio;julio;agosto;septiem~;octu~;noviem~;diciem~","bre"),mmm:y("ene;feb;mar;abr;may;jun;jul;ago;sept;oct;nov;dic"),dddd:y("domingo;lunes;martes;mircoles;jueves;viernes;sbado"),ddd:y("dom;lun;mar;mi;jue;vie;sb"),bool:y("VERDADERO;FALSO")},bv=y("ene;feb;mar;abr;may;jun;jul;ago;sep;oct;nov;dic"),dl=y("ene.;feb.;mar.;abr.;may.;jun.;jul.;ago.;sept.;oct.;nov.;dic.");et({...Ke},"es");et({...Ke},"es_AR");et({...Ke},"es_BO");et({...Ke},"es_CL");et({...Ke},"es_CO");et({...Ke},"es_EC");et({...Ke,mmm:bv,ampm:y("a.m.;p.m.")},"es_MX");et({...Ke,mmm:dl},"es_PY");et({...Ke,mmm:dl},"es_UY");et({...Ke,mmm:dl,mmmm:y("enero;febrero;marzo;abril;mayo;junio;julio;agosto;setiembre;octubre;noviembre;diciembre")},"es_VE");et({decimal:",",ampm:y("fm;em"),mmmm:y("januari;februari;mars;april;maj;juni;juli;augusti;september;oktober;november;december"),mmm:y("jan.;feb.;mars;apr.;maj;juni;juli;aug.;sep.;okt.;nov.;dec."),dddd:y("sn~;mn~;tis~;ons~;tors~;fre~;lr~","dag"),ddd:y("sn;mn;tis;ons;tors;fre;lr")},"sv");et(Ft({group:".",decimal:",",ampm:y(";S"),mmmm:y("Ocak;ubat;Mart;Nisan;Mays;Haziran;Temmuz;Austos;Eyll;Ekim;Kasm;Aralk"),mmm:y("Oca;ub;Mar;Nis;May;Haz;Tem;Au;Eyl;Eki;Kas;Ara"),dddd:y("Pazar;Pazartesi;Sal;aramba;Perembe;Cuma;Cumartesi"),ddd:y("Paz;Pzt;Sal;ar;Per;Cum;Cmt"),bool:y("DORU;YANLI")},3,-1),"tr");et({group:",",ampm:y("yb;yh"),mmmm:y("Ionawr;Chwefror;Mawrth;Ebrill;Mai;Mehefin;Gorffennaf;Awst;Medi;Hydref;Tachwedd;Rhagfyr"),mmm:y("Ion;Chwef;Maw;Ebr;Mai;Meh;Gorff;Awst;Medi;Hyd;Tach;Rhag"),dddd:y("Dydd Sul;Dydd Llun;Dydd Mawrth;Dydd Mercher;Dydd Iau;Dydd Gwener;Dydd Sadwrn"),ddd:y("Sul;Llun;Maw;Mer;Iau;Gwen;Sad")},"cy");et({group:".",decimal:",",mmmm:y("yanvar;fevral;mart;aprel;may;iyun;iyul;avqust;sentyabr;oktyabr;noyabr;dekabr"),mmm:y("yan;fev;mar;apr;may;iyn;iyl;avq;sen;okt;noy;dek"),dddd:y("bazar;bazar ertsi;rnb axam;rnb;cm axam;cm;nb"),ddd:y("B.;B.e.;.a.;.;C.a.;C.;.")},"az");et(Ft({decimal:",",mmmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},3,-1),"be");et({decimal:",",ampm:y("..;.."),mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;"),bool:y(";")},"bg");et({group:".",decimal:",",mmmm:y("de gener;de febrer;de mar;dabril;de maig;de juny;de juliol;dagost;de setembre;doctubre;de novembre;de desembre"),mmm:y("de gen.;de febr.;de mar;dabr.;de maig;de juny;de jul.;dag.;de set.;doct.;de nov.;de des."),dddd:y("diumenge;dilluns;dimarts;dimecres;dijous;divendres;dissabte"),ddd:y("dg.;dl.;dt.;dc.;dj.;dv.;ds."),ampm:y("a.m.;p.m.")},"ca");et(Ft({group:",",decimal:".",mmmm:y("Enero;Pebrero;Marso;Abril;Mayo;Hunyo;Hulyo;Agosto;Setyembre;Oktubre;Nobyembre;Disyembre"),dddd:y("Linggo;Lunes;Martes;Miyerkules;Huwebes;Biyernes;Sabado")},3,3),"fil");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y("~;~;~;~;~;~;~",""),ddd:y(";;;;;;")},"gu");et({group:",",decimal:".",ampm:y(";"),dddd:y("~;~;~;~;~;~;~"," "),ddd:y("~;~;~;~;~;~;"," "),mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),mmmm6:y(";; ; ;; ; ; ; ;;;"),mmm6:y(";; ; ;; ; ; ; ;;;")},"he");et(Ft({group:".",decimal:",",mmmm:y("sijenja;veljae;oujka;travnja;svibnja;lipnja;srpnja;kolovoza;rujna;listopada;studenoga;prosinca"),mmm:y("sij;velj;ou;tra;svi;lip;srp;kol;ruj;lis;stu;pro"),dddd:y("nedjelja;ponedjeljak;utorak;srijeda;etvrtak;petak;subota")},-1,3),"hr");et({decimal:",",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"hy");et(Ft({decimal:",",mmmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;")},3,3),"ka");et(Ft({decimal:",",mmmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},13,-1),"kk");et({group:",",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y("~;~;~;~;~;~;~",""),ddd:y(";;;;;;"),ampm:y(";")},"kn");et({decimal:",",mmmm:y("sausio;vasario;kovo;balandio;gegus;birelio;liepos;rugpjio;rugsjo;spalio;lapkriio;gruodio"),mmm:y("saus.;vas.;kov.;bal.;geg.;bir.;liep.;rugp.;rugs.;spal.;lapkr.;gruod."),dddd:y("sekmadienis;pirmadienis;antradienis;treiadienis;ketvirtadienis;penktadienis;etadienis"),ddd:y("sk;pr;an;tr;kt;pn;t"),ampm:y("priepiet;popiet")},"lt");et({decimal:",",mmmm:y("janvris;februris;marts;aprlis;maijs;jnijs;jlijs;augusts;septembris;oktobris;novembris;decembris"),mmm:y("janv.;febr.;marts;apr.;maijs;jn.;jl.;aug.;sept.;okt.;nov.;dec."),dddd:y("svtdiena;pirmdiena;otrdiena;trediena;ceturtdiena;piektdiena;sestdiena"),ddd:y("svtd.;pirmd.;otrd.;tred.;ceturtd.;piektd.;sestd."),ampm:y("priekpusdien;pcpusdien")},"lv");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"ml");et({group:",",decimal:".",mmmm:y("~;~;~;~;~;~;~;~;~;~; ~; ~"," "),mmm:y("1~;2~;3~;4~;5~;6~;7~;8~;9~;10~;11~;12~","- "),dddd:y(";;;;;;"),ddd:y(";;;;;;"),ampm:y("..;..")},"mn");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"mr");et(Ft({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ampm:y(";")},-1,0),"my");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;"),ampm:y("..;..")},"pa");et({group:".",decimal:",",mmmm:y("ianuarie;februarie;martie;aprilie;mai;iunie;iulie;august;septem~;octom~;noiem~;decem~","brie"),mmm:y("ian.;feb.;mar.;apr.;mai;iun.;iul.;aug.;sept.;oct.;nov.;dec."),dddd:y("duminic;luni;mari;miercuri;joi;vineri;smbt"),ddd:y("dum.;lun.;mar.;mie.;joi;vin.;sm."),ampm:y("a.m.;p.m.")},"ro");et(Ft({group:".",decimal:",",mmmm:y("januar;februar;marec;april;maj;junij;julij;avgust;september;oktober;november;december"),mmm:y("jan.;feb.;mar.;apr.;maj;jun.;jul.;avg.;sep.;okt.;nov.;dec."),dddd:y("nedelja;ponedeljek;torek;sreda;etrtek;petek;sobota"),ampm:y("dop.;pop.")},-1,13),"sl");et(Ft({group:".",decimal:",",mmmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;")},3,3),"sr");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(".;.;.;.;;;;.;.;.;.;."),dddd:y(";;;;;;"),ddd:y(".;.;.;.;.;.;")},"ta");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"te");et({decimal:",",mmmm:y(";;;;;;;;;;;"),mmm:y(".;.;.;.;.;.;.;.;.;.;.;."),dddd:y(";;;;;;"),ddd:y(";;;;;;"),ampm:y(";")},"uk");et({group:".",decimal:",",mmmm:y("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thng "),mmm:y("~1;~2;~3;~4;~5;~6;~7;~8;~9;~10;~11;~12","thg "),dddd:y("Ch Nht;Th Hai;Th Ba;Th T;Th Nm;Th Su;Th By"),ddd:y("CN;Th 2;Th 3;Th 4;Th 5;Th 6;Th 7"),ampm:y("SA;CH")},"vi");et(Ft({group:"",decimal:"",ampm:y(";"),mmmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),mmmm6:y(";; ; ;; ; ; ; ;;;")},0,0),"ar");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;")},"bn");et({group:",",decimal:".",mmmm:y(";;;;;;;;;;;"),mmm:y(";;;;;;;;;;;"),dddd:y(";;;;;;"),ddd:y(";;;;;;"),ampm:y("am;pm")},"hi");const Jd={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,bigintErrorNumber:!1,dateSpanLarge:!0,leap1900:!0,nbsp:!1,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1,grouping:[3,3],indexColors:!0,skipChar:"",repeatChar:""};function Ae(t,e=0){if(typeof t!="number")return t;if(t<0)return-Ae(-t,e);if(e){const n=10**e||1;return Ae(t*n,0)/n}return Math.round(t)}const Tv=1e-13;function Qd(t,e=2,n=2){const r=t<0?-1:1,s=10**(e||2),o=10**(n||2);let i=Math.abs(t),a=0,l=0,u=0,c=1,h,d;if(t=i,t%1===0)d=[t*r,1];else if(t<1e-19)d=[r,1e19];else if(t>1e19)d=[1e19*r,1];else{do if(i=1/(i-Math.floor(i)),h=c,c=c*Math.floor(i)+a,a=h,l=u,u=Math.floor(t*c+.5),u>=s||c>=o)return[r*l,a];while(Math.abs(t-u/c)>=Tv&&i!==Math.floor(i));d=[r*u,c]}return d}const ye=Math.floor;function qd(t,e=!0){if(e&&t>=0){if(t===0)return[1900,1,0];if(t===60)return[1900,2,29];if(t<60)return[1900,t<32?1:2,(t-1)%31+1]}let n=t+68569+2415019;const r=ye(4*n/146097);n=n-ye((146097*r+3)/4);const s=ye(4e3*(n+1)/1461001);n=n-ye(1461*s/4)+31;const o=ye(80*n/2447),i=n-ye(2447*o/80);n=ye(o/11);const a=o+2-12*n;return[100*(r-49)+s+n|0,a|0,i|0]}function Iv(t){return qd(t+1462)}function wv(t){if(t===60)throw new Error("#VALUE!");if(t<=1)return[1317,8,29];if(t<60)return[1317,t<32?9:10,1+(t-2)%30];const e=10631/30,n=8.01/60;let r=t+466935;const s=ye(r/10631);r=r-10631*s;const o=ye((r-n)/e);r=r-ye(o*e+n);const i=ye((r+28.5001)/29.5);return i===13?[30*s+o,12,30]:[30*s+o,i,r-ye(29.5001*i-29)]}function Zd(t,e=0,n=!0){const r=ye(t);return e===ir?wv(r):e===vv?Iv(r):qd(r,n)}const Ts=Math.floor,Xo=86400;function fl(t,e){let n=null;if(Array.isArray(t)){const[r,s,o,i,a,l]=t;n=Date.UTC(r,s==null?0:s-1,o??1,i||0,a||0,l||0)}else if(t instanceof Date&&(n=t*1,!e||!e.ignoreTimezone)){const r=new Date;r.setUTCFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setUTCHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n=r*1}if(n!=null&&isFinite(n)){const r=n/864e5;return r-(r<=-25509?-25568:-25569)}return null}function Sv(t,e){let n=t|0;const r=Xo*(t-n);let s=Ts(r);r-s>.9999&&(s+=1,s===Xo&&(s=0,n+=1));const o=s<0?Xo+s:s,[i,a,l]=Zd(t,0,e&&e.leap1900),u=Ts(o/60/60)%60,c=Ts(o/60)%60,h=Ts(o)%60;return[i,a,l,u,c,h]}const Av=["!d-m-y","!d-m-Y","!j-m-y","!j-m-Y","!d-n-y","!d-n-Y","!j-n-y","!j-n-Y","?m-d-y","?m-d-Y","?m-j-y","?m-j-Y","?n-d-y","?n-d-Y","?n-j-y","?n-j-Y","d-M-y","d-M-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","d-F-y","d-F-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","j-F","j-M","d-F","d-M","n-d","n-j","n-Y","m-d","m-j","m-Y","M-Y","M-y","F-y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],Ov={j:"d",d:"d",D:"ddd",l:"dddd",n:"m",m:"m",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},Dv={j:"dd",d:"dd",D:"ddd",l:"dddd",n:"mm",m:"mm",M:"mmm",F:"mmmm",y:"yy",Y:"yyyy"},tf={},ef={};function _e(t,e,n=1){if(t){const r=t[0],s=t.slice(1);r==="!"?_e(s,e,4):r==="?"?_e(s,e,2):(e[r]=e[r]||{},_e(s,e[r],n))}else e.$=n}function wu(t,e){_e(t,e),_e(t+" x",e),_e(t+" l",e),_e(t+" l x",e),_e("l "+t,e),_e("l "+t+" x",e),_e(t+" D",e),_e(t+" D x",e),_e("D "+t,e),_e("D "+t+" x",e)}Av.forEach(t=>{t[0]!=="?"&&wu(t,tf),t[0]!=="!"&&wu(t,ef)});const Nv=new Date().getUTCFullYear(),Su=".",xv=",",Jo=" ",Wr="",Vr="",$s="'",Hs="",Mv={".":[xv,Wr,Vr,$s,Hs],",":[Su,Wr,Vr,$s,Hs],"":[Su,Wr,Vr,$s,Hs]},Qo=t=>t&&t.length===1&&t>="0"&&t<="9";function pl(t,e={}){const n=Er(e.locale||"")||mn,r=n.decimal,s=[...Mv[r]||[$s,Hs]];!s.includes(n.group)&&n.group!==Jo&&n.group!==r&&s.push(n.group);let o="",i="",a=1,l="",u=!1,c=!1,h=!1,d=!1,f=!1,p=null,m=!1,R=0;const S=[Jo,Wr,Vr,"+","%","(","-"].concat(Ai);for(;S.includes(t[R]);){const v=t[R];if(v==="-"){if(u||c)return null;u=!0,a=-1}else if(Oi.test(v)){if(f)return null;f=!0,p=v}else if(v==="("){if(c||u)return null;c=!0,a=-1}else if(v==="%"){if(d)return null;d=!0}R++}let P=!1,k;if(t[R]===r||Qo(t[R]))for(;R<t.length;){const v=t[R];if(!k&&s.includes(v))k=v;else if(!(k&&k===v))if(v===r){if(P)break;o+=".",P=!0}else if(Qo(v))o+=v;else break;R++}if(t[R]==="e"||t[R]==="E"){i+=t[R],R++,(t[R]==="+"||t[R]==="-")&&(i+=t[R],R++);const v=R;for(;Qo(t[R]);)i+=t[R],R++;if(v===R)return null}const H=[Jo,Wr,Vr,"%","$",")"].concat(Ai);for(;H.includes(t[R]);){const v=t[R];if(Oi.test(v)){if(f)return null;f=!0,p=v,m=!0}else if(v===")"){if(h||!c)return null;h=!0}else if(v==="%"){if(d)return null;d=!0}R++}if(R!==t.length)return null;let C=parseFloat(o+i);if(!isFinite(C))return null;if(i){if(d||f)return null;l="0.00E+00"}else if(d){if(f)return null;l=o.includes(".")?"0.00%":"0%",C*=.01}else if(f){const v=o.includes(".")?"#,##0.00":"#,##0";m?l=v+p:l=p+v}else k&&(l=o.includes(".")?"#,##0.00":"#,##0");const b={v:C*a};return l&&(b.z=l),b}function Lv(t,e,n){if(n<1||e<1||e>12)return!1;if(e===2){const r=t%4===0&&t%100!==0||t%400===0||t===1900?29:28;if(n>r)return!1}else if((e===4||e===6||e===9||e===11)&&n>30||(e===1||e===3||e===5||e===7||e===8||e===10||e===12)&&n>31)return!1;return!0}const Au=(t,e,n=!1)=>{for(const r of e)if(t.startsWith(r[0])){let s=r[0].length;return n&&(r[2]==="D"||r[2]==="M")&&t[s]==="."&&s++,[t.slice(0,s),r]}return["",null]},We=(t,e,n,r)=>{const s=n.path||"",o=Object.keys(e);for(let i=0;i<o.length;i++){let a;const l=o[i];if(e[l]){if(l==="$"||l==="")t||(a=n);else if(l==="-"){const u=/^(\s*([./-]|,\s)\s*|\s+)/.exec(t);if(u){const c=u[1]==="-"||u[1]==="/"||u[1]==="."?u[1]:" ";if(!n.sep||n.sep===c){const h=u[0].replace(/\s+/g," ");a=We(t.slice(u[0].length),e[l],{...n,sep:c,path:s+h},r)}}}else if(l===" "){const u=/^[,.]?\s+/.exec(t);if(u){const c=u[0].replace(/\s+/g," ");a=We(t.slice(u[0].length),e[l],{...n,path:s+c},r)}}else if(l==="j"||l==="d"){const u=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(t);u&&(a=We(t.slice(u[0].length),e[l],{...n,day:u[0],path:s+l},r))}else if(l==="n"||l==="m"){const u=/^(0?[1-9]|1[012])\b/.exec(t);u&&(a=We(t.slice(u[0].length),e[l],{...n,month:+u[0],_mon:u[0],path:s+l},r))}else if(l==="F"||l==="M"){const[u,c]=Au(t,r.mon,r.mp);c&&c[2]===l&&(a=We(t.slice(u.length),e[l],{...n,month:c[1],_mon:u,path:s+l},r))}else if(l==="l"||l==="D"){const[u,c]=Au(t,r.day,r.dp);c&&c[2]===l&&(a=We(t.slice(u.length),e[l],{...n,path:s+l},r))}else if(l==="y"){const u=/^\d\d\b/.exec(t);if(u){const c=+u[0]>=30?+u[0]+1900:+u[0]+2e3;a=We(t.slice(u[0].length),e[l],{...n,year:c,path:s+l},r)}}else if(l==="Y"){const u=/^\d\d\d\d\b/.exec(t);u&&(a=We(t.slice(u[0].length),e[l],{...n,year:+u[0],path:s+l},r))}else if(l==="x"){const u=No(t,{locale:r.locale});u&&(a=We("",e[l],{...n,time:u.v,tf:u.z,path:s+l},r))}else throw new Error(`Unknown date token "${l}"`);if(a&&Lv(n.year||1916,n.month||1,n.day?+n.day:1))return a}}},nf=t=>t.replace(/\s+/g," ").trim().replace(//,"'").replace(/\.$/,"").toLowerCase(),Is=(t,e)=>{const n=t.map((r,s)=>[nf(r),s+1,e]);return n.sort((r,s)=>s[0].length-r[0].length),n};function gl(t,e={}){var n;const r=Er(e.locale||"")||mn,s={mon:Is(r.mmmm,"F").concat(Is(r.mmm,"M")),mp:r.mmm[0].at(-1)===".",day:Is(r.dddd,"l").concat(Is(r.ddd,"D")),dp:r.ddd[0].at(-1)===".",locale:e.locale},o=We(nf(t),r.preferMDY?ef:tf,{path:""},s);if(o){if(o.sep==="."&&o.path.length===3)return null;const i=+((n=o.year)!=null?n:Nv);o.day||(o.day=1);let a=-1/0;if(i<1900)return null;i<=1900&&o.month<=2?a=25568:i<1e4&&(a=25569);const l=Date.UTC(i,o.month-1,o.day)/864e5+a+(o.time||0);if(l>=0&&l<=2958465){const u=o._mon[0]==="0"||o.day[0]==="0"||o._mon.length===2&&o.day.length===2,c=o.path.replace(/[jdlDnmMFyYx]/g,h=>h==="x"?o.tf||"":(u?Dv[h]:Ov[h])||h);return{v:l,z:c}}}return null}const qo=t=>t.replace(/\s+/g,"").trim().replace(/\./g,"").toLowerCase();function No(t,e={}){const n=Er(e.locale||"")||mn,r=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?=\s*[^\s\d]|$)/.exec(t);let s="";if(r){const o=qo(t.slice(r[0].length));if(o===qo(n.ampm[0])||o==="a"||o==="am")s="a";else if(o===qo(n.ampm[1])||o==="p"||o==="pm")s="p";else if(o)return null}if(r){const[,o,i,a,l]=r;if(l&&!a||!s&&!i&&!a)return null;let u=+(o||0)*1;if(s){if(u>=13)return null;s==="p"&&(u+=12)}const c=+(i||0)*1,h=+(a||0)*1,d=+(l||0)*1;return{v:(u*60*60+c*60+h+d)/(3600*24),z:(o.length===2?"hh":"h")+":mm"+(a?":ss":"")+(s?" AM/PM":"")}}return null}function rf(t,e={}){const n=Er(e.locale||"")||mn,r=t.trim().toLowerCase(),s=n.bool[0].toLowerCase();if(r==="true"||r===s)return{v:!0};const o=n.bool[1].toLowerCase();return r==="false"||r===o?{v:!1}:null}function Uv(t,e){var n,r,s;return(s=(r=(n=pl(t,e))!=null?n:gl(t,e))!=null?r:No(t,e))!=null?s:rf(t,e)}function bn(t,e,n){return e[n+"_max"]=t.length,e[n+"_min"]=t.replace(/#/g,"").length,e}function Gt(t,e){typeof t=="string"?e.push({type:"string",value:t}):e.push(t)}function Ou(t,e){const n=t&&t.type;return n===Pa||n===ar||n===Ba||n===Oo&&e==="den"}function Lr(t){var e,n,r;const s=[],o={scale:1,percent:!1,text:!1,date:0,date_eval:!1,date_system:Iu,sec_decimals:0,general:!1,clock:24,int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:s};let i="int",a=null;const l=[];let u,c=!1,h=-1,d=!1,f="",p=!1;for(;++h<t.length&&!d;){const C=t[h],b=C.type||Jr;if(f+=C.raw,b===ka)o.general=!0,Gt(C,s);else if(Ou(C,i)){const v=o[i+"_pattern"];Ou(u,i)||u?.type===Xr?(v.push((v.pop()||"")+C.value),a.num+=C.value):(v.push(C.value),a={type:i,num:C.value},Gt(a,s))}else if(b===al)C.value==="("&&(o.parens=!0),Gt(C.value,s);else if(b===Oo)Gt(C.value,s);else if(b===$a)if(p=!0,o[i+"_pattern"].length){if(!a)throw new SyntaxError("Format pattern is missing a numerator");o.fractions=!0,o.num_pattern.push(o[i+"_pattern"].pop()),a.type="num",i="den",Gt({type:"div"},s)}else Gt(C.value,s);else if(b===Ha)Gt(",",s);else if(b===Zs)o.scale=.001**C.raw.length;else if(b===Xr){if(i==="int"&&(o.grouping=!0),i==="den")throw new SyntaxError("Cannot group denominator digits")}else if(b===Ga)Gt(C,s);else if(b===ja){d=!0;break}else if(b===Ao)o.text=!0,Gt(C,s);else if(b===Wa||b===Va)Gt(C,s);else if(b===Xa){const v=C.value.toLowerCase(),N=v[0],V={type:"",size:0,date:1,pad:v.length};N==="h"?(V.size=Nr,V.type="hour-elap"):N==="m"?(V.size=xr,V.type="min-elap"):(V.size=Mr,V.type="sec-elap"),o.date=o.date|V.size,l.push(V),Gt(V,s)}else if(o.date&&b===to&&((e=t[h+1])==null?void 0:e.type)===ar){let v=1;h++;let N="0";((n=t[h+1])==null?void 0:n.type)===ar&&(N+="0",v=2,h++),((r=t[h+1])==null?void 0:r.type)===ar&&(N+="0",v=3,h++),f+=N;const V=[Mr,Ii,wi,Si][v];o.date=o.date|V,o.date_eval=!0,o.sec_decimals=Math.max(o.sec_decimals,v),Gt({type:"subsec",size:V,decimals:v,date:1},s)}else if(b===za)c||(C.value==="B2"||C.value==="b2"?o.date_system=ir:o.date_system=Iu);else if(b===Ka){const v={type:"",size:0,date:1},N=C.value.toLowerCase(),V=N[0];if(N==="y"||N==="yy")v.size=Or,v.type="year-short";else if(V==="y"||V==="e")v.size=Or,v.type="year";else if(N==="b"||N==="bb")v.size=Or,v.type="b-year-short";else if(V==="b")v.size=Or,v.type="b-year";else if(N==="d"||N==="dd")v.size=Bs,v.type="day",v.pad=/dd/.test(N);else if(N==="ddd"||N==="aaa")v.size=Bs,v.type="weekday-short";else if(V==="d"||V==="a")v.size=Bs,v.type="weekday";else if(V==="h")v.size=Nr,v.type="hour",v.pad=/hh/i.test(N);else if(V==="m"){N.length===3?(v.size=Dr,v.type="monthname-short"):N.length===5?(v.size=Dr,v.type="monthname-single"):N.length>=4&&(v.size=Dr,v.type="monthname");const Y=l[l.length-1];!v.type&&Y&&!Y.used&&Y.size&(Nr|Mr)&&(Y.used=!0,v.size=xr,v.type="min",v.pad=/mm/.test(N)),v.type||(v.size=Dr,v.type="month",v.pad=/mm/.test(N),v.indeterminate=!0)}else if(V==="s"){v.size=Mr,v.type="sec",v.pad=/ss/.test(N);const Y=l[l.length-1];Y&&Y.size&xr?v.used=!0:Y&&Y.indeterminate&&(delete Y.indeterminate,Y.size=xr,Y.type="min",v.used=!0)}o.date=o.date|v.size,o.date_eval=!0,l.push(v),Gt(v,s)}else if(b===el)o.clock=12,o.date=o.date|Nr,o.date_eval=!0,C.short=C.value==="A/P",Gt(C,s);else if(b===rl||b===nl||b===Do)Gt(C.value,s);else if(b===Ja)o.condition=[C.value[0],parseFloat(C.value[1])];else if(b===Za){const v=C.value.split("-"),N=v.length<2?"":v.slice(1).join("-"),V=v[0];V&&Gt(V,s);const Y=ul(N);Y&&(o.locale=Y);const g=parseInt(N,16);isFinite(g)&&g&16711680&&(g>>16&255)===6&&(o.date_system=ir),c=!0}else if(b===tl){let v,N=C.value.toLowerCase();(v=/^color\s*(\d+)$/i.exec(N))&&(N=parseInt(v[1],10)),o.color=N}else if(b===Ya)o.scale=100,o.percent=!0,Gt("%",s);else if(b===to)Gt(C,s),o.date||(o.dec_fractions=!0,i="frac");else if(b===ol)o.exponential=!0,o.exp_plus=C.value.includes("+"),i="man",Gt({type:"exp",plus:o.exp_plus},s);else if(b===sl)Gt(C,s);else if(b===il)Gt(C,s);else if(!(b===Qa||b===qa))throw b===Jr?new SyntaxError(`Illegal character: ${f}`):new SyntaxError(`Unknown token ${b} in ${f}`);u=C}if(o.tokensUsed=h,o.pattern=f,/^((?:\[[^\]]+\])+)(;|$)/.test(o.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(o.pattern)&&Gt({type:"text"},s),o.fractions&&o.dec_fractions||o.grouping&&!o.int_pattern.length||o.fractions&&o.exponential||o.fractions&&o.den_pattern.length*o.num_pattern.length===0||p&&!o.fractions&&!o.date||o.exponential&&(o.int_pattern.length||o.frac_pattern.length)*o.man_pattern.length===0)throw new SyntaxError(`Invalid pattern: ${f}`);const m=o.int_pattern.join(""),R=o.man_pattern.join(""),S=o.frac_pattern.join("");bn(m,o,"int");let P=0;for(let C=0;C<m.length;C++){const b=m[m.length-1-C];/^[0-9?]/.test(b)&&(P=C+1)}o.int_min=P,bn(S,o,"frac"),bn(R,o,"man");let k=o.num_pattern.join(""),H=o.den_pattern[0]||"";if(H.includes("?")||k.includes("?")?(H=H.replace(/\d/g,"?"),H=H.replace(/#$/g,"?"),bn(k,o,"num"),bn(H,o,"den"),k=k.replace(/#$/g,"?")):(bn(k,o,"num"),bn(H,o,"den")),o.int_p=m,o.man_p=R,o.num_p=k,o.den_p=H,o.den_pattern.length&&(o.denominator=parseInt(o.den_pattern.join("").replace(/\D/g,""),10)),o.integer=!!m.length,!o.integer&&!o.exponential&&S.length){const C=o.tokens.findIndex(b=>b.type==="point");o.tokens.splice(C,0,{type:"int",value:"#"}),o.integer=!0,o.int_pattern=["#"],o.int_p="#"}if(o.fractions)for(let C=0;C<s.length-1;C++){const b=s[C];if(b.type!=="string"&&b.type!=="space")continue;const v=s[C+1].type;v==="num"?b.rule="num+int":v==="div"?b.rule="num":v==="den"&&(b.rule="den")}return o.grouping&&o.int_pattern.length>1&&(o.grouping=!1),o}function Fv(t){if(t===0)return t;const e=Math.ceil(Math.log10(t<0?-t:t)),n=10**(16-Math.floor(e));return isFinite(n)?Math.round(t*n)/n:0}function sf(t,e=0){const n=Math.floor(Math.log10(t));return e>1?Math.floor(n/e)*e:n}function of(t,e=1){return e<-300?parseFloat(t.toExponential().split("e")[0]):t*10**-e}const kv={total:1,sign:0,period:0,int:1,frac:0};function Pv(t,e=!0){const n=Math.abs(t);if(!n)return kv;const r=e&&t<0?1:0,s=Math.floor(n),o=Math.floor(Math.log10(n)+1);let i=0,a=0;if(s!==n){i=1;const l=String(Ae(n*10**-o,15));let u=l.length,c=!0,h=0;for(;h<=l.length;){if(l[h]==="."){u--;break}else l[h]==="0"&&c?u--:c=!1;h++}a=u-o,a<0&&(a=0,i=0)}return{total:r+Math.max(o,1)+i+a,digits:Math.max(o,0)+a,sign:r,period:i,int:Math.max(o,1),frac:a}}const zn=(t,e)=>t.replace(/\./,e.decimal),Du=(t,e,n)=>{const r=Math.abs(e);let s;return t===1?s=t:s=Ae(t,5),[zn(s+"",n),n.exponent,e<0?n.negative:n.positive,r<10?"0":"",r]};function Nu(t,e,n,r){const s=n|0;if(typeof n=="string")t.push(n);else if(n===s)t.push(Math.abs(s));else{const o=Math.abs(n);let i=sf(o),a=of(o,i);a===10&&(a=1,i++);const l=Pv(o);if(i>=-4&&i<=-1){const u=o.toPrecision(10+i).replace(/\.?0+$/,"");t.push(zn(u,r))}else if(i===10){const u=o.toFixed(10).slice(0,12).replace(/\.$/,"");t.push(zn(u,r))}else if(Math.abs(i)<=9)if(l.total<=11){const u=Ae(o,9).toFixed(l.frac);t.push(zn(u,r))}else i===9?t.push(Math.floor(o)):i>=0&&i<9?t.push(zn(String(Ae(o,9-i)),r)):t.push(...Du(a,i,r));else l.total>=12?t.push(...Du(a,i,r)):t.push(zn(Ae(o,9).toFixed(l.frac),r))}return t}function Tn(t,e=!1){return t==="0"?"0":t==="?"?e?"":" ":""}const Rr=86400,Bv=(t,e,n)=>n?t<yv||e>=Ev:t<mv||e>=_v;function xu(t,e,n,r){var s,o;let i="",a="",l="",u="",c="",h="",d=0,f=0;if(typeof t=="bigint"){if(t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER)t=Number(t);else return n.bigintErrorNumber?String(t):n.overflow;f=t}else f=Math.trunc(t);let p=0,m=0,R=1,S=0,P=0,k=0,H=0,C=0,b=0;const v=r||mn;if(!e.text&&isFinite(e.scale)&&e.scale!==1&&(t=Fv(t*e.scale)),e.exponential){let A=Math.abs(t);A&&(d=sf(A,e.int_max)),t&&!e.integer&&d++,A=of(A,d),e.int_max===1&&Ae(A,e.frac_max)===10&&(A=1,d++),t=t<0?-A:A,i+=Math.abs(d)}if(e.integer){const A=Math.abs(Ae(t,e.fractions?1:e.frac_max));h+=A<1?"":Math.floor(A)}const N=(s=n.grouping[0])!=null?s:3,V=(o=n.grouping[1])!=null?o:N;e.dec_fractions&&(c=String(Ae(t,e.frac_max)).split(".")[1]||"");const Y=!e.error&&(e.num_p.includes("0")||e.den_p.includes("0"));let g=Y;if(e.fractions){g=Y||!!(t%1);const A=Math.abs(e.integer?t%1:t);if(A)if(g=!0,e.denominator&&isFinite(e.denominator))u+=e.denominator,l+=Ae(A*e.denominator),l==="0"&&(l="",u="",g=Y);else{const O=Qd(A,1/0,e.den_max);l+=O[0],u+=O[1],e.integer&&l==="0"&&(l="",u="",g=Y)}else!t&&!e.integer&&(g=!0,l="0",u="1");e.integer&&!g&&!Math.trunc(t)&&(h="0")}if(e.date){f=Math.trunc(t);const A=Rr*(t-f);if(p=Math.floor(A),b=A-p,Math.abs(b)<1e-6?b=0:b>.9999&&(b=0,p+=1,p===Rr&&(p=0,f+=1)),b){const O=e.date&Si||e.date&wi||e.date&Ii;(O===Si&&b>.9995||O===wi&&b>.995||O===Ii&&b>.95||!O&&b>=.5)&&(p++,b=0)}if(f||e.date_system){const O=Zd(t,e.date_system,n.leap1900);m=O[0],R=O[1],S=O[2]}if(p){const O=p<0?Rr+p:p;C=Math.floor(O)%60,H=Math.floor(O/60)%60,k=Math.floor(O/60/60)%60}if(P=(6+f)%7,e.date_eval&&Bv(t,f+p/Rr,n.dateSpanLarge)){if(n.dateErrorThrows)throw new Error("Date out of bounds");if(n.dateErrorNumber){const O=t<0?[v.negative]:[];return Nu(O,{},t,v).join("")}return n.overflow}}const L=Tn("?",n.nbsp);d<0?a="-":e.exp_plus&&(a="+");const E=[],D=(A,O,x,F)=>{const Q=!F&&A.length>O.length?x.length+A.length-O.length:x.length;A.length<O.length&&(F+=A.length-O.length);for(let G=0;G<Q;G++)E.push(A[G+F]||Tn(x[G],n.nbsp));return Q};let w=!1;const I={int:0,frac:0,man:0,num:0,den:0};for(let A=0,O=e.tokens.length;A<O;A++){const x=e.tokens[A],F=x.type,Q=x.num?x.num.length:0;if(F==="string")x.rule?x.rule==="num"?g?E.push(x.value.replace(/ /g,L)):(e.num_min>0||e.den_min>0)&&E.push(x.value.replace(/./g,L)):x.rule==="num+int"?g&&h?E.push(x.value.replace(/ /g,L)):e.den_min>0&&(h||e.num_min)&&E.push(x.value.replace(/./g,L)):x.rule==="den"&&(g?E.push(x.value.replace(/ /g,L)):(e.den_min>0||e.den_min>0)&&E.push(x.value.replace(/./g,L))):E.push(x.value.replace(/ /g,L));else if(F==="space")x.rule==="num+int"?(g||e.num_min||e.den_min)&&(h||e.num_min)&&E.push(L):E.push(L);else if(F==="error")E.push(n.invalid);else if(F==="point")E.push(e.date?x.value:v.decimal);else if(F==="general")Nu(E,e,t,v);else if(F==="exp")E.push(v.exponent);else if(F==="minus")x.volatile&&e.date||x.volatile&&(t>=0||typeof t!="number")||(x.volatile&&!e.fractions&&(e.integer||e.dec_fractions)?(t<0&&h&&h!=="0"||c)&&E.push(v.negative):E.push(v.negative));else if(F==="plus")E.push(v.positive);else if(F==="text")E.push(t);else if(F==="fill")n.fillChar&&E.push(n.fillChar,x.value);else if(F==="skip")n.skipChar?E.push(n.skipChar,x.value):E.push(n.nbsp?"":" ");else if(F==="div")g?E.push("/"):e.num_min>0||e.den_min>0?E.push(L):E.push(Tn("#",n.nbsp));else if(F==="int")if(e.int_pattern.length===1){const G=e.int_p,it=Math.max(e.int_min,h.length);let lt="";for(let T=it;T>0;T--){const M=h.charAt(h.length-T),j=M?"":G.charAt(G.length-T)||G[0];let W="";if(e.grouping){const B=T-1-N;B>=0&&!(B%V)&&(W=M||j==="0"?v.group:Tn("?",n.nbsp))}lt+=(M||Tn(j,n.nbsp))+W}E.push(lt)}else I.int+=D(h,e.int_p,x.num,I.int);else if(F==="frac"){const G=I.frac;for(let it=0;it<Q;it++)E.push(c[it+G]||Tn(x.num[it],n.nbsp));I.frac+=Q}else if(F==="man")!I[F]&&!I.man&&E.push(a),I.man+=D(i,e.man_p,x.num,I.man);else if(F==="num")I.num+=D(l,e.num_p,x.num,I.num);else if(F==="den"){const G=I.den;for(let it=0;it<Q;it++){let lt=u[it+G];if(!lt){const T=x.num[it];"123456789".includes(T)||w&&T==="0"?(w=!0,lt=n.nbsp?"":" "):!w&&it===Q-1&&T==="0"&&!u?lt="1":lt=Tn(T,n.nbsp)}E.push(lt)}I.den+=Q}else if(F==="year")m<0&&E.push(v.negative),E.push(String(Math.abs(m)).padStart(4,"0"));else if(F==="year-short"){const G=m%100;E.push(G<10?"0":"",G)}else if(F==="month")E.push(x.pad&&R<10?"0":"",R);else if(F==="monthname-single")e.date_system===ir?E.push(v.mmmm6[R-1].charAt(0)):E.push(v.mmmm[R-1].charAt(0));else if(F==="monthname-short")e.date_system===ir?E.push(v.mmm6[R-1]):E.push(v.mmm[R-1]);else if(F==="monthname")e.date_system===ir?E.push(v.mmmm6[R-1]):E.push(v.mmmm[R-1]);else if(x.type==="weekday-short")E.push(v.ddd[P]);else if(F==="weekday")E.push(v.dddd[P]);else if(F==="day")E.push(x.pad&&S<10?"0":"",S);else if(F==="hour"){const G=k%e.clock||(e.clock<24?e.clock:0);E.push(x.pad&&G<10?"0":"",G)}else if(F==="min")E.push(x.pad&&H<10?"0":"",H);else if(F==="sec")E.push(x.pad&&C<10?"0":"",C);else if(F==="subsec"){E.push(v.decimal);const G=b.toFixed(e.sec_decimals);E.push(G.slice(2,2+x.decimals))}else if(F==="ampm"){const G=k<12?0:1;x.short&&!r?E.push("AP"[G]):E.push(v.ampm[G])}else if(F==="hour-elap"){t<0&&E.push(v.negative);const G=f*24+Math.floor(Math.abs(p)/3600);E.push(String(Math.abs(G)).padStart(x.pad,"0"))}else if(F==="min-elap"){t<0&&E.push(v.negative);const G=f*1440+Math.floor(Math.abs(p)/60);E.push(String(Math.abs(G)).padStart(x.pad,"0"))}else if(F==="sec-elap"){t<0&&E.push(v.negative);const G=f*Rr+Math.abs(p);E.push(String(Math.abs(G)).padStart(x.pad,"0"))}else if(F==="b-year")E.push(m+543);else if(F==="b-year-short"){const G=(m+543)%100;E.push(G<10?"0":"",G)}}return E.join("")}const $v=Lr([{type:Ao,value:"@",raw:"@"}]);function af(t,e){for(let n=0;n<3;n++){const r=e[n];if(r){let s;if(r.condition){const o=r.condition[0],i=r.condition[1];o==="="?s=t===i:o===">"?s=t>i:o==="<"?s=t<i:o===">="?s=t>=i:o==="<="?s=t<=i:o==="<>"&&(s=t!==i)}else s=!0;if(s)return r}}}function Hv(t,e,n){const r=e.partitions;let s=r[3],o=null;return(typeof t=="number"||typeof t=="bigint")&&isFinite(t)&&(s=af(t,r)),s&&s.color&&(o=s.color),o&&typeof o=="number"&&n.indexColors&&(o=Cv[o-1]||"#000"),o}function jv(t,e,n){const r=e.partitions,s=Er(e.locale||n.locale),o=r[3]?r[3]:$v;if(typeof t=="boolean"&&(t=(s||mn).bool[t?0:1]),t==null)return"";const i=typeof t=="bigint";if(typeof t!="number"&&!i)return xu(t,o,n,s);if(!i&&!isFinite(t)){const l=s||mn;return isNaN(t)?l.nan:(t<0?l.negative:"")+l.infinity}const a=af(t,r);return a?xu(t,a,n,s):n.overflow}function lf(t){return!!(t[0]&&t[0].percent||t[1]&&t[1].percent||t[2]&&t[2].percent||t[3]&&t[3].percent)}function uf(t){return!!(t[0]&&t[0].date||t[1]&&t[1].date||t[2]&&t[2].date||t[3]&&t[3].date)}function cf(t){const[e,n,r,s]=t;return!!((!e||e.generated)&&(!n||n.generated)&&(!r||r.generated)&&s&&s.text&&!s.generated)}const Wv={text:15,datetime:10.8,date:10.8,time:10.8,percent:10.6,currency:10.4,grouped:10.2,scientific:6,number:4,fraction:2,general:0,error:0},Vv=[["DMY",1],["DM",2],["MY",3],["MDY",4],["MD",5],["hmsa",6],["hma",7],["hms",8],["hm",9]];function Gv(t,e=null){var n;const[r,s]=t,o=r.frac_max,i={type:"general",isDate:uf(t),isText:cf(t),isPercent:lf(t),maxDecimals:r.general?9:o,scale:(n=r.scale)!=null?n:1,color:0,parentheses:0,grouped:r.grouping?1:0},a=!i.isDate&&!i.isText&&!r.error&&r.tokens.some(d=>d.type==="string"&&(e?d.value===e:Oi.test(d.value)));let l="G",u=o>=0?Math.min(15,o):"",c="",h="";if(s&&s.color&&(h="-",i.color=1),r.parens&&(c="()",i.parentheses=1),a)l="C",i.type="currency";else if(r.error)i.type="error",i.maxDecimals=0;else if(i.isDate){let d=0,f=0,p="";r.tokens.forEach(R=>{const S=R.type;/^(b-)?year/.test(S)?(p+="Y",f++):S.startsWith("month")?(p+="M",f++):/^(week)?day/.test(S)?(p+="D",f++):(S==="hour"||S==="min"||S==="sec"||S==="ampm")&&(p+=S[0],d++)}),i.type="date",f&&d?i.type="datetime":!f&&d&&(i.type="time");const m=Vv.find(R=>p.startsWith(R[0]));l=m?"D":"G",u=m?m[1]:""}else i.isText?(l="G",i.type="text",u="",i.maxDecimals=0):r.general?(l="G",i.type="general",u=""):r.fractions?(l="G",i.type="fraction",u=""):r.exponential?(l="S",i.type="scientific"):i.isPercent?(l="P",i.type="percent"):r.grouping?(l=",",i.type="grouped"):(r.int_max||o)&&(l="F",i.type="number");return i.code=l+u+h+c,i.level=Wv[i.type],Object.freeze(i)}function Yv(t){const[e]=t;return{year:!!(e.date&Or),month:!!(e.date&Dr),day:!!(e.date&Bs),hours:!!(e.date&Nr),minutes:!!(e.date&xr),seconds:!!(e.date&Mr),clockType:e.clock===12?12:24}}const zv=[[ka,/^General/i,0],[Pa,/^#/,0],[ar,/^0/,0],[Ba,/^\?/,0],[$a,/^\//,0],[ja,/^;/,0],[Ao,/^@/,0],[Wa,/^\+/,0],[Va,/^-/,0],[to,/^\./,0],[Ga,/^ /,0],[Ya,/^%/,0],[Oo,/^[1-9]/,0],[za,/^(?:B[12])/i,0],[Jr,/^B$/,0],[Ka,/^(?:[hH]+|[mM]+|[sS]+|[yY]+|[bB]+|[dD]+|[gG]+|[aA]{3,}|e+)/,0],[Xa,/^(?:\[(h+|m+|s+)\])/i,1],[Ja,/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/,[1,2]],[Qa,/^\[(DBNum[0-4]?\d)\]/i,1],[qa,/^\[(NatNum[0-4]?\d)\]/i,1],[Za,/^\[\$([^\]]+)\]/,1],[tl,/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*\d+)\]/i,1],[Vd,/^\[([^\]]+)\]/,1],[el,/^(?:AM\/PM|am\/pm|A\/P)/,0],[nl,/^\\(.)/,1],[rl,/^"([^"]*?)"/,1],[sl,/^_(\\.|.)/,1],[ol,/^[Ee]([+-])/,1],[il,/^\*(\\.|.)/,1],[al,/^[()]/,0],[Jr,/^[ENn["*/\\_]/,0],[Do,/^./,0]],Kv=63,Xv=35,Jv=48,Qv=57,Zo=t=>{const e=(t||"\0").charCodeAt(0);return e===Kv||e===Xv||e>=Jv&&e<=Qv};function rr(t){let e=0;const n=[],r=[];for(;e<t.length;){const s=t.slice(e);let o=0;const i=/^(,+)(.)?/.exec(s);if(i){const a=i[1];o=a.length;const l=t[e-1]||"";let u=!1,c=!1;Zo(l)?(u=!0,c=!0):l==="."&&(c=!0);const h=i[2]||"";if(u&&(!h||h===";")&&(u=!1),c&&Zo(h)&&(c=!1),u&&!c)n.push({type:Xr,value:",",raw:a});else if(!u&&c)n.push({type:Zs,value:",",raw:a});else if(u&&c){const d={type:Zs,value:",",raw:a};n.push(d),r.push(d)}else n.push({type:Ha,value:",",raw:a})}else{let a;for(const[l,u,c]of zv){const h=u.exec(s);if(h){const d=Array.isArray(c)?c.map(f=>h[f]):h[c||0];a={type:l,value:d,raw:h[0]},n.push(a),o=h[0].length;break}}r.length&&a.raw===";"&&(r.length=0),r.length&&Zo(a.raw)&&(r.forEach(l=>l.type=Xr),r.length=0)}if(!o){const a=s[0];o=1,n.push({type:Do,value:a,raw:a})}e+=o}return n}const ti=t=>{const e=t.condition;e&&e[1]<0&&(e[0]==="<"||e[0]==="<="||e[0]==="=")||t.tokens.unshift({type:"minus",volatile:!0})},Mu=(t,e=null)=>{const n={};for(const r in t)Array.isArray(t[r])?n[r]=[...t[r]]:n[r]=t[r];return e&&n.tokens.unshift(e),n.generated=!0,n};function qv(t){var e;const n=[];let r=!1,s,o=null,i=0,a=!1,l=0,u=0,c=rr(t);do{if(a=Lr(c),(a.date||a.general)&&(a.int_pattern.length||a.frac_pattern.length||a.scale!==1||a.text))throw new Error("Illegal format");if(a.condition&&(u++,r=!0),a.text){if(o)throw new Error("Unexpected partition");o=a}a.locale&&(s=ul(a.locale)),n.push(a),i=((e=c[a.tokensUsed])==null?void 0:e.type)==="break"?1:0,c=c.slice(a.tokensUsed+i),l++}while(i&&l<4&&u<3);if(i)throw new Error("Unexpected partition");if(u>2)throw new Error("Unexpected condition");const h=n[3];if(h&&(h.int_pattern.length||h.frac_pattern.length||h.date))throw new Error("Unexpected partition");if(r){const d=n.length;if(d===1&&(n[1]=Lr(rr("General")),n[1].generated=!0),d<3){const f=n[0],p=n[1];if(ti(f),p.condition)ti(p);else{const m=f.condition;(m[0]==="="||m[1]>=0&&(m[0]===">"||m[0]===">="))&&p.tokens.unshift({type:"minus",volatile:!0})}}else n.forEach(ti)}else{if(n.length<4&&o)for(let d=0,f=n.length;d<f;d++)n[d]===o&&n.splice(d,1);if(n.length<1&&o&&(n[0]=Lr(rr("General")),n[0].generated=!0),n.length<2){const d={type:"minus",volatile:!0};n.push(Mu(n[0],d))}if(n.length<3&&n.push(Mu(n[0])),n.length<4)if(o)n.push(o);else{const d=Lr(rr("@"));d.generated=!0,n.push(d)}n[0].condition=[">",0],n[1].condition=["<",0],n[2].condition=null}return{pattern:t,partitions:n,locale:s}}const Lu=Object.create({});function En(t,e=!1){t||(t="General");let n=Lu[t];if(!n)try{n=qv(t),Lu[t]=n}catch(r){if(e)throw r;const s={tokens:[{type:"error"}],error:r.message};n={pattern:t,partitions:[s,s,s,s],error:r.message,locale:null}}return n}function Zv(t,e,n={}){var r;const s=Object.assign({},Jd,n),o=En(t,s.throws),i=(r=fl(e,s))!=null?r:e;return jv(i,o,s)}function t1(t,e,n){var r;const s=Object.assign({},Jd,n),o=En(t,s.throws),i=(r=fl(e,s))!=null?r:e;return Hv(i,o,s)}function e1(t){const e=En(t,!1);return uf(e.partitions)}function n1(t){const e=En(t,!1);return lf(e.partitions)}function r1(t){const e=En(t,!1);return cf(e.partitions)}function s1(t){try{return En(t,!0),!0}catch{return!1}}function o1(t,e={}){const n=En(t,!1);return n.info||(n.info=Gv(n.partitions,e?.currency)),n.info}function i1(t){const e=En(t,!1);return e.dateInfo||(e.dateInfo=Yv(e.partitions)),e.dateInfo}const Kn=Object.freeze({AMPM:el,BREAK:ja,CALENDAR:za,CHAR:Do,COLOR:tl,COMMA:Ha,CONDITION:Ja,DATETIME:Ka,DBNUM:Qa,DIGIT:Oo,DURATION:Xa,ERROR:Jr,ESCAPED:nl,EXP:ol,FILL:il,GENERAL:ka,GROUP:Xr,HASH:Pa,LOCALE:Za,MINUS:Va,MODIFIER:Vd,NATNUM:qa,PAREN:al,PERCENT:Ya,PLUS:Wa,POINT:to,QMARK:Ba,SCALE:Zs,SKIP:sl,SLASH:$a,SPACE:Ga,STRING:rl,TEXT:Ao,ZERO:ar}),a1=Object.freeze(Object.defineProperty({__proto__:null,addLocale:et,dateFromSerial:Sv,dateToSerial:fl,dec2frac:Qd,format:Zv,formatColor:t1,getFormatDateInfo:i1,getFormatInfo:o1,getLocale:Er,isDateFormat:e1,isPercentFormat:n1,isTextFormat:r1,isValidFormat:s1,parseBool:rf,parseDate:gl,parseLocale:ll,parseNumber:pl,parseTime:No,parseValue:Uv,round:Ae,tokenTypes:Kn,tokenize:rr},Symbol.toStringTag,{value:"Module"})),hf="@@@",df="@",ml="General";function l1(t){return t===hf||t===df}function u1(t){return t==null||t===ml}const c1=(t,e)=>{if(t&&!e||!t&&e)return!1;const n=o=>{const i=rr(o);let a="",l=!1,u=!1;for(const c of i){if(c.type===Kn.POINT){l=!0;continue}if(!(u&&c.type===Kn.MINUS)&&c.type!==Kn.SKIP){if(c.type===Kn.COLOR){u=!0;continue}else u=!1;l&&c.type===Kn.ZERO||(l=!1,l||(a+=c.value||""))}}return a},r=n(t),s=n(e);return r===s},h1=new Set(["m d"]),d1=new Set(["h:mm AM/PM","hh:mm AM/PM"]),f1=new Set(["$","","","","NT$","","",""]),ff=t=>{var e,n;const r=(n=(e=gl(t))!=null?e:No(t))!=null?n:pl(t);if(!r)return null;const{z:s}=r;if(s){if(h1.has(s)||d1.has(s)&&!/\s(A|AM|P|PM)$/i.test(t))return null;if(s.includes("#,##0")){if(/[.,]$/.test(t))return null;const o=t.replace(new RegExp(`^[${[...f1].join("")}]+`),"").trim();if(o.includes(",")&&!/^-?\d{1,3}(,\d{3})*(\.\d+)?$/.test(o))return null}}return r};function p1(t,e){const n={};for(const r in t){const s=Number(r),o=t[s];for(const i in o){const a=Number(i),l=o[a],u=e(s,a,l);u!==void 0&&(n[s]?n[s][a]=u:n[s]={[a]:u})}}return n}function dn(t){let e=0;const n=Object.keys(t);for(const r of n){const s=Number(r);e=Math.max(e,s)}return e+1}const Uu=t=>t==null||typeof t=="object"&&Object.keys(t).length===0;function g1(t,e,n){const r=dn(n),s=n;for(let o=r-1;o>=t;o--)Uu(s[o])?delete s[o+1]:s[o+1]=s[o];Uu(e)||(s[t]=e)}function Ni(t,e,n){const r=Object.keys(n).reduce((s,o)=>Math.max(s,Number.parseInt(o)),0)+1;for(let s=t;s<r;s++)s<t+e?delete n[s]:n[s]!==void 0&&(n[s-e]=n[s],delete n[s])}function m1(t,e){const n=t,r=Object.keys(n),s=r.length,o=e,i=Object.keys(o),a=i.length,l={};let u=0;for(let c=0;c<s;c++,u++){const h=r[c];l[u]=n[h]}for(let c=0;c<a;c++,u++){const h=i[c];l[u]=o[h]}return l}function _1(t,e,n){const r=n;if(dn(n)>0){const s={};let o=0;for(let i=t;i<=e;i++)r[i]&&(s[o]=r[i],o++);return s}return{}}function xi(t,e,n,r){const s=t>n;if(!s&&t+e>n)throw new Error("Invalid move operation");s?y1(t,e,n,r):E1(t,e,n,r)}function y1(t,e,n,r){const s=r,o=[];for(let i=t;i<t+e;i++)o.push(s[i]);for(let i=t-1;i>=n;i--){const a=s[i];s[i+e]=a,a===void 0&&delete s[i+e]}o.forEach((i,a)=>{s[n+a]=i,i===void 0&&delete s[n+a]})}function E1(t,e,n,r){const s=r,o=[];for(let i=t;i<t+e;i++)o.push(s[i]);for(let i=t+e;i<n;i++){const a=s[i];s[i-e]=a,a===void 0&&delete s[i-e]}o.forEach((i,a)=>{s[n+a-e]=i,i===void 0&&delete s[n+a-e]})}class fe{constructor(e={}){_(this,"_matrix"),this._setOriginValue(e)}static MakeObjectMatrixSize(e){return new fe({[e-1]:{}})}getMatrix(){return this._matrix}forEach(e){const n=this._matrix,r=Object.keys(n);for(const s of r){const o=Number(s),i=n[o];if(e(o,i)===!1)return this}return this}forRow(e){const n=this._matrix,r=Object.keys(n);for(const s of r){const o=Number(s),i=n[o];if(e(o,Object.keys(i).map(a=>Number(a)))===!1)return this}return this}forValue(e){const n=this._matrix;for(const r in n){const s=Number(r),o=n[s];if(o)for(const i in o){const a=Number(i),l=o[a];if(e(s,a,l)===!1)return this}}return this}swapRow(e,n){const r=this._matrix[e],s=this._matrix[n];this._matrix[e]=s,this._matrix[n]=r}getRow(e){return this._matrix[e]}getRowOrCreate(e){let n=this.getRow(e);return n==null&&(n={},this._matrix[e]=n),n}reset(){this._setOriginValue({})}hasValue(){const e=this._matrix,n=Object.keys(e);if(n.length===0)return!1;for(const r of n){const s=Number(r),o=e[s];if(Object.keys(o).length>0)return!0}return!1}getValue(e,n){var r,s;return(s=(r=this._matrix)==null?void 0:r[e])==null?void 0:s[n]}setValue(e,n,r){const s=this.getRowOrCreate(e);s[n]=r}deleteValue(e,n){var r,s;(s=(r=this._matrix)==null?void 0:r[e])==null||delete s[n]}realDeleteValue(e,n){var r,s,o;if((s=(r=this._matrix)==null?void 0:r[e])==null||delete s[n],this.getRow(e)){const i=this.getRow(e);if(i==null)return;Object.keys(i).length===0&&((o=this._matrix)==null||delete o[e])}}setRow(e,n){this._matrix[e]=n}moveRows(e,n,r){xi(e,n,r,this._matrix)}moveColumns(e,n,r){this.forEach((s,o)=>{xi(e,n,r,o)})}insertRows(e,n){const r=Object.keys(this._matrix);for(let s=r.length-1;s>=0;s--){const o=Number(r[s]);if(o>=e){const i=this._matrix[o];delete this._matrix[o],this._matrix[o+n]=i}}}insertColumns(e,n){const r=Object.keys(this._matrix);for(let s=0;s<r.length;s++){const o=Number(r[s]),i=this._matrix[o],a=Object.keys(i);for(let l=a.length-1;l>=0;l--){const u=Number(a[l]);if(u>=e){const c=i[u];delete i[u],i[u+n]=c}}}}removeRows(e,n){Ni(e,n,this._matrix)}removeColumns(e,n){this.forEach((r,s)=>{s&&Ni(e,n,s)})}getFragment(e,n,r,s){const o=new fe;let i=0;for(let a=e;a<=n;a++){const l={};let u=0;for(let c=r;c<=s;c++){const h=this.getValue(a,c);l[u]=h,u++}o.setRow(i,l),i++}return o}getSlice(e,n,r,s){const o=new fe;for(let i=e;i<=n;i++)for(let a=r;a<=s;a++){const l=this.getValue(i,a);l&&o.setValue(i,a,q.deepClone(l))}return o}getSliceDataAndCellCountByRows(e,n){const r=new fe;let s=0;for(let o=e;o<=n;o++){const i=this.getRow(o);i&&(r.setRow(o,i),s+=Object.keys(i).length)}return{sliceData:r,cellCount:s}}getSizeOf(){return Object.keys(this._matrix).length}getLength(){return dn(this._matrix)}getRange(){const e=this.getLength()-1;let n=0;const r=this.getLength();for(let s=0;s<r;s++){const o=this.getRow(s);if(o){const i=dn(o)-1;n=i>n?i:n}}return{startRow:0,startColumn:0,endRow:e,endColumn:n}}getRealRange(){const e=Object.keys(this._matrix),n=e.length,r=n>0?Number(e[0]):0,s=n>0?Number(e[n-1]):0;let o=-1/0,i=0;for(const a of e){const l=this.getRow(Number(a));if(l){const u=Object.keys(l);if(u.length>0){const c=Number(u[0]),h=Number(u[u.length-1]);(o===-1/0||c<o)&&(o=c),h>i&&(i=h)}}}return o===-1/0&&(o=0),{startRow:r,endRow:s,startColumn:o,endColumn:i}}getRealRowRange(){const e=Object.keys(this._matrix),n=e.length,r=n>0?Number(e[0]):0,s=n>0?Number(e[n-1]):0;return{startRow:r,endRow:s}}toNativeArray(){const e=new Array;return this.forValue((n,r,s)=>{e.push(s)}),e}toArray(){const e=[];return this.forRow((n,r)=>{e[n]==null&&(e[n]=[]),r.forEach(s=>{e[n][s]=this.getValue(n,s)})}),e}toFullArray(){const e=this.getRange(),{endColumn:n,endRow:r}=e,s=[];for(let o=0;o<=r;o++){const i=new Array(n+1).fill(void 0);s.push(i)}return this.forValue((o,i,a)=>{s[o][i]=a}),s}toJSON(){return this._matrix}clone(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getData(){const e=JSON.stringify(this._matrix);return JSON.parse(e)}getArrayData(){let e=0,n=0,r=!1,s=!1;const o=new fe;return this.forEach((i,a)=>{r||(r=!0,e=i),Object.keys(a).forEach(l=>{const u=Number(l);s?u<n&&(n=u):(s=!0,n=u);const c=this.getValue(i,u);o.setValue(i-e,u-n,c)})}),o.getData()}getStartEndScope(){let e=1/0,n=-1/0,r=1/0,s=-1/0;const o=Object.keys(this._matrix);o.length>0&&(e=+o[0],n=+o[o.length-1]);for(const i of o){const a=Object.keys(this._matrix[i]);a.length>0&&(r=Math.min(r,+a[0]),s=Math.max(s,+a[a.length-1]))}return{startRow:e,endRow:n,startColumn:r,endColumn:s}}getDataRange(){let e=0,n=0,r=0,s=-1,o=!1,i=!1;return this.forEach((a,l)=>{if(o||(o=!0,e=a),l==null)return;const u=dn(l)-1;u>r&&(r=u),Object.keys(l).forEach(c=>{const h=Number(c);i?h<n&&(n=h):(i=!0,n=h)}),a>s&&(s=a)}),{startRow:e,startColumn:n,endRow:s,endColumn:r}}getDiscreteRanges(){const e=[];return this.forEach((n,r)=>{Object.keys(r).forEach(s=>{const o=Number(s);let i=!1;for(const a of e)if(n>=a.startRow&&n<=a.endRow+1&&o>=a.startColumn&&o<=a.endColumn+1){a.endRow=Math.max(n,a.endRow),a.endColumn=Math.max(o,a.endColumn),i=!0;break}i||e.push({startRow:n,endRow:n,startColumn:o,endColumn:o})})}),e}merge(e){this.forValue((n,r)=>{const s=e.getValue(n,r);s!=null&&this.setValue(n,r,s)})}concatRows(e){const n=e.getMatrix();for(const r in n){const s=Number(r);this.setRow(s,n[s])}}_setOriginValue(e={}){this._matrix=e}}function pf(t){const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:s,mergeInfo:o}=t;let{startY:i,endY:a,startX:l,endX:u}=t,c=e,h=n,d=e,f=n;if(r&&o){const{startRow:p,startColumn:m,endRow:R,endColumn:S,startY:P,endY:k,startX:H,endX:C}=o;c=p,h=m,d=R,f=S,i=P,a=k,l=H,u=C}return s&&(i=o.startY,a=o.endY,l=o.startX,u=o.endX,d=o.endRow,f=o.endColumn),{startRow:c,startColumn:h,endRow:d,endColumn:f,startY:i,endY:a,startX:l,endX:u}}const v1=pf;function C1(t){if(!t)return;const{actualRow:e,actualColumn:n,isMerged:r,isMergedMainCell:s,startRow:o,startColumn:i,endRow:a,endColumn:l}=t;let u=e,c=n,h=e,d=n;return(r||s)&&(u=o,c=i,h=a,d=l),{startRow:u,startColumn:c,endRow:h,endColumn:d}}function gf(t){var e;return!t||(((e=t?.v)==null?void 0:e.toString())||"").length===0&&!t.p}function Mi(t){return gf(t)&&t?.coverable!==!1}function Ve(t){if(t){if(t.rgb)return new we(t.rgb).toHexString();if(t.th)return new So().setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function mf(t){return q.isString(t)&&t.substring(0,1)==="="&&t.length>1}function R1(t){return q.isString(t)&&t.length>0}function b1(t,e=!1){var n;let r="";const s=new Map([["ff",()=>{t.ff&&(r+=`font-family: ${t.ff}; `)}],["fs",()=>{if(t.fs){let i=t.fs;t.va&&(i/=2),r+=`font-size: ${i}pt; `}}],["it",()=>{t.it&&(r+="font-style: italic; ")}],["bl",()=>{t.bl&&(r+="font-weight: bold; ")}],["ul",()=>{var i;(i=t.ul)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} underline`):r+="text-decoration: underline; ",t.ul.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${Ve(t.ul.cl)}; `),t.ul.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ul.t} `))}],["st",()=>{var i;(i=t.st)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} line-through`):r+="text-decoration-line: line-through; ",t.st.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${Ve(t.st.cl)}; `),t.st.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.st.t} `))}],["ol",()=>{var i;(i=t.ol)!=null&&i.s&&(r.indexOf("text-decoration-line")>-1?r=r.replace(/(text-decoration-line:\s*[^;]+)(?=;)/g,(a,l)=>`${l} overline`):r+="text-decoration-line: overline; ",t.ol.cl&&r.indexOf("text-decoration-color")===-1&&(r+=`text-decoration-color: ${Ve(t.ol.cl)}; `),t.ol.t&&r.indexOf("text-decoration-style")===-1&&(r+=`text-decoration-style: ${t.ol.t} `))}],["bg",()=>{t.bg&&(r+=`background: ${Ve(t.bg)}; `)}],["bd",()=>{var i,a,l,u,c,h,d,f,p,m,R,S;(i=t.bd)!=null&&i.b&&(r+=`border-bottom: ${ws((a=t.bd)==null?void 0:a.b.s)} ${(l=Ve(t.bd.b.cl))!=null?l:""}; `),(u=t.bd)!=null&&u.t&&(r+=`border-top: ${ws((c=t.bd)==null?void 0:c.t.s)} ${(h=Ve(t.bd.t.cl))!=null?h:""}; `),(d=t.bd)!=null&&d.r&&(r+=`border-right: ${ws((f=t.bd)==null?void 0:f.r.s)} ${(p=Ve(t.bd.r.cl))!=null?p:""}; `),(m=t.bd)!=null&&m.l&&(r+=`border-left: ${ws((R=t.bd)==null?void 0:R.l.s)} ${(S=Ve(t.bd.l.cl))!=null?S:""}; `)}],["cl",()=>{t.cl&&(r+=`color: ${Ve(t.cl)}; `)}],["va",()=>{t.va===tn.SUBSCRIPT?r+="vertical-align: sub; ":t.va===tn.SUPERSCRIPT&&(r+="vertical-align: super; ")}],["td",()=>{t.td===Kr.LEFT_TO_RIGHT?r+="direction: ltr; ":t.td===Kr.RIGHT_TO_LEFT&&(r+="direction: rtl; ")}],["tr",()=>{var i,a,l;t.tr&&(r+=`--data-rotate: (${(i=t.tr)==null?void 0:i.a}deg${(a=t.tr)!=null&&a.v?` ,${(l=t.tr)==null?void 0:l.v}`:""});`)}],["ht",()=>{t.ht===Fe.LEFT?r+="text-align: left; ":t.ht===Fe.RIGHT?r+="text-align: right; ":t.ht===Fe.CENTER?r+="text-align: center; ":t.ht===Fe.JUSTIFIED&&(r+="text-align: justify; ")}],["vt",()=>{t.vt===In.BOTTOM?r+="vertical-align: bottom; ":t.vt===In.TOP?r+="vertical-align: top; ":t.vt===In.MIDDLE&&(r+="vertical-align: middle; ")}],["tb",()=>{t.tb===Dn.CLIP?r+="white-space: nowrap; overflow-x: hidden; ":t.tb===Dn.WRAP&&(r+="white-space: normal;")}],["pd",()=>{var i,a,l,u,c,h,d,f;const p=`${(i=t.pd)==null?void 0:i.b}pt`,m=`${(a=t.pd)==null?void 0:a.t}pt`,R=`${(l=t.pd)==null?void 0:l.l}pt`,S=`${(u=t.pd)==null?void 0:u.r}pt`;(c=t.pd)!=null&&c.b&&(r+=`padding-bottom: ${p}; `),(h=t.pd)!=null&&h.t&&(r+=`padding-top: ${m}; `),(d=t.pd)!=null&&d.l&&(r+=`padding-left: ${R}; `),(f=t.pd)!=null&&f.r&&(r+=`padding-right: ${S}; `)}]]),o=["bd","tr","tb"];for(const i in t)e&&o.includes(i)||(n=s.get(i))==null||n();return r}function ws(t){let e="";return t===Mt.NONE?e="none":t===Mt.THIN?e="0.5pt solid":t===Mt.HAIR?e="0.5pt double":t===Mt.DOTTED?e="0.5pt dotted":t===Mt.DASHED||t===Mt.DASH_DOT?e="0.5pt dashed":t===Mt.DASH_DOT_DOT?e="0.5pt dotted":t===Mt.DOUBLE?e="0.5pt double":t===Mt.MEDIUM?e="1pt solid":t===Mt.MEDIUM_DASHED||t===Mt.MEDIUM_DASH_DOT?e="1pt dashed":t===Mt.MEDIUM_DASH_DOT_DOT?e="1pt dotted":t===Mt.SLANT_DASH_DOT?e="0.5pt dashed":t===Mt.THICK&&(e="1.5pt solid"),e}function T1(t){let e=0;if(t=t.trim(),t==="none")e=Mt.NONE;else if(t==="0.5pt solid")e=Mt.THIN;else if(t==="0.5pt double")e=Mt.HAIR;else if(t==="0.5pt dotted")e=Mt.DOTTED;else if(t==="0.5pt dashed")e=Mt.DASHED;else if(t==="1pt solid")e=Mt.MEDIUM;else if(t==="1pt dashed")e=Mt.MEDIUM_DASHED;else if(t==="1pt dotted")e=Mt.MEDIUM_DASH_DOT_DOT;else if(t==="1.5pt solid")e=Mt.THICK;else if(!t.includes("none"))e=Mt.THIN;else return Mt.NONE;return e}function I1(t,e){let n=t.body;if(e){const{headers:r,footers:s}=t;r!=null&&r[e]?n=r[e].body:s!=null&&s[e]&&(n=s[e].body)}return n}function w1(t,e){const{startRow:n,endRow:r,startColumn:s,endColumn:o,rangeType:i}=t;if(n<0||s<0||r<0||o<0||!(Number.isNaN(n)&&Number.isNaN(r))&&i===gt.COLUMN||!(Number.isNaN(s)&&Number.isNaN(o))&&i===gt.ROW||i!==gt.ROW&&i!==gt.COLUMN&&(Number.isNaN(s)||Number.isNaN(n)||Number.isNaN(o)||Number.isNaN(r)))return!1;if(e){const a=e.getRowCount(),l=e.getColumnCount();if(r>=a||o>=l)return!1}return!0}function S1(t,e){return{startRow:t,endRow:t,startColumn:e,endColumn:e}}function Li(t){if(mf(t))return{f:t,v:null,p:null};if(Hd(t)){if(typeof t=="string"){const e=ff(t);if(e&&e.z)return{v:e.v,p:null,f:null,s:{n:{pattern:e.z||ml}}}}return{v:t,p:null,f:null}}return $d(t),t}function A1(t,e){const n=new fe,{startRow:r,startColumn:s,endRow:o,endColumn:i}=e;if(q.isArray(t))for(let a=0;a<=o-r;a++)for(let l=0;l<=i-s;l++)n.setValue(a+r,l+s,Li(t[a][l]));else new fe(t).forValue((a,l,u)=>{n.setValue(a,l,Li(u))});return n.getMatrix()}function _l(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)?Object.prototype.toString.call(t)==="[object Object]"||Object.prototype.toString.call(t)==="[object Array]"?Object.keys(t).length!==Object.keys(e).length?!1:Object.keys(t).every(n=>_l(t[n],e[n])):t===e:!1}function _f(t,e){const n=t.ts||{},r=e.ts||{};return t.sId!==e.sId?!1:_l(n,r)}function O1(t,e){return e.some(n=>t.indexOf(n)>-1)}var Ui={exports:{}},D1=Ui.exports,Fu;function N1(){return Fu||(Fu=1,(function(t,e){(function(n,r){t.exports=r()})(D1,(function(){var n=1e3,r=6e4,s=36e5,o="millisecond",i="second",a="minute",l="hour",u="day",c="week",h="month",d="quarter",f="year",p="date",m="Invalid Date",R=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,S=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,P={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var w=["th","st","nd","rd"],I=D%100;return"["+D+(w[(I-20)%10]||w[I]||w[0])+"]"}},k=function(D,w,I){var A=String(D);return!A||A.length>=w?D:""+Array(w+1-A.length).join(I)+D},H={s:k,z:function(D){var w=-D.utcOffset(),I=Math.abs(w),A=Math.floor(I/60),O=I%60;return(w<=0?"+":"-")+k(A,2,"0")+":"+k(O,2,"0")},m:function D(w,I){if(w.date()<I.date())return-D(I,w);var A=12*(I.year()-w.year())+(I.month()-w.month()),O=w.clone().add(A,h),x=I-O<0,F=w.clone().add(A+(x?-1:1),h);return+(-(A+(I-O)/(x?O-F:F-O))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:h,y:f,w:c,d:u,D:p,h:l,m:a,s:i,ms:o,Q:d}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},C="en",b={};b[C]=P;var v="$isDayjsObject",N=function(D){return D instanceof L||!(!D||!D[v])},V=function D(w,I,A){var O;if(!w)return C;if(typeof w=="string"){var x=w.toLowerCase();b[x]&&(O=x),I&&(b[x]=I,O=x);var F=w.split("-");if(!O&&F.length>1)return D(F[0])}else{var Q=w.name;b[Q]=w,O=Q}return!A&&O&&(C=O),O||!A&&C},Y=function(D,w){if(N(D))return D.clone();var I=typeof w=="object"?w:{};return I.date=D,I.args=arguments,new L(I)},g=H;g.l=V,g.i=N,g.w=function(D,w){return Y(D,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var L=(function(){function D(I){this.$L=V(I.locale,null,!0),this.parse(I),this.$x=this.$x||I.x||{},this[v]=!0}var w=D.prototype;return w.parse=function(I){this.$d=(function(A){var O=A.date,x=A.utc;if(O===null)return new Date(NaN);if(g.u(O))return new Date;if(O instanceof Date)return new Date(O);if(typeof O=="string"&&!/Z$/i.test(O)){var F=O.match(R);if(F){var Q=F[2]-1||0,G=(F[7]||"0").substring(0,3);return x?new Date(Date.UTC(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,G)):new Date(F[1],Q,F[3]||1,F[4]||0,F[5]||0,F[6]||0,G)}}return new Date(O)})(I),this.init()},w.init=function(){var I=this.$d;this.$y=I.getFullYear(),this.$M=I.getMonth(),this.$D=I.getDate(),this.$W=I.getDay(),this.$H=I.getHours(),this.$m=I.getMinutes(),this.$s=I.getSeconds(),this.$ms=I.getMilliseconds()},w.$utils=function(){return g},w.isValid=function(){return this.$d.toString()!==m},w.isSame=function(I,A){var O=Y(I);return this.startOf(A)<=O&&O<=this.endOf(A)},w.isAfter=function(I,A){return Y(I)<this.startOf(A)},w.isBefore=function(I,A){return this.endOf(A)<Y(I)},w.$g=function(I,A,O){return g.u(I)?this[A]:this.set(O,I)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(I,A){var O=this,x=!!g.u(A)||A,F=g.p(I),Q=function(B,$){var Z=g.w(O.$u?Date.UTC(O.$y,$,B):new Date(O.$y,$,B),O);return x?Z:Z.endOf(u)},G=function(B,$){return g.w(O.toDate()[B].apply(O.toDate("s"),(x?[0,0,0,0]:[23,59,59,999]).slice($)),O)},it=this.$W,lt=this.$M,T=this.$D,M="set"+(this.$u?"UTC":"");switch(F){case f:return x?Q(1,0):Q(31,11);case h:return x?Q(1,lt):Q(0,lt+1);case c:var j=this.$locale().weekStart||0,W=(it<j?it+7:it)-j;return Q(x?T-W:T+(6-W),lt);case u:case p:return G(M+"Hours",0);case l:return G(M+"Minutes",1);case a:return G(M+"Seconds",2);case i:return G(M+"Milliseconds",3);default:return this.clone()}},w.endOf=function(I){return this.startOf(I,!1)},w.$set=function(I,A){var O,x=g.p(I),F="set"+(this.$u?"UTC":""),Q=(O={},O[u]=F+"Date",O[p]=F+"Date",O[h]=F+"Month",O[f]=F+"FullYear",O[l]=F+"Hours",O[a]=F+"Minutes",O[i]=F+"Seconds",O[o]=F+"Milliseconds",O)[x],G=x===u?this.$D+(A-this.$W):A;if(x===h||x===f){var it=this.clone().set(p,1);it.$d[Q](G),it.init(),this.$d=it.set(p,Math.min(this.$D,it.daysInMonth())).$d}else Q&&this.$d[Q](G);return this.init(),this},w.set=function(I,A){return this.clone().$set(I,A)},w.get=function(I){return this[g.p(I)]()},w.add=function(I,A){var O,x=this;I=Number(I);var F=g.p(A),Q=function(lt){var T=Y(x);return g.w(T.date(T.date()+Math.round(lt*I)),x)};if(F===h)return this.set(h,this.$M+I);if(F===f)return this.set(f,this.$y+I);if(F===u)return Q(1);if(F===c)return Q(7);var G=(O={},O[a]=r,O[l]=s,O[i]=n,O)[F]||1,it=this.$d.getTime()+I*G;return g.w(it,this)},w.subtract=function(I,A){return this.add(-1*I,A)},w.format=function(I){var A=this,O=this.$locale();if(!this.isValid())return O.invalidDate||m;var x=I||"YYYY-MM-DDTHH:mm:ssZ",F=g.z(this),Q=this.$H,G=this.$m,it=this.$M,lt=O.weekdays,T=O.months,M=O.meridiem,j=function($,Z,tt,U){return $&&($[Z]||$(A,x))||tt[Z].slice(0,U)},W=function($){return g.s(Q%12||12,$,"0")},B=M||function($,Z,tt){var U=$<12?"AM":"PM";return tt?U.toLowerCase():U};return x.replace(S,(function($,Z){return Z||(function(tt){switch(tt){case"YY":return String(A.$y).slice(-2);case"YYYY":return g.s(A.$y,4,"0");case"M":return it+1;case"MM":return g.s(it+1,2,"0");case"MMM":return j(O.monthsShort,it,T,3);case"MMMM":return j(T,it);case"D":return A.$D;case"DD":return g.s(A.$D,2,"0");case"d":return String(A.$W);case"dd":return j(O.weekdaysMin,A.$W,lt,2);case"ddd":return j(O.weekdaysShort,A.$W,lt,3);case"dddd":return lt[A.$W];case"H":return String(Q);case"HH":return g.s(Q,2,"0");case"h":return W(1);case"hh":return W(2);case"a":return B(Q,G,!0);case"A":return B(Q,G,!1);case"m":return String(G);case"mm":return g.s(G,2,"0");case"s":return String(A.$s);case"ss":return g.s(A.$s,2,"0");case"SSS":return g.s(A.$ms,3,"0");case"Z":return F}return null})($)||F.replace(":","")}))},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(I,A,O){var x,F=this,Q=g.p(A),G=Y(I),it=(G.utcOffset()-this.utcOffset())*r,lt=this-G,T=function(){return g.m(F,G)};switch(Q){case f:x=T()/12;break;case h:x=T();break;case d:x=T()/3;break;case c:x=(lt-it)/6048e5;break;case u:x=(lt-it)/864e5;break;case l:x=lt/s;break;case a:x=lt/r;break;case i:x=lt/n;break;default:x=lt}return O?x:g.a(x)},w.daysInMonth=function(){return this.endOf(h).$D},w.$locale=function(){return b[this.$L]},w.locale=function(I,A){if(!I)return this.$L;var O=this.clone(),x=V(I,A,!0);return x&&(O.$L=x),O},w.clone=function(){return g.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},D})(),E=L.prototype;return Y.prototype=E,[["$ms",o],["$s",i],["$m",a],["$H",l],["$W",u],["$M",h],["$y",f],["$D",p]].forEach((function(D){E[D[1]]=function(w){return this.$g(w,D[0],D[1])}})),Y.extend=function(D,w){return D.$i||(D(w,L,Y),D.$i=!0),Y},Y.locale=V,Y.isDayjs=N,Y.unix=function(D){return Y(1e3*D)},Y.en=b[C],Y.Ls=b,Y.p={},Y}))})(Ui)),Ui.exports}var x1=N1();const nn=Ne(x1);var Fi={exports:{}},M1=Fi.exports,ku;function L1(){return ku||(ku=1,(function(t,e){(function(n,r){t.exports=r()})(M1,(function(){return function(n,r){var s=r.prototype,o=s.format;s.format=function(i){var a=this,l=this.$locale();if(!this.isValid())return o.bind(this)(i);var u=this.$utils(),c=(i||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(h){switch(h){case"Q":return Math.ceil((a.$M+1)/3);case"Do":return l.ordinal(a.$D);case"gggg":return a.weekYear();case"GGGG":return a.isoWeekYear();case"wo":return l.ordinal(a.week(),"W");case"w":case"ww":return u.s(a.week(),h==="w"?1:2,"0");case"W":case"WW":return u.s(a.isoWeek(),h==="W"?1:2,"0");case"k":case"kk":return u.s(String(a.$H===0?24:a.$H),h==="k"?1:2,"0");case"X":return Math.floor(a.$d.getTime()/1e3);case"x":return a.$d.getTime();case"z":return"["+a.offsetName()+"]";case"zzz":return"["+a.offsetName("long")+"]";default:return h}}));return o.bind(this)(c)}}}))})(Fi)),Fi.exports}var U1=L1();const F1=Ne(U1);var ki={exports:{}},k1=ki.exports,Pu;function P1(){return Pu||(Pu=1,(function(t,e){(function(n,r){t.exports=r()})(k1,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,s=/\d/,o=/\d\d/,i=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,l={},u=function(R){return(R=+R)+(R>68?1900:2e3)},c=function(R){return function(S){this[R]=+S}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(R){(this.zone||(this.zone={})).offset=(function(S){if(!S||S==="Z")return 0;var P=S.match(/([+-]|\d\d)/g),k=60*P[1]+(+P[2]||0);return k===0?0:P[0]==="+"?-k:k})(R)}],d=function(R){var S=l[R];return S&&(S.indexOf?S:S.s.concat(S.f))},f=function(R,S){var P,k=l.meridiem;if(k){for(var H=1;H<=24;H+=1)if(R.indexOf(k(H,0,S))>-1){P=H>12;break}}else P=R===(S?"pm":"PM");return P},p={A:[a,function(R){this.afternoon=f(R,!1)}],a:[a,function(R){this.afternoon=f(R,!0)}],Q:[s,function(R){this.month=3*(R-1)+1}],S:[s,function(R){this.milliseconds=100*+R}],SS:[o,function(R){this.milliseconds=10*+R}],SSS:[/\d{3}/,function(R){this.milliseconds=+R}],s:[i,c("seconds")],ss:[i,c("seconds")],m:[i,c("minutes")],mm:[i,c("minutes")],H:[i,c("hours")],h:[i,c("hours")],HH:[i,c("hours")],hh:[i,c("hours")],D:[i,c("day")],DD:[o,c("day")],Do:[a,function(R){var S=l.ordinal,P=R.match(/\d+/);if(this.day=P[0],S)for(var k=1;k<=31;k+=1)S(k).replace(/\[|\]/g,"")===R&&(this.day=k)}],w:[i,c("week")],ww:[o,c("week")],M:[i,c("month")],MM:[o,c("month")],MMM:[a,function(R){var S=d("months"),P=(d("monthsShort")||S.map((function(k){return k.slice(0,3)}))).indexOf(R)+1;if(P<1)throw new Error;this.month=P%12||P}],MMMM:[a,function(R){var S=d("months").indexOf(R)+1;if(S<1)throw new Error;this.month=S%12||S}],Y:[/[+-]?\d+/,c("year")],YY:[o,function(R){this.year=u(R)}],YYYY:[/\d{4}/,c("year")],Z:h,ZZ:h};function m(R){var S,P;S=R,P=l&&l.formats;for(var k=(R=S.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(Y,g,L){var E=L&&L.toUpperCase();return g||P[L]||n[L]||P[E].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(D,w,I){return w||I.slice(1)}))}))).match(r),H=k.length,C=0;C<H;C+=1){var b=k[C],v=p[b],N=v&&v[0],V=v&&v[1];k[C]=V?{regex:N,parser:V}:b.replace(/^\[|\]$/g,"")}return function(Y){for(var g={},L=0,E=0;L<H;L+=1){var D=k[L];if(typeof D=="string")E+=D.length;else{var w=D.regex,I=D.parser,A=Y.slice(E),O=w.exec(A)[0];I.call(g,O),Y=Y.replace(O,"")}}return(function(x){var F=x.afternoon;if(F!==void 0){var Q=x.hours;F?Q<12&&(x.hours+=12):Q===12&&(x.hours=0),delete x.afternoon}})(g),g}}return function(R,S,P){P.p.customParseFormat=!0,R&&R.parseTwoDigitYear&&(u=R.parseTwoDigitYear);var k=S.prototype,H=k.parse;k.parse=function(C){var b=C.date,v=C.utc,N=C.args;this.$u=v;var V=N[1];if(typeof V=="string"){var Y=N[2]===!0,g=N[3]===!0,L=Y||g,E=N[2];g&&(E=N[2]),l=this.$locale(),!Y&&E&&(l=P.Ls[E]),this.$d=(function(A,O,x,F){try{if(["x","X"].indexOf(O)>-1)return new Date((O==="X"?1e3:1)*A);var Q=m(O)(A),G=Q.year,it=Q.month,lt=Q.day,T=Q.hours,M=Q.minutes,j=Q.seconds,W=Q.milliseconds,B=Q.zone,$=Q.week,Z=new Date,tt=lt||(G||it?1:Z.getDate()),U=G||Z.getFullYear(),z=0;G&&!it||(z=it>0?it-1:Z.getMonth());var X,nt=T||0,ft=M||0,mt=j||0,K=W||0;return B?new Date(Date.UTC(U,z,tt,nt,ft,mt,K+60*B.offset*1e3)):x?new Date(Date.UTC(U,z,tt,nt,ft,mt,K)):(X=new Date(U,z,tt,nt,ft,mt,K),$&&(X=F(X).week($).toDate()),X)}catch{return new Date("")}})(b,V,v,P),this.init(),E&&E!==!0&&(this.$L=this.locale(E).$L),L&&b!=this.format(V)&&(this.$d=new Date("")),l={}}else if(V instanceof Array)for(var D=V.length,w=1;w<=D;w+=1){N[1]=V[w-1];var I=P.apply(this,N);if(I.isValid()){this.$d=I.$d,this.$L=I.$L,this.init();break}w===D&&(this.$d=new Date(""))}else H.call(this,C)}}}))})(ki)),ki.exports}var B1=P1();const $1=Ne(B1);var Pi={exports:{}},H1=Pi.exports,Bu;function j1(){return Bu||(Bu=1,(function(t,e){(function(n,r){t.exports=r()})(H1,(function(){return function(n,r,s){var o=r.prototype,i=function(h){return h&&(h.indexOf?h:h.s)},a=function(h,d,f,p,m){var R=h.name?h:h.$locale(),S=i(R[d]),P=i(R[f]),k=S||P.map((function(C){return C.slice(0,p)}));if(!m)return k;var H=R.weekStart;return k.map((function(C,b){return k[(b+(H||0))%7]}))},l=function(){return s.Ls[s.locale()]},u=function(h,d){return h.formats[d]||(function(f){return f.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(p,m,R){return m||R.slice(1)}))})(h.formats[d.toUpperCase()])},c=function(){var h=this;return{months:function(d){return d?d.format("MMMM"):a(h,"months")},monthsShort:function(d){return d?d.format("MMM"):a(h,"monthsShort","months",3)},firstDayOfWeek:function(){return h.$locale().weekStart||0},weekdays:function(d){return d?d.format("dddd"):a(h,"weekdays")},weekdaysMin:function(d){return d?d.format("dd"):a(h,"weekdaysMin","weekdays",2)},weekdaysShort:function(d){return d?d.format("ddd"):a(h,"weekdaysShort","weekdays",3)},longDateFormat:function(d){return u(h.$locale(),d)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};o.localeData=function(){return c.bind(this)()},s.localeData=function(){var h=l();return{firstDayOfWeek:function(){return h.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(d){return u(h,d)},meridiem:h.meridiem,ordinal:h.ordinal}},s.months=function(){return a(l(),"months")},s.monthsShort=function(){return a(l(),"monthsShort","months",3)},s.weekdays=function(h){return a(l(),"weekdays",null,null,h)},s.weekdaysShort=function(h){return a(l(),"weekdaysShort","weekdays",3,h)},s.weekdaysMin=function(h){return a(l(),"weekdaysMin","weekdays",2,h)}}}))})(Pi)),Pi.exports}var W1=j1();const V1=Ne(W1);var Bi={exports:{}},G1=Bi.exports,$u;function Y1(){return $u||($u=1,(function(t,e){(function(n,r){t.exports=r()})(G1,(function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,o){var i=s.prototype,a=i.format;o.en.formats=n,i.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,c=(function(h,d){return h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(f,p,m){var R=m&&m.toUpperCase();return p||d[m]||n[m]||d[R].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(S,P,k){return P||k.slice(1)}))}))})(l,u===void 0?{}:u);return a.call(this,c)}}}))})(Bi)),Bi.exports}var z1=Y1();const K1=Ne(z1);var $i={exports:{}},X1=$i.exports,Hu;function J1(){return Hu||(Hu=1,(function(t,e){(function(n,r){t.exports=r()})(X1,(function(){var n="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(o,i,a){var l=i.prototype;a.utc=function(m){var R={date:m,utc:!0,args:arguments};return new i(R)},l.utc=function(m){var R=a(this.toDate(),{locale:this.$L,utc:!0});return m?R.add(this.utcOffset(),n):R},l.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var u=l.parse;l.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),u.call(this,m)};var c=l.init;l.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else c.call(this)};var h=l.utcOffset;l.utcOffset=function(m,R){var S=this.$utils().u;if(S(m))return this.$u?0:S(this.$offset)?h.call(this):this.$offset;if(typeof m=="string"&&(m=(function(C){C===void 0&&(C="");var b=C.match(r);if(!b)return null;var v=(""+b[0]).match(s)||["-",0,0],N=v[0],V=60*+v[1]+ +v[2];return V===0?0:N==="+"?V:-V})(m),m===null))return this;var P=Math.abs(m)<=16?60*m:m;if(P===0)return this.utc(R);var k=this.clone();if(R)return k.$offset=P,k.$u=!1,k;var H=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(k=this.local().add(P+H,n)).$offset=P,k.$x.$localOffset=H,k};var d=l.format;l.format=function(m){var R=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return d.call(this,R)},l.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var f=l.toDate;l.toDate=function(m){return m==="s"&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var p=l.diff;l.diff=function(m,R,S){if(m&&this.$u===m.$u)return p.call(this,m,R,S);var P=this.local(),k=a(m).local();return p.call(P,k,R,S)}}}))})($i)),$i.exports}var Q1=J1();const q1=Ne(Q1);var Hi={exports:{}},Z1=Hi.exports,ju;function tC(){return ju||(ju=1,(function(t,e){(function(n,r){t.exports=r()})(Z1,(function(){return function(n,r){r.prototype.weekday=function(s){var o=this.$locale().weekStart||0,i=this.$W,a=(i<o?i+7:i)-o;return this.$utils().u(s)?a:this.subtract(a,"day").add(s,"day")}}}))})(Hi)),Hi.exports}var eC=tC();const nC=Ne(eC);var ji={exports:{}},rC=ji.exports,Wu;function sC(){return Wu||(Wu=1,(function(t,e){(function(n,r){t.exports=r()})(rC,(function(){var n="week",r="year";return function(s,o,i){var a=o.prototype;a.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var u=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var c=i(this).startOf(r).add(1,r).date(u),h=i(this).endOf(n);if(c.isBefore(h))return 1}var d=i(this).startOf(r).date(u).startOf(n).subtract(1,"millisecond"),f=this.diff(d,n,!0);return f<0?i(this).startOf("week").week():Math.ceil(f)},a.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}}))})(ji)),ji.exports}var oC=sC();const iC=Ne(oC);var Wi={exports:{}},aC=Wi.exports,Vu;function lC(){return Vu||(Vu=1,(function(t,e){(function(n,r){t.exports=r()})(aC,(function(){return function(n,r){r.prototype.weekYear=function(){var s=this.month(),o=this.week(),i=this.year();return o===1&&s===11?i+1:s===0&&o>=52?i-1:i}}}))})(Wi)),Wi.exports}var uC=lC();const cC=Ne(uC);nn.extend($1);nn.extend(F1);nn.extend(nC);nn.extend(V1);nn.extend(iC);nn.extend(cC);nn.extend(q1);nn.extend(K1);function xo(t,e,n,r){if(t>e)throw new Error("a1 should be less than a2");if(n>r)throw new Error("b1 should be less than b2");if(e<n||r<t)return[t,e];if(n<=t&&r>=e)return[];const s=r-n+1;return t<n&&e>r?[t,e-s]:n<=t&&r<e?[r+1-s,e-s]:n>t&&r>=e?[t,n-1]:[t,e]}function hC(t){if(t==null)return!1;const e=t.bullet;return e?.listId!=null}function dC(t){if(t==null)return!1;const e=t.paragraphStyle;return yf(e)}function yf(t){var e;return!(t==null||(t.indentStart==null||t.indentStart.v===0)&&t.hanging==null||((e=t.hanging)==null?void 0:e.v)===0)}function Ef(t,e,n){return t.slice(0,e)+n+t.slice(e)}function vf(t,e,n){return e>n?t:t.slice(0,e)+t.slice(n)}function fC(t){if(t==null||typeof t=="boolean")return!1;if(typeof t=="number")return!isNaN(t);if(typeof t=="string"){const e=t.trim();return e===""?!1:!isNaN(Number(e))}return!1}function pC(t){let e=0;for(let n=0;n<t.length;n++)e=t.charCodeAt(n)+(e<<6)+(e<<16)-e;return e>>>0}function gC(t){if(t.length===0)return[];const e=t.slice().sort((o,i)=>(Array.isArray(o)?o[0]:o)-(Array.isArray(i)?i[0]:i)),n=[];let r=Array.isArray(e[0])?e[0][0]:e[0],s=r;for(let o=1;o<e.length;o++){const i=e[o];let a,l;Array.isArray(i)?(a=i[0],l=i[1]):(a=i,l=i),a<=s+1?s=Math.max(s,l):(n.push([r,s]),r=a,s=l)}return n.push([r,s]),n}function mC(t){if(t.length===0)return[];const e=t.slice().sort((o,i)=>o[0]-i[0]),n=[];let[r,s]=e[0];for(let o=1;o<e.length;o++){const[i,a]=e[o];i<=s+1?s=Math.max(s,a):(n.push([r,s]),r=i,s=a)}return n.push([r,s]),n}function _C(...t){let e;return t.length===1&&Array.isArray(t[0])?e=t[0]:e=t,Ro({},...e)}const Dt=Symbol("newer"),Zt=Symbol("older");class yC{constructor(e){_(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Dt],{done:!1,value:e.key}):{done:!0,value:void 0}}}class EC{constructor(e){_(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Dt],{done:!1,value:e.value}):{done:!0,value:void 0}}}class vC{constructor(e){_(this,"entry"),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[Dt],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}var Cf,Rf;Rf=Dt,Cf=Zt;class Gu{constructor(e,n){_(this,"key"),_(this,"value"),_(this,Rf),_(this,Cf),this.key=e,this.value=n,this[Dt]=void 0,this[Zt]=void 0}toJSON(){return{key:this.key,value:this.value}}}class Mo{constructor(...e){if(_(this,"_keymap"),_(this,"size",0),_(this,"limit"),_(this,"oldest"),_(this,"newest"),_(this,"_onShiftListeners",[]),Ur.hasLength(e,1)){if(Ur.isNumber(e[0])){const n=e[0];this._initialize(n,void 0);return}if(Ur.isIterable(e[0])){const n=e[0];this._initialize(0,n);return}return}if(Ur.hasLength(e,2)){const n=e[0],r=e[1];this._initialize(n,r)}}onShift(e){if(this._onShiftListeners.indexOf(e)===-1)return this._onShiftListeners.push(e),Wt(()=>ns(this._onShiftListeners,e));throw new Error("[LRUMap]: the listener has been registered!")}_initialize(e,n){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,n&&(this.assign(n),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[Dt]&&(e===this.oldest&&(this.oldest=e[Dt]),e[Dt][Zt]=e[Zt]),e[Zt]&&(e[Zt][Dt]=e[Dt]),e[Dt]=void 0,e[Zt]=this.newest,this.newest&&(this.newest[Dt]=e),this.newest=e)}assign(e){let n,r=this.limit||Number.MAX_VALUE;this._keymap.clear();const s=e[Symbol.iterator]();for(let o=s.next();!o.done;o=s.next()){const i=new Gu(o.value[0],o.value[1]);if(this._keymap.set(i.key,i),n?(n[Dt]=i,i[Zt]=n):this.oldest=i,n=i,r--===0)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}set(e,n){let r=this._keymap.get(e);return r?(r.value=n,this._markEntryAsUsed(r),this):(this._keymap.set(e,r=new Gu(e,n)),this.newest?(this.newest[Dt]=r,r[Zt]=this.newest):this.oldest=r,this.newest=r,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;if(e)return this.oldest&&this.oldest[Dt]?(this.oldest=this.oldest[Dt],this.oldest[Zt]=void 0):(this.oldest=void 0,this.newest=void 0),e[Dt]=e[Zt]=void 0,this._keymap.delete(e.key),--this.size,this._onShiftListeners.forEach(n=>n(e)),[e.key,e.value]}get(e){const n=this._keymap.get(e);if(n)return this._markEntryAsUsed(n),n.value}has(e){return this._keymap.has(e)}find(e){const n=this._keymap.get(e);return n?n.value:void 0}delete(e){const n=this._keymap.get(e);if(n)return this._keymap.delete(n.key),n[Dt]&&n[Zt]?(n[Zt][Dt]=n[Dt],n[Dt][Zt]=n[Zt]):n[Dt]?(n[Dt][Zt]=void 0,this.oldest=n[Dt]):n[Zt]?(n[Zt][Dt]=void 0,this.newest=n[Zt]):this.oldest=this.newest=void 0,this.size--,n.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new yC(this.oldest)}values(){return new EC(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new vC(this.oldest)}forEach(e,n){typeof n!="object"&&(n=this);let r=this.oldest;for(;r;)e.call(n,r.value,r.key,this),r=r[Dt]}toJSON(){const e=new Array(this.size);let n=0,r=this.oldest;for(;r;)e[n++]={key:r.key,value:r.value},r=r[Dt];return e}toString(){let e="",n=this.oldest;for(;n;)e+=`${String(n.key)}:${n.value}`,n=n[Dt],n&&(e+=" < ");return e}}class Ur{static hasLength(e,n){return e.length===n}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}}function CC(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(r<65||r>90)return-1;e=e*26+(r-64)}return e}const Vi=1048576,Gi=16384,RC={sheetId:"",range:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},bC={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},TC={startRow:0,startColumn:0,endRow:0,endColumn:0},IC={row:0,column:0},le={ff:"Arial",fs:11,it:ot.FALSE,bl:ot.FALSE,ul:{s:ot.FALSE},st:{s:ot.FALSE},ol:{s:ot.FALSE},tr:{a:0,v:ot.FALSE},td:Kr.UNSPECIFIED,cl:{rgb:"#000000"},bg:{rgb:"#fff"},ht:Fe.UNSPECIFIED,vt:In.UNSPECIFIED,tb:Dn.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0},n:null,bd:{b:null,l:null,r:null,t:null}},bf={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},wC=[Ra,Yc,ba],SC={[Jt.HEADING_1]:{fs:20,bl:1},[Jt.HEADING_2]:{fs:18,bl:1},[Jt.HEADING_3]:{fs:16,bl:1},[Jt.HEADING_4]:{fs:14,bl:1},[Jt.HEADING_5]:{fs:12,bl:1},[Jt.NORMAL_TEXT]:null,[Jt.TITLE]:{fs:26,bl:1},[Jt.SUBTITLE]:{fs:15,cl:{rgb:"#999999"}},[Jt.NAMED_STYLE_TYPE_UNSPECIFIED]:null},jn=4,AC={[Jt.HEADING_1]:{spaceAbove:{v:20},spaceBelow:{v:6+jn}},[Jt.HEADING_2]:{spaceAbove:{v:18},spaceBelow:{v:6+jn}},[Jt.HEADING_3]:{spaceAbove:{v:16},spaceBelow:{v:6+jn}},[Jt.HEADING_4]:{spaceAbove:{v:14},spaceBelow:{v:4+jn}},[Jt.HEADING_5]:{spaceAbove:{v:12},spaceBelow:{v:4+jn}},[Jt.NORMAL_TEXT]:{spaceAbove:{v:0},spaceBelow:{v:0}},[Jt.TITLE]:{spaceAbove:{v:0},spaceBelow:{v:3+jn}},[Jt.SUBTITLE]:{spaceAbove:{v:0},spaceBelow:{v:16}},[Jt.NAMED_STYLE_TYPE_UNSPECIFIED]:null},OC="univer-sheets-chart-print-chart",DC="univer-docs-drawing-printing";var Tf=(t=>(t.ARRAY_CONVERTOR="ARRAY_CONVERTOR",t.MATRIX_CONVERTOR="MATRIX_CONVERTOR",t))(Tf||{});const NC={[me.A3]:{width:1123,height:1587},[me.A4]:{width:794,height:1124},[me.A5]:{width:559,height:794},[me.B4]:{width:944,height:1344},[me.B5]:{width:665,height:944},[me.Executive]:{width:696,height:1008},[me.Folio]:{width:816,height:1248},[me.Legal]:{width:816,height:1344},[me.Letter]:{width:816,height:1056},[me.Statement]:{width:528,height:816},[me.Tabloid]:{width:1056,height:1632}};function Ss(t,e){const{textRuns:n=[]}=e;let r=0;for(const s of n){const{ts:o={},st:i,ed:a}=s;if(o[t]==null)return ot.FALSE;switch(t){case"bl":case"it":{if(o[t]===ot.FALSE)return ot.FALSE;break}case"ul":case"st":{if(o[t].s===ot.FALSE)return ot.FALSE;break}default:throw new Error(`unknown style key: ${t} in IStyleBase`)}r+=a-i}return e.dataStream.indexOf(`\r
`)===r?ot.TRUE:ot.FALSE}const If=class Yi{constructor(e,n,r){_(this,"_range"),_(this,"_worksheet"),this._deps=r,this._range=n,this._worksheet=e}static foreach(e,n){const{startRow:r,startColumn:s,endRow:o,endColumn:i}=e;for(let a=r;a<=o;a++)for(let l=s;l<=i;l++)n(a,l)}getRangeData(){return this._range}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=[];for(let i=e;i<=n;i++){const a=[];for(let l=r;l<=s;l++)a.push(this.getMatrix().getValue(i,l)||null);o.push(a)}return o}getMatrix(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=this._worksheet.getCellMatrix(),i=new fe;for(let a=e;a<=n;a++)for(let l=r;l<=s;l++)i.setValue(a,l,o.getValue(a,l)||null);return i}getMatrixObject(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range,o=this._worksheet.getCellMatrix(),i=new fe;for(let a=e;a<=n;a++)for(let l=r;l<=s;l++)i.setValue(a-e,l-r,o.getValue(a,l)||{});return i}getA1Notation(){const{startRow:e,endRow:n,startColumn:r,endColumn:s}=this._range;let o,i;return r<s?(o=q.numToWord(r+1)+(e+1),i=q.numToWord(s+1)+(n+1)):(o=q.numToWord(s+1)+(n+1),i=q.numToWord(r+1)+(e+1)),o===i?`${o}`:`${o}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var s;const o=e.getStyleByCell(r);return((s=o?.bg)==null?void 0:s.rgb)||le.bg.rgb}))}getCell(e,n){const{startRow:r,startColumn:s}=this._range,o={startRow:r+e,endRow:r+e,startColumn:s+n,endColumn:s+n};return new Yi(this._worksheet,o,this._deps)}getColumn(){return this._range.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){var n;const{startRow:r,endRow:s,startColumn:o,endColumn:i}=this._range,a=this._worksheet.getCellMatrix().getFragment(r,s,o,i).getData();if(e.isIncludeStyle){const l=this._deps.getStyles();for(let u=0;u<=s-r;u++)for(let c=0;c<=i-o;c++){if(a==null||((n=a?.[u])==null?void 0:n[c])==null)continue;const h=a[u][c].s;h&&(a[u][c].s=l.get(h))}}return a}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>{var s;const o=e.getStyleByCell(r);return((s=o?.cl)==null?void 0:s.rgb)||le.cl.rgb}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ss("ul",r.body)===ot.TRUE?{s:ot.TRUE}:{s:ot.FALSE}:this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThrough(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ss("st",r.body)===ot.TRUE?{s:ot.TRUE}:{s:ot.FALSE}:this.getStrikeThroughs()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getFontSize(){var e,n;const r=((e=this.getValue())==null?void 0:e.p)||{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?r.body.textRuns.some(s=>{var o;return((o=s?.ts)==null?void 0:o.fs)!=null})?Math.max(...r.body.textRuns.map(s=>{var o;return((o=s?.ts)==null?void 0:o.fs)||0})):this.getFontSizes()[0][0]:this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ss("it",r.body)===ot.TRUE?Xs.ITALIC:Xs.NORMAL:this._getFontStyles()[0][0]}_getFontStyles(){return this._getStyles("it")}getFontWeight(){var e,n;const{p:r}=(e=this.getValue())!=null?e:{};return r&&Array.isArray((n=r.body)==null?void 0:n.textRuns)&&r.body.textRuns.length>0?Ss("bl",r.body)===ot.TRUE?Js.BOLD:Js.NORMAL:this._getFontWeights()[0][0]}_getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_range:e,_worksheet:n}=this,{startRow:r,endRow:s}=e;let o=0;for(let i=0;i<=s-r;i++){const a=n.getRowHeight(i);o+=a}return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._range.endColumn}getLastRow(){return this._range.endRow}getNumColumns(){const{startColumn:e,endColumn:n}=this._range;return n-e+1}getNumRows(){const{startRow:e,endRow:n}=this._range;return n-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(n=>n?.p||""))}getRowIndex(){return this._range.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){const e=this._deps.getStyles();return this.getValues().map(n=>n.map(r=>e.getStyleByCell(r)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_range:e,_worksheet:n}=this,{startColumn:r,endColumn:s}=e;let o=0;for(let i=0;i<=s-r;i++)o+=n.getColumnWidth(i);return o}getWrap(){return this.getWrapStrategy()===Dn.WRAP?ot.TRUE:ot.FALSE}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}forEach(e){Yi.foreach(this._range,e)}_getStyles(e){const n=this._deps.getStyles();return this.getValues().map(r=>r.map(s=>{const o=n&&n.getStyleByCell(s);return o&&o[e]||le[e]}))}};_(If,"transformRange",(t,e)=>{const n=e.getMaxColumns()-1,r=e.getMaxRows()-1;return t.rangeType===gt.ALL?{startColumn:0,startRow:0,endColumn:n,endRow:r}:t.rangeType===gt.COLUMN?{startRow:0,endRow:r,startColumn:t.startColumn,endColumn:t.endColumn}:t.rangeType===gt.ROW?{startColumn:0,endColumn:n,startRow:t.startRow,endRow:t.endRow}:{startColumn:t.startColumn,endColumn:Math.min(t.endColumn,n),startRow:t.startRow,endRow:Math.min(t.endRow,r)}});let eo=If;function wf(t,e,n=0,r=t.length-1,s=xC){for(;r>n;){if(r-n>600){const l=r-n+1,u=e-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1),f=Math.max(n,Math.floor(e-u*h/l+d)),p=Math.min(r,Math.floor(e+(l-u)*h/l+d));wf(t,e,f,p,s)}const o=t[e];let i=n,a=r;for(br(t,n,e),s(t[r],o)>0&&br(t,n,r);i<a;){for(br(t,i,a),i++,a--;s(t[i],o)<0;)i++;for(;s(t[a],o)>0;)a--}s(t[n],o)===0?br(t,n,a):(a++,br(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function br(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function xC(t,e){return t<e?-1:t>e?1:0}class no{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!Os(e,n))return r;const s=this.toBBox,o=[];for(;n;){for(let i=0;i<n.children.length;i++){const a=n.children[i],l=n.leaf?s(a):a;Os(e,l)&&(n.leaf?r.push(a):ni(e,l)?this._all(a,r):o.push(a))}n=o.pop()}return r}collides(e){let n=this.data;if(!Os(e,n))return!1;const r=[];for(;n;){for(let s=0;s<n.children.length;s++){const o=n.children[s],i=n.leaf?this.toBBox(o):o;if(Os(e,i)){if(n.leaf||ni(e,i))return!0;r.push(o)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Xn([]),this}remove(e,n){if(!e)return this;let r=this.data;const s=this.toBBox(e),o=[],i=[];let a,l,u;for(;r||o.length;){if(r||(r=o.pop(),l=o[o.length-1],a=i.pop(),u=!0),r.leaf){const c=MC(e,r.children,n);if(c!==-1)return r.children.splice(c,1),o.push(r),this._condense(o),this}!u&&!r.leaf&&ni(r,s)?(o.push(r),i.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],u=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,s){const o=r-n+1;let i=this._maxEntries,a;if(o<=i)return a=Xn(e.slice(n,r+1)),Wn(a,this.toBBox),a;s||(s=Math.ceil(Math.log(o)/Math.log(i)),i=Math.ceil(o/Math.pow(i,s-1))),a=Xn([]),a.leaf=!1,a.height=s;const l=Math.ceil(o/i),u=l*Math.ceil(Math.sqrt(i));Yu(e,n,r,u,this.compareMinX);for(let c=n;c<=r;c+=u){const h=Math.min(c+u-1,r);Yu(e,c,h,l,this.compareMinY);for(let d=c;d<=h;d+=l){const f=Math.min(d+l-1,h);a.children.push(this._build(e,d,f,s-1))}}return Wn(a,this.toBBox),a}_chooseSubtree(e,n,r,s){for(;s.push(n),!(n.leaf||s.length-1===r);){let o=1/0,i=1/0,a;for(let l=0;l<n.children.length;l++){const u=n.children[l],c=ei(u),h=FC(e,u)-c;h<i?(i=h,o=c<o?c:o,a=u):h===i&&c<o&&(o=c,a=u)}n=a||n.children[0]}return n}_insert(e,n,r){const s=r?e:this.toBBox(e),o=[],i=this._chooseSubtree(s,this.data,n,o);for(i.children.push(e),kr(i,s);n>=0&&o[n].children.length>this._maxEntries;)this._split(o,n),n--;this._adjustParentBBoxes(s,o,n)}_split(e,n){const r=e[n],s=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,s);const i=this._chooseSplitIndex(r,o,s),a=Xn(r.children.splice(i,r.children.length-i));a.height=r.height,a.leaf=r.leaf,Wn(r,this.toBBox),Wn(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=Xn([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Wn(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let s,o=1/0,i=1/0;for(let a=n;a<=r-n;a++){const l=Fr(e,0,a,this.toBBox),u=Fr(e,a,r,this.toBBox),c=kC(l,u),h=ei(l)+ei(u);c<o?(o=c,s=a,i=h<i?h:i):c===o&&h<i&&(i=h,s=a)}return s||r-n}_chooseSplitAxis(e,n,r){const s=e.leaf?this.compareMinX:LC,o=e.leaf?this.compareMinY:UC,i=this._allDistMargin(e,n,r,s),a=this._allDistMargin(e,n,r,o);i<a&&e.children.sort(s)}_allDistMargin(e,n,r,s){e.children.sort(s);const o=this.toBBox,i=Fr(e,0,n,o),a=Fr(e,r-n,r,o);let l=As(i)+As(a);for(let u=n;u<r-n;u++){const c=e.children[u];kr(i,e.leaf?o(c):c),l+=As(i)}for(let u=r-n-1;u>=n;u--){const c=e.children[u];kr(a,e.leaf?o(c):c),l+=As(a)}return l}_adjustParentBBoxes(e,n,r){for(let s=r;s>=0;s--)kr(n[s],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():Wn(e[n],this.toBBox)}}function MC(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function Wn(t,e){Fr(t,0,t.children.length,e,t)}function Fr(t,e,n,r,s){s||(s=Xn(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let o=e;o<n;o++){const i=t.children[o];kr(s,t.leaf?r(i):i)}return s}function kr(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function LC(t,e){return t.minX-e.minX}function UC(t,e){return t.minY-e.minY}function ei(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function As(t){return t.maxX-t.minX+(t.maxY-t.minY)}function FC(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function kC(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,o-r)}function ni(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Os(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Xn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Yu(t,e,n,r,s){const o=[e,n];for(;o.length;){if(n=o.pop(),e=o.pop(),n-e<=r)continue;const i=e+Math.ceil((n-e)/r/2)*r;wf(t,i,e,n,s),o.push(e,i,i,n)}}function PC(t,e,n,r=!1){if(e===0&&n===0)return t;let s={...t};const o=s.startAbsoluteRefType||Ot.NONE,i=s.endAbsoluteRefType||Ot.NONE,a=s.rangeType||gt.NORMAL;if(!r&&o===Ot.ALL&&i===Ot.ALL)return s;const l=zu(s.startRow,n,s.startColumn,e,a),u=zu(s.endRow,n,s.endColumn,e,a);return r||o===Ot.NONE&&i===Ot.NONE?s={...s,startRow:l.row,startColumn:l.column,endRow:u.row,endColumn:u.column}:(o===Ot.NONE?s={...s,startRow:l.row,startColumn:l.column}:o===Ot.COLUMN?s={...s,startRow:l.row}:o===Ot.ROW&&(s={...s,startColumn:l.column}),i===Ot.NONE?s={...s,endRow:u.row,endColumn:u.column}:i===Ot.COLUMN?s={...s,endRow:u.row}:i===Ot.ROW&&(s={...s,endColumn:u.column}),s)}function zu(t,e,n,r,s){return s===gt.NORMAL?{row:t+e,column:n+r}:s===gt.ROW?{row:t+e,column:n}:s===gt.COLUMN?{row:t,column:n+r}:{row:t,column:n}}function yl(t){const e=new Set,n=new Set;for(const i of t)e.add(i.startColumn),e.add(i.endColumn+1),n.add(i.startRow),n.add(i.endRow+1);const r=Array.from(e).sort((i,a)=>i-a),s=Array.from(n).sort((i,a)=>i-a);t.sort((i,a)=>i.startRow-a.startRow||i.startColumn-a.startColumn);const o=[];for(let i=0;i<s.length-1;i++)for(let a=0;a<r.length-1;a++){const l=r[a],u=r[a+1]-1,c=s[i],h=s[i+1]-1;for(const d of t){if(d.startRow>h)break;if(d.startRow<=c&&d.endRow>=h&&d.startColumn<=l&&d.endColumn>=u){o.push({startColumn:l,endColumn:u,startRow:c,endRow:h});break}}}return o}function BC(t){t.sort((r,s)=>r.startRow-s.startRow||r.startColumn-s.startColumn);const e={};for(const r of t)e[r.startRow]||(e[r.startRow]=[]),e[r.startRow].push(r);const n=[];for(const r in e){const s=e[+r];s.sort((i,a)=>i.startColumn-a.startColumn);let o=s[0];for(let i=1;i<s.length;i++){const a=s[i];a.startColumn<=o.endColumn+1&&a.startRow===o.startRow&&a.endRow===o.endRow?o.endColumn=Math.max(o.endColumn,a.endColumn):(n.push(o),o=a)}n.push(o)}return n}function $C(t){t.sort((r,s)=>r.startColumn-s.startColumn||r.startRow-s.startRow);const e={};for(const r of t)e[r.startColumn]||(e[r.startColumn]=[]),e[r.startColumn].push(r);const n=[];for(const r in e){const s=e[+r];s.sort((i,a)=>i.startRow-a.startRow);let o=s[0];for(let i=1;i<s.length;i++){const a=s[i];a.startRow<=o.endRow+1&&a.startColumn===o.startColumn&&a.endColumn===o.endColumn?o.endRow=Math.max(o.endRow,a.endRow):(n.push(o),o=a)}n.push(o)}return n}function HC(t){const e=yl(t),n=BC(e);return $C(n)}function jC(t,e){const n=[];return t.forEach(r=>{n.push(...xn.subtract(r,e))}),xn.mergeRanges(n)}function Sf(t,e){const n=Ku(t.startRow,t.endRow,e.startRow,e.endRow),r=Ku(t.startColumn,t.endColumn,e.startColumn,e.endColumn);if(!n||!r)return null;const[s,o]=n,[i,a]=r,l=WC(t.rangeType,e.rangeType,s,o,i,a);return{startRow:s,endRow:o,startColumn:i,endColumn:a,rangeType:l}}function Ku(t,e,n,r){const s=isNaN(t)?-1/0:t,o=isNaN(e)?1/0:e,i=isNaN(n)?-1/0:n,a=isNaN(r)?1/0:r,l=Math.max(s,i),u=Math.min(o,a);if(l<=u){const c=l===-1/0?Number.NaN:l,h=u===1/0?Number.NaN:u;return[c,h]}else return null}function WC(t,e,n,r,s,o){const i=t!==void 0?t:Xu(n,r,s,o),a=e!==void 0?e:Xu(n,r,s,o);return i===gt.ALL||a===gt.ALL?i===a?i:i===gt.ALL?a:i:i===a?i:(i===gt.NORMAL||gt.NORMAL,gt.NORMAL)}function Xu(t,e,n,r){const s=!isNaN(t)&&!isNaN(e),o=!isNaN(n)&&!isNaN(r);return s&&o?gt.NORMAL:s?gt.ROW:o?gt.COLUMN:gt.ALL}const Jn=class zi{static clone(e){return e.rangeType!==void 0?{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn,rangeType:e.rangeType}:{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}static equals(e,n){return e==null||n==null?!1:e.endRow===n.endRow&&e.endColumn===n.endColumn&&e.startRow===n.startRow&&e.startColumn===n.startColumn&&(e.rangeType===n.rangeType||e.rangeType===void 0&&n.rangeType===gt.NORMAL||n.rangeType===void 0&&e.rangeType===gt.NORMAL)}static simpleRangesIntersect(e,n){const{startRow:r,endRow:s,startColumn:o,endColumn:i}=e,{startRow:a,endRow:l,startColumn:u,endColumn:c}=n,h=r<=l&&s>=a,d=o<=c&&i>=u;return h&&d}static intersects(e,n){if(e.rangeType===gt.ROW&&n.rangeType===gt.COLUMN||e.rangeType===gt.COLUMN&&n.rangeType===gt.ROW)return!0;if(e.rangeType===gt.ROW&&n.rangeType===gt.ROW)return e.startRow<=n.endRow&&e.endRow>=n.startRow;if(e.rangeType===gt.COLUMN&&n.rangeType===gt.COLUMN)return e.startColumn<=n.endColumn&&e.endColumn>=n.startColumn;const r=Number.isNaN(e.startRow)?0:e.startRow,s=Number.isNaN(e.endRow)?Vi-1:e.endRow,o=Number.isNaN(e.startColumn)?0:e.startColumn,i=Number.isNaN(e.endColumn)?Gi-1:e.endColumn,a=Number.isNaN(n.startRow)?0:n.startRow,l=Number.isNaN(n.endRow)?Vi-1:n.endRow,u=Number.isNaN(n.startColumn)?0:n.startColumn,c=Number.isNaN(n.endColumn)?Gi-1:n.endColumn,h=Math.abs(o+i-u-c),d=Math.abs(o-i)+Math.abs(u-c),f=Math.abs(r+s-a-l),p=Math.abs(r-s)+Math.abs(a-l);return h<=d&&f<=p}static doAnyRangesIntersect(e,n){const r=new no;return r.load(e.map(s=>({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}))),n.some(s=>r.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow}).length>0)}static getIntersects(e,n){const r=e.startRow,s=e.endRow,o=e.startColumn,i=e.endColumn,a=n.startRow,l=n.endRow,u=n.startColumn,c=n.endColumn;let h,d,f,p;if(a<=s)a>=r?d=a:d=r;else return null;if(l>=r)l>=s?p=s:p=l;else return null;if(u<=i)u>o?h=u:h=o;else return null;if(c>=o)c>=i?f=i:f=c;else return null;return{startRow:d,endRow:p,startColumn:h,endColumn:f,rangeType:gt.NORMAL}}static contains(e,n){return e.startRow<=n.startRow&&e.endRow>=n.endRow&&e.startColumn<=n.startColumn&&e.endColumn>=n.endColumn}static realContain(e,n){return zi.contains(e,n)&&(e.startRow<n.startRow||e.endRow>n.endRow||e.startColumn<n.startColumn||e.endColumn>n.endColumn)}static union(...e){return e.reduce((n,r)=>({startRow:Math.min(n.startRow,r.startRow),startColumn:Math.min(n.startColumn,r.startColumn),endRow:Math.max(n.endRow,r.endRow),endColumn:Math.max(n.endColumn,r.endColumn),rangeType:gt.NORMAL}),e[0])}static realUnion(...e){const n=e.some(o=>o.rangeType===gt.COLUMN),r=e.some(o=>o.rangeType===gt.ROW),s=zi.union(...e);return{startColumn:r?Number.NaN:s.startColumn,endColumn:r?Number.NaN:s.endColumn,startRow:n?Number.NaN:s.startRow,endRow:n?Number.NaN:s.endRow,rangeType:r?gt.ROW:n?gt.COLUMN:gt.NORMAL}}static subtract(e,n){if(n.startRow>e.endRow||n.endRow<e.startRow||n.startColumn>e.endColumn||n.endColumn<e.startColumn)return[e];const r=[];n.startRow>=e.startRow&&r.push({startRow:e.startRow,startColumn:e.startColumn,endRow:n.startRow-1,endColumn:e.endColumn}),n.endRow<=e.endRow&&r.push({startRow:n.endRow+1,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn});const s=Math.max(e.startRow,n.startRow),o=Math.min(e.endRow,n.endRow);return n.startColumn>=e.startColumn&&r.push({startRow:s,startColumn:e.startColumn,endRow:o,endColumn:n.startColumn-1}),n.endColumn<=e.endColumn&&r.push({startRow:s,startColumn:n.endColumn+1,endRow:o,endColumn:e.endColumn}),r.filter(i=>i.startRow<=i.endRow&&i.startColumn<=i.endColumn)}static mergeRanges(e){return HC(e)}static splitIntoGrid(e){return yl(e)}static subtractMulti(e,n){if(!n.length)return e;let r=e;return n.forEach(s=>{r=jC(r,s)}),r}static hasIntersectionBetweenTwoRect(e,n){return!(e.left>n.right||e.right<n.left||e.top>n.bottom||e.bottom<n.top)}static getIntersectionBetweenTwoRect(e,n){const r=Math.max(e.left,n.left),s=Math.min(e.right,n.right),o=Math.max(e.top,n.top),i=Math.min(e.bottom,n.bottom);return s<=r||i<=o?null:{left:r,right:s,top:o,bottom:i,width:s-r,height:i-o}}static sort(e){return e.sort((n,r)=>n.startRow-r.startRow||n.startColumn-r.startColumn)}};_(Jn,"getRelativeRange",(t,e)=>({startRow:t.startRow-e.startRow,endRow:t.endRow-t.startRow,startColumn:t.startColumn-e.startColumn,endColumn:t.endColumn-t.startColumn})),_(Jn,"getPositionRange",(t,e,n)=>({...n||{},startRow:n&&[Ot.ROW,Ot.ALL].includes(n.startAbsoluteRefType||0)?n.startRow:t.startRow+e.startRow,endRow:n&&[Ot.ROW,Ot.ALL].includes(n.endAbsoluteRefType||0)?n.endRow:t.endRow+t.startRow+e.startRow,startColumn:n&&[Ot.COLUMN,Ot.ALL].includes(n.startAbsoluteRefType||0)?n.startColumn:t.startColumn+e.startColumn,endColumn:n&&[Ot.COLUMN,Ot.ALL].includes(n.endAbsoluteRefType||0)?n.endColumn:t.endColumn+t.startColumn+e.startColumn})),_(Jn,"moveHorizontal",(t,e=0,n=0)=>({...t,startColumn:t.startColumn+e,endColumn:t.endColumn+e+n})),_(Jn,"moveVertical",(t,e=0,n=0)=>({...t,startRow:t.startRow+e,endRow:t.endRow+e+n})),_(Jn,"moveOffset",(t,e,n)=>{const r={...t};switch(t.startAbsoluteRefType){case Ot.ROW:r.startColumn+=e;break;case Ot.COLUMN:r.startRow+=n;break;case Ot.ALL:break;case Ot.NONE:default:r.startRow+=n,r.startColumn+=e;break}switch(t.endAbsoluteRefType){case Ot.ROW:r.endColumn+=e;break;case Ot.COLUMN:r.endRow+=n;break;case Ot.ALL:break;case Ot.NONE:default:r.endRow+=n,r.endColumn+=e;break}return r});let xn=Jn;function VC(t,e){if(t.length===0||t[0].length===0)return null;const n=new Array(t[0].length).fill(0);let r=0,s=null;for(let o=0;o<t.length;o++){for(let a=0;a<t[0].length;a++)n[a]=e(t[o][a])?n[a]+1:0;const i=GC(n);i.area>r&&(r=i.area,s={startColumn:i.start,startRow:o-i.height+1,endColumn:i.end,endRow:o})}return s}function GC(t){const e=[];let n=0,r={area:0,height:0,start:0,end:0},s=0;for(;s<t.length;)if(e.length===0||t[s]>=t[e[e.length-1]])e.push(s++);else{const o=t[e.pop()],i=e.length===0?s:s-e[e.length-1]-1;o*i>n&&(n=o*i,r={area:n,height:o,start:e.length===0?0:e[e.length-1]+1,end:s-1})}for(;e.length>0;){const o=t[e.pop()],i=e.length===0?s:s-e[e.length-1]-1;o*i>n&&(n=o*i,r={area:n,height:o,start:e.length===0?0:e[e.length-1]+1,end:s-1})}return r}function YC(t,e){eo.foreach(e,(n,r)=>{t[n][r]=void 0})}function zC(t,e){const n=t.toFullArray(),r=[];for(;;){const s=VC(n,e);if(!s)break;r.push(s),YC(n,s)}return r}class KC{constructor(e,n){_(this,"_values",[]),_(this,"_keys",[]),_(this,"_keyMaps",new Map),this._values=e,this._keys=n,e.forEach(r=>{this._initKeyMap(r)})}_initKeyMap(e){this._keys.forEach(n=>{const r=e[n],s=this._keyMaps.get(n)||new Map;s.set(r,e),this._keyMaps.set(n,s)})}getValue(e,n){const r=n||this._keys;for(let s=0;s<r.length;s++){const o=this._keyMaps.get(r[s]);if(o!=null&&o.has(e))return o.get(e)}return null}hasValue(e){for(let n=0;n<this._keys.length;n++){const r=this._keyMaps.get(this._keys[n]);if(r!=null&&r.has(e))return!0}return!1}addValue(e){this._values.push(e),this._initKeyMap(e)}setValue(e,n,r){const s=this.getValue(e);s&&Object.keys(s).includes(n)&&(s[n]=r)}deleteValue(e,n){const r=this.getValue(e,n);if(r){this._keys.forEach(o=>{const i=this._keyMaps.get(o),a=r[o];i?.delete(a)});const s=this._values.findIndex(o=>o===r);this._values.splice(s,1)}}getValues(){return this._values}getKeyMap(e){var n;return[...((n=this._keyMaps.get(e))==null?void 0:n.keys())||[]]}clear(){this._values=[],this._keys=[],this._keyMaps.clear()}}function Ki(t,e,n,r){return{forEach(s){for(let o=t;o<=e;o++)for(let i=n;i<=r;i++)s(o,i)}}}function XC(t){if(t==null||t.length===0)return Number.NaN;const e=t.toLowerCase().split(""),n=e.length,r=i=>i.charCodeAt(0)-96;let s=0,o=0;for(let i=0;i<n;i++)o=r(e[i]),s+=o*26**(n-i-1);return s===0?Number.NaN:s-1}const ro=65,Af=90,JC=97;function QC(t){const e=Af-ro+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+ro)+n,t=Math.floor(t/e)-1;return n}function Of(t,e){let n="";for(;e>0;)n+=t,e--;return n}function qC(t,e=!1){const n=Af-ro+1;let r=JC;e&&(r=ro);const s=String.fromCharCode(t%n+r),o=Math.floor(t/n)+1;return Of(s,o)}function ZC(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function tR(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}function us(t="index",e=1){return(n,r)=>n[t]>r[t]?e:n[t]===r[t]?0:-e}function cs(t,e=!1){const n=[];for(const r of t){const{st:s,ed:o,ts:i}=r;if(r.sId===void 0&&delete r.sId,s===o||!e&&q.isEmptyObject(i)&&r.sId==null)continue;if(n.length===0){n.push(r);continue}const a=n.pop();_f(r,a)&&q.hasIntersectionBetweenTwoRanges(a.st,a.ed,r.st,r.ed)?n.push({...r,st:a.st,ed:o}):n.push(a,r)}return n}function Df(t,e,n,r){var s;const{textRuns:o}=t;if(o==null)return;const i=[],a=o.length;let l=!1;const u=(s=e.textRuns)!=null?s:[];if(u.length)for(const c of u)c.st+=r,c.ed+=r;for(let c=0;c<a;c++){const h=o[c],{st:d,ed:f}=h;if(f<=r)i.push(h);else if(r>d&&r<f){l=!0;const p={...h,ed:r};i.push(p),u.length&&i.push(...u);const m={...h,st:r+n,ed:f+n};i.push(m)}else h.st+=n,h.ed+=n,l||(l=!0,i.push(...u)),i.push(h)}l||(l=!0,i.push(...u)),t.textRuns=cs(i)}function Nf(t,e,n,r){const{paragraphs:s}=t;if(s==null)return;const{paragraphs:o}=e,i=[];for(let l=0,u=s.length;l<u;l++){const c=s[l],{startIndex:h}=c;h>=r&&(c.startIndex+=n),i.push(c.startIndex)}let a=-1;if(o){for(let l=0,u=o.length;l<u;l++){const c=o[l];c.startIndex+=r;const h=c.startIndex;a=i.indexOf(h)}a!==-1&&s.splice(a,1),s.push(...o),s.sort(us("startIndex"))}}function xf(t,e,n,r){const{sectionBreaks:s}=t;if(s==null)return;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.sectionBreaks;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r}s.push(...o),s.sort(us("startIndex"))}}function Mf(t,e,n,r){const{customBlocks:s=[]}=t;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n)}const o=e.customBlocks;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r}s.push(...o),s.sort(us("startIndex"))}s.length&&!t.customBlocks&&(t.customBlocks=s)}function Lf(t,e,n,r){const{tables:s}=t;if(s==null)return;for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u,endIndex:c}=l;u>r?(l.startIndex+=n,l.endIndex+=n):c>r&&(l.endIndex+=n)}const o=e.tables;if(o){for(let i=0,a=o.length;i<a;i++){const l=o[i];l.startIndex+=r,l.endIndex+=r}s.push(...o),s.sort(us("startIndex"))}}const Uf="$",Ju=t=>t.split(Uf)[0];function El(t){if(t.length<=1)return t;t.sort((s,o)=>s.startIndex-o.startIndex);const e=[];let n={...t[0]};n.rangeId=Ju(n.rangeId);for(let s=1;s<t.length;s++){const o=t[s];o.rangeId=Ju(o.rangeId),o.rangeId===n.rangeId&&Zc(n.properties,o.properties)&&n.endIndex+1>=o.startIndex?n.endIndex=o.endIndex:(e.push(n),n={...o})}e.push(n);const r=Object.create(null);for(let s=0,o=e.length;s<o;s++){const i=e[s],a=i.rangeId;r[a]?(i.rangeId=`${a}${Uf}${r[a]}`,r[a]=r[a]+1):r[a]=1}return e}function Xi(t,e){const n=t.findIndex(s=>s.startIndex<e&&s.endIndex>=e),r=t[n];r&&t.splice(n,1,{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:r.startIndex,endIndex:e-1,properties:{...r.properties}},{rangeId:r.rangeId,rangeType:r.rangeType,startIndex:e,endIndex:r.endIndex,properties:{...r.properties}})}function Ff(t){if(t.length<=1)return t;t.sort((r,s)=>r.startIndex-s.startIndex);const e=[];let n={...t[0]};for(let r=1;r<t.length;r++){const s=t[r];s.id===n.id&&n.endIndex+1>=s.startIndex?n.endIndex=s.endIndex:(e.push(n),n={...s})}return e.push(n),e}function Ji(t,e){t.filter(n=>n.startIndex<e&&n.endIndex>=e).forEach(n=>{const r=t.indexOf(n);t.splice(r,1,{id:n.id,type:n.type,startIndex:n.startIndex,endIndex:e-1},{id:n.id,type:n.type,startIndex:e,endIndex:n.endIndex})})}function eR(t,e,n,r){t.customRanges||(t.customRanges=[]);const{customRanges:s}=t;Xi(s,r);for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const o=[];if(e.customRanges){for(let i=0,a=e.customRanges.length;i<a;i++){const l=e.customRanges[i];l.startIndex+=r,l.endIndex+=r,o.push(l)}s.push(...o)}t.customRanges=El(s)}function nR(t,e,n,r){t.customDecorations||(t.customDecorations=[]);const{customDecorations:s}=t;Ji(s,r);for(let i=0,a=s.length;i<a;i++){const l=s[i],{startIndex:u}=l;u>=r&&(l.startIndex+=n,l.endIndex+=n)}const o=[];if(e.customDecorations){for(let i=0,a=e.customDecorations.length;i<a;i++){const l=e.customDecorations[i];l.startIndex+=r,l.endIndex+=r,o.push(l)}s.push(...o)}t.customDecorations=Ff(s)}function kf(t,e,n){const{textRuns:r}=t,s=n,o=n+e,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{st:h,ed:d}=c;if(s<=h&&o>=d){i.push({...c,st:h-s,ed:d-s});continue}else h<=s&&d>=o?(i.push({...c,st:s-s,ed:o-s}),c.ed-=e):s>=h&&s<d?(i.push({...c,st:s-s,ed:d-s}),c.ed=s):o>h&&o<=d?(i.push({...c,st:h-s,ed:o-s}),c.st=o-e,c.ed-=e):h>=o&&(c.st-=e,c.ed-=e);a.push(c)}t.textRuns=a}return i.length===0&&i.push({st:0,ed:e,ts:{}}),i}function Pf(t,e,n){const{paragraphs:r}=t,s=n,o=n+e,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<o){i.push({...c,startIndex:h-n});continue}else h>=o&&(c.startIndex-=e);a.push(c)}t.paragraphs=a}return i}function Bf(t,e,n){const{sectionBreaks:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<=o){i.push({...c,startIndex:h-n});continue}else h>o&&(c.startIndex-=e);a.push(c)}t.sectionBreaks=a}return i}function $f(t,e,n){const{customBlocks:r=[]}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h}=c;if(h>=s&&h<=o){i.push({...c,startIndex:h-n});continue}else h>o&&(c.startIndex-=e);a.push(c)}t.customBlocks=a}return r.length&&!t.customBlocks&&(t.customBlocks=r),i}function Hf(t,e,n){const{tables:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h,endIndex:d}=c;if(s<=h&&o>=d){i.push({...c,startIndex:h-n,endIndex:d-n});continue}else if(h<=s&&d>=o){const f=xo(h,d,s,o);if(f.length===0||(c.startIndex=f[0],c.endIndex=f[1],c.startIndex===c.endIndex))continue}else o<h&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.tables=a}return i}function rR(t,e,n){const{customRanges:r}=t,s=n,o=n+e-1,i=[];if(r){const a=[];for(let l=0,u=r.length;l<u;l++){const c=r[l],{startIndex:h,endIndex:d}=c;if(h>=s&&d<=o){i.push(c);continue}else if(Math.max(s,h)<=Math.min(o,d)){const f=xo(h,d,s,o);if(f.length===0)continue;c.startIndex=f[0],c.endIndex=f[1]}else o<h&&(c.startIndex-=e,c.endIndex-=e);a.push(c)}t.customRanges=El(a)}return i}function sR(t,e,n,r=!0){const{customDecorations:s}=t,o=n,i=n+e-1,a=[];if(s){const l=[];for(let u=0,c=s.length;u<c;u++){const h=s[u],{startIndex:d,endIndex:f}=h;if(d>=o&&f<=i){a.push(h);continue}else if(Math.max(o,d)<=Math.min(i,f)){const p=xo(d,f,o,i);if(p.length===0)continue;h.startIndex=p[0],h.endIndex=p[1]}else i<d&&r&&(h.startIndex-=e,h.endIndex-=e);l.push(h)}t.customDecorations=l}return a}var jf=(t=>(t.ORDER_LIST_QUICK_1="1.",t.ORDER_LIST_QUICK_2="a)",t.ORDER_LIST_QUICK_3="a.",t.ORDER_LIST_QUICK_4="i.",t.ORDER_LIST_QUICK_5="A.",t.ORDER_LIST_QUICK_6="I.",t.ORDER_LIST_QUICK_7="01.",t.BULLET_LIST="*",t))(jf||{}),Ye=(t=>(t.BULLET_LIST="BULLET_LIST",t.BULLET_LIST_1="BULLET_LIST_1",t.BULLET_LIST_2="BULLET_LIST_2",t.BULLET_LIST_3="BULLET_LIST_3",t.BULLET_LIST_4="BULLET_LIST_4",t.BULLET_LIST_5="BULLET_LIST_5",t.ORDER_LIST="ORDER_LIST",t.ORDER_LIST_1="ORDER_LIST_1",t.ORDER_LIST_2="ORDER_LIST_2",t.ORDER_LIST_3="ORDER_LIST_3",t.ORDER_LIST_4="ORDER_LIST_4",t.ORDER_LIST_5="ORDER_LIST_5",t.ORDER_LIST_QUICK_2="ORDER_LIST_QUICK_2",t.ORDER_LIST_QUICK_3="ORDER_LIST_QUICK_3",t.ORDER_LIST_QUICK_4="ORDER_LIST_QUICK_4",t.ORDER_LIST_QUICK_5="ORDER_LIST_QUICK_5",t.ORDER_LIST_QUICK_6="ORDER_LIST_QUICK_6",t.CHECK_LIST="CHECK_LIST",t.CHECK_LIST_CHECKED="CHECK_LIST_CHECKED",t))(Ye||{});const Ds={"a)":{glyphFormat:"%1)",glyphType:dt.DECIMAL},"1.":{glyphType:dt.DECIMAL},"a.":{glyphFormat:"%1.",glyphType:dt.LOWER_LETTER},"A.":{glyphType:dt.UPPER_LETTER},"i.":{glyphFormat:"%1.",glyphType:dt.LOWER_ROMAN},"I.":{glyphFormat:"%1.",glyphType:dt.UPPER_LETTER}},Vn=t=>[...t,...t,...t].map((e,n)=>({glyphFormat:` %${n+1}`,glyphSymbol:e,bulletAlignment:os.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),Gn=t=>t.map((e,n)=>({...e,bulletAlignment:os.START,textStyle:{fs:12},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*n}}})),Qu=(t,e)=>new Array(9).fill(0).map((n,r)=>({glyphFormat:` %${r+1}`,glyphSymbol:t,bulletAlignment:os.START,textStyle:{fs:16},startNumber:0,paragraphProperties:{hanging:{v:21},indentStart:{v:21*r},textStyle:e}})),hs={BULLET_LIST:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},BULLET_LIST_1:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},BULLET_LIST_2:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},BULLET_LIST_3:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},BULLET_LIST_4:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},BULLET_LIST_5:{listType:"BULLET_LIST",nestingLevel:Vn(["","",""])},ORDER_LIST:{listType:"ORDER_LIST",nestingLevel:Gn([{glyphFormat:"%1.",glyphType:dt.DECIMAL},{glyphFormat:"%2.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%3.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:dt.DECIMAL},{glyphFormat:"%5.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%6.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:dt.DECIMAL},{glyphFormat:"%8.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%9.",glyphType:dt.LOWER_ROMAN}])},ORDER_LIST_1:{listType:"ORDER_LIST",nestingLevel:Gn([{glyphFormat:"%1)",glyphType:dt.DECIMAL},{glyphFormat:"%2)",glyphType:dt.LOWER_LETTER},{glyphFormat:"%3)",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%4)",glyphType:dt.DECIMAL},{glyphFormat:"%5)",glyphType:dt.LOWER_LETTER},{glyphFormat:"%6)",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%7)",glyphType:dt.DECIMAL},{glyphFormat:"%8)",glyphType:dt.LOWER_LETTER},{glyphFormat:"%9)",glyphType:dt.LOWER_ROMAN}])},ORDER_LIST_2:{listType:"ORDER_LIST",nestingLevel:Gn(["%1.","%1.%2.","%1.%2.%3.","%1.%2.%3.%4.","%1.%2.%3.%4.%5.","%1.%2.%3.%4.%5.%6.","%1.%2.%3.%4.%5.%6.%7."].map(t=>({glyphFormat:t,glyphType:dt.DECIMAL})))},ORDER_LIST_3:{listType:"ORDER_LIST",nestingLevel:Gn([{glyphFormat:"%1.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%2.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%3.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%5.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%6.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%8.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%9.",glyphType:dt.LOWER_ROMAN}])},ORDER_LIST_4:{listType:"ORDER_LIST",nestingLevel:Gn([{glyphFormat:"%1.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%2.",glyphType:dt.DECIMAL},{glyphFormat:"%3.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%5.",glyphType:dt.DECIMAL},{glyphFormat:"%6.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:dt.UPPER_LETTER},{glyphFormat:"%8.",glyphType:dt.DECIMAL},{glyphFormat:"%9.",glyphType:dt.LOWER_ROMAN}])},ORDER_LIST_5:{listType:"ORDER_LIST",nestingLevel:Gn([{glyphFormat:"%1.",glyphType:dt.DECIMAL_ZERO},{glyphFormat:"%2.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%3.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%4.",glyphType:dt.DECIMAL_ZERO},{glyphFormat:"%5.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%6.",glyphType:dt.LOWER_ROMAN},{glyphFormat:"%7.",glyphType:dt.DECIMAL_ZERO},{glyphFormat:"%8.",glyphType:dt.LOWER_LETTER},{glyphFormat:"%9.",glyphType:dt.LOWER_ROMAN}])},CHECK_LIST:{listType:"CHECK_LIST",nestingLevel:Qu("")},CHECK_LIST_CHECKED:{listType:"CHECK_LIST_CHECKED",nestingLevel:Qu("",{st:{s:ot.TRUE}})}},Ns=t=>{const{glyphFormat:e,glyphType:n}=t,r=q.deepClone(hs.ORDER_LIST);return r.nestingLevel[0].glyphFormat=e,r.nestingLevel[0].glyphType=n,r},oR={ORDER_LIST_QUICK_2:Ns(Ds["a)"]),ORDER_LIST_QUICK_3:Ns(Ds["a."]),ORDER_LIST_QUICK_4:Ns(Ds["i."]),ORDER_LIST_QUICK_6:Ns(Ds["I."])};Object.assign(hs,oR);const iR={"1.":"ORDER_LIST","a)":"ORDER_LIST_QUICK_2","a.":"ORDER_LIST_QUICK_3","i.":"ORDER_LIST_QUICK_4","A.":"ORDER_LIST_3","I.":"ORDER_LIST_QUICK_6","01.":"ORDER_LIST_5","*":"BULLET_LIST"};function aR(t,e,n,r,s){const o=lR(t,e,n,r,s),i=uR(t,e,n,r,s),a=cR(t,e,n,r,s),l=hR(t,e,n,r,s),u=dR(t,e,n,r,s),c=fR(t,e,n,r),h=pR(t,e,n,r,s);return{dataStream:"",textRuns:o,paragraphs:i,sectionBreaks:a,customBlocks:l,tables:u,customRanges:c,customDecorations:h}}function lR(t,e,n,r,s){const{textRuns:o}=t,{textRuns:i}=e;if(o==null||i==null)return;const a=kf(t,n,r);if(s!==_t.REPLACE){const l=Wf(i,a,s);e.textRuns=l}return Df(t,e,n,r),a}function Wf(t,e,n){if(e.length===0)return t;t=q.deepClone(t),e=q.deepClone(e);const r=[],s=t.length,o=e.length;let i=0,a=0,l=null;function u(){return l?(r.push(l),l=null,!0):!1}for(;i<s&&a<o;){const{st:f,ed:p,ts:m}=t[i],{st:R,ed:S,ts:P,sId:k}=e[a];let H;if(n===_t.COVER?H={...P,...m}:H={...m},p<R)u()||r.push(t[i]),i++;else if(S<f)u()||r.push(e[a]),a++;else{const C={st:Math.min(f,R),ed:Math.max(f,R),ts:f<R?{...m}:{...P},sId:f<R?void 0:k};C.ed>C.st&&r.push(C),r.push({st:Math.max(f,R),ed:Math.min(p,S),ts:H,sId:k}),p<S?(i++,e[a].st=p,e[a].st===e[a].ed&&a++):(a++,t[i].st=S,t[i].st===t[i].ed&&i++);const b={st:Math.min(p,S),ed:Math.max(p,S),ts:p<S?{...P}:{...m},sId:p<S?k:void 0};l=b.ed>b.st?b:null}}u();const c=r[r.length-1],h=t[s-1],d=e[o-1];return c&&c.ed!==Math.max(h.ed,d.ed)&&(h.ed>d.ed?r.push(h):r.push(d)),cs(r)}function uR(t,e,n,r,s){const{paragraphs:o}=t,{paragraphs:i}=e;if(o==null||i==null)return;const a=Pf(t,n,r);if(s!==_t.REPLACE){const l=[];for(const u of i){const{startIndex:c,paragraphStyle:h,bullet:d}=u;let f=[];for(const p of a){const{startIndex:m,paragraphStyle:R,bullet:S}=p;let P,k;if(s===_t.COVER?(P={...R,...h},k={listId:"",listType:Ye.BULLET_LIST,nestingLevel:0,textStyle:{},...S,...d}):(P={...h,...R},k={listId:"",listType:Ye.BULLET_LIST,nestingLevel:0,textStyle:{},...d,...S}),c===m){f.push({startIndex:c,paragraphStyle:P,bullet:k});break}}l.push(...f),f=[]}e.paragraphs=l}return Nf(t,e,n,r),a}function cR(t,e,n,r,s){const{sectionBreaks:o}=t,{sectionBreaks:i}=e;if(o==null||i==null)return;const a=Bf(t,n,r);if(s!==_t.REPLACE){const l=[];for(const u of i){const{startIndex:c}=u;let h=[];for(const d of a){const{startIndex:f}=d;if(c===f){s===_t.COVER?h.push({...d,...u}):h.push({...u,...d});break}}l.push(...h),h=[]}e.sectionBreaks=l}return xf(t,e,n,r),a}function hR(t,e,n,r,s){const{customBlocks:o=[]}=t,{customBlocks:i}=e;if(o==null||i==null)return;const a=$f(t,n,r);if(s!==_t.REPLACE){const l=[];for(const u of i){const{startIndex:c}=u;let h=[];for(const d of a){const{startIndex:f}=d;if(c===f){s===_t.COVER?h.push({...d,...u}):h.push({...u,...d});break}}l.push(...h),h=[]}e.customBlocks=l}return Mf(t,e,n,r),o.length&&!t.customBlocks&&(t.customBlocks=o),a}function dR(t,e,n,r,s){const{tables:o}=t,{tables:i}=e;if(o==null||i==null)return;const a=Hf(t,n,r);if(s!==_t.REPLACE){const l=[];for(const u of i){const{startIndex:c,endIndex:h}=u;let d=[];for(const f of a){const{startIndex:p,endIndex:m}=f;if(p>=c&&m<=h){s===_t.COVER?d.push({...f,...u}):d.push({...u,...f});break}}l.push(...d),d=[]}e.tables=l}return Lf(t,e,n,r),a}function fR(t,e,n,r,s){t.customRanges||(t.customRanges=[]),Xi(t.customRanges,r),Xi(t.customRanges,r+n);const o=r,i=r+n-1,{customRanges:a}=e,l=[],u=new Map;t.customRanges.forEach(h=>{const{startIndex:d,endIndex:f}=h;d>=o&&f<=i?u.set(h.rangeId,h):l.push(h)});const c=[];return a?(a.forEach(h=>{const{startIndex:d,endIndex:f}=h;l.push({...h,startIndex:d+r,endIndex:f+r})}),t.customRanges=El(l),c):[]}function pR(t,e,n,r,s){t.customDecorations||(t.customDecorations=[]),Ji(t.customDecorations,r),Ji(t.customDecorations,r+n);const o=[],{customDecorations:i}=t,{customDecorations:a=[]}=e;if(s===_t.REPLACE){for(let l=0;l<i.length;l++){const u=i[l],{startIndex:c,endIndex:h}=u;c>=r&&h<=r+n-1&&o.push(u)}a.forEach(l=>{const{startIndex:u,endIndex:c}=l;i.push({...l,startIndex:u+r,endIndex:c+r})})}else for(const l of a){const{id:u}=l;if(l.type===wn.DELETED){const c=i.filter(h=>h.id===u);c.length&&o.push(...c)}else i.push({...l,startIndex:l.startIndex+r,endIndex:l.endIndex+r})}for(const l of o){const{id:u}=l,c=i.findIndex(h=>h.id===u);c!==-1&&i.splice(c,1)}return t.customDecorations=Ff(i),o}var vl=(t=>(t[t.copy=0]="copy",t[t.cut=1]="cut",t))(vl||{});function so(t,e,n,r=!0){const{textRuns:s}=t;if(s){const o=[];for(const i of s){const a=q.deepClone(i),{st:l,ed:u}=a;q.hasIntersectionBetweenTwoRanges(l,u,e,n)&&(e>=l&&e<=u?o.push({...a,st:e,ed:Math.min(n,u)}):n>=l&&n<=u?o.push({...a,st:Math.max(e,l),ed:n}):o.push(a))}return cs(o.map(i=>{const{st:a,ed:l}=i;return{...i,st:a-e,ed:l-e}}))}else if(r)return[{st:0,ed:n-e,ts:{}}]}function Vf(t,e,n){const{tables:r=[]}=t,s=[];for(const o of r){const i=q.deepClone(o),{startIndex:a,endIndex:l}=i;a>=e&&l<=n&&s.push({...i,startIndex:a-e,endIndex:l-e})}return s}function Gf(t,e,n){const{paragraphs:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;if(i>=e&&i<n){const a=q.deepClone(o);s.push(a)}}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function gR(t,e,n){const{sectionBreaks:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;i>=e&&i<=n&&s.push(q.deepClone(o))}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function Yf(t,e,n){const{customBlocks:r=[]}=t,s=[];for(const o of r){const{startIndex:i}=o;i>=e&&i<n&&s.push(q.deepClone(o))}if(s.length)return s.map(o=>({...o,startIndex:o.startIndex-e}))}function ke(t,e,n,r=!0,s=1){const{dataStream:o}=t,i={dataStream:o.slice(e,n)};i.textRuns=so(t,e,n,r);const a=Vf(t,e,n);if(a.length&&(i.tables=a),i.paragraphs=Gf(t,e,n),s===1){const u=Kf(t,e,n);u?i.customDecorations=u:r&&(i.customDecorations=[])}const{customRanges:l}=zf(t,e,n);return l?i.customRanges=l:r&&(i.customRanges=[]),i.customBlocks=Yf(t,e,n),i}function mR(t){const{dataStream:e,textRuns:n,paragraphs:r,customRanges:s,customDecorations:o,tables:i}=t;let a=0,l=0;s?.forEach(c=>{c.startIndex<0&&(a=Math.max(a,-c.startIndex)),c.endIndex>e.length-1&&(l=Math.max(l,c.endIndex-e.length+1))});const u=`${e}`;return n&&(n[0]&&(n[0].st=n[0].st-a),n[n.length-1]&&(n[n.length-1].ed=n[n.length-1].ed+l)),n?.forEach(c=>{c.st+=a,c.ed+=a}),r?.forEach(c=>{c.startIndex+=a}),s?.forEach(c=>{c.startIndex+=a,c.endIndex+=a}),o?.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),i?.forEach(c=>{c.startIndex+=a,c.endIndex+=l}),{...t,dataStream:u,textRuns:n,paragraphs:r,customRanges:s,customDecorations:o,tables:i}}function zf(t,e,n){if(t.customRanges==null)return{};const{customRanges:r}=t;return{customRanges:r.filter(s=>Math.max(s.startIndex,e)<=Math.min(s.endIndex,n-1)).map(s=>({...s,startIndex:Math.max(s.startIndex,e),endIndex:Math.min(s.endIndex,n-1)})).map(s=>({...s,startIndex:s.startIndex-e,endIndex:s.endIndex-e})),leftOffset:0,rightOffset:0}}function Kf(t,e,n){if(t.customDecorations==null)return;const{customDecorations:r=[]}=t,s=[];return r.forEach(o=>{if(Math.max(o.startIndex,e)<=Math.min(o.endIndex,n-1)){const i=q.deepClone(o);s.push({...i,startIndex:Math.max(i.startIndex-e,0),endIndex:Math.min(i.endIndex,n-1)-e})}}),s}function _R(t,e,n){return t==null||e==null?t??e:Wf(t,e,n)}function yR(t,e,n){if(t==null||e==null)return t??e;if(e.length===0||t.length===0)return t;if(e.length>1||t.length>1)throw new Error("Cannot cover multiple customRanges");return n===_t.REPLACE?[{...t[0]}]:[{...e[0],...t[0]}]}function ER(t,e,n){return e.length===0||t.length===0||n===_t.REPLACE?t:[...t,...e.filter(r=>!t.some(s=>r.id===s.id))]}function Qi(t,e,n=_t.COVER){if(e.dataStream!=="")throw new Error("Cannot compose other body with non-empty dataStream");const r={dataStream:t.dataStream},{textRuns:s,paragraphs:o=[],customRanges:i,customDecorations:a=[]}=t,{textRuns:l,paragraphs:u=[],customRanges:c,customDecorations:h=[]}=e;r.textRuns=_R(l,s,n),r.customRanges=yR(c,i,n);const d=ER(h,a,n);d.length&&(r.customDecorations=d);const f=[];let p=0,m=0;for(;p<o.length&&m<u.length;){const R=o[p],S=u[m],{startIndex:P}=R,{startIndex:k}=S;P===k?(f.push(q.deepMerge(R,S)),p++,m++):P<k?(f.push(q.deepClone(R)),p++):(f.push(q.deepClone(S)),m++)}return p<o.length&&f.push(...o.slice(p)),m<u.length&&f.push(...u.slice(m)),f.length&&(r.paragraphs=f),r}function vR(t){const{body:e}=t;if(e==null)return!0;const{textRuns:n,paragraphs:r,customRanges:s,customBlocks:o,customDecorations:i,tables:a}=e;return n==null&&r==null&&s==null&&o==null&&i==null&&a==null}class Qn{constructor(e){_(this,"_index",0),_(this,"_offset",0),this._actions=e}hasNext(){return this.peekLength()<Number.POSITIVE_INFINITY}next(e){e||(e=Number.POSITIVE_INFINITY);const n=this._actions[this._index];if(n){const r=this._offset,s=n.len;return e>=s-r?(e=s-r,this._index+=1,this._offset=0):this._offset+=e,n.t===J.DELETE||n.t===J.RETAIN&&n.body==null?q.deepClone({...n,len:e}):q.deepClone({...n,len:e,body:ke(n.body,r,r+e,!1)})}else return{t:J.RETAIN,len:Number.POSITIVE_INFINITY}}peek(){return this._actions[this._index]}peekLength(){return this._actions[this._index]?this._actions[this._index].len-this._offset:Number.POSITIVE_INFINITY}peekType(){const e=this._actions[this._index];return e?e.t:J.RETAIN}rest(){if(this.hasNext()){if(this._offset===0)return this._actions.slice(this._index);{const e=this._offset,n=this._index,r=this.next(),s=this._actions.slice(this._index);return this._offset=e,this._index=n,[r].concat(s)}}else return[]}}function Xf(t,e,n){const{dataStream:r}=t,s=n,o=n+e,i=kf(t,e,n),a=Pf(t,e,n),l=Bf(t,e,n),u=$f(t,e,n),c=Hf(t,e,n),h=rR(t,e,n),d=sR(t,e,n);let f="";return r&&(t.dataStream=vf(r,s,o),f=r.slice(s,o)),{dataStream:f,textRuns:i,paragraphs:a,sectionBreaks:l,customBlocks:u,tables:c,customRanges:h,customDecorations:d}}function Jf(t,e,n,r){t.dataStream=Ef(t.dataStream,r,e.dataStream),Df(t,e,n,r),Nf(t,e,n,r),xf(t,e,n,r),Mf(t,e,n,r),Lf(t,e,n,r),eR(t,e,n,r),nR(t,e,n,r)}function CR(t,e,n,r,s=_t.COVER){return aR(t,e,n,r,s)}function RR(t,e,n){return e<=0?{dataStream:""}:Xf(t,e,n)}function bR(t,e,n,r){n!==0&&Jf(t,e,n,r)}function TR(t,e){const n=new kn;return n.reset(),e.forEach(r=>{const s=q.deepClone(r);switch(s.t){case J.RETAIN:{const{coverType:o,body:i,len:a}=s;i!=null&&CR(t,i,a,n.cursor,o),n.moveCursor(a);break}case J.INSERT:{const{body:o,len:i}=s;bR(t,o,i,n.cursor),n.moveCursor(i);break}case J.DELETE:{const{len:o}=s;RR(t,o,n.cursor);break}default:throw new Error(`Unknown action type for action: ${s}.`)}}),t}function IR(t,e,n,r,s){if(t==null||e==null)return e;if(t.length===0||e.length===0)return[];e=q.deepClone(e),t=q.deepClone(t);const o=[],i=e.length,a=t.length;let l=0,u=0,c=null;function h(){return c?(o.push(c),c=null,!0):!1}for(;l<i&&u<a;){const{st:m,ed:R,ts:S}=e[l],{st:P,ed:k,ts:H,sId:C}=t[u];let b={};if(s===0)b={...S},n===_t.COVER&&r===_t.REPLACE&&H&&(b=Object.assign({},H,b));else if(b={...S},n===_t.REPLACE){if(r===_t.REPLACE)b={...H};else if(S&&H){const v=Object.keys(S);for(const N of v)H[N]&&delete b[N]}}else if(r===_t.REPLACE){if(H){const v=Object.keys(H);for(const N of v)H[N]!==void 0&&(b[N]=H[N])}}else if(H){const v=Object.keys(H);for(const N of v)b[N]!==void 0&&delete b[N]}if(R<P)h()||o.push(e[l]),l++;else if(k<m)h()||o.push(t[u]),u++;else{const v={st:Math.min(m,P),ed:Math.max(m,P),ts:m<P?{...S}:{...H}};v.ed>v.st&&o.push(),o.push({st:Math.max(m,P),ed:Math.min(R,k),ts:b,sId:C}),R<k?(l++,t[u].st=R,t[u].st===t[u].ed&&u++):(u++,e[l].st=k,e[l].st===e[l].ed&&l++);const N={st:Math.min(R,k),ed:Math.max(R,k),ts:R<k?{...H}:{...S},sId:R<k?C:void 0};c=N.ed>N.st?N:null}}h();const d=o[o.length-1],f=e[i-1],p=t[a-1];return d.ed!==Math.max(f.ed,p.ed)&&(f.ed>p.ed?o.push(f):o.push(p)),cs(o,!0)}function wR(t,e,n,r,s){if(t==null||e==null)return e;if(t.length===0||e.length===0)return[];if(t.length>1||e.length>1)throw new Error("CustomRanges is only supported transform for length one now.");const o=t[0],i=e[0];if(n===_t.REPLACE)return s===1?[q.deepClone(o)]:[q.deepClone(i)];if(r===_t.REPLACE){const a=q.deepClone(i);return s===1&&Object.assign(a,q.deepClone(o)),[a]}else{const a=q.deepClone(i);return s===1&&Object.assign(a,q.deepClone(o)),[a]}}function qu(t,e,n,r,s){const o={startIndex:e.startIndex};if(e.paragraphStyle&&(o.paragraphStyle=q.deepClone(e.paragraphStyle),t.paragraphStyle)){if(n===_t.REPLACE)if(r===_t.REPLACE)s===1&&(o.paragraphStyle={...t.paragraphStyle});else if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)t.paragraphStyle[a]!==void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else{const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]===void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else if(r===_t.REPLACE)if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)t.paragraphStyle[a]!==void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else{const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]===void 0&&(o.paragraphStyle[a]=t.paragraphStyle[a])}else if(s===1){const i=Object.keys(t.paragraphStyle);for(const a of i)o.paragraphStyle[a]&&delete o.paragraphStyle[a]}}return n===_t.REPLACE&&r===_t.REPLACE?o.bullet=s===1?q.deepClone(t.bullet):q.deepClone(e.bullet):t.bullet===void 0?o.bullet=q.deepClone(e.bullet):n===_t.REPLACE||r===_t.REPLACE?o.bullet=s===0&&e.bullet?q.deepClone(e.bullet):q.deepClone(t.bullet):s===0&&e.bullet!==void 0&&(o.bullet=q.deepClone(e.bullet)),o}function SR(t,e){if(t==null||e==null)return e;if(t.length===0||e.length===0)return q.deepClone(e);const n=[];for(const r of e){const{id:s,type:o}=r;let i=!1;for(const a of t)if(a.id===s){(a.type===wn.DELETED||o===wn.DELETED)&&(i=!0,n.push({...r,type:wn.DELETED}));break}i||n.push(r)}return n}function AR(t,e,n=!1){const{body:r,coverType:s=_t.COVER}=t,{body:o,coverType:i=_t.COVER}=e;if(r==null||r.dataStream!==""||o==null||o.dataStream!=="")throw new Error("Data stream is not supported in retain transform.");const a={dataStream:""},l=i,{textRuns:u,paragraphs:c=[],customRanges:h,customDecorations:d}=r,{textRuns:f,paragraphs:p=[],customRanges:m,customDecorations:R}=o,S=IR(u,f,s,i,n?1:0);S&&(a.textRuns=S);const P=wR(h,m,s,i,n?1:0);P&&(a.customRanges=P);const k=SR(d,R);k&&(a.customDecorations=k);const H=[];let C=0,b=0;for(;C<c.length&&b<p.length;){const v=c[C],N=p[b],{startIndex:V}=v,{startIndex:Y}=N;if(V===Y){let g={startIndex:V};n?g=qu(v,N,s,i,1):g=qu(v,N,s,i,0),H.push(g),C++,b++}else V<Y?C++:(H.push(q.deepClone(N)),b++)}return b<p.length&&H.push(...p.slice(b)),H.length&&(a.paragraphs=H),{coverType:l,body:a}}function Zu(t){return Object.keys(t).length===1}const qi=class Zi{constructor(){_(this,"_actions",[])}static apply(e,n){return TR(e,n)}static compose(e,n){const r=new Qn(e),s=new Qn(n),o=new Zi;for(;r.hasNext()||s.hasNext();)if(s.peekType()===J.INSERT)o.push(s.next());else if(r.peekType()===J.DELETE)o.push(r.next());else{const i=Math.min(r.peekLength(),s.peekLength()),a=r.next(i),l=s.next(i);if(a.t===J.INSERT&&l.t===J.RETAIN)l.body==null?o.push(a):o.push({...a,body:Qi(a.body,l.body,l.coverType)});else if(a.t===J.RETAIN&&l.t===J.RETAIN)if(a.body==null&&l.body==null)o.push(a.len!==Number.POSITIVE_INFINITY?a:l);else if(a.body&&l.body){const u=a.coverType===_t.REPLACE||l.coverType===_t.REPLACE?_t.REPLACE:_t.COVER;o.push({...a,t:J.RETAIN,coverType:u,body:Qi(a.body,l.body,l.coverType)})}else o.push(a.body?a:l);else a.t===J.RETAIN&&l.t===J.DELETE?o.push(l):a.t===J.INSERT&&(l.t,J.DELETE)}return o.trimEndUselessRetainAction(),o.serialize()}static transform(e,n,r="right"){return this._transform(n,e,r==="left"?"right":"left")}static _transform(e,n,r="right"){const s=new Qn(e),o=new Qn(n),i=new Zi;for(;s.hasNext()||o.hasNext();)if(s.peekType()===J.INSERT&&(r==="left"||o.peekType()!==J.INSERT)){const a=s.next();i.retain(a.len)}else if(o.peekType()===J.INSERT)i.push(o.next());else{const a=Math.min(s.peekLength(),o.peekLength()),l=s.next(a),u=o.next(a);if(l.t===J.DELETE)continue;if(u.t===J.DELETE){i.push(u);continue}if(l.body==null||u.body==null)i.push(u);else{const{coverType:c,body:h}=AR(l,u,r==="left");i.push({...u,t:J.RETAIN,coverType:c,body:h})}}return i.trimEndUselessRetainAction(),i.serialize()}static transformPosition(e,n,r=!1){const s=new Qn(e);let o=0;for(;s.hasNext()&&o<=n;){const i=s.peekLength(),a=s.peekType();if(s.next(),a===J.DELETE){n-=Math.min(i,n-o);continue}else a===J.INSERT&&(o<n||!r)&&(n+=i);o+=i}return n}static isNoop(e){return e.length===0}static invert(e){const n=[];for(const r of e)if(r.t===J.INSERT)n.push({t:J.DELETE,len:r.len,body:r.body});else if(r.t===J.DELETE){if(r.body==null)throw new Error("Can not invert DELETE action without body property, makeInvertible must be called first.");n.push({t:J.INSERT,body:r.body,len:r.len})}else if(r.body!=null){if(r.oldBody==null)throw new Error("Can not invert RETAIN action without oldBody property, makeInvertible must be called first.");n.push({t:J.RETAIN,body:r.oldBody,oldBody:r.body,len:r.len,coverType:_t.REPLACE})}else n.push(r);return n}static makeInvertible(e,n){const r=[];let s=0;for(const o of e){if(o.t===J.DELETE&&(o.body==null||o.body&&o.body.dataStream.length!==o.len)){const i=ke(n,s,s+o.len,!1);o.len=i.dataStream.length,o.body=i}if(o.t===J.RETAIN&&o.body!=null){const i=ke(n,s,s+o.len,!0);o.oldBody={...i,dataStream:""},o.len=i.dataStream.length}r.push(o),o.t!==J.INSERT&&(s+=o.len)}return r}insert(e,n){const r={t:J.INSERT,body:n,len:e};return this.push(r),this}retain(e,n,r){const s={t:J.RETAIN,len:e};return n!=null&&(s.body=n),r!=null&&(s.coverType=r),this.push(s),this}delete(e){const n={t:J.DELETE,len:e};return this.push(n),this}empty(){return this._actions=[],this}serialize(){return this._actions}push(...e){if(e.length>1){for(const o of e)this.push(o);return this}let n=this._actions.length,r=this._actions[n-1];const s=q.deepClone(e[0]);if(s.t===J.RETAIN&&s.len===0&&s.body==null)return this;if(typeof r=="object"){if(r.t===J.DELETE&&s.t===J.DELETE)return r.len+=s.len,this;if(r.t===J.DELETE&&s.t===J.INSERT&&(n-=1,r=this._actions[n-1],r==null))return this._actions.unshift(s),this;if(r.t===J.RETAIN&&s.t===J.RETAIN&&r.body==null&&s.body==null)return r.len+=s.len,this;if(r.t===J.INSERT&&Zu(r.body)&&s.t===J.INSERT&&Zu(s.body))return r.len+=s.len,r.body.dataStream+=s.body.dataStream,this}return n===this._actions.length?this._actions.push(s):this._actions.splice(n,0,s),this}trimEndUselessRetainAction(){let e=this._actions[this._actions.length-1];for(;e&&e.t===J.RETAIN&&vR(e);)this._actions.pop(),e=this._actions[this._actions.length-1];return this}};_(qi,"id","text-x"),_(qi,"uri","https://github.com/dream-num/univer#text-x");let xt=qi;Object.defineProperty(xt,"name",{value:"text-x"});const js=class Qf{static registerSubtype(e){var n;e==null||this._subTypes.has(e.name)&&((n=this._subTypes.get(e.name))==null?void 0:n.id)!==xt.id||(this._subTypes.set(e.name,e),he.type.registerSubtype(e))}static apply(e,n){if(!he.type.isNoop(n))return he.type.apply(e,n)}static compose(e,n){return he.type.compose(e,n)}static transform(e,n,r){return he.type.transform(e,n,r)}static transformPosition(e,n,r="right"){return e&&e.length===2&&e[0]==="body"&&e[1].et===xt.name?xt.transformPosition(e[1].e,n,r==="left"):n}static invertWithDoc(e,n){return he.type.invertWithDoc(e,n)}static isNoop(e){return he.type.isNoop(e)}static getInstance(){return this._instance==null&&(this._instance=new Qf),this._instance}removeOp(e,n){return he.removeOp(e,n)}moveOp(e,n){return he.moveOp(e,n)}insertOp(e,n){return he.insertOp(e,n)}replaceOp(e,n,r){return he.replaceOp(e,n,r)}editOp(e,n=["body"]){return he.editOp(n,xt.name,e)}};_(js,"uri","https://github.com/dream-num/univer#json-x"),_(js,"_subTypes",new Map),_(js,"_instance",null);let Mn=js;Mn.registerSubtype(xt);var qf=(t=>(t.PARAGRAPH="PARAGRAPH",t.SECTION_BREAK="SECTION_BREAK",t.TABLE="TABLE",t.TABLE_ROW="TABLE_ROW",t.TABLE_CELL="TABLE_CELL",t.CUSTOM_BLOCK="CUSTOM_BLOCK",t))(qf||{}),de=(t=>(t.PARAGRAPH="\r",t.SECTION_BREAK=`
`,t.TABLE_START="",t.TABLE_ROW_START="\x1B",t.TABLE_CELL_START="",t.TABLE_CELL_END="",t.TABLE_ROW_END="",t.TABLE_END="",t.CUSTOM_RANGE_START="",t.CUSTOM_RANGE_END="",t.COLUMN_BREAK="\v",t.PAGE_BREAK="\f",t.DOCS_END="\0",t.TAB="	",t.CUSTOM_BLOCK="\b",t.LETTER="",t.SPACE=" ",t))(de||{});function OR(t){return`${t}`}const DR=[de.TABLE_START,de.TABLE_ROW_START,de.TABLE_CELL_START,de.TABLE_CELL_END,de.TABLE_ROW_END,de.TABLE_END],Lo=t=>{const e=t.endsWith(`\r
`)?t.slice(0,-2):t;return DR.reduce((n,r)=>n.replaceAll(r,""),e)},NR=t=>t?Lo(t).replaceAll("\r","")==="":!0,xR=t=>{const e=t.replace(/\n/g,"\r"),n=[],r=[];let s=0,o="";const i=(l,u=!0)=>{const c=e.slice(s,l);if(q.isLegalUrl(c)){const h=re(),d=`${c}`,f={startIndex:s,endIndex:s+d.length-1,rangeId:h,rangeType:gn.HYPERLINK,properties:{url:t}};r.push(f),o+=d,s=l+1,u&&(o+="\r",n.push({startIndex:l}))}else o+=e.slice(s,l+1),s=l+1,u&&n.push({startIndex:l})};let a=0;for(let l=0;l<e.length;l++)e[l]==="\r"&&(i(l),a=l);return(a!==e.length-1||e.length===1)&&i(e.length,!1),{dataStream:o,paragraphs:n,customRanges:r}},Cl={id:"default_doc",documentStyle:{}};class MR extends To{constructor(e){var n;super(),_(this,"type",bt.UNIVER_DOC),_(this,"_name$",new ie("")),_(this,"name$",this._name$.asObservable()),_(this,"snapshot"),this.snapshot={...Cl,...e},this._name$.next((n=this.snapshot.title)!=null?n:"No Title")}getUnitId(){throw new Error("Method not implemented.")}getRev(){var e;return(e=this.snapshot.rev)!=null?e:1}incrementRev(){this.snapshot.rev=this.getRev()+1}setRev(e){this.snapshot.rev=e}setName(e){this.snapshot.title=e,this._name$.next(e)}get drawings(){return this.snapshot.drawings}get documentStyle(){return this.snapshot.documentStyle}get lists(){return this.snapshot.lists}get zoomRatio(){var e;return((e=this.snapshot.settings)==null?void 0:e.zoomRatio)||1}resetDrawing(e,n){this.snapshot.drawings=e,this.snapshot.drawingsOrder=n}getBody(){return this.snapshot.body}getSnapshot(){return this.snapshot}getBulletPresetList(){var e;const n=(e=this.snapshot.lists)!=null?e:{};return{...hs,...n}}updateDocumentId(e){this.snapshot.id=e}updateDocumentRenderConfig(e){const{documentStyle:n}=this.snapshot;n.renderConfig==null?n.renderConfig=e:n.renderConfig={...n.renderConfig,...e}}getDocumentStyle(){return this.snapshot.documentStyle}updateDocumentStyle(e){this.snapshot.documentStyle==null?this.snapshot.documentStyle=e:this.snapshot.documentStyle={...this.snapshot.documentStyle,...e}}updateDocumentDataMargin(e){const{t:n,l:r,b:s,r:o}=e,{documentStyle:i}=this.snapshot;n!=null&&(i.marginTop=n),r!=null&&(i.marginLeft=r),s!=null&&(i.marginBottom=s),o!=null&&(i.marginRight=o)}updateDocumentDataPageSize(e,n){const{documentStyle:r}=this.snapshot;if(!r.pageSize){r.pageSize={width:e??Number.POSITIVE_INFINITY,height:n??Number.POSITIVE_INFINITY};return}e!==void 0&&(r.pageSize.width=e),n!==void 0&&(r.pageSize.height=n)}updateDrawing(e,n){const{drawings:r}=this,{width:s,height:o,left:i,top:a}=n,l=r?.[e];if(!l)return;const u=l.docTransform;u.size.width=s,u.size.height=o,u.positionH.posOffset=i,u.positionV.posOffset=a}setZoomRatio(e=1){this.snapshot.settings?this.snapshot.settings.zoomRatio=e:this.snapshot.settings={zoomRatio:e}}setDisabled(e){this.snapshot.disabled=e}getDisabled(){return this.snapshot.disabled}getTitle(){return this.snapshot.title}}class Pe extends MR{constructor(e){var n,r;super(q.isEmptyObject(e)?OE():e),_(this,"_unitId"),_(this,"headerModelMap",new Map),_(this,"footerModelMap",new Map),_(this,"change$",new ie(0));const s=6;this._unitId=(n=this.snapshot.id)!=null?n:re(s),this._initializeHeaderFooterModel(),this._name$.next((r=this.snapshot.title)!=null?r:"")}dispose(){super.dispose(),this.headerModelMap.forEach(e=>{e.dispose()}),this.footerModelMap.forEach(e=>{e.dispose()}),this._name$.complete()}getDrawings(){return this.snapshot.drawings}getDrawingsOrder(){return this.snapshot.drawingsOrder}getCustomRanges(){var e;return(e=this.snapshot.body)==null?void 0:e.customRanges}getCustomDecorations(){var e;return(e=this.snapshot.body)==null?void 0:e.customDecorations}getSettings(){return this.snapshot.settings}reset(e){if(e.id&&e.id!==this._unitId)throw new Error("Cannot reset a document model with a different unit id!");this.snapshot={...Cl,...e},this._initializeHeaderFooterModel(),this.change$.next(this.change$.value+1)}getSelfOrHeaderFooterModel(e){if(e!=null){if(this.headerModelMap.has(e))return this.headerModelMap.get(e);if(this.footerModelMap.has(e))return this.footerModelMap.get(e)}return this}getUnitId(){return this._unitId}apply(e){if(!Mn.isNoop(e))return this.snapshot=Mn.apply(this.snapshot,e),e!=null&&e.some(n=>Array.isArray(n)&&(n?.[0]==="headers"||n?.[0]==="footers"))&&(this.headerModelMap.clear(),this.footerModelMap.clear(),this._initializeHeaderFooterModel()),this.change$.next(this.change$.value+1),this.snapshot}sliceBody(e,n,r=vl.copy){const s=this.getBody();if(s!=null)return ke(s,e,n,!1,r)}_initializeHeaderFooterModel(){const{headers:e,footers:n}=this.getSnapshot();if(e)for(const r in e){const s=e[r];this.headerModelMap.set(r,new Pe(s)),this.headerModelMap.get(r).updateDocumentId(this.getUnitId())}if(n)for(const r in n){const s=n[r];this.footerModelMap.set(r,new Pe(s)),this.footerModelMap.get(r).updateDocumentId(this.getUnitId())}}updateDocumentId(e){super.updateDocumentId(e),this._unitId=e}getPlainText(){var e,n;return Lo((n=(e=this.getBody())==null?void 0:e.dataStream)!=null?n:"")}}function LR(t){const{ranges:e,id:n,type:r}=t,s=new xt;let o=0;for(let i=0;i<e.length;i++){const a=e[i],{startOffset:l,endOffset:u}=a;l>0&&s.push({t:J.RETAIN,len:l-o}),s.push({t:J.RETAIN,body:{dataStream:"",customDecorations:[{id:n,type:r,startIndex:0,endIndex:u-l-1}]},len:u-l}),o=u}return s}function UR(t){var e,n,r;const{id:s,segmentId:o,documentDataModel:i}=t,a=i?.getBody();if(!i||!a)return!1;const l=(r=(n=(e=i.getSelfOrHeaderFooterModel(o))==null?void 0:e.getBody())==null?void 0:n.customDecorations)==null?void 0:r.find(f=>f.id===s);if(!l)return!1;const u=new xt,{startIndex:c,endIndex:h}=l,d=h-c+1;return u.push({t:J.RETAIN,len:c}),u.push({t:J.RETAIN,len:d,body:{dataStream:"",customDecorations:[{startIndex:0,endIndex:d-1,id:s,type:wn.DELETED}]}}),u}function Zf(t,e,n,r){return t<=n&&e>=n||t>=n&&t<=r}function FR(t,e){const n=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];t.collapsed?o.startIndex<t.startOffset&&t.startOffset<=o.endIndex&&n.push(o):Zf(t.startOffset,t.endOffset-1,o.startIndex,o.endIndex)&&n.push(o)}return n}function kR(t){return{...q.deepClone(t),rangeId:re()}}function PR(t,e){const n=[];let r=t[0];for(const s of e)s<t[0]||s>t[1]||(r<s&&n.push([r,s-1]),r=s+1);return r<=t[1]&&n.push([r,t[1]]),n}function tp(t,e,n,r){const s=[];for(let o=0,i=n.length;o<i;o++){const a=n[o];if((r===void 0||a.rangeType===r)&&Math.max(a.startIndex,t)<=Math.min(a.endIndex,e)&&s.push({...a}),a.startIndex>e)break}return s}function BR(t,e){var n,r,s,o,i;const a=tp(t.startOffset,t.collapsed?t.startOffset:t.endOffset-1,(n=e.customRanges)!=null?n:[]),l=Math.min(t.startOffset,(s=(r=a[0])==null?void 0:r.startIndex)!=null?s:1/0),u=Math.max(t.endOffset,((i=(o=a[a.length-1])==null?void 0:o.endIndex)!=null?i:-1/0)+1);return{startOffset:l,endOffset:u,collapsed:l===u}}var ri,tc;function $R(){if(tc)return ri;tc=1;var t=-1,e=1,n=0;function r(g,L,E,D,w){if(g===L)return g?[[n,g]]:[];if(E!=null){var I=V(g,L,E);if(I)return I}var A=a(g,L),O=g.substring(0,A);g=g.substring(A),L=L.substring(A),A=u(g,L);var x=g.substring(g.length-A);g=g.substring(0,g.length-A),L=L.substring(0,L.length-A);var F=s(g,L);return O&&F.unshift([n,O]),x&&F.push([n,x]),P(F,w),D&&h(F),F}function s(g,L){var E;if(!g)return[[e,L]];if(!L)return[[t,g]];var D=g.length>L.length?g:L,w=g.length>L.length?L:g,I=D.indexOf(w);if(I!==-1)return E=[[e,D.substring(0,I)],[n,w],[e,D.substring(I+w.length)]],g.length>L.length&&(E[0][0]=E[2][0]=t),E;if(w.length===1)return[[t,g],[e,L]];var A=c(g,L);if(A){var O=A[0],x=A[1],F=A[2],Q=A[3],G=A[4],it=r(O,F),lt=r(x,Q);return it.concat([[n,G]],lt)}return o(g,L)}function o(g,L){for(var E=g.length,D=L.length,w=Math.ceil((E+D)/2),I=w,A=2*w,O=new Array(A),x=new Array(A),F=0;F<A;F++)O[F]=-1,x[F]=-1;O[I+1]=0,x[I+1]=0;for(var Q=E-D,G=Q%2!==0,it=0,lt=0,T=0,M=0,j=0;j<w;j++){for(var W=-j+it;W<=j-lt;W+=2){var B=I+W,$;W===-j||W!==j&&O[B-1]<O[B+1]?$=O[B+1]:$=O[B-1]+1;for(var Z=$-W;$<E&&Z<D&&g.charAt($)===L.charAt(Z);)$++,Z++;if(O[B]=$,$>E)lt+=2;else if(Z>D)it+=2;else if(G){var tt=I+Q-W;if(tt>=0&&tt<A&&x[tt]!==-1){var U=E-x[tt];if($>=U)return i(g,L,$,Z)}}}for(var z=-j+T;z<=j-M;z+=2){var tt=I+z,U;z===-j||z!==j&&x[tt-1]<x[tt+1]?U=x[tt+1]:U=x[tt-1]+1;for(var X=U-z;U<E&&X<D&&g.charAt(E-U-1)===L.charAt(D-X-1);)U++,X++;if(x[tt]=U,U>E)M+=2;else if(X>D)T+=2;else if(!G){var B=I+Q-z;if(B>=0&&B<A&&O[B]!==-1){var $=O[B],Z=I+$-B;if(U=E-U,$>=U)return i(g,L,$,Z)}}}}return[[t,g],[e,L]]}function i(g,L,E,D){var w=g.substring(0,E),I=L.substring(0,D),A=g.substring(E),O=L.substring(D),x=r(w,I),F=r(A,O);return x.concat(F)}function a(g,L){if(!g||!L||g.charAt(0)!==L.charAt(0))return 0;for(var E=0,D=Math.min(g.length,L.length),w=D,I=0;E<w;)g.substring(I,w)==L.substring(I,w)?(E=w,I=E):D=w,w=Math.floor((D-E)/2+E);return k(g.charCodeAt(w-1))&&w--,w}function l(g,L){var E=g.length,D=L.length;if(E==0||D==0)return 0;E>D?g=g.substring(E-D):E<D&&(L=L.substring(0,E));var w=Math.min(E,D);if(g==L)return w;for(var I=0,A=1;;){var O=g.substring(w-A),x=L.indexOf(O);if(x==-1)return I;A+=x,(x==0||g.substring(w-A)==L.substring(0,A))&&(I=A,A++)}}function u(g,L){if(!g||!L||g.slice(-1)!==L.slice(-1))return 0;for(var E=0,D=Math.min(g.length,L.length),w=D,I=0;E<w;)g.substring(g.length-w,g.length-I)==L.substring(L.length-w,L.length-I)?(E=w,I=E):D=w,w=Math.floor((D-E)/2+E);return H(g.charCodeAt(g.length-w))&&w--,w}function c(g,L){var E=g.length>L.length?g:L,D=g.length>L.length?L:g;if(E.length<4||D.length*2<E.length)return null;function w(lt,T,M){for(var j=lt.substring(M,M+Math.floor(lt.length/4)),W=-1,B="",$,Z,tt,U;(W=T.indexOf(j,W+1))!==-1;){var z=a(lt.substring(M),T.substring(W)),X=u(lt.substring(0,M),T.substring(0,W));B.length<X+z&&(B=T.substring(W-X,W)+T.substring(W,W+z),$=lt.substring(0,M-X),Z=lt.substring(M+z),tt=T.substring(0,W-X),U=T.substring(W+z))}return B.length*2>=lt.length?[$,Z,tt,U,B]:null}var I=w(E,D,Math.ceil(E.length/4)),A=w(E,D,Math.ceil(E.length/2)),O;if(!I&&!A)return null;A?I?O=I[4].length>A[4].length?I:A:O=A:O=I;var x,F,Q,G;g.length>L.length?(x=O[0],F=O[1],Q=O[2],G=O[3]):(Q=O[0],G=O[1],x=O[2],F=O[3]);var it=O[4];return[x,F,Q,G,it]}function h(g){for(var L=!1,E=[],D=0,w=null,I=0,A=0,O=0,x=0,F=0;I<g.length;)g[I][0]==n?(E[D++]=I,A=x,O=F,x=0,F=0,w=g[I][1]):(g[I][0]==e?x+=g[I][1].length:F+=g[I][1].length,w&&w.length<=Math.max(A,O)&&w.length<=Math.max(x,F)&&(g.splice(E[D-1],0,[t,w]),g[E[D-1]+1][0]=e,D--,D--,I=D>0?E[D-1]:-1,A=0,O=0,x=0,F=0,w=null,L=!0)),I++;for(L&&P(g),S(g),I=1;I<g.length;){if(g[I-1][0]==t&&g[I][0]==e){var Q=g[I-1][1],G=g[I][1],it=l(Q,G),lt=l(G,Q);it>=lt?(it>=Q.length/2||it>=G.length/2)&&(g.splice(I,0,[n,G.substring(0,it)]),g[I-1][1]=Q.substring(0,Q.length-it),g[I+1][1]=G.substring(it),I++):(lt>=Q.length/2||lt>=G.length/2)&&(g.splice(I,0,[n,Q.substring(0,lt)]),g[I-1][0]=e,g[I-1][1]=G.substring(0,G.length-lt),g[I+1][0]=t,g[I+1][1]=Q.substring(lt),I++),I++}I++}}var d=/[^a-zA-Z0-9]/,f=/\s/,p=/[\r\n]/,m=/\n\r?\n$/,R=/^\r?\n\r?\n/;function S(g){function L(lt,T){if(!lt||!T)return 6;var M=lt.charAt(lt.length-1),j=T.charAt(0),W=M.match(d),B=j.match(d),$=W&&M.match(f),Z=B&&j.match(f),tt=$&&M.match(p),U=Z&&j.match(p),z=tt&&lt.match(m),X=U&&T.match(R);return z||X?5:tt||U?4:W&&!$&&Z?3:$||Z?2:W||B?1:0}for(var E=1;E<g.length-1;){if(g[E-1][0]==n&&g[E+1][0]==n){var D=g[E-1][1],w=g[E][1],I=g[E+1][1],A=u(D,w);if(A){var O=w.substring(w.length-A);D=D.substring(0,D.length-A),w=O+w.substring(0,w.length-A),I=O+I}for(var x=D,F=w,Q=I,G=L(D,w)+L(w,I);w.charAt(0)===I.charAt(0);){D+=w.charAt(0),w=w.substring(1)+I.charAt(0),I=I.substring(1);var it=L(D,w)+L(w,I);it>=G&&(G=it,x=D,F=w,Q=I)}g[E-1][1]!=x&&(x?g[E-1][1]=x:(g.splice(E-1,1),E--),g[E][1]=F,Q?g[E+1][1]=Q:(g.splice(E+1,1),E--))}E++}}function P(g,L){g.push([n,""]);for(var E=0,D=0,w=0,I="",A="",O;E<g.length;){if(E<g.length-1&&!g[E][1]){g.splice(E,1);continue}switch(g[E][0]){case e:w++,A+=g[E][1],E++;break;case t:D++,I+=g[E][1],E++;break;case n:var x=E-w-D-1;if(L){if(x>=0&&b(g[x][1])){var F=g[x][1].slice(-1);if(g[x][1]=g[x][1].slice(0,-1),I=F+I,A=F+A,!g[x][1]){g.splice(x,1),E--;var Q=x-1;g[Q]&&g[Q][0]===e&&(w++,A=g[Q][1]+A,Q--),g[Q]&&g[Q][0]===t&&(D++,I=g[Q][1]+I,Q--),x=Q}}if(C(g[E][1])){var F=g[E][1].charAt(0);g[E][1]=g[E][1].slice(1),I+=F,A+=F}}if(E<g.length-1&&!g[E][1]){g.splice(E,1);break}if(I.length>0||A.length>0){I.length>0&&A.length>0&&(O=a(A,I),O!==0&&(x>=0?g[x][1]+=A.substring(0,O):(g.splice(0,0,[n,A.substring(0,O)]),E++),A=A.substring(O),I=I.substring(O)),O=u(A,I),O!==0&&(g[E][1]=A.substring(A.length-O)+g[E][1],A=A.substring(0,A.length-O),I=I.substring(0,I.length-O)));var G=w+D;I.length===0&&A.length===0?(g.splice(E-G,G),E=E-G):I.length===0?(g.splice(E-G,G,[e,A]),E=E-G+1):A.length===0?(g.splice(E-G,G,[t,I]),E=E-G+1):(g.splice(E-G,G,[t,I],[e,A]),E=E-G+2)}E!==0&&g[E-1][0]===n?(g[E-1][1]+=g[E][1],g.splice(E,1)):E++,w=0,D=0,I="",A="";break}}g[g.length-1][1]===""&&g.pop();var it=!1;for(E=1;E<g.length-1;)g[E-1][0]===n&&g[E+1][0]===n&&(g[E][1].substring(g[E][1].length-g[E-1][1].length)===g[E-1][1]?(g[E][1]=g[E-1][1]+g[E][1].substring(0,g[E][1].length-g[E-1][1].length),g[E+1][1]=g[E-1][1]+g[E+1][1],g.splice(E-1,1),it=!0):g[E][1].substring(0,g[E+1][1].length)==g[E+1][1]&&(g[E-1][1]+=g[E+1][1],g[E][1]=g[E][1].substring(g[E+1][1].length)+g[E+1][1],g.splice(E+1,1),it=!0)),E++;it&&P(g,L)}function k(g){return g>=55296&&g<=56319}function H(g){return g>=56320&&g<=57343}function C(g){return H(g.charCodeAt(0))}function b(g){return k(g.charCodeAt(g.length-1))}function v(g){for(var L=[],E=0;E<g.length;E++)g[E][1].length>0&&L.push(g[E]);return L}function N(g,L,E,D){return b(g)||C(D)?null:v([[n,g],[t,L],[e,E],[n,D]])}function V(g,L,E){var D=typeof E=="number"?{index:E,length:0}:E.oldRange,w=typeof E=="number"?null:E.newRange,I=g.length,A=L.length;if(D.length===0&&(w===null||w.length===0)){var O=D.index,x=g.slice(0,O),F=g.slice(O),Q=w?w.index:null;t:{var G=O+A-I;if(Q!==null&&Q!==G||G<0||G>A)break t;var it=L.slice(0,G),lt=L.slice(G);if(lt!==F)break t;var T=Math.min(O,G),M=x.slice(0,T),j=it.slice(0,T);if(M!==j)break t;var W=x.slice(T),B=it.slice(T);return N(M,W,B,F)}t:{if(Q!==null&&Q!==O)break t;var $=O,it=L.slice(0,$),lt=L.slice($);if(it!==x)break t;var Z=Math.min(I-$,A-$),tt=F.slice(F.length-Z),U=lt.slice(lt.length-Z);if(tt!==U)break t;var W=F.slice(0,F.length-Z),B=lt.slice(0,lt.length-Z);return N(x,W,B,tt)}}if(D.length>0&&w&&w.length===0)t:{var M=g.slice(0,D.index),tt=g.slice(D.index+D.length),T=M.length,Z=tt.length;if(A<T+Z)break t;var j=L.slice(0,T),U=L.slice(A-Z);if(M!==j||tt!==U)break t;var W=g.slice(T,I-Z),B=L.slice(T,A-Z);return N(M,W,B,tt)}return null}function Y(g,L,E,D){return r(g,L,E,D,!0)}return Y.INSERT=e,Y.DELETE=t,Y.EQUAL=n,ri=Y,ri}var HR=$R();const Rl=Ne(HR);function jR(t){var e,n,r;const{rangeId:s,segmentId:o,documentDataModel:i,insert:a}=t,l=(n=(e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.customRanges)==null?void 0:n.find(p=>p.rangeId===s);if(!l)return!1;const{startIndex:u,endIndex:c}=l,h=new xt,d=c-u+1;h.push({t:J.RETAIN,len:u}),h.push({t:J.RETAIN,len:d,body:{dataStream:"",customRanges:[]}}),a&&h.push({t:J.INSERT,body:a,len:a.dataStream.length});const f=c+1+((r=a?.dataStream.length)!=null?r:0);return h.selections=[{startOffset:f,endOffset:f,collapsed:!0}],h}function WR(t){const{ranges:e,rangeId:n,rangeType:r,wholeEntity:s,properties:o,body:i}=t;let a=0;const l=new xt;let u=!1;return e.forEach(c=>{var h,d,f;const p=BR(c,i);if(!p||!i)return!1;const{startOffset:m,endOffset:R}=p,S=(h=i.customRanges)!=null?h:[],P=(C,b,v)=>{var N,V,Y,g;const L=tp(C,b,S,r),E=Math.min((V=(N=L[0])==null?void 0:N.startIndex)!=null?V:1/0,C),D=Math.max((g=(Y=L[L.length-1])==null?void 0:Y.endIndex)!=null?g:-1/0,b),w={rangeId:v?`${n}$${v}`:n,rangeType:r,startIndex:0,endIndex:D-E,wholeEntity:s,properties:{...o}};l.push({t:J.RETAIN,len:E-a}),l.push({t:J.RETAIN,len:D-E+1,body:{dataStream:"",customRanges:[w]},coverType:_t.COVER}),a=D+1},k=((d=i.paragraphs)!=null?d:[]).filter(C=>C.startIndex<R&&C.startIndex>m),H=((f=i.customBlocks)!=null?f:[]).filter(C=>C.startIndex<R&&C.startIndex>m);PR([m,R-1],[...k.map(C=>C.startIndex),...H.map(C=>C.startIndex)]).forEach(([C,b],v)=>P(C,b,v)),u=!0,l.selections=[{startOffset:p.endOffset,endOffset:p.endOffset,collapsed:!0}]}),u?l:!1}function ep(t,e,n=0,r=null,s=!0){t.sort((u,c)=>u.startOffset-c.startOffset);const o=[],{paragraphs:i=[]}=e,a=i?.find(u=>u.startIndex>=t[0].startOffset&&u.startIndex<t[0].endOffset);let l=n;if(t.forEach(u=>{const{startOffset:c,endOffset:h}=u;c>l&&(o.push({t:J.RETAIN,len:c-l}),l=c),l<h&&(o.push({t:J.DELETE,len:h-l}),l=h)}),r&&o.push({t:J.INSERT,body:r,len:r.dataStream.length}),a&&s){const u=i.find(c=>c.startIndex-n>=t[t.length-1].endOffset-1);u&&(u.startIndex>l&&(o.push({t:J.RETAIN,len:u.startIndex-l}),l=u.startIndex),o.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...u,startIndex:0,bullet:a?.bullet}]},coverType:_t.REPLACE}))}return o}function VR(t,e,n=0){const r=[];let s=n;return t.forEach(o=>{const{startOffset:i,endOffset:a}=o;i>s&&(r.push({t:J.RETAIN,len:i-s}),s=i),a>s&&(r.push({t:J.RETAIN,len:a-s,body:{...q.deepClone(e),dataStream:""}}),s=a)}),r}const GR=t=>{var e;const{selection:n,body:r,doc:s}=t,o=n.segmentId,i=(e=s.getSelfOrHeaderFooterModel(o))==null?void 0:e.getBody();if(!i)return!1;const a=n.collapsed?null:ke(i,n.startOffset,n.endOffset),l=Rl(a?a.dataStream:"",r.dataStream);let u=0;const c=l.map(([d,f])=>{switch(d){case 0:{const p={t:J.RETAIN,body:{...ke(r,u,u+f.length,!1),dataStream:""},len:f.length};return u+=f.length,p}case 1:{const p={t:J.INSERT,body:ke(r,u,u+f.length),len:f.length};return u+=f.length,p}default:return{t:J.DELETE,len:f.length}}}),h=new xt;return h.push({t:J.RETAIN,len:n.startOffset}),h.push(...c),h};function YR(t,e){return!!(t?.length===e?.length&&t!=null&&t.every((n,r)=>JSON.stringify(n)===JSON.stringify(e?.[r])))}const zR=t=>{var e;const{selection:n,body:r,doc:s,themeService:o}=t,i=n.segmentId,a=(e=s.getSelfOrHeaderFooterModel(i))==null?void 0:e.getBody();if(!a)return!1;const l=n.collapsed?null:ke(a,n.startOffset,n.endOffset),u=Rl(l?l.dataStream:"",r.dataStream);let c=0;const h=u.map(([f,p])=>{switch(f){case 0:{const m=so(r,c,c+p.length,!1),R=so(l,c,c+p.length,!1),S={t:J.RETAIN,body:YR(m,R)?void 0:{textRuns:m?.map(P=>{var k,H,C,b,v,N,V;return{...P,ts:{...P.ts,cl:(C=(H=(k=P.ts)==null?void 0:k.cl)==null?void 0:H.rgb)!=null&&C.includes(".")?{rgb:o.getColorFromTheme((N=(v=(b=P.ts)==null?void 0:b.cl)==null?void 0:v.rgb)!=null?N:"")}:(V=P.ts)==null?void 0:V.cl}}}),dataStream:""},len:p.length};return c+=p.length,S}case 1:{const m={t:J.INSERT,body:ke(r,c,c+p.length),len:p.length};return c+=p.length,m}default:return{t:J.DELETE,len:p.length}}});if(h.every(f=>f.t===J.RETAIN&&!f.body))return!1;const d=new xt;return d.push({t:J.RETAIN,len:n.startOffset}),d.push(...h),d};function KR(t,e){const n=[],{customBlocks:r=[]}=t;for(const s of e){const{startOffset:o,endOffset:i}=s;if(!(o==null||i==null))for(const a of r){const{startIndex:l}=a;l>=o&&l<i&&n.push(a.blockId)}}return n}function XR(t,e=""){if(!e)return["body"];const{headers:n,footers:r}=t.getSnapshot();if(n==null&&r==null)throw new Error("Document data model must have headers or footers when update by segment id");if(n?.[e]!=null)return["headers",e,"body"];if(r?.[e]!=null)return["footers",e,"body"];throw new Error("Segment id not found in headers or footers")}const JR=t=>{var e,n,r,s;const{selection:o,documentDataModel:i,drawings:a}=t,{collapsed:l,startOffset:u,segmentId:c}=o,h=new xt,d=Mn.getInstance(),f=[],p=i.getSelfOrHeaderFooterModel(c).getBody();if(!p)return!1;const m=(n=(e=i.getSnapshot().drawingsOrder)==null?void 0:e.length)!=null?n:0;let R=0;if(l)u>0&&h.push({t:J.RETAIN,len:u});else{const k=ep([o],p,0,null,!1);h.push(...k);const H=KR(p,[o]),C=(r=i.getDrawings())!=null?r:{},b=(s=i.getDrawingsOrder())!=null?s:[],v=H.sort((N,V)=>b.indexOf(N)>b.indexOf(V)?-1:b.indexOf(N)<b.indexOf(V)?1:0);if(v.length>0)for(const N of v){const V=C[N],Y=b.indexOf(N);if(V==null||Y<0)continue;const g=d.removeOp(["drawings",N],V),L=d.removeOp(["drawingsOrder",Y],N);f.push(g),f.push(L),R++}}h.push({t:J.INSERT,body:{dataStream:"\b".repeat(a.length),customBlocks:a.map((k,H)=>({startIndex:H,blockId:k.drawingId}))},len:a.length});const S=XR(i,c),P=d.editOp(h.serialize(),S);f.push(P);for(const k of a){const{drawingId:H}=k,C=d.insertOp(["drawings",H],k),b=d.insertOp(["drawingsOrder",m-R],H);f.push(C),f.push(b)}return f.reduce((k,H)=>Mn.compose(k,H),null)};function QR(t,e){if(typeof e>"u")return{startOffset:t,endOffset:t,collapsed:!0};if(e<t)throw new Error(`Cannot make a doc selection when endOffset ${e} is less than startOffset ${t}.`);return{startOffset:t,endOffset:e,collapsed:t===e}}function qR(t){const{startOffset:e,endOffset:n,collapsed:r}=t,s=Math.min(e,n),o=Math.max(e,n);return{startOffset:s,endOffset:o,collapsed:r}}function ZR(t,e,n,r){return Math.max(t,n)<=Math.min(e,r)}function ta(t,e,n,r){const{startOffset:s,endOffset:o}=t,i=r??bl(e,n),a=[];let l=-1;for(let u=0;u<i.length;u++){const c=i[u],{startIndex:h}=c;(s>l&&s<=h||o>l&&o<=h||h>=s&&h<=o)&&a.push(c),l=h}return a}function ea(t,e,n){const r=[],s=bl(e,n);for(const o of t){const i=ta(o,e,n,s);r.push(...i)}return r}const tb=[de.PARAGRAPH,de.TABLE_START,de.TABLE_END,de.TABLE_ROW_START,de.TABLE_CELL_START,de.TABLE_CELL_END];function bl(t,e){const n=[];for(let r=0;r<t.length;r++){const s=t[r],{startIndex:o}=s;let i=o-1;for(;!tb.includes(e[i])&&i>=0;)i--;n.push({...s,paragraphStart:i+1,paragraphEnd:s.startIndex})}return n}const eb=t=>{var e,n,r;const{paragraphs:s,segmentId:o,document:i}=t;let a=t.listType;const l=(n=(e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.paragraphs)!=null?n:[],u=s.every(f=>{var p;return((p=f.bullet)==null?void 0:p.listType.indexOf(a))===0});let c=re(6);if(s.length===1){const f=l.indexOf(s[0]),p=l[f-1],m=l[f+1];p&&p.bullet&&p.bullet.listType.indexOf(a)===0?(c=p.bullet.listId,a!==Ye.CHECK_LIST&&(a=p.bullet.listType)):m&&m.bullet&&m.bullet.listType.indexOf(a)===0&&(c=m.bullet.listId,a!==Ye.CHECK_LIST&&(a=m.bullet.listType))}const h=new kn;h.reset();const d=new xt;for(const f of s){const{startIndex:p,paragraphStyle:m={},bullet:R}=f;d.push({t:J.RETAIN,len:p-h.cursor}),d.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[u?{paragraphStyle:m,startIndex:0}:{startIndex:0,paragraphStyle:{...m},bullet:{nestingLevel:(r=R?.nestingLevel)!=null?r:0,textStyle:{fs:20},listType:a,listId:c}}]},coverType:_t.REPLACE}),h.moveCursorTo(p+1)}return d},nb=t=>{var e;const{paragraphIndex:n,segmentId:r,document:s}=t,o=(e=s.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:e.paragraphs;if(o==null)return!1;const i=o.find(d=>d.startIndex===n);if(!(i!=null&&i.bullet)||i.bullet.listType.indexOf(Ye.CHECK_LIST)===-1)return!1;const a=new kn;a.reset();const l=new xt,{startIndex:u,paragraphStyle:c={}}=i,h=i.bullet.listType===Ye.CHECK_LIST?Ye.CHECK_LIST_CHECKED:Ye.CHECK_LIST;return l.push({t:J.RETAIN,len:u-a.cursor}),l.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...i,paragraphStyle:c,startIndex:0,bullet:{...i.bullet,listType:h}}]},coverType:_t.REPLACE}),a.moveCursorTo(u+1),l},rb=t=>{var e,n;const{paragraphs:r,listType:s,segmentId:o,document:i}=t;if(((e=i.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:e.paragraphs)==null)return!1;const a=re(6),l=new kn;l.reset();const u=new xt;for(const c of r){const{startIndex:h,paragraphStyle:d={},bullet:f}=c;u.push({t:J.RETAIN,len:h-l.cursor}),u.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:d,bullet:{nestingLevel:(n=f?.nestingLevel)!=null?n:0,textStyle:f?.listType===s?f.textStyle:{fs:20},listType:s,listId:a}}]},coverType:_t.REPLACE}),l.moveCursorTo(h+1)}return u};function sb(t,e){return e.some(n=>t.startIndex>n.startIndex&&t.startIndex<n.endIndex)}const ob=t=>{var e,n,r;const{paragraphs:s,document:o,type:i}=t,a=new kn;a.reset();const l=new xt,u=(e=o.getSnapshot().lists)!=null?e:{},c=(r=(n=o.getBody())==null?void 0:n.tables)!=null?r:[],h={...hs,...u};for(const d of s){const{startIndex:f,paragraphStyle:p={},bullet:m}=d,R=sb(d,c);if(l.push({t:J.RETAIN,len:f-a.cursor}),m){const S=m.listType;let P=h[S].nestingLevel.length-1;R&&(P=Math.min(P,2)),l.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...p},bullet:{...m,nestingLevel:Math.max(Math.min(m.nestingLevel+i,P),0)}}]},coverType:_t.REPLACE})}else l.push({t:J.RETAIN,len:1});a.moveCursorTo(f+1)}return l},ib=t=>{var e,n,r,s;const{textRanges:o,segmentId:i,document:a,style:l,paragraphTextRun:u,cursor:c,deleteLen:h,textX:d}=t,f=a.getSelfOrHeaderFooterModel(i),p=(n=(e=f.getBody())==null?void 0:e.paragraphs)!=null?n:[],m=(s=(r=f.getBody())==null?void 0:r.dataStream)!=null?s:"",R=ea(o,p,m),S=new kn;c&&S.moveCursorTo(c);const P=d??new xt;R.sort((H,C)=>H.startIndex-C.startIndex);const k=Math.max(0,R[0].paragraphStart-1);k>S.cursor&&(P.push({t:J.RETAIN,len:k-S.cursor}),S.moveCursorTo(k)),h&&P.push({t:J.DELETE,len:h});for(const H of R){const{startIndex:C,paragraphStyle:b={}}=H,v=C-S.cursor;P.push({t:J.RETAIN,len:v,...u?{body:{dataStream:"",textRuns:[{ts:u,st:0,ed:v}]},coverType:_t.REPLACE}:null}),P.push({t:J.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...b,...l}}]},coverType:_t.REPLACE}),S.moveCursorTo(C+1)}return P};class te{}_(te,"customRange",{add:WR,delete:jR,copyCustomRange:kR,getCustomRangesInterestsWithSelection:FR,isIntersecting:Zf}),_(te,"customDecoration",{add:LR,delete:UR}),_(te,"selection",{replace:GR,makeSelection:QR,normalizeSelection:qR,delete:ep,replaceTextRuns:zR,retain:VR}),_(te,"range",{isIntersects:ZR,getParagraphsInRange:ta,getParagraphsInRanges:ea}),_(te,"transform",{getPlainText:Lo,fromPlainText:xR,isEmptyDocument:NR}),_(te,"paragraph",{bullet:{set:rb,switch:eb,toggleChecklist:nb,changeNestLevel:ob},style:{set:ib},util:{transform:bl,getParagraphsInRange:ta,getParagraphsInRanges:ea}}),_(te,"drawing",{add:JR});function ab(t,e,n,r){var s;if(e==="")return t;const o={id:"mock-id",body:t,documentStyle:{}},i=new Pe(o),a=e.length;let l;for(;(l=(r?i.getBody().dataStream:i.getBody().dataStream.toLowerCase()).indexOf(e))>=0;){const c=new xt,h=Mn.getInstance();if(l>0&&c.retain(l),n.length>0){const d=i.sliceBody(l,l+a),f={dataStream:n};if(Array.isArray(d?.textRuns)&&d.textRuns.length&&(f.textRuns=[{...d.textRuns[0],st:0,ed:n.length}]),(s=d?.customRanges)!=null&&s.length){const p=d.customRanges[0];f.customRanges=[{...p,startIndex:0,endIndex:n.length-1}]}c.insert(n.length,f)}c.delete(a),i.apply(h.editOp(c.serialize()))}const u=i.getBody();return i.dispose(),u}function lb(t){if(t.customRanges||(t.customRanges=[]),!t.paragraphs){t.paragraphs=[];for(let e=0;e<t.dataStream.length;e++)t.dataStream[e]==="\r"&&t.paragraphs.push({startIndex:e})}return t.customBlocks||(t.customBlocks=[]),t.textRuns||(t.textRuns=[]),t.customDecorations||(t.customDecorations=[]),t.sectionBreaks||(t.sectionBreaks=[]),t.tables||(t.tables=[]),t}function np(t){var e;return t.body=lb((e=t.body)!=null?e:{dataStream:""}),t.drawingsOrder||(t.drawingsOrder=[]),t.drawings||(t.drawings={}),t.documentStyle||(t.documentStyle={}),t}class ds{constructor(e={}){_(this,"_style"),this._style=e}static create(e={}){return new ds(e)}get fontFamily(){return this._style.ff}get fontSize(){return this._style.fs}get italic(){return this._style.it===ot.TRUE}get bold(){return this._style.bl===ot.TRUE}get underline(){return this._style.ul&&ln.create(this._style.ul)}get bottomBorderLine(){return this._style.bbl&&ln.create(this._style.bbl)}get strikethrough(){return this._style.st&&ln.create(this._style.st)}get overline(){return this._style.ol&&ln.create(this._style.ol)}get background(){return this._style.bg}get border(){return this._style.bd}get color(){return this._style.cl}get verticalAlign(){return this._style.va}get numberFormat(){return this._style.n}copy(){return fn.create(q.deepClone(this._style))}getValue(){return{...this._style}}}class fn extends ds{static create(e={}){return new fn(e)}constructor(e={}){super(e)}setFontFamily(e){return this._style.ff=e,this}setFontSize(e){return this._style.fs=e,this}setItalic(e){return this._style.it=e?1:0,this}setBold(e){return this._style.bl=e?1:0,this}setUnderline(e){return this._style.ul=e.build(),this}setBottomBorderLine(e){return this._style.bbl=e.build(),this}setStrikethrough(e){return this._style.st=e.build(),this}setOverline(e){return this._style.ol=e.build(),this}setBackground(e){return this._style.bg=e,this}setBorder(e){return this._style.bd=e,this}setColor(e){return this._style.cl=e,this}setVerticalAlign(e){return this._style.va=e,this}copy(){return fn.create(q.deepClone(this._style))}build(){return this.getValue()}}class ln{constructor(e={s:1}){_(this,"_decoration"),this._decoration=e}static create(e={s:1}){return new ln(e)}get show(){return this._decoration.s===ot.TRUE}get followFontColor(){return this._decoration.c===ot.TRUE}get color(){return this._decoration.cl}get type(){return this._decoration.t}setShow(e){return this._decoration.s=e?1:0,this}setFollowFontColor(e){return this._decoration.c=e?1:0,this}setColor(e){return this._decoration.cl=e,this}setLineType(e){return this._decoration.t=e,this}copy(){return ln.create(q.deepClone(this._decoration))}build(){return{...this._decoration}}}class fs{constructor(e={}){_(this,"_style"),this._style=e}static create(e={}){return new fs(e)}get indentFirstLine(){return this._style.indentFirstLine}get hanging(){return this._style.hanging}get indentStart(){return this._style.indentStart}get tabStops(){return this._style.tabStops}get indentEnd(){return this._style.indentEnd}get textStyle(){return this._style.textStyle}get headingId(){return this._style.headingId}get namedStyleType(){return this._style.namedStyleType}get horizontalAlign(){return this._style.horizontalAlign}get lineSpacing(){return this._style.lineSpacing}get direction(){return this._style.direction}get spacingRule(){return this._style.spacingRule}get snapToGrid(){return this._style.snapToGrid}get spaceAbove(){return this._style.spaceAbove}get spaceBelow(){return this._style.spaceBelow}get borderBetween(){return this._style.borderBetween}get borderTop(){return this._style.borderTop}get borderBottom(){return this._style.borderBottom}get borderLeft(){return this._style.borderLeft}get borderRight(){return this._style.borderRight}get keepLines(){return this._style.keepLines===ot.TRUE}get keepNext(){return this._style.keepNext===ot.TRUE}get wordWrap(){return this._style.wordWrap===ot.TRUE}get widowControl(){return this._style.widowControl===ot.TRUE}get shading(){return this._style.shading}get suppressHyphenation(){return this._style.suppressHyphenation===ot.TRUE}copy(){return Qr.create(q.deepClone(this._style))}getValue(){return this._style}}class Qr extends fs{static create(e={}){return new Qr(e)}constructor(e={}){super(e)}setIndentFirstLine(e){return this._style.indentFirstLine=e,this}setHanging(e){return this._style.hanging=e,this}setIndentStart(e){return this._style.indentStart=e,this}setTabStops(e){return this._style.tabStops=e,this}setIndentEnd(e){return this._style.indentEnd=e,this}setTextStyle(e){return this._style.textStyle=e,this}setHeadingId(e){return this._style.headingId=e,this}setNamedStyleType(e){return this._style.namedStyleType=e,this}setHorizontalAlign(e){return this._style.horizontalAlign=e,this}setLineSpacing(e){return this._style.lineSpacing=e,this}setDirection(e){return this._style.direction=e,this}setSpacingRule(e){return this._style.spacingRule=e,this}setSnapToGrid(e){return this._style.snapToGrid=e?1:0,this}setSpaceAbove(e){return this._style.spaceAbove=e,this}setSpaceBelow(e){return this._style.spaceBelow=e,this}setBorderBetween(e){return this._style.borderBetween=e,this}setBorderTop(e){return this._style.borderTop=e,this}setBorderBottom(e){return this._style.borderBottom=e,this}setBorderLeft(e){return this._style.borderLeft=e,this}setBorderRight(e){return this._style.borderRight=e,this}setKeepLines(e){return this._style.keepLines=e?1:0,this}setKeepNext(e){return this._style.keepNext=e?1:0,this}setWordWrap(e){return this._style.wordWrap=e?1:0,this}setWidowControl(e){return this._style.widowControl=e?1:0,this}setShading(e){return this._style.shading=e,this}setSuppressHyphenation(e){return this._style.suppressHyphenation=e?1:0,this}copy(){return Qr.create(q.deepClone(this._style))}build(){return this.getValue()}}class un{constructor(e){if(_(this,"_data"),!e.body)throw new Error("Invalid document data, body is required");this._data=np(e)}static create(e){return new un(e)}static createByBody(e){return new un({body:e,id:"d",documentStyle:{}})}copy(){return Sn.create(q.deepClone(this._data))}slice(e,n){const{body:r,...s}=this._data;return Sn.create({...q.deepClone(s),body:ke(r,e,n)})}toPlainText(){var e,n;return te.transform.getPlainText((n=(e=this._data.body)==null?void 0:e.dataStream)!=null?n:"").replaceAll("\r",`
`)}getParagraphStyle(){var e,n;return fs.create((n=(e=this._data.body)==null?void 0:e.paragraphs)==null?void 0:n[0].paragraphStyle)}getParagraphBullet(){var e,n;return(n=(e=this._data.body)==null?void 0:e.paragraphs)==null?void 0:n[0].bullet}getParagraphs(){var e,n;const r=(n=(e=this._data.body)==null?void 0:e.paragraphs)!=null?n:[];let s=0;return r.map(o=>{const i=this.slice(s,o.startIndex);return s=o.startIndex,i})}getTextRuns(){var e,n;return((n=(e=this._data.body)==null?void 0:e.textRuns)!=null?n:[]).map(r=>({...r,ts:r.ts?ds.create(r.ts):null}))}getLinks(){var e,n,r;return(r=(n=(e=this._data.body)==null?void 0:e.customRanges)==null?void 0:n.filter(s=>s.rangeType===gn.HYPERLINK))!=null?r:[]}getData(){return this._data}}class Sn extends un{constructor(e){super(e),_(this,"_doc"),this._doc=new Pe(e)}static newEmptyData(){return np({id:"d",documentStyle:{},drawings:{},drawingsOrder:[],body:{dataStream:`\r
`,customBlocks:[],customRanges:[],paragraphs:[{startIndex:0}],textRuns:[],tables:[],sectionBreaks:[]}})}static create(e){return new Sn(e??Sn.newEmptyData())}insertText(e,n,r){var s,o;let i=((o=(s=this._data.body)==null?void 0:s.dataStream.length)!=null?o:2)-2,a,l;if(typeof e=="string"?a=e:(i=Math.min(e,i),a=n),typeof n=="object"?l=n instanceof fn?n.build():n:l=r instanceof fn?r.build():r,!a)return this;const u={dataStream:a,textRuns:l?[{ts:l,st:i,ed:i+a.length}]:[]},c=te.selection.replace({doc:this._doc,selection:{startOffset:i,endOffset:i,collapsed:!0},body:u});if(!c)throw new Error("Insert text failed, please check.");return xt.apply(this._doc.getBody(),c.serialize()),this}insertRichText(e,n){var r,s;let o=((s=(r=this._data.body)==null?void 0:r.dataStream.length)!=null?s:2)-2,i;typeof e=="object"?i=e instanceof un?e.getData():e:(o=Math.min(e,o),i=n instanceof un?n.getData():n);const a=te.selection.replace({doc:this._doc,selection:{startOffset:o,endOffset:o,collapsed:!0},body:i.body});if(!a)throw new Error("Insert text failed, please check.");return xt.apply(this._doc.getBody(),a.serialize()),this}delete(e,n){if(n!==void 0){if(!n)return this;const r=te.selection.delete([{startOffset:e,endOffset:e+n,collapsed:!0}],this._data.body);xt.apply(this._doc.getBody(),r)}return this}setStyle(e,n,r){const s={dataStream:"",textRuns:[{ts:r instanceof fn?r.build():r,st:0,ed:n-e}]},o=te.selection.retain([{startOffset:e,endOffset:n,collapsed:!0}],s);return xt.apply(this._doc.getBody(),o),this}setLink(e,n,r){const s=te.customRange.add({rangeType:gn.HYPERLINK,rangeId:re(),properties:{url:r},ranges:[{startOffset:e,endOffset:n,collapsed:!1}],body:this._data.body});if(!s)throw new Error("Insert text failed, please check.");return xt.apply(this._doc.getBody(),s.serialize()),this}cancelLink(e,n){if(typeof e=="string"){const r=te.customRange.delete({rangeId:e,documentDataModel:this._doc});if(!r)throw new Error("Insert text failed, please check.");xt.apply(this._doc.getBody(),r.serialize())}else this.slice(e,n).getLinks().forEach(r=>{const s=te.customRange.delete({rangeId:r.rangeId,documentDataModel:this._doc});if(!s)throw new Error("Insert text failed, please check.");xt.apply(this._doc.getBody(),s.serialize())});return this}updateLink(e,n){var r,s;const o=(s=(r=this._data.body)==null?void 0:r.customRanges)==null?void 0:s.find(i=>i.rangeId===e);if(!o)throw new Error("Link not found");return o.properties.url=n,this}insertParagraph(e,n){var r,s;let o,i;return typeof e=="object"?(o={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:e.build()}]},i=((s=(r=this._data.body)==null?void 0:r.dataStream.length)!=null?s:2)-2):(i=e,o={dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:n?.build()}]}),this.insertRichText(i,un.create({body:o,id:"d",documentStyle:{}})),this}insertLink(e,n,r){let s="",o="";typeof e=="string"?(s=e,o=n):(s=n,o=r);const i=Sn.createByBody({dataStream:s,customRanges:[{rangeType:gn.HYPERLINK,rangeId:re(),properties:{url:o},startIndex:0,endIndex:s.length-1}]});return typeof e=="number"?this.insertRichText(e,i):this.insertRichText(i)}}const ub="__default_document_sub_component_id20231101__";class rp{constructor(){_(this,"skipNextObservers",!1),_(this,"lastReturnValue"),_(this,"isStopPropagation",!1)}stopPropagation(){this.isStopPropagation=!0}}class cb extends se{constructor(){super(...arguments),_(this,"_sortedObservers",[])}unsubscribe(){super.unsubscribe(),this._sortedObservers.length=0}complete(){super.complete(),this._sortedObservers.length=0}subscribeEvent(e){let n;typeof e=="function"?n={next:([s,o])=>e(s,o)}:n=e;const r=super.subscribe(n);return this._sortedObservers.push(n),this._sortedObservers.sort((s,o)=>{var i,a;return((i=s.priority)!=null?i:0)-((a=o.priority)!=null?a:0)}),r.add(()=>this._sortedObservers=this._sortedObservers.filter(s=>s!==n)),r}clearObservers(){this._sortedObservers.forEach(e=>{var n;return(n=e.complete)==null?void 0:n.call(e)}),this._sortedObservers.length=0}emitEvent(e){var n;if(!this.closed){const r=new rp;r.lastReturnValue=e;for(const s of this._sortedObservers){const o=(n=s.next)==null?void 0:n.call(s,[e,r]);if(r.lastReturnValue=o,r.skipNextObservers)return{handled:!0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}return{handled:this._sortedObservers.length>0,lastReturnValue:r.lastReturnValue,stopPropagation:r.isStopPropagation}}throw new Error("[EventSubject]: cannot emit event on a closed subject.")}}function hb(t){return new ee(e=>{const n=t.subscribeEvent(r=>{e.next(r)});return()=>n.unsubscribe()})}const Uo=ue("core.resource-manager.service"),na={[vt.Editor]:"Editor",[vt.Owner]:"Owner",[vt.Reader]:"Reader",[vt.UNRECOGNIZED]:"UNRECOGNIZED"},oo=t=>t?{userID:`${na[t]}_${re(8)}`,name:na[t],avatar:""}:{userID:"",name:"",avatar:"",anonymous:!0,canBindAnonymous:!1},db=(t,e)=>t.startsWith(na[e]);class qr extends Xt{constructor(){super(...arguments),_(this,"_model",new Map),_(this,"_userChange$",new se),_(this,"userChange$",this._userChange$.asObservable()),_(this,"_currentUser$",new ie(oo())),_(this,"currentUser$",this._currentUser$.asObservable())}dispose(){super.dispose(),this._model.clear(),this._userChange$.complete(),this._currentUser$.complete()}getCurrentUser(){return this._currentUser$.getValue()}setCurrentUser(e){this.addUser(e),this._currentUser$.next(e)}addUser(e){this._model.set(e.userID,e),this._userChange$.next({type:"add",user:e})}getUser(e,n){const r=this._model.get(e);if(r)return r;n&&n()}delete(e){const n=this.getUser(e);this._model.delete(e),n&&this._userChange$.next({type:"delete",user:n})}clear(){this._model.clear(),this._userChange$.next({type:"clear"})}list(){return Array.from(this._model.values())}}var fb=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},ec=(t,e)=>(n,r)=>e(n,r,t);let io=class{constructor(t,e){_(this,"_permissionMap",new Map([])),_(this,"_permissionOverrides",new Map),this._resourceManagerService=t,this._userManagerService=e,this._initSnapshot(),this._initDefaultUser()}_initDefaultUser(){const t=this._userManagerService.getCurrentUser();t&&t.userID||this._userManagerService.setCurrentUser(oo(vt.Owner))}_getRole(t){const e=this._userManagerService.getCurrentUser();return e?db(e.userID,t):!1}_initSnapshot(){this._resourceManagerService.registerPluginResource({toJson:t=>{const e=[...this._permissionMap.keys()].reduce((n,r)=>{const s=this._permissionMap.get(r);return n[r]=s,n},{});return JSON.stringify(e)},parseJson:t=>JSON.parse(t),pluginName:"SHEET_AuthzIoMockService_PLUGIN",businesses:[bt.UNIVER_SHEET,bt.UNIVER_DOC,bt.UNIVER_SLIDE],onLoad:(t,e)=>{for(const n in e)this._permissionMap.set(n,e[n])},onUnLoad:()=>{this._permissionMap.clear()}})}async create(t){const e=re(8),{objectType:n,selectRangeObject:r,worksheetObject:s}=t,o=r||s,i={objectType:n,unitID:o?.unitID||"",name:o?.name||"",strategies:[{action:6,role:vt.Owner},{action:16,role:vt.Owner},{action:17,role:vt.Owner},{action:18,role:vt.Owner},{action:19,role:vt.Owner},{action:33,role:vt.Owner},{action:34,role:vt.Owner},{action:35,role:vt.Owner},{action:36,role:vt.Owner},{action:37,role:vt.Owner},{action:38,role:vt.Owner},{action:39,role:vt.Owner},{action:40,role:vt.Owner}],selectRangeObject:r};return this._permissionMap.set(e,i),e}async allowed(t){const{objectID:e,actions:n}=t,r=this._permissionMap.get(e);return r?n.map(s=>{const o=`${e}:${s}`;if(this._permissionOverrides.has(o))return{action:s,allowed:this._permissionOverrides.get(o)};const i=r.strategies.find(a=>a.action===s);return i?{action:s,allowed:this._getRole(i.role)}:{action:s,allowed:this._getRole(vt.Owner)||this._getRole(vt.Editor)}}):n.map(s=>({action:s,allowed:this._getRole(vt.Owner)||this._getRole(vt.Editor)}))}async batchAllowed(t){const e=await Promise.all(t.map(n=>this.allowed(n)));return t.map((n,r)=>({unitID:n.unitID,objectID:n.objectID,actions:e[r]}))}async list(t){const e=[],n=[{action:6,role:vt.Owner},{action:16,role:vt.Owner},{action:17,role:vt.Owner},{action:18,role:vt.Owner},{action:19,role:vt.Owner},{action:33,role:vt.Owner},{action:34,role:vt.Owner},{action:35,role:vt.Owner},{action:36,role:vt.Owner},{action:37,role:vt.Owner},{action:38,role:vt.Owner},{action:39,role:vt.Owner},{action:40,role:vt.Owner}];return t.objectIDs.forEach(r=>{const s=this._permissionMap.get(r),o=s?.strategies||n,i={objectID:r,unitID:t.unitID,objectType:s?.objectType||3,name:s?.name||"",shareOn:!1,shareRole:vt.Owner,shareScope:-1,scope:{read:vi.AllCollaborator,edit:vi.AllCollaborator},creator:oo(vt.Owner),strategies:o.map(a=>({action:a.action,role:a.role})),actions:t.actions.map(a=>{const l=`${r}:${a}`;if(this._permissionOverrides.has(l))return{action:a,allowed:this._permissionOverrides.get(l)};const u=o.find(c=>c.action===a);if(!u){const c=this._getRole(vt.Owner)||this._getRole(vt.Editor);return{action:a,allowed:c}}return{action:a,allowed:this._getRole(u.role)}})};e.push(i)}),e}async listCollaborators(){return[]}async listRoles(){return{roles:[],actions:[]}}async deleteCollaborator(){}async update(t){const{objectID:e,strategies:n}=t,r=this._permissionMap.get(e);r&&n&&(r.strategies=n.map(s=>({action:s.action,role:s.role})),this._permissionMap.set(e,r),n.forEach(s=>{s.role===vt.Reader?this.setPermissionOverride(e,s.action,!1):(s.role===vt.Owner||s.role===vt.Editor)&&this.clearPermissionOverride(e,s.action)}))}setPermissionOverride(t,e,n){const r=`${t}:${e}`;this._permissionOverrides.set(r,n)}clearPermissionOverride(t,e){const n=`${t}:${e}`;this._permissionOverrides.delete(n)}clearAllOverrides(t){const e=[];this._permissionOverrides.forEach((n,r)=>{r.startsWith(`${t}:`)&&e.push(r)}),e.forEach(n=>this._permissionOverrides.delete(n))}async updateCollaborator(){}async createCollaborator(){}async putCollaborators(t){}};io=fb([ec(0,Uo),ec(1,Ce(qr))],io);const sp=ue("IAuthzIoIoService"),pb=ue("univer.confirm-service");class gb{constructor(){_(this,"confirmOptions$",new se)}dispose(){this.confirmOptions$.complete()}open(e){throw new Error("This is not implemented in the test service!")}confirm(e){return Promise.resolve(!0)}close(e){throw new Error("This is not implemented in the test service!")}}const Pr="FOCUSING_UNIT",sr="FOCUSING_SHEET",Br="FOCUSING_DOC",$r="FOCUSING_SLIDE",mb="FOCUSING_EDITOR_BUT_HIDDEN",op="EDITOR_ACTIVATED",_b="FOCUSING_EDITOR_INPUT_FORMULA",ip="FOCUSING_FX_BAR_EDITOR",yb="FOCUSING_UNIVER_EDITOR",Eb="FOCUSING_EDITOR_INPUT_FORMULA",vb="FOCUSING_COMMENT_EDITOR",Cb="FOCUSING_PANEL_EDITOR",Rb="FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE",bb="FOCUSING_COMMON_DRAWINGS",Tb="FOCUSING_SHAPE_TEXT_EDITOR",Ib="FORMULA_EDITOR_ACTIVATED";class ap extends Xt{constructor(){super(...arguments),_(this,"_error$",new se),_(this,"error$",this._error$.asObservable())}dispose(){this._error$.complete()}emit(e){this._error$.next({errorKey:e})}}var ao=(t=>(t.URL="URL",t.UUID="UUID",t.BASE64="BASE64",t))(ao||{}),lp=(t=>(t.SUCCUSS="0",t.ERROR_EXCEED_SIZE="1",t.ERROR_IMAGE_TYPE="2",t.ERROR_UPLOAD_COUNT_LIMIT="3",t.ERROR_IMAGE="4",t))(lp||{});const ra=ue("core.image-io.service"),sa=ue("core.url-image.service"),wb="0.15.5",Sb={version:wb};function Ab(t="",e=ss.ZH_CN,n=""){return{id:t,sheetOrder:[],name:n,appVersion:Sb.version,locale:e,styles:{},sheets:{},resources:[]}}class up{constructor(e={}){_(this,"_styles"),_(this,"_cacheMap",new Mo(1e5)),this._styles=e,this._generateCacheMap()}each(e){return Object.entries(this._styles).forEach(e),this}search(e,n){return this._cacheMap.has(n)?this._cacheMap.get(n):this._getExistingStyleId(e)||"-1"}get(e){return typeof e!="string"?e:(e=String(e),this._styles[e])}add(e,n){const r=re(6);return this._styles[r]=e,this._cacheMap.set(n,r),r}setValue(e){if(e==null)return;const n=JSON.stringify(e),r=this.search(e,n);return r!=="-1"?r:this.add(e,n)}addCustomStyle(e,n){n!=null&&(this._styles[e]=n,this._cacheMap.set(JSON.stringify(n),e))}remove(e){const n=this._styles[e];n&&(delete this._styles[e],this._cacheMap.delete(JSON.stringify(n)))}toJSON(){return this._styles}getStyleByCell(e){let n;e&&q.isObject(e.s)?n=e.s:n=e?.s&&this.get(e.s);const r=e?.interceptorStyle;return r?{...n,...r}:n}_generateCacheMap(){const{_styles:e,_cacheMap:n}=this;for(const r in e){const s=JSON.stringify(e[r]);n.set(s,r)}}_getExistingStyleId(e){const{_styles:n}=this;for(const r in n)if(q.diffValue(n[r],e))return r;return null}}const Ob=(t,e)=>e.length===t.length&&!t.some(n=>e.some(r=>!xn.equals(r,n))),Db=(t,e)=>e.length===t.length&&t.every((n,r)=>{const s=e[r];return s.unitId===n.unitId&&s.sheetId===n.sheetId&&xn.equals(n.range,s.range)}),oa={t:0,b:2,l:2,r:2},Nb=t=>({sbr:.6,sbo:t,spr:.6,spo:t}),nc=90;function Hr(t,e,n={}){const r=t.length,{textRotation:s,paddingData:o,horizontalAlign:i=Fe.UNSPECIFIED,verticalAlign:a=In.UNSPECIFIED,wrapStrategy:l=Dn.UNSPECIFIED,cellValueType:u}=n,{t:c,r:h,b:d,l:f}=o||oa,{vertexAngle:p,centerAngle:m}=dp(s),R={id:"d",body:{dataStream:`${t}${Kc}`,textRuns:[{ts:e,st:0,ed:r}],paragraphs:[{startIndex:r,paragraphStyle:{horizontalAlign:i}}],sectionBreaks:[{startIndex:r+1}]},documentStyle:{pageSize:{width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},marginTop:c,marginBottom:d,marginRight:h,marginLeft:f,renderConfig:{horizontalAlign:i,verticalAlign:a,centerAngle:m,vertexAngle:p,wrapStrategy:l,cellValueType:u}},drawings:{},drawingsOrder:[]};return new Pe(R)}function xb(t){if(!t)return{};const{tr:e,td:n,ht:r,vt:s,tb:o,pd:i}=t;return{textRotation:e,textDirection:n,horizontalAlign:r,verticalAlign:s,wrapStrategy:o,paddingData:i}}function rc(t){if(!t)return{};const{ff:e,fs:n,it:r,bl:s,ul:o,st:i,ol:a,cl:l}=t,u={};return e&&(u.ff=e),n&&(u.fs=n),r&&(u.it=r),s&&(u.bl=s),o&&(u.ul=o),i&&(u.st=i),a&&(u.ol=a),l&&(u.cl=l),u}function cp(t,e,n){var r;const s=t.getBody();if((r=s.customRanges)!=null&&r.some(i=>i.rangeType===gn.HYPERLINK))return;const o=te.customRange.add({ranges:[{startOffset:0,endOffset:s.dataStream.length-1,collapsed:!1}],rangeId:n,rangeType:gn.HYPERLINK,body:s,properties:{url:e,refId:n}});o&&xt.apply(s,o.serialize())}function hp(t){return t!=null}function Mb(){return{p:null,s:null,v:null,t:null,f:null,si:null,ref:null,xf:null}}const Lb='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';function sc(t){const e=le.ff,n=le.fs;if(!t){const h=`${n}pt  ${e}`;return{fontCache:h,fontString:h,fontSize:n,originFontSize:n,fontFamily:e}}let r=tr.ITALIC;(t.it===0||t.it===void 0)&&(r=tr.NORMAL);let s=tr.BOLD;(t.bl===0||t.bl===void 0)&&(s=tr.NORMAL);let o=n;t.fs&&(o=Math.ceil(t.fs));let i=e;if(t.ff){let h=t.ff;h=h.replace(/"/g,"").replace(/'/g,""),h.indexOf(" ")>-1&&(h=`"${h}"`),h==null&&(h=e),i=h}const{va:a}=t;let l=o;if(a===tn.SUBSCRIPT||a===tn.SUPERSCRIPT){const h=Ub(i,l),{sbr:d,spr:f}=h;l*=a===tn.SUBSCRIPT?d:f}const u=`${r} ${s} ${l}pt ${i}`,c=`${u}, ${Lb} `;return{fontCache:u,fontString:c,fontSize:l,originFontSize:o,fontFamily:i}}function Ub(t,e){return Nb(e)}function dp(t){const{a:e=0,v:n=ot.FALSE}=t||{a:0,v:ot.FALSE};let r=0,s=e;return n===ot.TRUE&&(r=nc,s=nc),{centerAngle:r,vertexAngle:s}}function ve(t){if(t==null||typeof t!="object")return t;if(Array.isArray(t)){const r=t.length,s=new Array(r);for(let o=0;o<r;o++)s[o]=ve(t[o]);return s}const e={},n=Object.keys(t);for(let r=0,s=n.length;r<s;r++){const o=n[r];e[o]=ve(t[o])}return e}function fp(t){if(t==null)return t;const e={};return t.p!==void 0&&(e.p=t.p===null?null:ve(t.p)),t.s!==void 0&&(t.s===null||typeof t.s=="string"?e.s=t.s:e.s=ve(t.s)),t.v!==void 0&&(e.v=t.v),t.t!==void 0&&(e.t=t.t),t.f!==void 0&&(e.f=t.f),t.ref!==void 0&&(e.ref=t.ref),t.xf!==void 0&&(e.xf=t.xf),t.si!==void 0&&(e.si=t.si),t.custom!==void 0&&(e.custom=t.custom===null?null:ve(t.custom)),e}function Fb(t){if(t==null)return t;const e={};return t.p!==void 0&&(e.p=t.p===null?null:ve(t.p)),t.s!==void 0&&(t.s===null||typeof t.s=="string"?e.s=t.s:e.s=ve(t.s)),t.v!==void 0&&(e.v=t.v),t.t!==void 0&&(e.t=t.t),t.f!==void 0&&(e.f=t.f),t.ref!==void 0&&(e.ref=t.ref),t.xf!==void 0&&(e.xf=t.xf),t.si!==void 0&&(e.si=t.si),t.custom!==void 0&&(e.custom=t.custom===null?null:ve(t.custom)),t.rowSpan!==void 0&&(e.rowSpan=t.rowSpan),t.colSpan!==void 0&&(e.colSpan=t.colSpan),t.displayV!==void 0&&(e.displayV=t.displayV),e}function pp(t){const e={},n=Object.keys(t);for(let r=0,s=n.length;r<s;r++){const o=n[r],i=Number(o),a=t[i];if(a===void 0)continue;const l={},u=Object.keys(a);for(let c=0,h=u.length;c<h;c++){const d=u[c],f=Number(d),p=a[f];p!=null&&(l[f]=fp(p))}e[i]=l}return e}function oc(t){const e={},n=Object.keys(t);for(let r=0,s=n.length;r<s;r++){const o=n[r],i=Number(o),a=t[i];if(a===void 0)continue;const l={};"h"in a&&a.h!==void 0&&(l.h=a.h),"ia"in a&&a.ia!==void 0&&(l.ia=a.ia),"ah"in a&&a.ah!==void 0&&(l.ah=a.ah),"hd"in a&&a.hd!==void 0&&(l.hd=a.hd),"w"in a&&a.w!==void 0&&(l.w=a.w),"s"in a&&a.s!==void 0&&(a.s===null||typeof a.s=="string"?l.s=a.s:l.s=ve(a.s)),"custom"in a&&a.custom!==void 0&&(l.custom=a.custom===null?null:ve(a.custom)),e[i]=l}return e}function kb(t){const e=t.length,n=new Array(e);for(let r=0;r<e;r++){const s=t[r];n[r]={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn,rangeType:s.rangeType,startAbsoluteRefType:s.startAbsoluteRefType,endAbsoluteRefType:s.endAbsoluteRefType}}return n}function gp(t){const e={id:t.id,name:t.name,tabColor:t.tabColor,hidden:t.hidden,rowCount:t.rowCount,columnCount:t.columnCount,zoomRatio:t.zoomRatio,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,defaultColumnWidth:t.defaultColumnWidth,defaultRowHeight:t.defaultRowHeight,showGridlines:t.showGridlines,rightToLeft:t.rightToLeft,freeze:{xSplit:t.freeze.xSplit,ySplit:t.freeze.ySplit,startRow:t.freeze.startRow,startColumn:t.freeze.startColumn},rowHeader:{width:t.rowHeader.width,hidden:t.rowHeader.hidden},columnHeader:{height:t.columnHeader.height,hidden:t.columnHeader.hidden},mergeData:kb(t.mergeData),cellData:pp(t.cellData),rowData:oc(t.rowData),columnData:oc(t.columnData)};return t.gridlinesColor!==void 0&&(e.gridlinesColor=t.gridlinesColor),t.defaultStyle!==void 0&&(t.defaultStyle===null||typeof t.defaultStyle=="string"?e.defaultStyle=t.defaultStyle:e.defaultStyle=ve(t.defaultStyle)),t.custom!==void 0&&(e.custom=t.custom===null?null:ve(t.custom)),e}class Pb{constructor(e,n){_(this,"_columnData",{}),this._config=e,this._columnData=n}getColumnData(){return this._columnData}getColVisible(e){const{_columnData:n}=this,r=n[e];return r?r.hd!==ot.TRUE:!0}getColumnStyle(e){var n;return(n=this._columnData[e])==null?void 0:n.s}setColumnStyle(e,n){const r=this.getColumnOrCreate(e);r.s=n}getHiddenCols(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getColVisible(i);s&&a?(s=!1,r.push({rangeType:gt.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):!s&&!a&&(s=!0,o=i)}return s&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:gt.COLUMN}),r}getVisibleCols(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getColVisible(i);s&&!a?(s=!1,r.push({rangeType:gt.COLUMN,startColumn:o,endColumn:i-1,startRow:0,endRow:0})):!s&&a&&(s=!0,o=i)}return s&&r.push({startRow:0,endRow:0,startColumn:o,endColumn:n,rangeType:gt.COLUMN}),r}getColumnDatas(e,n){const r={};let s=0;for(let o=e;o<e+n;o++){const i=this.getColumn(o);r[s]=i??{w:this._config.defaultColumnWidth,hd:ot.FALSE},s++}return r}getSize(){return dn(this._columnData)}getColumnWidth(e){var n,r;return(r=(n=this._columnData[e])==null?void 0:n.w)!=null?r:this._config.defaultColumnWidth}setColumnWidth(e,n){const r=this._columnData[e];n===this._config.defaultColumnWidth?r&&(delete r.w,Object.keys(r).length===0&&delete this._columnData[e]):this._columnData[e]=r?{...r,w:n}:{w:n}}getColumn(e){return this._columnData[e]}insertColumnsWithData(e,n,r){const s=n-e+1,o=Object.keys(this._columnData);for(let i=o.length-1;i>=0;i--){const a=Number(o[i]);a>=e&&(this._columnData[a+s]=this._columnData[a],delete this._columnData[a])}for(let i=e;i<=n;i++){const a=r?.[i-e];a!=null&&Object.keys(a).length>0&&(this._columnData[i]={...a})}}removeColumn(e){delete this._columnData[e]}getColumnOrCreate(e){const{_columnData:n}=this,r=n[e];if(r)return r;const s={};return this._columnData[e]=s,s}setCustomMetadata(e,n){const r=this.getColumn(e);r&&(r.custom=n)}getCustomMetadata(e){var n;return(n=this.getColumn(e))==null?void 0:n.custom}}const Bb=2e3;class $b{constructor(e,n,r){_(this,"_rowData"),this._config=e,this._viewModel=n,this._rowData=r}getRowData(){return this._rowData}getRowStyle(e){var n;return(n=this._rowData[e])==null?void 0:n.s}setRowStyle(e,n){const r=this.getRowOrCreate(e);r.s=n}getRowDatas(e,n){const r={};let s=0;for(let o=e;o<e+n;o++){const i=this.getRow(o);r[s]=i??{h:this._config.defaultRowHeight,hd:ot.FALSE},s++}return r}getRowHeight(e,n=1){const{_rowData:r}=this,s=this._config;let o=0;for(let i=0;i<n;i++){const a=r[i+e]||{hd:ot.FALSE,h:s.defaultRowHeight},{ia:l,ah:u,h:c=s.defaultRowHeight}=a;o+=(l==null||l===ot.TRUE)&&typeof u=="number"?u:c}return o}setRowHeight(e,n){const r=this._rowData[e];if(n===this._config.defaultRowHeight)r&&(delete r.h,Object.keys(r).length===0&&delete this._rowData[e]);else{const s=Math.min(n,Bb);this._rowData[e]=r?{...r,h:s}:{h:s}}}getRow(e){return this._rowData[e]}insertRowsWithData(e,n,r){const s=n-e+1,o=Object.keys(this._rowData);for(let i=o.length-1;i>=0;i--){const a=Number(o[i]);a>=e&&(this._rowData[a+s]=this._rowData[a],delete this._rowData[a])}for(let i=e;i<=n;i++){const a=r?.[i-e];a!=null&&Object.keys(a).length>0&&(this._rowData[i]={...a})}}removeRow(e){delete this._rowData[e]}getRowOrCreate(e){const{_rowData:n}=this,r=n[e];if(r)return r;const s={};return n[e]=s,s}getHiddenRows(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getRowRawVisible(i);s&&a?(s=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:gt.ROW})):!s&&!a&&(s=!0,o=i)}return s&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:gt.ROW}),r}getVisibleRows(e=0,n=this.getSize()-1){const r=[];let s=!1,o=-1;for(let i=e;i<=n;i++){const a=this.getRowRawVisible(i);s&&!a?(s=!1,r.push({startRow:o,endRow:i-1,startColumn:0,endColumn:0,rangeType:gt.ROW})):!s&&a&&(s=!0,o=i)}return s&&r.push({startRow:o,endRow:n,startColumn:0,endColumn:0,rangeType:gt.ROW}),r}getRowRawVisible(e){const n=this.getRow(e);return n?n.hd!==ot.TRUE:!0}getSize(){return dn(this._rowData)}setCustomMetadata(e,n){const r=this.getRow(e);r&&(r.custom=n)}getCustomMetadata(e){var n;return(n=this.getRow(e))==null?void 0:n.custom}}const Hb="DEFAULT_WORKSHEET_ROW_COUNT",mp=1e3,jb="DEFAULT_WORKSHEET_COLUMN_COUNT",_p=20,Wb="DEFAULT_WORKSHEET_ROW_HEIGHT",yp=24,Vb="DEFAULT_WORKSHEET_COLUMN_WIDTH",Ep=88,Gb="DEFAULT_WORKSHEET_ROW_TITLE_WIDTH",vp=46,Yb="DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT",Cp=20;function Rp(t){const e={name:"Sheet1",id:"sheet-01",tabColor:"",hidden:ot.FALSE,rowCount:mp,columnCount:_p,zoomRatio:1,freeze:{xSplit:0,ySplit:0,startRow:-1,startColumn:-1},scrollTop:0,scrollLeft:0,defaultColumnWidth:Ep,defaultRowHeight:yp,mergeData:[],cellData:{},rowData:{},columnData:{},showGridlines:ot.TRUE,rowHeader:{width:vp,hidden:ot.FALSE},columnHeader:{height:Cp,hidden:ot.FALSE},rightToLeft:ot.FALSE};return Object.keys(e).forEach(n=>{const r=n;typeof t[r]>"u"&&(t[r]=e[r])}),t}class zb extends Xt{constructor(e){super(),_(this,"_cellCache",new Map),_(this,"_rowCache",new Map),_(this,"_columnCache",new Map),_(this,"_hasRow",!1),_(this,"_hasColumn",!1),_(this,"_hasAll",!1),_(this,"_allIndex",-1),_(this,"_mergeData"),_(this,"_rangeMap",new Mo(5e4)),this._init(e.concat())}_init(e){this._mergeData=e,this._createCache(e)}_clearCache(){this._cellCache.clear(),this._rowCache.clear(),this._columnCache.clear(),this._hasAll=!1,this._allIndex=-1,this._rangeMap.clear(),this._hasColumn=!1,this._hasRow=!1}_createCache(e){let n=0;for(const r of e){const{rangeType:s}=r;s===gt.ROW?this._createRowCache(r,n):s===gt.COLUMN?this._createColumnCache(r,n):s===gt.ALL?this._createCellAllCache(n):this._createCellCache(r,n),n++}}rebuild(e){this._clearCache(),this._init(e.concat())}_createRowCache(e,n){const{startRow:r,endRow:s}=e;for(let o=r;o<=s;o++)this._rowCache.set(o,n),this._hasRow=!0}_createColumnCache(e,n){const{startColumn:r,endColumn:s}=e;for(let o=r;o<=s;o++)this._columnCache.set(o,n),this._hasColumn=!0}_createCellAllCache(e){this._hasAll=!0,this._allIndex=e}_createCellCache(e,n){for(let r=e.startRow;r<=e.endRow;r++){let s=this._cellCache.get(r);s==null&&(s=new Map,this._cellCache.set(r,s));for(let o=e.startColumn;o<=e.endColumn;o++)s.set(o,n)}}add(e){this._mergeData.push(e),this._clearCache(),this._createCache(this._mergeData)}remove(e,n){const r=this._getMergeDataIndex(e,n);r!==-1&&(this._mergeData.splice(r,1),this._clearCache(),this._createCache(this._mergeData))}getMergedCell(e,n){const r=this._getMergeDataIndex(e,n);return r!==-1?this._mergeData[r]:null}getMergeDataIndex(e,n){return this._getMergeDataIndex(e,n)}isRowContainsMergedCell(e){return this._hasAll||!q.isEmptyObject(this._columnCache)?!0:this._mergeData.some(n=>n.startRow<=e&&e<=n.endRow)}isColumnContainsMergedCell(e){return this._hasAll||!q.isEmptyObject(this._rowCache)?!0:this._mergeData.some(n=>n.startColumn<=e&&e<=n.endColumn)}getMergedCellRange(e,n,r,s){const o=[],i=`${e}-${n}-${r}-${s}`;if(this._rangeMap.has(i))return this._getRangeFromCache(i);let a=0;const l=[];for(const u of this._mergeData||[])xn.intersects(u,{startRow:e,endRow:r,startColumn:n,endColumn:s})&&(o.push({...u}),l.push(a)),a++;return this._rangeMap.set(i,l),o}_getRangeFromCache(e){const n=this._rangeMap.get(e)||[],r=[];for(const s of n)r.push({...this._mergeData[s]});return r}_getMergeDataIndex(e,n){var r;if(this._hasAll)return this._allIndex;if(this._hasRow){const o=this._rowCache.get(e);if(o!==void 0)return o}if(this._hasColumn){const o=this._columnCache.get(n);if(o!==void 0)return o}const s=(r=this._cellCache.get(e))==null?void 0:r.get(n);return s!==void 0?s:-1}getMergeDataSnapshot(){return this._mergeData}dispose(){this._clearCache(),this._mergeData=[]}}class bp extends Xt{constructor(e){super(),_(this,"_cellContentInterceptor",null),_(this,"_rowFilteredInterceptor",null),this.getRawCell=e}dispose(){super.dispose(),this._cellContentInterceptor=null,this._rowFilteredInterceptor=null}getCell(e,n,r,s){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Zn.Value|Zn.Style,r,s):this.getRawCell(e,n)}getCellValueOnly(e,n){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Zn.Value):this.getRawCell(e,n)}getCellStyleOnly(e,n){return this._cellContentInterceptor?this._cellContentInterceptor.getCell(e,n,Zn.Style):this.getRawCell(e,n)}getRowFiltered(e){var n,r;return(r=(n=this._rowFilteredInterceptor)==null?void 0:n.getRowFiltered(e))!=null?r:!1}registerCellContentInterceptor(e){if(this._cellContentInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._cellContentInterceptor=e,Wt(()=>this._cellContentInterceptor=null)}registerRowFilteredInterceptor(e){if(this._rowFilteredInterceptor)throw new Error("[SheetViewModel]: Interceptor already registered.");return this._rowFilteredInterceptor=e,Wt(()=>this._rowFilteredInterceptor=null)}}const ic={isDeepClone:!1,displayRawFormula:!1,ignoreTextRotation:!1};class Zr{constructor(e,n,r){_(this,"_sheetId"),_(this,"_snapshot"),_(this,"_cellData"),_(this,"_rowManager"),_(this,"_columnManager"),_(this,"_viewModel"),_(this,"_spanModel"),_(this,"_isRowStylePrecedeColumnStyle",!0),_(this,"_getCellHeight");var s;this.unitId=e,this._styles=r,this._snapshot=Rp(n);const{columnData:o,rowData:i,cellData:a}=this._snapshot;this._sheetId=(s=this._snapshot.id)!=null?s:re(6),this._cellData=new fe(a),this._viewModel=new bp((l,u)=>this.getCellRaw(l,u)),this._rowManager=new $b(this._snapshot,this._viewModel,i),this._columnManager=new Pb(this._snapshot,o),this._spanModel=new zb(this._snapshot.mergeData)}__interceptViewModel(e){e(this._viewModel)}__registerGetCellHeight(e){return this._getCellHeight=e,Wt(()=>{this._getCellHeight=null})}getSnapshot(){return this._snapshot}getCellHeight(e,n){return this._getCellHeight?this._getCellHeight(e,n):this._snapshot.defaultRowHeight}setMergeData(e){this._snapshot.mergeData=e,this.getSpanModel().rebuild(e)}getSpanModel(){return this._spanModel}setIsRowStylePrecedeColumnStyle(e){this._isRowStylePrecedeColumnStyle=e}getStyleDataByHash(e){return{...this._styles.get(e)}}setStyleData(e){return this._styles.setValue(e)}getColumnStyle(e,n=!1){return n?this._columnManager.getColumnStyle(e):this._styles.get(this._columnManager.getColumnStyle(e))}setColumnStyle(e,n){this._columnManager.setColumnStyle(e,n)}getRowStyle(e,n=!1){return n?this._rowManager.getRowStyle(e):this._styles.get(this._rowManager.getRowStyle(e))}setRowStyle(e,n){this._rowManager.setRowStyle(e,n)}getDefaultCellStyle(){return this._snapshot.defaultStyle}getDefaultCellStyleInternal(){const e=this._snapshot.defaultStyle;return this._styles.get(e)}setDefaultCellStyle(e){this._snapshot.defaultStyle=e}getCellStyle(e,n){const r=this.getCell(e,n);if(r){const s=r.s;return typeof s=="string"?this._styles.get(s):s}return null}getComposedCellStyle(e,n,r){const s=this.getDefaultCellStyleInternal(),o=this.getRowStyle(e),i=this.getColumnStyle(n),a=this.getCell(e,n),l=this._styles.getStyleByCell(a);return r??this._isRowStylePrecedeColumnStyle?wr(s,i,o,a?.themeStyle,l):wr(s,o,i,a?.themeStyle,l)}getComposedCellStyleByCellData(e,n,r,s){const o=this.getDefaultCellStyleInternal(),i=this.getRowStyle(e),a=this.getColumnStyle(n),l=this._styles.getStyleByCell(r);return s??this._isRowStylePrecedeColumnStyle?wr(o,a,i,r?.themeStyle,l):wr(o,i,a,r?.themeStyle,l)}getComposedCellStyleWithoutSelf(e,n,r,s){const o=r===void 0?this.getComposedCellStyle(e,n,s):this.getComposedCellStyleByCellData(e,n,r,s),i=this.getCellRaw(e,n);if(!i||!i.s)return o;const a=typeof i.s=="string"?this._styles.get(i.s):i.s;if(!a)return o;for(const l in a)l in o&&delete o[l];return o}getCellMatrix(){return this._cellData}getCellMatrixPrintRange(){const e=this.getCellMatrix(),n=this.getMergeData();let r=-1,s=-1,o=-1,i=-1,a=!1,l=!1;return e.forEach((u,c)=>{Object.keys(c).forEach(h=>{const d=+h,f=e.getValue(u,d),p=f!=null&&f.s?this._styles.get(f.s):null,m=p?.bd&&(p.bd.b||p.bd.l||p.bd.r||p.bd.t||p.bd.bc_tr||p.bd.bl_tr||p.bd.ml_tr||p.bd.tl_bc||p.bd.tl_br||p.bd.tl_mr);(f&&(f.v!==null&&f.v!==void 0&&f.v!==""||f.p)||p!=null&&p.bg||m)&&(a?r=Math.min(r,u):(r=u,a=!0),s=Math.max(s,u),l?o=Math.min(o,d):(l=!0,o=d),i=Math.max(i,d))})}),n.forEach(u=>{a?r=Math.min(r,u.startRow):(r=u.startRow,a=!0),s=Math.max(s,u.endRow),l?o=Math.min(o,u.startColumn):(o=u.startColumn,a=!0),i=Math.max(i,u.endColumn)}),!a||!l?null:{startColumn:o,startRow:r,endColumn:i,endRow:s}}getRowManager(){return this._rowManager}getUnitId(){return this.unitId}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}getName(){return this._snapshot.name}clone(){const{_snapshot:e}=this,n=gp(e);return new Zr(this.unitId,n,this._styles)}getMergeData(){return this._spanModel.getMergeDataSnapshot()}getMergedCell(e,n){return this._spanModel.getMergedCell(e,n)}getMergedCellRange(e,n,r,s){return this._spanModel.getMergedCellRange(e,n,r,s)}isRowContainsMergedCell(e){return this._spanModel.isRowContainsMergedCell(e)}isColumnContainsMergedCell(e){return this._spanModel.isColumnContainsMergedCell(e)}getCellInfoInMergeData(e,n){const r=this.getMergedCell(e,n);let s=!1,o=!1,i=e,a=n,l=e,u=n;if(r){const{startRow:c,endRow:h,startColumn:d,endColumn:f}=r;e===c&&n===d?(i=h,a=f,l=c,u=d,o=!0):e>=c&&e<=h&&n>=d&&n<=f&&(i=h,a=f,l=c,u=d,s=!0)}return{actualRow:e,actualColumn:n,isMergedMainCell:o,isMerged:s,endRow:i,endColumn:a,startRow:l,startColumn:u}}getCell(e,n){return e<0||n<0?null:this._viewModel.getCell(e,n)}getCellValueOnly(e,n){return e<0||n<0?null:this._viewModel.getCellValueOnly(e,n)}getCellStyleOnly(e,n){return e<0||n<0?null:this._viewModel.getCellStyleOnly(e,n)}getCellRaw(e,n){return this.getCellMatrix().getValue(e,n)}getCellWithFilteredInterceptors(e,n,r,s){return this._viewModel.getCell(e,n,r,s)}getRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRangeFilterRows(e){const n=[];for(let r=e.startRow;r<=e.endRow;r++)this.getRowFiltered(r)&&n.push(r);return n}getMatrixWithMergedCells(e,n,r,s,o=er.Raw){const i=this.getCellMatrix(),a=this._spanModel.getMergedCellRange(e,n,r,s),l=new fe;return Ki(e,r,n,s).forEach((u,c)=>{var h;let d;if(o===er.Raw)d=this.getCellRaw(u,c);else if(o===er.Intercepted)d=this.getCell(u,c);else if(o===er.Both){const f=this.getCellRaw(u,c);if(f){d={...f};const p=(h=this.getCell(u,c))==null?void 0:h.v;hp(p)&&d&&(d.displayV=String(p))}}d&&l.setValue(u,c,d)}),a.forEach(u=>{const{startColumn:c,startRow:h,endColumn:d,endRow:f}=u;Ki(h,f,c,d).forEach((p,m)=>{p===h&&m===c&&l.setValue(p,m,{...i.getValue(p,m),rowSpan:f-h+1,colSpan:d-c+1}),(p!==h||m!==c)&&l.realDeleteValue(p,m)})}),l}getRange(e,n,r,s){return typeof e=="object"?new eo(this,e,{getStyles:()=>this._styles}):new eo(this,{startRow:e,startColumn:n,endColumn:s||n,endRow:r||e},{getStyles:()=>this._styles})}getScrollLeftTopFromSnapshot(){return{scrollLeft:this._snapshot.scrollLeft,scrollTop:this._snapshot.scrollTop}}getZoomRatio(){return this._snapshot.zoomRatio||1}getConfig(){return this._snapshot}getFreeze(){return this._snapshot.freeze}getMaxColumns(){const{_snapshot:e}=this,{columnCount:n}=e;return n}getMaxRows(){const{_snapshot:e}=this,{rowCount:n}=e;return n}getRowCount(){return this._snapshot.rowCount}setRowCount(e){this._snapshot.rowCount=e}getColumnCount(){return this._snapshot.columnCount}setColumnCount(e){this._snapshot.columnCount=e}isSheetHidden(){return this._snapshot.hidden}hasHiddenGridlines(){const{_snapshot:e}=this,{showGridlines:n}=e;return n===0}getGridlinesColor(){return this.getConfig().gridlinesColor}getTabColor(){const{_snapshot:e}=this,{tabColor:n}=e;return n}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this._viewModel.getRowFiltered(e)?0:this.getRowManager().getRowHeight(e)}isRowFiltered(e){return this._viewModel.getRowFiltered(e)}getRowVisible(e){return!this.isRowFiltered(e)&&this.getRowRawVisible(e)}getRowRawVisible(e){return this.getRowManager().getRowRawVisible(e)}getHiddenRows(e,n){const r=this.getMaxColumns()-1,s=this._rowManager.getHiddenRows(e,n);return s.forEach(o=>o.endColumn=r),s}getColVisible(e){return this._columnManager.getColVisible(e)}getHiddenCols(e,n){const r=this.getMaxRows()-1,s=this._columnManager.getHiddenCols(e,n);return s.forEach(o=>o.endRow=r),s}getVisibleRows(){const e=this.getRowCount();return this._rowManager.getVisibleRows(0,e-1)}getVisibleCols(){const e=this.getColumnCount();return this._columnManager.getVisibleCols(0,e-1)}isRightToLeft(){const{_snapshot:e}=this,{rightToLeft:n}=e;return n}getLastRowWithContent(){return this._cellData.getRealRowRange().endRow}getLastColumnWithContent(){return this.getDataRealRange().endColumn}getDataRealRange(){return this._cellData.getRealRange()}getDataRangeScope(){return this._cellData.getStartEndScope()}cellHasValue(e){return e&&(e.v!==void 0||e.f!==void 0||e.p!==void 0)}iterateByRow(e,n=!0){const{startRow:r,startColumn:s,endRow:o,endColumn:i}=e,a=this;return{[Symbol.iterator]:()=>{let l=r,u=s;return{next(){for(;;){if(u>i&&(l+=1,u=s),l>o)return{done:!0,value:void 0};const c=a.getCell(l,u),h=!c,d=a.getMergedCell(l,u);if(d){if(l!==d.startRow||u!==d.startColumn){u=d.endColumn+1;continue}if(h&&n){u=d.endColumn+1;continue}const f={row:l,col:u,value:c};return f.colSpan=d.endColumn-d.startColumn+1,f.rowSpan=d.endRow-d.startRow+1,u=d.endColumn+1,{done:!1,value:f}}if(h&&n)u+=1;else{const f={row:l,col:u,value:c};return u+=1,{done:!1,value:f}}}}}}}}iterateByColumn(e,n=!0,r=!0){const{startRow:s,startColumn:o,endRow:i,endColumn:a}=e,l=this;return{[Symbol.iterator]:()=>{let u=s,c=o;return{next(){for(;;){if(u>i&&(c+=1,u=s),c>a)return{done:!0,value:void 0};const h=l.getMergedCell(u,c);if(h){const f=u!==h.startRow,p=f||c!==h.startColumn;if(r&&p||!r&&f){u=h.endRow+1;continue}const m=l.getCell(h.startRow,h.startColumn);if(!m&&n){u=h.endRow+1;continue}const R={row:u,col:h.startColumn,value:m};return R.colSpan=h.endColumn-h.startColumn+1,R.rowSpan=h.endRow-h.startRow+1,u=h.endRow+1,{done:!1,value:R}}const d=l.getCell(u,c);if(!d&&n)u+=1;else{const f={row:u,col:c,value:d};return u+=1,{done:!1,value:f}}}}}}}}getCellDocumentModel(e,n,r=ic){var s;if(!e)return;const{isDeepClone:o,displayRawFormula:i,ignoreTextRotation:a}={...ic,...r};let l,u="document";const c=xb(n),h=a?le.tr:c.textRotation||le.tr;let d=c.horizontalAlign||le.ht;const f=c.verticalAlign||le.vt,p=c.wrapStrategy||le.tb,m=c.paddingData||oa;if(e.f&&i)l=Hr(e.f.toString(),{},{verticalAlign:f}),d=le.ht;else if(e.p){const{centerAngle:R,vertexAngle:S}=dp(h);l=this._updateConfigAndGetDocumentModel(o?q.deepClone(e.p):e.p,d,m,{horizontalAlign:d,verticalAlign:f,centerAngle:R,vertexAngle:S,wrapStrategy:p,zeroWidthParagraphBreak:1})}else if(e.v!=null){const R=rc(n);u=sc(R).fontCache;let S=Tp(e);e.t===hn.FORCE_STRING&&i&&(S=`'${S}`),l=Hr(S,R,{...c,textRotation:h,cellValueType:e.t})}return l&&e.linkUrl&&e.linkId&&cp(l,e.linkUrl,e.linkId),{documentModel:l,fontString:u,textRotation:h,wrapStrategy:p,verticalAlign:f,horizontalAlign:d,paddingData:m,fill:(s=n?.bg)==null?void 0:s.rgb}}_updateConfigAndGetDocumentModel(e,n,r,s){var o,i,a,l,u;if(!s||!((o=e.body)!=null&&o.dataStream))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.marginTop=(i=r.t)!=null?i:0,e.documentStyle.marginBottom=(a=r.b)!=null?a:2,e.documentStyle.marginLeft=(l=r.l)!=null?l:2,e.documentStyle.marginRight=(u=r.r)!=null?u:2,e.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},e.documentStyle.renderConfig={...e.documentStyle.renderConfig,...s};const c=e.body.paragraphs||[];for(const h of c)h.paragraphStyle||(h.paragraphStyle={}),h.paragraphStyle.horizontalAlign=n;return new Pe(e)}getBlankCellDocumentModel(e,n,r){const s=this.getComposedCellStyleByCellData(n,r,e),o=rc(s),i=this.getCellDocumentModel(e,s,{ignoreTextRotation:!0});if(i!=null)return i.documentModel==null&&(i.documentModel=Hr("",o)),i;const a="";let l="document";const u=le.tr,c=le.ht,h=le.vt,d=le.tb,f=oa;return l=sc({}).fontCache,{documentModel:Hr(a,o),fontString:l,textRotation:u,wrapStrategy:d,verticalAlign:h,horizontalAlign:c,paddingData:f}}getCellDocumentModelWithFormula(e,n,r){const s=this.getComposedCellStyleByCellData(n,r,e);return this.getCellDocumentModel(e,s,{isDeepClone:!0,displayRawFormula:!0,ignoreTextRotation:!0})}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(e){this._snapshot.custom=e}}function Tp(t){var e,n;if(!t)return"";const r=(n=(e=t.p)==null?void 0:e.body)==null?void 0:n.dataStream;if(r)return te.transform.getPlainText(r);const s=t.v;return typeof s=="string"?t.t===hn.BOOLEAN?s.toUpperCase():s.replace(/[\r\n]/g,""):typeof s=="number"?t.t===hn.BOOLEAN?s?"TRUE":"FALSE":s.toString():typeof s=="boolean"?s?"TRUE":"FALSE":""}function Kb(t){if(t===null)return"";if(t!=null&&t.p){const e=t?.p.body;if(e==null)return"";const n=e.dataStream;return te.transform.getPlainText(n)}return t?.v}var Xb=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},Jb=(t,e)=>(n,r)=>e(n,r,t);function Qb(t,e){return`${t.getUnitId()}|${e.getSheetId()}`}let ts=class extends To{constructor(t={},e){super(),_(this,"type",bt.UNIVER_SHEET),_(this,"_sheetCreated$",new se),_(this,"sheetCreated$",this._sheetCreated$.asObservable()),_(this,"_sheetDisposed$",new se),_(this,"sheetDisposed$",this._sheetDisposed$.asObservable()),_(this,"_activeSheet$",new ie(null)),_(this,"activeSheet$",this._activeSheet$.asObservable()),_(this,"_worksheets"),_(this,"_styles"),_(this,"_snapshot"),_(this,"_unitId"),_(this,"_count"),_(this,"_name$"),_(this,"name$"),this._logService=e;const n=Ab();q.isEmptyObject(t)?this._snapshot=n:this._snapshot=q.commonExtend(n,t);const{styles:r}=this._snapshot;(this._snapshot.id==null||this._snapshot.id.length===0)&&(this._snapshot.id=re(6)),this._unitId=this._snapshot.id,this._styles=new up(r),this._count=1,this._worksheets=new Map,this._name$=new ie(t.name||""),this.name$=this._name$.asObservable(),this._parseWorksheetSnapshots()}get _activeSheet(){return this._activeSheet$.getValue()}get name(){return this._name$.getValue()}static isIRangeType(t){return typeof t=="string"||"startRow"in t||"row"in t}dispose(){super.dispose(),this._sheetCreated$.complete(),this._sheetDisposed$.complete(),this._activeSheet$.complete(),this._name$.complete(),Array.from(this._worksheets.keys()).forEach(t=>{this._removeSheet(t)})}save(){return q.deepClone(this._snapshot)}getSnapshot(){return this._snapshot}getName(){return this._snapshot.name}setName(t){this._name$.next(t),this._snapshot.name=t}getUnitId(){return this._unitId}getRev(){var t;return(t=this._snapshot.rev)!=null?t:1}incrementRev(){this._snapshot.rev=this.getRev()+1}setRev(t){this._snapshot.rev=t}addWorksheet(t,e,n){const{sheets:r,sheetOrder:s}=this._snapshot;if(r[t])return!1;r[t]=n,s.splice(e,0,t),this.ensureSheetOrderUnique();const o=new Zr(this._unitId,n,this._styles);return this._worksheets.set(t,o),this._sheetCreated$.next(o),!0}getSheetOrders(){return this._snapshot.sheetOrder}ensureSheetOrderUnique(){const t=new Set,e=[];for(const n of this._snapshot.sheetOrder)t.has(n)||(t.add(n),e.push(n));this._snapshot.sheetOrder=e,t.clear()}getWorksheets(){return this._worksheets}getActiveSpreadsheet(){return this}getStyles(){return this._styles}addStyles(t){Object.entries(t).forEach(([e,n])=>{this._styles.addCustomStyle(e,n)})}removeStyles(t){t.forEach(e=>{this._styles.remove(e)})}getConfig(){return this._snapshot}getIndexBySheetId(t){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>n===t)}getActiveSheet(t){if(!this._activeSheet&&typeof t>"u")throw new Error(`[Workbook]: no active Worksheet on Workbook ${this._unitId}!`);return this._activeSheet}ensureActiveSheet(){const t=this._activeSheet;if(t)return t;const e=this._snapshot.sheetOrder;for(let r=0,s=e.length;r<s;r++){const o=this._worksheets.get(e[r]);if(o&&o.isSheetHidden()!==ot.TRUE)return this.setActiveSheet(o),o}const n=this._worksheets.get(e[0]);return this.setActiveSheet(n),n}setActiveSheet(t){this._activeSheet$.next(t)}_removeSheet(t){const e=this._worksheets.get(t);return e?(this._worksheets.delete(t),this._snapshot.sheetOrder.splice(this._snapshot.sheetOrder.indexOf(t),1),this.ensureSheetOrderUnique(),this._sheetDisposed$.next(e),!0):!1}removeSheet(t){const e=this._removeSheet(t);return e&&delete this._snapshot.sheets[t],e}getActiveSheetIndex(){const{sheetOrder:t}=this._snapshot;return t.findIndex(e=>this._worksheets.get(e)===this._activeSheet)}getSheetSize(){return this._snapshot.sheetOrder.length}getSheets(){const{sheetOrder:t}=this._snapshot;return t.map(e=>this._worksheets.get(e))}getSheetsName(){const{sheetOrder:t}=this._snapshot,e=[];return t.forEach(n=>{const r=this._worksheets.get(n);r&&e.push(r.getName())}),e}getSheetIndex(t){const{sheetOrder:e}=this._snapshot;return e.findIndex(n=>t.getSheetId()===n)}getSheetBySheetName(t){const{sheetOrder:e}=this._snapshot,n=e.find(r=>this._worksheets.get(r).getName()===t);return this._worksheets.get(n)}getSheetBySheetId(t){return this._worksheets.get(t)}getSheetByIndex(t){const{sheetOrder:e}=this._snapshot;return this._worksheets.get(e[t])}getHiddenWorksheets(){return this.getSheets().filter(t=>t.getConfig().hidden===ot.TRUE).map(t=>t.getConfig().id)}getUnhiddenWorksheets(){return this.getSheets().filter(t=>t.getConfig().hidden!==ot.TRUE).map(t=>t.getConfig().id)}load(t){this._snapshot=t}checkSheetName(t){return this.getSheetsName().some(e=>e.toLowerCase()===t.toLowerCase())}uniqueSheetName(t="Sheet1"){let e=t;for(;this.checkSheetName(e);)e=t+this._count,this._count++;return e}generateNewSheetName(t){let e=t+this._count;for(;this.checkSheetName(e);)e=t+this._count,this._count++;return e}_parseWorksheetSnapshots(){const{_snapshot:t,_worksheets:e}=this,{sheets:n,sheetOrder:r}=t;if(q.isEmptyObject(n)){const s=re();n[s]={id:s}}for(const s in n){const o=n[s],{name:i}=o;o.name=this.uniqueSheetName(i),o.name!==i&&this._logService.debug("[Workbook]",`The worksheet name ${i} is duplicated, we changed it to ${o.name}. Please fix the problem in your snapshot.`);const a=new Zr(this._unitId,o,this._styles);e.set(s,a),r.includes(s)||r.push(s)}this.ensureSheetOrderUnique(),this.ensureActiveSheet()}getCustomMetadata(){return this._snapshot.custom}setCustomMetadata(t){this._snapshot.custom=t}};ts=Xb([Jb(1,Ee)],ts);class Tl extends To{constructor(e){var n;super(),_(this,"type",bt.UNIVER_SLIDE),_(this,"_activePage$",new ie(null)),_(this,"activePage$",this._activePage$.asObservable()),_(this,"_name$"),_(this,"name$"),_(this,"_snapshot"),_(this,"_unitId"),this._snapshot={...bf,...e},this._unitId=(n=this._snapshot.id)!=null?n:re(6),this._name$=new ie(this._snapshot.title),this.name$=this._name$.asObservable()}get _activePage(){var e,n;const r=this._activePage$.getValue();if(!r){const s=(e=this.getPageOrder())==null?void 0:e[0];return s?(n=this.getPages())==null?void 0:n[s]:null}return r}setName(e){var n;this._snapshot.title=e,this._name$.next(e),this._unitId=(n=this._snapshot.id)!=null?n:re(6)}getRev(){return 0}incrementRev(){}setRev(e){}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const n=this.getPages();return n?.[e]}getElementsByPage(e){var n;return(n=this.getPage(e))==null?void 0:n.pageElements}getElement(e,n){var r;return(r=this.getElementsByPage(e))==null?void 0:r[n]}getPageSize(){return this._snapshot.pageSize}getBlankPage(){const e=re(6);return{id:e,pageType:Ua.SLIDE,zIndex:10,title:e,description:"",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}setActivePage(e){this._activePage$.next(e)}getActivePage(){return this._activePage}updatePage(e,n){this._snapshot.body&&(this._snapshot.body.pages[e]=n)}appendPage(e){var n;if(!this._snapshot.body)return;this._snapshot.body.pages[e.id]=e;const r=this._activePage,s=this._snapshot.body.pageOrder.indexOf((n=r?.id)!=null?n:"");this._snapshot.body.pageOrder.splice(s+1,0,e.id)}}var qb=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},si=(t,e)=>(n,r)=>e(n,r,t);const hr=ue("univer.current");let lo=class extends Xt{constructor(t,e,n){super(),_(this,"_unitsByType",new Map),_(this,"_createHandler"),_(this,"_ctorByType",new Map),_(this,"_currentUnits",new Map),_(this,"_currentUnits$",new ie(this._currentUnits)),_(this,"currentUnits$",this._currentUnits$.asObservable()),_(this,"_unitAdded$",new se),_(this,"unitAdded$",this._unitAdded$.asObservable()),_(this,"_unitDisposed$",new se),_(this,"unitDisposed$",this._unitDisposed$.asObservable()),_(this,"_focused$",new ie(null)),_(this,"focused$",this._focused$.asObservable()),this._injector=t,this._contextService=e,this._logService=n}dispose(){super.dispose(),this._focused$.complete(),this._currentUnits$.complete(),this._unitAdded$.complete(),this._currentUnits.forEach(t=>t?.dispose()),this._currentUnits.clear(),this._unitsByType.clear()}__setCreateHandler(t){this._createHandler=t}createUnit(t,e,n){return this._createHandler(t,e,this._ctorByType.get(t),n)}registerCtorForType(t,e){return this._ctorByType.set(t,e),{dispose:()=>{this._ctorByType.delete(t)}}}getCurrentTypeOfUnit$(t){return this.currentUnits$.pipe(pr(e=>{var n;return(n=e.get(t))!=null?n:null}),vm())}getCurrentUnitForType(t){return this._currentUnits.get(t)}getCurrentUnitOfType(t){return this.getCurrentUnitForType(t)}setCurrentUnitForType(t){const e=this._getUnitById(t);if(!e)throw new Error(`[UniverInstanceService]: no document with unitId ${t}!`);this._currentUnits.set(e[1],e[0]),this._currentUnits$.next(this._currentUnits)}getTypeOfUnitAdded$(t){return this._unitAdded$.pipe(pn(e=>e.type===t))}__addUnit(t,e){var n;this._logService.debug(`[UniverInstanceService]: Adding unit with id ${t.getUnitId()}`);const r=t.type;this._unitsByType.has(r)||this._unitsByType.set(r,[]);const s=this._unitsByType.get(r),o=t.getUnitId();if(s.findIndex(i=>i.getUnitId()===o)!==-1)throw new Error(`[UniverInstanceService]: cannot create a unit with the same unit id: ${o}.`);s.push(t),this._unitAdded$.next(t),((n=e?.makeCurrent)==null||n)&&this.setCurrentUnitForType(t.getUnitId())}getTypeOfUnitDisposed$(t){return this.unitDisposed$.pipe(pn(e=>e.type===t))}getUnit(t,e){var n;const r=(n=this._getUnitById(t))==null?void 0:n[0];return e&&r?.type!==e?null:r}getCurrentUniverDocInstance(){return this.getCurrentUnitForType(bt.UNIVER_DOC)}getUniverDocInstance(t){return this.getUnit(t,bt.UNIVER_DOC)}getUniverSheetInstance(t){return this.getUnit(t,bt.UNIVER_SHEET)}getAllUnitsForType(t){var e;return(e=this._unitsByType.get(t))!=null?e:[]}changeDoc(t,e){const n=this.getAllUnitsForType(bt.UNIVER_DOC),r=n.find(s=>s.getUnitId()===t);if(r!=null){const s=n.indexOf(r);n.splice(s,1)}this.__addUnit(e)}get focused(){var t;const e=this._focused$.getValue();return e?(t=this._getUnitById(e))==null?void 0:t[0]:null}focusUnit(t){this._focused$.next(t),this.focused instanceof ts?(this._contextService.setContextValue(Pr,!0),this._contextService.setContextValue(Br,!1),this._contextService.setContextValue(sr,!0),this._contextService.setContextValue($r,!1),this.setCurrentUnitForType(t)):this.focused instanceof Pe?(this._contextService.setContextValue(Pr,!0),this._contextService.setContextValue(Br,!0),this._contextService.setContextValue(sr,!1),this._contextService.setContextValue($r,!1),this.setCurrentUnitForType(t)):this.focused instanceof Tl?(this._contextService.setContextValue(Pr,!0),this._contextService.setContextValue(Br,!1),this._contextService.setContextValue(sr,!1),this._contextService.setContextValue($r,!0),this.setCurrentUnitForType(t)):(this._contextService.setContextValue(Pr,!1),this._contextService.setContextValue(Br,!1),this._contextService.setContextValue(sr,!1),this._contextService.setContextValue($r,!1))}getFocusedUnit(){return this.focused}getUnitType(t){const e=this._getUnitById(t);return e?e[1]:bt.UNRECOGNIZED}disposeUnit(t){this._logService.debug(`[UniverInstanceService]: Disposing unit with id ${t}`);const e=this._getUnitById(t);if(!e)return this._logService.debug(`[UniverInstanceService]: No unit found with id ${t}`),!1;const[n,r]=e,s=this._unitsByType.get(r),o=s.indexOf(n);return s.splice(o,1),this._tryResetCurrentOnRemoval(t,r),this._tryResetFocusOnRemoval(t),this._unitDisposed$.next(n),n.dispose(),!0}_tryResetCurrentOnRemoval(t,e){const n=this.getCurrentUnitForType(e);n?.getUnitId()===t&&(this._currentUnits.set(e,null),this._currentUnits$.next(this._currentUnits))}_tryResetFocusOnRemoval(t){var e;((e=this.focused)==null?void 0:e.getUnitId())===t&&this._focused$.next(null)}_getUnitById(t){for(const[e,n]of this._unitsByType){const r=n.find(s=>s.getUnitId()===t);if(r)return[r,e]}}};lo=qb([si(0,Ce(_n)),si(1,yr),si(2,Ce(Ee))],lo);var Ut=(t=>(t[t.Starting=0]="Starting",t[t.Ready=1]="Ready",t[t.Rendered=2]="Rendered",t[t.Steady=3]="Steady",t))(Ut||{});const Ip={0:"Starting",1:"Ready",2:"Rendered",3:"Steady"};var Zb=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},tT=(t,e)=>(n,r)=>e(n,r,t);class wp extends Error{constructor(e){super(`[LifecycleService]: lifecycle stage "${Ip[e]}" will never be reached!`),this.name="LifecycleUnreachableError"}}let Ln=class extends Xt{constructor(t){super(),_(this,"_lifecycle$",new ie(Ut.Starting)),_(this,"lifecycle$",this._lifecycle$.asObservable()),_(this,"_lock",!1),this._logService=t,this._reportProgress(Ut.Starting)}get stage(){return this._lifecycle$.getValue()}set stage(t){if(this._lock)throw new Error("[LifecycleService]: cannot set new stage when related logic is all handled!");if(t<this.stage)throw new Error("[LifecycleService]: lifecycle stage cannot go backward!");t!==this.stage&&(this._lock=!0,this._reportProgress(t),this._lifecycle$.next(t),this._lock=!1)}dispose(){this._lifecycle$.complete(),super.dispose()}onStage(t){return nm(this.lifecycle$.pipe(pn(e=>e>=t),Ri(e=>e===t),pr(()=>{}))).catch(e=>e.name==="EmptyError"?Promise.reject(new wp(t)):Promise.reject(e))}subscribeWithPrevious(){return jc(Sp(this.stage),this._lifecycle$.pipe(Gc(1))).pipe(Ri(t=>t===Ut.Steady))}_reportProgress(t){this._logService.debug("[LifecycleService]",`lifecycle progressed to "${Ip[t]}".`)}};Ln=Zb([tT(0,Ee)],Ln);function Sp(t){switch(t){case Ut.Starting:return _s(Ut.Starting);case Ut.Ready:return _s(Ut.Starting,Ut.Ready);case Ut.Rendered:return _s(Ut.Starting,Ut.Ready,Ut.Rendered);default:return _s(Ut.Starting,Ut.Ready,Ut.Rendered,Ut.Steady)}}const eT=ue("ILocalStorageService");class An extends Xt{constructor(){super(),_(this,"_currentLocale$",new ie(ss.ZH_CN)),_(this,"currentLocale$",this._currentLocale$.asObservable()),_(this,"_locales",null),_(this,"localeChanged$",new se),_(this,"t",(e,...n)=>{if(!this._locales)throw new Error("[LocaleService]: Locale not initialized");const r=e.split("."),s=this.resolveKeyPath(this._locales[this._currentLocale],r);if(typeof s=="string"){let o=s;return n.forEach((i,a)=>{o=o.replace(`{${a}}`,i)}),o}else return e}),this.disposeWithMe(Wt(()=>{this._locales=null,this._currentLocale$.complete(),this.localeChanged$.complete()}))}get _currentLocale(){return this._currentLocale$.value}load(e){var n;this._locales=Ro((n=this._locales)!=null?n:{},e)}setLocale(e){this._currentLocale$.next(e),this.localeChanged$.next()}getLocales(){var e;return(e=this._locales)==null?void 0:e[this._currentLocale]}getCurrentLocale(){return this._currentLocale}resolveKeyPath(e,n){const r=n.shift();if(r&&e&&r in e){const s=e[r];return n.length>0&&(typeof s=="object"||Array.isArray(s))?this.resolveKeyPath(s,n):s}return null}}var nT=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},rT=(t,e)=>(n,r)=>e(n,r,t);let uo=class{constructor(t){this._userManagerService=t}async list(t){return{list:[{type:Ks.PERSON,mentions:[{objectType:Ks.PERSON,objectId:this._userManagerService.getCurrentUser().userID,label:this._userManagerService.getCurrentUser().name,metadata:{icon:this._userManagerService.getCurrentUser().avatar}}],metadata:{},title:"PEOPLE"}],page:t.page,size:t.size,total:1}}};uo=nT([rT(0,Ce(qr))],uo);const Ap=ue("univer.service.mention-io");var Il=(t=>(t.INIT="init",t.FETCHING="fetching",t.DONE="done",t))(Il||{});const Op=ue("univer.permission-service");class Dp extends Xt{constructor(){super(...arguments),_(this,"_permissionPointMap",new Map),_(this,"_permissionPointUpdate$",new se),_(this,"permissionPointUpdate$",this._permissionPointUpdate$.asObservable()),_(this,"_showComponents",!0)}setShowComponents(e){this._showComponents=e}getShowComponents(){return this._showComponents}deletePermissionPoint(e){const n=this._permissionPointMap.get(e);n&&(n.complete(),this._permissionPointMap.delete(e))}addPermissionPoint(e){const n=e instanceof ie,r=n?e.getValue():e;return r.id?this._permissionPointMap.get(r.id)?(console.warn(`${r.id} PermissionPoint already exists`),!1):(this._permissionPointMap.set(r.id,n?e:new ie(r)),this._permissionPointUpdate$.next(r),!0):!1}updatePermissionPoint(e,n){const r=this._permissionPointMap.get(e);if(!r)return;const s=r.getValue();s.value=n,s.status=Il.DONE,r.next(s),this._permissionPointUpdate$.next(s)}clearPermissionMap(){this._permissionPointMap.clear()}getPermissionPoint(e){const n=this._permissionPointMap.get(e);if(n)return n.getValue()}getPermissionPoint$(e){const n=this._permissionPointMap.get(e);if(n)return n}composePermission$(e){const n=e.map(r=>{var s;const o=(s=this._permissionPointMap)==null?void 0:s.get(r);if(!o)throw new Error(`[PermissionService]: ${r} permissionPoint does not exist!`);return o.asObservable()});return pm(n).pipe(pr(r=>r))}composePermission(e){return e.map(n=>{var r;const s=(r=this._permissionPointMap)==null?void 0:r.get(n);if(!s)throw new Error(`[PermissionService]: ${n} permissionPoint does not exist!`);return s.getValue()})}getAllPermissionPoint(){const e=new Map;return this._permissionPointMap.forEach((n,r)=>{e.set(r,n)}),e}}function Np(t,e){if(!e)return t;const n=[];for(const r of t){const s=e.find(([o])=>o===r[0]);if(s){if(s[1]===null)continue;n.push([r[0],s[1]])}else n.push(r)}return n}var sT=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},oi=(t,e)=>(n,r)=>e(n,r,t);const oT=4,xp=Symbol("DependentOn");class ia extends Xt{onStarting(){}onReady(){}onRendered(){}onSteady(){}getUnitType(){return this.constructor.type}getPluginName(){return this.constructor.pluginName}}_(ia,"pluginName"),_(ia,"type",bt.UNIVER_UNKNOWN);class iT{constructor(){_(this,"_plugins",[])}addPlugin(e){this._plugins.push(e)}removePlugins(){const e=this._plugins.slice();return this._plugins.length=0,e}forEachPlugin(e){this._plugins.forEach(e)}}function aT(...t){return function(e){e[xp]=t}}let es=class{constructor(t,e,n){_(this,"_pluginRegistry",new Map),_(this,"_pluginStore",new iT),_(this,"_seenPlugins",new Set),_(this,"_loadedPlugins",new Set),_(this,"_loadedPluginTypes",new Set([bt.UNIVER_UNKNOWN])),_(this,"_flushTimerByType",new Map),this._injector=t,this._lifecycleService=e,this._logService=n}dispose(){this._pluginStore.removePlugins().forEach(t=>t.dispose()),this._flushTimerByType.forEach(t=>clearTimeout(t))}registerPlugin(t,e){this._assertPluginValid(t);const n={plugin:t,options:e};this._pluginRegistry.set(t.pluginName,n),this._logService.debug("[PluginService]",`Plugin "${t.pluginName}" registered.`);const{type:r}=t;this._loadedPluginTypes.has(r)&&(r===bt.UNIVER_UNKNOWN?this._loadFromPlugins([n]):this._flushType(r))}startPluginsForType(t){this._loadedPluginTypes.has(t)||this._loadPluginsForType(t)}_loadPluginsForType(t){const e=Array.from(this._pluginRegistry.keys()),n=[];e.forEach(r=>{const s=this._pluginRegistry.get(r);s.plugin.type===t&&n.push(s)}),this._loadFromPlugins(n),this._loadedPluginTypes.add(t)}_assertPluginValid(t){const{type:e,pluginName:n}=t;if(e===bt.UNRECOGNIZED)throw new Error(`[PluginService]: invalid plugin type for ${t.name}. Please assign a "type" to your plugin.`);if(!n)throw new Error(`[PluginService]: no plugin name for ${t.name}. Please assign a "pluginName" to your plugin.`);if(this._seenPlugins.has(n))throw new Error(`[PluginService]: duplicated plugin name for "${n}". Maybe a plugin that dependents on "${n} has already registered it. In that case please register "${n}" before the that plugin.`);this._seenPlugins.add(t.pluginName)}_flushType(t){this._flushTimerByType.get(t)===void 0&&this._flushTimerByType.set(t,setTimeout(()=>{this._loadPluginsForType(t),this._flushTimerByType.delete(t)},oT))}_loadFromPlugins(t){const e=[],n=new Set,r=o=>{const{plugin:i}=o,{pluginName:a}=i;if(this._loadedPlugins.has(a)||n.has(a))return;n.add(a),this._pluginRegistry.delete(a);const l=i[xp];l&&l.forEach(u=>{const c=this._pluginRegistry.get(u.pluginName);if(c)r(c);else if(!this._seenPlugins.has(u.pluginName)&&!n.has(u.pluginName)){if(i.type===bt.UNIVER_UNKNOWN&&u.type!==bt.UNIVER_UNKNOWN)throw new Error(`[PluginService]: cannot register a plugin with Univer type that depends on a plugin with other type. The dependent is ${i.pluginName} and the dependency is ${u.pluginName}.`);i.type!==u.type&&u.type!==bt.UNIVER_UNKNOWN&&this._logService.debug("[PluginService]",`Plugin "${a}" depends on "${u.pluginName}" which has different type.`),this._logService.debug("[PluginService]",`Plugin "${a}" depends on "${u.pluginName}" which is not registered. Univer will automatically register it with default configuration.`),this._assertPluginValid(u),r({plugin:u,options:void 0})}}),e.push(o)};t.forEach(o=>r(o));const s=e.map(o=>this._initPlugin(o.plugin,o.options));this._pluginsRunLifecycle(s)}_pluginsRunLifecycle(t){const e=this._lifecycleService.stage;if(Sp(e).subscribe(n=>this._runStage(t,n)),e!==Ut.Steady){const n=this._lifecycleService.lifecycle$.pipe(Gc(1)).subscribe(r=>{this._runStage(t,r),r===Ut.Steady&&n.unsubscribe()})}}_runStage(t,e){t.forEach(n=>{switch(e){case Ut.Starting:n.onStarting();break;case Ut.Ready:n.onReady();break;case Ut.Rendered:n.onRendered();break;case Ut.Steady:n.onSteady();break}})}_initPlugin(t,e){const n=this._injector.createInstance(t,e);return this._pluginStore.addPlugin(n),this._loadedPlugins.add(t.pluginName),this._logService.debug("[PluginService]",`Plugin "${n.getPluginName()}" loaded.`),n}};es=sT([oi(0,Ce(_n)),oi(1,Ce(Ln)),oi(2,Ee)],es);const aa=ue("resource-loader-service");var lT=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},uT=(t,e)=>(n,r)=>e(n,r,t);let co=class extends Xt{constructor(t){super(),_(this,"_resourceMap",new Map),_(this,"_register$",new se),_(this,"register$",this._register$.asObservable()),this._logService=t}getAllResourceHooks(){return[...this._resourceMap.values()]}getResources(t,e){return e?this.getResourcesByType(t,e):this.getAllResourceHooks().map(n=>{const r=n.toJson(t);return{name:n.pluginName,data:r}})}getResourcesByType(t,e){return this.getAllResourceHooks().filter(n=>n.businesses.includes(e)).map(n=>{const r=n.toJson(t);return{name:n.pluginName,data:r}})}registerPluginResource(t){const e=t.pluginName;if(this._resourceMap.has(e))throw new Error(`the pluginName is registered {${e}}`);return this._resourceMap.set(e,t),this._register$.next(t),Wt(()=>this._resourceMap.delete(e))}disposePluginResource(t){this._resourceMap.delete(t)}loadResources(t,e){this.getAllResourceHooks().forEach(n=>{var r;const s=(r=e?.find(o=>o.name===n.pluginName))==null?void 0:r.data;if(s)try{const o=n.parseJson(s);n.onLoad(t,o)}catch(o){this._logService.error("[ResourceManagerService]","loadResources error",o)}})}unloadResources(t,e){this.getAllResourceHooks().filter(n=>n.businesses.includes(e)).forEach(n=>{n.onUnLoad(t)})}dispose(){this._register$.complete(),this._resourceMap.clear()}};co=lT([uT(0,Ee)],co);class ho extends Xt{constructor(){super(),_(this,"_darkMode$",new ie(!1)),_(this,"darkMode$",this._darkMode$.asObservable()),_(this,"_validColorCache",new Map),_(this,"_currentTheme",ys),_(this,"_currentTheme$",new ie(this._currentTheme)),_(this,"currentTheme$",this._currentTheme$.asObservable()),this.disposeWithMe(Wt(()=>{this._currentTheme=ys,this._currentTheme$.complete(),this._darkMode$.complete()}))}get darkMode(){return this._darkMode$.getValue()}isValidThemeColor(e){if(this._validColorCache.has(e))return this._validColorCache.get(e);let n=!1;const r=e.split(".");if(r.length===1)n=e in ys;else if(r.length===2){const[s,o]=r;n=s in ys&&o in this._currentTheme[s]}return this._validColorCache.set(e,n),n}getCurrentTheme(){return this._currentTheme}setTheme(e){this._currentTheme=e,this._currentTheme$.next(e)}setDarkMode(e){this._darkMode$.next(e)}getColorFromTheme(e){return vh(this._currentTheme,e)}}var cT=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},ii=(t,e)=>(n,r)=>e(n,r,t);const Fo=ue("univer.undo-redo.service"),hT=20;class Mp{dispose(){}async dispatchToHandlers(){return!1}}const Lp="univer.command.redo",Up="univer.command.undo",Fp=new class extends Mp{constructor(){super(...arguments),_(this,"type",as.COMMAND),_(this,"id",Up)}handler(t){const e=t.get(Fo),n=e.pitchTopUndoElement();if(!n)return!1;const r=t.get(ls);return wo(n.undoMutations,r)?(e.popUndoToRedo(),!0):!1}},kp=new class extends Mp{constructor(){super(...arguments),_(this,"type",as.COMMAND),_(this,"id",Lp)}handler(t){const e=t.get(Fo),n=e.pitchTopRedoElement();if(!n)return!1;const r=t.get(ls);return wo(n.redoMutations,r)?(e.popRedoToUndo(),!0):!1}};let fo=class extends Xt{constructor(t,e,n){super(),_(this,"undoRedoStatus$"),_(this,"_undoRedoStatus$",new ie({undos:0,redos:0})),_(this,"_undoStacks",new Map),_(this,"_redoStacks",new Map),_(this,"_batchingStatus",new Map),this._univerInstanceService=t,this._commandService=e,this._contextService=n,this.undoRedoStatus$=this._undoRedoStatus$.asObservable(),this.disposeWithMe(this._commandService.registerCommand(Fp)),this.disposeWithMe(this._commandService.registerCommand(kp)),this.disposeWithMe(Wt(()=>this._undoRedoStatus$.complete())),this.disposeWithMe(Wt(this._univerInstanceService.focused$.subscribe(()=>this._updateStatus())))}pushUndoRedo(t){const{unitID:e}=t,n=this._getRedoStack(e,!0),r=this._getUndoStack(e,!0);if(n.length=0,this._batchingStatus.has(t.unitID)){const o=this._batchingStatus.get(t.unitID),i=this._pitchUndoElement(t.unitID);o===0||!i?(s(t),this._batchingStatus.set(t.unitID,1)):this._tryBatchingElements(i,t)}else s(t);function s(o){r.push(o),r.length>hT&&r.splice(0,1)}this._updateStatus()}clearUndoRedo(t){const e=this._getRedoStack(t);e&&(e.length=0);const n=this._getUndoStack(t);n&&(n.length=0),this._updateStatus()}pitchTopUndoElement(){const t=this._getFocusedUnitId();return this._pitchUndoElement(t)}pitchTopRedoElement(){const t=this._getFocusedUnitId();return this._pitchRedoElement(t)}_pitchUndoElement(t){const e=this._getUndoStack(t);return e!=null&&e.length?e[e.length-1]:null}_pitchRedoElement(t){const e=this._getRedoStack(t);return e!=null&&e.length?e[e.length-1]:null}popUndoToRedo(){const t=this._getUndoStackForFocused().pop();t&&(t.redoMutations.length>0&&this._getRedoStackForFocused().push(t),this._updateStatus())}popRedoToUndo(){const t=this._getRedoStackForFocused().pop();t&&(this._getUndoStackForFocused().push(t),this._updateStatus())}rollback(t,e){const n=e||this._getFocusedUnitId(),r=this._getUndoStack(n),s=r?.[r?.length-1];s&&s.id===t&&(r.pop(),wo(s.undoMutations,this._commandService))}__tempBatchingUndoRedo(t){if(this._batchingStatus.has(t))throw new Error("[LocalUndoRedoService]: cannot batching undo redo twice at the same time!");return this._batchingStatus.set(t,0),Wt(()=>this._batchingStatus.delete(t))}_updateStatus(){var t,e;const n=this._getFocusedUnitId(),r=n&&((t=this._undoStacks.get(n))==null?void 0:t.length)||0,s=n&&((e=this._redoStacks.get(n))==null?void 0:e.length)||0;this._undoRedoStatus$.next({undos:r,redos:s})}_getUndoStack(t,e=!1){let n=this._undoStacks.get(t);return!n&&e&&(n=[],this._undoStacks.set(t,n)),n||null}_getRedoStack(t,e=!1){let n=this._redoStacks.get(t);return!n&&e&&(n=[],this._redoStacks.set(t,n)),n||null}_getUndoStackForFocused(){const t=this._getFocusedUnitId();if(!t)throw new Error("No focused univer instance!");return this._getUndoStack(t,!0)}_getRedoStackForFocused(){const t=this._getFocusedUnitId();if(!t)throw new Error("No focused univer instance!");return this._getRedoStack(t,!0)}_tryBatchingElements(t,e){t.redoMutations.push(...e.redoMutations),t.undoMutations.push(...e.undoMutations)}_getFocusedUnitId(){var t,e,n,r;let s="";const o=this._contextService.getContextValue(sr),i=this._contextService.getContextValue(ip),a=this._contextService.getContextValue(op);return o?i?s=ba:a?s=Ra:s=(e=(t=this._univerInstanceService.getFocusedUnit())==null?void 0:t.getUnitId())!=null?e:"":s=(r=(n=this._univerInstanceService.getFocusedUnit())==null?void 0:n.getUnitId())!=null?r:"",s}};fo=cT([ii(0,hr),ii(1,ls),ii(2,yr)],fo);class Pp{constructor(e,n=1e3){_(this,"_imageCacheMap"),this._injector=e,this._imageCacheMap=new Mo(n)}_getImageCacheKey(e,n){return`${e}-${n}`}getImage(e,n,r,s){const o=this._getImageCacheKey(e,n);return this._imageCacheMap.get(o)||((async()=>{const a=new Image,l=this._injector.has(ra)?this._injector.get(ra):null,u=this._injector.has(sa)?this._injector.get(sa):null;if(e===ao.UUID)try{a.src=await l?.getImage(n)||""}catch(c){console.error(c)}else if(e===ao.URL)try{const c=await u?.getImage(n);a.src=c||n}catch{a.src=n}else a.src=n;a.onload=()=>{a.removeAttribute("data-error"),r?.()},a.onerror=()=>{a.setAttribute("data-error","true"),s?.()},this._imageCacheMap.set(o,a)})(),null)}}function dT(t){return!(t.length===0||t.length>31||t.startsWith("'")||t.endsWith("'")||/[:\\\/\?\*\[\]]/.test(t))}function fT(t,e){return!(!t||t.length===0||t.length>255||e.has(t)||/[ :\\\/\?\*\[\]]/.test(t)||!/^[\p{L}_]/u.test(t)||/^\$?[A-Za-z]{1,3}\$?[0-9]+$/.test(t)||/^[rR]\d+[cC]\d+$/.test(t)||/^\d+$/.test(t))}const ac=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ai=1,Tr=8;class wl{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=r>>4;if(s!==ai)throw new Error(`Got v${s} data when expected v${ai}.`);const o=ac[r&15];if(!o)throw new Error("Unrecognized array type.");const[i]=new Uint16Array(e,2,1),[a]=new Uint32Array(e,4,1);return new wl(a,i,o,e)}constructor(e,n=64,r=Float64Array,s){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=ac.indexOf(this.ArrayType),i=e*2*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-a%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${r}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,Tr,e),this.coords=new this.ArrayType(this.data,Tr+a+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Tr+i+a+l),this.ids=new this.IndexArrayType(this.data,Tr,e),this.coords=new this.ArrayType(this.data,Tr+a+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ai<<4)+o]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=n,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return la(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:a}=this,l=[0,o.length-1,0],u=[];for(;l.length;){const c=l.pop()||0,h=l.pop()||0,d=l.pop()||0;if(h-d<=a){for(let R=d;R<=h;R++){const S=i[2*R],P=i[2*R+1];S>=e&&S<=r&&P>=n&&P<=s&&u.push(o[R])}continue}const f=d+h>>1,p=i[2*f],m=i[2*f+1];p>=e&&p<=r&&m>=n&&m<=s&&u.push(o[f]),(c===0?e<=p:n<=m)&&(l.push(d),l.push(f-1),l.push(1-c)),(c===0?r>=p:s>=m)&&(l.push(f+1),l.push(h),l.push(1-c))}return u}within(e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:o,nodeSize:i}=this,a=[0,s.length-1,0],l=[],u=r*r;for(;a.length;){const c=a.pop()||0,h=a.pop()||0,d=a.pop()||0;if(h-d<=i){for(let R=d;R<=h;R++)lc(o[2*R],o[2*R+1],e,n)<=u&&l.push(s[R]);continue}const f=d+h>>1,p=o[2*f],m=o[2*f+1];lc(p,m,e,n)<=u&&l.push(s[f]),(c===0?e-r<=p:n-r<=m)&&(a.push(d),a.push(f-1),a.push(1-c)),(c===0?e+r>=p:n+r>=m)&&(a.push(f+1),a.push(h),a.push(1-c))}return l}}function la(t,e,n,r,s,o){if(s-r<=n)return;const i=r+s>>1;Bp(t,e,i,r,s,o),la(t,e,n,r,i-1,1-o),la(t,e,n,i+1,s,1-o)}function Bp(t,e,n,r,s,o){for(;s>r;){if(s-r>600){const u=s-r+1,c=n-r+1,h=Math.log(u),d=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*d*(u-d)/u)*(c-u/2<0?-1:1),p=Math.max(r,Math.floor(n-c*d/u+f)),m=Math.min(s,Math.floor(n+(u-c)*d/u+f));Bp(t,e,n,p,m,o)}const i=e[2*n+o];let a=r,l=s;for(Ir(t,e,r,n),e[2*s+o]>i&&Ir(t,e,r,s);a<l;){for(Ir(t,e,a,l),a++,l--;e[2*a+o]<i;)a++;for(;e[2*l+o]>i;)l--}e[2*r+o]===i?Ir(t,e,r,l):(l++,Ir(t,e,l,s)),l<=n&&(r=l+1),n<=l&&(s=l-1)}}function Ir(t,e,n,r){li(t,n,r),li(e,2*n,2*r),li(e,2*n+1,2*r+1)}function li(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function lc(t,e,n,r){const s=t-n,o=e-r;return s*s+o*o}class pT{constructor(e=!1){_(this,"_tree",new Map),_(this,"_oneCellCache",new Map),_(this,"_kdTree",new Map),this._enableOneCellCache=e}dispose(){this.clear()}getTree(e,n){return this._tree.has(e)||this._tree.set(e,new Map),this._tree.get(e).has(n)||this._tree.get(e).set(n,new no),this._tree.get(e).get(n)}_getOneCellCache(e,n,r,s){return this._oneCellCache.has(e)||this._oneCellCache.set(e,new Map),this._oneCellCache.get(e).has(n)||this._oneCellCache.get(e).set(n,new Map),this._oneCellCache.get(e).get(n).has(r)||this._oneCellCache.get(e).get(n).set(r,new Map),this._oneCellCache.get(e).get(n).get(r).has(s)||this._oneCellCache.get(e).get(n).get(r).set(s,new Set),this._oneCellCache.get(e).get(n).get(r).get(s)}_removeOneCellCache(e,n,r,s,o){const i=this._oneCellCache.get(e);if(!i)return;const a=i.get(n);if(!a)return;const l=a.get(r);if(!l)return;const u=l.get(s);u&&u.delete(o)}_removeCellCacheByRange(e){const{unitId:n,sheetId:r,range:s,id:o}=e,i=this._oneCellCache.get(n);if(!i)return;const a=i.get(r);if(!a)return;const{startRow:l,startColumn:u,endRow:c,endColumn:h}=s;for(let d=l;d<=c;d++){const f=a.get(d);if(f)for(let p=u;p<=h;p++){const m=f.get(p);m&&m.delete(o)}}}_insertOneCellCache(e,n,r,s,o){this._getOneCellCache(e,n,r,s).add(o)}_getRdTreeItems(e){const n=[];for(const[r,s]of e)for(const[o,i]of s)n.push({x:o,y:r,ids:i});return n}_searchByOneCellCache(e){var n;const{unitId:r,sheetId:s,range:o}=e,{startRow:i,startColumn:a,endRow:l,endColumn:u}=o,c=(n=this._kdTree.get(r))==null?void 0:n.get(s);if(!c)return[];const{tree:h,items:d}=c,f=h.range(a,i,u,l),p=[];for(const m of f){const R=d[m];p.push(...Array.from(R.ids))}return p}openKdTree(){var e;for(const[n,r]of this._oneCellCache){this._kdTree.has(n)||this._kdTree.set(n,new Map);for(const[s,o]of r){const i=this._getRdTreeItems(o),a=new wl(i.length);(e=this._kdTree.get(n))==null||e.set(s,{tree:a,items:i});for(const l of i)a.add(l.x,l.y);a.finish()}}}closeKdTree(){var e;for(const[n,r]of this._oneCellCache)for(const[s,o]of r)(e=this._kdTree.get(n))==null||e.set(s,void 0)}insert(e){const{unitId:n,sheetId:r,range:s,id:o}=e;if(!n||n.length===0)return;let{startRow:i,endRow:a,startColumn:l,endColumn:u}=s;if(this._enableOneCellCache&&i===a&&l===u){this._insertOneCellCache(n,r,i,l,o);return}const c=this.getTree(n,r);Number.isNaN(i)&&(i=0),Number.isNaN(l)&&(l=0),Number.isNaN(a)&&(a=Number.POSITIVE_INFINITY),Number.isNaN(u)&&(u=Number.POSITIVE_INFINITY),c.insert({minX:l,minY:i,maxX:u,maxY:a,id:o})}bulkInsert(e){for(const n of e)this.insert(n)}*searchGenerator(e){var n;const{unitId:r,sheetId:s,range:o}=e;if(this._enableOneCellCache){const l=this._searchByOneCellCache(e);for(const u of l)yield u}const i=(n=this._tree.get(r))==null?void 0:n.get(s);if(!i)return;const a=i.search({minX:o.startColumn,minY:o.startRow,maxX:o.endColumn,maxY:o.endRow});for(const l of a)yield l.id}bulkSearch(e,n){const r=new Set;for(const s of e)for(const o of this.searchGenerator(s))n?.has(o)!==!0&&r.add(o);return r}removeById(e,n){var r,s;n?((r=this._tree.get(e))==null||r.delete(n),(s=this._oneCellCache.get(e))==null||s.delete(n)):(this._tree.delete(e),this._oneCellCache.delete(e))}_removeRTreeItem(e){const{unitId:n,sheetId:r,range:s,id:o}=e,i=this.getTree(n,r),a=i.search({minX:s.startColumn,minY:s.startRow,maxX:s.endColumn,maxY:s.endRow});for(let l=0;l<a.length;l++)a[l].id===o&&i.remove(a[l])}remove(e){const{unitId:n,sheetId:r,range:s,id:o}=e,{startRow:i,startColumn:a,endRow:l,endColumn:u}=s;this._enableOneCellCache?i===l&&a===u?this._removeOneCellCache(n,r,s.startRow,s.startColumn,o):(this._removeCellCacheByRange(e),this._removeRTreeItem(e)):this._removeRTreeItem(e)}bulkRemove(e){for(const n of e)this.remove(n)}clear(){this._tree.clear(),this._oneCellCache.clear()}toJSON(){const e={};return this._tree.forEach((n,r)=>{e[r]={},n.forEach((s,o)=>{e[r][o]=s.toJSON()})}),e}fromJSON(e){this._tree.clear();for(const n in e){this._tree.set(n,new Map);for(const r in e[n]){const s=new no;s.fromJSON(e[n][r]),this._tree.get(n).set(r,s)}}}}function gT(t){return new Promise(e=>setTimeout(e,t))}function mT(t=1){return new Promise(e=>{let n=0;const r=()=>{n++,n>=t?e():requestAnimationFrame(r)};requestAnimationFrame(r)})}var _T=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},yT=(t,e)=>(n,r)=>e(n,r,t);let po=class extends Xt{constructor(t){super(),_(this,"_fontLocale"),_(this,"_dirty",!0),this._localeService=t,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}makeDirty(t){this._dirty=t}dispose(){super.dispose(),this._fontLocale=null}_localeInitial(){}};po=_T([yT(0,Ce(An))],po);var ET=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},xs=(t,e)=>(n,r)=>e(n,r,t);let ua=class extends po{constructor(t,e,n,r,s,o){super(n),_(this,"_worksheetData"),_(this,"_renderRawFormula",!1),_(this,"_cellData"),_(this,"_imageCacheMap"),_(this,"_skipAutoHeightForMergedCells",!0),_(this,"_rowTotalHeight",0),_(this,"_columnTotalWidth",0),_(this,"_rowHeaderWidth",0),_(this,"_columnHeaderHeight",0),_(this,"_rowHeightAccumulation",[]),_(this,"_columnWidthAccumulation",[]),_(this,"_marginTop",0),_(this,"_marginLeft",0),_(this,"_scaleX"),_(this,"_scaleY"),_(this,"_scrollX"),_(this,"_scrollY"),this.worksheet=t,this._styles=e,this._contextService=r,this._configService=s,this._injector=o,this._worksheetData=this.worksheet.getConfig(),this._cellData=this.worksheet.getCellMatrix(),this._imageCacheMap=new Pp(this._injector),this.initConfig()}initConfig(){var t,e;this._skipAutoHeightForMergedCells=!((t=this._configService.getConfig(Jc))!=null&&t),this.worksheet.setIsRowStylePrecedeColumnStyle((e=this._configService.getConfig(Xc))!=null?e:!1)}resetCache(){}getWorksheetConfig(){return this._worksheetData}getLocation(){return[this.worksheet.getUnitId(),this.worksheet.getSheetId()]}set columnHeaderHeight(t){this._columnHeaderHeight=t,this._worksheetData.columnHeader.height=t}set rowHeaderWidth(t){this._rowHeaderWidth=t,this._worksheetData.rowHeader.width=t}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowHeaderWidth(){return this._rowHeaderWidth}get columnHeaderHeight(){return this._columnHeaderHeight}setMarginLeft(t){this._marginLeft=t}setMarginTop(t){this._marginTop=t}setScale(t,e){this._updateLayout(),this._scaleX=t,this._scaleY=e||t,this._updateLayout()}setScroll(t,e){q.isDefine(t)&&(this._scrollX=t),q.isDefine(e)&&(this._scrollY=e)}get scrollX(){return this._scrollX}get scrollY(){return this._scrollY}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get rowHeaderWidthAndMarginLeft(){return this.rowHeaderWidth+this._marginLeft}get columnHeaderHeightAndMarginTop(){return this.columnHeaderHeight+this._marginTop}get imageCacheMap(){return this._imageCacheMap}_generateRowMatrixCache(t,e,n){let r=0;const s=[],o=e;for(let i=0;i<t;i++){let a=n;if(this.worksheet.getRowFiltered(i))a=0;else if(o[i]!=null){const l=o[i];if(!l)continue;const{h:u=n,ah:c,ia:h}=l;(h==null||h===ot.TRUE)&&typeof c=="number"?a=c:a=u,l.hd===ot.TRUE&&(a=0)}r+=a,s.push(r)}return{rowTotalHeight:r,rowHeightAccumulation:s}}_generateColumnMatrixCache(t,e,n){let r=0;const s=[],o=e;for(let i=0;i<t;i++){let a=n;if(o[i]!=null){const l=o[i];if(!l)continue;l.w!=null&&(a=l.w),l.hd===ot.TRUE&&(a=0)}r+=a,s.push(r)}return{columnTotalWidth:r,columnWidthAccumulation:s}}intersectMergeRange(t,e){return!!this.worksheet.getMergedCell(t,e)}_getOverflowBound(t,e,n,r,s=Fe.LEFT){let o=0;if(e>n){const i=this._columnWidthAccumulation.length-1;for(let a=e;a>=n;a--){const l=a,u=this.worksheet.getCell(t,l);if(!Mi(u)&&l!==e||this.intersectMergeRange(t,l))return l===e?l:l+1>i?i:l+1;const{startX:c,endX:h}=qn(t,l,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s===Fe.CENTER&&l===e?o+=(h-c)/2:o+=h-c,r<o)return l}return e}for(let i=e;i<=n;i++){const a=i,l=this.worksheet.getCell(t,a);if(!Mi(l)&&a!==e||this.intersectMergeRange(t,a))return a===e?a:a-1<0?0:a-1;const{startX:u,endX:c}=qn(t,a,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s===Fe.CENTER&&a===e?o+=(c-u)/2:o+=c-u,r<o)return a}return n}_updateLayout(){if(!this.dirty)return;const{rowData:t,columnData:e,defaultRowHeight:n,defaultColumnWidth:r,rowCount:s,columnCount:o,rowHeader:i,columnHeader:a}=this._worksheetData,{rowTotalHeight:l,rowHeightAccumulation:u}=this._generateRowMatrixCache(s,t,n),{columnTotalWidth:c,columnWidthAccumulation:h}=this._generateColumnMatrixCache(o,e,r);this._rowHeaderWidth=i.hidden!==ot.TRUE?this._dynamicallyUpdateRowHeaderWidth(i):0,this._columnHeaderHeight=a.hidden!==ot.TRUE?a.height:0,this._rowTotalHeight=l,this._rowHeightAccumulation=u,this._columnTotalWidth=c,this._columnWidthAccumulation=h,this.makeDirty(!1)}calculate(){return this.resetCache(),this._updateLayout(),this}resetRangeCache(t){}_dynamicallyUpdateRowHeaderWidth(t){const e=`${this.worksheet.getRowCount()}`.length*8;return Math.max(t.width,e)}_hasUnMergedCellInRow(t,e,n){if(!this.worksheet.getMergeData())return!1;for(let r=e;r<=n;r++){const{isMerged:s,isMergedMainCell:o}=this.worksheet.getCellInfoInMergeData(t,r);if(!s&&!o)return!0}return!1}expandRangeByMerge(t,e){let{startRow:n,startColumn:r,endRow:s,endColumn:o}=t;const i=this._worksheetData.mergeData;if(!i)return{startRow:n,startColumn:r,endRow:s,endColumn:o};let a=!0;const l=new fe;let u=0,c=null;for(;a;){a=!1;for(let h=0;h<i.length;h++){const{startRow:d,startColumn:f,endRow:p,endColumn:m}=i[h];if(l.getValue(d,f))continue;const R={startColumn:r,startRow:n,endColumn:o,endRow:s},S={startColumn:f,startRow:d,endColumn:m,endRow:p};Sf(R,S)&&(n=Math.min(n,d),r=Math.min(r,f),s=Math.max(s,p),o=Math.max(o,m),l.setValue(d,f,!0),a=!0,u++,c=S)}}return e&&u===1&&xn.contains(c,t)?{startRow:c.startRow,startColumn:c.startColumn,endRow:c.startRow,endColumn:c.startColumn}:{startRow:n,startColumn:r,endRow:s,endColumn:o}}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}_getCellMergeInfo(t,e){return this.worksheet.getCellInfoInMergeData(t,e)}getNoMergeCellPositionByIndex(t,e,n=!0){return this.getNoMergeCellWithCoordByIndex(t,e,n)}getNoMergeCellWithCoordByIndex(t,e,n=!0){const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:i}=this;let{startY:a,endY:l,startX:u,endX:c}=qn(t,e,r,s);return n&&(a+=i,l+=i,u+=o,c+=o),{startY:a,endY:l,startX:u,endX:c}}getNoMergeCellPositionByIndexWithNoHeader(t,e){const{rowHeightAccumulation:n,columnWidthAccumulation:r}=this,{startY:s,endY:o,startX:i,endX:a}=qn(t,e,n,r);return{startY:s,endY:o,startX:i,endX:a}}getRowIndexByOffsetY(t,e,n,r){var s;const{rowHeightAccumulation:o}=this;t=Hp(t,e,n,this.columnHeaderHeightAndMarginTop);let i=Sr(o,t,r?.firstMatch);return r!=null&&r.closeFirst&&Math.abs(o[i]-t)<Math.abs(t-((s=o[i-1])!=null?s:0))&&(i=i+1),i}getColumnIndexByOffsetX(t,e,n,r){var s;const o=$p(t,e,n,this.rowHeaderWidthAndMarginLeft),{columnWidthAccumulation:i}=this;let a=Sr(i,o,r?.firstMatch);return r!=null&&r.closeFirst&&Math.abs(i[a]-o)<Math.abs(o-((s=i[a-1])!=null?s:0))&&(a=a+1),a}getCellIndexByOffset(t,e,n,r,s,o){const i=this.getRowIndexByOffsetY(e,r,s,o),a=this.getColumnIndexByOffsetX(t,n,s,o);return{row:i,column:a}}getCellByOffset(t,e,n,r,s){const o=this==null?void 0:this.getCellIndexByOffset(t,e,n,r,s,{firstMatch:!0});return o?this.worksheet.getCellInfoInMergeData(o.row,o.column):null}getCellWithCoordByIndex(t,e,n=!0){const{rowHeightAccumulation:r,columnWidthAccumulation:s,rowHeaderWidthAndMarginLeft:o,columnHeaderHeightAndMarginTop:i}=this,a=qn(t,e,r,s,this.worksheet.getCellInfoInMergeData(t,e)),{isMerged:l,isMergedMainCell:u}=a;let{startY:c,endY:h,startX:d,endX:f,mergeInfo:p}=a,m=o,R=i;return n===!1&&(m=0,R=0),c+=R,h+=R,d+=m,f+=m,p.startY+=R,p.endY+=R,p.startX+=m,p.endX+=m,{actualRow:t,actualColumn:e,startX:d,startY:c,endX:f,endY:h,isMerged:l,isMergedMainCell:u,mergeInfo:p}}getCellWithCoordByOffset(t,e,n,r,s,o){const{row:i,column:a}=this.getCellIndexByOffset(t,e,n,r,s,o);return this.getCellWithCoordByIndex(i,a)}getOffsetByColumn(t){const{columnWidthAccumulation:e,rowHeaderWidthAndMarginLeft:n}=this,r=e.length-1,s=e[t];return s!=null?s+n:t<0?n:e[r]+n}getOffsetByRow(t){const{rowHeightAccumulation:e,columnHeaderHeightAndMarginTop:n}=this,r=e.length-1,s=e[t];return s!=null?s+n:t<0?n:e[r]+n}getOffsetRelativeToRowCol(t,e){const n=Sr(this.columnWidthAccumulation,t);let r=0;n===0?r=t:r=t-this._columnWidthAccumulation[n-1];const s=Sr(this.rowHeightAccumulation,e);let o=0;return s===0?o=e:o=e-this._rowHeightAccumulation[s-1],{row:s,column:n,columnOffset:r,rowOffset:o}}_updateConfigAndGetDocumentModel(t,e,n,r){var s,o,i,a,l;if(!r||!((s=t.body)!=null&&s.dataStream))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.marginTop=(o=n.t)!=null?o:0,t.documentStyle.marginBottom=(i=n.b)!=null?i:2,t.documentStyle.marginLeft=(a=n.l)!=null?a:2,t.documentStyle.marginRight=(l=n.r)!=null?l:2,t.documentStyle.pageSize={width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},t.documentStyle.renderConfig={...t.documentStyle.renderConfig,...r};const u=t.body.paragraphs||[];for(const c of u)c.paragraphStyle||(c.paragraphStyle={}),c.paragraphStyle.horizontalAlign=e;return new Pe(t)}dispose(){super.dispose(),this._rowHeightAccumulation=[],this._columnWidthAccumulation=[],this._rowTotalHeight=0,this._columnTotalWidth=0,this._rowHeaderWidth=0,this._columnHeaderHeight=0,this._worksheetData=null,this._cellData=null,this._styles=null,this.worksheet=null}};ua=ET([xs(2,Ce(An)),xs(3,yr),xs(4,is),xs(5,Ce(_n))],ua);function Sl(t,e,n,r){const s=t-1,o=e-1,i=n[s]||0;let a=n[t];a==null&&(a=n[n.length-1]);const l=r[o]||0;let u=r[e];return u==null&&(u=r[r.length-1]),{startY:i,endY:a,startX:l,endX:u}}function vT(t,e,n,r){return Sl(t,e,n,r)}function qn(t,e,n,r,s){t=q.clamp(t,0,n.length-1),e=q.clamp(e,0,r.length-1);let{startY:o,endY:i,startX:a,endX:l}=Sl(t,e,n,r);if(!s)return{startY:o,endY:i,startX:a,endX:l,isMerged:!1,isMergedMainCell:!1,actualRow:t,actualColumn:e,mergeInfo:{startY:o,endY:i,startX:a,endX:l,startRow:t,startColumn:e,endRow:t,endColumn:e}};const{isMerged:u,isMergedMainCell:c,startRow:h,startColumn:d,endRow:f,endColumn:p}=s;let m={startRow:h,startColumn:d,endRow:f,endColumn:p,startY:o,endY:i,startX:a,endX:l};const R=n.length-1,S=r.length-1;if(u&&h!==-1&&d!==-1){const P=n[h-1]||0,k=n[f]||n[R],H=r[d-1]||0,C=r[p]||r[S];m={...m,startY:P,endY:k,startX:H,endX:C}}else if(!u&&f!==-1&&p!==-1){const P=n[f]||n[R],k=r[p]||r[S];m={...m,startY:o,endY:P,startX:a,endX:k}}return{isMerged:u,isMergedMainCell:c,actualRow:t,actualColumn:e,startY:o,endY:i,startX:a,endX:l,mergeInfo:m}}function $p(t,e,n,r){const{x:s}=n;return t/e+s-r}function Hp(t,e,n,r){const{y:s}=n;return t=t/e+s-r,t}const CT=["script","style","meta","comment","link"];var jp=(t=>(t[t.INFO=0]="INFO",t[t.STOP=1]="STOP",t[t.WARNING=2]="WARNING",t))(jp||{}),Wp=(t=>(t[t.DISABLED=0]="DISABLED",t[t.FULL_ALPHA=1]="FULL_ALPHA",t[t.FULL_HANGUL=2]="FULL_HANGUL",t[t.FULL_KATAKANA=3]="FULL_KATAKANA",t[t.HALF_ALPHA=4]="HALF_ALPHA",t[t.HALF_HANGUL=5]="HALF_HANGUL",t[t.HALF_KATAKANA=6]="HALF_KATAKANA",t[t.HIRAGANA=7]="HIRAGANA",t[t.NO_CONTROL=8]="NO_CONTROL",t[t.OFF=9]="OFF",t[t.ON=10]="ON",t))(Wp||{}),Vp=(t=>(t.BETWEEN="between",t.EQUAL="equal",t.GREATER_THAN="greaterThan",t.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",t.LESS_THAN="lessThan",t.LESS_THAN_OR_EQUAL="lessThanOrEqual",t.NOT_BETWEEN="notBetween",t.NOT_EQUAL="notEqual",t))(Vp||{}),Gp=(t=>(t[t.TEXT=0]="TEXT",t[t.ARROW=1]="ARROW",t[t.CUSTOM=2]="CUSTOM",t))(Gp||{}),Yp=(t=>(t.VALID="valid",t.INVALID="invalid",t.VALIDATING="validating",t))(Yp||{}),zp=(t=>(t.CUSTOM="custom",t.LIST="list",t.LIST_MULTIPLE="listMultiple",t.NONE="none",t.TEXT_LENGTH="textLength",t.DATE="date",t.TIME="time",t.WHOLE="whole",t.DECIMAL="decimal",t.CHECKBOX="checkbox",t.ANY="any",t))(zp||{}),RT=(t,e,n,r)=>{for(var s=e,o=t.length-1,i;o>=0;o--)(i=t[o])&&(s=i(s)||s);return s},uc=(t,e)=>(n,r)=>e(n,r,t);let ca=class extends Xt{constructor(t,e){super(),this._resourceManagerService=t,this._univerInstanceService=e,this._init()}_init(){const t=e=>{e.businesses.forEach(n=>{switch(n){case bt.UNRECOGNIZED:case bt.UNIVER_UNKNOWN:case bt.UNIVER_SLIDE:case bt.UNIVER_DOC:{this._univerInstanceService.getAllUnitsForType(bt.UNIVER_DOC).forEach(r=>{const s=(r.getSnapshot().resources||[]).find(o=>o.name===e.pluginName);if(s)try{const o=e.parseJson(s.data);e.onLoad(r.getUnitId(),o)}catch{console.error(`Load Document{${r.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}});break}case bt.UNIVER_SHEET:this._univerInstanceService.getAllUnitsForType(bt.UNIVER_SHEET).forEach(r=>{const s=(r.getSnapshot().resources||[]).find(o=>o.name===e.pluginName);if(s)try{const o=e.parseJson(s.data);e.onLoad(r.getUnitId(),o)}catch{console.error(`Load Workbook{${r.getUnitId()}} Resources{${e.pluginName}} Data Error.`)}})}})};this._resourceManagerService.getAllResourceHooks().forEach(e=>t(e)),this.disposeWithMe(this._resourceManagerService.register$.subscribe(e=>t(e))),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(bt.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitAdded$(bt.UNIVER_DOC).subscribe(e=>{const n=e.getUnitId();Qc(n)||this._resourceManagerService.loadResources(e.getUnitId(),e.getSnapshot().resources)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(bt.UNIVER_SHEET).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId(),bt.UNIVER_SHEET)})),this.disposeWithMe(this._univerInstanceService.getTypeOfUnitDisposed$(bt.UNIVER_DOC).subscribe(e=>{this._resourceManagerService.unloadResources(e.getUnitId(),bt.UNIVER_DOC)}))}saveUnit(t){const e=this._univerInstanceService.getUnit(t);if(!e)return null;const n=this._resourceManagerService.getResources(t,e.type),r=q.deepClone(e.getSnapshot());return r.resources=n,r}};ca=RT([uc(0,Ce(Uo)),uc(1,Ce(hr))],ca);class bT{constructor(e={},n){_(this,"_startedTypes",new Set),_(this,"_injector"),_(this,"_disposingCallbacks",new bo);const r=this._injector=TT(n,e?.override),{theme:s,darkMode:o,locale:i,locales:a,logLevel:l,logCommandExecution:u}=e;s&&this._injector.get(ho).setTheme(s),o&&this._injector.get(ho).setDarkMode(o),a&&this._injector.get(An).load(a),i&&this._injector.get(An).setLocale(i),l&&this._injector.get(Ee).setLogLevel(l),u!==void 0&&this._injector.get(is).setConfig(Qs,u),this._init(r)}get _univerInstanceService(){return this._injector.get(hr)}get _pluginService(){return this._injector.get(es)}__getInjector(){return this._injector}onDispose(e){const n=this._disposingCallbacks.add(Wt(e));return Wt(()=>n.dispose(!0))}dispose(){this._disposingCallbacks.dispose(),this._injector.dispose()}setLocale(e){this._injector.get(An).setLocale(e)}createUnit(e,n){return this._univerInstanceService.createUnit(e,n)}createUniverSheet(e){return this._injector.get(Ee).warn("[Univer]","Univer.createUniverSheet is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(bt.UNIVER_SHEET,e)}createUniverDoc(e){return this._injector.get(Ee).warn("[Univer]","Univer.createUniverDoc is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(bt.UNIVER_DOC,e)}createUniverSlide(e){return this._injector.get(Ee).warn("[Univer]","Univer.createUniverSlide is deprecated, use createUnit instead"),this._univerInstanceService.createUnit(bt.UNIVER_SLIDE,e)}_init(e){this._univerInstanceService.registerCtorForType(bt.UNIVER_SHEET,ts),this._univerInstanceService.registerCtorForType(bt.UNIVER_DOC,Pe),this._univerInstanceService.registerCtorForType(bt.UNIVER_SLIDE,Tl);const n=e.get(hr);n.__setCreateHandler((r,s,o,i)=>{if(!this._startedTypes.has(r)){this._pluginService.startPluginsForType(r),this._startedTypes.add(r);const l=e.createInstance(o,s);return n.__addUnit(l,i),this._tryProgressToReady(),l}const a=e.createInstance(o,s);return n.__addUnit(a,i),a})}_tryProgressToReady(){this._injector.get(Ln).stage<Ut.Ready&&(this._injector.get(Ln).stage=Ut.Ready)}registerPlugin(e,n){this._pluginService.registerPlugin(e,n)}registerPlugins(e){e.forEach(n=>{const[r,s]=n;this._pluginService.registerPlugin(r,s)})}}function TT(t,e){const n=Np([[ap],[An],[ho],[Ln],[es],[qr],[hr,{useClass:lo}],[Op,{useClass:Dp}],[Ee,{useClass:Ad,lazy:!0}],[ls,{useClass:qs}],[Fo,{useClass:fo,lazy:!0}],[is,{useClass:Id}],[yr,{useClass:wd}],[Uo,{useClass:co,lazy:!0}],[aa,{useClass:ca,lazy:!0}],[sp,{useClass:io}],[Ap,{useClass:uo,lazy:!0}]],e),r=t?t.createChild(n):new _n(n);return qc(r,[[qr],[aa]]),r}Nm();const AT=Object.freeze(Object.defineProperty({__proto__:null,ABCToNumber:XC,AUTO_HEIGHT_FOR_MERGED_CELLS:Jc,AbsoluteRefType:Ot,ActionIterator:Qn,AlignTypeH:gd,AlignTypeV:md,ArrangeTypeEnum:Ed,ArrowsAndMarkersShapes:Hh,AsyncInterceptorManager:Zm,AsyncLock:Hm,get AuthzIoLocalService(){return io},AutoFillSeries:Dh,BaselineOffset:tn,BasicShapes:$h,BlockType:Xh,BooleanNumber:ot,BorderStyleTypes:Mt,BorderType:Nh,BuildTextUtils:te,BulletAlignment:os,COLORS:Ti,COMMAND_LOG_EXECUTION_CONFIG_KEY:Qs,CanceledError:zm,CellModeEnum:er,CellValueType:hn,Color:Nn,ColorBuilder:So,ColorKit:we,ColorType:Se,ColumnSeparatorType:qh,get CommandService(){return qs},CommandType:as,CommonHideTypes:xh,ConfigService:Id,ContextService:wd,CopyPasteType:Mh,CustomCommandExecutionError:Gs,CustomDecorationType:wn,CustomRangeType:gn,DEFAULT_CELL:IC,DEFAULT_DOC:Cl,DEFAULT_DOCUMENT_SUB_COMPONENT_ID:ub,DEFAULT_EMPTY_DOCUMENT_VALUE:Kc,DEFAULT_NUMBER_FORMAT:ml,DEFAULT_RANGE:bC,DEFAULT_RANGE_ARRAY:RC,DEFAULT_SELECTION:TC,DEFAULT_SLIDE:bf,DEFAULT_STYLES:le,DEFAULT_TEXT_FORMAT:hf,DEFAULT_TEXT_FORMAT_EXCEL:df,DEFAULT_WORKSHEET_COLUMN_COUNT:_p,DEFAULT_WORKSHEET_COLUMN_COUNT_KEY:jb,DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT:Cp,DEFAULT_WORKSHEET_COLUMN_TITLE_HEIGHT_KEY:Yb,DEFAULT_WORKSHEET_COLUMN_WIDTH:Ep,DEFAULT_WORKSHEET_COLUMN_WIDTH_KEY:Vb,DEFAULT_WORKSHEET_ROW_COUNT:mp,DEFAULT_WORKSHEET_ROW_COUNT_KEY:Hb,DEFAULT_WORKSHEET_ROW_HEIGHT:yp,DEFAULT_WORKSHEET_ROW_HEIGHT_KEY:Wb,DEFAULT_WORKSHEET_ROW_TITLE_WIDTH:vp,DEFAULT_WORKSHEET_ROW_TITLE_WIDTH_KEY:Gb,DOCS_COMMENT_EDITOR_UNIT_ID_KEY:zc,DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY:ba,DOCS_NORMAL_EDITOR_UNIT_ID_KEY:Ra,DOCS_ZEN_EDITOR_UNIT_ID_KEY:Yc,DOC_DRAWING_PRINTING_COMPONENT_KEY:DC,DOC_RANGE_TYPE:Wd,DashStyleType:sd,DataStreamTreeNodeType:qf,DataStreamTreeTokenType:de,DataValidationErrorStyle:jp,DataValidationImeMode:Wp,DataValidationOperator:Vp,DataValidationRenderMode:Gp,DataValidationStatus:Yp,DataValidationType:zp,DeleteDirection:Lh,DependentOn:aT,DesktopLogService:Ad,DeveloperMetadataVisibility:Uh,Dimension:Fh,Direction:kh,Disposable:Xt,DisposableCollection:bo,DocStyleType:zh,DocumentDataModel:Pe,DocumentFlavor:La,DrawingTypeEnum:vd,EDITOR_ACTIVATED:op,EXTENSION_NAMES:Tf,ErrorService:ap,EventState:rp,EventSubject:cb,FOCUSING_COMMENT_EDITOR:vb,FOCUSING_COMMON_DRAWINGS:bb,FOCUSING_DOC:Br,FOCUSING_EDITOR_BUT_HIDDEN:mb,FOCUSING_EDITOR_INPUT_FORMULA:_b,FOCUSING_EDITOR_STANDALONE:Eb,FOCUSING_FX_BAR_EDITOR:ip,FOCUSING_PANEL_EDITOR:Cb,FOCUSING_SHAPE_TEXT_EDITOR:Tb,FOCUSING_SHEET:sr,FOCUSING_SLIDE:$r,FOCUSING_UNIT:Pr,FOCUSING_UNIVER_EDITOR:yb,FOCUSING_UNIVER_EDITOR_STANDALONE_SINGLE_MODE:Rb,FORMULA_EDITOR_ACTIVATED:Ib,FollowNumberWithType:Kh,FontItalic:Xs,FontStyleType:tr,FontWeight:Js,GridType:Jh,HLSColor:Ud,HorizontalAlign:Fe,IAuthzIoService:sp,ICommandService:ls,IConfigService:is,IConfirmService:pb,IContextService:yr,IImageIoService:ra,ILocalStorageService:eT,ILogService:Ee,IMentionIOService:Ap,IPermissionService:Op,IResourceLoaderService:aa,IResourceManagerService:Uo,IS_ROW_STYLE_PRECEDE_COLUMN_STYLE:Xc,IURLImageService:sa,IUndoRedoService:Fo,IUniverInstanceService:hr,ImageCacheMap:Pp,ImageSourceType:ao,ImageUploadStatusType:lp,Inject:Ce,InjectSelf:Cg,Injector:_n,InterceptorEffectEnum:Zn,InterceptorManager:Jm,InterpolationPointType:Ph,JSON1:kE,JSONX:Mn,LRUHelper:Ur,LRUMap:Mo,get LifecycleService(){return Ln},LifecycleStages:Ut,LifecycleUnreachableError:wp,ListGlyphType:dt,get LocalUndoRedoService(){return fo},LocaleService:An,LocaleType:ss,LogLevel:Sd,LookUp:Ze,MAX_COLUMN_COUNT:Gi,MAX_ROW_COUNT:Vi,MOVE_BUFFER_VALUE:Ar,Many:mc,MemoryCursor:kn,get MentionIOLocalService(){return uo},MentionType:Ks,NAMED_STYLE_MAP:SC,NAMED_STYLE_SPACE_MAP:AC,NamedStyleType:Jt,NilCommand:Od,NumberUnitType:pd,ObjectMatrix:fe,ObjectRelativeFromH:dd,ObjectRelativeFromV:fd,Optional:_c,OtherShapes:jh,PAGE_SIZE:NC,PAPER_TYPES:AE,PRESET_LIST_TYPE:hs,PRINT_CHART_COMPONENT_KEY:OC,PageElementType:Cd,PageOrientType:yd,PageType:Ua,PaperType:me,ParagraphElementType:td,ParagraphStyleBuilder:Qr,ParagraphStyleValue:fs,PermissionService:Dp,PermissionStatus:Il,Plugin:ia,get PluginService(){return es},PositionedObjectLayoutType:nd,PresetListType:Ye,ProtectionType:Bh,Quantity:Nt,QuickListType:jf,QuickListTypeMap:iR,RANGE_DIRECTION:jd,RANGE_TYPE:gt,RBush:no,RCDisposable:fE,RGBA_PAREN:qE,RGB_PAREN:QE,ROTATE_BUFFER_VALUE:Md,RTree:pT,Range:eo,Rectangle:xn,RediError:Re,RedoCommand:kp,RedoCommandId:Lp,RefAlias:KC,Registry:Na,RegistryAsMap:xa,RelativeDate:Vh,RelativeSlideLink:Rd,get ResourceManagerService(){return co},RgbColor:Fd,RichTextBuilder:Sn,RichTextValue:un,RxDisposable:dE,SHEET_EDITOR_UNITS:wC,SectionType:Qh,Self:pc,get SheetSkeleton(){return ua},SheetTypes:Gh,SheetViewModel:bp,get Skeleton(){return po},SkipSelf:fc,SliceBodyType:vl,SlideDataModel:Tl,SpacingRule:rd,SpecialShapes:Wh,Styles:up,THEME_COLORS:Ld,TabStopAlignment:od,TableAlignmentType:ad,TableLayoutType:ld,TableRowHeightRule:cd,TableSizeType:id,TableTextWrapType:ud,TestConfirmService:gb,TextDecoration:Yh,TextDecorationBuilder:ln,TextDirection:Kr,TextDirectionType:Zh,TextStyleBuilder:fn,TextStyleValue:ds,TextX:xt,TextXActionType:J,ThemeColor:Pd,ThemeColorType:ce,ThemeColors:Io,ThemeService:ho,Tools:q,UndoCommand:Fp,UndoCommandId:Up,UnitModel:To,Univer:bT,get UniverInstanceService(){return lo},UniverInstanceType:bt,UpdateDocsAttributeType:_t,UserManagerService:qr,VerticalAlign:In,VerticalAlignmentType:hd,WithNew:ug,get Workbook(){return ts},Worksheet:Zr,WrapStrategy:Dn,WrapTextType:ed,addLinkToDocumentModel:cp,afterInitApply:YE,afterTime:VE,awaitTime:gT,binSearchFirstGreaterThanTarget:xd,binarySearchArray:zE,bufferDebounceTime:WE,cellToRange:S1,characterSpacingControlType:_d,checkForSubstrings:O1,checkIfMove:XE,checkParagraphHasBullet:hC,checkParagraphHasIndent:dC,checkParagraphHasIndentByStyle:yf,cloneCellData:fp,cloneCellDataMatrix:pp,cloneCellDataWithSpanAndDisplay:Fb,cloneValue:ve,cloneWorksheetData:gp,codeToBlob:KE,columnLabelToNumber:CC,composeBody:Qi,composeInterceptors:th,composeStyles:wr,concatMatrixArray:m1,convertBodyToHtml:JE,convertCellToRange:pf,convertObservableToBehaviorSubject:GE,covertCellValue:Li,covertCellValues:A1,covertTextRunToHtml:bi,createAsyncInterceptorKey:Qm,createDefaultUser:oo,createDocumentModelWithStyle:Hr,createIdentifier:ue,createInterceptorKey:Xm,createInternalEditorID:Vm,createREGEXFromWildChar:wE,createRowColIter:Ki,customNameCharacterCheck:fT,dayjs:nn,debounce:Zy,dedupe:xm,dedupeBy:Mm,deepCompare:_l,delayAnimationFrame:mT,deleteContent:vf,extractPureTextFromCell:Tp,forwardRef:sg,fromCallback:Dd,fromEventSubject:hb,generateIntervalsByPoints:gC,generateRandomId:re,get:vh,getArrayLength:dn,getBodySlice:ke,getBodySliceHtml:ks,getBorderStyleType:T1,getCellCoordByIndexSimple:Sl,getCellInfoInMergeData:gv,getCellPositionByIndexSimple:vT,getCellValueType:dv,getCellWithCoordByIndexCore:qn,getColorStyle:Ve,getCustomBlockSlice:Yf,getCustomDecorationSlice:Kf,getCustomRangeSlice:zf,getDocsUpdateBody:I1,getEmptyCell:Mb,getIntersectRange:Sf,getNumfmtParseValueFilter:ff,getOriginCellValue:Kb,getParagraphsSlice:Gf,getPlainText:Lo,getReverseDirection:SE,getSectionBreakSlice:gR,getTableSlice:Vf,getTextRunSlice:so,getTransformOffsetX:$p,getTransformOffsetY:Hp,getWorksheetUID:Qb,groupBy:Fm,handleStyleToString:b1,hashAlgorithm:pC,horizontalLineSegmentsSubtraction:xo,insertMatrixArray:g1,insertTextToContent:Ef,invertColorByHSL:o0,invertColorByMatrix:a0,isAsyncDependencyItem:di,isAsyncHook:Ms,isBlackColor:cv,isBooleanString:Wm,isCellCoverable:Mi,isCellV:Hd,isClassDependencyItem:ui,isCommentEditorID:Gm,isCtor:da,isDefaultFormat:u1,isDisposable:Ec,isEmptyCell:gf,isFactoryDependencyItem:ci,isFormulaId:R1,isFormulaString:mf,isICellData:$d,isInternalEditorID:Qc,isNodeEnv:IE,isNotNullOrUndefined:hp,isNullCell:fv,isNumeric:Th,isPatternEqualWithoutDecimal:c1,isRangesEqual:Ob,isRealNum:fC,isSafeNumeric:aE,isSameStyleTextRun:_f,isTextFormat:l1,isUnitRangesEqual:Db,isValidRange:w1,isValueDependencyItem:hi,isWhiteColor:hv,makeArray:km,makeCellRangeToRangeData:C1,makeCellToSelection:v1,makeCustomRangeStream:OR,mapObjectMatrix:p1,merge:Ro,mergeIntervals:mC,mergeLocales:_C,mergeOverrideWithDependencies:Np,mergeSets:cE,mergeWith:rE,mergeWorksheetSnapshotWithDefault:Rp,mixinClass:iE,moveMatrixArray:xi,moveRangeByOffset:PC,nameCharacterCheck:dT,normalizeBody:mR,normalizeTextRuns:cs,numberToABC:QC,numberToListABC:qC,numfmt:a1,queryObjectMatrix:zC,registerDependencies:Ym,remove:ns,repeatStringNumTimes:Of,replaceInDocumentBody:ab,requestImmediateMacroTask:uE,resolveWithBasePath:_E,rotate:Um,searchArray:Sr,searchInOrderedArray:Nd,selectionToArray:pv,sequence:wh,sequenceAsync:Ih,sequenceExecute:wo,sequenceExecuteAsync:jE,set:oE,setDependencies:rg,shallowEqual:Zc,skipParseTagNames:CT,sliceMatrixArray:_1,sortRules:ZC,sortRulesByDesc:tR,sortRulesFactory:us,spliceArray:Ni,splitIntoGrid:yl,takeAfter:Ri,textDiff:Rl,throttle:Km,toDisposable:Wt,touchDependencies:qc,updateAttributeByDelete:Xf,updateAttributeByInsert:Jf,willLoseNumericPrecision:lE},Symbol.toStringTag,{value:"Module"}));export{Xh as $,bT as A,Gs as B,So as C,wn as D,gn as E,IC as F,Cl as G,Ti as H,Nh as I,Jc as J,ub as K,as as L,Hh as M,ss as N,sp as O,ml as P,te as Q,_C as R,bC as S,$h as T,XC as U,io as V,Nn as W,Kc as X,RC as Y,tn as Z,TC as _,Sd as a,Kh as a$,bf as a0,le as a1,hf as a2,df as a3,_p as a4,jb as a5,Cp as a6,Yb as a7,Ep as a8,Vb as a9,kh as aA,Xt as aB,bo as aC,zh as aD,Pe as aE,La as aF,vd as aG,op as aH,Tf as aI,ap as aJ,rp as aK,cb as aL,vb as aM,bb as aN,Br as aO,mb as aP,_b as aQ,Eb as aR,ip as aS,Cb as aT,Tb as aU,sr as aV,$r as aW,Pr as aX,yb as aY,Rb as aZ,Ib as a_,mp as aa,Hb as ab,yp as ac,Wb as ad,vp as ae,Gb as af,zc as ag,ba as ah,Ra as ai,Yc as aj,DC as ak,Wd as al,sd as am,qf as an,de as ao,jp as ap,Wp as aq,Vp as ar,Gp as as,Yp as at,zp as au,Lh as av,aT as aw,Ad as ax,Uh as ay,Fh as az,Ot as b,me as b$,Xs as b0,tr as b1,Js as b2,Jh as b3,Ud as b4,Fe as b5,ls as b6,is as b7,pb as b8,yr as b9,fo as bA,An as bB,Ze as bC,Gi as bD,Vi as bE,Ar as bF,mc as bG,kn as bH,uo as bI,Ks as bJ,SC as bK,AC as bL,Jt as bM,Od as bN,pd as bO,fe as bP,dd as bQ,fd as bR,_c as bS,jh as bT,NC as bU,AE as bV,hs as bW,OC as bX,Cd as bY,yd as bZ,Ua as b_,ra as ba,eT as bb,Ee as bc,Op as bd,aa as be,Uo as bf,Xc as bg,sa as bh,hr as bi,Pp as bj,ao as bk,lp as bl,Ce as bm,Cg as bn,_n as bo,Zn as bp,Jm as bq,Ph as br,kE as bs,Mn as bt,Ur as bu,Mo as bv,Ln as bw,Ut as bx,wp as by,dt as bz,gd as c,xt as c$,td as c0,Qr as c1,fs as c2,Dp as c3,Il as c4,ia as c5,es as c6,nd as c7,Ye as c8,Bh as c9,wC as cA,Qh as cB,pc as cC,ua as cD,Gh as cE,bp as cF,po as cG,fc as cH,vl as cI,Tl as cJ,rd as cK,Wh as cL,up as cM,Ld as cN,od as cO,ad as cP,ld as cQ,cd as cR,id as cS,ud as cT,gb as cU,Yh as cV,ln as cW,Kr as cX,Zh as cY,fn as cZ,ds as c_,Nt as ca,jf as cb,iR as cc,jd as cd,gt as ce,no as cf,fE as cg,qE as ch,QE as ci,Md as cj,pT as ck,eo as cl,xn as cm,Re as cn,kp as co,Lp as cp,KC as cq,Na as cr,xa as cs,Vh as ct,Rd as cu,co as cv,Fd as cw,Sn as cx,un as cy,dE as cz,Dh as d,xm as d$,J as d0,Pd as d1,ce as d2,Io as d3,ho as d4,q as d5,Fp as d6,Up as d7,To as d8,lo as d9,pp as dA,Fb as dB,ve as dC,gp as dD,KE as dE,CC as dF,Qi as dG,th as dH,wr as dI,m1 as dJ,JE as dK,pf as dL,GE as dM,Li as dN,A1 as dO,bi as dP,Qm as dQ,oo as dR,Hr as dS,ue as dT,Xm as dU,Vm as dV,wE as dW,Ki as dX,fT as dY,nn as dZ,Zy as d_,bt as da,_t as db,qr as dc,In as dd,hd as de,ug as df,ts as dg,Zr as dh,Dn as di,ed as dj,cp as dk,YE as dl,VE as dm,gT as dn,xd as dp,zE as dq,WE as dr,S1 as ds,_d as dt,O1 as du,XE as dv,hC as dw,dC as dx,yf as dy,fp as dz,ot as e,$d as e$,Mm as e0,_l as e1,ys as e2,mT as e3,vf as e4,Tp as e5,sg as e6,Dd as e7,hb as e8,gC as e9,$p as eA,Hp as eB,Qb as eC,wT as eD,Fm as eE,b1 as eF,pC as eG,xo as eH,g1 as eI,Ef as eJ,o0 as eK,a0 as eL,di as eM,Ms as eN,cv as eO,Wm as eP,Mi as eQ,Hd as eR,ui as eS,Gm as eT,da as eU,u1 as eV,Ec as eW,gf as eX,ci as eY,R1 as eZ,mf as e_,re as ea,vh as eb,dn as ec,ke as ed,ks as ee,T1 as ef,Sl as eg,gv as eh,vT as ei,dv as ej,qn as ek,Ve as el,Yf as em,Kf as en,zf as eo,I1 as ep,Mb as eq,Sf as er,ff as es,Kb as et,Gf as eu,Lo as ev,SE as ew,gR as ex,Vf as ey,so as ez,Ap as f,Wt as f$,Qc as f0,IE as f1,hp as f2,fv as f3,Th as f4,c1 as f5,Ob as f6,fC as f7,aE as f8,_f as f9,Ym as fA,ns as fB,Of as fC,ab as fD,uE as fE,_E as fF,Um as fG,Sr as fH,Nd as fI,pv as fJ,wh as fK,Ih as fL,wo as fM,jE as fN,oE as fO,rg as fP,Zc as fQ,CT as fR,_1 as fS,ZC as fT,tR as fU,us as fV,Ni as fW,yl as fX,Ri as fY,Rl as fZ,Km as f_,l1 as fa,Db as fb,w1 as fc,hi as fd,hv as fe,km as ff,C1 as fg,v1 as fh,OR as fi,p1 as fj,Ro as fk,mC as fl,Np as fm,cE as fn,rE as fo,Rp as fp,iE as fq,xi as fr,PC as fs,dT as ft,mR as fu,cs as fv,QC as fw,qC as fx,a1 as fy,zC as fz,os as g,qc as g0,Xf as g1,Jf as g2,lE as g3,Be as g4,Oe as g5,ie as g6,vm as g7,ee as g8,Wc as g9,va as gA,Ic as gB,Ws as gC,cn as gD,lr as gE,ze as gF,Pg as gG,Bg as gH,Ac as gI,_m as gJ,_o as gK,Vs as gL,AT as gM,fr as ga,jc as gb,pm as gc,pr as gd,Gl as ge,pn as gf,nm as gg,ym as gh,Kt as gi,Hc as gj,Un as gk,_s as gl,se as gm,Vc as gn,wc as go,Fg as gp,Gc as gq,Hg as gr,IT as gs,Yr as gt,Gr as gu,gm as gv,im as gw,Bl as gx,Tm as gy,dr as gz,zm as h,Fo as i,hn as j,we as k,er as l,Zm as m,Qn as n,md as o,Se as p,qh as q,qs as r,Hm as s,Id as t,Ed as u,wd as v,xh as w,Mt as x,Qs as y,Mh as z};
