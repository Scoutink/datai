import{UniverDocsPlugin as $t}from"./index-GTTB9Gpg.js";import{DOC_INTERCEPTOR_POINT as io,DocInterceptorService as lo,DocSelectionManagerService as co,DocSkeletonManagerService as mo,DocStateEmitService as uo,RichTextEditingMutation as ho,SetTextSelectionsOperation as go,addCustomRangeBySelectionFactory as So,addCustomRangeFactory as Co,deleteCustomRangeFactory as vo,replaceSelectionFactory as po}from"./index-GTTB9Gpg.js";import{UniverDocsUIPlugin as Gt}from"./index-C5GuqOxb.js";import{AfterSpaceCommand as fo,AlignCenterCommand as _o,AlignJustifyCommand as bo,AlignLeftCommand as Eo,AlignOperationCommand as To,AlignRightCommand as Io,BreakLineCommand as Mo,BulletListCommand as yo,ChangeListNestingLevelCommand as Fo,ChangeListNestingLevelType as Po,ChangeListTypeCommand as No,CheckListCommand as Do,CoverContentCommand as Ao,CreateDocTableCommand as xo,CutContentCommand as Oo,DOCS_COMPONENT_BACKGROUND_LAYER_INDEX as ko,DOCS_COMPONENT_DEFAULT_Z_INDEX as Lo,DOCS_COMPONENT_HEADER_LAYER_INDEX as Uo,DOCS_COMPONENT_MAIN_LAYER_INDEX as wo,DOCS_VIEW_KEY as Wo,DOC_UI_PLUGIN_NAME as Bo,DOC_VERTICAL_PADDING as jo,DefaultDocContainerConfig as Ho,DefaultToolbarConfig as Vo,DeleteCommand as $o,DeleteCustomBlockCommand as Go,DeleteLeftCommand as Yo,DeleteRightCommand as Ko,DocAutoFormatService as zo,DocBackScrollRenderController as Xo,DocCanvasPopManagerService as Zo,DocCopyCommand as Jo,DocCreateTableOperation as qo,DocCutCommand as Qo,DocEventManagerService as er,DocIMEInputManagerService as tr,DocPasteCommand as ar,DocPrintInterceptorService as nr,DocRenderController as sr,DocSelectAllCommand as or,DocSelectionRenderService as rr,DocStateChangeManagerService as ir,DocTableDeleteColumnsCommand as lr,DocTableDeleteRowsCommand as cr,DocTableDeleteTableCommand as mr,DocTableInsertColumnCommand as ur,DocTableInsertColumnLeftCommand as dr,DocTableInsertColumnRightCommand as hr,DocTableInsertRowAboveCommand as gr,DocTableInsertRowBellowCommand as Sr,DocTableInsertRowCommand as Cr,DocTableTabCommand as vr,DocUIController as pr,DocsRenderService as Rr,DocsUIMenuSchema as fr,Editor as _r,EditorInsertTextCommandId as br,EditorService as Er,EnterCommand as Tr,HorizontalLineCommand as Ir,IDocClipboardService as Mr,IEditorService as yr,IMEInputCommand as Fr,InnerPasteCommand as Pr,InsertCommand as Nr,InsertCustomRangeCommand as Dr,ListOperationCommand as Ar,MergeTwoParagraphCommand as xr,MoveCursorOperation as Or,MoveSelectionOperation as kr,NORMAL_TEXT_SELECTION_PLUGIN_NAME as Lr,NodePositionConvertToCursor as Ur,NodePositionConvertToRectRange as wr,OrderListCommand as Wr,PastePluginLark as Br,PastePluginUniver as jr,PastePluginWord as Hr,QuickListCommand as Vr,RectRange as $r,ReplaceContentCommand as Gr,ReplaceSelectionCommand as Yr,ReplaceSnapshotCommand as Kr,ReplaceTextRunsCommand as zr,ResetInlineFormatTextBackgroundColorCommand as Xr,RichTextEditor as Zr,SetDocZoomRatioCommand as Jr,SetDocZoomRatioOperation as qr,SetInlineFormatBoldCommand as Qr,SetInlineFormatCommand as ei,SetInlineFormatFontFamilyCommand as ti,SetInlineFormatFontSizeCommand as ai,SetInlineFormatItalicCommand as ni,SetInlineFormatStrikethroughCommand as si,SetInlineFormatSubscriptCommand as oi,SetInlineFormatSuperscriptCommand as ri,SetInlineFormatTextBackgroundColorCommand as ii,SetInlineFormatTextColorCommand as li,SetInlineFormatUnderlineCommand as ci,SetParagraphNamedStyleCommand as mi,SwitchDocModeCommand as ui,TEXT_RANGE_LAYER_INDEX as di,TabCommand as hi,TextRange as gi,ToggleCheckListCommand as Si,UpdateCommand as Ci,VIEWPORT_KEY as vi,addCustomDecorationBySelectionFactory as pi,addCustomDecorationFactory as Ri,calcDocRangePositions as fi,convertBodyToHtml as _i,convertPositionsToRectRanges as bi,deleteCustomDecorationFactory as Ei,docDrawingPositionToTransform as Ti,genTableSource as Ii,generateParagraphs as Mi,getAnchorBounding as yi,getCanvasOffsetByEngine as Fi,getCommandSkeleton as Pi,getCursorWhenDelete as Ni,getCustomBlockIdsInSelections as Di,getCutActionsFromDocRanges as Ai,getDocObject as xi,getDocObjectById as Oi,getEmptyTableCell as ki,getEmptyTableRow as Li,getLineBounding as Ui,getOneTextSelectionRange as wi,getRichTextEditPath as Wi,getTableColumn as Bi,hasParagraphInTable as ji,isInSameTableCell as Hi,isValidRectRange as Vi,neoGetDocObject as $i,transformToDocDrawingPosition as Gi,useEditor as Yi,useEditorClickOutside as Ki,useIsFocusing as zi,useKeyboardEvent as Xi,useLeftAndRightArrow as Zi,useOnChange as Ji,useResize as qi,whenDocAndEditorFocused as Qi}from"./index-C5GuqOxb.js";import{c5 as Yt,b6 as xe,aU as Kt,aT as zt,aR as ze,a7 as Xt,h as Zt,aZ as Jt,aY as qt,aX as Qt,aW as ea,aN as ta,aM as aa,b3 as Xe,b2 as Ze,g as na,b1 as sa,b0 as oa,as as ra,ah as ia,ab as la,al as ca,aS as Je,a0 as ma,R as lt,bk as ct,c7 as ua,E as da}from"./index-BBqjqAkl.js";import{Z as tl,K as al,C as nl,a as sl,b as ol,_ as rl,s as il,N as ll,I as cl,W as ml,o as ul,v as dl,J as hl,c as gl,c8 as Sl,c9 as Cl,ca as vl,z as pl,u as Rl,G as fl,d as _l,M as bl,A as El,B as Tl,cb as Il,cc as Ml,e as yl,f as Fl,t as Pl,T as Nl,i as Dl,j as Al,k as xl,l as Ol,m as kl,n as Ll,X as Ul,p as wl,Q as Wl,q as Bl,r as jl,w as Hl,x as Vl,y as $l,P as Gl,D as Yl,F as Kl,H as zl,L as Xl,O as Zl,S as Jl,U as ql,V as Ql,Y as ec,$ as tc,a1 as ac,a2 as nc,a3 as sc,a4 as oc,a5 as rc,a6 as ic,a8 as lc,a9 as cc,aa as mc,ac as uc,ad as dc,ae as hc,af as gc,ag as Sc,ai as Cc,aj as vc,cd as pc,ce as Rc,cf as fc,ak as _c,am as bc,an as Ec,ao as Tc,ap as Ic,aq as Mc,ar as yc,at as Fc,au as Pc,av as Nc,aw as Dc,ax as Ac,ay as xc,az as Oc,aA as kc,cg as Lc,ch as Uc,aB as wc,aC as Wc,aD as Bc,aE as jc,aF as Hc,ci as Vc,cj as $c,ck as Gc,aG as Yc,aH as Kc,aI as zc,aJ as Xc,aK as Zc,aL as Jc,aO as qc,aP as Qc,aQ as em,aV as tm,a_ as am,a$ as nm,b4 as sm,b5 as om,b7 as rm,b8 as im,b9 as lm,ba as cm,bb as mm,cl as um,bc as dm,bd as hm,cm as gm,be as Sm,bf as Cm,bg as vm,bh as pm,bi as Rm,bj as fm,cn as _m,bl as bm,bm as Em,bn as Tm,bo as Im,bp as Mm,bq as ym,br as Fm,bs as Pm,bt as Nm,bu as Dm,bv as Am,bw as xm,bx as Om,by as km,bz as Lm,bA as Um,bB as wm,bC as Wm,bD as Bm,bE as jm,bF as Hm,bG as Vm,bH as $m,bI as Gm,bJ as Ym,bK as Km,bL as zm,bM as Xm,bN as Zm,bO as Jm,bP as qm,bQ as Qm,bR as eu,bS as tu,bT as au,bU as nu,bV as su,bW as ou,bX as ru,bY as iu,bZ as lu,b_ as cu,b$ as mu,c0 as uu,c1 as du,c2 as hu,c3 as gu,c4 as Su,co as Cu,c6 as vu}from"./index-BBqjqAkl.js";import{aa as ce,o as ha}from"./index-DnxWP_AP.js";import{T as Ru,Y as fu,U as _u,W as bu,S as Eu,a as Tu,A as Iu,g as Mu,b as yu,X as Fu,z as Pu,c as Nu,y as Du,I as Au,k as xu,m as Ou,d as ku,M as Lu,L as Uu,n as wu,N as Wu,e as Bu,h as ju,G as Hu,f as Vu,p as $u,i as Gu,j as Yu,l as Ku,s as zu,r as Xu,q as Zu,t as Ju,u as qu,v as Qu,_ as ed,w as td,x as ad,B as nd,C as sd,D as od,E as rd,F as id,H as ld,J as cd,K as md,O as ud,P as dd,Q as hd,R as gd,V as Sd,Z as Cd,$ as vd,a0 as pd,a1 as Rd,a2 as fd,a3 as _d,a4 as bd,a5 as Ed,a6 as Td,a7 as Id,a8 as Md,a9 as yd,ab as Fd,ac as Pd,ad as Nd,ae as Dd,af as Ad,ag as xd,ah as Od,ai as kd,aj as Ld,ak as Ud,al as wd,am as Wd,an as Bd,ao as jd,ap as Hd,aq as Vd,ar as $d,as as Gd,at as Yd,au as Kd,av as zd,aw as Xd,ax as Zd,ay as Jd,az as qd,aA as Qd,aB as eh,aC as th,aD as ah,aE as nh,aF as sh,aG as oh,aH as rh,aI as ih,aJ as lh,aK as ch,aL as mh,aM as uh,aN as dh,aO as hh,aP as gh,aQ as Sh,aR as Ch,aS as vh,aT as ph,aU as Rh,aV as fh,aW as _h,aX as bh,aY as Eh,aZ as Th,a_ as Ih,a$ as Mh,b0 as yh,b1 as Fh,b2 as Ph,b3 as Nh,b4 as Dh,b5 as Ah,b6 as xh,b7 as Oh,b8 as kh,b9 as Lh,ba as Uh,bb as wh,bc as Wh,bd as Bh,be as jh,bf as Hh,bg as Vh,bh as $h,bi as Gh,bj as Yh,bk as Kh,bl as zh,bm as Xh,bn as Zh,bo as Jh,bp as qh,bq as Qh,br as eg,bs as tg,bt as ag,bu as ng,bv as sg,bw as og,bx as rg,by as ig,bz as lg,bA as cg,bB as mg,bC as ug,bD as dg,bE as hg,bF as gg,bG as Sg,bH as Cg,bI as vg,bJ as pg,bK as Rg,bL as fg,bM as _g,bN as bg,bO as Eg,bP as Tg,bQ as Ig,bR as Mg,bS as yg,bT as Fg,bU as Pg,bV as Ng,bW as Dg,bX as Ag,bY as xg,bZ as Og,b_ as kg,b$ as Lg,c0 as Ug,c1 as wg,c2 as Wg,c3 as Bg,c4 as jg,c5 as Hg,c6 as Vg,c7 as $g,c8 as Gg,c9 as Yg,ca as Kg,cb as zg,cc as Xg,cd as Zg,ce as Jg,cf as qg,cg as Qg,ch as eS,ci as tS,cj as aS,ck as nS,cl as sS,cm as oS,cn as rS,co as iS,cp as lS,cq as cS,cr as mS,cs as uS,ct as dS,cu as hS,cv as gS,cw as SS,cx as CS,cy as vS,cz as pS,cA as RS,cB as fS,cC as _S,cD as bS,cE as ES,cF as TS,cG as IS,cH as MS,cI as yS,cJ as FS,cK as PS,cL as NS,cM as DS,cN as AS,cO as xS,cP as OS,cQ as kS,cR as LS,cS as US,cT as wS,cU as WS,cV as BS,cW as jS,cX as HS,cY as VS,cZ as $S}from"./index-DnxWP_AP.js";import{V as ga}from"./facade-DIbSrBHn.js";import{X as YS,N as KS,Q as zS,I as XS,_ as ZS,a as JS,q as qS,v as QS,x as eC,L as tC,Y as aC,z as nC,b as sC,E as oC,J as rC,K as iC,c as lC,D as cC}from"./facade-DIbSrBHn.js";import{a as Sa,p as Ca,R as va,D as Oe,O as ke,j as pa,V as Ra,N as fa,r as _a,d as ba,l as Ea,x as Ta,m as Z,K as Le,I as Ia,q as mt,b as J,$ as q,z as Q,h as ee,c as Ma,t as ya,e as Ue,Y as ut,i as Fa,E as me,f as ue,X as qe,g as Pa}from"./facade-BslPbXnu.js";import{k as uC,n as dC,o as hC,s as gC,Q as SC,A as CC,u as vC,v as pC,w as RC,y as fC,B as _C,J as bC,C as EC,F as TC,G as IC,H as MC,L as yC,M as FC,P as PC,T as NC,S as DC,U as AC,W as xC,Z as OC,_ as kC,a0 as LC,a1 as UC,a2 as wC,a3 as WC,a4 as BC,a5 as jC,a6 as HC,a7 as VC,a8 as $C,a9 as GC,aa as YC,ab as KC,ac as zC,ad as XC,ae as ZC,af as JC,ag as qC,ah as QC,ai as ev,aj as tv,ak as av,al as nv,am as sv,an as ov,ao as rv,ap as iv,aq as lv,ar as cv,as as mv,at as uv,au as dv,av as hv,aw as gv,ax as Sv,ay as Cv,az as vv,aA as pv,aB as Rv,aC as fv,aD as _v,aE as bv,aF as Ev,aG as Tv,aH as Iv,aI as Mv,aJ as yv,aK as Fv,aL as Pv,aM as Nv,aN as Dv,aO as Av,aP as xv,aQ as Ov,aR as kv,aS as Lv,aT as Uv,aU as wv,aV as Wv,aW as Bv,aX as jv,aY as Hv,aZ as Vv,a_ as $v,a$ as Gv,b0 as Yv,b1 as Kv,b2 as zv,b3 as Xv,b4 as Zv,b5 as Jv,b6 as qv,b7 as Qv,b8 as ep,b9 as tp,ba as ap,bb as np,bc as sp,bd as op,be as rp,bf as ip,bg as lp,bh as cp,bi as mp,bj as up,bk as dp,bl as hp,bm as gp,bn as Sp,bo as Cp,bp as vp,bq as pp,br as Rp,bs as fp,bt as _p,bu as bp,bv as Ep,bw as Tp,bx as Ip,by as Mp,bz as yp,bA as Fp,bB as Pp,bC as Np,bD as Dp,bE as Ap,bF as xp,bG as Op,bH as kp,bI as Lp,bJ as Up,bK as wp,bL as Wp,bM as Bp,bN as jp,bO as Hp,bP as Vp,bQ as $p,bR as Gp,bS as Yp,bT as Kp,bU as zp,bV as Xp,bW as Zp,bX as Jp,bY as qp,bZ as Qp,b_ as eR,b$ as tR,c0 as aR,c1 as nR,c2 as sR,c3 as oR,c4 as rR,c5 as iR,c6 as lR,c7 as cR,c8 as mR,c9 as uR,ca as dR,cb as hR,cc as gR,cd as SR,ce as CR,cf as vR,cg as pR,ch as RR,ci as fR,cj as _R,ck as bR,cl as ER,cm as TR,cn as IR,co as MR,cp as yR,cq as FR,cr as PR,cs as NR,ct as DR,cu as AR,cv as xR,cw as OR,cx as kR,cy as LR,cz as UR,cA as wR,cB as WR,cC as BR,cD as jR,cE as HR,cF as VR,cG as $R,cH as GR,cI as YR,cJ as KR,cK as zR,cL as XR,cM as ZR,cN as JR,cO as qR,cP as QR,cQ as ef,cR as tf,cS as af,cT as nf,cU as sf,cV as of,cU as rf,cW as lf,cX as cf,cY as mf,cZ as uf,c_ as df,c$ as hf,d0 as gf,d1 as Sf,d2 as Cf,d3 as vf,d4 as pf,d5 as Rf,d6 as ff,d7 as _f,d8 as bf,d9 as Ef,da as Tf,db as If,dc as Mf,dd as yf,de as Ff,df as Pf,dg as Nf,dh as Df,di as Af,dj as xf,dk as Of,dl as kf,dm as Lf,dn as Uf,dp as wf,dq as Wf,dr as Bf,ds as jf,dt as Hf,du as Vf,dv as $f,dw as Gf,dx as Yf,dy as Kf,dz as zf,dA as Xf,dB as Zf,dC as Jf,dD as qf,dE as Qf,dF as e_,dG as t_,dH as a_,dI as n_,dJ as s_,dK as o_,dL as r_,dM as i_,dN as l_,dO as c_,dP as m_,dQ as u_,dR as d_,dS as h_,dT as g_,dU as S_,dV as C_,dW as v_,dX as p_,dY as R_,dZ as f_,d_ as __,d$ as b_,e0 as E_,e1 as T_,e2 as I_,e3 as M_,e4 as y_,e5 as F_,e6 as P_,e7 as N_,e8 as D_,e9 as A_,ea as x_,eb as O_,ec as k_,ed as L_,ee as U_,ef as w_,eg as W_,eh as B_,ei as j_,ej as H_,ek as V_,el as $_,em as G_,en as Y_,eo as K_,ep as z_,eq as X_,er as Z_,es as J_,et as q_,eu as Q_,ev as eb,ew as tb,ex as ab,ey as nb,ez as sb,eA as ob,eB as rb,eC as ib,eD as lb,eE as cb,eF as mb,eG as ub,eH as db,eI as hb,eJ as gb,eK as Sb,eL as Cb,eM as vb,eN as pb,eO as Rb,eP as fb,eQ as _b,eR as bb,eS as Eb,eT as Tb,eU as Ib,eV as Mb,eW as yb,eX as Fb,eY as Pb,eZ as Nb,e_ as Db,e$ as Ab,f0 as xb,f1 as Ob,f2 as kb,f3 as Lb,f4 as Ub,f5 as wb,f6 as Wb,f7 as Bb,f8 as jb,f9 as Hb,fa as Vb,fb as $b,fc as Gb,fd as Yb,fe as Kb,ff as zb,fg as Xb,fh as Zb,fi as Jb,fj as qb,fk as Qb,fl as eE,fm as tE,fn as aE,fo as nE,fp as sE,fq as oE,fr as rE,fs as iE,ft as lE,fu as cE,fv as mE,fw as uE,fx as dE,fy as hE,fz as gE,fA as SE,fB as CE,fC as vE,fD as pE,fE as RE,fF as fE,fG as _E,fH as bE,fI as EE,fJ as TE,fK as IE,fL as ME,fM as yE,fN as FE,fO as PE,fP as NE,fQ as DE,fR as AE,fS as xE,fT as OE,fU as kE,fV as LE,fW as UE,fX as wE,fY as WE,fZ as BE,f_ as jE,f$ as HE,g0 as VE,g1 as $E,g2 as GE,g3 as YE,g4 as KE,g5 as zE,g6 as XE,g7 as ZE,g8 as JE,g9 as qE,ga as QE,gb as eT,gc as tT,gd as aT,ge as nT,gf as sT,gg as oT,gh as rT,gi as iT,gj as lT,gk as cT,gl as mT,gm as uT,gn as dT,go as hT,gp as gT,gq as ST,gr as CT,gs as vT,gt as pT,gu as RT,gv as fT,gw as _T,gx as bT,gy as ET,gz as TT,gA as IT,gB as MT,gC as yT,gD as FT,gE as PT,gF as NT,gG as DT,gH as AT,gI as xT,gJ as OT,gK as kT,gL as LT,gM as UT,gN as wT,gO as WT,gP as BT,gQ as jT,gR as HT,gS as VT,gT as $T,gU as GT,gV as YT,gW as KT,gX as zT,gY as XT,gZ as ZT,g_ as JT,g$ as qT,h0 as QT,h1 as eI,h2 as tI,h3 as aI,h4 as nI,h5 as sI,h6 as oI,h7 as rI,h8 as iI,h9 as lI,ha as cI,hb as mI,hc as uI,hd as dI,he as hI,hf as gI,hg as SI,hh as CI,hi as vI,hj as pI,hk as RI,hl as fI,hm as _I,hn as bI,ho as EI,hp as TI,hq as II,hr as MI,hs as yI,ht as FI,hu as PI,hv as NI,hw as DI,hx as AI,hy as xI,hz as OI,hA as kI,hB as LI,hC as UI,hD as wI,hE as WI,hF as BI,hG as jI,hH as HI,hI as VI,hJ as $I,hK as GI,hL as YI,hM as KI,hN as zI,hO as XI,hP as ZI,hQ as JI,hR as qI,hS as QI,hT as eM,hU as tM,hV as aM,hW as nM,hX as sM,hY as oM,hZ as rM,h_ as iM,h$ as lM,i0 as cM,i1 as mM,i2 as uM,i3 as dM,i4 as hM,i5 as gM,i6 as SM}from"./facade-BslPbXnu.js";import{J as N,V as Te,g as Qe,T as Na,W as Da,f as Aa,K as xa}from"./index-Dd27tKdG.js";import{B as vM,$ as pM,N as RM,v as fM,U as _M,P as bM,a as EM,Y as TM,Z as IM,b as MM,c as yM,O as FM,E as PM,d as NM,L as DM,M as AM,o as xM,j as OM,e as kM,y as LM,h as UM,x as wM,m as WM,i as BM,k as jM,l as HM}from"./index-Dd27tKdG.js";import{H as Oa,s as we,K as dt,V as ht,j as gt,L as St,a as ka,O as se,x as et,D as We,w as La,B as Ua,P as oe,o as te,F as A,c as ve,i as Ct,l as vt,n as wa,A as Wa,b as Ba,d as ja,e as tt,f as pt,Y as Ha}from"./index-DYW2pYtY.js";import{g as $M,h as GM,q as YM}from"./index-DYW2pYtY.js";import{g8 as B,ga as Rt,g5 as Va,c5 as $a,fk as Ga,fA as Ya,g0 as Ka,da as I,aB as de,gb as ft,j as P,L as Be,gc as za,gd as _t,f$ as Ie,ge as Xa,bp as at,g9 as bt,f7 as Et,fa as Tt,es as Za,g3 as Ja,d5 as qa,cl as It,bB as M,bi as he,b6 as x,f5 as ge,bb as Mt,fy as Qa,a3 as en,aw as tn,aC as an,e7 as nn,gf as yt,eV as sn,bm as p,bo as j,b7 as Se,d4 as on,bS as rn,ea as ln,gg as cn,gh as mn,d_ as Ft,bw as un,bc as dn,bx as hn}from"./index-BI8deSNo.js";import{bE as gn,ao as U,bt as b,aK as Pt,ba as ae,aa as Sn,am as Cn,w as re,aj as Nt,ad as je,z as Me,av as ye,a6 as vn,ae as pn,al as pe,b8 as Rn,a7 as fn,aN as _n,a as bn,an as En,aJ as Tn,ap as In,ai as Mn,P as yn}from"./index-BeEHzc6r.js";import{j as zM,O as XM,x as ZM,n as JM,b as qM,K as QM,I as ey,_ as ty,V as ay,l as ny,U as sy,i as oy,c as ry,L as iy,W as ly,d as cy,F as my,k as uy,e as dy,f as hy,g as gy,Y as Sy,Z as Cy,h as vy,C as py,X as Ry,G as fy,m as _y,T as by,v as Ey,o as Ty,q as Iy,t as My,J as yy,p as Fy,r as Py,Q as Ny,s as Dy,u as Ay,A as xy,y as Oy,B as ky,D as Ly,E as Uy,H as wy,M as Wy,N as By,R as jy,S as Hy,$ as Vy,a0 as $y,a1 as Gy,a2 as Yy,a3 as Ky,a4 as zy,a5 as Xy,a8 as Zy,a9 as Jy,ab as qy,ac as Qy,af as eF,ag as tF,ah as aF,ak as nF,aq as sF,ar as oF,as as rF,at as iF,au as lF,aw as cF,ax as mF,ay as uF,az as dF,aA as hF,aB as gF,aC as SF,aD as CF,aE as vF,aF as pF,aG as RF,aH as fF,aI as _F,aL as bF,aM as EF,aO as TF,aP as IF,aQ as MF,aR as yF,aS as FF,aT as PF,aU as NF,aV as DF,aW as AF,aX as xF,aY as OF,X as kF,aZ as LF,a_ as UF,a$ as wF,b0 as WF,b1 as BF,b2 as jF,b3 as HF,b4 as VF,b5 as $F,b6 as GF,b7 as YF,b9 as KF,bb as zF,bc as XF,bd as ZF,be as JF,bf as qF,bg as QF,bh as eP,bi as tP,bj as aP,bk as nP,bl as sP,bm as oP,bn as rP,bo as iP,bp as lP,bq as cP,br as mP,bs as uP,bu as dP,bv as hP,bw as gP,bx as SP,by as CP,bz as vP,bA as pP,bB as RP,bC as fP,bD as _P}from"./index-BeEHzc6r.js";import{aj as v,ak as h,p as He,Z as nt,a4 as Dt,ag as Fn,s as Pn,f as Ve,t as $e,Y as Nn,T as Dn}from"./index-BmfxE5KL.js";import{U as k,P as At,O as Ge,$ as Ye}from"./facade-bHpds0ZF.js";import"./facade-BFb3hZLS.js";import"./takeUntil-BWepI5Pd.js";import"./index-u4QJ_A0o.js";import"./bufferTime-Dc1Jgi3q.js";import"./isObservable-DLg0_x3m.js";import"./shareReplay-DR2HpNHE.js";function An(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t=Sa(t),t.length===1?Rt(t[0]):new B(xn(t))}function xn(t){return function(e){for(var a=[],n=function(o){a.push(Rt(t[o]).subscribe(Va(e,function(r){if(a){for(var i=0;i<a.length;i++)i!==o&&a[i].unsubscribe();a=null}e.next(r)})))},s=0;a&&!e.closed&&s<t.length;s++)n(s)}}var On=Object.defineProperty,kn=(t,e,a)=>e in t?On(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,Fe=(t,e,a)=>kn(t,typeof e!="symbol"?e+"":e,a);const st={};var Ln=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},W=(t,e)=>(a,n)=>e(a,n,t);const Re="SHEET_NUMFMT_ALERT";let Pe=class extends de{constructor(t,e,a,n,s,o,r){super(),this._context=t,this._hoverManagerService=e,this._cellAlertManagerService=a,this._localeService=n,this._zenZoneService=s,this._numfmtService=o,this._configService=r,this._init()}_init(){this._initCellAlertPopup(),this._initZenService()}_initCellAlertPopup(){this.disposeWithMe(this._hoverManagerService.currentCell$.pipe(bt(100)).subscribe(t=>{var e,a;if(t){const n=t.location,s=this._context.unit,o=s.getActiveSheet();if(!o)return this._hideAlert();const r=n.unitId,i=n.subUnitId;let m;const l=o.getCell(n.row,n.col);if(l!=null&&l.s){const u=s.getStyles().get(l.s);u!=null&&u.n&&(m=u.n)}if(m||(m=this._numfmtService.getValue(r,i,n.row,n.col)),!m){this._hideAlert();return}if(Tt(m.pattern)&&qa.isDefine(l?.v)&&Et(l.v)){if((e=this._configService.getConfig(ka))!=null&&e.disableTextFormatAlert)return;const u=this._cellAlertManagerService.currentAlert.get(Re),d=(a=u?.alert)==null?void 0:a.location;if(d&&d.row===n.row&&d.col===n.col&&d.subUnitId===n.subUnitId&&d.unitId===n.unitId){this._hideAlert();return}this._cellAlertManagerService.showAlert({type:Ta.ERROR,title:this._localeService.t("info.error"),message:this._localeService.t("info.forceStringInfo"),location:n,width:200,height:74,key:Re});return}}this._hideAlert()}))}_initZenService(){this.disposeWithMe(this._zenZoneService.visible$.subscribe(t=>{t&&this._hideAlert()}))}_hideAlert(){this._cellAlertManagerService.removeAlert(Re)}};Pe=Ln([W(1,p(Ma)),W(2,p(ya)),W(3,p(M)),W(4,Cn),W(5,p(Ue)),W(6,Se)],Pe);const fe={id:"sheet.operation.close.numfmt.panel",type:Be.OPERATION,handler:()=>!0},G={id:"sheet.operation.open.numfmt.panel",type:Be.OPERATION,handler:t=>(t.get(K).openPanel(),!0)};var Un=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},wn=(t,e)=>(a,n)=>e(a,n,t);const Ke=v.createContext([]);let Y=class{constructor(t){this._localStorageService=t}_getKey(t){return`userHabitController_${t}`}async addHabit(t,e){const a=this._getKey(t);return this._localStorageService.getItem(a).then(n=>{n||this._localStorageService.setItem(a,e)})}markHabit(t,e){const a=this._getKey(t);this._localStorageService.getItem(a).then(n=>{if(n){const s=n.findIndex(o=>o===e);s>-1&&n.splice(s,1),n.unshift(e),this._localStorageService.setItem(a,n)}})}async getHabit(t,e){const a=this._getKey(t),n=await this._localStorageService.getItem(a);if(e&&n){const s=n.map((o,r,i)=>{const m=i.length;return{value:o,priority:m-r}});return e.sort((o,r)=>{var i,m;const l=((i=s.find(u=>u.value===o))==null?void 0:i.priority)||-1;return(((m=s.find(u=>u.value===r))==null?void 0:m.priority)||-1)-l})}return n||[]}deleteHabit(t){this._localStorageService.removeItem(t)}};Y=Un([wn(0,p(Mt))],Y);const ot="numfmtCurrency",Wn=t=>{const e=b(Y),[a,n]=v.useState(tt);return v.useEffect(()=>{e.addHabit("numfmtCurrency",[]).then(()=>{e.getHabit(ot,[...tt]).then(s=>{n(s),t&&t(s)})})},[]),{userHabitCurrency:a,mark:s=>{e.markHabit(ot,s)}}},Bn=()=>{const t=v.useRef([]),[e,a]=v.useState({});return v.useEffect(()=>{t.current.forEach(n=>{n()}),t.current=[]},[e]),n=>{t.current.push(n),a({})}},jn=t=>!!te(t)&&t.startsWith("_("),Hn=t=>{const{defaultPattern:e,action:a,onChange:n}=t,[s,o]=v.useState(()=>oe(e||"",2)),r=v.useContext(Ke),[i,m]=v.useState(()=>te(e)||r[0]),l=v.useMemo(()=>r.map(g=>({label:g,value:g})),[]),u=b(M).t;a.current=()=>A(`_("${i}"* #,##0${s>0?".0":""}_)`,s);const d=g=>{m(g),n(A(`_("${g}"* #,##0${s>0?".0":""}_)`,s))},C=g=>{const c=g||0;o(c),n(A(`_("${i}"* #,##0${c>0?".0":""}_)`,c))};return h.jsxs("div",{children:[h.jsxs("div",{className:"univer-mt-4 univer-flex univer-justify-between",children:[h.jsxs("div",{className:"option",children:[h.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:u("sheet.numfmt.decimalLength")}),h.jsx("div",{className:"univer-mt-2 univer-w-32",children:h.jsx(Ve,{value:s,step:1,precision:0,max:20,min:0,onChange:C})})]}),h.jsxs("div",{className:"option",children:[h.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:u("sheet.numfmt.currencyType")}),h.jsx("div",{className:"univer-mt-2 univer-w-36",children:h.jsx(He,{options:l,value:i,onChange:d})})]})]}),h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:u("sheet.numfmt.accountingDes")})]})},Vn=t=>!!te(t)&&!t.startsWith("_("),$n=t=>{const e=b(M).t,a=v.useContext(Ke),[n,s]=v.useState(()=>te(t.defaultPattern)||a[0]),[o,r]=v.useState(()=>oe(t.defaultPattern||"",2)),[i,m]=v.useState(()=>{var c;const S=ve(n);return((c=S.find(f=>ge(f.value,t.defaultPattern)))==null?void 0:c.value)||S[0].value}),l=v.useMemo(()=>ve(n),[n]),u=v.useMemo(()=>a.map(c=>({label:c,value:c})),[a]);t.action.current=()=>A(i,o);const d=c=>{if(c===void 0)return;s(c);const S=ve(c)[0].value;m(S),t.onChange(A(S,o))},C=c=>{c!==void 0&&(m(c),t.onChange(A(c,o)))},g=c=>{r(c||0),t.onChange(A(i,c||0))};return h.jsxs("div",{children:[h.jsxs("div",{className:"univer-mt-4 univer-flex univer-justify-between",children:[h.jsxs("div",{className:"option",children:[h.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:e("sheet.numfmt.decimalLength")}),h.jsx("div",{className:"univer-mt-2 univer-w-32",children:h.jsx(Ve,{value:o,max:20,min:0,onChange:g})})]}),h.jsxs("div",{className:"option",children:[h.jsx("div",{className:"univer-text-sm univer-text-gray-400",children:e("sheet.numfmt.currencyType")}),h.jsx("div",{className:"univer-mt-2 univer-w-36",children:h.jsx(He,{value:n,options:u,onChange:d})})]})]}),h.jsx("div",{className:"label univer-mt-4",children:e("sheet.numfmt.negType")}),h.jsx("div",{className:"univer-mt-2",children:h.jsx($e,{value:i,options:l,onChange:C})}),h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:e("sheet.numfmt.currencyDes")})]})};function xt({ref:t,...e}){const{icon:a,id:n,className:s,extend:o,...r}=e,i=`univerjs-icon univerjs-icon-${n} ${s||""}`.trim(),m=v.useRef(`_${Kn()}`);return Ot(a,`${n}`,{defIds:a.defIds,idSuffix:m.current},{ref:t,className:i,...r},o)}function Ot(t,e,a,n,s){return v.createElement(t.tag,{key:e,...Gn(t,a,s),...n},(Yn(t,a).children||[]).map((o,r)=>Ot(o,`${e}-${t.tag}-${r}`,a,void 0,s)))}function Gn(t,e,a){const n={...t.attrs};a!=null&&a.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=a.colorChannel1),t.tag==="mask"&&n.id&&(n.id=n.id+e.idSuffix),Object.entries(n).forEach(([o,r])=>{o==="mask"&&typeof r=="string"&&(n[o]=r.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))});const{defIds:s}=e;return!s||s.length===0||(t.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+e.idSuffix),Object.entries(n).forEach(([o,r])=>{typeof r=="string"&&(n[o]=r.replace(/url\(#(.*)\)/,`url(#$1${e.idSuffix})`))})),n}function Yn(t,e){var a;const{defIds:n}=e;return!n||n.length===0?t:t.tag==="defs"&&(a=t.children)!=null&&a.length?{...t,children:t.children.map(s=>typeof s.attrs.id=="string"&&n&&n.includes(s.attrs.id)?{...s,attrs:{...s.attrs,id:s.attrs.id+e.idSuffix}}:s)}:t}function Kn(){return Math.random().toString(36).substring(2,8)}xt.displayName="UniverIcon";const zn={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.1544 3.75557C14.3887 3.98988 14.3887 4.36978 14.1544 4.6041L6.51409 12.2444C6.40157 12.3569 6.24896 12.4201 6.08983 12.4201C5.9307 12.4201 5.77808 12.3569 5.66556 12.2444L1.84541 8.42425C1.6111 8.18993 1.6111 7.81003 1.84541 7.57572C2.07973 7.34141 2.45963 7.34141 2.69394 7.57572L6.08983 10.9716L13.3059 3.75557C13.5402 3.52126 13.9201 3.52126 14.1544 3.75557Z",fillRule:"evenodd",clipRule:"evenodd"}}]},kt=v.forwardRef(function(t,e){return v.createElement(xt,Object.assign({},t,{id:"check-mark-icon",ref:e,icon:zn}))});kt.displayName="CheckMarkIcon";const _e="customFormat",be="numfmt_custom_pattern";function Xn(t){const{defaultPattern:e,action:a,onChange:n}=t,s=b(Y),o=b(Mt),r=b(M),[i,m]=v.useState(e);a.current=()=>(s.markHabit(_e,i),o.getItem(be).then((g=[])=>{const c=[...new Set([i,...g||[]])].splice(0,10).filter(S=>!!S);o.setItem(be,c)}),i);const[l,u]=v.useState([]);v.useEffect(()=>{o.getItem(be).then(g=>{const c=[...Wa.map(S=>S.suffix("$")),...Ba.map(S=>S.suffix),...ja.map(S=>S.suffix)];c.push(...g||[]),s.addHabit(_e,[]).finally(()=>{s.getHabit(_e,c).then(S=>{u([...new Set(S)])})})})},[]);const d=g=>{m(g),n(g)},C=()=>{n(i)};return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:r.t("sheet.numfmt.customFormat")}),h.jsx(Nn,{placeholder:r.t("sheet.numfmt.customFormat"),onBlur:C,value:i,onChange:m,className:"univer-mt-2 univer-w-full"}),h.jsx("div",{className:Dt("univer-mt-2 univer-max-h-[400px] univer-overflow-auto univer-rounded-lg univer-p-2",Dn),children:l.map(g=>h.jsxs("div",{onClick:()=>d(g),className:"univer-flex univer-cursor-pointer univer-items-center univer-gap-1.5 univer-py-1.5 univer-text-sm",children:[h.jsx("div",{className:"univer-flex univer-w-4 univer-items-center univer-text-primary-600",children:i===g&&h.jsx(kt,{})}),h.jsx("div",{children:g})]},g))}),h.jsx("div",{className:"univer-mt-3 univer-text-sm univer-text-gray-600 dark:!univer-text-gray-200",children:r.t("sheet.numfmt.customFormatDes")})]})}const Zn=t=>{const e=Qa.getFormatInfo(t);return Ct().map(a=>a.value).includes(t)||["date","datetime","time"].includes(e.type)};function Jn(t){const{onChange:e,defaultPattern:a}=t,n=v.useMemo(Ct,[]),s=b(M),[o,r]=v.useState(()=>{if(a){const m=n.find(l=>l.value===a);if(m)return m.value}return n[0].value});t.action.current=()=>o;const i=m=>{m!==void 0&&(r(m),e(m))};return h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:s.t("sheet.numfmt.dateType")}),h.jsx("div",{className:"univer-mt-2",children:h.jsx($e,{value:o,options:n,onChange:i})}),h.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:s.t("sheet.numfmt.dateDes")})]})}const qn=t=>!t,Qn=t=>{const e=b(M).t;return t.action.current=()=>"",h.jsx("div",{children:h.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:e("sheet.numfmt.generalDes")})})},es=t=>vt().some(e=>ge(e.value,t));function ts(t){const e=b(M),a=v.useMemo(vt,[]),[n,s]=v.useState(()=>oe(t.defaultPattern||"",0)),[o,r]=v.useState(()=>{const d=a.find(C=>ge(C.value,t.defaultPattern||""));return d?.value||a[0].value}),i=v.useMemo(()=>A(o,Number(n||0)),[o,n]),m=v.useMemo(()=>!wa(o),[o]),l=d=>{s(d||0),t.onChange(A(o,Number(d||0)))},u=d=>{d!==void 0&&(s(oe(d,0)),r(d),t.onChange(d))};return t.action.current=()=>i,h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:e.t("sheet.numfmt.decimalLength")}),h.jsx("div",{className:"univer-mt-2",children:h.jsx(Ve,{disabled:m,value:n,max:20,min:0,onChange:l})}),h.jsxs("div",{className:"univer-mt-4 univer-text-sm univer-text-gray-400",children:[" ",e.t("sheet.numfmt.negType")]}),h.jsx("div",{className:"univer-mt-2",children:h.jsx($e,{onChange:u,options:a,value:o})}),h.jsx("div",{className:"univer-mt-3.5 univer-text-sm/5 univer-text-gray-600 dark:!univer-text-gray-200",children:e.t("sheet.numfmt.thousandthPercentileDes")})]})}const as=t=>{const{defaultValue:e,defaultPattern:a,row:n,col:s}=t.value,o=b(M),r=v.useRef(()=>""),i=o.t,m=Bn(),l=v.useMemo(()=>[{label:"sheet.numfmt.general",component:Qn},{label:"sheet.numfmt.accounting",component:Hn},{label:"sheet.numfmt.currency",component:$n},{label:"sheet.numfmt.date",component:Jn},{label:"sheet.numfmt.thousandthPercentile",component:ts},{label:"sheet.numfmt.customFormat",component:Xn}].map(_=>({..._,label:i(_.label)})),[]),[u,d]=v.useState(R),[C,g]=v.useState(()=>`${n}_${s}`),{mark:c,userHabitCurrency:S}=Wn(()=>g(`${n}_${s}_userCurrency'`)),f=v.useMemo(()=>{var _;return(_=l.find(w=>w.label===u))==null?void 0:_.component},[u]);function R(){return[qn,jn,Vn,Zn,es].reduce((_,w,Vt)=>_||(w(a)?l[Vt].label:""),"")||l[0].label}const E=l.map(_=>({label:_.label,value:_.label})),T=_=>{d(_),m(()=>t.onChange({type:"change",value:r.current()||""}))},F=v.useCallback(_=>{t.onChange({type:"change",value:_})},[]),O=()=>{const _=r.current()||"",w=te(_);w&&c(w),t.onChange({type:"confirm",value:_})},Ce=()=>{t.onChange({type:"cancel",value:""})},Ht={onChange:F,defaultValue:e,defaultPattern:a,action:r};return v.useEffect(()=>{d(R()),g(`${n}_${s}`)},[n,s]),h.jsxs("div",{className:Dt("univer-flex univer-h-full univer-flex-col univer-justify-between univer-overflow-y-auto univer-pb-5",Fn),children:[h.jsxs("div",{children:[h.jsx("div",{className:"univer-mt-3.5 univer-text-sm univer-text-gray-400",children:i("sheet.numfmt.numfmtType")}),h.jsx("div",{className:"univer-mt-2",children:h.jsx(He,{className:"univer-w-full",value:u,options:E,onChange:T})}),h.jsx("div",{children:f&&h.jsx(Ke.Provider,{value:S,children:v.createElement(f,{...Ht,key:C})})})]}),h.jsxs("div",{className:"univer-mb-5 univer-mt-3.5 univer-flex univer-justify-end",children:[h.jsx(nt,{onClick:Ce,className:"univer-mr-3",children:i("sheet.numfmt.cancel")}),h.jsx(nt,{variant:"primary",onClick:O,children:i("sheet.numfmt.confirm")})]})]})};var ns=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},y=(t,e)=>(a,n)=>e(a,n,t);const rt="SHEET_NUMFMT_PANEL";let K=class extends de{constructor(t,e,a,n,s,o,r,i,m,l,u){super(),Fe(this,"_previewPattern",""),Fe(this,"_sidebarDisposable",null),this._sheetInterceptorService=t,this._themeService=e,this._univerInstanceService=a,this._commandService=n,this._selectionManagerService=s,this._renderManagerService=o,this._numfmtService=r,this._componentManager=i,this._sidebarService=m,this._localeService=l,this._sheetsNumfmtCellContentController=u,this._initRealTimeRenderingInterceptor(),this._initPanel(),this._initCommands(),this._initCloseListener(),this._commandExecutedListener(),this._initNumfmtLocalChange()}_initNumfmtLocalChange(){this.disposeWithMe(ft(this._sheetsNumfmtCellContentController.locale$,this._localeService.currentLocale$).subscribe(()=>{this._forceUpdate()}))}openPanel(){var t;const e=this._sidebarService,a=this._selectionManagerService,n=this._commandService,s=this._univerInstanceService,o=this._numfmtService,r=this._localeService,i=(((t=a.getCurrentSelections())==null?void 0:t.map(S=>S.range))||[])[0];if(!i)return!1;const m=s.getCurrentUnitForType(I.UNIVER_SHEET),l=m.getActiveSheet();if(!l)return!1;const u=l.getCellRaw(i.startRow,i.startColumn),d=o.getValue(m.getUnitId(),l.getSheetId(),i.startRow,i.startColumn);let C="";d&&(C=d.pattern);const g=u?.t===P.NUMBER?u.v:12345678,c={onChange:S=>{var f;if(S.type==="change")this._previewPattern=S.value,this._forceUpdate();else if(S.type==="confirm"){const R=((f=a.getCurrentSelections())==null?void 0:f.map(F=>F.range))||[],E={values:[]},T=we(S.value);R.forEach(F=>{It.foreach(F,(O,Ce)=>{E.values.push({row:O,col:Ce,pattern:S.value,type:T})})}),n.executeCommand(se.id,E),e.close()}else S.type==="cancel"&&e.close()},value:{defaultPattern:C,defaultValue:g,row:i.startRow,col:i.startColumn}};return this._sidebarDisposable=e.open({header:{title:r.t("sheet.numfmt.title")},children:{label:rt,...c},onClose:()=>{this._forceUpdate(),n.executeCommand(fe.id)}}),!0}_forceUpdate(t){var e;const a=this._renderManagerService.getRenderById(t??this._univerInstanceService.getCurrentUnitForType(I.UNIVER_SHEET).getUnitId());a?.with(Ca).reCalculate(),(e=a?.mainComponent)==null||e.makeDirty()}_initCommands(){[G,fe].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))})}_initPanel(){this.disposeWithMe(this._componentManager.register(rt,as))}_initRealTimeRenderingInterceptor(){const t=new B(a=>{this._commandService.onCommandExecuted(n=>{n.id===G.id&&a.next(!0),n.id===fe.id&&a.next(!1)})}),e=za([t,this._selectionManagerService.selectionMoveEnd$.pipe(_t(a=>a?a.map(n=>n.range):[]))]);this.disposeWithMe(Ie(e.pipe(gn(([a,n])=>new B(s=>{const o=new an;return a&&n.length&&s.next({selectionRanges:n,disposableCollection:o}),()=>{o.dispose()}})),Xa(()=>{this._previewPattern=null})).subscribe(({disposableCollection:a,selectionRanges:n})=>{var s,o;const r=this._univerInstanceService.getCurrentUnitForType(I.UNIVER_SHEET);this.openPanel(),a.add(this._sheetInterceptorService.intercept(va.CELL_CONTENT,{priority:99,effect:at.Value|at.Style,handler:(i,m,l)=>{var u;const{row:d,col:C}=m,g=l(i)||{};if(n.find(c=>c.startColumn<=C&&c.endColumn>=C&&c.startRow<=d&&c.endRow>=d)){const c=m.worksheet.getCellRaw(d,C),S=c?.v,f=c?.t;if(S==null||f!==P.NUMBER||this._previewPattern===null)return g;const R=Oa(this._previewPattern,S,this._sheetsNumfmtCellContentController.locale);if(R.color){const E=(u=this._themeService.getColorFromTheme(`${R.color}.500`))!=null?u:R.color;return{...g,v:R.result,t:P.STRING,s:{cl:{rgb:E}}}}return{...g,v:R.result,t:P.STRING}}return g}})),(o=(s=this._renderManagerService.getRenderById(r.getUnitId()))==null?void 0:s.mainComponent)==null||o.makeDirty()})))}_commandExecutedListener(){const t=[Oe.id,ke.id];this.disposeWithMe(new B(e=>{const a=this._commandService.onCommandExecuted(n=>{if(t.includes(n.id)){const s=n.params;e.next(s.unitId)}});return()=>a.dispose()}).pipe(bt(16)).subscribe(e=>this._forceUpdate(e)))}_initCloseListener(){this._univerInstanceService.getCurrentTypeOfUnit$(I.UNIVER_SHEET).subscribe(t=>{var e;t||((e=this._sidebarDisposable)==null||e.dispose(),this._sidebarDisposable=null)})}};K=ns([y(0,p(ut)),y(1,p(on)),y(2,he),y(3,x),y(4,p(Le)),y(5,ce),y(6,Ue),y(7,p(re)),y(8,Nt),y(9,p(M)),y(10,p(We))],K);var ss=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},H=(t,e)=>(a,n)=>e(a,n,t);const os=()=>{let t=[];return{add:(e,a,n,s,o)=>t.push({unitId:e,subUnitId:a,row:n,col:s,value:o}),getEffects:()=>t,clean:()=>{t=[]}}};let ie=class extends de{constructor(t,e,a,n,s){super(),Fe(this,"_collectEffectMutation",os()),this._sheetInterceptorService=t,this._numfmtService=e,this._univerInstanceService=a,this._injector=n,this._editorBridgeService=s,this._initInterceptorEditorStart(),this._initInterceptorEditorEnd(),this._initInterceptorCommands()}_initInterceptorEditorStart(){this._editorBridgeService&&this.disposeWithMe(Ie(this._sheetInterceptorService.writeCellInterceptor.intercept(pa,{handler:(t,e,a)=>{const n=e.row,s=e.col,o=this._numfmtService.getValue(e.unitId,e.subUnitId,n,s);if(o)switch(we(o.pattern)){case"scientific":case"currency":case"grouped":case"number":{const r=e.worksheet.getCellRaw(n,s);return r?.t===P.NUMBER&&r?.v!==void 0&&r.v!==null&&Et(r.v)&&(r.v=Yt(Number(r.v))),a&&a(r)}default:return a&&a(t)}return a(t)}})))}_initInterceptorEditorEnd(){this.disposeWithMe(Ie(this._sheetInterceptorService.writeCellInterceptor.intercept(Ra,{handler:(t,e,a)=>{var n,s,o;if(!(t!=null&&t.v)&&!(t!=null&&t.p))return a(t);this._collectEffectMutation.clean();const r=this._numfmtService.getValue(e.unitId,e.subUnitId,e.row,e.col),i=e.worksheet.getCellRaw(e.row,e.col);if(Tt(r?.pattern)||t.t===P.FORCE_STRING)return a(t);const m=(n=t.p)==null?void 0:n.body,l=(o=(s=t?.p)==null?void 0:s.body)!=null&&o.dataStream?t.p.body.dataStream.replace(/\r\n$/,""):String(t.v),u=Za(l);if(m)if(rs(m)){const{dataStream:d}=m,C=d.replace(/\r\n$/,""),g=Number(C);if(Number.isNaN(g)&&!u)return a(t)}else return a(t);if(u){if(!u.z&&!(r!=null&&r.pattern)&&i?.t!==P.STRING&&i?.t!==P.FORCE_STRING&&Ja(l))return a({...t,p:void 0,v:l,t:P.FORCE_STRING});u.z&&this._collectEffectMutation.add(e.unitId,e.subUnitId,e.row,e.col,{pattern:u.z});const d=Number(u.v);return a({...t,p:void 0,v:d,t:P.NUMBER})}return a(t)}})))}_initInterceptorCommands(){const t=this;this.disposeWithMe(this._sheetInterceptorService.interceptCommand({getMutations(e){var a;switch(e.id){case fa.id:{const n=t._univerInstanceService.getCurrentUnitForType(I.UNIVER_SHEET),s=n.getUnitId(),o=(a=n.getActiveSheet())==null?void 0:a.getSheetId();if(!o)return{redos:[],undos:[]};const r=t._collectEffectMutation.getEffects();if(t._collectEffectMutation.clean(),!r.length)return{redos:[],undos:[]};const i=r.filter(d=>{var C;return!!((C=d.value)!=null&&C.pattern)}).map(d=>({row:d.row,col:d.col,pattern:d.value.pattern})),m=r.filter(d=>{var C;return!((C=d.value)!=null&&C.pattern)}).map(d=>({startRow:d.row,endColumn:d.col,startColumn:d.col,endRow:d.row})),l=[],u=[];if(i.length){const d={id:ke.id,params:_a(s,o,i)};l.push(d),u.push(...ba(t._injector,d.params))}if(m.length){const d={id:Oe.id,params:{unitId:s,subUnitId:o,ranges:m}};l.push(d),u.push(...Ea(t._injector,d.params))}return{redos:l,undos:u.reverse()}}}return{redos:[],undos:[]}}}))}dispose(){super.dispose(),this._collectEffectMutation.clean()}};ie=ss([H(0,p(ut)),H(1,p(Ue)),H(2,p(he)),H(3,p(j)),H(4,rn(Fa))],ie);function rs(t){const{textRuns:e=[],paragraphs:a=[],customRanges:n,customBlocks:s=[]}=t,o=["va"];return!(e.some(r=>!!(r.ts&&Object.keys(r.ts).some(i=>o.includes(i))))||a.some(r=>r.bullet)||a.length>=2||n!=null&&n.length||s.length>0)}const Lt=t=>[{label:"sheet.numfmt.general",pattern:null},{label:"sheet.numfmt.text",pattern:en},"|",{label:"sheet.numfmt.number",pattern:"0"},{label:"sheet.numfmt.percent",pattern:"0.00%"},{label:"sheet.numfmt.scientific",pattern:"0.00E+00"},"|",{label:"sheet.numfmt.accounting",pattern:`"${t}" #,##0.00_);[Red]("${t}"#,##0.00)`},{label:"sheet.numfmt.financialValue",pattern:"#,##0.00;[Red]#,##0.00"},{label:"sheet.numfmt.currency",pattern:`"${t}"#,##0.00_);[Red]("${t}"#,##0.00)`},{label:"sheet.numfmt.roundingCurrency",pattern:`"${t}"#,##0;[Red]"${t}"#,##0`},"|",{label:"sheet.numfmt.date",pattern:"yyyy-mm-dd;@"},{label:"sheet.numfmt.time",pattern:'am/pm h":"mm":"ss'},{label:"sheet.numfmt.dateTime",pattern:"yyyy-m-d am/pm h:mm"},{label:"sheet.numfmt.timeDuration",pattern:"h:mm:ss"},"|",{label:"sheet.numfmt.moreFmt",pattern:""}],is=t=>({icon:new B(e=>{const a=t.get(M);return e.next(et(a.getCurrentLocale()).icon),a.localeChanged$.subscribe(()=>{e.next(et(a.getCurrentLocale()).icon)})}),id:gt.id,title:"sheet.numfmt.currency",tooltip:"sheet.numfmt.currency",type:U.BUTTON,hidden$:ae(t,I.UNIVER_SHEET),disabled$:Z(t,{workbookTypes:[q],worksheetTypes:[Q,ee],rangeTypes:[J]})}),ls=t=>({icon:"AddDigitsIcon",id:ht.id,title:"sheet.numfmt.addDecimal",tooltip:"sheet.numfmt.addDecimal",type:U.BUTTON,hidden$:ae(t,I.UNIVER_SHEET),disabled$:Z(t,{workbookTypes:[q],worksheetTypes:[Q,ee],rangeTypes:[J]})}),cs=t=>({icon:"ReduceDigitsIcon",id:dt.id,title:"sheet.numfmt.subtractDecimal",tooltip:"sheet.numfmt.subtractDecimal",type:U.BUTTON,hidden$:ae(t,I.UNIVER_SHEET),disabled$:Z(t,{workbookTypes:[q],worksheetTypes:[Q,ee],rangeTypes:[J]})}),ms=t=>({icon:"PercentIcon",id:St.id,title:"sheet.numfmt.percent",tooltip:"sheet.numfmt.percent",type:U.BUTTON,hidden$:ae(t,I.UNIVER_SHEET),disabled$:Z(t,{workbookTypes:[q],worksheetTypes:[Q,ee],rangeTypes:[J]})}),us=t=>{const e=t.get(he),a=t.get(x),n=t.get(M),s=t.get(Le),o=[Oe.id,ke.id],r=Ia(e,"",({workbook:i,worksheet:m})=>new B(l=>ft(s.selectionMoveEnd$,nn(a.onCommandExecuted.bind(a)).pipe(yt(([u])=>o.includes(u.id)))).subscribe(()=>{var u,d;const C=s.getCurrentSelections();if(C&&C[0]){const g=C[0].range,c=g.startRow,S=g.startColumn,f=(d=i.getStyles().get((u=m.getCell(c,S))==null?void 0:u.s))==null?void 0:d.n,R=f?.pattern,E=Ha(n.getCurrentLocale());let T=n.t("sheet.numfmt.general");if(sn(R)){l.next(T);return}if(R){const F=Lt(E).filter(O=>typeof O=="object"&&O.pattern).find(O=>ge(R,O.pattern));F&&typeof F=="object"&&F.pattern?T=n.t(F.label):T=n.t("sheet.numfmt.moreFmt")}l.next(T)}})));return{label:Ut,id:G.id,tooltip:"sheet.numfmt.title",type:U.SELECTOR,slot:!0,selections:[{label:{name:wt,hoverable:!1,selectable:!1}}],value$:r,hidden$:ae(t,I.UNIVER_SHEET),disabled$:Z(t,{workbookTypes:[q],worksheetTypes:[ee,Q],rangeTypes:[J]})}},Ut="sheet.numfmt.moreNumfmtType",wt="sheet.numfmt.moreNumfmtType.options";function ds(t){const{value:e}=t,a=b(M),n=e??a.t("sheet.numfmt.general");return h.jsx("span",{className:"univer-text-sm",children:n})}function hs(){const t=b(x),e=b(M),a=b(Sn),n=b(We),s=b(Le),o=l=>{const u=s.getCurrentLastSelection();if(!u)return;const d=u.range,C=[];It.foreach(d,(g,c)=>{l?C.push({row:g,col:c,pattern:l,type:we(l)}):C.push({row:g,col:c})}),t.executeCommand(se.id,{values:C}),a.focus()},r=v.useMemo(()=>{const l=La.get(e.getCurrentLocale());return Lt(l)},[e]),i=l=>{if(l===0)o(null);else if(l===r.length-1)t.executeCommand(G.id),a.focus();else{const u=r[l];u.pattern&&o(u.pattern)}},m=1220;return h.jsx("div",{className:"univer-grid univer-gap-1 univer-p-1.5",children:r.map((l,u)=>l==="|"?h.jsx(Pn,{},u):h.jsxs("div",{className:"univer-flex univer-h-7 univer-cursor-default univer-items-center univer-justify-between univer-gap-6 univer-rounded univer-px-2 univer-text-sm hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-700",onClick:()=>i(u),children:[h.jsx("span",{children:e.t(l.label)}),h.jsx("span",{className:"univer-text-xs univer-text-gray-500 dark:!univer-text-gray-400",children:l.pattern?Ua(l.pattern||"",m,n.locale).result.trim():""})]},u))})}const gs={[Pt.LAYOUT]:{[G.id]:{order:9,menuItemFactory:us},[St.id]:{order:9.1,menuItemFactory:ms},[gt.id]:{order:9.2,menuItemFactory:is},[ht.id]:{order:9.3,menuItemFactory:ls},[dt.id]:{order:9.4,menuItemFactory:cs}}};var Ss=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},it=(t,e)=>(a,n)=>e(a,n,t);let le=class extends de{constructor(t,e){super(),this._componentManager=t,this._menuManagerService=e,this._initMenu()}_initMenu(){this._menuManagerService.mergeMenu(gs),[[Ut,ds],[wt,hs]].forEach(([t,e])=>{this.disposeWithMe(this._componentManager.register(t,e))})}};le=Ss([it(0,p(re)),it(1,je)],le);var Cs=Object.defineProperty,vs=(t,e,a)=>e in t?Cs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,ps=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},Ee=(t,e)=>(a,n)=>e(a,n,t),Wt=(t,e,a)=>vs(t,typeof e!="symbol"?e+"":e,a);const Rs="SHEET_NUMFMT_UI_PLUGIN";let z=class extends $a{constructor(e=st,a,n,s){super(),this._config=e,this._injector=a,this._configService=n,this._renderManagerService=s;const{menu:o,...r}=Ga({},st,this._config);o&&this._configService.setConfig("menu",o,{merge:!0}),this._configService.setConfig("sheets-numfmt-ui.config",r)}onStarting(){Ya(this._injector,[[K],[ie],[Y],[le]])}onRendered(){this._registerRenderModules(),Ka(this._injector,[[K],[ie],[le]])}_registerRenderModules(){[[Pe]].forEach(e=>{this.disposeWithMe(this._renderManagerService.registerRenderModule(I.UNIVER_SHEET,e))})}};Wt(z,"pluginName",Rs);Wt(z,"type",I.UNIVER_SHEET);z=ps([tn(mt,pt),Ee(1,p(j)),Ee(2,Se),Ee(3,ce)],z);var fs=Object.defineProperty,_s=(t,e,a)=>e in t?fs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,D=(t,e,a)=>_s(t,typeof e!="symbol"?e+"":e,a),Bt=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},$=(t,e)=>(a,n)=>e(a,n,t);class jt extends Ye{appendTo(e){const a=typeof e=="string"?e.split("|"):e,n=a.length,s={};let o=s;const r=this.__getSchema();a.forEach((i,m)=>{m===n-1?o[i]=r:o[i]={},o=o[i]}),this._menuManagerService.mergeMenu(s)}}var V;let Ne=(V=class extends jt{constructor(t,e,a,n){super(),D(this,"_commandToRegister",new Map),D(this,"_buildingSchema"),this._item=t,this._injector=e,this._commandService=a,this._menuManagerService=n;const s=typeof t.action=="string"?t.action:ln(12);s!==t.action&&this._commandToRegister.set(s,t.action),this._buildingSchema={menuItemFactory:()=>({id:t.id,type:U.BUTTON,icon:t.icon,title:t.title,tooltip:t.tooltip,commandId:s})},typeof t.order<"u"&&(this._buildingSchema.order=t.order)}__getSchema(){return this._commandToRegister.forEach((t,e)=>{this._commandService.hasCommand(e)||this._commandService.registerCommand({id:e,type:Be.COMMAND,handler:t})}),{[this._item.id]:this._buildingSchema}}},D(V,"RibbonStartGroup",Pt),D(V,"RibbonPosition",Tn),D(V,"MenuManagerPosition",In),V);Ne=Bt([$(1,p(j)),$(2,x),$(3,je)],Ne);let De=class extends jt{constructor(e,a,n){super(),D(this,"_menuByGroups",[]),D(this,"_submenus",[]),D(this,"_buildingSchema"),this._item=e,this._injector=a,this._menuManagerService=n,this._buildingSchema={menuItemFactory:()=>({id:e.id,type:U.SUBITEMS,icon:e.icon,title:e.title,tooltip:e.tooltip})},typeof e.order<"u"&&(this._buildingSchema.order=e.order)}addSubmenu(e){return this._submenus.push(e),this}addSeparator(){return this._menuByGroups.push(this._submenus),this._submenus=[],this}__getSchema(){const e={};return this.addSeparator(),this._menuByGroups.forEach((a,n)=>{const s={};a.forEach(o=>{Object.assign(s,o.__getSchema())}),e[`${this._item.id}-group-${n}`]=s}),{[this._item.id]:Object.assign(this._buildingSchema,e)}}};De=Bt([$(1,p(j)),$(2,je)],De);var bs=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},ne=(t,e)=>(a,n)=>e(a,n,t);let Ae=class extends Ye{constructor(e,a,n,s){super(),D(this,"_forceDisableDisposable",null),this._injector=e,this._renderManagerService=a,this._univerInstanceService=n,this._shortcutService=s}enableShortcut(){var e;return(e=this._forceDisableDisposable)==null||e.dispose(),this._forceDisableDisposable=null,this}disableShortcut(){return this._forceDisableDisposable||(this._forceDisableDisposable=this._shortcutService.forceDisable()),this}triggerShortcut(e){const a=this._univerInstanceService.getCurrentUnitForType(I.UNIVER_SHEET);if(!a)return;const n=this._renderManagerService.getRenderById(a.getUnitId());return n?(n.engine.getCanvasElement().dispatchEvent(e),this._shortcutService.dispatch(e)):void 0}dispatchShortcutEvent(e){return this._shortcutService.dispatch(e)}};Ae=bs([ne(0,p(j)),ne(1,p(ce)),ne(2,he),ne(3,Mn)],Ae);class Es extends k{getURL(){return new URL(window.location.href)}getShortcut(){return this._injector.createInstance(Ae)}copy(){return this._commandService.executeCommand(Me.id)}paste(){return this._commandService.executeCommand(ye.id)}createMenu(e){return this._injector.createInstance(Ne,e)}createSubmenu(e){return this._injector.createInstance(De,e)}openSiderbar(e){return this._injector.get(Nt).open(e)}openSidebar(e){return this.openSiderbar(e)}openDialog(e){const a=this._injector.get(vn).open({...e,onClose:()=>{a.dispose()}});return a}getComponentManager(){return this._injector.get(re)}showMessage(e){return this._injector.get(pn).show(e),this}setUIVisible(e,a){return this._injector.get(pe).setUIVisible(e,a),this}isUIVisible(e){return this._injector.get(pe).isUIVisible(e)}registerUIPart(e,a){return this._injector.get(pe).registerComponent(e,()=>Rn(a,this._injector))}registerComponent(e,a,n){const s=this._injector.get(re);return this.disposeWithMe(s.register(e,a,n))}setCurrent(e){if(!this._injector.get(ce).getRenderById(e))throw new Error("Unit not found");this._univerInstanceService.setCurrentUnitForType(e)}addFonts(e){const a=this._injector.get(fn);e.forEach(n=>{a.addFont(n)})}}k.extend(Es);class Ts extends At{onBeforeCopy(e){return this._injector.get(x).beforeCommandExecuted(a=>{a.id===Me.id&&e()})}onCopy(e){return this._injector.get(x).onCommandExecuted(a=>{a.id===Me.id&&e()})}onBeforePaste(e){return this._injector.get(x).beforeCommandExecuted(a=>{a.id===ye.id&&e()})}onPaste(e){return this._injector.get(x).onCommandExecuted(a=>{(a.id===ye.id||a.id===_n)&&e()})}}At.extend(Ts);class Is extends Ge{get BuiltInUIPart(){return bn}get KeyCode(){return En}}Ge.extend(Is);var Ms=(t,e,a,n)=>{for(var s=e,o=t.length-1,r;o>=0;o--)(r=t[o])&&(s=r(s)||s);return s},L=(t,e)=>(a,n)=>e(a,n,t);let X=class extends Ye{constructor(t,e,a,n,s,o,r){super(),this._commandService=t,this._injector=e,this._lexerTreeBuilder=a,this._configService=n,this._functionService=s,this._definedNamesService=o,this._superTableService=r,this._initialize()}_initialize(){}get lexerTreeBuilder(){return this._lexerTreeBuilder}moveFormulaRefOffset(t,e,a,n){return this._lexerTreeBuilder.moveFormulaRefOffset(t,e,a,n)}sequenceNodesBuilder(t){return this._lexerTreeBuilder.sequenceNodesBuilder(t)||[]}executeCalculation(){this._commandService.executeCommand(xe.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})}stopCalculation(){this._commandService.executeCommand(Kt.id,{})}calculationStart(t){return this._commandService.onCommandExecuted(e=>{if(e.id===zt.id){const a=e.params;t(a.forceCalculation)}})}calculationEnd(t){return this._commandService.onCommandExecuted(e=>{if(e.id!==ze.id)return;const a=e.params;a.functionsExecutedState!==void 0&&t(a.functionsExecutedState)})}whenComputingCompleteAsync(t){const e=this._injector.get(Xt);return e.computingStatus?Promise.resolve(!0):cn(An(e.computingStatus$.pipe(yt(a=>a)),mn(t??3e4).pipe(_t(()=>!1))))}onCalculationEnd(){return new Promise((t,e)=>{const a=setTimeout(()=>{e(new Error("Calculation end timeout"))},3e4),n=this.calculationEnd(()=>{clearTimeout(a),n.dispose(),t()})})}calculationProcessing(t){return this._commandService.onCommandExecuted(e=>{if(e.id!==ze.id)return;const a=e.params;a.stageInfo!==void 0&&t(a.stageInfo)})}setMaxIteration(t){this._configService.setConfig(Zt,t)}executeFormulas(t,e=3e4){return new Promise((a,n)=>{const s=this._commandService.onCommandExecuted(r=>{if(r.id!==Jt.id)return;const i=r.params;clearTimeout(o),s.dispose(),i.result!=null?a(i.result):n(new Error("Formula batch calculation returned no result"))}),o=setTimeout(()=>{s.dispose(),n(new Error("Formula batch calculation timeout"))},e);this._commandService.executeCommand(qt.id,{formulas:t},{onlyLocal:!0})})}getAllDependencyTrees(t=3e4){return new Promise((e,a)=>{const n=this._commandService.onCommandExecuted(o=>{if(o.id!==Qt.id)return;const r=o.params;clearTimeout(s),n.dispose(),r.result!=null?e(r.result):e([])}),s=setTimeout(()=>{n.dispose(),a(new Error("Formula dependency calculation timeout"))},t);this._commandService.executeCommand(ea.id,void 0,{onlyLocal:!0})})}getCellDependencyTree(t,e=3e4){return new Promise((a,n)=>{const s=this._commandService.onCommandExecuted(r=>{if(r.id!==ta.id)return;const i=r.params;clearTimeout(o),s.dispose(),a(i.result)}),o=setTimeout(()=>{s.dispose(),n(new Error("Cell dependency calculation timeout"))},e);this._commandService.executeCommand(aa.id,t,{onlyLocal:!0})})}getRangeDependents(t,e=3e4){return new Promise((a,n)=>{const s=this._commandService.onCommandExecuted(r=>{if(r.id!==Xe.id)return;const i=r.params;clearTimeout(o),s.dispose(),i.result!=null?a(i.result):a([])}),o=setTimeout(()=>{s.dispose(),n(new Error("Range dependents calculation timeout"))},e);this._commandService.executeCommand(Ze.id,{unitRanges:t},{onlyLocal:!0})})}getInRangeFormulas(t,e=3e4){return new Promise((a,n)=>{const s=this._commandService.onCommandExecuted(r=>{if(r.id!==Xe.id)return;const i=r.params;clearTimeout(o),s.dispose(),i.result!=null?a(i.result):a([])}),o=setTimeout(()=>{s.dispose(),n(new Error("In-range formulas calculation timeout"))},e);this._commandService.executeCommand(Ze.id,{unitRanges:t,isInRange:!0},{onlyLocal:!0})})}setFormulaReturnDependencyTree(t){this._configService.setConfig(na,t)}getFormulaExpressTree(t,e){return this._lexerTreeBuilder.getFormulaExprTree(t,e,this._functionService.hasExecutor.bind(this._functionService),this._definedNamesService.getValueByName.bind(this._definedNamesService),this._superTableService.getTable.bind(this._superTableService))}getRangeDependentsAndInRangeFormulas(t,e=3e4){return new Promise((a,n)=>{const s=this._commandService.onCommandExecuted(r=>{if(r.id!==sa.id)return;const i=r.params;clearTimeout(o),s.dispose(),i.result!=null?a(i.result):a({dependents:[],inRanges:[]})}),o=setTimeout(()=>{s.dispose(),n(new Error("Range dependents calculation timeout"))},e);this._commandService.executeCommand(oa.id,{unitRanges:t},{onlyLocal:!0})})}};X=Ms([L(0,p(x)),L(1,p(j)),L(2,p(ra)),L(3,Se),L(4,ia),L(5,la),L(6,ca)],X);let ys=class extends k{getFormula(){return this._injector.createInstance(X)}};k.extend(ys);class Fs extends k{_initialize(){this._debouncedFormulaCalculation=Ft(()=>{this._commandService.executeCommand(xe.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})},10)}registerFunction(e){let a=this._injector.get(N);a||(this._injector.add([N,{useClass:Te}]),a=this._injector.get(N));const n=a.registerFunctions(e);return this._debouncedFormulaCalculation(),n}}k.extend(Fs);class Ps extends X{_initialize(){this._debouncedFormulaCalculation=Ft(()=>{this._commandService.executeCommand(xe.id,{commands:[],forceCalculation:!0},{onlyLocal:!0})},10)}setInitialFormulaComputing(e){const a=this._injector.get(un).stage,n=this._injector.get(dn),s=this._injector.get(Se);a>hn.Starting&&n.warn("[FFormula]","CalculationMode is called after the Starting lifecycle and will take effect the next time the Univer Sheet is constructed. If you want it to take effect when the Univer Sheet is initialized this time, consider calling it before the Ready lifecycle or using configuration.");const o=s.getConfig(Qe);if(!o){s.setConfig(Qe,{initialFormulaComputing:e});return}o.initialFormulaComputing=e}registerFunction(e,a,n){var s;let o=this._injector.get(N);o||(this._injector.add([N,{useClass:Te}]),o=this._injector.get(N));const r={name:e,func:a,description:typeof n=="string"?n:(s=n?.description)!=null?s:"",locales:typeof n=="object"?n.locales:void 0},i=o.registerFunction(r);return this._debouncedFormulaCalculation(),i}registerAsyncFunction(e,a,n){var s;let o=this._injector.get(N);o||(this._injector.add([N,{useClass:Te}]),o=this._injector.get(N));const r={name:e,func:a,description:typeof n=="string"?n:(s=n?.description)!=null?s:"",locales:typeof n=="object"?n.locales:void 0},i=o.registerAsyncFunction(r);return this._debouncedFormulaCalculation(),i}calculationResultApplied(e){let a=!1,n=!1,s=null;return this._commandService.onCommandExecuted((o,r)=>{o.id!==Je.id&&o.id!==qe.id||(o.id===Je.id&&(a=!0,s=o.params),o.id===qe.id&&r!=null&&r.applyFormulaCalculationResult&&(n=!0),!(!a||!n)&&requestIdleCallback(()=>{e(s)}))})}onCalculationResultApplied(){return new Promise((e,a)=>{let n=!1,s=!1;const o=setTimeout(()=>{l(),a(new Error("Calculation end timeout"))},6e4),r=setTimeout(()=>{n||(l(),e())},500),i=this.calculationProcessing(u=>{const{stage:d,totalArrayFormulasToCalculate:C,totalFormulasToCalculate:g}=u;if(d===ma.START_CALCULATION&&C+g===0){l(),e();return}n||(n=!0,clearTimeout(r))}),m=this.calculationResultApplied(()=>{s||(s=!0,l(),e())});function l(){clearTimeout(o),clearTimeout(r),i.dispose(),m.dispose()}})}}X.extend(Ps);class Ns{get CalculationMode(){return Na}}Ge.extend(Ns);class Ds extends me{getAllFormulaError(){const e=[],a=this._workbook,n=a.getUnitId(),s=a.getSheets(),o=this._injector.get(lt).getArrayFormulaCellData();return s.forEach(r=>{var i;const m=r.getName(),l=r.getSheetId(),u=r.getCellMatrix(),d=((i=o?.[n])==null?void 0:i[l])||{};u.forValue((C,g,c)=>{var S;if(!c)return;const f=(S=d?.[C])==null?void 0:S[g],R=ct(c,!!f);R&&e.push({sheetName:m,row:C,column:g,formula:c.f||"",errorType:R})})}),e}}me.extend(Ds);class As extends ue{getFormulaError(){var e,a;const n=[],s=this._workbook.getUnitId(),o=this._worksheet.getSheetId(),r=this._worksheet.getName(),i=this._workbook.getSheetBySheetId(o);if(!i)return n;const m=this._injector.get(lt).getArrayFormulaCellData(),l=((e=m?.[s])==null?void 0:e[o])||{},u=i.getCellMatrix(),{startRow:d,endRow:C,startColumn:g,endColumn:c}=this._range;for(let S=d;S<=C;S++)for(let f=g;f<=c;f++){const R=u.getValue(S,f);if(!R)continue;const E=(a=l?.[S])==null?void 0:a[f],T=ct(R,!!E);T&&n.push({sheetName:r,row:S,column:f,formula:R.f||"",errorType:T})}return n}}ue.extend(As);class xs extends ue{setNumberFormat(e){const a=[],{startColumn:n,startRow:s,endColumn:o,endRow:r}=this._range;for(let i=s;i<=r;i++)for(let m=n;m<=o;m++)a.push({row:i,col:m,pattern:e});return this._commandService.syncExecuteCommand(se.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:a}),this}setNumberFormats(e){var a;const n=[],{startColumn:s,startRow:o,endColumn:r,endRow:i}=this._range;for(let m=o;m<=i;m++)for(let l=s;l<=r;l++){const u=(a=e[m-o])==null?void 0:a[l-s];n.push({row:m,col:l,pattern:u})}return this._commandService.syncExecuteCommand(se.id,{unitId:this._workbook.getUnitId(),subUnitId:this._worksheet.getSheetId(),values:n}),this}getNumberFormat(){var e,a;const n=this.getCellStyle();return(a=(e=n?.numberFormat)==null?void 0:e.pattern)!=null?a:""}getNumberFormats(){return this.getCellStyles().map(e=>e.map(a=>{var n,s;return(s=(n=a?.numberFormat)==null?void 0:n.pattern)!=null?s:""}))}}ue.extend(xs);class Os extends me{setNumfmtLocal(e){return this._injector.get(We).setNumfmtLocal(e),this}}me.extend(Os);class ks extends k{showRangeSelectorDialog(e){return this._injector.get(Da).showRangeSelectorDialog(e)}}k.extend(ks);function so(t={}){var e;const{container:a="app",workerURL:n,header:s,footer:o,toolbar:r,ribbonType:i,formulaBar:m,menu:l,contextMenu:u,disableAutoFocus:d,customFontFamily:C,docs:g,sheets:c,formula:S,disableTextFormatAlert:f,disableTextFormatMark:R}=t,E=!!n;return{plugins:[ga,[$t,{hasScroll:g?.hasScroll}],ha,[yn,{container:a,header:s,toolbar:r,ribbonType:i,menu:l,contextMenu:u,disableAutoFocus:d,customFontFamily:C}],Gt,E?[ua,{workerURL:n}]:null,[da,{notExecuteFormula:E,function:S?.function}],[Pa,{notExecuteFormula:E,onlyRegisterFormulaRelatedMutations:!1,isRowStylePrecedeColumnStyle:c?.isRowStylePrecedeColumnStyle,autoHeightForMergedCells:c?.autoHeightForMergedCells,freezeSync:c?.freezeSync}],[mt,{formulaBar:m,footer:o,maxAutoHeightCount:c?.maxAutoHeightCount,clipboardConfig:c?.clipboardConfig,scrollConfig:c?.scrollConfig,protectedRangeShadow:(e=c?.protectedRangeShadow)!=null?e:!0,protectedRangeUserSelector:c?.protectedRangeUserSelector,disableForceStringAlert:c?.disableForceStringAlert,disableForceStringMark:c?.disableForceStringMark}],[pt,{disableTextFormatAlert:f,disableTextFormatMark:R}],z,[Aa,{notExecuteFormula:E,description:S?.description,initialFormulaComputing:S?.initialFormulaComputing}],[xa,{functionScreenTips:S?.functionScreenTips}]].filter(T=>!!T)}}export{uC as AFFECT_LAYOUT_STYLES,Ra as AFTER_CELL_EDIT,dC as AUTO_FILL_APPLY_TYPE,hC as AUTO_FILL_DATA_TYPE,gC as AUTO_FILL_HOOK_TYPE,tl as ActiveDirtyManagerService,ht as AddDecimalCommand,SC as AddMergeRedoSelectionsOperationFactory,CC as AddMergeUndoMutationFactory,vC as AddMergeUndoSelectionsOperationFactory,pC as AddRangeProtectionCommand,RC as AddRangeProtectionFromContextMenuCommand,fC as AddRangeProtectionFromSheetBarCommand,_C as AddRangeProtectionFromToolbarCommand,bC as AddRangeProtectionMutation,EC as AddRangeThemeMutation,TC as AddWorksheetMergeAllCommand,IC as AddWorksheetMergeCommand,MC as AddWorksheetMergeHorizontalCommand,yC as AddWorksheetMergeMutation,FC as AddWorksheetMergeVerticalCommand,PC as AddWorksheetProtectionCommand,NC as AddWorksheetProtectionMutation,fo as AfterSpaceCommand,_o as AlignCenterCommand,bo as AlignJustifyCommand,Eo as AlignLeftCommand,To as AlignOperationCommand,Io as AlignRightCommand,DC as AppendRowCommand,AC as ApplyFormatPainterCommand,al as ArrayValueObject,nl as AstRootNodeFactory,sl as AstTreeBuilder,ol as AsyncArrayObject,rl as AsyncCustomFunction,il as AsyncObject,YS as AuthInterceptorFactory,xC as AutoClearContentCommand,OC as AutoFillCommand,kC as AutoFillController,LC as AutoFillRules,UC as AutoFillService,wC as AutoFillTools,WC as AutoFillUIController,BC as AutoHeightController,jC as AutoWidthController,Ru as BASE_OBJECT_ARRAY,pa as BEFORE_CELL_EDIT,fu as BG_Z_INDEX,_u as BORDER_TYPE,bu as BORDER_Z_INDEX,Eu as Background,ll as BaseFunction,Tu as BaseObject,cl as BaseReferenceObject,HC as BaseSelectionRenderService,ml as BaseValueObject,ul as BooleanValue,dl as BooleanValueObject,Iu as Border,VC as BorderStyleManagerService,Mo as BreakLineCommand,Mu as BreakType,zM as BrowserClipboardService,bn as BuiltInUIPart,yo as BulletListCommand,yu as CHECK_OBJECT_ARRAY,Fu as CIRCLE_OBJECT_ARRAY,Pu as COLOR_BLACK_RGB,XM as COLOR_PICKER_COMPONENT,$C as COMMAND_LISTENER_SKELETON_CHANGE,GC as COMMAND_LISTENER_VALUE_CHANGE,ZM as COMMON_LABEL_COMPONENT,YC as COPY_SPECIAL_MENU_ID,KC as COPY_TYPE,Wa as CURRENCYFORMAT,Nu as CURSOR_TYPE,hl as CalculateController,gl as CalculateFormulaService,Na as CalculationMode,zC as CancelFrozenCommand,XC as CancelMarkDirtyRowAutoHeightMutation,Du as Canvas,Au as CanvasColorService,JM as CanvasFloatDomService,qM as CanvasPopup,QM as CanvasPopupService,xu as CanvasRenderMode,ya as CellAlertManagerService,Ta as CellAlertType,ZC as CellCustomRenderController,JC as CellEditorManagerService,qC as CellPopupManagerService,Fo as ChangeListNestingLevelCommand,Po as ChangeListNestingLevelType,No as ChangeListTypeCommand,QC as ChangeSheetProtectionFromSheetBarCommand,ev as ChangeZoomRatioCommand,Sl as ChannelClient,Cl as ChannelServer,vl as ChannelService,Do as CheckListCommand,Ou as CheckboxShape,ku as Circle,tv as ClearSelectionAllCommand,av as ClearSelectionContentCommand,nv as ClearSelectionFormatCommand,Lu as ColumnHeaderLayout,ey as CommonLabel,ty as ComponentContainer,Uu as ComponentExtension,re as ComponentManager,ay as ContextMenu,ny as ContextMenuGroup,sy as ContextMenuPosition,oy as ContextMenuService,wu as Control,Me as CopyCommand,sv as CopySheetCommand,ry as CopyShortcutItem,ov as CopyWorksheetEndMutation,Ao as CoverContentCommand,xo as CreateDocTableCommand,Wu as Custom,pl as CustomFunction,iy as CustomLabel,Bu as CustomObject,ly as CutCommand,Oo as CutContentCommand,cy as CutShortcutItem,Ba as DATEFMTLISG,ju as DEFAULT_DOCUMENT_FONTSIZE,Hu as DEFAULT_FONTFACE_PLANE,Vu as DEFAULT_FRAME_LIST_SIZE,$u as DEFAULT_FRAME_SAMPLE_SIZE,Rl as DEFAULT_INTERVAL_COUNT,Gu as DEFAULT_MEASURE_TEXT,Yu as DEFAULT_OFFSET_SPACING,Ku as DEFAULT_PADDING_DATA,zu as DEFAULT_SKELETON_FOOTER,Xu as DEFAULT_SKELETON_HEADER,fl as DEFAULT_TOKEN_LAMBDA_FUNCTION_NAME,_l as DEFAULT_TOKEN_LET_FUNCTION_NAME,bl as DEFAULT_TOKEN_TYPE_LAMBDA_PARAMETER,El as DEFAULT_TOKEN_TYPE_PARAMETER,Tl as DEFAULT_TOKEN_TYPE_ROOT,my as DISABLE_AUTO_FOCUS_KEY,rv as DISABLE_NORMAL_SELECTIONS,ko as DOCS_COMPONENT_BACKGROUND_LAYER_INDEX,Lo as DOCS_COMPONENT_DEFAULT_Z_INDEX,Uo as DOCS_COMPONENT_HEADER_LAYER_INDEX,wo as DOCS_COMPONENT_MAIN_LAYER_INDEX,Wo as DOCS_VIEW_KEY,Zu as DOCUMENT_CONTEXT_CLIP_TYPE,io as DOC_INTERCEPTOR_POINT,Bo as DOC_UI_PLUGIN_NAME,jo as DOC_VERTICAL_PADDING,Ju as DRAWING_OBJECT_LAYER_INDEX,qu as DRAWING_OBJECT_LOWER_LAYER_INDEX,Qu as DRAWING_OBJECT_UPPER_LAYER_INDEX,ed as DashedRect,td as DataStreamTreeNode,Il as DataSyncPrimaryController,Ml as DataSyncReplicaController,Ho as DefaultDocContainerConfig,Vo as DefaultToolbarConfig,iv as DefinedNameDataController,yl as DefinedNamesService,$o as DeleteCommand,Go as DeleteCustomBlockCommand,Yo as DeleteLeftCommand,lv as DeleteRangeMoveLeftCommand,cv as DeleteRangeMoveLeftConfirmCommand,mv as DeleteRangeMoveUpCommand,uv as DeleteRangeMoveUpConfirmCommand,dv as DeleteRangeProtectionCommand,hv as DeleteRangeProtectionFromContextMenuCommand,gv as DeleteRangeProtectionMutation,Ko as DeleteRightCommand,Sv as DeleteWorksheetProtectionCommand,Cv as DeleteWorksheetProtectionFormSheetBarCommand,vv as DeleteWorksheetProtectionMutation,pv as DeleteWorksheetRangeThemeStyleCommand,Rv as DeleteWorksheetRangeThemeStyleMutation,fv as DeleteWorksheetRangeThemeStyleMutationFactory,_v as DeltaColumnWidthCommand,bv as DeltaRowHeightCommand,Fl as DependencyManagerBaseService,Pl as DependencyManagerService,vM as DescriptionService,uy as DesktopBeforeCloseService,dy as DesktopConfirmService,hy as DesktopDialogService,gy as DesktopGalleryService,Sy as DesktopGlobalZoneService,Cy as DesktopLayoutService,vy as DesktopLocalFileService,py as DesktopLocalStorageService,Ry as DesktopMenu,fy as DesktopMessageService,_y as DesktopNotificationService,by as DesktopRibbonService,Ey as DesktopSidebarService,Ty as DesktopUIController,Iy as DesktopZenZoneService,ad as DeviceInputEventType,nd as DeviceType,zo as DocAutoFormatService,Xo as DocBackScrollRenderController,sd as DocBackground,Zo as DocCanvasPopManagerService,Jo as DocCopyCommand,qo as DocCreateTableOperation,Qo as DocCutCommand,er as DocEventManagerService,tr as DocIMEInputManagerService,lo as DocInterceptorService,ar as DocPasteCommand,nr as DocPrintInterceptorService,sr as DocRenderController,or as DocSelectAllCommand,co as DocSelectionManagerService,rr as DocSelectionRenderService,od as DocSimpleSkeleton,mo as DocSkeletonManagerService,ir as DocStateChangeManagerService,uo as DocStateEmitService,lr as DocTableDeleteColumnsCommand,cr as DocTableDeleteRowsCommand,mr as DocTableDeleteTableCommand,ur as DocTableInsertColumnCommand,dr as DocTableInsertColumnLeftCommand,hr as DocTableInsertColumnRightCommand,gr as DocTableInsertRowAboveCommand,Sr as DocTableInsertRowBellowCommand,Cr as DocTableInsertRowCommand,vr as DocTableTabCommand,pr as DocUIController,Rr as DocsRenderService,fr as DocsUIMenuSchema,rd as DocumentEditArea,id as DocumentSkeleton,ld as DocumentSkeletonPageType,cd as DocumentViewModel,md as Documents,ud as DocumentsSpanAndLineExtensionRegistry,Ev as DragManagerService,Tv as DragRenderController,dd as Drawing,hd as DumbCanvasColorService,Iv as EMBEDDING_FORMULA_EDITOR,Mv as EMBEDDING_FORMULA_EDITOR_COMPONENT_KEY,gd as EMOJI_REG,Zt as ENGINE_FORMULA_CYCLE_REFERENCE_COUNT,Nl as ENGINE_FORMULA_PLUGIN_CONFIG_KEY,na as ENGINE_FORMULA_RETURN_DEPENDENCY_TREE,Dl as ERROR_TYPE_SET,Sd as EXPAND_SIZE_FOR_RENDER_OVERFLOW,yv as EditStateEnum,Fv as EditingRenderController,_r as Editor,Pv as EditorBridgeService,br as EditorInsertTextCommandId,Er as EditorService,Nv as EffectRefRangId,Dv as EmptyMutation,Cd as Engine,Tr as EnterCommand,My as ErrorController,Al as ErrorType,xl as ErrorValueObject,vd as EventConstants,Av as ExclusiveRangeService,xv as ExpandSelectionCommand,yy as FILE_PNG_CLIPBOARD_MIME_TYPE,Fy as FILE_SVG_XML_CLIPBOARD_MIME_TYPE,Py as FILE__BMP_CLIPBOARD_MIME_TYPE,Ny as FILE__JPEG_CLIPBOARD_MIME_TYPE,Dy as FILE__WEBP_CLIPBOARD_MIME_TYPE,pd as FIX_ONE_PIXEL_BLUR_OFFSET,Rd as FONT_EXTENSION_Z_INDEX,Ay as FONT_FAMILY_COMPONENT,xy as FONT_FAMILY_ITEM_COMPONENT,Oy as FONT_SIZE_COMPONENT,ky as FONT_SIZE_LIST,pM as FORMULA_PROMPT_ACTIVATED,Ol as FUNCTION_NAMES_ARRAY,kl as FUNCTION_NAMES_COMPATIBILITY,Ll as FUNCTION_NAMES_CUBE,Ul as FUNCTION_NAMES_DATABASE,wl as FUNCTION_NAMES_DATE,Wl as FUNCTION_NAMES_ENGINEERING,Bl as FUNCTION_NAMES_FINANCIAL,jl as FUNCTION_NAMES_INFORMATION,Hl as FUNCTION_NAMES_LOGICAL,Vl as FUNCTION_NAMES_LOOKUP,$l as FUNCTION_NAMES_MATH,Gl as FUNCTION_NAMES_STATISTICAL,Yl as FUNCTION_NAMES_TEXT,Kl as FUNCTION_NAMES_UNIVER,zl as FUNCTION_NAMES_WEB,Ov as FactoryAddRangeProtectionMutation,kv as FactoryDeleteRangeProtectionMutation,Lv as FactorySetRangeProtectionMutation,Xl as FeatureCalculationManagerService,KS as FetchHTTPImplementation,Ly as FloatDom,Uy as FloatDomSingle,fd as Font,_d as FontCache,wy as FontFamily,Wy as FontFamilyItem,By as FontSize,Uv as FormatPainterStatus,wv as FormulaBar,Zl as FormulaCurrentConfigService,lt as FormulaDataModel,Jl as FormulaDependencyGenerator,ql as FormulaDependencyTree,Ql as FormulaDependencyTreeModel,ec as FormulaDependencyTreeType,tc as FormulaDependencyTreeVirtual,RM as FormulaEditor,Wv as FormulaEditorController,ma as FormulaExecuteStageType,ac as FormulaExecutedStateType,fM as FormulaRefRangeService,_M as FormulaReorderController,nc as FormulaResultStatus,sc as FormulaRuntimeService,oc as FunctionNodeFactory,rc as FunctionService,ic as FunctionType,Xt as GlobalComputingStatusService,Da as GlobalRangeSelectorService,jy as GlobalZone,bd as GlyphType,Ed as Group,Hy as HEADING_ITEM_COMPONENT,Vy as HEADING_LIST,$y as HTML_CLIPBOARD_MIME_TYPE,zS as HTTPEventType,XS as HTTPHeaders,ZS as HTTPProgress,JS as HTTPRequest,qS as HTTPResponse,QS as HTTPResponseError,eC as HTTPService,tC as HTTPStatusCode,Bv as HeaderFreezeRenderController,jv as HeaderMoveRenderController,Hv as HeaderResizeRenderController,Gy as HeadingItem,bM as HelpFunctionOperation,Vv as HideColConfirmCommand,$v as HideRowConfirmCommand,Td as HitCanvas,Ir as HorizontalLineCommand,Ma as HoverManagerService,Gv as HoverRenderController,lc as HyperlinkEngineFormulaService,cc as IActiveDirtyManagerService,Yv as IAutoFillService,Yy as IBeforeCloseService,mc as ICalculateFormulaService,Id as ICanvasColorService,Ky as ICanvasPopupService,Kv as ICellEditorManagerService,zy as IClipboardInterfaceService,Xy as IContextMenuService,la as IDefinedNamesService,uc as IDependencyManagerService,EM as IDescriptionService,vn as IDialogService,Mr as IDocClipboardService,Fa as IEditorBridgeService,yr as IEditorService,zv as IExclusiveRangeService,dc as IFeatureCalculationManagerService,fn as IFontService,Xv as IFormatPainterService,hc as IFormulaCurrentConfigService,gc as IFormulaDependencyGenerator,Zv as IFormulaEditorManagerService,Sc as IFormulaRuntimeService,ia as IFunctionService,Zy as IGalleryService,Jy as IGlobalZoneService,aC as IHTTPImplementation,Cc as IHyperlinkEngineFormulaService,Sn as ILayoutService,qy as ILeftSidebarService,Qy as ILocalFileService,Fr as IMEInputCommand,Jv as IMarkSelectionService,je as IMenuManagerService,pn as IMessageService,Md as INITIAL_MATRIX,yd as INITIAL_Path2,va as INTERCEPTOR_POINT,eF as INotificationService,Ue as INumfmtService,vc as IOtherFormulaManagerService,tF as IPlatformService,pc as IRPCChannelService,qv as IRefSelectionsService,N as IRegisterFunctionService,Rc as IRemoteInstanceService,TM as IRemoteRegisterFunctionService,fc as IRemoteSyncService,ce as IRenderManagerService,Fd as IRenderingEngine,aF as IRibbonService,Qv as ISheetCellDropdownManagerService,ep as ISheetClipboardService,_c as ISheetRowFilteredService,tp as ISheetSelectionRenderService,Mn as IShortcutService,Nt as ISidebarService,nC as ISocketService,ap as IStatusBarService,ca as ISuperTableService,nF as IUIController,pe as IUIPartsService,Pd as IWatermarkTypeEnum,Cn as IZenZoneService,Nd as Image,IM as ImageFormulaCellInterceptorController,Pr as InnerPasteCommand,np as InsertColAfterCommand,sp as InsertColBeforeCommand,op as InsertColByRangeCommand,rp as InsertColCommand,ip as InsertColMutation,lp as InsertColMutationUndoFactory,Nr as InsertCommand,Dr as InsertCustomRangeCommand,cp as InsertDefinedNameCommand,MM as InsertFunctionCommand,yM as InsertFunctionOperation,mp as InsertMultiColsLeftCommand,up as InsertMultiColsRightCommand,dp as InsertMultiRowsAboveCommand,hp as InsertMultiRowsAfterCommand,gp as InsertRangeMoveDownCommand,Sp as InsertRangeMoveDownConfirmCommand,Cp as InsertRangeMoveRightCommand,vp as InsertRangeMoveRightConfirmCommand,pp as InsertRowAfterCommand,Rp as InsertRowBeforeCommand,fp as InsertRowByRangeCommand,_p as InsertRowCommand,bp as InsertRowMutation,Ep as InsertRowMutationUndoFactory,Tp as InsertSheetCommand,Ip as InsertSheetMutation,Mp as InsertSheetUndoMutationFactory,yp as InterceptCellContentPriority,bc as Interpreter,Dd as IsSafari,Fp as JumpOver,En as KeyCode,Ad as LINK_VIEW_PORT_TYPE,Ec as LambdaNodeFactory,Tc as LambdaParameterNodeFactory,Ic as LambdaValueObjectObject,xd as Layer,Mc as Lexer,yc as LexerNode,ra as LexerTreeBuilder,Od as LineType,kd as Liquid,Ar as ListOperationCommand,Ld as MAIN_VIEW_PORT_KEY,Ud as MAXIMUM_COL_WIDTH,wd as MAXIMUM_ROW_HEIGHT,Pp as MAX_CELL_PER_SHEET_KEY,Wd as MEASURE_EXTENT,Bd as MEASURE_EXTENT_FOR_PARAGRAPH,Np as MERGE_CELL_INTERCEPTOR_CHECK,jd as MIDDLE_CELL_POS_MAGIC_NUMBER,Hd as MIN_COL_WIDTH,Dp as MarkDirtyRowAutoHeightMutation,Ap as MarkSelectionService,Vd as Marker,U as MenuItemType,In as MenuManagerPosition,sF as MenuManagerService,xp as MergeCellController,sC as MergeInterceptorFactory,xr as MergeTwoParagraphCommand,oF as MetaKeys,rF as MobileContextMenu,Op as MobileSheetBar,iF as MockMessageService,FM as MoreFunctionsOperation,kp as MoveColsCommand,Lp as MoveColsMutation,Up as MoveColsMutationUndoFactory,Or as MoveCursorOperation,wp as MoveRangeCommand,Wp as MoveRangeMutation,Bp as MoveRowsCommand,jp as MoveRowsMutation,Hp as MoveRowsMutationUndoFactory,Vp as MoveSelectionCommand,$p as MoveSelectionEnterAndTabCommand,kr as MoveSelectionOperation,Fc as NEW_EXCEL_FUNCTIONS,Lr as NORMAL_TEXT_SELECTION_PLUGIN_NAME,$d as NORMAL_TEXT_SELECTION_PLUGIN_STYLE,ja as NUMBERFORMAT,Ur as NodePositionConvertToCursor,wr as NodePositionConvertToRectRange,Pc as NullValueObject,Nc as NumberValueObject,Gp as NumfmtService,Dc as OPERATOR_TOKEN_SET,Gd as ORIENTATION_TYPE,Yd as ObjectType,Ac as OperatorNodeFactory,Yp as OperatorType,Wr as OrderListCommand,xc as OtherFormulaBizType,Oc as OtherFormulaManagerService,kc as OtherFormulaMarkDirty,Kp as PASTE_SPECIAL_MENU_ID,Kd as PATH_OBJECT_ARRAY,lF as PLAIN_TEXT_CLIPBOARD_MIME_TYPE,Qe as PLUGIN_CONFIG_KEY_BASE,Lc as PLUGIN_CONFIG_KEY_MAIN_THREAD,Uc as PLUGIN_CONFIG_KEY_WORKER_THREAD,zp as PREDEFINED_HOOK_NAME,Xp as PREDEFINED_HOOK_NAME_COPY,Zp as PREDEFINED_HOOK_NAME_PASTE,zd as PRINTING_BG_Z_INDEX,Xd as PageLayoutType,ye as PasteCommand,Br as PastePluginLark,jr as PastePluginUniver,Hr as PastePluginWord,Zd as Path,Jd as Path2,qd as PerformanceMonitor,Jp as PermissionPointsDefinitions,cF as PlatformService,Qd as PointerInput,wc as PrefixNodeFactory,mF as PrintFloatDomSingle,uF as ProgressBar,Vr as QuickListCommand,PM as QuickSumCommand,qp as RANGE_SELECTOR_COMPONENT_KEY,Qp as RANGE_SELECTOR_SYMBOLS,eh as RECT_OBJECT_ARRAY,eR as REF_SELECTIONS_ENABLED,th as REGULAR_POLYGON_OBJECT_ARRAY,ah as RENDER_CLASS_TYPE,nh as RENDER_RAW_FORMULA_KEY,sh as RICHTEXT_OBJECT_ARRAY,tR as RangeMergeUtil,aR as RangeProtectionCache,nR as RangeProtectionPermissionDeleteProtectionPoint,J as RangeProtectionPermissionEditPoint,sR as RangeProtectionPermissionManageCollaPoint,oR as RangeProtectionPermissionViewPoint,rR as RangeProtectionRefRangeService,iR as RangeProtectionRenderModel,lR as RangeProtectionRuleModel,cR as RangeProtectionService,Wc as RangeReferenceObject,NM as RangeSelector,mR as RangeThemeStyle,oh as Rect,dF as RectPopup,$r as RectRange,hF as RediConsumer,gF as RediContext,SF as RediProvider,CF as RedoShortcutItem,uR as RefRangeService,DM as RefSelectionsRenderService,dR as RefSelectionsService,AM as ReferenceAbsoluteOperation,Bc as ReferenceNodeFactory,hR as RefillCommand,jc as RegisterFunctionMutation,Te as RegisterFunctionService,Hc as RegisterOtherFormulaService,gR as RegisterWorksheetRangeThemeStyleCommand,SR as RegisterWorksheetRangeThemeStyleMutation,rh as RegularPolygon,Vc as RemoteInstanceServiceName,xM as RemoteRegisterFunctionService,$c as RemoteSyncPrimaryService,Gc as RemoteSyncServiceName,CR as RemoveColByRangeCommand,vR as RemoveColCommand,pR as RemoveColConfirmCommand,RR as RemoveColMutation,fR as RemoveDefinedNameCommand,Yc as RemoveDefinedNameMutation,Kc as RemoveFeatureCalculationMutation,_R as RemoveMergeUndoMutationFactory,Oe as RemoveNumfmtMutation,zc as RemoveOtherFormulaMutation,bR as RemoveRangeThemeMutation,ER as RemoveRowByRangeCommand,TR as RemoveRowCommand,IR as RemoveRowConfirmCommand,MR as RemoveRowMutation,yR as RemoveSheetCommand,FR as RemoveSheetConfirmCommand,PR as RemoveSheetMutation,NR as RemoveSheetUndoMutationFactory,Xc as RemoveSuperTableMutation,DR as RemoveWorksheetMergeCommand,AR as RemoveWorksheetMergeMutation,xR as RenameSheetOperation,ih as RenderComponent,lh as RenderManagerService,OR as RenderSheetContent,kR as RenderSheetFooter,LR as RenderSheetHeader,ch as RenderUnit,UR as ReorderRangeCommand,wR as ReorderRangeMutation,WR as ReorderRangeUndoMutationFactory,Gr as ReplaceContentCommand,Yr as ReplaceSelectionCommand,Kr as ReplaceSnapshotCommand,zr as ReplaceTextRunsCommand,BR as ResetBackgroundColorCommand,Xr as ResetInlineFormatTextBackgroundColorCommand,jR as ResetRangeTextColorCommand,HR as ResetScrollCommand,VR as ResetTextColorCommand,oC as ResponseHeader,rC as RetryInterceptorFactory,vF as Ribbon,pF as RibbonDataGroup,RF as RibbonFormulasGroup,fF as RibbonInsertGroup,_F as RibbonOthersGroup,Tn as RibbonPosition,Pt as RibbonStartGroup,bF as RibbonViewGroup,mh as RichText,ho as RichTextEditingMutation,Zr as RichTextEditor,uh as RollingAverage,dh as RowHeaderLayout,$R as SCOPE_WORKBOOK_VALUE_DEFINED_NAME,GR as SELECTIONS_ENABLED,YR as SELECTION_CONTROL_BORDER_BUFFER_COLOR,KR as SELECTION_CONTROL_BORDER_BUFFER_WIDTH,zR as SELECTION_SHAPE_DEPTH,hh as SHAPE_OBJECT_ARRAY,gh as SHAPE_TYPE,ka as SHEETS_NUMFMT_PLUGIN_CONFIG_KEY,XR as SHEETS_PLUGIN_CONFIG_KEY,Sh as SHEET_EXTENSION_PREFIX,Ch as SHEET_EXTENSION_TYPE,ZR as SHEET_UI_PLUGIN_NAME,vh as SHEET_VIEWPORT_KEY,JR as SHEET_VIEW_KEY,ph as SLIDE_NAVIGATION_KEY,Zc as SUFFIX_TOKEN_SET,Rh as Scene,fh as SceneCanvas,_h as SceneViewer,bh as ScrollBar,qR as ScrollCommand,Eh as ScrollTimer,Th as ScrollTimerType,QR as ScrollToCellCommand,ef as ScrollToCellOperation,tf as ScrollToRangeOperation,OM as SearchFunctionOperation,af as SelectAllCommand,kM as SelectEditorFormulaOperation,nf as SelectRangeCommand,sf as SelectionControl,of as SelectionMoveType,rf as SelectionShape,lf as SelectionShapeExtension,cf as SetActivateCellEditOperation,Jc as SetArrayFormulaDataMutation,mf as SetBackgroundColorCommand,uf as SetBoldCommand,df as SetBorderBasicCommand,hf as SetBorderColorCommand,gf as SetBorderCommand,Sf as SetBorderPositionCommand,Cf as SetBorderStyleCommand,vf as SetCellEditVisibleArrowOperation,pf as SetCellEditVisibleOperation,Rf as SetCellEditVisibleWithF2Operation,aa as SetCellFormulaDependencyCalculationMutation,ta as SetCellFormulaDependencyCalculationResultMutation,ff as SetColDataCommand,_f as SetColDataMutation,bf as SetColDataMutationFactory,Ef as SetColHiddenCommand,Tf as SetColHiddenMutation,If as SetColVisibleMutation,Mf as SetColWidthCommand,yf as SetColumnFrozenCommand,Ff as SetColumnHeaderHeightCommand,gt as SetCurrencyCommand,Pf as SetDefinedNameCommand,qc as SetDefinedNameMutation,Qc as SetDefinedNameMutationFactory,Jr as SetDocZoomRatioCommand,qr as SetDocZoomRatioOperation,em as SetFeatureCalculationMutation,Nf as SetFirstColumnFrozenCommand,Df as SetFirstRowFrozenCommand,Af as SetFontFamilyCommand,xf as SetFontSizeCommand,Of as SetFormatPainterOperation,ze as SetFormulaCalculationNotificationMutation,Je as SetFormulaCalculationResultMutation,zt as SetFormulaCalculationStartMutation,Kt as SetFormulaCalculationStopMutation,tm as SetFormulaDataMutation,ea as SetFormulaDependencyCalculationMutation,Qt as SetFormulaDependencyCalculationResultMutation,qt as SetFormulaStringBatchCalculationMutation,Jt as SetFormulaStringBatchCalculationResultMutation,kf as SetFrozenCommand,Lf as SetFrozenMutation,Uf as SetFrozenMutationFactory,wf as SetGridlinesColorCommand,Wf as SetGridlinesColorMutation,Bf as SetHorizontalTextAlignCommand,am as SetImageFormulaDataMutation,jf as SetInfiniteFormatPainterCommand,Qr as SetInlineFormatBoldCommand,ei as SetInlineFormatCommand,ti as SetInlineFormatFontFamilyCommand,ai as SetInlineFormatFontSizeCommand,ni as SetInlineFormatItalicCommand,si as SetInlineFormatStrikethroughCommand,oi as SetInlineFormatSubscriptCommand,ri as SetInlineFormatSuperscriptCommand,ii as SetInlineFormatTextBackgroundColorCommand,li as SetInlineFormatTextColorCommand,ci as SetInlineFormatUnderlineCommand,Hf as SetItalicCommand,se as SetNumfmtCommand,ke as SetNumfmtMutation,Vf as SetOnceFormatPainterCommand,nm as SetOtherFormulaMutation,$f as SetOverlineCommand,mi as SetParagraphNamedStyleCommand,St as SetPercentCommand,Gf as SetProtectionCommand,oa as SetQueryFormulaDependencyAllMutation,sa as SetQueryFormulaDependencyAllResultMutation,Ze as SetQueryFormulaDependencyMutation,Xe as SetQueryFormulaDependencyResultMutation,Yf as SetRangeBoldCommand,Kf as SetRangeCustomMetadataCommand,zf as SetRangeFontDecreaseCommand,Xf as SetRangeFontFamilyCommand,Zf as SetRangeFontIncreaseCommand,Jf as SetRangeFontSizeCommand,qf as SetRangeItalicCommand,Qf as SetRangeProtectionFromContextMenuCommand,e_ as SetRangeProtectionMutation,t_ as SetRangeStrickThroughCommand,a_ as SetRangeSubscriptCommand,n_ as SetRangeSuperscriptCommand,s_ as SetRangeTextColorCommand,o_ as SetRangeThemeMutation,r_ as SetRangeUnderlineCommand,fa as SetRangeValuesCommand,qe as SetRangeValuesMutation,i_ as SetRangeValuesUndoMutationFactory,l_ as SetRowDataCommand,c_ as SetRowDataMutation,m_ as SetRowDataMutationFactory,u_ as SetRowFrozenCommand,d_ as SetRowHeaderWidthCommand,h_ as SetRowHeightCommand,g_ as SetRowHiddenCommand,S_ as SetRowHiddenMutation,C_ as SetRowVisibleMutation,v_ as SetScrollOperation,p_ as SetScrollRelativeCommand,R_ as SetSelectedColsVisibleCommand,f_ as SetSelectedRowsVisibleCommand,__ as SetSelectionFrozenCommand,b_ as SetSelectionsOperation,E_ as SetSpecificColsVisibleCommand,T_ as SetSpecificRowsVisibleCommand,I_ as SetStrikeThroughCommand,M_ as SetStyleCommand,sm as SetSuperTableMutation,om as SetSuperTableOptionMutation,y_ as SetTabColorCommand,F_ as SetTabColorMutation,P_ as SetTextColorCommand,N_ as SetTextRotationCommand,go as SetTextSelectionsOperation,D_ as SetTextWrapCommand,xe as SetTriggerFormulaCalculationStartMutation,A_ as SetUnderlineCommand,x_ as SetVerticalTextAlignCommand,O_ as SetWorkbookNameCommand,k_ as SetWorkbookNameMutation,L_ as SetWorksheetActivateCommand,U_ as SetWorksheetActiveOperation,w_ as SetWorksheetColAutoWidthCommand,W_ as SetWorksheetColWidthMutation,B_ as SetWorksheetColWidthMutationFactory,j_ as SetWorksheetColumnCountCommand,H_ as SetWorksheetColumnCountMutation,V_ as SetWorksheetColumnCountUndoMutationFactory,$_ as SetWorksheetDefaultStyleCommand,G_ as SetWorksheetDefaultStyleMutation,Y_ as SetWorksheetDefaultStyleMutationFactory,K_ as SetWorksheetHideCommand,z_ as SetWorksheetHideMutation,X_ as SetWorksheetNameCommand,Z_ as SetWorksheetNameMutation,J_ as SetWorksheetOrderCommand,q_ as SetWorksheetOrderMutation,Q_ as SetWorksheetPermissionPointsCommand,eb as SetWorksheetPermissionPointsMutation,tb as SetWorksheetProtectionCommand,ab as SetWorksheetProtectionMutation,nb as SetWorksheetRangeThemeStyleCommand,sb as SetWorksheetRangeThemeStyleMutation,ob as SetWorksheetRangeThemeStyleMutationFactory,rb as SetWorksheetRightToLeftCommand,ib as SetWorksheetRightToLeftMutation,lb as SetWorksheetRowAutoHeightMutation,cb as SetWorksheetRowAutoHeightMutationFactory,mb as SetWorksheetRowCountCommand,ub as SetWorksheetRowCountMutation,db as SetWorksheetRowCountUndoMutationFactory,hb as SetWorksheetRowHeightMutation,gb as SetWorksheetRowHeightMutationFactory,Sb as SetWorksheetRowIsAutoHeightCommand,Cb as SetWorksheetRowIsAutoHeightMutation,vb as SetWorksheetRowIsAutoHeightMutationFactory,pb as SetWorksheetShowCommand,Rb as SetZoomRatioCommand,fb as SetZoomRatioOperation,Ih as Shape,EF as SharedController,_b as SheetBar,bb as SheetCanvasPopManagerService,Eb as SheetCellDropdownManagerService,Tb as SheetCellEditorResizeService,Ib as SheetClipboardService,Mh as SheetColumnHeaderExtensionRegistry,yh as SheetComponent,Mb as SheetCopyCommand,LM as SheetCopyFormulaOnlyCommand,yb as SheetCutCommand,Fh as SheetExtension,ut as SheetInterceptorService,Fb as SheetLazyExecuteScheduleService,Pb as SheetMenuPosition,UM as SheetOnlyPasteFormulaCommand,Nb as SheetPasteBesidesBorderCommand,Db as SheetPasteColWidthCommand,Ab as SheetPasteCommand,xb as SheetPasteFormatCommand,Ob as SheetPasteShortKeyCommand,_n as SheetPasteShortKeyCommandName,kb as SheetPasteValueCommand,Lb as SheetPermissionCheckController,Ub as SheetPermissionCheckUIController,wb as SheetPermissionInitController,Wb as SheetPermissionOpenDialogOperation,Bb as SheetPermissionOpenPanelOperation,jb as SheetPermissionRenderManagerService,Hb as SheetPermissionUserManagerService,Vb as SheetPrintInterceptorService,$b as SheetRangeThemeModel,Gb as SheetRangeThemeService,Yb as SheetRenderController,rm as SheetRowFilteredService,Ph as SheetRowHeaderExtensionRegistry,Kb as SheetScrollManagerService,zb as SheetSelectionRenderService,Xb as SheetSkeletonChangeType,Ca as SheetSkeletonManagerService,Zb as SheetSkeletonService,Jb as SheetUIController,qb as SheetValueChangeType,Qb as SheetsFreezeSyncController,We as SheetsNumfmtCellContentController,eE as SheetsRenderService,tE as SheetsScrollRenderController,Le as SheetsSelectionsService,aE as SheetsUIMenuSchema,nE as SheetsUIPart,TF as ShortcutPanelController,IF as ShortcutPanelService,MF as ShortcutService,Nh as ShowGridlinesState,sE as ShowMenuListCommand,yF as Sidebar,oE as SidebarDefinedNameOperation,FF as SingleCanvasPopup,PF as SingleUnitUIController,Dh as SkeletonType,Ah as Slide,NF as Slider,rE as SplitDelimiterEnum,iE as SplitTextToColumnsCommand,xh as Spreadsheet,Oh as SpreadsheetColumnHeader,kh as SpreadsheetExtensionRegistry,Lh as SpreadsheetHeader,Uh as SpreadsheetRowHeader,wh as SpreadsheetSkeleton,lE as StatusBarController,cE as StatusBarService,im as StringValueObject,dt as SubtractDecimalCommand,lm as SuffixNodeFactory,cm as SuperTableService,ui as SwitchDocModeCommand,Wh as TEXT_OBJECT_ARRAY,di as TEXT_RANGE_LAYER_INDEX,Bh as TRANSFORM_CHANGE_OBSERVABLE_TYPE,hi as TabCommand,jh as Text,gi as TextRange,mE as TextToNumberCommand,DF as ThemeSwitcherService,iC as ThresholdInterceptorFactory,uE as ToggleCellCheckboxCommand,Si as ToggleCheckListCommand,dE as ToggleGridlinesCommand,hE as ToggleGridlinesMutation,AF as ToggleShortcutPanelOperation,xF as ToolbarButton,OF as ToolbarItem,Hh as Transform,wM as TriggerCalculationController,kF as UIMenu,LF as UIMenuSchema,UF as UIPartsService,wF as UI_PLUGIN_CONFIG_KEY,gE as UNIVER_SHEET_PERMISSION_USER_PART,WF as UNIVER_UI_PLUGIN_NAME,Vh as UNIVER_WATERMARK_LAYER_INDEX,$h as UNIVER_WATERMARK_STORAGE_KEY,BF as UNI_DISABLE_CHANGING_FOCUS_KEY,jF as UndoShortcutItem,mm as UnionNodeFactory,SE as UnitAction,CE as UnitObject,$t as UniverDocsPlugin,Gt as UniverDocsUIPlugin,da as UniverFormulaEnginePlugin,HF as UniverMobileUIPlugin,ga as UniverNetworkPlugin,Gh as UniverPrintingContext,ua as UniverRPCMainThreadPlugin,um as UniverRPCWorkerThreadPlugin,WM as UniverRemoteSheetsFormulaPlugin,ha as UniverRenderEnginePlugin,Yh as UniverRenderingContext,Kh as UniverRenderingContext2D,so as UniverSheetsCorePreset,Aa as UniverSheetsFormulaPlugin,xa as UniverSheetsFormulaUIPlugin,vE as UniverSheetsMobileUIPlugin,pt as UniverSheetsNumfmtPlugin,z as UniverSheetsNumfmtUIPlugin,Pa as UniverSheetsPlugin,mt as UniverSheetsUIPlugin,yn as UniverUIPlugin,pE as UnregisterWorksheetRangeThemeStyleCommand,RE as UnregisterWorksheetRangeThemeStyleMutation,Ci as UpdateCommand,BM as UpdateDefinedNameController,jM as UpdateFormulaController,fE as VALIDATE_CELL,zh as VERTICAL_ROTATE_ANGLE,vi as VIEWPORT_KEY,dm as ValueNodeFactory,hm as ValueObjectFactory,Xh as Vector2,_E as ViewSheetPermissionFromContextMenuCommand,bE as ViewSheetPermissionFromSheetBarCommand,EE as ViewStateEnum,Zh as Viewport,Jh as WatermarkLayer,lC as WebSocketService,gm as WebWorkerRemoteInstanceService,VF as WithDependency,TE as WorkbookCommentPermission,IE as WorkbookCopyPermission,ME as WorkbookCopySheetPermission,yE as WorkbookCreateProtectPermission,FE as WorkbookCreateSheetPermission,PE as WorkbookDeleteColumnPermission,NE as WorkbookDeleteRowPermission,DE as WorkbookDeleteSheetPermission,AE as WorkbookDuplicatePermission,q as WorkbookEditablePermission,xE as WorkbookExportPermission,OE as WorkbookHideSheetPermission,kE as WorkbookHistoryPermission,LE as WorkbookInsertColumnPermission,UE as WorkbookInsertRowPermission,wE as WorkbookManageCollaboratorPermission,WE as WorkbookMoveSheetPermission,BE as WorkbookPermissionService,jE as WorkbookPrintPermission,HE as WorkbookRecoverHistoryPermission,VE as WorkbookRenameSheetPermission,$E as WorkbookSelectionModel,GE as WorkbookSharePermission,YE as WorkbookViewHistoryPermission,KE as WorkbookViewPermission,zE as WorksheetCopyPermission,XE as WorksheetDeleteColumnPermission,ZE as WorksheetDeleteProtectionPermission,JE as WorksheetDeleteRowPermission,qE as WorksheetEditExtraObjectPermission,Q as WorksheetEditPermission,QE as WorksheetFilterPermission,eT as WorksheetInsertColumnPermission,tT as WorksheetInsertHyperlinkPermission,aT as WorksheetInsertRowPermission,nT as WorksheetManageCollaboratorPermission,sT as WorksheetPermissionService,oT as WorksheetPivotTablePermission,rT as WorksheetProtectionPointModel,iT as WorksheetProtectionRuleModel,lT as WorksheetSelectProtectedCellsPermission,cT as WorksheetSelectUnProtectedCellsPermission,ee as WorksheetSetCellStylePermission,mT as WorksheetSetCellValuePermission,uT as WorksheetSetColumnStylePermission,dT as WorksheetSetRowStylePermission,hT as WorksheetSortPermission,gT as WorksheetViewPermission,cC as XHRHTTPImplementation,$F as ZIndexManager,ST as ZebraCrossingCacheController,GF as ZenZone,pi as addCustomDecorationBySelectionFactory,Ri as addCustomDecorationFactory,So as addCustomRangeBySelectionFactory,Co as addCustomRangeFactory,CT as addMergeCellsUtil,vT as adjustRangeOnMutation,pT as alignToMergedCellsBorders,RT as attachPrimaryWithCoord,fT as attachRangeWithCoord,_T as attachSelectionWithCoord,bT as baseProtectionActions,fi as calcDocRangePositions,ET as calculateDocSkeletonRects,HM as calculateFormula,qh as calculateRectRotate,Qh as cancelRequestFrame,TT as checkCellValueType,IT as checkInHeaderRanges,MT as checkRangesEditablePermission,eg as checkStyle,tg as clampRange,ag as clearLineByBorderType,Sm as compareToken,YF as connectDependencies,Rn as connectInjector,_i as convertBodyToHtml,yT as convertPositionCellToSheetOverGrid,FT as convertPositionSheetOverGridToAbsolute,bi as convertPositionsToRectRanges,PT as convertPrimaryWithCoordToPrimary,NT as convertSelectionDataToRange,ng as convertTextRotation,sg as convertTransformToOffsetX,og as convertTransformToOffsetY,Cm as convertUnitDataToRuntime,DT as copyRangeStyles,AT as countCells,rg as createCanvasElement,ig as createImageElement,xT as createTopMatrixFromMatrix,OT as createTopMatrixFromRanges,tt as currencySymbols,kT as defaultLargeSheetOperationConfig,LT as defaultWorkbookPermissionPoints,UT as defaultWorksheetPermissionPoint,lg as degToRad,Ei as deleteCustomDecorationFactory,vo as deleteCustomRangeFactory,Ia as deriveStateFromActiveSheet$,vm as deserializeRangeForR1C1,pm as deserializeRangeWithSheet,Rm as deserializeRangeWithSheetWithCache,wT as discreteRangeToRange,Ti as docDrawingPositionToTransform,cg as drawDiagonalLineByBorderType,mg as drawLineByBorderType,fm as excelDateSerial,ug as expandRangeIfIntersects,WT as expandToContinuousRange,ct as extractFormulaError,Ea as factoryRemoveNumfmtUndoMutation,ba as factorySetNumfmtUndoMutation,BT as findAllRectangle,jT as findFirstNonEmptyCell,dg as fixLineWidthByScale,HT as followSelectionOperation,_m as fromModule,bm as functionArray,Em as functionCompatibility,Tm as functionCube,Im as functionDatabase,Mm as functionDate,VT as functionDisplayNames,ym as functionEngineering,Fm as functionFinancial,Pm as functionInformation,Nm as functionLogical,Dm as functionLookup,Am as functionMath,xm as functionMeta,Om as functionStatistical,km as functionText,Lm as functionUniver,Um as functionWeb,$T as genNormalSelectionStyle,GT as genSelectionByRange,Ii as genTableSource,wm as generateAstNode,Wm as generateExecuteAstNodeData,YT as generateNullCell,KT as generateNullCellValue,Mi as generateParagraphs,Bm as generateRandomDependencyTreeId,hg as generateRandomKey,jm as generateStringWithSequence,Hm as getAbsoluteRefTypeWitString,Vm as getAbsoluteRefTypeWithSingleString,zT as getAddMergeMutationRangeByType,XT as getAllRangePermissionPoint,ZT as getAllSelection,JT as getAllWorkbookPermissionPoint,qT as getAllWorksheetPermissionPoint,QT as getAllWorksheetPermissionPointByPointPanel,yi as getAnchorBounding,Fi as getCanvasOffsetByEngine,eI as getCellAtRowCol,gg as getCellByIndexWithMergeInfo,Sg as getCellPositionByIndex,tI as getCellRealRange,Cg as getCharSpaceApply,aI as getClearContentMutationParamForRange,nI as getClearContentMutationParamsForRanges,vg as getColor,Pi as getCommandSkeleton,sI as getCoordByCell,oI as getCoordByOffset,$M as getCurrencyFormat,ve as getCurrencyFormatOptions,GM as getCurrencyOptions,Ha as getCurrencySymbolByLocale,et as getCurrencySymbolIconByLocale,te as getCurrencyType,rI as getCurrentExclusiveRangeInterest$,Z as getCurrentRangeDisable$,pg as getCurrentScrollXY,Rg as getCurrentTypeOfRenderer,Ni as getCursorWhenDelete,Di as getCustomBlockIdsInSelections,iI as getCustomRangePosition,Ai as getCutActionsFromDocRanges,fg as getDPI,Ct as getDateFormatOptions,oe as getDecimalFromPattern,YM as getDecimalString,lI as getDefaultRangePermission,_g as getDevicePixelRatio,xi as getDocObject,Oi as getDocObjectById,bg as getDocsSkeletonPageSize,cI as getEditingCustomRangePosition,mI as getEditorObject,ki as getEmptyTableCell,Li as getEmptyTableRow,Eg as getFontStyleString,Tg as getGroupState,KF as getHeaderFooterMenuHiddenObservable,uI as getInsertRangeMutations,Ig as getLastColumn,Mg as getLastLine,Ui as getLineBounding,yg as getLineOffset,Fg as getLineWidth,Pg as getLineWith,dI as getMatrixPlainText,ae as getMenuHiddenObservable,hI as getMoveRangeUndoRedoMutations,gI as getNextPrimaryCell,vt as getNumberFormatOptions,Ng as getNumberUnitValue,$m as getObjectValue,SI as getObservableWithExclusiveRange$,Dg as getOffsetRectForDom,wi as getOneTextSelectionRange,Ag as getPageFromPath,xg as getParagraphByGlyph,Ua as getPatternPreview,Oa as getPatternPreviewIgnoreGeneral,we as getPatternType,Og as getPointerPrefix,CI as getPrimaryForRange,Gm as getRangeWithRefsString,vI as getRemoveRangeMutations,pI as getRepeatRange,Wi as getRichTextEditPath,kg as getRotateOffsetAndFarthestHypotenuse,Lg as getRotateOrientation,Ug as getScale,RI as getSelectionsService,fI as getSeparateEffectedRangesOnCommand,_I as getSheetCommandTarget,bI as getSheetCommandTargetWorkbook,EI as getSheetMutationTarget,TI as getSheetObject,wg as getSizeForDom,II as getSkeletonChangedEffectedRange,Wg as getSystemHighlightColor,Bi as getTableColumn,Bg as getTableIdAndSliceIndex,MI as getTopLeftSelectionOfCurrSheet,yI as getTransformCoord,jg as getTranslateInSpreadContextWithPixelRatio,FI as getValueChangedEffectedRange,Hg as getValueType,PI as getViewportByCell,NI as getVisibleRanges,Vg as glyphIterator,zF as handelExcelToJson,XF as handelTableToJson,DI as handleBaseInsertRange,AI as handleBaseMoveRowsCols,xI as handleBaseRemoveRange,OI as handleCommonDefaultRangeChangeWithEffectRefCommands,kI as handleCommonRangeChangeWithEffectRefCommandsSkipNoInterests,LI as handleDefaultRangeChangeWithEffectRefCommands,UI as handleDefaultRangeChangeWithEffectRefCommandsSkipNoInterests,wI as handleDeleteRangeMoveLeft,WI as handleDeleteRangeMoveUp,BI as handleDeleteRangeMutation,ZF as handleDomToJson,jI as handleIRemoveCol,HI as handleIRemoveRow,VI as handleInsertCol,$I as handleInsertRangeMoveDown,GI as handleInsertRangeMoveRight,YI as handleInsertRangeMutation,KI as handleInsertRow,zI as handleMoveCols,XI as handleMoveRange,ZI as handleMoveRows,Ym as handleNumfmtInCell,JF as handlePlainToJson,Km as handleRefStringInfo,qF as handleStringToStyle,QF as handleTableColgroup,eP as handleTableMergeData,tP as handleTableRowGroup,$g as hasAllLatin,Gg as hasArabic,Yg as hasBasicLatin,Kg as hasCJK,zg as hasCJKPunctuation,Xg as hasCJKText,Zg as hasLatinExtendedA,Jg as hasLatinExtendedB,qg as hasLatinOneSupplement,Qg as hasListGlyph,ji as hasParagraphInTable,eS as hasSpace,tS as hasTibetan,aS as hasUnMergedCellInRow,aP as imageMimeTypeSet,nS as inViewRanges,zm as includeFormulaLexerToken,Xm as initSheetFormulaData,sS as injectStyle,oS as isArray,rS as isCjkCenterAlignedPunctuation,iS as isCjkLeftAlignedPunctuation,lS as isCjkRightAlignedPunctuation,cS as isDate,JI as isEmbeddingFormulaEditor,mS as isFirstGlyph,Zm as isFormulaLexerToken,uS as isFunction,Jm as isInDirtyRange,Hi as isInSameTableCell,dS as isIndentByGlyph,hS as isLastGlyph,gS as isNumber,SS as isObject,wa as isPatternHasDecimal,CS as isPlaceholderOrSpace,qI as isRangeSelector,vS as isRectIntersect,qm as isReferenceString,Qm as isReferenceStringWithEffectiveColumn,eu as isReferenceStrings,pS as isRegExp,RS as isSameLine,QI as isSingleCellSelection,fS as isString,Vi as isValidRectRange,_S as lineIterator,La as localeCurrencySymbolMap,tu as matchRefDrawToken,au as matchToken,eM as menuClipboardDisabledObservable,bS as mergeInfoOffset,nP as mergeMenuConfigs,tM as mergeSetRangeValues,nu as needsQuoting,$i as neoGetDocObject,su as normalizeSheetName,ou as operatorToken,ES as parseDataStreamToTree,TS as pixelToPt,IS as precisionTo,ru as prefixToken,MS as ptToMM,yS as ptToPixel,FS as ptToPx,PS as pxToInch,NS as pxToNum,DS as pxToPt,iu as quoteSheetName,AS as radToDeg,aM as rangeMerge,nM as rangeToDiscreteRange,xS as renderImageWatermark,OS as renderTextWatermark,kS as renderUserInfoWatermark,LS as renderWatermark,po as replaceSelectionFactory,US as requestNewFrame,sM as rotateRange,oM as runRefRangeMutations,lu as sequenceNodeType,cu as serializeRange,mu as serializeRangeToRefString,uu as serializeRangeWithSheet,du as serializeRangeWithSpreadsheet,rM as setEndForRange,wS as setLineType,A as setPatternDecimal,WS as sheetContentViewportKeys,BS as sheetHeaderViewportKeys,hu as singleReferenceToGrid,iM as splitRangeText,sP as splitSpanText,gu as splitTableStructuredRef,jS as startWithEmoji,Su as strip,Yt as stripErrorMargin,oP as supportClipboardAPI,rP as t,iP as textTrim,Cu as toModule,HS as toPx,_a as transformCellsToRange,VS as transformObjectOutOfGroup,Gi as transformToDocDrawingPosition,vu as unquoteSheetName,lM as useActiveWorkbook,cM as useActiveWorksheet,lP as useClickOutSide,cP as useComponentsOfPart,mP as useConfigValue,uP as useDebounceFn,b as useDependency,Yi as useEditor,Ki as useEditorClickOutside,dP as useEvent,mM as useHighlightRange,hP as useInjector,zi as useIsFocusing,uM as useKeyEventConfig,Xi as useKeyboardEvent,Zi as useLeftAndRightArrow,gP as useObservable,SP as useObservableRef,Ji as useOnChange,qi as useResize,CP as useScrollYOverContainer,vP as useSidebarClick,pP as useToolbarItemStatus,RP as useUpdateBinder,fP as useUpdateEffect,_P as useVirtualList,dM as useWorkbooks,hM as virtualizeDiscreteRanges,Qi as whenDocAndEditorFocused,gM as whenFormulaEditorActivated,SM as whenSheetEditorFocused,$S as withCurrentTypeOfRenderer};
