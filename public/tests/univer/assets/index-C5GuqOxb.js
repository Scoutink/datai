import{L as D,fN as Rs,b6 as T,b5 as Ne,bi as U,Q as re,bH as Ot,c$ as fe,bt as V,d0 as G,db as Kt,da as N,ao as k,c8 as Se,i as gi,c7 as pi,$ as Il,aB as pe,f$ as bn,cz as gt,ai as fi,g6 as _e,aC as un,gd as Zt,aO as Rn,aH as qn,bB as Fe,b8 as Lo,g7 as Ut,gm as Ce,e8 as Ct,gf as xt,bq as Cl,aF as Te,al as De,gb as Ho,d7 as Tr,cp as Br,bM as q,gc as yn,g8 as he,d4 as ys,a1 as mi,f0 as Xe,aR as Mr,aM as wr,eT as Sl,dd as xl,X as ko,am as bl,dT as Fo,cA as hn,d5 as de,ea as ue,E as Os,e as z,bW as Rl,cd as ye,cm as yl,H as ln,dV as Ol,ev as Kn,bR as ot,c5 as Tl,fk as Bl,g0 as Nr,aA as oe,fm as Ml,cS as Vo,bQ as vi,cT as wl,cP as Nl,cR as _l,d_ as Ts,aY as Bs,aN as jo,dU as Wo,bZ as Dl,bV as Ql,bU as Zn,Z as Qe,k as _r,ed as zo,cc as Ui,du as Pl,cI as $i,fu as Ul,aG as Ms,gy as Ll,aj as Ye,ah as Hl,an as $t,gl as kl,bK as Fl,bk as ws,fR as Vl,bv as jl,e1 as Wl,cK as Wt,aw as zl,gn as Gl,bm as W,bo as On,bc as Ns,b7 as _s,b9 as Ds}from"./index-BI8deSNo.js";import{DocSelectionManagerService as Y,RichTextEditingMutation as X,DocSkeletonManagerService as ae,SetTextSelectionsOperation as Me,DocInterceptorService as Yl,DocStateEmitService as ql}from"./index-GTTB9Gpg.js";import{ar as gn,cg as Kl,ct as Zl,cr as Jl,bY as Xl,c as bt,bn as $l,aX as es,ag as Dr,K as ed,C as td,aw as pn,aY as nd,c2 as id,a4 as Go,bm as fn,aa as ce,ai as Yo,H as be,bX as ts,aH as qo,bI as dn,aG as Vn,cL as Ko,cE as sd,bW as rd,c3 as Qr,x as Zo,E as Ee,cF as od,cI as Pr,ax as Ur,a_ as ad,cC as ld,bQ as dd,bV as Jt,o as Ad,bR as cd,bd as Jo}from"./index-DnxWP_AP.js";import{z as ud,W as hd,av as gd,ao as $,bF as mn,bE as pd,a4 as Xo,bG as He,a as Lr,b8 as Hr,an as Z,U as Jn,l as en,aH as fd,aK as kr,ba as ne,O as $o,A as md,u as vd,B as Ed,y as Id,$ as Fr,x as Cd,S as Sd,bt as J,bu as cn,bw as $e,ai as Ei,ar as te,aa as Ii,az as xd,X as bd,br as ea,aj as ta,w as Xt,a0 as na,au as ia,bj as Rd,J as yd,s as Od,Q as Td,r as Bd,ad as sa,aY as Md,aU as wd,ap as Nd,bH as _d,a3 as Dd,al as Qd,a5 as Pd}from"./index-BeEHzc6r.js";import"./index-u4QJ_A0o.js";import{aj as M,ak as B,a4 as ke,T as Tn,p as ra,f as Je,ag as Ud,E as Ld,u as Vr,Z as Hd}from"./index-BmfxE5KL.js";import{t as at}from"./takeUntil-BWepI5Pd.js";import{b as kd}from"./bufferTime-Dc1Jgi3q.js";import"./shareReplay-DR2HpNHE.js";import"./isObservable-DLg0_x3m.js";var Fd=Object.defineProperty,Vd=(e,t,n)=>t in e?Fd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,y=(e,t,n)=>Vd(e,typeof t!="symbol"?t+"":t,n),jd=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},jr=(e,t)=>(n,i)=>t(n,i,e);let Rt=class extends pe{constructor(e,t){super(),y(this,"_matches",new Map),this._univerInstanceService=e,this._textSelectionManagerService=t}registerAutoFormat(e){const t=this._matches.get(e.id);return t?(t.push(e),t.sort((n,i)=>{var s,r;return((s=i.priority)!=null?s:0)-((r=n.priority)!=null?r:0)})):this._matches.set(e.id,[e]),bn(()=>{const n=this._matches.get(e.id);if(n){const i=n.findIndex(s=>s===e);i>=0&&n.splice(i,1)}})}onAutoFormat(e,t){var n,i,s,r,o,a,l,d,c;const A=(n=this._matches.get(e))!=null?n:[],g=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC),u=this._textSelectionManagerService.getDocRanges(),h=(i=u.find(p=>p.isActive))!=null?i:u[0];if(g&&h){const p=g.getSelfOrHeaderFooterModel(h.segmentId),f={unit:p,selection:h,isBody:!h.segmentId,paragraphs:re.range.getParagraphsInRange(h,(r=(s=p.getBody())==null?void 0:s.paragraphs)!=null?r:[],(a=(o=p.getBody())==null?void 0:o.dataStream)!=null?a:""),customRanges:re.customRange.getCustomRangesInterestsWithSelection(h,(d=(l=p.getBody())==null?void 0:l.customRanges)!=null?d:[]),commandId:e,commandParams:t},m=A.find(C=>C.match(f));return(c=m?.getMutations(f))!=null?c:[]}return[]}};Rt=jd([jr(0,U),jr(1,W(Y))],Rt);const Wd={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},zd={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},Gd="DOC_UI_PLUGIN";var ze=(e=>(e.MAIN="__Document_Render_Main__",e.BACKGROUND="__Document_Render_Background__",e))(ze||{}),Pe=(e=>(e.VIEW_MAIN="viewMain",e.VIEW_TOP="viewTop",e.VIEW_LEFT="viewLeft",e.VIEW_LEFT_TOP="viewLeftTop",e))(Pe||{});const Yd=0,Li=2,qd=4,Wr=10,np="normalTextSelectionPluginName";function lt(e){const{mainComponent:t,scene:n,engine:i,components:s}=e,r=t,o=s.get(ze.BACKGROUND);return{document:r,docBackground:o,scene:n,engine:i}}function Kd(e,t){const n=e.getCurrentUnitOfType(N.UNIVER_DOC);if(!n)return null;const i=n.getUnitId(),s=t.getRenderById(i);if(s==null)return;const{mainComponent:r,scene:o,engine:a,components:l}=s,d=r,c=l.get(ze.BACKGROUND);return{document:d,docBackground:c,scene:o,engine:a}}function ip(e,t){const n=t.getRenderById(e);if(n==null)return;const{mainComponent:i,scene:s,engine:r,components:o}=n,a=i,l=o.get(ze.BACKGROUND);return{document:a,docBackground:l,scene:s,engine:r}}function Zd(e){const{unitId:t,ranges:n,id:i,type:s,segmentId:r}=e,o={id:X.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:r}},a=V.getInstance(),l=re.customDecoration.add({ranges:n,id:i,type:s});return o.params.actions=a.editOp(l.serialize()),o}function sp(e,t){const{segmentId:n,id:i,type:s,unitId:r}=t,o=e.get(Y),a=e.get(U),l=r?a.getUnit(r,N.UNIVER_DOC):a.getCurrentUnitForType(N.UNIVER_DOC);if(!l)return!1;const d=l.getUnitId(),c=o.getTextRanges({unitId:d,subUnitId:d});return!c||!l.getBody()?!1:Zd({unitId:d,ranges:c,id:i,type:s,segmentId:n})}function rp(e,t){const{unitId:n,id:i,segmentId:s}=t,r=e.get(U).getUnit(n);if(!r)return!1;const o={id:X.id,params:{unitId:n,actions:[],textRanges:void 0,segmentId:s}},a=re.customDecoration.delete({id:i,segmentId:s,documentDataModel:r});if(!a)return!1;const l=V.getInstance();return o.params.actions=l.editOp(a.serialize()),o}function op(e,t){return t.some(n=>e.startIndex>n.startIndex&&e.startIndex<n.endIndex)}function Ci(e,t,n,i,s){const{textRuns:r=[],dataStream:o}=e,a=s&&o.startsWith("="),l={st:0,ed:0,ts:{}};if(a)return l;for(let d=r.length-1;d>=0;d--){const c=r[d],{st:A,ed:g}=c;t>A&&t<=g&&(l.st=A,l.ed=g,l.ts={...l.ts,...c.ts})}if(t===0){const d=r?.[0];d&&d.st===0&&(l.ts={...l.ts,...d.ts})}return i&&(l.ts={...l.ts,...i}),l}function Qs(e,t,n){if(n){const s=e.find(r=>t>=r.startIndex&&t<=r.endIndex+1);return s!=null&&s.wholeEntity?null:s}const i=e.find(s=>t>s.startIndex&&t<=s.endIndex);return i!=null&&i.wholeEntity?null:i}function Ps(e,t){return e.filter(n=>t>n.startIndex&&t<=n.endIndex)}function ap(e){return{left:e.positionH.posOffset,top:e.positionV.posOffset,width:e.size.width,height:e.size.height}}function lp(e,t=0,n=0){return{size:{width:e.width,height:e.height},positionH:{relativeFrom:vi.MARGIN,posOffset:(e.left||0)-t},positionV:{relativeFrom:ot.PAGE,posOffset:(e.top||0)-n},angle:e.angle||0}}const Jd="doc.command.tab",Gt={id:Jd,type:D.COMMAND,async handler(e,t){const n=e.get(Rt).onAutoFormat(Gt.id,t);return(await Rs(n,e.get(T))).result}},Xd="doc.command.after-space",Si={id:Xd,type:D.COMMAND,async handler(e){const t=e.get(Rt).onAutoFormat(Si.id);return(await Rs(t,e.get(T))).result}},vn={id:"doc.command.enter",type:D.COMMAND,async handler(e){const t=e.get(Rt).onAutoFormat(vn.id);return(await Rs(t,e.get(T))).result}};var $d=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Hi=(e,t)=>(n,i)=>t(n,i,e);const eA=11,tA=9,Qn={ff:"Arial",fs:eA};let et=class extends pe{constructor(e,t,n){super(),y(this,"_cacheStyle",null),this._textSelectionManagerService=e,this._univerInstanceService=t,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var e;const t=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC);if(t==null)return{...Qn};const n=t?.getUnitId(),i=(e=this._renderManagerService.getRenderById(n))==null?void 0:e.with(ae),s=i?.getViewModel();return s==null?{...Qn}:s.getEditArea()===Ee.BODY?{...Qn}:{...Qn,fs:tA}}setStyleCache(e){this._cacheStyle={...this._cacheStyle,...e}}_clearStyleCache(){this._cacheStyle=null}};et=$d([Hi(0,W(Y)),Hi(1,U),Hi(2,ce)],et);function Ve(e,t){var n;return(n=e.get(ce).getRenderById(t))==null?void 0:n.with(ae)}function le(e,t=""){if(!t)return["body"];const{headers:n,footers:i}=e.getSnapshot();if(n==null&&i==null)throw new Error("Document data model must have headers or footers when update by segment id");if(n?.[t]!=null)return["headers",t,"body"];if(i?.[t]!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}function oa(e,t,n){const i=[];for(let s=0,r=e.length;s<r;s++)e[s]===k.PARAGRAPH&&i.push({startIndex:s});if(t)for(const s of i)t.bullet&&(s.bullet=de.deepClone(t.bullet)),t.paragraphStyle&&(s.paragraphStyle=de.deepClone(t.paragraphStyle),delete s.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(s.paragraphStyle.headingId=ue(6)));if(n)for(const s of i)s.paragraphStyle||(s.paragraphStyle={}),s.paragraphStyle.borderBottom=n;return i}const Us={id:"doc.command.break-line",type:D.COMMAND,handler:(e,t)=>{var n,i,s,r,o;const a=e.get(Y),l=e.get(U),d=e.get(T),c=e.get(et),A=(n=t?.textRange)!=null?n:a.getActiveTextRange(),g=a.getRectRanges();if(A==null)return!1;if(g&&g.length){const{startOffset:L}=A;return a.replaceDocRanges([{startOffset:L,endOffset:L}]),!0}const{horizontalLine:u}=t??{},{segmentId:h}=A,p=l.getCurrentUnitForType(N.UNIVER_DOC),f=p?.getSelfOrHeaderFooterModel(h??"").getBody();if(p==null||f==null)return!1;const m=p.getUnitId(),{startOffset:C,endOffset:v}=A,I=((i=f.paragraphs)!=null?i:[]).find(L=>L.startIndex>=C);if(!I)return!1;const E=C===I.startIndex,S=I.startIndex,R=c.getDefaultStyle(),b=c.getStyleCache(),x=Ci(f,v,R,b),O={dataStream:k.PARAGRAPH,paragraphs:oa(k.PARAGRAPH,I,u),textRuns:[{st:0,ed:1,ts:{...x.ts}}]};if(p==null)return!1;const w=a.getActiveTextRange();if(f==null)return!1;const{collapsed:P}=A,Q=O.dataStream.length,H=[{startOffset:C+Q,endOffset:C+Q,style:w?.style,collapsed:P}],_={id:X.id,params:{unitId:m,actions:[],textRanges:H,debounce:!0}},j=new fe,K=V.getInstance();if(P)C>0&&j.push({t:G.RETAIN,len:C}),j.push({t:G.INSERT,body:O,len:O.dataStream.length});else{const L=re.selection.delete([A],f,0,O);j.push(...L)}(((s=I.bullet)==null?void 0:s.listType)===Se.CHECK_LIST_CHECKED||(r=I.paragraphStyle)!=null&&r.headingId)&&(A.endOffset<S&&j.push({t:G.RETAIN,len:S-A.endOffset}),j.push({t:G.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...I,paragraphStyle:{...I.paragraphStyle,...E?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(o=I.paragraphStyle)!=null&&o.headingId?void 0:{...I.bullet,listType:Se.CHECK_LIST}}]},coverType:Kt.REPLACE})),_.params.textRanges=[{startOffset:C+Q,endOffset:C+Q,collapsed:P}];const ee=le(p,h);return _.params.actions=K.editOp(j.serialize(),ee),!!d.syncExecuteCommand(_.id,_.params)}};var xi=(e=>(e[e.ABOVE=0]="ABOVE",e[e.BELLOW=1]="BELLOW",e))(xi||{}),Ls=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e))(Ls||{});function nA(e,t){let n=k.TABLE_START;const i=[],s=[];for(let r=0;r<e;r++){n+=k.TABLE_ROW_START;for(let o=0;o<t;o++)n+=`${k.TABLE_CELL_START}\r
${k.TABLE_CELL_END}`,i.push({startIndex:n.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),s.push({startIndex:n.length-2});n+=k.TABLE_ROW_END}return n+=k.TABLE_END,{dataStream:n,paragraphs:i,sectionBreaks:s}}function Hs(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function ks(e){const t=Hs();return{tableCells:[...new Array(e).fill(null).map(()=>de.deepClone(t))],trHeight:{val:{v:30},hRule:_l.AUTO}}}function Fs(e){return{size:{type:Vo.SPECIFIED,width:{v:e}}}}function aa(e,t,n){const i=Fs(n/t),s=ks(t),r=[...new Array(e).fill(null).map(()=>de.deepClone(s))],o=[...new Array(t).fill(null).map(()=>de.deepClone(i))],a=ue(6);return{tableRows:r,tableColumns:o,tableId:a,align:Nl.START,indent:{v:0},textWrap:wl.NONE,position:{positionH:{relativeFrom:vi.PAGE,posOffset:0},positionV:{relativeFrom:ot.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:Vo.UNSPECIFIED,width:{v:n}}}}function Bn(e,t){if(!e&&!t)return null;if(t&&t.length>0){let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s="";for(const r of t){const{startOffset:o,endOffset:a,segmentId:l}=r;o==null||a==null||l==null||(n=Math.min(n,o),i=Math.max(i,a))}if(Number.isFinite(n)&&Number.isFinite(i))return{startOffset:n,endOffset:i,segmentId:s}}else if(e){const{startOffset:n,endOffset:i,segmentId:s}=e;return n==null||i==null||s==null?null:{startOffset:n,endOffset:i,segmentId:s}}}function iA(e){let t=k.TABLE_ROW_START;const n=[],i=[];for(let s=0;s<e;s++)t+=`${k.TABLE_CELL_START}\r
${k.TABLE_CELL_END}`,n.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),i.push({startIndex:t.length-2});return t+=k.TABLE_ROW_END,{dataStream:t,paragraphs:n,sectionBreaks:i}}function sA(){const e=`${k.TABLE_CELL_START}\r
${k.TABLE_CELL_END}`,t=[],n=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:2}),{dataStream:e,paragraphs:t,sectionBreaks:n}}function rA(e,t,n){var i,s,r;const{startOffset:o,endOffset:a,segmentId:l}=e,d=n.getSelfOrHeaderFooterViewModel(l),c=t===0?o:a;let A=null;const g=(r=(s=(i=n.getBody())==null?void 0:i.tables)==null?void 0:s.find(h=>c>=h.startIndex&&c<=h.endIndex))==null?void 0:r.tableId;let u=0;for(const h of d.getChildren()){for(const p of h.children){const{children:f}=p,m=f[0];if(m){for(const C of m.children)if(C.startIndex<=c&&c<=C.endIndex){u=m.children.indexOf(C),A=C;break}}if(A)break}if(A)break}return A==null||g==null?null:{offset:t===0?A.startIndex:A.endIndex+1,colCount:A.children.length,tableId:g,insertRowIndex:t===0?u:u+1}}function oA(e,t,n){var i,s,r;const{startOffset:o,endOffset:a,segmentId:l}=e,d=n.getSelfOrHeaderFooterViewModel(l),c=t===0?o:a,A=(r=(s=(i=n.getBody())==null?void 0:i.tables)==null?void 0:s.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:r.tableId,g=[];let u=null,h=-1;for(const f of d.getChildren()){for(const m of f.children){const{children:C}=m,v=C[0];if(v){if(c<v.startIndex||c>v.endIndex)continue;u=v;for(const I of v.children){for(const E of I.children){const S=I.children.indexOf(E);if(c>=E.startIndex&&c<=E.endIndex){h=S;break}}if(h!==-1)break}}if(u)break}if(u)break}if(u==null||A==null||h===-1)return null;let p=0;for(const f of u.children){const m=f.children[h],C=t===0?m.startIndex:m.endIndex+1;g.push(C-p),p=C}return{offsets:g,tableId:A,columnIndex:h,rowCount:u.children.length}}function aA(e,t,n){const i=[];let s=t[n].size.width.v,r=0;for(let o=0;o<t.length;o++)r+=t[o].size.width.v;r+=s;for(let o=0;o<t.length;o++)i.push(t[o].size.width.v/r*e);return s=s/r*e,{widths:i,newColWidth:s}}function la(e,t){var n,i,s;const{startOffset:r,endOffset:o,segmentId:a}=e,l=t.getSelfOrHeaderFooterViewModel(a),d=(s=(i=(n=t.getBody())==null?void 0:n.tables)==null?void 0:i.find(p=>r>=p.startIndex&&o<=p.endIndex))==null?void 0:s.tableId,c=[];let A=-1,g=0,u=-1,h=!1;for(const p of l.getChildren()){for(const f of p.children){const{children:m}=f,C=m[0];if(C){if(r<C.startIndex||o>C.endIndex)continue;u=C.startIndex+3;for(const v of C.children){const I=C.children.indexOf(v),{startIndex:E,endIndex:S}=v;r>=E&&r<=S?(A=E,c.push(I),g+=S-E+1):(E>r&&S<o||o>=E&&o<=S)&&(c.push(I),g+=S-E+1),c.length===C.children.length&&(h=!0)}}if(c.length)break}if(c.length)break}return d==null||c.length===0?null:{tableId:d,rowIndexes:c,offset:A,len:g,cursor:u,selectWholeTable:h}}function lA(e,t){var n,i,s;const{startOffset:r,endOffset:o,segmentId:a}=e,l=t.getSelfOrHeaderFooterViewModel(a),d=(s=(i=(n=t.getBody())==null?void 0:n.tables)==null?void 0:i.find(m=>r>=m.startIndex&&o<=m.endIndex))==null?void 0:s.tableId,c=[];let A=null;const g=[];let u=-1,h=-1,p=-1;for(const m of l.getChildren()){for(const C of m.children){const{children:v}=C,I=v[0];if(I){if(r<I.startIndex||o>I.endIndex)continue;A=I;for(const E of I.children)for(const S of E.children){const R=E.children.indexOf(S);r>=S.startIndex&&r<=S.endIndex&&(h=R),o>=S.startIndex&&o<=S.endIndex&&(p=R)}}if(A)break}if(A)break}if(A==null||d==null)return null;for(let m=h;m<=p;m++)g.push(m);let f=0;for(const m of A.children){const C=m.children[h],v=m.children[p];c.push({retain:C.startIndex-f,delete:v.endIndex-C.startIndex+1}),f=v.endIndex+1}return u=A.startIndex+3,{offsets:c,tableId:d,columnIndexes:g,cursor:u,selectWholeTable:g.length===A.children[0].children.length,rowCount:A.children.length}}function da(e,t){var n,i,s;const{startOffset:r,endOffset:o,segmentId:a}=e,l=t.getSelfOrHeaderFooterViewModel(a),d=(s=(i=(n=t.getBody())==null?void 0:n.tables)==null?void 0:i.find(u=>r>=u.startIndex&&o<=u.endIndex))==null?void 0:s.tableId;let c=-1,A=0,g=-1;for(const u of l.getChildren()){for(const h of u.children){const{children:p}=h,f=p[0];if(f){if(r<f.startIndex||o>f.endIndex)continue;c=f.startIndex,A=f.endIndex-f.startIndex+1,g=f.startIndex}if(f)break}if(A>0)break}return d==null?null:{tableId:d,offset:c,len:A,cursor:g}}function dA(e,t){var n,i,s;const{startOffset:r,endOffset:o,segmentId:a}=e,l=t.getSelfOrHeaderFooterViewModel(a),d=(s=(i=(n=t.getBody())==null?void 0:n.tables)==null?void 0:i.find(m=>r>=m.startIndex&&o<=m.endIndex))==null?void 0:s.tableId,c=[];let A=null,g=-1,u=-1,h=-1,p=-1;for(const m of l.getChildren()){for(const C of m.children){const{children:v}=C,I=v[0];if(I){if(r<I.startIndex||o>I.endIndex)continue;A=I;for(const E of I.children){const S=I.children.indexOf(E);for(const R of E.children){const b=E.children.indexOf(R);r>=R.startIndex&&r<=R.endIndex&&(u=S,h=b),o>=R.startIndex&&o<=R.endIndex&&(p=b)}}}if(A)break}if(A)break}if(A==null||d==null||u===-1)return null;const f=A.children[u];for(let m=h;m<=p;m++){const C=f.children[m];c.push({retain:C.startIndex+1,delete:C.endIndex-C.startIndex-3})}return g=A.startIndex+3,{offsets:c,tableId:d,cursor:g,rowCount:A.children.length}}var ns=(e=>(e[e.NEXT=0]="NEXT",e[e.PREV=1]="PREV",e))(ns||{});function zr(e,t,n){const{startOffset:i}=t;let s=null;for(const d of e.getChildren()){for(const c of d.children){const A=c.children[0];if(A&&i>A.startIndex&&i<A.endIndex){s=A;break}}if(s)break}if(s==null)return null;let r=-1,o=-1,a=null;for(const d of s.children){for(const c of d.children)if(i>c.startIndex&&i<c.endIndex){r=d.children.indexOf(c),o=s.children.indexOf(d),a=d;break}if(r>-1)break}if(r===-1||o===-1||a==null)return null;let l=null;if(n===0){if(l=a.children[r+1],!l){const d=s.children[o+1];d&&(l=d.children[0])}}else if(l=a.children[r-1],!l){const d=s.children[o-1];d&&(l=d.children[d.children.length-1])}if(l){const{startIndex:d,endIndex:c}=l;return{startOffset:d+1,endOffset:c-2}}}function AA(e,t){const n=[],{customBlocks:i=[]}=e;for(const s of t){const{startOffset:r,endOffset:o}=s;if(!(r==null||o==null))for(const a of i){const{startIndex:l}=a;l>=r&&l<o&&n.push(a.blockId)}}return n}function cA(e){return e.some(t=>{const{startNodePosition:n}=t;return n?n?.path.indexOf("cells")>-1:!1})}const uA=hn,Aa={id:"doc.command.inner-paste",type:D.COMMAND,handler:async(e,t)=>{var n,i,s,r,o,a;const{segmentId:l,textRanges:d,doc:c}=t,A=e.get(T),g=e.get(Y),u=e.get(U),h=g.getTextRanges(),p=g.getRectRanges(),{body:f,tableSource:m,drawings:C}=c;if(!Array.isArray(h)||h.length===0||f==null)return!1;const v=u.getCurrentUniverDocInstance(),I=v?.getSelfOrHeaderFooterModel(l).getBody();if(v==null||I==null)return!1;const E=v.getUnitId(),S={id:X.id,params:{unitId:E,actions:[],textRanges:d,segmentId:l}},R=new Ot;R.reset();const b=new fe,x=V.getInstance(),O=[],w=!!((n=f.tables)!=null&&n.length),P=!!((i=f.customBlocks)!=null&&i.length);if(w&&l||w&&cA(h)||h.length&&p!=null&&p.length)return!1;for(let H=0;H<h.length;H++){const _=h[H],{startOffset:j,endOffset:K,collapsed:ee}=_,L=j-R.cursor,F=de.deepClone(f);if(w)for(const ge of F.tables){const{tableId:se}=ge,ve=ue(6);ge.tableId=ve;const Oe=de.deepClone(m[se]);Oe.tableId=ve;const Le=x.insertOp(["tableSource",ve],Oe);O.push(Le)}if(P&&C){const ge=(r=(s=v.getSnapshot().drawingsOrder)==null?void 0:s.length)!=null?r:0;for(const se of F.customBlocks){const{blockId:ve}=se,Oe=ue(6);se.blockId=Oe;const Le=de.deepClone(C[ve]);Le.drawingId=Oe;const Qt=x.insertOp(["drawings",Oe],Le),Dn=x.insertOp(["drawingsOrder",ge],Oe);O.push(Qt),O.push(Dn)}}const ie=Qs((o=I.customRanges)!=null?o:[],K,uA.includes(E)),Ae=Ps((a=I.customDecorations)!=null?a:[],K);if(ie&&(F.customRanges=[{...ie,startIndex:0,endIndex:f.dataStream.length-1}]),Ae.length&&(F.customDecorations=Ae.map(ge=>({...ge,startIndex:0,endIndex:f.dataStream.length-1}))),ee)b.push({t:G.RETAIN,len:L}),b.push({t:G.INSERT,body:F,len:f.dataStream.length});else{const ge=re.selection.delete([_],f,R.cursor,F,h.length===1);b.push(...ge)}R.reset(),R.moveCursor(K)}const Q=le(v,l);return O.push(x.editOp(b.serialize(),Q)),S.params.actions=O.reduce((H,_)=>V.compose(H,_),null),!!A.syncExecuteCommand(S.id,S.params)}};function hA(e,t){const{startOffset:n,endOffset:i}=e,s=t.some(o=>o.startIndex===i),r=Math.max(n,s?i-1:i);return{...e,endOffset:r,collapsed:n===r}}function gA(e,t,n){var i,s;const r=t.getSelfOrHeaderFooterModel(n).getBody(),o=new fe,a=V.getInstance(),l=[];if(r==null)return l;const{tables:d=[]}=r,c=new Ot;c.reset();for(let f=0;f<e.length;f++){const m=hA(e[f],d),{startOffset:C,endOffset:v,collapsed:I}=m,E=C-c.cursor;I?o.push({t:G.RETAIN,len:E}):o.push(...re.selection.delete([m],r,c.cursor,null,!1)),c.reset(),c.moveCursor(v)}const A=le(t,n);l.push(a.editOp(o.serialize(),A));const g=AA(r,e),u=(i=t.getDrawings())!=null?i:{},h=(s=t.getDrawingsOrder())!=null?s:[],p=g.sort((f,m)=>h.indexOf(f)>h.indexOf(m)?-1:h.indexOf(f)<h.indexOf(m)?1:0);if(p.length>0)for(const f of p){const m=u[f],C=h.indexOf(f);if(m==null||C<0)continue;const v=a.removeOp(["drawings",f],m),I=a.removeOp(["drawingsOrder",C],f);l.push(v),l.push(I)}return l.reduce((f,m)=>V.compose(f,m),null)}function pA(e,t,n,i){const s=[];if(t.getSelfOrHeaderFooterModel(i).getBody()==null)return s;const r=new fe,o=V.getInstance(),a=new Ot;a.reset();for(const d of e){const{startOffset:c,endOffset:A,spanEntireRow:g,spanEntireTable:u}=d;if(!(c==null||A==null))if(u){const h=da({startOffset:c,endOffset:A,segmentId:i},n);if(h==null)continue;const{offset:p,len:f,tableId:m}=h;p-a.cursor>0&&r.push({t:G.RETAIN,len:p-a.cursor}),r.push({t:G.DELETE,len:f});const C=o.removeOp(["tableSource",m]);s.push(C),a.moveCursorTo(p+f)}else if(g){const h=la({startOffset:c,endOffset:A,segmentId:i},n);if(h==null)continue;const{offset:p,rowIndexes:f,len:m,tableId:C}=h;p-a.cursor>0&&r.push({t:G.RETAIN,len:p-a.cursor}),r.push({t:G.DELETE,len:m});for(const v of f.reverse()){const I=o.removeOp(["tableSource",C,"tableRows",v]);s.push(I)}a.moveCursorTo(p+m)}else{const h=dA({startOffset:c,endOffset:A,segmentId:i},n);if(h==null)continue;const{offsets:p}=h;for(const f of p){const{retain:m,delete:C}=f;m-a.cursor>0&&r.push({t:G.RETAIN,len:m-a.cursor}),r.push({t:G.DELETE,len:C}),a.moveCursorTo(m+C)}}}const l=le(t,i);return s.push(o.editOp(r.serialize(),l)),s.reduce((d,c)=>V.compose(d,c),null)}function fA(e,t,n,i,s){let r=[];if(Array.isArray(e)&&e?.length!==0&&(r=gA(e,n,s)),Array.isArray(t)&&t?.length!==0){const o=pA(t,n,i,s);r==null||r.length===0?r=o:r=V.compose(r,V.transform(o,r,"right"))}return r}const Yt={id:"doc.command.inner-cut",type:D.COMMAND,handler:(e,t)=>{var n;const i=e.get(Y),s=e.get(T),r=e.get(U),{segmentId:o,textRanges:a,selections:l=i.getTextRanges(),rectRanges:d=i.getRectRanges()}=t;if((!Array.isArray(l)||l.length===0)&&(!Array.isArray(d)||d.length===0))return!1;const c=(n=r.getCurrentUniverDocInstance())==null?void 0:n.getUnitId();if(!c)return!1;const A=r.getUniverDocInstance(c);if(A==null)return!1;const g=Ve(e,c);if(g==null)return!1;const u=g.getViewModel(),h={id:X.id,params:{unitId:c,actions:[],textRanges:a}};return h.params.actions=fA(l,d,A,u,o),!!s.syncExecuteCommand(h.id,h.params)}};var Be=(e=>(e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e))(Be||{});const mA="doc.command.insert-text",ca={id:mA,type:D.COMMAND,handler:async(e,t)=>{var n;const i=e.get(T),{range:s,segmentId:r,body:o,unitId:a,cursorOffset:l}=t,d=e.get(Y),c=e.get(U).getUnit(a,N.UNIVER_DOC);if(c==null)return!1;const A=d.getActiveTextRange(),g=c.getSelfOrHeaderFooterModel((n=A?.segmentId)!=null?n:"").getBody();if(g==null)return!1;const{startOffset:u,collapsed:h}=s,p=l??o.dataStream.length,f=[{startOffset:u+p,endOffset:u+p,style:A?.style,collapsed:h}],m={id:X.id,params:{unitId:a,actions:[],textRanges:f,debounce:!0}},C=new fe,v=V.getInstance();if(h)u>0&&C.push({t:G.RETAIN,len:u}),C.push({t:G.INSERT,body:o,len:o.dataStream.length});else{const E=re.selection.delete([s],g,0,o);C.push(...E)}m.params.textRanges=[{startOffset:u+p,endOffset:u+p,collapsed:h}];const I=le(c,r);return m.params.actions=v.editOp(C.serialize(),I),!!i.syncExecuteCommand(m.id,m.params)}},En={id:"doc.command.delete-text",type:D.COMMAND,handler:async(e,t)=>{var n;const i=e.get(T),s=e.get(U),{range:r,segmentId:o,unitId:a,direction:l,len:d=1}=t,c=s.getUnit(a,N.UNIVER_DOC),A=c?.getSelfOrHeaderFooterModel(o).getBody();if(c==null||A==null)return!1;const{startOffset:g}=r;let u=l===Be.LEFT?g-d:g,h=l===Be.LEFT?g-1:g+d-1;const p=(n=A.customRanges)==null?void 0:n.find(I=>I.startIndex<=u&&I.endIndex>=h);p!=null&&p.wholeEntity&&(u=p.startIndex,h=Math.max(h,p.endIndex));const f={id:X.id,params:{unitId:a,actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],debounce:!0}},m=new fe,C=V.getInstance();m.push({t:G.RETAIN,len:u-0}),m.push({t:G.DELETE,len:h-u+1});const v=le(c,o);return f.params.actions=C.editOp(m.serialize(),v),!!i.syncExecuteCommand(f.id,f.params)}},ua={id:"doc.command.update-text",type:D.COMMAND,handler:async(e,t)=>{const{range:n,segmentId:i,updateBody:s,coverType:r,unitId:o,textRanges:a}=t,l=e.get(T),d=e.get(U).getCurrentUniverDocInstance();if(d==null)return!1;const c={id:X.id,params:{unitId:o,actions:[],textRanges:a}},A=new fe,g=V.getInstance(),{startOffset:u,endOffset:h}=n;A.push({t:G.RETAIN,len:u}),A.push({t:G.RETAIN,body:s,len:h-u,coverType:r});const p=le(d,i);return c.params.actions=g.editOp(A.serialize(),p),!!l.syncExecuteCommand(c.id,c.params)}};function Mn(e){var t,n,i,s;const r=e.get(U),o=e.get(Y).getActiveTextRange(),a=r.getCurrentUnitOfType(N.UNIVER_DOC);return!o||!o.collapsed||!a||o.segmentId?!1:re.range.getParagraphsInRange(o,(n=(t=a.getBody())==null?void 0:t.paragraphs)!=null?n:[],(s=(i=a.getBody())==null?void 0:i.dataStream)!=null?s:"")[0]}const Vs={id:"doc.command.delete-custom-block",type:D.COMMAND,handler:async(e,t)=>{var n;const i=e.get(Y),s=e.get(U),r=e.get(T),o=i.getActiveTextRange(),a=s.getCurrentUniverDocInstance();if(o==null||a==null)return!1;const{direction:l,range:d,unitId:c,drawingId:A}=t,{startOffset:g,segmentId:u,style:h}=o,p=l===Be.LEFT?g-1:g,f=[{startOffset:p,endOffset:p,style:h}],m={id:X.id,params:{unitId:c,actions:[],textRanges:f,prevTextRanges:[d]}},C=new fe,v=V.getInstance(),I=[];g>0&&C.push({t:G.RETAIN,len:l===Be.LEFT?g-1:g}),C.push({t:G.DELETE,len:1});const E=le(a,u);I.push(v.editOp(C.serialize(),E));const S=((n=a.getDrawings())!=null?n:{})[A],R=a.getDrawingsOrder().indexOf(A),b=v.removeOp(["drawings",A],S),x=v.removeOp(["drawingsOrder",R],A);return I.push(b),I.push(x),m.params.actions=I.reduce((O,w)=>V.compose(O,w),null),!!r.syncExecuteCommand(m.id,m.params)}},js={id:"doc.command.merge-two-paragraph",type:D.COMMAND,handler:async(e,t)=>{const n=e.get(Y),i=e.get(U),s=e.get(T),{direction:r,range:o}=t,a=n.getActiveTextRange(),l=n.getTextRanges();if(a==null||l==null)return!1;const{segmentId:d,style:c}=a,A=i.getCurrentUnitForType(N.UNIVER_DOC),g=A?.getSelfOrHeaderFooterModel(d).getBody();if(A==null||g==null)return!1;const u=g.dataStream,h=a,p=A.getUnitId(),{startOffset:f,collapsed:m}=h;if(!m)return!1;const C=r===Be.LEFT?f:f+1;let v,I;for(const Q of g.paragraphs){if(Q.startIndex>=C){I=Q;break}v=Q}if(v==null||I==null)return!1;const E=r===Be.LEFT?f-1:f,S=[{startOffset:E,endOffset:E,style:c}],R={id:X.id,params:{unitId:p,actions:[],textRanges:S,prevTextRanges:[o]}},b=new fe,x=V.getInstance();v.startIndex>0&&b.push({t:G.RETAIN,len:v.startIndex}),b.push({t:G.DELETE,len:1}),I.startIndex>v.startIndex+1&&b.push({t:G.RETAIN,len:I.startIndex-v.startIndex-1});const O=Object.values(k),w=u[v.startIndex-1];(w&&!O.includes(w)||w===" ")&&b.push({t:G.RETAIN,len:1,coverType:Kt.REPLACE,body:{dataStream:"",paragraphs:[{...de.deepClone(v),startIndex:0}]}});const P=le(A,d);return R.params.actions=x.editOp(b.serialize(),P),!!s.syncExecuteCommand(R.id,R.params)}},ha={id:"doc.command.remove-horizontal-line",type:D.COMMAND,handler:async e=>{var t;const n=e.get(Y),i=e.get(U),s=e.get(T),r=n.getActiveTextRange(),o=n.getTextRanges();if(r==null||o==null)return!1;const{segmentId:a,style:l}=r,d=i.getCurrentUnitForType(N.UNIVER_DOC),c=d?.getSelfOrHeaderFooterModel(a).getBody();if(d==null||c==null)return!1;const A=r,g=d.getUnitId(),{startOffset:u,collapsed:h}=A;if(!h)return!1;const p=(t=c.paragraphs)==null?void 0:t.find(E=>E.startIndex===u-1);if(p==null)return!1;const f=[{startOffset:u,endOffset:u,style:l}],m={id:X.id,params:{unitId:g,actions:[],textRanges:f}},C=new fe,v=V.getInstance();p.startIndex>0&&C.push({t:G.RETAIN,len:p.startIndex}),C.push({t:G.RETAIN,len:1,coverType:Kt.REPLACE,body:{dataStream:"",paragraphs:[{...de.deepClone({...p,paragraphStyle:{...p.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const I=le(d,a);return m.params.actions=v.editOp(C.serialize(),I),!!s.syncExecuteCommand(m.id,m.params)}};function Ws(e,t){let n=0;if(e==null||e.length===0){if(typeof t[0].startOffset=="number"){const i=t[0],{spanEntireRow:s,spanEntireTable:r}=i;r?n=i.startOffset-3:s?i.startRow>0?n=i.startOffset-6:n=i.startOffset:n=t[0].startOffset}}else if(e.length>0&&t.length>0){const i=e[0],s=t[0];if(i.startOffset!=null&&s.startOffset!=null){if(i.startOffset<s.startOffset)n=i.startOffset;else if(i.startOffset>=s.startOffset){const{spanEntireRow:r,spanEntireTable:o}=s;o?n=s.startOffset-3:r&&(n=s.startOffset-6)}}}return n}const bi={id:"doc.command.delete-left",type:D.COMMAND,handler:async e=>{var t,n,i,s,r,o;const a=e.get(Y),l=e.get(U),d=e.get(T);let c=!0;const A=l.getCurrentUniverDocInstance();if(A==null)return!1;const g=A.getUnitId(),u=Ve(e,g),h=a.getActiveTextRange(),p=a.getRectRanges(),f=a.getTextRanges(),m=u?.getSkeleton();if(m==null)return!1;if(p!=null&&p.length){const H=Ws(f,p),_=p[0].segmentId,j=[{startOffset:H,endOffset:H}];return d.executeCommand(Yt.id,{segmentId:_,textRanges:j})}if(h==null||f==null)return!1;const{segmentId:C,style:v,segmentPage:I}=h,E=A.getSelfOrHeaderFooterModel(C).getBody();if(E==null)return!1;const S=h,{startOffset:R,collapsed:b}=S,x=m.findNodeByCharIndex(R,C,I),O=Kl(x),w=Zl(x,E);let P=R;const Q=m.findNodeByCharIndex(R-1,C,I);if(Jl(x)&&Q!==x&&(O===!0||w===!0)&&b){const H=Xl(x,E);if(H==null)return!1;const _=H?.startIndex,j={startIndex:0},K=H.paragraphStyle;if(O===!0){const L=H.paragraphStyle;if(L){j.paragraphStyle=L;const{hanging:F}=L;F&&(j.paragraphStyle.indentStart=F,j.paragraphStyle.hanging=void 0)}}else if(w===!0){const L=H.bullet;L&&(j.bullet=L),K!=null&&(j.paragraphStyle={...K},delete j.paragraphStyle.hanging,delete j.paragraphStyle.indentStart)}const ee=[{startOffset:P,endOffset:P,style:v}];c=await d.executeCommand(ua.id,{unitId:A.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...j}]},range:{startOffset:_,endOffset:_+1},textRanges:ee,coverType:Kt.REPLACE,segmentId:C})}else if(b===!0){if(Q==null)return!0;if(Q.content==="\r"){const H=(t=E.paragraphs)==null?void 0:t.find(_=>_.startIndex===R-1);(n=H?.paragraphStyle)!=null&&n.borderBottom?c=await d.executeCommand(ha.id):c=await d.executeCommand(js.id,{direction:Be.LEFT,range:S})}else if(Q.streamType==="\b"){const H=(s=A.getSnapshot().drawings)==null?void 0:s[(i=Q.drawingId)!=null?i:""];if(H==null)return!0;const _=(o=(r=A.getBody())==null?void 0:r.customBlocks)==null?void 0:o.find(j=>j.blockId===Q.drawingId);if(H.layoutType===pi.INLINE||_?.blockType===Il.CUSTOM){const j=A.getUnitId();c=await d.executeCommand(Vs.id,{direction:Be.LEFT,range:h,unitId:j,drawingId:Q.drawingId})}else{const j=m.findNodeByCharIndex(R-2);if(j==null)return!0;P-=Q.count,P-=j.count;const K=[{startOffset:P,endOffset:P,style:v}];c=await d.executeCommand(En.id,{unitId:A.getUnitId(),range:{...h,startOffset:h.startOffset-1,endOffset:h.endOffset-1},segmentId:C,direction:Be.LEFT,len:j.count,textRanges:K})}}else P-=Q.count,c=await d.executeCommand(En.id,{unitId:A.getUnitId(),range:S,segmentId:C,direction:Be.LEFT,len:Q.count})}else{const H=pa(S,[S]);c=await d.executeCommand(Yt.id,{segmentId:C,textRanges:H,selections:[S]})}return c}},ga={id:"doc.command.delete-right",type:D.COMMAND,handler:async e=>{var t,n;const i=e.get(Y),s=e.get(U).getCurrentUniverDocInstance();if(!s)return!1;const r=Ve(e,s.getUnitId()),o=e.get(T),a=i.getActiveTextRange(),l=i.getRectRanges(),d=i.getTextRanges(),c=r?.getSkeleton();if(l!=null&&l.length){const I=Ws(d,l),E=l[0].segmentId,S=[{startOffset:I,endOffset:I}];return o.executeCommand(Yt.id,{segmentId:E,textRanges:S})}if(a==null||c==null||d==null)return!1;const{segmentId:A,style:g,segmentPage:u}=a,h=s?.getSelfOrHeaderFooterModel(A).getBody();if(!s||!h)return!1;const p=a,{startOffset:f,endOffset:m,collapsed:C}=p;if(f===h.dataStream.length-2&&C)return!0;let v=!1;if(C===!0){const I=c.findNodeByCharIndex(f,A,u),E=c.findNodeByCharIndex(f+1);if(I.streamType===k.PARAGRAPH&&E?.streamType===k.SECTION_BREAK)return!1;if(I.content==="\r")v=await o.executeCommand(js.id,{direction:Be.RIGHT,range:a});else if(I.streamType==="\b"){const S=(n=s.getSnapshot().drawings)==null?void 0:n[(t=I.drawingId)!=null?t:""];if(S==null)return!0;if(S.layoutType===pi.INLINE){const R=s.getUnitId();v=await o.executeCommand(Vs.id,{direction:Be.RIGHT,range:a,unitId:R,drawingId:I.drawingId})}else{if(E==null)return!0;const R=[{startOffset:f+1,endOffset:f+1,style:g}];v=await o.executeCommand(En.id,{unitId:s.getUnitId(),range:{...a,startOffset:f+1,endOffset:m+1},segmentId:A,direction:Be.RIGHT,textRanges:R,len:E.count})}}else{const S=[{startOffset:f,endOffset:f,style:g}];v=await o.executeCommand(En.id,{unitId:s.getUnitId(),range:p,segmentId:A,direction:Be.RIGHT,textRanges:S,len:I.count})}}else{const I=pa(p,[p]);v=await o.executeCommand(Yt.id,{segmentId:A,textRanges:I,selections:[p]})}return v}};function pa(e,t){let n=e.endOffset;for(const i of t){const{startOffset:s,endOffset:r}=i;s==null||r==null||r<=e.endOffset&&(n-=r-s)}return[{startOffset:n,endOffset:n,style:e.style}]}const zs={id:"doc.command.delete-current-paragraph",type:D.COMMAND,handler:async e=>{var t,n;const i=e.get(U),s=e.get(T),r=i.getCurrentUnitOfType(N.UNIVER_DOC);if(!r)return!1;const o=(n=(t=r.getBody())==null?void 0:t.dataStream)!=null?n:"",a=Mn(e);if(!a)return!1;const l=re.selection.delete([{startOffset:a.paragraphStart,endOffset:o[a.paragraphEnd+1]===`
`?a.paragraphEnd:a.paragraphEnd+1,collapsed:!1}],r.getBody(),0,void 0,!0),d=le(r),c={unitId:r.getUnitId(),actions:V.getInstance().editOp(l,d),textRanges:[{startOffset:a.paragraphStart,endOffset:a.paragraphStart,collapsed:!0}]};return s.syncExecuteCommand(X.id,c)}},vA=10,EA=6;function IA(){return ue(EA)}function CA(e){const t=e.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class SA{constructor(){y(this,"_cache",new jl(vA))}set(t,n){this._cache.set(t,n)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const ki=new SA;function Gs(e){const t=e.style,n={},i=e.tagName.toLowerCase();switch(i){case"b":case"em":case"strong":{n.bl=z.TRUE;break}case"s":{n.st={s:z.TRUE};break}case"u":{n.ul={s:z.TRUE};break}case"i":{n.it=z.TRUE;break}case"sub":case"sup":{n.va=i==="sup"?Qe.SUPERSCRIPT:Qe.SUBSCRIPT;break}}for(let s=0;s<t.length;s++){const r=t[s],o=t.getPropertyValue(r);switch(r){case"font-family":{n.ff=o.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const a=Number.parseInt(o);Number.isNaN(a)||(o.endsWith("pt")?n.fs=a:o.endsWith("px")&&(n.fs=od(a)));break}case"font-style":{o==="italic"&&(n.it=z.TRUE);break}case"font-weight":{(Number(o)>400||String(o)==="bold")&&(n.bl=z.TRUE);break}case"text-decoration":{/underline/.test(o)?n.ul={s:z.TRUE}:/overline/.test(o)?n.ol={s:z.TRUE}:/line-through/.test(o)&&(n.st={s:z.TRUE});break}case"color":{try{const a=new _r(o);a.isValid&&(n.cl={rgb:a.toRgbString()})}catch{}break}case"background-color":{const a=new _r(o);a.isValid&&(n.bg={rgb:a.toRgbString()});break}}}return n}function xA(e){const t=new DOMParser,n=`<x-univer id="univer-root">${e}</x-univer>`;return t.parseFromString(n,"text/html").querySelector("#univer-root")}function Gr(e,t){const n=e.tagName.toLowerCase();return typeof t=="string"?n===t:Array.isArray(t)?t.some(i=>i===n):t(e)}const Yr=660,fa=class ma{constructor(){y(this,"_tableCache",[]),y(this,"_styleCache",new Map),y(this,"_styleRules",[]),y(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,n={}){var i;const s=ma._pluginList.find(a=>a.checkPasteType(t)),r=xA(t),o={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(i=n?.unitId)!=null?i:""};return s&&(this._styleRules=[...s.stylesRules],this._afterProcessRules=[...s.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,r.childNodes,o),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],o}_process(t,n,i){var s,r,o,a;const l=i.body;for(const d of n)if(d.nodeType===Node.TEXT_NODE){if(((s=d.nodeValue)==null?void 0:s.trim())==="")continue;const c=(r=d.nodeValue)==null?void 0:r.replace(/[\r\n]/g,"");let A;t&&this._styleCache.has(t)&&(A=this._styleCache.get(t)),l.dataStream+=c,A&&Object.getOwnPropertyNames(A).length&&l.textRuns.push({st:l.dataStream.length-c.length,ed:l.dataStream.length,ts:A})}else if(d.nodeName==="IMG"){const c=d,A=c.dataset.imageSourceType,g=A===ws.UUID?c.dataset.source:c.src;if(g&&A){const u=Number(c.dataset.width||100),h=Number(c.dataset.height||100),p=Number(c.dataset.docTransformWidth||u),f=Number(c.dataset.docTransformHeight||h),m=ue(6);(a=(o=i.body)==null?void 0:o.customBlocks)==null||a.push({startIndex:l.dataStream.length,blockId:m}),l.dataStream+="\b",i.drawings||(i.drawings={}),i.drawings[m]={drawingId:m,title:"",description:"",imageSourceType:A,source:g,transform:{width:u,height:h,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:vi.PAGE,posOffset:0},positionV:{relativeFrom:ot.PARAGRAPH,posOffset:0}},layoutType:pi.INLINE,drawingType:Ms.DRAWING_IMAGE,unitId:i.id||"",subUnitId:i.id||""}}}else{if(Vl.includes(d.nodeName.toLowerCase()))continue;if(d.nodeType===Node.ELEMENT_NODE){const c=d,A=this._processBeforeLink(c,i),g=t?this._styleCache.get(t):{},u=this._styleRules.find(({filter:m})=>Gr(d,m)),h=u?u.getStyle(d):Gs(d);this._styleCache.set(d,{...g,...h});const{childNodes:p}=d;this._processBeforeTable(d,i),this._process(d,p,i),this._processAfterTable(d,i);const f=this._afterProcessRules.find(({filter:m})=>Gr(d,m));f&&f.handler(i,d),this._processAfterLink(c,i,A)}}}_processBeforeTable(t,n){var i;const s=t.tagName.toUpperCase(),r=n.body;switch(s){case"TABLE":{r.dataStream[r.dataStream.length-1]!=="\r"&&(r.dataStream+="\r",r.paragraphs==null&&(r.paragraphs=[]),(i=r.paragraphs)==null||i.push({startIndex:r.dataStream.length-1}));const o=aa(0,0,Yr);this._tableCache.push({table:o,startIndex:r.dataStream.length}),r.dataStream+=k.TABLE_START;break}case"TR":{const o=ks(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(o),r.dataStream+=k.TABLE_ROW_START;break}case"TD":{const o=Hs(),a=this._tableCache[this._tableCache.length-1].table;a.tableRows[a.tableRows.length-1].tableCells.push(o),r.dataStream+=k.TABLE_CELL_START;break}}}_processAfterTable(t,n){var i,s;const r=t.tagName.toUpperCase(),o=n.body;n.tableSource==null&&(n.tableSource={}),o.tables==null&&(o.tables=[]),o.sectionBreaks==null&&(o.sectionBreaks=[]);const{tableSource:a}=n;switch(r){case"TABLE":{const l=this._tableCache.pop(),{startIndex:d,table:c}=l,A=c.tableRows[0].tableCells.length,g=Fs(Yr/A),u=[...new Array(A).fill(null).map(()=>de.deepClone(g))];c.tableColumns=u,a[c.tableId]=c,o.dataStream+=k.TABLE_END,o.tables.push({startIndex:d,endIndex:o.dataStream.length,tableId:c.tableId});break}case"TR":{o.dataStream+=k.TABLE_ROW_END;break}case"TD":{o.dataStream[o.dataStream.length-1]!=="\r"&&((i=o.paragraphs)==null||i.push({startIndex:o.dataStream.length}),o.dataStream+="\r"),(s=o.sectionBreaks)==null||s.push({startIndex:o.dataStream.length}),o.dataStream+=`
${k.TABLE_CELL_END}`;break}}}_processBeforeLink(t,n){return n.body.dataStream.length}_processAfterLink(t,n,i){var s,r;const o=n.body,a=t;a.tagName.toUpperCase()==="A"&&(o.customRanges=(s=o.customRanges)!=null?s:[],o.customRanges.push({startIndex:i,endIndex:o.dataStream.length-1,rangeId:(r=a.dataset.rangeid)!=null?r:ue(),rangeType:Os.HYPERLINK,properties:{url:a.href}}))}};y(fa,"_pluginList",[]);let Ri=fa;const bA={name:"univer-doc-paste-plugin-lark",checkPasteType(e){return/lark-record-clipboard/i.test(e)},stylesRules:[{filter:["s"],getStyle(e){const t=Gs(e);return{st:{s:z.TRUE},...t}}}],afterProcessRules:[{filter(e){return e.tagName==="DIV"&&/ace-line/i.test(e.className)},handler(e){const t=e.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function va(e){const t=e.style,n={};for(let i=0;i<t.length;i++){const s=t[i],r=t.getPropertyValue(s);switch(s){case"margin-top":{const o=Number.parseInt(r);n.spaceAbove={v:/pt/.test(r)?Pr(o):o};break}case"margin-bottom":{const o=Number.parseInt(r);n.spaceBelow={v:/pt/.test(r)?Pr(o):o};break}case"line-height":{let o=Number.parseFloat(r);r.endsWith("%")&&(o/=100),n.lineSpacing=o;break}}}return Object.getOwnPropertyNames(n).length?n:null}const RA={name:"univer-doc-paste-plugin-univer",checkPasteType(e){return/UniverNormal/i.test(e)},stylesRules:[],afterProcessRules:[{filter(e){return e.tagName==="P"&&/UniverNormal/i.test(e.className)},handler(e,t){const n=e.body;n.paragraphs==null&&(n.paragraphs=[]);const i={startIndex:n.dataStream.length},s=va(t);s&&(i.paragraphStyle=s),n.paragraphs.push(i),n.dataStream+="\r"}}]},yA={name:"univer-doc-paste-plugin-word",checkPasteType(e){return/word|mso/i.test(e)},stylesRules:[{filter:["b"],getStyle(e){const t=Gs(e);return{bl:z.TRUE,...t}}}],afterProcessRules:[{filter(e){return e.tagName==="P"},handler(e,t){const n=e.body;n.paragraphs==null&&(n.paragraphs=[]);const i={startIndex:n.dataStream.length},s=va(t);s&&(i.paragraphStyle=s),n.paragraphs.push(i),n.dataStream+="\r"}}]};function OA(e){var t,n;const i=r=>{let o="";return Object.keys(r).forEach(a=>{r[a]!==void 0&&(o+=` ${a}=${r[a]}`)}),o},s={"data-doc-transform-height":e.docTransform.size.height,"data-doc-transform-width":e.docTransform.size.width,"data-width":(t=e.transform)==null?void 0:t.width,"data-height":(n=e.transform)==null?void 0:n.height,"data-image-source-type":e.imageSourceType,"data-source":e.imageSourceType===ws.UUID?e.source:void 0,src:e.source};return`<img  ${i(s)}></img>`}function qr(e,t){const{st:n,ed:i,ts:s={}}=t,{ff:r,fs:o,it:a,bl:l,ul:d,st:c,ol:A,bg:g,cl:u,va:h}=s;let p=e.slice(n,i);const f=[];return a===z.TRUE&&(p=`<i>${p}</i>`),h===Qe.SUPERSCRIPT?p=`<sup>${p}</sup>`:h===Qe.SUBSCRIPT&&(p=`<sub>${p}</sub>`),d?.s===z.TRUE&&(p=`<u>${p}</u>`),c?.s===z.TRUE&&(p=`<s>${p}</s>`),l===z.TRUE&&(p=`<strong>${p}</strong>`),r&&f.push(`font-family: ${r}`),u&&f.push(`color: ${u.rgb}`),o&&f.push(`font-size: ${o}pt`),A&&f.push("text-decoration: overline"),g&&f.push(`background: ${g.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Fi(e,t,n){const{dataStream:i,textRuns:s=[]}=e;if(t===n)return"";let r=t;const o=[];for(const a of s){const{st:l,ed:d}=a;de.hasIntersectionBetweenTwoRanges(t,n,l,d)&&(l>r?(o.push(i.slice(r,l)),o.push(qr(i,{...a,ed:Math.min(d,n)}))):o.push(qr(i,{...a,st:r,ed:Math.min(d,n)}))),r=Math.max(t,Math.min(d,n))}return r!==n&&o.push(i.slice(r,n)),o.join("")}function TA(e,t,n){const i=e.body,s=e.drawings||{},{customRanges:r=[],customBlocks:o=[]}=i||{},a=[...o],l=r.filter(u=>u.startIndex>=t&&u.endIndex<=n);let d=t,c="";const A=(u,h)=>{let p="",f=0,m=u,C=a.findIndex(v=>u<=v.startIndex&&h>=v.startIndex);if(C===-1)return p=Fi(i,u,h),{sliceHtml:p,customBlockLength:f};for(;C!==-1;){const v=a[C];a.splice(C,1),p+=Fi(i,m,v.startIndex);const I=s[v.blockId];I&&I.drawingType===Ms.DRAWING_IMAGE&&(p+=OA(I),f++),m=v.startIndex+1,C=a.findIndex(E=>m<=E.startIndex&&h>=E.startIndex)}return p=p+Fi(i,m,h+1),{sliceHtml:p,customBlockLength:f}};l.forEach(u=>{var h,p;const{startIndex:f,endIndex:m,rangeType:C,rangeId:v}=u,I=A(d,f);c+=I.sliceHtml;const E=A(f,m+1);C===Os.HYPERLINK?c+=`<a data-rangeid="${v}" href="${(p=(h=u.properties)==null?void 0:h.url)!=null?p:""}">${E.sliceHtml}</a>`:c+=E.sliceHtml,d=m+1+(I.customBlockLength+E.customBlockLength)});const g=A(d,n);return c+=g.sliceHtml,c}function BA(e){const t=e.body||{},{paragraphs:n=[],sectionBreaks:i=[]}=t;let{dataStream:s=""}=t;s.endsWith(`\r
`)||(s+=`\r
`,n.push({startIndex:s.length-2}),i.push({startIndex:s.length-1}),t.dataStream=s,t.paragraphs=n,t.sectionBreaks=i);const r={html:""},o=sd(s).sectionList;for(const a of o)Vt(a,e,r);return r.html}function Vt(e,t,n){var i,s;switch(e.nodeType){case $t.SECTION_BREAK:{for(const r of e.children)Vt(r,t,n);break}case $t.PARAGRAPH:{const{children:r,startIndex:o,endIndex:a}=e,l=(s=(i=t.body)==null?void 0:i.paragraphs.find(h=>h.startIndex===a))!=null?s:{},{paragraphStyle:d={}}=l,{spaceAbove:c,spaceBelow:A,lineSpacing:g}=d,u=[];if(c!=null&&(typeof c=="number"?u.push(`margin-top: ${c}px`):u.push(`margin-top: ${c.v}px`)),A!=null&&(typeof A=="number"?u.push(`margin-bottom: ${A}px`):u.push(`margin-bottom: ${A.v}px`)),g!=null&&u.push(`line-height: ${g}`),n.html+=`<p class="UniverNormal" ${u.length?`style="${u.join("; ")};"`:""}>`,r.length)for(const h of r)Vt(h,t,n);n.html+=`${TA(t,o,a)}</p>`;break}case $t.TABLE:{const{children:r}=e;n.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const o of r)Vt(o,t,n);n.html+="</tbody></table>";break}case $t.TABLE_ROW:{const{children:r}=e;n.html+='<tr class="UniverTableRow">';for(const o of r)Vt(o,t,n);n.html+="</tr>";break}case $t.TABLE_CELL:{const{children:r}=e;n.html+='<td class="UniverTableCell">';for(const o of r)Vt(o,t,n);n.html+="</td>";break}default:throw new Error(`Unknown node type: ${e.nodeType}`)}}class MA{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let n="";for(const i of de.deepClone(t))n+=BA(i);return n}}var wA=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},tn=(e,t)=>(n,i)=>t(n,i,e);Ri.use(yA);Ri.use(bA);Ri.use(RA);function NA(e,t,n){var i,s,r;const o=zo(e,t,n+2),a=k.TABLE_START+k.TABLE_ROW_START+k.TABLE_CELL_START+o.dataStream+k.TABLE_CELL_END+k.TABLE_ROW_END+k.TABLE_END;return o.dataStream=a,(i=o.textRuns)==null||i.forEach(l=>{const{st:d,ed:c}=l;l.st=d+3,l.ed=c+3}),(s=o.tables)==null||s.forEach(l=>{const{startIndex:d,endIndex:c}=l;l.startIndex=d+3,l.endIndex=c+3}),(r=o.paragraphs)==null||r.forEach(l=>{const{startIndex:d}=l;l.startIndex=d+3}),o}const Tt=Fo("doc.clipboard-service");let is=class extends pe{constructor(e,t,n,i,s){super(),y(this,"_clipboardHooks",[]),y(this,"_htmlToUDM",new Ri),y(this,"_umdToHtml",new MA),this._univerInstanceService=e,this._logService=t,this._commandService=n,this._clipboardInterfaceService=i,this._docSelectionManagerService=s}async copy(e=$i.copy,t){var n,i;const{newSnapshotList:s=[],needCache:r=!1,snapshot:o,ranges:a}=(n=this._getDocumentBodyInRanges(e,t))!=null?n:{};if(s.length===0||o==null)return!1;try{const l=!!((i=a?.[0])!=null&&i.segmentId);this._setClipboardData(s,!l&&r)}catch(l){return this._logService.error("[DocClipboardService] copy failed",l),!1}return!0}async cut(e){return this._cut(e)}async paste(e){const t=await this._genDocDataFromClipboardItems(e);return this._paste(t)}async legacyPaste(e){let{html:t,text:n,files:i}=e;const s=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC),r=s?.getUnitId()||"";if(!t&&!n&&i.length&&(t=await this._createImagePasteHtml(i)),!t&&!n)return this._logService.warn("[DocClipboardController] html and text cannot be both empty!"),!1;const o=this._genDocDataFromHtmlAndText(t,n,r);if(r===fi)if(n){const a=re.transform.fromPlainText(n);return this._paste({body:a})}else o.body.textRuns=[];return this._paste(o)}async _cut(e){var t,n,i,s,r;const o=(n=(t=e?.filter(A=>A.rangeType===De.TEXT))!=null?t:this._docSelectionManagerService.getTextRanges())!=null?n:[],a=(s=(i=e?.filter(A=>A.rangeType===De.RECT))!=null?i:this._docSelectionManagerService.getRectRanges())!=null?s:[],{segmentId:l,endOffset:d,style:c}=(r=o[0])!=null?r:{};if(l==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),o.length===0&&a.length===0)return!1;this.copy($i.cut,e);try{let A=0;if(a.length>0)A=Ws(o,a);else if(d!=null){A=d;for(const u of o){const{startOffset:h,endOffset:p}=u;h==null||p==null||p<=d&&(A-=p-h)}}const g=[{startOffset:A,endOffset:A,style:c}];return this._commandService.executeCommand(Yt.id,{segmentId:l,textRanges:g,rectRanges:a,selections:o})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(e){var t,n,i;const{body:s}=e;if(s==null)return!1;let r=Ul(s);if(!((t=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC))!=null&&t.getUnitId()))return!1;this._clipboardHooks.forEach(A=>{A.onBeforePaste&&(r=A.onBeforePaste(r))}),r.customRanges=(n=r.customRanges)==null?void 0:n.map(re.customRange.copyCustomRange),(i=r.paragraphs)==null||i.forEach(A=>{var g;(g=A.paragraphStyle)!=null&&g.headingId&&(A.paragraphStyle.headingId=ue(6))});const o=this._docSelectionManagerService.getActiveTextRange(),{segmentId:a,endOffset:l,style:d}=o||{},c=this._docSelectionManagerService.getTextRanges();if(a==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),l==null||c==null)return!1;try{let A=l;for(const u of c){const{startOffset:h,endOffset:p}=u;h==null||p==null||p<=l&&(A+=r.dataStream.length-(p-h))}const g=[{startOffset:A,endOffset:A,style:d}];return this._commandService.executeCommand(Aa.id,{doc:{...e,body:r},segmentId:a,textRanges:g})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(e,t=!0){var n,i,s,r;const o=IA(),a=(e.length>1?e.map(d=>{var c;return((c=d.body)==null?void 0:c.dataStream)||""}).join(`
`):((n=e[0].body)==null?void 0:n.dataStream)||"").replaceAll(k.TABLE_START,"").replaceAll(k.TABLE_END,"").replaceAll(k.TABLE_ROW_START,"").replaceAll(k.TABLE_ROW_END,"").replaceAll(k.TABLE_CELL_START,"").replaceAll(k.TABLE_CELL_END,"").replaceAll(`\r
`," ");let l=this._umdToHtml.convert(e);if(e.length===1&&t){l=l.replace(/(<[a-z]+)/,(A,g)=>`${g} data-copy-id="${o}"`);const d=e[0],c={body:d.body};if((s=(i=d.body)==null?void 0:i.customBlocks)!=null&&s.length){c.drawings={};for(const A of d.body.customBlocks){const{blockId:g}=A,u=(r=d.drawings)==null?void 0:r[g];if(u){const h=ue(6);A.blockId=h,c.drawings[h]={...de.deepClone(u),drawingId:h}}}}ki.set(o,c)}return this._clipboardInterfaceService.write(a,l)}addClipboardHook(e){return this._clipboardHooks.push(e),bn(()=>{const t=this._clipboardHooks.indexOf(e);t>-1&&this._clipboardHooks.splice(t,1)})}_getDocumentBodyInRanges(e,t){var n;const i=this._univerInstanceService.getCurrentUniverDocInstance(),s=t??this._docSelectionManagerService.getDocRanges(),r=[];let o=!0;if(i==null||s.length===0)return;const a=s[0].segmentId,l=(n=i?.getSelfOrHeaderFooterModel(a))==null?void 0:n.getBody(),d=i.getSnapshot();if(l!=null){for(const c of s){const{startOffset:A,endOffset:g,collapsed:u,rangeType:h}=c;if(u||A==null||g==null)continue;if(h===De.RECT){o=!1;const{spanEntireRow:m}=c;let C;C=NA(l,A,g),r.push(C);continue}const p={startOffset:A,endOffset:g},f=i.getSelfOrHeaderFooterModel(a).sliceBody(p.startOffset,p.endOffset,e);f!=null&&r.push(f)}return{newSnapshotList:r.map(c=>({...d,body:c})),needCache:o,snapshot:d,ranges:s}}}async _genDocDataFromClipboardItems(e){try{let t="",n="";const i=[];for(const s of e)for(const r of s.types)switch(r){case ia:{n=await s.getType(r).then(o=>o&&o.text());break}case na:{t=await s.getType(r).then(o=>o&&o.text());break}case Bd:case Td:case Od:case yd:{const o=await s.getType(r),a=new File([o],`pasted_image.${r.split("/")[1]}`,{type:r});i.push(a);break}}return!t&&!n&&i.length&&(t=await this._createImagePasteHtml(i)),this._genDocDataFromHtmlAndText(t,n)}catch(t){return Promise.reject(t)}}_genDocDataFromHtmlAndText(e,t,n){if(!e){if(t)return{body:re.transform.fromPlainText(t)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const i=CA(e);if(i){const r=ki.get(i);if(r)return r}if(!n){const r=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC);n=r?.getUnitId()||""}const s=this._htmlToUDM.convert(e,{unitId:n});return i&&ki.set(i,s),s}async _createImagePasteHtml(e){var t,n;const i={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},s=async a=>{const l=new FileReader;return new Promise(d=>{l.onloadend=function(){d({source:l.result,imageSourceType:ws.BASE64})},l.readAsDataURL(a)})},r=a=>{const l=new Image,d=500;return new Promise(c=>{l.src=typeof a=="string"?a:URL.createObjectURL(a),l.onload=()=>{const A=Math.min(d,l.naturalWidth),g=l.naturalHeight/l.naturalWidth;c({width:A,height:A*g})}})},o=(n=(t=this._clipboardHooks.find(a=>a.onBeforePasteImage))==null?void 0:t.onBeforePasteImage)!=null?n:s;return await Promise.all(e.map(async(a,l)=>{var d;const c=await o(a);if(!c)return Promise.resolve();const{width:A=100,height:g=100}=await r(a),u=`paste_image_id_${l}`,h=i.body,p=i.drawings;h.dataStream+="\b",(d=h.customBlocks)==null||d.push({startIndex:l,blockId:u}),p[u]={drawingId:u,unitId:"",subUnitId:"",imageSourceType:c.imageSourceType,title:"",source:c.source,description:"",layoutType:pi.INLINE,drawingType:Ms.DRAWING_IMAGE,transform:{width:A,height:g,angle:0},docTransform:{angle:0,size:{width:A,height:g},positionH:{relativeFrom:vi.CHARACTER,posOffset:0},positionV:{relativeFrom:ot.LINE,posOffset:0}}}})),this._umdToHtml.convert([i])}};is=wA([tn(0,U),tn(1,Ns),tn(2,T),tn(3,Xo),tn(4,W(Y))],is);function yi(e){return e.getContextValue(Rn)||e.getContextValue(qn)}const Ys=999,Xn={id:ud.id,name:"doc.command.copy",type:D.COMMAND,multi:!0,priority:Ys,preconditions:yi,handler:async e=>e.get(Tt).copy()},qs={id:"doc.command.copy-current-paragraph",type:D.COMMAND,handler:async e=>{const t=e.get(Tt),n=Mn(e);return n?t.copy($i.copy,[{startOffset:n.paragraphStart,endOffset:n.paragraphEnd+1,collapsed:!1}]):!1}},Ks={id:hd.id,name:"doc.command.cut",type:D.COMMAND,multi:!0,priority:Ys,preconditions:yi,handler:async e=>e.get(Tt).cut()},Zs={id:"doc.command.cut-current-paragraph",type:D.COMMAND,handler:async e=>{const t=e.get(Tt),n=Mn(e);return n?t.cut([{startOffset:n.paragraphStart,endOffset:n.paragraphEnd+1,collapsed:!1,rangeType:De.TEXT}]):!1}},Js={id:gd.id,name:"doc.command.paste",type:D.COMMAND,multi:!0,priority:Ys,preconditions:yi,handler:async e=>{const t=e.get(Tt),n=await e.get(Xo).read();return n.length===0?!1:t.paste(n)}},Oi={id:"doc.command.horizontal-line",type:D.COMMAND,handler:(e,t)=>e.get(T).syncExecuteCommand(Us.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:bl.SOLID},textRange:t?.insertRange})},Xs={id:"doc.command.insert-horizontal-line-bellow",type:D.COMMAND,handler:e=>{const t=e.get(T),n=Mn(e);return n?t.syncExecuteCommand(Oi.id,{insertRange:{startOffset:n.startIndex+1,endOffset:n.startIndex+1}}):!1}},Ea={id:"doc.command.select-all",type:D.COMMAND,handler:async e=>{var t;const n=e.get(U),i=e.get(Y),s=n.getCurrentUnitForType(N.UNIVER_DOC),r=i.getDocRanges(),o=(t=r.find(h=>h.isActive))!=null?t:r[0];if(s==null||o==null)return!1;const{segmentId:a}=o,l=s.getUnitId(),d=s.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null)return!1;const{tables:c=[],dataStream:A}=d;if(A===`\r
`)return!0;const g=[];let u=0;for(const h of c){const{startIndex:p,endIndex:f}=h;u!==p&&g.push({startOffset:u,endOffset:p-1,rangeType:De.TEXT}),g.push({startOffset:p+3,endOffset:f-5,rangeType:De.RECT}),u=f}return u!==d.dataStream.length-2&&g.push({startOffset:u,endOffset:d.dataStream.length-2,rangeType:De.TEXT}),i.replaceDocRanges(g,{unitId:l,subUnitId:l},!1),!0}};class Ti extends gt{constructor(t){super(),y(this,"_previousActiveRange",null),y(this,"_undoMutationParamsCache",[]),y(this,"_redoMutationParamsCache",[]),this._context=t}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:t=[],redoCache:n=[]}){this._undoMutationParamsCache=t,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(t){this._previousActiveRange=t}pushUndoRedoMutationParams(t,n){this._undoMutationParamsCache.push(t),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:t}=this._undoMutationParamsCache[0],n={unitId:t,actions:this._undoMutationParamsCache.reverse().reduce((i,s)=>V.compose(i,s.actions),null),textRanges:[]};return{redoMutationParams:{unitId:t,actions:this._redoMutationParamsCache.reduce((i,s)=>V.compose(i,s.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const Ia={id:"doc.command.ime-input",type:D.COMMAND,handler:async(e,t)=>{var n,i,s;const{unitId:r,newText:o,oldTextLen:a,isCompositionEnd:l,isCompositionStart:d}=t,c=e.get(T),A=e.get(ce),g=e.get(U),u=e.get(et),h=(n=A.getRenderById(r))==null?void 0:n.with(Ti),p=g.getUnit(r,N.UNIVER_DOC);if(p==null||h==null)return!1;const f=h.getActiveRange();if(f==null)return!1;const{style:m,segmentId:C}=f,v=p.getSelfOrHeaderFooterModel(C).getBody();if(v==null)return!1;Object.assign(f,f);const{startOffset:I,endOffset:E}=f,S=o.length,R=[{startOffset:I+S,endOffset:I+S,collapsed:!0,style:m}],b={id:X.id,params:{unitId:r,actions:[],textRanges:R}},x=u.getDefaultStyle(),O=u.getStyleCache(),w=Qs((i=v.customRanges)!=null?i:[],I+a,hn.includes(r)),P=Ci(v,d?E:I+a,x,O,hn.includes(r)),Q=Ps((s=v.customDecorations)!=null?s:[],I+a),H=new fe,_=V.getInstance();if(!f.collapsed&&d){const ee=re.selection.delete([f],v,0,null,!1);H.push(...ee),b.params.textRanges=[{startOffset:I+S,endOffset:I+S,collapsed:!0}]}else H.push({t:G.RETAIN,len:I});a>0&&H.push({t:G.DELETE,len:a}),H.push({t:G.INSERT,body:{dataStream:o,textRuns:P?[{...P,st:0,ed:o.length}]:[],customRanges:w?[{...w,startIndex:0,endIndex:o.length-1}]:[],customDecorations:Q.map(ee=>({...ee,startIndex:0,endIndex:o.length-1}))},len:o.length});const j=le(p,C);b.params.actions=_.editOp(H.serialize(),j),b.params.noHistory=!l,b.params.isCompositionEnd=l;const K=c.syncExecuteCommand(b.id,b.params);return h.pushUndoRedoMutationParams(K,b.params),!!K}};function je(e,t,n){return n.executeCommand(ft.id,{preCommandId:e,...t??{}})}const Kr="doc.command.set-inline-format-bold",Bt={id:Kr,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(Kr,t,n)}},Zr="doc.command.set-inline-format-italic",Mt={id:Zr,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(Zr,t,n)}},Jr="doc.command.set-inline-format-underline",wt={id:Jr,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(Jr,t,n)}},Xr="doc.command.set-inline-format-strikethrough",Nt={id:Xr,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(Xr,t,n)}},$r="doc.command.set-inline-format-subscript",pt={id:$r,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je($r,t,n)}},eo="doc.command.set-inline-format-superscript",_t={id:eo,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(eo,t,n)}},to="doc.command.set-inline-format-fontsize",tt={id:to,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(to,t,n)}},no="doc.command.set-inline-format-font-family",St={id:no,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(no,t,n)}},io="doc.command.set-inline-format-text-color",dt={id:io,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(io,t,n)}},so="doc.command.set-inline-format-text-background-color",At={id:so,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(so,t,n)}},ro="doc.command.reset-inline-format-text-background-color",wn={id:ro,type:D.COMMAND,handler:async(e,t)=>{const n=e.get(T);return je(ro,t,n)}},ss={[Bt.id]:"bl",[Mt.id]:"it",[wt.id]:"ul",[Nt.id]:"st",[tt.id]:"fs",[St.id]:"ff",[dt.id]:"cl",[At.id]:"bg",[wn.id]:"bg",[pt.id]:"va",[_t.id]:"va"},ft={id:"doc.command.set-inline-format",type:D.COMMAND,handler:async(e,t)=>{var n;const{value:i,preCommandId:s}=t,r=e.get(T),o=e.get(Y),a=e.get(U),l=e.get(et),d=o.getDocRanges(),c=(n=d.find(E=>E.isActive))!=null?n:d[0];if(d.length===0)return!1;const{segmentId:A}=d[0],g=a.getCurrentUnitForType(N.UNIVER_DOC);if(g==null)return!1;const u=g.getSelfOrHeaderFooterModel(A).getBody();if(u==null)return!1;const h=g.getUnitId();let p;switch(s){case Bt.id:case Mt.id:case wt.id:case Nt.id:case pt.id:case _t.id:{const E=l.getDefaultStyle(),S=Sa(u,c,E);p=DA(S,s);break}case tt.id:case St.id:{p=i;break}case dt.id:case At.id:{p={rgb:i};break}case wn.id:{p={rgb:null};break}default:throw new Error(`Unknown command: ${s} in handleInlineFormat`)}const f={id:X.id,params:{unitId:h,actions:[],textRanges:d}},m=new fe,C=V.getInstance(),v=new Ot;v.reset();for(const E of d){let{startOffset:S,endOffset:R,rangeType:b}=E;if(S==null||R==null)continue;if(b===De.RECT&&(S=S-1),S===R){const w=l.getStyleCache(),P=ss[s];l.setStyleCache({[P]:w?.[P]!==void 0?Ca(w,P,s):p});continue}const x={dataStream:"",textRuns:[{st:0,ed:R-S,ts:{[ss[s]]:p}}]},O=S-v.cursor;O!==0&&m.push({t:G.RETAIN,len:O}),m.push({t:G.RETAIN,body:x,len:R-S}),v.reset(),v.moveCursor(R)}const I=le(g,A);return f.params.actions=C.editOp(m.serialize(),I),!!r.syncExecuteCommand(f.id,f.params)}};function _A(e){return e!==null&&typeof e=="object"}function Ca(e,t,n){if(/bl|it/.test(t))return e?.[t]===z.TRUE?z.FALSE:z.TRUE;if(/ul|st/.test(t))return _A(e?.[t])&&(e?.[t]).s===z.TRUE?{s:z.FALSE}:{s:z.TRUE};if(/va/.test(t))return n===pt.id?e?.[t]===Qe.SUBSCRIPT?Qe.NORMAL:Qe.SUBSCRIPT:e?.[t]===Qe.SUPERSCRIPT?Qe.NORMAL:Qe.SUPERSCRIPT}function Sa(e,t,n){var i,s,r,o,a,l,d,c,A,g,u,h,p,f;const{startOffset:m,endOffset:C,collapsed:v}=t;if(v){const b=(i=e.textRuns)!=null?i:[];let x=null;for(let O=b.length-1;O>=0;O--){const w=b[O];if(w.st<m&&m<=w.ed){x=w;break}}return x!=null&&x.ts?{...n,...x.ts}:n}const{textRuns:I=[]}=zo(e,m,C),E=de.deepClone(n),S=I.map(b=>{var x;return(x=b?.ts)==null?void 0:x.fs}).filter(Boolean);E.fs=E.fs?Math.max(E.fs,...S):S.length?Math.max(...S):void 0,E.fs=!E.fs||Number.isNaN(E.fs)?void 0:E.fs,E.ff=(o=(r=(s=I.find(b=>{var x;return((x=b.ts)==null?void 0:x.ff)!=null}))==null?void 0:s.ts)==null?void 0:r.ff)!=null?o:E.ff,E.it=I.length&&I.every(b=>{var x;return((x=b.ts)==null?void 0:x.it)===z.TRUE})?z.TRUE:z.FALSE,E.bl=I.length&&I.every(b=>{var x;return((x=b.ts)==null?void 0:x.bl)===z.TRUE})?z.TRUE:z.FALSE,E.ul=I.length&&I.every(b=>{var x,O;return((O=(x=b.ts)==null?void 0:x.ul)==null?void 0:O.s)===z.TRUE})?(a=I[0].ts)==null?void 0:a.ul:E.ul,E.st=I.length&&I.every(b=>{var x,O;return((O=(x=b.ts)==null?void 0:x.st)==null?void 0:O.s)===z.TRUE})?(l=I[0].ts)==null?void 0:l.st:E.st,E.bg=(A=(c=(d=I.find(b=>{var x;return((x=b.ts)==null?void 0:x.bg)!=null}))==null?void 0:d.ts)==null?void 0:c.bg)!=null?A:E.bg,E.cl=(h=(u=(g=I.find(b=>{var x;return((x=b.ts)==null?void 0:x.cl)!=null}))==null?void 0:g.ts)==null?void 0:u.cl)!=null?h:E.cl;const R=I.filter(b=>{var x;return((x=b?.ts)==null?void 0:x.va)!=null});if(R.length>0&&R.length===I.length){const b=(p=R[0].ts)==null?void 0:p.va;let x=!0;for(let O=1;O<R.length;O++)if(((f=R[O].ts)==null?void 0:f.va)!==b){x=!1;break}x&&(E.va=b)}return E}function DA(e,t){const n=ss[t];return Ca(e,n,t)}const xa={id:"doc.command-replace-snapshot",type:D.COMMAND,handler:(e,t)=>{const{unitId:n,snapshot:i,textRanges:s,segmentId:r="",options:o}=t,a=e.get(U),l=e.get(T),d=e.get(Y),c=a.getUnit(n,N.UNIVER_DOC),A=c?.getSelfOrHeaderFooterModel(r).getSnapshot();if(c==null||A==null)return!1;const{body:g,tableSource:u,footers:h,headers:p,lists:f,drawings:m,drawingsOrder:C,documentStyle:v}=de.deepClone(i),{body:I,tableSource:E,footers:S,headers:R,lists:b,drawings:x,drawingsOrder:O,documentStyle:w}=A;if(g==null||I==null)return!1;if(de.diffValue(g,I)&&s)return d.replaceDocRanges(s,{unitId:n,subUnitId:n},!1),!0;const P={id:X.id,params:{unitId:n,actions:[],textRanges:s}};o&&(P.params.options=o);const Q=[],H=V.getInstance();if(!de.diffValue(w,v)){const _=H.replaceOp(["documentStyle"],w,v);_!=null&&Q.push(_)}if(!de.diffValue(g,I)){const _=H.replaceOp(["body"],I,g);_!=null&&Q.push(_)}if(!de.diffValue(u,E)){const _=H.replaceOp(["tableSource"],E,u);_!=null&&Q.push(_)}if(!de.diffValue(h,S)){const _=H.replaceOp(["footers"],S,h);_!=null&&Q.push(_)}if(!de.diffValue(p,R)){const _=H.replaceOp(["headers"],R,p);_!=null&&Q.push(_)}if(!de.diffValue(f,b)){const _=H.replaceOp(["lists"],b,f);_!=null&&Q.push(_)}if(!de.diffValue(m,x)){const _=H.replaceOp(["drawings"],x,m);_!=null&&Q.push(_)}if(!de.diffValue(C,O)){const _=H.replaceOp(["drawingsOrder"],O,C);_!=null&&Q.push(_)}return P.params.actions=Q.reduce((_,j)=>V.compose(_,j),null),!!l.syncExecuteCommand(P.id,P.params)}},QA={id:"doc.command-replace-content",type:D.COMMAND,handler:async(e,t)=>{const{unitId:n,body:i,textRanges:s,segmentId:r="",options:o}=t,a=e.get(U),l=e.get(T),d=e.get(Y),c=a.getUnit(n,N.UNIVER_DOC),A=c?.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(c==null||A==null)return!1;const g=ba(n,r,c,A,i);return g.params.textRanges=s,o&&(g.params.options=o),g.params.actions==null&&s?(d.replaceDocRanges(s,{unitId:n,subUnitId:n},!1),!0):!!l.syncExecuteCommand(g.id,g.params)}},PA={id:"doc.command-cover-content",type:D.COMMAND,handler:(e,t)=>{const{unitId:n,body:i,segmentId:s="",textRanges:r}=t,o=e.get(U),a=e.get(T),l=e.get(gi),d=o.getUniverDocInstance(n),c=d?.getSnapshot().body;if(d==null||c==null)return!1;const A=ba(n,s,d,c,i);return A.params.noNeedSetTextRange=!0,A.params.noHistory=!0,A.params.textRanges=r,a.syncExecuteCommand(A.id,A.params),l.clearUndoRedo(n),!0}};function UA(e,t,n,i){const s=new fe,r=V.getInstance(),o=n?.dataStream.length-2;o>0&&s.push({t:G.DELETE,len:o}),i.dataStream.length>0&&s.push({t:G.INSERT,body:i,len:i.dataStream.length});const a=le(t,e);return r.editOp(s.serialize(),a)}function ba(e,t,n,i,s){const r={id:X.id,params:{unitId:e,actions:[],textRanges:[]}},o=UA(t,n,i,s);return r.params.actions=o,r}const Ra={id:"doc.command.replace-selection",type:D.COMMAND,handler(e,t){var n;if(!t)return!1;const i=e.get(T),{unitId:s,body:r,textRanges:o}=t,a=e.get(U).getUnit(s),l=e.get(Y);if(!a)return!1;const d=a.getBody(),c=(n=t.selection)!=null?n:l.getActiveTextRange();if(!c||!d)return!1;const A={id:X.id,params:{unitId:s,actions:[],textRanges:o,debounce:!0}},g=new fe,u=V.getInstance();return g.push(...re.selection.delete([c],d,0,r)),A.params.actions=u.editOp(g.serialize()),i.syncExecuteCommand(A.id,A.params)}},LA={id:"doc.command.replace-text-runs",type:D.COMMAND,handler:(e,t)=>{const{unitId:n,body:i,textRanges:s,segmentId:r="",options:o}=t,a=e.get(U),l=e.get(T),d=e.get(ys),c=a.getUnit(n,N.UNIVER_DOC),A=c?.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(c==null||A==null)return!1;const g=re.selection.replaceTextRuns({doc:c,body:i,selection:{startOffset:0,endOffset:A.dataStream.length-2,collapsed:!1},themeService:d});if(!g)return!1;const u={id:X.id,params:{unitId:n,actions:[],textRanges:s,noHistory:!0}},h=V.getInstance(),p=le(c,r);return u.params.actions=h.editOp(g.serialize(),p),u.params.textRanges=s,o&&(u.params.options=o),!!l.syncExecuteCommand(u.id,u.params)}},HA={id:"doc.command.insert-custom-range",type:D.COMMAND,handler:(e,t)=>{if(!t)return!1;const n=e.get(T),{unitId:i,rangeId:s=ue(),textRanges:r,properties:o,text:a,wholeEntity:l}=t,d={unitId:i,textRanges:r,body:{dataStream:a,customRanges:[{startIndex:0,endIndex:a.length-1,rangeId:s,rangeType:Os.CUSTOM,properties:o,wholeEntity:l}]}};return n.syncExecuteCommand(Ra.id,d)}},Nn={id:"doc.command.list-operation",type:D.COMMAND,handler:(e,t)=>{var n,i,s,r,o,a;const l=e.get(Y),d=e.get(U),c=e.get(T),A=t.listType,g=d.getCurrentUnitForType(N.UNIVER_DOC),u=(i=(n=t.docRange)!=null?n:l.getDocRanges())!=null?i:[];if(g==null||u.length===0)return!1;const h=u[0].segmentId,p=g.getSelfOrHeaderFooterModel(h),f=(r=(s=p.getBody())==null?void 0:s.paragraphs)!=null?r:[],m=(a=(o=p.getBody())==null?void 0:o.dataStream)!=null?a:"";if(!f.length)return!1;const C=re.range.getParagraphsInRanges(u,f,m),v=g.getUnitId(),I={id:X.id,params:{unitId:v,actions:[],textRanges:u,isEditing:!1}};new Ot().reset();const E=re.paragraph.bullet.switch({paragraphs:C,listType:A,document:g,segmentId:h}),S=V.getInstance(),R=le(g,h);return I.params.actions=S.editOp(E.serialize(),R),!!c.syncExecuteCommand(I.id,I.params)}},Bi={id:"doc.command.change-list-type",type:D.COMMAND,handler:(e,t)=>{var n,i,s,r,o;const a=e.get(Y),l=e.get(U),d=e.get(T),{listType:c}=t,A=l.getCurrentUnitForType(N.UNIVER_DOC),g=(n=t.docRange)!=null?n:a.getDocRanges();if(A==null||g==null||!g.length)return!1;const{segmentId:u}=g[0],h=A.getSelfOrHeaderFooterModel(u),p=(s=(i=h.getBody())==null?void 0:i.paragraphs)!=null?s:[],f=(o=(r=h.getBody())==null?void 0:r.dataStream)!=null?o:"";if(!p.length)return!1;const m=re.range.getParagraphsInRanges(g,p,f),C=A.getUnitId(),v=re.paragraph.bullet.set({paragraphs:m,listType:c,segmentId:u,document:A});if(!v)return!1;const I=V.getInstance(),E={id:X.id,params:{unitId:C,actions:[],textRanges:g,isEditing:!1}},S=le(A,u);return E.params.actions=I.editOp(v.serialize(),S),!!d.syncExecuteCommand(E.id,E.params)}};var jn=(e=>(e[e.increase=1]="increase",e[e.decrease=-1]="decrease",e))(jn||{});const rs={id:"doc.command.change-list-nesting-level",type:D.COMMAND,handler:(e,t)=>{var n,i,s,r,o;if(!t)return!1;const{type:a}=t,l=e.get(Y),d=e.get(U),c=e.get(T),A=d.getCurrentUnitForType(N.UNIVER_DOC),g=l.getActiveTextRange();if(A==null||g==null)return!1;const{segmentId:u}=g,h=(n=l.getDocRanges())!=null?n:[],p=A.getSelfOrHeaderFooterModel(u),f=(s=(i=p.getBody())==null?void 0:i.paragraphs)!=null?s:[],m=(o=(r=p.getBody())==null?void 0:r.dataStream)!=null?o:"";if(!f.length)return!1;const C=re.range.getParagraphsInRange(g,f,m),v=A.getUnitId(),I=V.getInstance(),E=re.paragraph.bullet.changeNestLevel({paragraphs:C,type:a,segmentId:u,document:A}),S={id:X.id,params:{unitId:v,actions:[],textRanges:h,isEditing:!1}},R=le(A,u);return S.params.actions=I.editOp(E.serialize(),R),!!c.syncExecuteCommand(S.id,S.params)}},In={id:"doc.command.bullet-list",type:D.COMMAND,handler:(e,t)=>{const n=e.get(T);return t!=null&&t.value?n.syncExecuteCommand(Bi.id,{listType:t.value,docRange:t.docRange}):n.syncExecuteCommand(Nn.id,{listType:Se.BULLET_LIST,docRange:t?.docRange})}},$n={id:"doc.command.check-list",type:D.COMMAND,handler:(e,t)=>{const n=e.get(T);return t!=null&&t.value?n.syncExecuteCommand(Bi.id,{listType:t.value,docRange:t.docRange}):n.syncExecuteCommand(Nn.id,{listType:Se.CHECK_LIST,docRange:t?.docRange})}},ya={id:"doc.command.toggle-check-list",type:D.COMMAND,handler:(e,t)=>{var n;if(!t)return!1;const i=e.get(U),s=e.get(T),{index:r,segmentId:o,textRanges:a}=t,l=i.getCurrentUnitForType(N.UNIVER_DOC);if(l==null||((n=l.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:n.paragraphs)==null)return!1;const d=l.getUnitId(),c={id:X.id,params:{unitId:d,actions:[],textRanges:a??[],segmentId:o,isEditing:!1}},A=re.paragraph.bullet.toggleChecklist({document:l,paragraphIndex:r,segmentId:o});if(!A)return!1;const g=V.getInstance(),u=le(l,o);return c.params.actions=g.editOp(A.serialize(),u),!!s.syncExecuteCommand(c.id,c.params)}},Cn={id:"doc.command.order-list",type:D.COMMAND,handler:(e,t)=>{const n=e.get(T);return t!=null&&t.value?n.syncExecuteCommand(Bi.id,{listType:t.value}):n.syncExecuteCommand(Nn.id,{listType:Se.ORDER_LIST})}},Oa={id:"doc.command.quick-list",type:D.COMMAND,handler(e,t){var n,i,s;if(!t)return!1;const r=e.get(Y),o=e.get(U),a=e.get(T),l=o.getCurrentUnitForType(N.UNIVER_DOC),d=r.getActiveTextRange();if(l==null||d==null)return!1;const{segmentId:c,startOffset:A}=d,{listType:g,paragraph:u}=t,{paragraphStart:h,paragraphEnd:p}=u,f=new fe,m=V.getInstance(),{paragraphStyle:C={}}=u,v=(Rl[g].nestingLevel[0].paragraphProperties||{}).textStyle;let I=ue(6);const E=(i=(n=l.getBody())==null?void 0:n.paragraphs)!=null?i:[],S=E.findIndex(w=>w.startIndex===u.startIndex),R=E[S-1],b=E[S+1];R&&R.bullet&&R.bullet.listType.indexOf(g)===0?I=R.bullet.listId:b&&b.bullet&&b.bullet.listType.indexOf(g)===0&&(I=b.bullet.listId);const x={id:X.id,params:{unitId:l.getUnitId(),actions:[],textRanges:[{startOffset:h,endOffset:h,collapsed:!0}],isEditing:!1}};f.push({t:G.RETAIN,len:h}),f.push({t:G.DELETE,len:A-h}),p>A&&f.push({t:G.RETAIN,len:p-A}),f.push({t:G.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...C,textStyle:{...C.textStyle,...v},indentFirstLine:void 0},bullet:{...(s=u.bullet)!=null?s:{nestingLevel:0,textStyle:{fs:20}},listType:g,listId:I}}]}});const O=le(l,c);return x.params.actions=m.editOp(f.serialize(),O),!!a.syncExecuteCommand(x.id,x.params)}};function $s(e,t){var n,i;const s=e.get(T),r=Mn(e);if(!r)return!1;const o=e.get(U).getCurrentUnitOfType(N.UNIVER_DOC);if(!o)return!1;const a=re.selection.replace({doc:o,selection:{startOffset:r.startIndex+1,endOffset:r.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...r.paragraphStyle},bullet:{listType:t,listId:((n=r.bullet)==null?void 0:n.listType)===t?r.bullet.listId:ue(6),nestingLevel:((i=r.bullet)==null?void 0:i.listType)===t?r.bullet.nestingLevel:0}}]}});if(!a)return!1;const l={id:X.id,params:{unitId:o.getUnitId(),actions:[],textRanges:[{startOffset:r.startIndex+1,endOffset:r.startIndex+1,collapsed:!0}],isEditing:!1}},d=V.getInstance(),c=le(o);return l.params.actions=d.editOp(a.serialize(),c),!!s.syncExecuteCommand(l.id,l.params)}const er={id:"doc.command.insert-bullet-list-bellow",type:D.COMMAND,handler:e=>$s(e,Se.BULLET_LIST)},tr={id:"doc.command.insert-order-list-bellow",type:D.COMMAND,handler:e=>$s(e,Se.ORDER_LIST)},nr={id:"doc.command.insert-check-list-bellow",type:D.COMMAND,handler:e=>$s(e,Se.CHECK_LIST)},nt={id:"doc.command.align-action",type:D.COMMAND,handler:(e,t)=>{var n,i,s,r;const o=e.get(Y),a=e.get(U),l=e.get(T),{alignType:d}=t,c=a.getCurrentUniverDocInstance();if(c==null)return!1;const A=o.getDocRanges();if(A.length===0)return!1;const g=A[0].segmentId,u=c.getSelfOrHeaderFooterModel(g),h=(i=(n=u.getBody())==null?void 0:n.paragraphs)!=null?i:[],p=(r=(s=u.getBody())==null?void 0:s.dataStream)!=null?r:"";if(h==null)return!1;const f=re.range.getParagraphsInRanges(A,h,p),m=c.getUnitId(),C=f.every(b=>{var x;return((x=b.paragraphStyle)==null?void 0:x.horizontalAlign)===d}),v={id:X.id,params:{unitId:m,actions:[],textRanges:A}},I=new Ot;I.reset();const E=new fe,S=V.getInstance();for(const b of f){const{startIndex:x}=b;E.push({t:G.RETAIN,len:x-I.cursor});const O={...b.paragraphStyle,horizontalAlign:C?Ne.UNSPECIFIED:d};E.push({t:G.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...b,paragraphStyle:O,startIndex:0}]},coverType:Kt.REPLACE}),I.moveCursorTo(x+1)}const R=le(c,g);return v.params.actions=S.editOp(E.serialize(),R),!!l.syncExecuteCommand(v.id,v.params)}},Mi={id:"doc.command.align-left",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(nt.id,{alignType:Ne.LEFT})},wi={id:"doc.command.align-center",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(nt.id,{alignType:Ne.CENTER})},Ni={id:"doc.command.align-right",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(nt.id,{alignType:Ne.RIGHT})},_i={id:"doc.command.align-justify",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(nt.id,{alignType:Ne.JUSTIFIED})},kA=(e,t)=>{const n=e.get(U).getUnit(t.unitId,N.UNIVER_DOC);return n?.setZoomRatio(t.zoomRatio),{...t}},Ge={id:"doc.operation.set-zoom-ratio",type:D.OPERATION,handler:(e,t)=>{const n=e.get(U).getUnit(t.unitId,N.UNIVER_DOC);return n?(n.setZoomRatio(t.zoomRatio),!0):!1}},Wn={type:D.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(e,t)=>{var n,i,s;const r=e.get(T),o=e.get(gi),a=e.get(U);let l=(n=a.getCurrentUniverDocInstance())==null?void 0:n.getUnitId();if(!l)return!1;let d=1;if(t&&(l=(i=t.documentId)!=null?i:l,d=(s=t.zoomRatio)!=null?s:d),!a.getUniverDocInstance(l))return!1;const c={zoomRatio:d,unitId:l},A=kA(e,c);return r.syncExecuteCommand(Ge.id,c)?(o.pushUndoRedo({unitID:l,undoMutations:[{id:Ge.id,params:A}],redoMutations:[{id:Ge.id,params:c}]}),!0):!1}},We={id:"doc.command.set-paragraph-named-style",type:D.COMMAND,handler(e,t){var n;if(!t)return!1;const i=e.get(U).getCurrentUnitOfType(N.UNIVER_DOC);if(!i)return!1;const s=i.getUnitId(),r=e.get(Y),o=(n=t.textRanges)!=null?n:r.getTextRanges({unitId:s,subUnitId:s});if(!(o!=null&&o.length))return!1;const a=o[0].segmentId,l=re.paragraph.style.set({document:i.getSelfOrHeaderFooterModel(a),textRanges:o,style:{namedStyleType:t.value,headingId:!t.value||t.value===q.NORMAL_TEXT?void 0:ue(6),spaceAbove:void 0,spaceBelow:void 0,lineSpacing:void 0},paragraphTextRun:{}}),d={id:X.id,params:{actions:[],textRanges:o,unitId:s,segmentId:a}},c=V.getInstance(),A=le(i,a);return d.params.actions=c.editOp(l.serialize(),A),!!e.get(T).syncExecuteCommand(d.id,d.params)}},Ta={id:"doc.command.quick-heading",type:D.COMMAND,handler(e,t){var n,i,s,r;if(!t)return!1;const{value:o}=t,a=e.get(Y),l=e.get(U),d=e.get(T),c=l.getCurrentUnitForType(N.UNIVER_DOC),A=a.getActiveTextRange();if(c==null||A==null||!A.collapsed)return!1;const{segmentId:g,startOffset:u}=A,h=c.getSelfOrHeaderFooterModel(g),p=(i=(n=h.getBody())==null?void 0:n.paragraphs)!=null?i:[],f=(r=(s=h.getBody())==null?void 0:s.dataStream)!=null?r:"",m=re.paragraph.util.getParagraphsInRange(A,p,f)[0];if(!m)return!1;const{paragraphStart:C}=m,v=new fe,I=V.getInstance(),{paragraphStyle:E={}}=m,S={id:X.id,params:{unitId:c.getUnitId(),actions:[],textRanges:[{startOffset:C,endOffset:C,collapsed:!0}],isEditing:!1}};v.push({t:G.RETAIN,len:C}),re.paragraph.style.set({textRanges:[A],document:c,style:{...E,headingId:ue(6),namedStyleType:o},cursor:u,deleteLen:u-C,textX:v,paragraphTextRun:{}});const R=le(c,g);return S.params.actions=I.editOp(v.serialize(),R),!!d.syncExecuteCommand(S.id,S.params)}},Vi={"#":q.HEADING_1,"##":q.HEADING_2,"###":q.HEADING_3,"####":q.HEADING_4,"#####":q.HEADING_5},ir={id:"doc.command.h1-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.HEADING_1})},sr={id:"doc.command.h2-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.HEADING_2})},rr={id:"doc.command.h3-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.HEADING_3})},or={id:"doc.command.h4-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.HEADING_4})},ar={id:"doc.command.h5-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.HEADING_5})},ei={id:"doc.command.normal-text-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.NORMAL_TEXT})},Ba={id:"doc.command.title",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.TITLE})},Ma={id:"doc.command.subtitle-heading",type:D.COMMAND,handler:e=>e.get(T).syncExecuteCommand(We.id,{value:q.SUBTITLE})};var zn=(e=>(e[e.page=0]="page",e[e.section=1]="section",e[e.column=2]="column",e[e.line=3]="line",e[e.divide=4]="divide",e[e.glyph=5]="glyph",e))(zn||{});const jt={page:0,section:1,column:2,line:3,divide:4,glyph:5};function lr(e,t){return e.page>t.page?!1:e.page<t.page?!0:e.section>t.section?!1:e.section<t.section?!0:e.column>t.column?!1:e.column<t.column?!0:e.line>t.line?!1:e.line<t.line?!0:e.divide>t.divide?!1:e.divide<t.divide?!0:e.glyph>t.glyph?!1:(e.glyph<t.glyph,!0)}function os(e,t){return lr(e,t)?{start:e,end:t}:{start:t,end:e}}function oo(e){const t=e.length;if(t===0)return;const n=e[0],i=e[t-1],s=e.length===1&&n.collapsed;return{startOffset:n.startOffset,endOffset:i.endOffset,collapsed:s}}function FA(e,t,n,i){let s=i,r=i;for(let o=0;o<e.length;o++){const a=e[o].count;o<t&&(s+=a),o<n&&(r+=a)}return{startOffset:s,endOffset:r}}function as(e){const{startX:t,startY:n,endX:i,endY:s}=e,r=[];return r.push({x:t,y:n}),r.push({x:i,y:n}),r.push({x:i,y:s}),r.push({x:t,y:s}),r.push({x:t,y:n}),r}class ct{constructor(t,n){y(this,"_liquid",new Yo),y(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),y(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0}),this._documentOffsetConfig=t,this._docSkeleton=n}getRangePointData(t,n){const i=[],s=[],r=[];if(t==null||n==null)return{borderBoxPointGroup:i,contentBoxPointGroup:s,cursorList:r};if(!this._isValidPosition(t,n))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:o,end:a}=os(t,n);return this._selectionIterator(o,a,(l,d,c,A,g,u)=>{const{lineHeight:h,asc:p,paddingTop:f,marginTop:m,marginBottom:C}=u,{glyphGroup:v,st:I}=g;if(v.length===0)return;const{x:E,y:S}=this._liquid;let R,b;const x=v[l],O=v[d],w=v[l-1],P=x?.left||0,Q=x?.width||0,H=O?.left||0,_=O?.width||0,j=x?.glyphType===Go.LIST,{startOffset:K,endOffset:ee}=FA(v,l,d,I),L=o.glyph===l&&c?o.isBack:!0,F=a.glyph===d&&A?a.isBack:!1,ie=o===a,Ae=L&&w!=null?w:x;if(l===0&&d===v.length-1)R={startX:E+P+(j?Q:0),startY:S,endX:E+H+(F?0:_),endY:S+h-m-C},b={startX:E+P+(j?Q:0),startY:S+f+p-Ae.bBox.ba,endX:E+H+(F?0:_),endY:S+f+p+Ae.bBox.bd};else{const ge=L&&!j;R={startX:E+P+(ge?0:Q),startY:S,endX:E+H+(F?0:_),endY:S+h-m-C},b={startX:E+P+(ge?0:Q),startY:S+f+p-Ae.bBox.ba,endX:E+H+(F?0:_),endY:S+f+p+Ae.bBox.bd}}i.push(as(R)),s.push(as(b)),r.push({startOffset:L?K:K+x.count,endOffset:F?ee:ee+O.count,collapsed:ie})}),{borderBoxPointGroup:i,contentBoxPointGroup:s,cursorList:r}}_isValidPosition(t,n){const{segmentPage:i,pageType:s}=t,{segmentPage:r,pageType:o}=n;return s!==o?!1:s===be.HEADER||s===be.FOOTER?i===r:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,n,i,s){s===n?this._currentStartState[t]=1:this._currentStartState[t]=0,s===i?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,n=!0){let i=t,s;for(;i>=0;){const r=zn[i];let o;if(n?o=this._currentStartState[r]:o=this._currentEndState[r],o===void 0)return;if(s===void 0&&(s=o),o!==s)return 0;i--}return s}_getSelectionRuler(t,n,i,s,r){let o=0,a=s;const l=zn[t],d=zn[t+1];if(d===null||l===null)return{start_next:o,end_next:a};const c=n[l],A=i[l];this._setNodePositionState(l,c,A,r);const g=this._checkPreviousNodePositionState(t),u=this._checkPreviousNodePositionState(t,!1);return g===1&&(o=n[d]),u===2&&(a=i[d]),{start_next:o,end_next:a}}_selectionIterator(t,n,i){var s,r;const o=this._docSkeleton;if(!o)return[];const{pageType:a,path:l}=t;this._liquid.reset();const d=o.getSkeletonData();if(d==null)return[];const{pages:c,skeHeaders:A,skeFooters:g}=d,{page:u,segmentPage:h}=t,{page:p,segmentPage:f}=n;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:m,pageMarginLeft:C,pageMarginTop:v}=this._documentOffsetConfig,I=a===be.BODY||a===be.CELL?u:h;for(let S=0;S<I;S++){const R=c[S];this._liquid.translatePage(R,m,C,v)}const E=a===be.BODY||a===be.CELL?p:f;for(let S=I;S<=E;S++){const R=c[S],{headerId:b,footerId:x,pageWidth:O}=R;let w=R;if(a===be.HEADER?w=(s=A.get(b))==null?void 0:s.get(O):a===be.FOOTER?w=(r=g.get(x))==null?void 0:r.get(O):a===be.CELL&&(w=ts(d,l)),w==null){this._liquid.translatePage(R,m,C,v);continue}const P=w.sections,{start_next:Q,end_next:H}=this._getSelectionRuler(jt.page,t,n,P.length-1,a===be.BODY||a===be.CELL?S:0);switch(this._liquid.translateSave(),a){case be.HEADER:this._liquid.translatePagePadding({...w,marginLeft:R.marginLeft});break;case be.FOOTER:{const _=R.pageHeight-w.height-w.marginBottom;this._liquid.translate(R.marginLeft,_);break}case be.CELL:{this._liquid.translatePagePadding(R);const _=w.parent,j=_.parent,{left:K}=w,{top:ee,left:L}=j,{top:F}=_;this._liquid.translate(L+K,ee+F),this._liquid.translatePagePadding(w);break}default:this._liquid.translatePagePadding(R);break}for(let _=Q;_<=H;_++){const j=P[_],K=j.columns,{start_next:ee,end_next:L}=this._getSelectionRuler(jt.section,t,n,K.length-1,_);this._liquid.translateSection(j);for(let F=ee;F<=L;F++){const ie=K[F],Ae=ie.lines,{start_next:ge,end_next:se}=this._getSelectionRuler(jt.column,t,n,Ae.length-1,F);this._liquid.translateColumn(ie);for(let ve=ge;ve<=se;ve++){const Oe=Ae[ve],{divides:Le}=Oe,{start_next:Qt,end_next:Dn}=this._getSelectionRuler(jt.line,t,n,Le.length-1,ve);this._liquid.translateSave(),this._liquid.translateLine(Oe,!0,!1);for(let Pt=Qt;Pt<=Dn;Pt++){const Pi=Le[Pt];this._liquid.translateSave(),this._liquid.translateDivide(Pi);const{glyphGroup:ml}=Pi,{start_next:vl,end_next:El}=this._getSelectionRuler(jt.divide,t,n,ml.length-1,Pt);let yr=!1,Or=!1;S===I&&_===Q&&F===ee&&ve===ge&&Pt===Qt&&(yr=!0),S===E&&_===H&&F===L&&ve===se&&Pt===Dn&&(Or=!0),i&&i(vl,El,yr,Or,Pi,Oe,ie,j,w),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(R,m,C,v)}}}function VA(e,t){const{path:n}=e,{path:i}=t;if(n.length!==i.length||n.indexOf("cells")===-1)return!1;const s=n.indexOf("skeTables")+1,r=n.indexOf("rows")+1,o=n.indexOf("cells")+1,{tableId:a,sliceIndex:l}=Qr(n[s]),{tableId:d,sliceIndex:c}=Qr(i[s]);if(a!==d)return!1;const A=n[r],g=i[r],u=n[o],h=i[o];return!(A===g&&u===h&&l===c)}function wa(e,t){const{path:n}=e,{path:i}=t;return n.indexOf("cells")===-1||i.indexOf("cells")===-1||n.length!==i.length?!1:de.diffValue(n,i)}function Na(e,t,n){var i,s,r,o,a,l,d,c;const{path:A}=t,{path:g}=n;if(A.indexOf("cells")===-1||g.indexOf("cells")===-1)return!1;const u=e.findGlyphByPosition(t),h=e.findGlyphByPosition(n),p=(o=(r=(s=(i=u?.parent)==null?void 0:i.parent)==null?void 0:s.parent)==null?void 0:r.parent)==null?void 0:o.parent,f=(c=(d=(l=(a=h?.parent)==null?void 0:a.parent)==null?void 0:l.parent)==null?void 0:d.parent)==null?void 0:c.parent;if(p==null||f==null)return!1;const m=p.parent,C=f.parent,v=m.cells.indexOf(p),I=C.cells.indexOf(f);return v===I&&m.index===C.index}function ji(e,t){if(wa(e,t))return lr(e,t);const{path:n}=e,{path:i}=t,s=n[n.length-5],r=i[i.length-5];if(s!==r&&typeof s=="string"&&typeof r=="string"){const c=s.split("#-#")[1],A=r.split("#-#")[1];return+c<+A}const o=n[n.length-3],a=i[i.length-3],l=n[n.length-1],d=i[i.length-1];return o<a?!0:o>a?!1:l<=d}function Lt(e){return e.sections[0].columns[0].lines.length===0}function jA(e,t,n){let i=t,s=n,r=e[i],o=e[s];for(;i<s&&(Lt(r)||Lt(o));)Lt(r)?(i++,r=e[i]):Lt(o)&&(s--,o=e[s]);if(!Lt(r)&&!Lt(o))return[r,o]}class _a{constructor(t,n){y(this,"_liquid",new Yo),this._documentOffsetConfig=t,this._docSkeleton=n}getRangePointData(t,n){const i=[],s=this._docSkeleton.getSkeletonData();if(s==null)return;const{pages:r}=s,{segmentPage:o,page:a,pageType:l}=t,d=this._getTableRectRangeInfo(t,n);if(d==null)return;const{tableId:c,startRowIndex:A,startColumnIndex:g,endRowIndex:u,endColumnIndex:h}=d;this._liquid.reset();const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:m}=this._documentOffsetConfig,C=l===be.BODY||l===be.CELL?a:o;for(let v=0;v<C;v++){const I=r[v];this._liquid.translatePage(I,p,f,m)}for(let v=C;v<r.length;v++){const I=r[v];this._liquid.translatePagePadding(I);const{skeTables:E}=I;let S=null;for(const[O,w]of E.entries())O.startsWith(c)&&(S=w);if(S==null){this._liquid.restorePagePadding(I),this._liquid.translatePage(I,p,f,m);continue}this._liquid.translateSave(),this._liquid.translate(0,S.top);const{x:R,y:b}=this._liquid,{left:x}=S;for(const O of S.rows)if(O.index>=A&&O.index<=u){const w=jA(O.cells,g,h);if(w==null)continue;const[P,Q]=w,H={startX:R+P.left+x,startY:b+O.top,endX:R+Q.left+Q.pageWidth+x,endY:b+O.top+O.height};i.push(as(H))}this._liquid.translateRestore(),this._liquid.restorePagePadding(I),this._liquid.translatePage(I,p,f,m)}return{pointGroup:i,startRow:A,startColumn:g,endRow:u,endColumn:h,tableId:c}}getNodePositionGroup(t,n){const i=[],s=this._docSkeleton.findCharIndexByPosition(t),r=this._docSkeleton.findCharIndexByPosition(n);if(s==null||r==null)return;const o=s<r,a=this._getTableRectRangeInfo(t,n);if(a==null)return;const{tableId:l,startRowIndex:d,startColumnIndex:c,endRowIndex:A,endColumnIndex:g}=a,u=this._docSkeleton.getViewModel().findTableNodeById(l);if(u==null)return;const h=u.children[0].children.length;if(c===0&&g===h-1){const p=u.children[d].children[c],f=this._docSkeleton.findNodePositionByCharIndex(p.startIndex+1),m=u.children[A].children[g],C=this._docSkeleton.findNodePositionByCharIndex(m.endIndex-2);if(f==null||C==null)return;i.push({anchor:o?f:C,focus:o?C:f})}else for(let p=d;p<=A;p++){const f=u.children[p],m=f.children[c],C=f.children[g],v=this._docSkeleton.findNodePositionByCharIndex(m.startIndex+1),I=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(v==null||I==null)return;i.push({anchor:o?v:I,focus:o?I:v})}return i}_getTableRectRangeInfo(t,n){const i=this._docSkeleton.getSkeletonData();if(i==null)return;const{pages:s}=i,{path:r}=t,{path:o}=n,a=ts(i,r),l=ts(i,o);if(a==null||l==null)return;const d=a.segmentId,c=a.parent.index,A=a.parent.cells.indexOf(a),g=(l?.parent).index,u=(l?.parent).cells.indexOf(l),h=Math.min(c,g),p=Math.max(c,g),f=Math.min(A,u),m=Math.max(A,u);return{pages:s,tableId:d,startRowIndex:h,startColumnIndex:f,endRowIndex:p,endColumnIndex:m}}}const WA="__TestSelectionRange__",zA="__TestSelectionAnchor__",ao=6,Wi=500,GA=500,ls=3;function Gn(e){const t=e[0],n=t[0],i=t[2],{x:s,y:r}=n,{x:o,y:a}=i;return{left:s,top:r,width:o-s,height:a-r}}function dr(e){return e.map(t=>{let n=1/0,i=-1/0,s=1/0,r=-1/0;return t.forEach(o=>{n=Math.min(o.x,n),i=Math.max(o.x,i),r=Math.max(o.y,r),s=Math.min(o.y,s)}),{left:n,right:i,top:s,bottom:r}})}class zt{constructor(t,n,i,s,r,o=gn,a="",l=-1){y(this,"rangeType",De.TEXT),y(this,"_current",!1),y(this,"_rangeShape"),y(this,"_anchorShape"),y(this,"_cursorList",[]),y(this,"_anchorBlinkTimer",null),this._scene=t,this._document=n,this._docSkeleton=i,this.anchorNodePosition=s,this.focusNodePosition=r,this.style=o,this._segmentId=a,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Wi),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Wi))},GA+Wi)}get startOffset(){var t;const{startOffset:n}=(t=oo(this._cursorList))!=null?t:{},i=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(n==null||i==null)return n;const s=i.dataStream.length-2;return Math.min(s,n)}get endOffset(){var t;const{endOffset:n}=(t=oo(this._cursorList))!=null?t:{},i=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(n==null||i==null)return n;const s=i.dataStream.length-2;return Math.min(n,s)}get collapsed(){const{startOffset:t,endOffset:n}=this;return t!=null&&t===n}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=os(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=os(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:n,focusNodePosition:i}=this;return t||n==null||i==null?ye.NONE:lr(n,i)?ye.FORWARD:ye.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,n=this.focusNodePosition;if(this._isEmpty())return;const i=this._document.getOffsetConfig(),{docsLeft:s,docsTop:r}=i,o=new ct(i,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:c,cursorList:A}=o.getRangePointData(t,t);if(this._setCursorList(A),c.length===0)return;const g=Gn(c);return{...g,left:g.left+s,top:g.top+r}}const{borderBoxPointGroup:a,cursorList:l}=o.getRangePointData(t,n);if(this._setCursorList(l),a.length===0)return;const d=Gn(a);return{...d,left:d.left+s,top:d.top+r}}getAnchor(){return this._anchorShape}activeStatic(){var t,n;(n=this._anchorShape)==null||n.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||dn(ln.black,1)})}deactivateStatic(){var t,n;(n=this._anchorShape)==null||n.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||dn(ln.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,n;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(n=this._anchorShape)==null||n.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:n,endOffset:i}=this,{startOffset:s,endOffset:r}=t;return n==null||i==null||s==null||r==null?!1:n<=r&&i>=s}refresh(){var t,n;const{_document:i,_docSkeleton:s}=this,r=this.anchorNodePosition,o=this.focusNodePosition;if((t=this._anchorShape)==null||t.hide(),(n=this._rangeShape)==null||n.hide(),this._isEmpty())return;const a=i.getOffsetConfig(),{docsLeft:l,docsTop:d}=a,c=new ct(a,s);if(this._isCollapsed()){const{contentBoxPointGroup:u,cursorList:h}=c.getRangePointData(r,r);if(this._setCursorList(h),u.length>0){const p=s.findGlyphByPosition(r);this._createOrUpdateAnchor(u,l,d,p)}return}const{borderBoxPointGroup:A,cursorList:g}=c.getRangePointData(r,o);this._setCursorList(g),A.length>0&&this._createOrUpdateRange(A,l,d)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,n=this.focusNodePosition;if(t!=null&&n==null)return!0;if(t==null||n==null)return!1;const i=Object.keys(jt);for(const s of i){const r=t[s],o=n[s];if(r!==o)return!1}return t.isBack===n.isBack}_createOrUpdateRange(t,n,i){var s;if(this._rangeShape){this._rangeShape.translate(n,i),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const r=.3,o=new qo(WA+ue(ao),{pointsGroup:t,fill:((s=this.style)==null?void 0:s.fill)||dn(ln.black,r),left:n,top:i,evented:!1,debounceParentDirty:!1});this._rangeShape=o,this._scene.addObject(o,ls)}_createOrUpdateAnchor(t,n,i,s){var r,o,a;const l=Gn(t),{left:d}=l;let{top:c,height:A}=l;const g=14;A<g&&(c-=g-A,A=g);const u=12;let h=d+n;const p=c+i,f=((r=s?.ts)==null?void 0:r.it)===z.TRUE;if(f&&(h+=A*Math.tan(u*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:h,top:p,height:A}),this._anchorShape.show(),f?this._anchorShape.skew(-u,0):this._anchorShape.skew(0,0);return}const m=new Vn(zA+ue(ao),{left:h,top:p,height:A,strokeWidth:((o=this.style)==null?void 0:o.strokeWidth)||1,stroke:((a=this.style)==null?void 0:a.strokeActive)||dn(ln.black,1),evented:!1});f&&m.skew(-u,0),this._anchorShape=m,this._scene.addObject(m,ls),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const YA="__DocTableRectRange__",qA=6;function zi(e,t,n,i,s,r=gn,o="",a=-1){const l=t.getOffsetConfig(),d=new _a(l,n).getNodePositionGroup(i,s);return(d??[]).map(c=>new Da(e,t,n,c.anchor,c.focus,r,o,a))}class Da{constructor(t,n,i,s,r,o=gn,a="",l=-1){y(this,"rangeType",De.RECT),y(this,"_rangeShape"),y(this,"_current",!1),y(this,"_startRow"),y(this,"_startCol"),y(this,"_endRow"),y(this,"_endCol"),y(this,"_tableId"),this._scene=t,this._document=n,this._docSkeleton=i,this.anchorNodePosition=s,this.focusNodePosition=r,this.style=o,this._segmentId=a,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var t;const n=(t=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:t[this._tableId],{_startCol:i,_endCol:s}=this;if(n==null)throw new Error("Table is not found.");const{tableColumns:r}=n;return i===0&&s===r.length-1}get spanEntireColumn(){var t;const n=(t=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:t[this._tableId],{_startRow:i,_endRow:s}=this;if(n==null)throw new Error("Table is not found.");const{tableRows:r}=n;return i===0&&s===r.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:n}=this;return ji(t,n)?t:n}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:n}=this;return ji(t,n)?n:t}get direction(){const{anchorNodePosition:t,focusNodePosition:n}=this;return ji(t,n)?ye.FORWARD:ye.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:n,startColumn:i,endRow:s,endColumn:r}=this,{startRow:o,startColumn:a,endRow:l,endColumn:d}=t,c={left:i,top:n,right:r,bottom:s},A={left:a,top:o,right:d,bottom:l};return yl.hasIntersectionBetweenTwoRect(c,A)}refresh(){var t;(t=this._rangeShape)==null||t.hide();const{startNodePosition:n,endNodePosition:i,_document:s,_docSkeleton:r}=this,o=s.getOffsetConfig(),{docsLeft:a,docsTop:l}=o,d=new _a(o,r).getRangePointData(n,i);if(d==null)return;const{pointGroup:c=[],startRow:A,endRow:g,startColumn:u,endColumn:h,tableId:p}=d;c?.length>0&&this._createOrUpdateRange(c,a,l),this._updateTableInfo(A,g,u,h,p)}_updateTableInfo(t,n,i,s,r){this._startRow=t,this._endRow=n,this._startCol=i,this._endCol=s,this._tableId=r}_createOrUpdateRange(t,n,i){var s;if(this._rangeShape){this._rangeShape.translate(n,i),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const r=.3,o=new qo(YA+ue(qA),{pointsGroup:t,fill:((s=this.style)==null?void 0:s.fill)||dn(ln.black,r),left:n,top:i,evented:!1,debounceParentDirty:!1});this._rangeShape=o,this._scene.addObject(o,ls)}}function lo(e,t,n,i,s,r,o,a,l=!0,d=!0){const c=s.findNodePositionByCharIndex(e,l,o,a),A=s.findNodePositionByCharIndex(t,d,o,a);if(!(c==null||A==null))return new zt(n,i,s,c,A,r,o,a)}function KA(e,t,n,i,s,r,o,a){const l=s.findNodePositionByCharIndex(e,!0,o,a),d=s.findNodePositionByCharIndex(t,!0,o,a);if(!(l==null||d==null))return new Da(n,i,s,l,d,r,o,a)}function ZA(e,t,n,i,s,r,o,a){const l=s.findNodePositionByCharIndex(e,!0,o,a),d=s.findNodePositionByCharIndex(t,!0,o,a);if(!(l==null||d==null))return ds(l,d,n,i,s,r,o,a)}function ds(e,t,n,i,s,r,o,a){const l=[],d=[],c=[n,i,s,e,t,r,o,a];if(Na(s,e,t)){if(wa(e,t))return l.push(new zt(...c)),{textRanges:l,rectRanges:d};{const v=zi(...c);return d.push(...v),{textRanges:l,rectRanges:d}}}if(VA(e,t)){const v=zi(...c);return d.push(...v),{textRanges:l,rectRanges:d}}const A=s.getViewModel().getSelfOrHeaderFooterViewModel(o),g=s.findCharIndexByPosition(e),u=s.findCharIndexByPosition(t);if(g==null||u==null)return;const h=g<=u?ye.FORWARD:ye.BACKWARD,p=Math.min(g,u),f=Math.max(g,u);let m=p,C=f;for(const v of A.getChildren())for(const I of v.children){const{startIndex:E,endIndex:S,children:R}=I,b=v.children.indexOf(I),x=v.children[b+1],O=R[0];let w=!1;if(O){const{startIndex:P,endIndex:Q,children:H}=O;let _=null,j=null;const K=H.find(L=>L.startIndex<=p&&L.endIndex>=p),ee=H.find(L=>L.startIndex<=f&&L.endIndex>=f);if(p>P&&p<Q)_=s.findNodePositionByCharIndex(K.startIndex+2,!0,o,a),j=s.findNodePositionByCharIndex(Q-4,!0,o,a),m=Q+1;else if(f>P&&f<Q)_=s.findNodePositionByCharIndex(P+3,!0,o,a),j=s.findNodePositionByCharIndex(ee.endIndex-3,!0,o,a),C=P-1,w=!0;else if(P>p&&Q<f){if(_=s.findNodePositionByCharIndex(P+3,!0,o,a),j=s.findNodePositionByCharIndex(Q-4,!0,o,a),m<=P-1){const L=s.findNodePositionByCharIndex(m,!0,o,a),F=s.findNodePositionByCharIndex(P-1,!1,o,a),ie=h===ye.FORWARD?L:F,Ae=h===ye.FORWARD?F:L;l.push(new zt(n,i,s,ie,Ae,r,o,a))}m=Q+1}if(_&&j){const L=h===ye.FORWARD?_:j,F=h===ye.FORWARD?j:_;d.push(...zi(n,i,s,L,F,r,o,a))}}if(C===S+1&&!w&&x&&x.children.length&&(C=S,w=!0),C>=E&&C<=S||w){const P=s.findNodePositionByCharIndex(m,!0,o,a),Q=s.findNodePositionByCharIndex(C,!w,o,a),H=h===ye.FORWARD?P:Q,_=h===ye.FORWARD?Q:P;if(d.length&&de.diffValue(H,_))continue;l.push(new zt(n,i,s,H,_,r,o,a))}}return{textRanges:l,rectRanges:d}}function JA(e){const t=e?.getCanvasElement();if(!t)return{left:0,top:0};const{top:n,left:i}=rd(t);return{left:i,top:n}}function Ao(e){var t;const n=(t=e.parent)==null?void 0:t.parent,i=n?.parent;if(n==null||i==null)return;const{paragraphIndex:s}=n,r=i.lines.filter(d=>d.paragraphIndex===s);let o=-1,a="",l=!1;for(const d of r)for(const c of d.divides)for(const A of c.glyphGroup)l||(o+=A.count),A===e&&(l=!0),a+=A.count>0?A.content:"";return{st:r[0].st,ed:s,content:a,nodeIndex:o}}function As(e){const{startOffset:t,endOffset:n,collapsed:i,rangeType:s,startNodePosition:r,endNodePosition:o,direction:a,segmentId:l,segmentPage:d}=e;return{startOffset:t,endOffset:n,collapsed:i,rangeType:s,startNodePosition:r,endNodePosition:o,direction:a,segmentId:l,segmentPage:d,isActive:e.isActive()}}function XA(e){const t=As(e),{startRow:n,startColumn:i,endRow:s,endColumn:r,tableId:o,spanEntireRow:a,spanEntireColumn:l,spanEntireTable:d}=e;return{...t,startRow:n,startColumn:i,endRow:s,endColumn:r,tableId:o,spanEntireRow:a,spanEntireColumn:l,spanEntireTable:d}}var $A=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Pn=(e,t)=>(n,i)=>t(n,i,e);let Ie=class extends gt{constructor(e,t,n,i,s){super(),y(this,"_onInputBefore$",new Ce),y(this,"onInputBefore$",this._onInputBefore$.asObservable()),y(this,"_onKeydown$",new Ce),y(this,"onKeydown$",this._onKeydown$.asObservable()),y(this,"_onInput$",new Ce),y(this,"onInput$",this._onInput$.asObservable()),y(this,"_onCompositionstart$",new _e(null)),y(this,"onCompositionstart$",this._onCompositionstart$.asObservable()),y(this,"_onCompositionupdate$",new _e(null)),y(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable()),y(this,"_onCompositionend$",new _e(null)),y(this,"onCompositionend$",this._onCompositionend$.asObservable()),y(this,"_onSelectionStart$",new _e(null)),y(this,"onSelectionStart$",this._onSelectionStart$.asObservable()),y(this,"onChangeByEvent$",Ho(this._onInput$,this._onKeydown$.pipe(xt(r=>r.event.keyCode===Z.BACKSPACE)),this._onCompositionend$)),y(this,"_onPaste$",new Ce),y(this,"onPaste$",this._onPaste$.asObservable()),y(this,"_textSelectionInner$",new _e(null)),y(this,"textSelectionInner$",this._textSelectionInner$.asObservable()),y(this,"_onFocus$",new Ce),y(this,"onFocus$",this._onFocus$.asObservable()),y(this,"_onBlur$",new Ce),y(this,"onBlur$",this._onBlur$.asObservable()),y(this,"_onPointerDown$",new Ce),y(this,"onPointerDown$",this._onPointerDown$.asObservable()),y(this,"_container"),y(this,"_inputParent"),y(this,"_input"),y(this,"_scrollTimers",[]),y(this,"_rangeList",[]),y(this,"_rangeListCache",[]),y(this,"_rectRangeList",[]),y(this,"_rectRangeListCache",[]),y(this,"_anchorNodePosition",null),y(this,"_focusNodePosition",null),y(this,"_currentSegmentId",""),y(this,"_currentSegmentPage",-1),y(this,"_selectionStyle",gn),y(this,"_onPointerEvent",!1),y(this,"_viewPortObserverMap",new Map),y(this,"_isIMEInputApply",!1),y(this,"_scenePointerMoveSubs",[]),y(this,"_scenePointerUpSubs",[]),y(this,"_reserveRanges",!1),this._context=e,this._layoutService=t,this._logService=n,this._univerInstanceService=i,this._docSkeletonManagerService=s,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(N.UNIVER_DOC).pipe(at(this.dispose$)).subscribe(e=>{e!=null&&e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=gn){this._selectionStyle=e}addDocRanges(e,t=!0,n){const{_currentSegmentId:i,_currentSegmentPage:s,_selectionStyle:r}=this,{scene:o,mainComponent:a}=this._context,l=a,d=this._docSkeletonManagerService.getSkeleton(),c=(A,g)=>{const u=ZA(A,g,o,l,d,r,i,s);if(u==null)return;const{textRanges:h,rectRanges:p}=u;for(const f of h)this._addTextRange(f);this._addRectRanges(p)};for(const A of e){const{startOffset:g,endOffset:u,rangeType:h,startNodePosition:p,endNodePosition:f}=A;if(h===De.RECT){const m=KA(g,u,o,l,d,r,i,s);m&&this._addRectRanges([m])}else if(h===De.TEXT)try{let m=null;p&&f?m=lo(p.isBack?g:g-1,f.isBack?u:u-1,o,l,d,r,i,s,p.isBack,f.isBack):m=lo(g,u,o,l,d,r,i,s),m&&this._addTextRange(m)}catch{c(g,u)}else c(g,u)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:i,segmentPage:s,style:r,isEditing:t,options:n}),!(!e.length||n?.shouldFocus===!1)&&this._updateInputPosition(n?.forceFocus)}setCursorManually(e,t){const n=this._findNodeByCoord(e,t,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),i=this._getNodePosition(n);if(i==null){this._removeAllRanges();return}n?.node.streamType===k.PARAGRAPH&&(i.isBack=!0),this._createTextRangeByAnchorPosition(i),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,t,n=!1){this._ensureHostContainer();let i=e,s=t;const r=this._container.parentElement;if(r){const o=r.getBoundingClientRect();i-=o.left,s-=o.top}this._container.style.left=`${i}px`,this._container.style.top=`${s}px`,this._container.style.zIndex="1000",(this.canFocusing||n)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(i==null||i.node==null)return;const s=Ao(i.node);if(s==null)return;const{content:r,st:o,nodeIndex:a}=s;if(a===-1||Intl.Segmenter==null)return;const l=new Intl.Segmenter(void 0,{granularity:"word"}).segment(r);let d=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(const{segment:A,index:g,isWordLike:u}of l)if(g<=a&&a<g+A.length&&u){d=g+o,c=g+o+A.length;break}if(Number.isFinite(d)&&Number.isFinite(c)){this.removeAllRanges();const A=[{startOffset:d,endOffset:c}];this.addDocRanges(A,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:t,offsetY:n}=e,i=this._findNodeByCoord(t,n,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(i==null||i.node==null)return;const s=Ao(i.node);if(s==null)return;this.removeAllRanges();const{st:r,ed:o}=s,a=[{startOffset:r,endOffset:o}];this.addDocRanges(a,!1,{forceFocus:!0})}__onPointDown(e){var t,n;const{scene:i,mainComponent:s}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{offsetX:o,offsetY:a}=e,l=this._findNodeByCoord(o,a,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),d=this._getNodePosition(l);if(d==null||l==null){this._removeAllRanges();return}l?.node.streamType===k.PARAGRAPH&&(d.isBack=!0);const c=this._textSelectionInner$.value;if(l&&e.button===2&&c){const f=r.findCharIndexByPosition(d);if(typeof f=="number"&&c.textRanges.some(m=>m.startOffset<=f&&m.endOffset>f)||typeof f=="number"&&c.rectRanges.some(m=>m.startOffset<=f&&m.endOffset>=f))return}const{segmentId:A,segmentPage:g}=l;A&&this._currentSegmentId&&A!==this._currentSegmentId&&this.setSegment(A),A&&g!==this._currentSegmentPage&&this.setSegmentPage(g),this._anchorNodePosition=d,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(d):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),i.disableObjectsEvent();const u=nd.create(i);this._scrollTimers.push(u),u.startScroll(o,a),this._onSelectionStart$.next((t=this._getActiveRangeInstance())==null?void 0:t.startNodePosition),(n=i.getTransformer())==null||n.clearSelectedObjects();let h=o,p=a;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(i.onPointerMove$.subscribeEvent(f=>{const{offsetX:m,offsetY:C}=f;i.setCursor(bt.TEXT),!(Math.sqrt((m-h)**2+(C-p)**2)<3)&&(this._moving(m,C),u.scrolling(m,C,()=>{this._moving(m,C)}),h=m,p=C)})),this._scenePointerUpSubs.push(i.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(m=>{m.unsubscribe()}),this._onPointerEvent=!1,i.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const m=new zt(i,s,r,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(m)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const m of this._rangeListCache)e.ctrlKey?m.collapsed?m.dispose():this._addTextRange(m):this._addTextRange(m);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const f={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(f),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e?.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:t,b:n,a:i}=id(),s={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${t}, ${n}, ${i??.3})`};this._setRangeStyle(s)}_getAllTextRanges(){return this._rangeList.map(As)}_getAllRectRanges(){return this._rectRangeList.map(XA)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(i=>i.isActive());if(e==null)return null;const{startOffset:t,endOffset:n}=e;return t==null||n==null?null:As(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,t=document.createElement("div");t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.id=`univer-doc-selection-container-${e}`;const n=document.createElement("div"),i=document.createElement("div");n.appendChild(i),t.appendChild(n),this._container=t,this._inputParent=n,this._input=i,this._initInput(),this._initInputEvents();const s=this._layoutService.rootContainerElement;(s!=null&&s.isConnected?s:document.body).appendChild(t)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_ensureHostContainer(){const e=this._layoutService.rootContainerElement;if(e!=null&&e.isConnected){this._container.parentElement!==e&&e.appendChild(this._container);return}this._container.parentElement!==document.body&&document.body.appendChild(this._container)}_getNodePosition(e){if(e==null)return;const{node:t,ratioX:n,segmentPage:i}=e,s=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(t,i);if(s==null)return;let r=n<.5;return t.glyphType===Go.LIST&&(r=!0),{...s,isBack:r}}_interactTextRanges(e){const t=[];for(const n of this._rangeList){if(e.some(i=>i.isIntersection(n))){n.dispose();continue}t.push(n)}this._rangeList=t}_interactRectRanges(e){const t=[];for(const n of this._rectRangeList){if(e.some(i=>i.isIntersection(n))){n.dispose();continue}t.push(n)}this._rectRangeList=t}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:t,mainComponent:n}=this._context,i=this._docSkeletonManagerService.getSkeleton(),s=new zt(t,n,i,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(s)}_updateActiveRangePosition(e){const t=this._getActiveRangeInstance();if(t==null||t.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=t.anchorNodePosition,this._focusNodePosition=e;const{scene:n,mainComponent:i}=this._context,s=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:r,_focusNodePosition:o,_selectionStyle:a,_currentSegmentId:l,_currentSegmentPage:d}=this;if(r==null||o==null||i==null)return;const c=ds(r,o,n,i,s,a,l,d);if(c==null)return;const{textRanges:A,rectRanges:g}=c;this._addTextRangesToCache(A),this._addRectRangesToCache(g),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var e;const t=(e=this._context.scene)==null?void 0:e.getEngine();return JA(t)}_updateInputPosition(e=!1){const t=this._getActiveRangeInstance(),n=t?.getAnchor();if(!n||n&&!n.visible||this.activeViewPort==null){this.focus();return}const{left:i,top:s}=n,r=this.activeViewPort.getAbsoluteVector(fn.FromArray([i,s])),{x:o,y:a}=r;let{left:l,top:d}=this._getCanvasOffset();l+=o,d+=a,this.activate(l,d,e)}_moving(e,t){var n,i;const{_currentSegmentId:s,_currentSegmentPage:r}=this,o=this._findNodeByCoord(e,t,{strict:!0,segmentId:s,segmentPage:r}),a=this._getNodePosition(o);if(a==null||o==null)return;const l=o?.node.parent,d=l?.glyphGroup[l.glyphGroup.indexOf(o.node)+1];o?.node.streamType===k.PARAGRAPH&&d?.streamType===k.SECTION_BREAK&&(a.isBack=!0),this._focusNodePosition=a,this._removeAllCacheRanges();const{_anchorNodePosition:c,_selectionStyle:A}=this,{scene:g,mainComponent:u}=this._context,h=this._docSkeletonManagerService.getSkeleton();if(c==null||u==null)return;const p=ds(c,a,g,u,h,A,s,r);if(p==null)return;const{textRanges:f,rectRanges:m}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&m.length>0&&this._interactRectRanges(m),this._addTextRangesToCache(f),this._addRectRangesToCache(m),this.deactivate(),(i=(n=this._context.scene)==null?void 0:n.getEngine())==null||i.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:t}=this._context;if(this._viewPortObserverMap.has(t))return;const n=e.onScrollAfter$.subscribeEvent(s=>{if(!s.viewport)return;const r=this._getActiveRangeInstance();r?.activeStatic()}),i=e.onScrollEnd$.subscribeEvent(s=>{const r=s.viewport;if(!r)return;const o=r.getBounding(),a=this._getActiveRangeInstance(),l=a?.getAnchor();if(!(!l||l&&!l.visible)){if(o){const{left:d,top:c,right:A,bottom:g}=o.viewBound;if(l.left<d||l.left>A||l.top<c||l.top>g){a?.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:i})}_initInputEvents(){this.disposeWithMe(He(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,t=>{this._onKeydown$.next(t)})})),this.disposeWithMe(He(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,t=>{this._onInputBefore$.next(t),this._onInput$.next(t)})}})),this.disposeWithMe(He(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,t=>{this._onCompositionstart$.next(t)})})),this.disposeWithMe(He(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,t=>{this._onCompositionend$.next(t)})})),this.disposeWithMe(He(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,t=>{this._onInputBefore$.next(t),this._onCompositionupdate$.next(t)})})),this.disposeWithMe(He(this._input,"paste").subscribe(e=>{this._eventHandle(e,t=>{this._onPaste$.next(t)})})),this.disposeWithMe(He(this._input,"focus").subscribe(e=>{this._eventHandle(e,t=>{this._onFocus$.next(t)})})),this.disposeWithMe(He(this._input,"blur").subscribe(e=>{this._eventHandle(e,t=>{this._onBlur$.next(t)})}))}_eventHandle(e,t){const n=this._input.textContent||"";this._input.innerHTML="";const i=this._getActiveRange(),s=this._getAllTextRanges();t({event:e,content:n,activeRange:i,rangeList:s})}_getTransformCoordForDocumentOffset(e,t){const n=this._context.mainComponent,{documentTransform:i}=n.getOffsetConfig();if(this.activeViewPort==null||i==null)return;const s=this.activeViewPort.transformVector2SceneCoord(fn.FromArray([e,t]));if(s)return i.clone().invert().applyPoint(s)}_findNodeByCoord(e,t,n){const i=this._getTransformCoordForDocumentOffset(e,t);if(i==null)return;const s=this._context.mainComponent,r=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:o=pn.VERTICAL,pageMarginLeft:a,pageMarginTop:l}=s.getOffsetConfig();return r.findNodeByCoord(i,o,a,l,n)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}};Ie=$A([Pn(1,Ii),Pn(2,Ns),Pn(3,U),Pn(4,W(ae))],Ie);const Di={id:"doc.command.switch-mode",type:D.COMMAND,handler:e=>{var t,n,i,s,r;const o=e.get(T),a=e.get(ce),l=e.get(Y),d=e.get(U).getCurrentUniverDocInstance();if(d==null)return!1;const c=d.getUnitId(),A=(t=a.getRenderById(c))==null?void 0:t.with(ae).getSkeleton(),g=(n=a.getRenderById(c))==null?void 0:n.with(Ie);if(A==null||g==null)return!1;const u=g?.getSegment(),h=g?.getSegmentPage(),p=d.getSnapshot().documentStyle.documentFlavor,f=l.getDocRanges(),m={id:X.id,params:{unitId:c,actions:[],textRanges:p===Te.TRADITIONAL&&u?[]:f}},C=V.getInstance(),v=[];let I;if(p===void 0?I=C.insertOp(["documentStyle","documentFlavor"],Te.MODERN):p===Te.MODERN?I=C.replaceOp(["documentStyle","documentFlavor"],p,Te.TRADITIONAL):I=C.replaceOp(["documentStyle","documentFlavor"],p,Te.MODERN),I)v.push(I);else return!1;if(p!==Te.MODERN){const E=d.getSnapshot(),{drawings:S={},body:R}=E,b=(i=R?.customBlocks)!=null?i:[];for(const x in S){const O=S[x],w=b.find(se=>se.blockId===x);if(w==null)continue;const P=O.docTransform.positionV,{relativeFrom:Q,posOffset:H}=P;if(Q===ot.PARAGRAPH)continue;const{startIndex:_}=w,j=A.findNodeByCharIndex(_,u,h),K=(s=j?.parent)==null?void 0:s.parent,ee=K?.parent,L=ee?.lines.find(se=>se.paragraphIndex===K?.paragraphIndex&&se.paragraphStart),F=(r=ee?.parent)==null?void 0:r.parent;if(j==null||K==null||L==null||ee==null||F==null)continue;let ie=0;Q===ot.LINE?ie-=K.top:Q===ot.PAGE&&(ie+=F.marginTop),ie+=L.top;const Ae={...P,relativeFrom:ot.PARAGRAPH,posOffset:(H??0)-ie},ge=C.replaceOp(["drawings",x,"docTransform","positionV"],P,Ae);ge&&v.push(ge)}}return m.params.actions=v.reduce((E,S)=>V.compose(E,S),null),!!o.syncExecuteCommand(m.id,m.params)}},ec="doc.command.create-table",Qa={id:ec,type:D.COMMAND,handler:async(e,t)=>{var n,i,s,r,o;const{rowCount:a,colCount:l}=t,d=e.get(Y),c=e.get(U),A=e.get(T),g=e.get(et),u=d.getActiveTextRange();if(u==null)return!1;const{segmentId:h,segmentPage:p}=u,f=c.getCurrentUniverDocInstance(),m=f?.getSelfOrHeaderFooterModel(h).getBody();if(f==null||m==null)return!1;const C=f.getUnitId(),v=Ve(e,C),I=v?.getSkeleton();if(I==null)return!1;const{startOffset:E}=u,S=((n=m.paragraphs)!=null?n:[]).find(Le=>Le.startIndex>=E),R=I.findNodeByCharIndex(E,h,p);if(R==null)return!1;const b=new fe,x=V.getInstance(),O=[],w=E+4,P=[{startOffset:w,endOffset:w,collapsed:!0}],Q={id:X.id,params:{unitId:C,actions:[],textRanges:P}};E>0&&b.push({t:G.RETAIN,len:E}),b.push({t:G.INSERT,body:{dataStream:k.PARAGRAPH,paragraphs:oa(k.PARAGRAPH,S)},len:1});const H=g.getDefaultStyle(),_=g.getStyleCache(),j=Ci(m,E,H,_),{dataStream:K,paragraphs:ee,sectionBreaks:L}=nA(a,l),F=(o=(r=(s=(i=R.parent)==null?void 0:i.parent)==null?void 0:s.parent)==null?void 0:r.parent)==null?void 0:o.parent;if(F==null)return!1;const{pageWidth:ie,marginLeft:Ae,marginRight:ge}=F,se=aa(a,l,ie-Ae-ge);b.push({t:G.INSERT,body:{dataStream:K,paragraphs:ee,sectionBreaks:L,textRuns:[{...j,st:0,ed:K.length}],tables:[{startIndex:0,endIndex:K.length,tableId:se.tableId}]},len:K.length});const ve=le(f,h);O.push(x.editOp(b.serialize(),ve));const Oe=x.insertOp(["tableSource",se.tableId],se);return O.push(Oe),Q.params.actions=O.reduce((Le,Qt)=>V.compose(Le,Qt),null),!!A.syncExecuteCommand(Q.id,Q.params)}},Ar={id:"doc.table.delete-rows",type:D.COMMAND,handler:async e=>{const t=e.get(Y),n=e.get(U),i=e.get(T),s=t.getRectRanges(),r=t.getActiveTextRange(),o=Bn(r,s);if(o==null)return!1;const{segmentId:a}=o,l=n.getCurrentUniverDocInstance(),d=l?.getSelfOrHeaderFooterModel(a).getBody();if(l==null||d==null)return!1;const c=Ve(e,l.getUnitId());if(c==null)return!1;const A=c.getViewModel(),g=l?.getUnitId(),u=new fe,h=V.getInstance(),p=la(o,A);if(p==null)return!1;const{offset:f,rowIndexes:m,len:C,tableId:v,cursor:I,selectWholeTable:E}=p;if(E)return i.executeCommand(_n.id);const S=[],R=[{startOffset:I,endOffset:I,collapsed:!0}],b={id:X.id,params:{unitId:g,actions:[],textRanges:R}};f>0&&u.push({t:G.RETAIN,len:f}),u.push({t:G.DELETE,len:C});const x=le(l,a);S.push(h.editOp(u.serialize(),x));for(const O of m.reverse()){const w=h.removeOp(["tableSource",v,"tableRows",O]);S.push(w)}return b.params.actions=S.reduce((O,w)=>V.compose(O,w),null),!!i.syncExecuteCommand(b.id,b.params)}},cr={id:"doc.table.delete-columns",type:D.COMMAND,handler:async e=>{const t=e.get(Y),n=e.get(U),i=e.get(T),s=t.getRectRanges(),r=t.getActiveTextRange(),o=Bn(r,s);if(o==null)return!1;const{segmentId:a}=o,l=n.getCurrentUniverDocInstance(),d=l?.getSelfOrHeaderFooterModel(a).getBody();if(l==null||d==null)return!1;const c=Ve(e,l.getUnitId());if(c==null)return!1;const A=c.getViewModel(),g=l?.getUnitId(),u=new fe,h=V.getInstance(),p=lA(o,A);if(p==null)return!1;const{offsets:f,columnIndexes:m,tableId:C,cursor:v,rowCount:I,selectWholeTable:E}=p;if(E)return i.executeCommand(_n.id);const S=[],R=[{startOffset:v,endOffset:v,collapsed:!0}],b={id:X.id,params:{unitId:g,actions:[],textRanges:R}};for(const O of f){const{retain:w,delete:P}=O;w>0&&u.push({t:G.RETAIN,len:w}),u.push({t:G.DELETE,len:P})}const x=le(l,a);S.push(h.editOp(u.serialize(),x)),m.reverse();for(let O=0;O<I;O++)for(const w of m){const P=h.removeOp(["tableSource",C,"tableRows",O,"tableCells",w]);S.push(P)}for(const O of m){const w=h.removeOp(["tableSource",C,"tableColumns",O]);S.push(w)}return b.params.actions=S.reduce((O,w)=>V.compose(O,w),null),!!i.syncExecuteCommand(b.id,b.params)}},_n={id:"doc.table.delete-table",type:D.COMMAND,handler:async e=>{const t=e.get(Y),n=e.get(U),i=e.get(T),s=t.getRectRanges(),r=t.getActiveTextRange(),o=Bn(r,s);if(o==null)return!1;const{segmentId:a}=o,l=n.getCurrentUniverDocInstance(),d=l?.getSelfOrHeaderFooterModel(a).getBody();if(l==null||d==null)return!1;const c=Ve(e,l.getUnitId());if(c==null)return!1;const A=c.getViewModel(),g=l?.getUnitId(),u=new fe,h=V.getInstance(),p=da(o,A);if(p==null)return!1;const{offset:f,len:m,tableId:C,cursor:v}=p,I=[],E=[{startOffset:v,endOffset:v,collapsed:!0}],S={id:X.id,params:{unitId:g,actions:[],textRanges:E}};f>0&&u.push({t:G.RETAIN,len:f}),u.push({t:G.DELETE,len:m});const R=le(l,a);I.push(h.editOp(u.serialize(),R));const b=h.removeOp(["tableSource",C]);return I.push(b),S.params.actions=I.reduce((x,O)=>V.compose(x,O),null),!!i.syncExecuteCommand(S.id,S.params)}},ur="doc.command.table-insert-row",hr="doc.command.table-insert-column",tc="doc.command.table-insert-row-above",nc="doc.command.table-insert-row-bellow",ic="doc.command.table-insert-column-left",sc="doc.command.table-insert-column-right",gr={id:tc,type:D.COMMAND,handler:async e=>e.get(T).executeCommand(ur,{position:xi.ABOVE})},pr={id:nc,type:D.COMMAND,handler:async e=>e.get(T).executeCommand(ur,{position:xi.BELLOW})},fr={id:ic,type:D.COMMAND,handler:async e=>e.get(T).executeCommand(hr,{position:Ls.LEFT})},mr={id:sc,type:D.COMMAND,handler:async e=>e.get(T).executeCommand(hr,{position:Ls.RIGHT})},Pa={id:ur,type:D.COMMAND,handler:async(e,t)=>{const{position:n}=t,i=e.get(Y),s=e.get(U),r=e.get(T),o=i.getRectRanges(),a=i.getActiveTextRange(),l=Bn(a,o);if(l==null)return!1;const{segmentId:d}=l,c=s.getCurrentUnitForType(N.UNIVER_DOC),A=c?.getSelfOrHeaderFooterModel(d).getBody();if(c==null||A==null)return!1;const g=Ve(e,c.getUnitId());if(g==null)return!1;const u=g.getViewModel(),h=c?.getUnitId(),p=new fe,f=V.getInstance(),m=rA(l,n,u);if(m==null)return!1;const{offset:C,colCount:v,tableId:I,insertRowIndex:E}=m,S=[],R=C+2,b=[{startOffset:R,endOffset:R,collapsed:!0}],x={id:X.id,params:{unitId:h,actions:[],textRanges:b}};C>0&&p.push({t:G.RETAIN,len:C});const O=iA(v);p.push({t:G.INSERT,body:O,len:O.dataStream.length});const w=le(c,d);S.push(f.editOp(p.serialize(),w));const P=ks(v),Q=f.insertOp(["tableSource",I,"tableRows",E],P);return S.push(Q),x.params.actions=S.reduce((H,_)=>V.compose(H,_),null),!!r.syncExecuteCommand(x.id,x.params)}},rc={id:hr,type:D.COMMAND,handler:async(e,t)=>{var n,i,s;const{position:r}=t,o=e.get(Y),a=e.get(U),l=e.get(T),d=o.getRectRanges(),c=o.getActiveTextRange(),A=Bn(c,d);if(A==null)return!1;const{segmentId:g}=A,u=a.getCurrentUniverDocInstance(),h=u?.getSelfOrHeaderFooterModel(g).getBody();if(u==null||h==null)return!1;const p=Ve(e,u.getUnitId());if(p==null)return!1;const f=p.getViewModel(),m=u?.getUnitId(),C=new fe,v=V.getInstance(),I=oA(A,r,f);if(I==null)return!1;const{offsets:E,columnIndex:S,tableId:R,rowCount:b}=I,x=[],O=E[0]+1,w=[{startOffset:O,endOffset:O,collapsed:!0}],P={id:X.id,params:{unitId:m,actions:[],textRanges:w}};for(const se of E){C.push({t:G.RETAIN,len:se});const ve=sA();C.push({t:G.INSERT,body:ve,len:ve.dataStream.length})}const Q=le(u,g);x.push(v.editOp(C.serialize(),Q));for(let se=0;se<b;se++){const ve=Hs(),Oe=v.insertOp(["tableSource",R,"tableRows",se,"tableCells",S],ve);x.push(Oe)}const H=u.getSnapshot(),_=H.documentStyle,{marginLeft:j=0,marginRight:K=0}=_,ee=((i=(n=_.pageSize)==null?void 0:n.width)!=null?i:800)-j-K,L=(s=H?.tableSource)==null?void 0:s[R].tableColumns,{newColWidth:F,widths:ie}=aA(ee,L,S);for(let se=0;se<ie.length;se++){const ve=v.replaceOp(["tableSource",R,"tableColumns",se,"size","width","v"],L[se].size.width.v,ie[se]);x.push(ve)}const Ae=Fs(F),ge=v.insertOp(["tableSource",R,"tableColumns",S],Ae);return x.push(ge),P.params.actions=x.reduce((se,ve)=>V.compose(se,ve),null),!!l.syncExecuteCommand(P.id,P.params)}},Ua={id:"doc.table.tab-in-table",type:D.COMMAND,handler:async(e,t)=>{var n;const{shift:i}=t,s=e.get(Y),r=s.getDocRanges(),o=e.get(T),a=e.get(U).getCurrentUniverDocInstance();if(!a)return!1;const l=(n=r.find(h=>h.isActive))!=null?n:r[0],d=a.getUnitId(),c=Ve(e,d),A=c?.getSkeleton(),g=A?.getViewModel().getSelfOrHeaderFooterViewModel(l?.segmentId);if(g==null||l==null)return!1;let u=null;if(i?u=zr(g,l,ns.PREV):u=zr(g,l,ns.NEXT),u){const{startOffset:h,endOffset:p}=u,f=[{startOffset:h,endOffset:p}];return s.replaceDocRanges(f),!0}return i===!1?await o.executeCommand(Pa.id,{position:xi.BELLOW}):!0}},La="COMPONENT_DOC_CREATE_TABLE_CONFIRM",Gi="doc.component.create-table-confirm",vr={id:"doc.operation.create-table",type:D.COMMAND,handler:async e=>{const t=e.get(Fe),n=e.get(Lo),i=e.get(T),s={rowCount:3,colCount:5},r=(o,a)=>{s.rowCount=o,s.colCount=a};return await n.open({id:Gi,children:{label:{name:La,props:{handleRowColChange:r,tableCreateParams:s}}},width:"auto",title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{i.executeCommand(Qa.id,s),n.close(Gi)},onClose:()=>{n.close(Gi)}}),!0}},ut={id:"doc.operation.move-cursor",type:D.OPERATION,handler:(e,t)=>!!t},ht={id:"doc.operation.move-selection",type:D.OPERATION,handler:(e,t)=>!!t};function Re({ref:e,...t}){const{icon:n,id:i,className:s,extend:r,...o}=t,a=`univerjs-icon univerjs-icon-${i} ${s||""}`.trim(),l=M.useRef(`_${lc()}`);return Ha(n,`${i}`,{defIds:n.defIds,idSuffix:l.current},{ref:e,className:a,...o},r)}function Ha(e,t,n,i,s){return M.createElement(e.tag,{key:t,...oc(e,n,s),...i},(ac(e,n).children||[]).map((r,o)=>Ha(r,`${t}-${e.tag}-${o}`,n,void 0,s)))}function oc(e,t,n){const i={...e.attrs};n!=null&&n.colorChannel1&&i.fill==="colorChannel1"&&(i.fill=n.colorChannel1),e.tag==="mask"&&i.id&&(i.id=i.id+t.idSuffix),Object.entries(i).forEach(([r,o])=>{r==="mask"&&typeof o=="string"&&(i[r]=o.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))});const{defIds:s}=t;return!s||s.length===0||(e.tag==="use"&&i["xlink:href"]&&(i["xlink:href"]=i["xlink:href"]+t.idSuffix),Object.entries(i).forEach(([r,o])=>{typeof o=="string"&&(i[r]=o.replace(/url\(#(.*)\)/,`url(#$1${t.idSuffix})`))})),i}function ac(e,t){var n;const{defIds:i}=t;return!i||i.length===0?e:e.tag==="defs"&&(n=e.children)!=null&&n.length?{...e,children:e.children.map(s=>typeof s.attrs.id=="string"&&i&&i.includes(s.attrs.id)?{...s,attrs:{...s.attrs,id:s.attrs.id+t.idSuffix}}:s)}:e}function lc(){return Math.random().toString(36).substring(2,8)}Re.displayName="UniverIcon";const dc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641C14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004C14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999Z"}}]},ka=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"align-text-both-icon",ref:t,icon:dc}))});ka.displayName="AlignTextBothIcon";const Ac={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332C13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267C11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827C1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827C8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007Z"}}]},Fa=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"catalogue-icon",ref:t,icon:Ac}))});Fa.displayName="CatalogueIcon";const cc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993 0.866699 5.9313 0.866699H10.069C10.4004 0.866699 10.669 1.13533 10.669 1.4667C10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443C14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928L9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171C10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778L9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539C9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263L6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539C5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778L6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Va=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"delete-icon",ref:t,icon:cc}))});Va.displayName="DeleteIcon";const uc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105C8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105C4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324C10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324C4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188Z"}}]},ja=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"doc-setting-icon",ref:t,icon:uc}))});ja.displayName="DocSettingIcon";const hc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},Wa=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"down-icon",ref:t,icon:hc}))});Wa.displayName="DownIcon";const gc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689C2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336C2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336C9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689C8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203C13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319C11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333C13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879Z"}}]},za=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"h1-icon",ref:t,icon:gc}))});za.displayName="H1Icon";const pc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689C12.8465 7.26689 13.4 7.67244 13.4 8.33356C13.4 8.62807 13.2712 8.94814 12.9954 9.32391C12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373C10.3718 12.1759 10.0667 12.7122 10.0667 13.3336C10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336C14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767C11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338C14.3122 9.55787 14.6 8.98906 14.6 8.33356C14.6 6.88362 13.3757 6.06689 12.3333 6.06689C11.291 6.06689 10.0667 6.88361 10.0667 8.33356C10.0667 8.66493 10.3353 8.93356 10.6667 8.93356C10.998 8.93356 11.2667 8.66493 11.2667 8.33356Z"}}]},Ga=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"h2-icon",ref:t,icon:pc}))});Ga.displayName="H2Icon";const fc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689C10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051C11.2283 10.1364 11.4375 10.2669 11.6667 10.2669C12.2418 10.2669 12.6786 10.4115 12.9585 10.6354C13.2204 10.845 13.4 11.166 13.4 11.6669C13.4 12.1622 13.2254 12.3937 13.0567 12.5202C12.8588 12.6686 12.5829 12.7336 12.3333 12.7336C11.7271 12.7336 11.3432 12.4858 11.1106 12.23C10.8877 11.9848 10.5082 11.9667 10.2631 12.1896C10.0179 12.4125 9.99979 12.792 10.2227 13.0372C10.6568 13.5147 11.3522 13.9336 12.3333 13.9336C12.7504 13.9336 13.3078 13.8319 13.7767 13.4802C14.2746 13.1068 14.6 12.5049 14.6 11.6669C14.6 10.8345 14.2796 10.1555 13.7081 9.69837C13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328C14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667Z"}}]},Ya=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"h3-icon",ref:t,icon:fc}))});Ya.displayName="H3Icon";const mc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},qa=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"h4-icon",ref:t,icon:mc}))});qa.displayName="H4Icon";const vc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689C1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336C2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336C8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689C7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492C10.7822 9.94492 10.8899 9.91238 10.9814 9.85599C10.9901 9.85195 11.0027 9.84632 11.0192 9.83936C11.0764 9.81533 11.1692 9.78033 11.2927 9.74447C11.5397 9.67268 11.8996 9.60022 12.3336 9.60022C12.4975 9.60022 12.5978 9.63412 12.6624 9.67167C12.7263 9.70877 12.79 9.76953 12.8503 9.87834C12.983 10.1181 13.0669 10.5337 13.0669 11.1669C13.0669 11.8061 12.9802 12.1936 12.8338 12.414C12.7252 12.5775 12.5275 12.7336 12.0002 12.7336C11.6445 12.7336 11.4936 12.622 11.4192 12.5328C11.3289 12.4245 11.2669 12.2453 11.2669 12.0028C11.2669 11.6714 10.9983 11.4028 10.6669 11.4028C10.3355 11.4028 10.0669 11.6714 10.0669 12.0028C10.0669 12.4244 10.1716 12.9106 10.4979 13.3016C10.8401 13.7118 11.356 13.9336 12.0002 13.9336C12.8063 13.9336 13.4419 13.6673 13.8334 13.0779C14.1869 12.5456 14.2669 11.8497 14.2669 11.1669C14.2669 10.4781 14.1841 9.81027 13.9002 9.29724C13.7521 9.02964 13.545 8.79662 13.2651 8.63403C12.986 8.4719 12.6697 8.40022 12.3336 8.40022C11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332C13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669Z"}}]},Ka=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"h5-icon",ref:t,icon:vc}))});Ka.displayName="H5Icon";const Ec={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641C2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641C13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004C2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004C13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315Z"}}]},Za=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"horizontally-icon",ref:t,icon:Ec}))});Za.displayName="HorizontallyIcon";const Ic={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ja=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"left-icon",ref:t,icon:Ic}))});Ja.displayName="LeftIcon";const Cc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641C1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641C11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004C1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004C11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999Z"}}]},Xa=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"left-justifying-icon",ref:t,icon:Cc}))});Xa.displayName="LeftJustifyingIcon";const Sc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941C1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941C14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641C4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641C14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334C14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004C4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004C14.6 13.169 14.3314 12.9004 14 12.9004H4.66665Z"}}]},$a=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"right-justifying-icon",ref:t,icon:Sc}))});$a.displayName="RightJustifyingIcon";const xc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},An=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"text-type-icon",ref:t,icon:xc}))});An.displayName="TextTypeIcon";const bc={tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263C4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837L1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263C0.880874 2.97695 0.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689C6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689C15.0605 2.83552 14.7918 2.56689 14.4605 2.56689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334C6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334C15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999C15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999 0.939453 6.76549 0.939453 7.83324C0.939453 8.90099 1.80504 9.76657 2.87279 9.76657C3.94054 9.76657 4.80612 8.90099 4.80612 7.83324C4.80612 6.76549 3.94054 5.8999 2.87279 5.8999ZM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999C3.2778 7.0999 3.60612 7.42823 3.60612 7.83324C3.60612 8.23824 3.2778 8.56657 2.87279 8.56657C2.46778 8.56657 2.13945 8.23824 2.13945 7.83324Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M0.939453 12.5002C0.939453 11.4325 1.80504 10.5669 2.87279 10.5669C3.94054 10.5669 4.80612 11.4325 4.80612 12.5002C4.80612 13.568 3.94054 14.4336 2.87279 14.4336C1.80504 14.4336 0.939453 13.568 0.939453 12.5002ZM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002C2.13945 12.9052 2.46778 13.2336 2.87279 13.2336C3.2778 13.2336 3.60612 12.9052 3.60612 12.5002C3.60612 12.0952 3.2778 11.7669 2.87279 11.7669Z",fillRule:"evenodd",clipRule:"evenodd"}}]},el=M.forwardRef(function(e,t){return M.createElement(Re,Object.assign({},e,{id:"todo-list-double-icon",ref:t,icon:bc}))});el.displayName="TodoListDoubleIcon";function tl(e){var t;const{dataStream:n}=(t=e.body)!=null?t:{},i=[k.TABLE_START,k.TABLE_CELL_END,k.TABLE_CELL_START,k.TABLE_END,k.TABLE_ROW_END,k.TABLE_ROW_START,k.COLUMN_BREAK,k.PAGE_BREAK,k.TAB,k.DOCS_END,k.CUSTOM_BLOCK];if(typeof n=="string")for(let s=0;s<n.length;s++){const r=n[s];if(!i.includes(r))return s}return 0}class Rc extends pe{constructor(t,n,i,s,r,o){super(),y(this,"_change$",new Ce),y(this,"change$",this._change$.asObservable()),y(this,"_input$",new Ce),y(this,"input$",this._input$.asObservable()),y(this,"_paste$",new Ce),y(this,"paste$",this._paste$.asObservable()),y(this,"_focus$",new Ce),y(this,"focus$",this._focus$.asObservable()),y(this,"_blur$",new Ce),y(this,"blur$",this._blur$.asObservable()),y(this,"_selectionChange$",new Ce),y(this,"selectionChange$",this._selectionChange$.asObservable()),this._param=t,this._univerInstanceService=n,this._docSelectionManagerService=i,this._commandService=s,this._undoRedoService=r,this._injector=o,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(Ie)}_listenSelection(){const t=this._param.render.with(Ie);this.disposeWithMe(t.onBlur$.subscribe(n=>{this._blur$.next(n);const i=this.getDocumentData();this._change$.next({target:this,data:i})})),this.disposeWithMe(t.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(t.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(Ho(t.onInput$,t.onKeydown$.pipe(xt(n=>{const i=n.event;return i.ctrlKey||i.metaKey?[Z.X,Z.V].includes(i.keyCode):[Z.BACKSPACE].includes(i.keyCode)})),t.onCompositionupdate$,t.onCompositionend$,t.onPaste$).subscribe(n=>{if(n==null)return;const{content:i=""}=n,s=this.getDocumentData();this._input$.next({target:this,content:i,data:s,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:i,subUnitId:s,...r}=n,o=this.getEditorId();i===o&&this._selectionChange$.next(r)}))}isFocus(){const t=this._param.render.with(Ie);return t.isFocusing&&!!t.getActiveTextRange()}focus(){const t=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC),n=this.getEditorId();(t==null||t.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(Ie).focus()}blur(){this._param.render.with(Ie).blur()}select(){const t=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:t.body?t.body.dataStream.length-2:0}])}setSelectionRanges(t,n=!0){const i=this.getEditorId(),s={unitId:i,subUnitId:i};return this._docSelectionManagerService.replaceDocRanges(t,s,!1,{shouldFocus:n})}getSelectionRanges(){const t=this.getEditorId(),n={unitId:t,subUnitId:t};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var t,n;return(n=(t=this.getSelectionRanges().find(i=>i.collapsed))==null?void 0:t.startOffset)!=null?n:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(t,n){this._commandService.syncExecuteCommand(xa.id,{unitId:this.getEditorId(),snapshot:t,textRanges:n})}replaceText(t,n=!0){const i=this.getDocumentData();this.setDocumentData({...i,body:{dataStream:`${t}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:t.length,endOffset:t.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const t=this.getEditorId();return this._undoRedoService.clearUndoRedo(t)}dispose(){const t=this._getDocDataModel();t?.dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var t;return(t=this._injector.get(ce).getRenderById(this._getEditorId()))==null?void 0:t.with(ae).getSkeleton()}isSheetEditor(){return Xe(this._getEditorId())}getValue(){var t;return(((t=this._getDocDataModel().getBody())==null?void 0:t.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(t){this._param={...this._param,...t}}updateCanvasStyle(){var t;const n=this._getDocDataModel();if(n==null)return;const i={};(t=this._param.canvasStyle)!=null&&t.fontSize&&(i.textStyle==null&&(i.textStyle={}),i.textStyle.fs=this._param.canvasStyle.fontSize),n.updateDocumentStyle(i)}_getDocDataModel(){const t=this._getEditorId();return this._univerInstanceService.getUnit(t,N.UNIVER_DOC)}_getEditorId(){var t;return((t=this._param.initialSnapshot)==null?void 0:t.id)||this._param.editorUnitId||""}}var yc=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},vt=(e,t)=>(n,i)=>t(n,i,e);const Oc=["editor","render-canvas"];let cs=class extends pe{constructor(e,t,n,i,s,r,o){super(),y(this,"_editors",new Map),y(this,"_focusEditorUnitId"),y(this,"_blur$",new Ce),y(this,"blur$",this._blur$.asObservable()),y(this,"_focus$",new Ce),y(this,"focus$",this._focus$.asObservable()),this._univerInstanceService=e,this._renderManagerService=t,this._docSelectionManagerService=n,this._contextService=i,this._commandService=s,this._undoRedoService=r,this._injector=o,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(He(window,"focusin").subscribe(e=>{const t=e.target;this._blurSheetEditor(t)}))}_blurSheetEditor(e){if(Oc.some(n=>e.dataset.uComp===n))return;const t=this.getFocusEditor();t&&t.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const t=this._editors.get(e);return!!(t&&t.isSheetEditor())}blur(e){const t=this.getFocusEditor();e&&t?.setSelectionRanges([]),t?.blur(),this._contextService.setContextValue(qn,!1),this._contextService.setContextValue(Mr,!1),this._contextService.setContextValue(wr,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const t=this.getEditor(e);if(t==null)return;this._univerInstanceService.setCurrentUnitForType(e);const n=t.getValue().length;this._contextService.setContextValue(qn,!0),Xe(e)||this._contextService.setContextValue(Mr,!0),Sl(e)&&this._contextService.setContextValue(wr,!0),t.focus(),this._setFocusId(e),this._focus$.next({startOffset:n,endOffset:n})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,t){var n,i,s,r;const{initialSnapshot:o,canvasStyle:a={}}=e,l=o.id;this._univerInstanceService.getUnit(l,N.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(N.UNIVER_DOC,o||this._getBlank(l),{makeCurrent:!1});let d=this._renderManagerService.getRenderById(l);if(d==null&&(this._renderManagerService.create(l),d=this._renderManagerService.getRenderById(l)),d){d.engine.setContainer(t);const c=new Rc({...e,render:d,editorDom:t,canvasStyle:a},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(l,c),e.scrollBar||(r=(s=(i=(n=d.mainComponent)==null?void 0:n.getScene())==null?void 0:i.getViewports())==null?void 0:s[0].getScrollBar())==null||r.dispose()}return bn(()=>{this._unRegister(l)})}_unRegister(e){const t=this._editors.get(e);t!=null&&(this._renderManagerService.removeRender(e),t.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${ko}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:xl.TOP,horizontalAlign:Ne.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}};cs=yc([vt(0,U),vt(1,ce),vt(2,W(Y)),vt(3,Ds),vt(4,T),vt(5,gi),vt(6,W(On))],cs);const Ue=Fo("univer.editor.service"),us="COMPONENT_DOC_HEADER_FOOTER_PANEL";function Tc(e,t,n){const{useFirstPageHeaderFooter:i,evenAndOddHeaders:s,defaultHeaderId:r,defaultFooterId:o,firstPageHeaderId:a,firstPageFooterId:l,evenPageHeaderId:d,evenPageFooterId:c}=e;return t===Ee.HEADER?i===z.TRUE?n===0?a:s===z.TRUE&&n%2===1?d:r:s===z.TRUE&&n%2===1?d:r:i===z.TRUE?n===0?l:s===z.TRUE&&n%2===1?c:o:s===z.TRUE&&n%2===1?c:o}const Bc=e=>{const t=J(Fe),n=J(U),i=J(ce),s=J(T),r=J(Ii),{unitId:o}=e,a=i.getRenderById(o).with(Ie),[l,d]=M.useState({}),c=(u,h)=>{var p;d(b=>({...b,[h]:u?z.TRUE:z.FALSE}));const f=n.getUniverDocInstance(o),m=f?.getSnapshot().documentStyle,C=(p=i.getRenderById(o))==null?void 0:p.with(ae),v=C?.getViewModel();if(m==null||v==null)return;const I=v.getEditArea();let E=!1;const S=a.getSegmentPage();let R=!1;if(h==="useFirstPageHeaderFooter"&&u===!0&&((I===Ee.HEADER&&!m.firstPageHeaderId||I===Ee.FOOTER&&!m.firstPageFooterId)&&(E=!0),E&&S===0&&(R=!0)),h==="evenAndOddHeaders"&&u===!0&&((I===Ee.HEADER&&!m.evenPageHeaderId||I===Ee.FOOTER&&!m.evenPageFooterId)&&(E=!0),E&&S%2===1&&(R=!0)),E){const b=ue(6);R&&a.setSegment(b),s.executeCommand(Yn,{unitId:o,segmentId:b,headerFooterProps:{[h]:u?z.TRUE:z.FALSE}})}else{const b=a.getSegmentPage(),x=a.getSegment(),O=Tc({...m,[h]:u?z.TRUE:z.FALSE},I,b);O&&O!==x&&a.setSegment(O),s.executeCommand(Yn,{unitId:o,headerFooterProps:{[h]:u?z.TRUE:z.FALSE}})}r.focus()},A=async(u,h)=>{d(p=>({...p,[h]:u})),await s.executeCommand(Yn,{unitId:o,headerFooterProps:{[h]:u}}),a.removeAllRanges(),a.blur()},g=()=>{s.executeCommand(Cr.id,{unitId:o})};return M.useEffect(()=>{const u=n.getUniverDocInstance(o),h=u?.getSnapshot().documentStyle;if(h){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:m=z.FALSE,evenAndOddHeaders:C=z.FALSE}=h;d({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:m,evenAndOddHeaders:C})}},[o]),B.jsxs("div",{className:"univer-grid univer-gap-4",children:[B.jsxs("div",{className:"univer-grid univer-gap-2",children:[B.jsx("div",{children:B.jsx(Vr,{checked:l.useFirstPageHeaderFooter===z.TRUE,onChange:u=>{c(u,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),B.jsx("div",{children:B.jsx(Vr,{checked:l.evenAndOddHeaders===z.TRUE,onChange:u=>{c(u,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),B.jsxs("div",{className:"univer-mb-1 univer-flex",children:[B.jsxs("div",{children:[B.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),B.jsx(Je,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:u=>{A(u,"marginHeader")}})]}),B.jsxs("div",{children:[B.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),B.jsx(Je,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:u=>{A(u,"marginFooter")}})]})]}),B.jsx("div",{className:"univer-flex univer-justify-end",children:B.jsx(Hd,{onClick:g,children:t.t("headerFooter.closeHeaderFooter")})})]})},Mc=()=>{var e;const t=J(Fe),n=J(ce),i=J(U).getCurrentUniverDocInstance().getUnitId(),s=((e=n.getRenderById(i))==null?void 0:e.with(ae)).getViewModel(),[r,o]=M.useState(!0);return M.useEffect(()=>{const a=s.getEditArea();o(a!==Ee.BODY);const l=s.editAreaChange$.subscribe(d=>{d!=null&&o(d!==Ee.BODY)});return()=>{l.unsubscribe()}},[]),B.jsx("div",{className:"univer-text-sm",children:r?B.jsx(Bc,{unitId:i}):B.jsx("div",{className:"univer-text-gray-400",children:t.t("headerFooter.disableText")})})},co=18,uo=200,Yi=6,wc=4;function Nc(e,t){let{radius:n,width:i,height:s}=t;n=n??0,i=i??30,s=s??30;let r=0;r=Math.min(n,i/2,s/2),e.beginPath(),e.moveTo(0,0),e.lineTo(i,0),e.lineTo(i,s-r),e.arc(i-r,s-r,r,0,Math.PI/2,!1),e.lineTo(0,s),e.lineTo(0,0),e.closePath(),t.fill&&(e.save(),e.fillStyle=t.fill,t.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}class ti extends ad{constructor(t,n){super(t,n),y(this,"color"),y(this,"text"),this.color=n?.color,this.text=n?.text}static drawWith(t,n){const{text:i,color:s}=n;t.save(),t.font="13px Source Han Sans CN";const r=t.measureText(i).width,o=Math.min(r+2*Yi,uo);Nc(t,{height:co,width:o,radius:4,fill:s}),t.fillStyle="rgba(58, 96, 247, 1)";const a=Yi,l=co-wc,d=uo-2*Yi;if(r>d){let c="",A=0;for(const g of i){const u=t.measureText(g).width;if(A+u<=d-t.measureText("...").width)c+=g,A+=u;else{c+="...";break}}t.fillText(c,a,l)}else t.fillText(i,a,l);t.restore()}_draw(t){ti.drawWith(t,this)}}var _c=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},st=(e,t)=>(n,i)=>t(n,i,e);const ho="rgba(58, 96, 247, 1)",go="rgba(58, 96, 247, 0.08)";var we=(e=>(e[e.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",e[e.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",e[e.DEFAULT_HEADER=2]="DEFAULT_HEADER",e[e.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",e[e.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",e[e.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",e))(we||{});function Dc(e,t,n){const{documentStyle:i}=e.getDataModel().getSnapshot(),{defaultHeaderId:s,defaultFooterId:r,evenPageHeaderId:o,evenPageFooterId:a,firstPageHeaderId:l,firstPageFooterId:d,evenAndOddHeaders:c,useFirstPageHeaderFooter:A}=i;switch(t){case Ee.BODY:return{createType:null,headerFooterId:null};case Ee.HEADER:return A===z.TRUE&&!l?{createType:0,headerFooterId:null}:c===z.TRUE&&n%2===0&&!o?{createType:4,headerFooterId:null}:s?{createType:null,headerFooterId:s}:{createType:2,headerFooterId:null};case Ee.FOOTER:return A===z.TRUE&&!d?{createType:1,headerFooterId:null}:c===z.TRUE&&n%2===0&&!a?{createType:5,headerFooterId:null}:r?{createType:null,headerFooterId:r}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let hs=class extends pe{constructor(e,t,n,i,s,r,o,a,l){super(),y(this,"_loadedMap",new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._renderManagerService=s,this._docSkeletonManagerService=r,this._docSelectionRenderService=o,this._localeService=a,this._componentManager=l,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}dispose(){super.dispose()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(X.id===e.id){const t=this._context.unit,n=this._docSkeletonManagerService.getViewModel().getEditArea(),i=t.getSnapshot().documentStyle.documentFlavor;n!==Ee.BODY&&i===Te.MODERN&&this._commandService.executeCommand(Cr.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(us)||this.disposeWithMe(this._componentManager.register(us,Mc))}_init(){const{unitId:e}=this._context,t=lt(this._context);t==null||t.document==null||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_initialMain(e){const t=lt(this._context),{document:n}=t;this.disposeWithMe(n.onDblclick$.subscribeEvent(async i=>{if(this._isEditorReadOnly(e)||!this._isTraditionalMode())return;const{offsetX:s,offsetY:r}=i,{pageLayoutType:o=pn.VERTICAL,pageMarginLeft:a,pageMarginTop:l}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(s,r);if(d==null)return;const c=this._docSkeletonManagerService.getViewModel(),A=this._docSkeletonManagerService.getSkeleton(),g=c.getEditArea(),{editArea:u,pageNumber:h}=A.findEditAreaByCoord(d,o,a,l);if(g===u)return;c.setEditArea(u);const{createType:p,headerFooterId:f}=Dc(c,u,h);if(u===Ee.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(s,r);else if(p!=null){const m=ue(6);this._docSelectionRenderService.setSegment(m),this._docSelectionRenderService.setSegmentPage(h),await this._commandService.executeCommand(nl.id,{unitId:e,createType:p,segmentId:m})}else f!=null&&(this._docSelectionRenderService.setSegment(f),this._docSelectionRenderService.setSegmentPage(h),this._docSelectionRenderService.setCursorManually(s,r))}))}_getTransformCoordForDocumentOffset(e,t){const n=lt(this._context),{document:i,scene:s}=n,{documentTransform:r}=i.getOffsetConfig(),o=s.getViewports()[0];if(o==null)return;const a=o.transformVector2SceneCoord(fn.FromArray([e,t]));return r.clone().invert().applyPoint(a)}_drawHeaderFooterLabel(){const e=this._localeService;this.disposeWithMe(this._instanceSrv.getCurrentTypeOfUnit$(N.UNIVER_DOC).subscribe(t=>{if(t==null)return;const n=t.getUnitId(),i=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||i==null)return;const{mainComponent:s}=i,r=s;this.disposeWithMe(bn(r.pageRender$.subscribe(o=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const a=this._docSkeletonManagerService.getViewModel().getEditArea()===Ee.BODY,{page:l,pageLeft:d,pageTop:c,ctx:A}=o,{pageWidth:g,pageHeight:u,marginTop:h,marginBottom:p}=l;if(A.save(),A.translate(d-.5,c-.5),a?(Vn.drawWith(A,{left:0,top:0,width:g,height:h,fill:"rgba(255, 255, 255, 0.5)"}),A.save(),A.translate(0,u-p),Vn.drawWith(A,{left:0,top:0,width:g,height:p,fill:"rgba(255, 255, 255, 0.5)"}),A.restore()):(A.save(),A.translate(0,h),Vn.drawWith(A,{left:0,top:h,width:g,height:u-h-p,fill:"rgba(255, 255, 255, 0.5)"}),A.restore()),!a){const f={dataArray:[{command:"M",points:[0,h]},{command:"L",points:[g,h]}],strokeWidth:1,stroke:ho},m={dataArray:[{command:"M",points:[0,u-p]},{command:"L",points:[g,u-p]}],strokeWidth:1,stroke:ho};Ur.drawWith(A,f),Ur.drawWith(A,m),A.translate(0,h+1),ti.drawWith(A,{text:e.t("headerFooter.header"),color:go}),A.translate(0,u-h-p),ti.drawWith(A,{text:e.t("headerFooter.footer"),color:go})}A.restore()})))}))}_isEditorReadOnly(e){const t=this._editorService.getEditor(e);return t?t.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===Te.TRADITIONAL}};hs=_c([st(1,T),st(2,Ue),st(3,U),st(4,ce),st(5,W(ae)),st(6,W(Ie)),st(7,W(Fe)),st(8,W(Xt))],hs);const Er={id:"sidebar.operation.doc-header-footer-panel",type:D.OPERATION,handler:async(e,t)=>{const n=e.get(ta),i=e.get(Fe);return t.value==="open"?n.open({header:{title:i.t("headerFooter.panel")},children:{label:us},onClose:()=>{},width:400}):n.close(),!0}};function po(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function qi(e,t,n,i){const s=V.getInstance(),r=6,o=e??ue(r),a=t===we.DEFAULT_HEADER||t===we.FIRST_PAGE_HEADER||t===we.EVEN_PAGE_HEADER,l=s.insertOp([a?"headers":"footers",o],{[a?"headerId":"footerId"]:o,body:po()});i.push(l);const d=ue(r),c=s.insertOp([a?"footers":"headers",d],{[a?"footerId":"headerId"]:d,body:po()});i.push(c);let A="defaultHeaderId",g="defaultFooterId";switch(t){case we.DEFAULT_HEADER:A="defaultHeaderId",g="defaultFooterId";break;case we.DEFAULT_FOOTER:A="defaultFooterId",g="defaultHeaderId";break;case we.FIRST_PAGE_HEADER:A="firstPageHeaderId",g="firstPageFooterId";break;case we.FIRST_PAGE_FOOTER:A="firstPageFooterId",g="firstPageHeaderId";break;case we.EVEN_PAGE_HEADER:A="evenPageHeaderId",g="evenPageFooterId";break;case we.EVEN_PAGE_FOOTER:A="evenPageFooterId",g="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[u,h]of[[A,o],[g,d]])if(n[u]!=null){const p=s.replaceOp(["documentStyle",u],n[u],h);i.push(p)}else{const p=s.insertOp(["documentStyle",u],h);i.push(p)}return i}const Yn="doc.command.core-header-footer",nl={id:Yn,type:D.COMMAND,handler:async(e,t)=>{var n;const i=e.get(T),s=e.get(U),r=e.get(ce),{unitId:o,segmentId:a,createType:l,headerFooterProps:d}=t,c=(n=r.getRenderById(o))==null?void 0:n.with(ae),A=s.getUniverDocInstance(o),g=c?.getViewModel();if(A==null||g==null)return!1;const u=g.getEditArea(),{documentStyle:h}=A.getSnapshot(),p=d?.marginFooter!=null||d?.marginHeader!=null,f=[{startOffset:0,endOffset:0,collapsed:!0}],m={id:X.id,params:{unitId:o,actions:[],textRanges:f,debounce:!0}};p&&(m.params.noNeedSetTextRange=!0);const C=V.getInstance(),v=[];return l!=null&&qi(a,l,h,v),d!=null&&Object.keys(d).forEach(I=>{const E=d[I],S=h[I];if(E===S)return;let R;if(S===void 0?R=C.insertOp(["documentStyle",I],E):R=C.replaceOp(["documentStyle",I],S,E),v.push(R),I==="useFirstPageHeaderFooter"&&E===z.TRUE&&!h.firstPageHeaderId){const b=u===Ee.HEADER?we.FIRST_PAGE_HEADER:we.FIRST_PAGE_FOOTER;qi(a,b,h,v)}else if(I==="evenAndOddHeaders"&&E===z.TRUE&&!h.evenPageHeaderId){const b=u===Ee.HEADER?we.EVEN_PAGE_HEADER:we.EVEN_PAGE_FOOTER;qi(a,b,h,v)}}),v.length===0?!1:(m.params.actions=v.reduce((I,E)=>V.compose(I,E),null),!!i.syncExecuteCommand(m.id,m.params))}},Ir={id:"doc.command.open-header-footer-panel",type:D.COMMAND,handler:async(e,t)=>e.get(T).executeCommand(Er.id,{value:"open"})},Cr={id:"doc.command.close-header-footer",type:D.COMMAND,handler:async(e,t)=>{var n;const i=e.get(T),s=e.get(ce),r=e.get(Y),o=e.get(U),{unitId:a}=t,l=s.getRenderById(a);if(l==null)return!1;const{scene:d}=l,c=d.getTransformerByCreate(),A=l.with(ae),g=l.with(Ie),u=A?.getSkeleton(),h=A?.getViewModel();return h==null||u==null?!1:(r.replaceDocRanges([]),c.clearSelectedObjects(),g.setSegment(""),g.setSegmentPage(-1),h.setEditArea(Ee.BODY),u.calculate(),(n=l.mainComponent)==null||n.makeDirty(!0),queueMicrotask(()=>{const p=o.getUnit(a),f=p?.getSnapshot();if(f==null)return;const m=tl(f);r.replaceDocRanges([{startOffset:m,endOffset:m}])}),i.executeCommand(Er.id,{value:"close"}),!0)}},il="UI_PLUGIN_DOCS",sl=e=>{const{value:t,onChange:n,options:i}=e;return B.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:i.map(s=>B.jsx("a",{className:ke("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",Tn,{"univer-border-primary-500":t===s.value}),onClick:()=>{n(s.value)},children:B.jsx("img",{className:"univer-size-full",src:s.img,draggable:!1})},s.value))})},Qc=[{value:Se.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:Se.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:Se.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:Se.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:Se.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:Se.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],Pc=e=>B.jsx(sl,{...e,options:Qc}),Uc=[{value:Se.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:Se.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:Se.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:Se.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:Se.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:Se.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],Lc=e=>B.jsx(sl,{...e,options:Uc}),rl=`${il}_ORDER_LIST_TYPE_COMPONENT`,ol=`${il}_BULLET_LIST_TYPE_COMPONENT`,Hc=e=>{const t=Object.keys(Zn).find(n=>{const{width:i,height:s}=Zn[n];return e.width===i&&e.height===s});return t??"A4"};function kc(e){const{hooks:t}=e,n=J(U).getCurrentUnitOfType(N.UNIVER_DOC).getDocumentStyle(),i=J(Fe),[s,r]=M.useState(()=>{var l,d,c,A,g,u,h,p,f;return{paperSize:Hc(n.pageSize),pageSise:{width:(d=(l=n.pageSize)==null?void 0:l.width)!=null?d:0,height:(A=(c=n.pageSize)==null?void 0:c.height)!=null?A:0},orientation:(g=n.pageOrient)!=null?g:Dl.PORTRAIT,margins:{top:(u=n.marginTop)!=null?u:0,bottom:(h=n.marginBottom)!=null?h:0,left:(p=n.marginLeft)!=null?p:0,right:(f=n.marginRight)!=null?f:0}}});M.useEffect(()=>{t.beforeClose=()=>s,t.beforeConfirm=()=>s},[s]);const o=l=>{r(d=>({...d,paperSize:l,pageSise:Zn[l]}))},a=(l,d)=>{r(c=>({...c,margins:{...c.margins,[l]:d||0}}))};return B.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[B.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:i.t("page-settings.paper-size")}),B.jsx(ra,{value:s.paperSize,onChange:o,options:Ql.map(l=>({label:i.t(`page-settings.page-size.${l.toLocaleLowerCase()}`),value:l}))})]}),B.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:!univer-text-white",children:i.t("page-settings.custom-paper-size")}),B.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[B.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[B.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:i.t("page-settings.top")}),B.jsx(Je,{precision:2,max:s.pageSise.height/2,value:s.margins.top,onChange:l=>a("top",l)})]}),B.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:i.t("page-settings.bottom")}),B.jsx(Je,{precision:2,max:s.pageSise.height/2,value:s.margins.bottom,onChange:l=>a("bottom",l)})]})]}),B.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[B.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:i.t("page-settings.left")}),B.jsx(Je,{precision:2,max:s.pageSise.width/2,value:s.margins.left,onChange:l=>a("left",l)})]}),B.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[B.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:i.t("page-settings.right")}),B.jsx(Je,{precision:2,max:s.pageSise.width/2,value:s.margins.right,onChange:l=>a("right",l)})]})]})]})]})]})}const gs="docs.component.page-setting",al={id:"docs.command.page-setup",type:D.COMMAND,handler:(e,t)=>{if(!t)return!1;const n=e.get(U),i=e.get(T),s=n.getCurrentUnitOfType(N.UNIVER_DOC);if(!s)return!1;const{marginLeft:r,marginRight:o,marginBottom:a,marginTop:l,pageOrient:d,pageSize:c}=t,A=V.getInstance(),g=s.getDocumentStyle(),{marginBottom:u,marginLeft:h,marginRight:p,marginTop:f,pageOrient:m,pageSize:C}=g,v=[];if(u===void 0){const E=A.insertOp(["documentStyle","marginBottom"],a);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","marginBottom"],u,a);E&&v.push(E)}if(h===void 0){const E=A.insertOp(["documentStyle","marginLeft"],r);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","marginLeft"],h,r);E&&v.push(E)}if(p===void 0){const E=A.insertOp(["documentStyle","marginRight"],o);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","marginRight"],p,o);E&&v.push(E)}if(f===void 0){const E=A.insertOp(["documentStyle","marginTop"],l);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","marginTop"],f,l);E&&v.push(E)}if(C===void 0){const E=A.insertOp(["documentStyle","pageSize"],c);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","pageSize"],C,c);E&&v.push(E)}if(m===void 0){const E=A.insertOp(["documentStyle","pageOrient"],d);E&&v.push(E)}else{const E=A.replaceOp(["documentStyle","pageOrient"],m,d);E&&v.push(E)}const I={id:X.id,params:{unitId:s.getUnitId(),actions:[],textRanges:void 0}};return I.params.actions=v.reduce((E,S)=>V.compose(E,S),null),!!i.syncExecuteCommand(I.id,I.params)}},Sr={id:"docs.operation.open-page-setting",type:D.OPERATION,handler:e=>{const t=e.get(Lo),n=e.get(T),i=e.get(Fe),s=t.open({id:gs,title:{label:i.t("page-settings.document-setting")},children:{label:gs},width:528,onClose:()=>{s.dispose()},onConfirm:r=>{if(s.dispose(),!r)return;const o=Zn[r.paperSize];n.executeCommand(al.id,{pageOrient:r.orientation,marginTop:r.margins.top,marginBottom:r.margins.bottom,marginLeft:r.margins.left,marginRight:r.margins.right,pageSize:o})},confirmText:i.t("page-settings.confirm"),cancelText:i.t("page-settings.cancel")});return!0}};function Fc(e){const t=e.get(U),n=e.get(ce);return new he(i=>{const s=t.focused$.subscribe(r=>{if(r==null||t.getUnitType(r)!==N.UNIVER_DOC)return i.next(!0);const o=n.getRenderById(r);if(o==null)return i.next(!0);o.with(ae).getViewModel().editAreaChange$.subscribe(a=>{i.next(a===Ee.HEADER||a===Ee.FOOTER)})});return()=>s.unsubscribe()})}function Vc(e){const t=e.get(U),n=e.get(T);return new he(i=>{const s=n.onCommandExecuted(l=>{if(l.id===X.id){const{unitId:d}=l.params,c=t.getUnit(d);if(c==null){i.next(!0);return}const{documentStyle:A}=c.getSnapshot();i.next(A?.documentFlavor!==Te.TRADITIONAL)}}),r=t.focused$.subscribe(l=>{if(l==null)return i.next(!0);const d=t.getUniverDocInstance(l),c=d?.getSnapshot().documentStyle.documentFlavor;i.next(c!==Te.TRADITIONAL)}),o=t.getCurrentUniverDocInstance();if(o==null)return i.next(!0);const a=o?.getSnapshot().documentStyle.documentFlavor;return i.next(a!==Te.TRADITIONAL),()=>{s.dispose(),r.unsubscribe()}})}function jc(e){const t=e.get(Y),n=e.get(U);return new he(i=>{const s=t.textSelection$.subscribe(r=>{if(r==null){i.next(!0);return}const{textRanges:o}=r;if(o.length!==1){i.next(!0);return}const a=o[0],{collapsed:l,startNodePosition:d,startOffset:c}=a;if(!l||c==null){i.next(!0);return}const A=n.getCurrentUniverDocInstance();if(A==null){i.next(!0);return}const g=Ve(e,A.getUnitId());if(g==null){i.next(!0);return}if(g.getViewModel().getCustomRangeRaw(c)){i.next(!0);return}if(d!=null){const{path:u}=d;if(u.indexOf("cells")!==-1){i.next(!0);return}}i.next(!1)});return()=>s.unsubscribe()})}function xe(e){const t=e.get(Y);return new he(n=>{const i=t.textSelection$.subscribe(s=>{if(s==null){n.next(!0);return}const{textRanges:r,rectRanges:o}=s;if(r.length===0&&o.length===0){n.next(!0);return}n.next(!1)});return()=>i.unsubscribe()})}function Wc(e){const t=e.get(T);return{id:Bt.id,type:$.BUTTON,icon:"BoldIcon",title:"Set bold",tooltip:"toolbar.bold",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.bl;n.next(a===z.TRUE)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function zc(e){const t=e.get(T);return{id:Mt.id,type:$.BUTTON,icon:"ItalicIcon",title:"Set italic",tooltip:"toolbar.italic",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.it;n.next(a===z.TRUE)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Gc(e){const t=e.get(T);return{id:wt.id,type:$.BUTTON,icon:"UnderlineIcon",title:"Set underline",tooltip:"toolbar.underline",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.ul;n.next(a?.s===z.TRUE)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Yc(e){const t=e.get(T);return{id:Nt.id,type:$.BUTTON,icon:"StrikethroughIcon",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.st;n.next(a?.s===z.TRUE)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function qc(e){const t=e.get(T);return{id:pt.id,type:$.BUTTON,icon:"SubscriptIcon",tooltip:"toolbar.subscript",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.va;n.next(a===Qe.SUBSCRIPT)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Kc(e){const t=e.get(T);return{id:_t.id,type:$.BUTTON,icon:"SuperscriptIcon",tooltip:"toolbar.superscript",activated$:new he(n=>{const i=()=>{var r;const o=qe(e);if(o==null){n.next(!1);return}const a=(r=o.ts)==null?void 0:r.va;n.next(a===Qe.SUPERSCRIPT)},s=t.onCommandExecuted(r=>{const o=r.id;(o===Me.id||o===ft.id)&&i()});return i(),s.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Zc(e){const t=e.get(T);return{id:St.id,tooltip:"toolbar.font",type:$.SELECTOR,label:vd,selections:[{label:{name:md,hoverable:!1,selectable:!1,props:{id:St.id}}}],value$:new he(n=>{const i=mi.ff,s=()=>{var o;const a=qe(e);if(a==null){n.next(i);return}const l=(o=a.ts)==null?void 0:o.ff;n.next(l??i)},r=t.onCommandExecuted(o=>{const a=o.id;(a===Me.id||a===St.id)&&s()});return s(),r.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Jc(e){const t=e.get(T);return{id:tt.id,type:$.SELECTOR,tooltip:"toolbar.fontSize",label:{name:Id,props:{min:1,max:400}},selections:Ed,value$:new he(n=>{const i=mi.fs,s=()=>{var o;const a=qe(e);if(a==null){n.next(i);return}const l=(o=a.ts)==null?void 0:o.fs;n.next(l??i)},r=t.onCommandExecuted(o=>{const a=o.id;(a===Me.id||a===tt.id)&&s()});return s(),r.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function Xc(e){const t=e.get(T);return{id:We.id,type:$.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:Cd,props:{selections:Fr}},selections:Fr.map(n=>({label:{name:Sd,props:{value:n.value,text:n.label}},value:n.value})),value$:new he(n=>{const i=q.NORMAL_TEXT,s=()=>{var o,a;const l=Dt(e);if(l==null){n.next(i);return}const d=(a=(o=l.paragraphStyle)==null?void 0:o.namedStyleType)!=null?a:i;n.next(d)},r=t.onCommandExecuted(o=>{const a=o.id;(a===Me.id||a===tt.id)&&s()});return s(),r.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function $c(e){const t=e.get(T),n=e.get(ys);return{id:dt.id,icon:"FontColorDoubleIcon",tooltip:"toolbar.textColor.main",type:$.BUTTON_SELECTOR,selections:[{label:{name:$o,hoverable:!1,selectable:!1},value$:new he(i=>{const s=mi.cl.rgb,r=()=>{var a,l;const d=qe(e);if(!d){i.next(s);return}const c=(l=(a=d.ts)==null?void 0:a.cl)==null?void 0:l.rgb;i.next(c??s)},o=t.onCommandExecuted(a=>{a.id===dt.id&&r()});return r(),o.dispose})}],value$:new he(i=>{const s=n.getColorFromTheme("gray.900"),r=t.onCommandExecuted(o=>{if(o.id===dt.id){const a=o.params.value;i.next(a??s)}});return i.next(s),r.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function eu(e){return{id:Ir.id,type:$.BUTTON,icon:"HeaderFooterIcon",tooltip:"toolbar.headerFooter",hidden$:yn(ne(e,N.UNIVER_DOC,void 0,Ye),Vc(e),(t,n)=>t||n)}}const tu="GridIcon",ll="doc.menu.table";function nu(e){return{id:ll,type:$.SUBITEMS,icon:tu,tooltip:"toolbar.table.main",disabled$:jc(e),hidden$:yn(ne(e,N.UNIVER_DOC,void 0,Ye),Fc(e),(t,n)=>t||n)}}function iu(e){return{id:vr.id,title:"toolbar.table.insert",type:$.BUTTON,hidden$:ne(e,N.UNIVER_DOC)}}function su(e){const t=e.get(T);return{id:Mi.id,type:$.BUTTON,icon:"LeftJustifyingIcon",tooltip:"toolbar.alignLeft",disabled$:xe(e),activated$:new he(n=>{const i=t.onCommandExecuted(s=>{var r;const o=s.id;if(o===Me.id||o===nt.id){const a=Dt(e);if(a==null)return;const l=(r=a.paragraphStyle)==null?void 0:r.horizontalAlign;n.next(l===Ne.LEFT)}});return n.next(!1),i.dispose}),hidden$:ne(e,N.UNIVER_DOC,void 0,Ye)}}function ru(e){const t=e.get(T);return{id:wi.id,type:$.BUTTON,icon:"HorizontallyIcon",tooltip:"toolbar.alignCenter",activated$:new he(n=>{const i=t.onCommandExecuted(s=>{var r;const o=s.id;if(o===Me.id||o===nt.id){const a=Dt(e);if(a==null)return;const l=(r=a.paragraphStyle)==null?void 0:r.horizontalAlign;n.next(l===Ne.CENTER)}});return n.next(!1),i.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC,void 0,Ye)}}function ou(e){const t=e.get(T);return{id:Ni.id,type:$.BUTTON,icon:"RightJustifyingIcon",tooltip:"toolbar.alignRight",activated$:new he(n=>{const i=t.onCommandExecuted(s=>{var r;const o=s.id;if(o===Me.id||o===nt.id){const a=Dt(e);if(a==null)return;const l=(r=a.paragraphStyle)==null?void 0:r.horizontalAlign;n.next(l===Ne.RIGHT)}});return n.next(!1),i.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC,void 0,Ye)}}function au(e){const t=e.get(T);return{id:_i.id,type:$.BUTTON,icon:"AlignTextBothIcon",tooltip:"toolbar.alignJustify",activated$:new he(n=>{const i=t.onCommandExecuted(s=>{var r;const o=s.id;if(o===Me.id||o===nt.id){const a=Dt(e);if(a==null)return;const l=(r=a.paragraphStyle)==null?void 0:r.horizontalAlign;n.next(l===Ne.JUSTIFIED)}});return n.next(!1),i.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC,void 0,Ye)}}function lu(e){return{id:Oi.id,type:$.BUTTON,icon:"ReduceIcon",tooltip:"toolbar.horizontalLine",disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC,void 0,Ye)}}const Sn=e=>new he(t=>{const n=e.get(U),i=e.get(Y);let s;const r=n.focused$.subscribe(o=>{if(s?.unsubscribe(),o==null)return;const a=n.getUniverDocInstance(o);a!=null&&(s=i.textSelection$.subscribe(()=>{var l,d,c,A,g;const u=i.getDocRanges(),h=(l=u.find(p=>p.isActive))!=null?l:u[0];if(h){const p=a.getSelfOrHeaderFooterModel(h?.segmentId),f=re.range.getParagraphsInRange(h,(c=(d=p.getBody())==null?void 0:d.paragraphs)!=null?c:[],(g=(A=p.getBody())==null?void 0:A.dataStream)!=null?g:"");let m;if(f.every(C=>{var v;return m||(m=(v=C.bullet)==null?void 0:v.listType),C.bullet&&C.bullet.listType===m})){t.next(m);return}}t.next(void 0)}))});return()=>{r.unsubscribe(),s?.unsubscribe()}});function fo(e){return{id:Cn.id,type:$.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:rl,hoverable:!1,selectable:!1},value$:Sn(e)}],icon:"OrderIcon",tooltip:"toolbar.order",hidden$:ne(e,N.UNIVER_DOC),disabled$:xe(e),activated$:Sn(e).pipe(Zt(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function mo(e){return{id:In.id,type:$.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:ol,hoverable:!1,selectable:!1},value$:Sn(e)}],icon:"UnorderIcon",tooltip:"toolbar.unorder",disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC),activated$:Sn(e).pipe(Zt(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function vo(e){return{id:$n.id,type:$.BUTTON,icon:"TodoListDoubleIcon",tooltip:"toolbar.checklist",disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC),activated$:Sn(e).pipe(Zt(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function du(e){const t=e.get(T),n=e.get(U);return{id:Di.id,type:$.BUTTON,icon:"KeyboardIcon",tooltip:"toolbar.documentFlavor",hidden$:ne(e,N.UNIVER_DOC,void 0,Ye),activated$:new he(i=>{var s;const r=t.onCommandExecuted(a=>{var l;if(a.id===X.id){const d=n.getCurrentUnitForType(N.UNIVER_DOC);i.next(((l=d?.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===Te.MODERN)}}),o=n.getCurrentUnitForType(N.UNIVER_DOC);return i.next(((s=o?.getSnapshot())==null?void 0:s.documentStyle.documentFlavor)===Te.MODERN),()=>r.dispose()})}}function Au(e){return{id:wn.id,type:$.BUTTON,title:"toolbar.resetColor",icon:"NoColorDoubleIcon"}}function cu(e){const t=e.get(T),n=e.get(ys);return{id:At.id,tooltip:"toolbar.fillColor.main",type:$.BUTTON_SELECTOR,icon:"PaintBucketDoubleIcon",selections:[{label:{name:$o,hoverable:!1,selectable:!1},value$:new he(i=>{const s=mi.bg.rgb,r=()=>{var a,l;const d=qe(e);if(!d){i.next(s);return}const c=(l=(a=d.ts)==null?void 0:a.bg)==null?void 0:l.rgb;i.next(c??s)},o=t.onCommandExecuted(a=>{a.id===At.id&&r()});return r(),o.dispose})}],value$:new he(i=>{const s=n.getColorFromTheme("primary.600"),r=t.onCommandExecuted(o=>{if(o.id===At.id){const a=o.params.value;i.next(a??s)}});return i.next(s),r.dispose}),disabled$:xe(e),hidden$:ne(e,N.UNIVER_DOC)}}function qe(e){var t,n,i,s;const r=e.get(U),o=e.get(Y),a=e.get(et),l=r.getCurrentUnitForType(N.UNIVER_DOC),d=o.getDocRanges(),c=(t=d.find(C=>C.isActive))!=null?t:d[0],A=a.getDefaultStyle(),g=(n=a.getStyleCache())!=null?n:{},u=Dt(e),h=(i=u?.paragraphStyle)!=null&&i.namedStyleType?Fl[(s=u?.paragraphStyle)==null?void 0:s.namedStyleType]:null;if(l==null||c==null)return{ts:{...A,...h,...g}};const{segmentId:p}=c,f=l.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return{ts:{...A,...h,...g}};const m=Sa(f,c,{});return de.deleteNull(m),{ts:{...A,...h,...m,...g}}}function Dt(e){var t,n;const i=e.get(U),s=e.get(Y),r=i.getCurrentUniverDocInstance(),o=s.getDocRanges(),a=(t=o.find(g=>g.isActive))!=null?t:o[0];if(r==null||a==null)return;const{startOffset:l,segmentId:d}=a,c=(n=r.getSelfOrHeaderFooterModel(d).getBody())==null?void 0:n.paragraphs;if(c==null)return;let A=-1;for(const g of c){const{startIndex:u}=g;if(l>A&&l<=u)return g;A=u}return null}function uu(e){return{id:Sr.id,type:$.BUTTON,icon:"DocumentSettingIcon",tooltip:"toolbar.pageSetup",hidden$:ne(e,N.UNIVER_DOC)}}const hu={[q.HEADING_1]:ir,[q.HEADING_2]:sr,[q.HEADING_3]:rr,[q.HEADING_4]:or,[q.HEADING_5]:ar,[q.NORMAL_TEXT]:ei,[q.TITLE]:Ba,[q.SUBTITLE]:Ma,[q.NAMED_STYLE_TYPE_UNSPECIFIED]:ei},dl={[q.HEADING_1]:{key:"H1Icon",component:za},[q.HEADING_2]:{key:"H2Icon",component:Ga},[q.HEADING_3]:{key:"H3Icon",component:Ya},[q.HEADING_4]:{key:"H4Icon",component:qa},[q.HEADING_5]:{key:"H5Icon",component:Ka},[q.NORMAL_TEXT]:{key:"TextTypeIcon",component:An},[q.TITLE]:{key:"TextTypeIcon",component:An},[q.SUBTITLE]:{key:"TextTypeIcon",component:An},[q.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeIcon",component:An}},mt=e=>t=>{const n=t.get(T),i=t.get(Xt),s=dl[e];return i.get(s.key)||i.register(s.key,s.component),{id:hu[e].id,type:$.BUTTON,icon:s.key,tooltip:"toolbar.heading.tooltip",disabled$:xe(t),hidden$:ne(t,N.UNIVER_DOC),activated$:new he(r=>{const o=q.NORMAL_TEXT,a=()=>{var d,c;const A=Dt(t);if(A==null){r.next(o===e);return}const g=(c=(d=A.paragraphStyle)==null?void 0:d.namedStyleType)!=null?c:o;r.next(g===e)},l=n.onCommandExecuted(d=>{const c=d.id;(c===Me.id||c===tt.id)&&a()});return a(),l.dispose})}},gu=mt(q.HEADING_1),pu=mt(q.HEADING_2),fu=mt(q.HEADING_3),mu=mt(q.HEADING_4),vu=mt(q.HEADING_5),Eu=mt(q.NORMAL_TEXT);mt(q.TITLE);mt(q.SUBTITLE);const Iu=e=>({id:qs.id,type:$.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy"}),Cu=e=>({id:Zs.id,type:$.BUTTON,icon:"CutIcon",title:"rightClick.cut"}),Su=e=>({id:zs.id,type:$.BUTTON,icon:"DeleteIcon",title:"rightClick.delete"}),xu=e=>({id:er.id,type:$.BUTTON,icon:"UnorderIcon",title:"rightClick.bulletList"}),bu=e=>({id:tr.id,type:$.BUTTON,icon:"OrderIcon",title:"rightClick.orderList"}),Ru=e=>({id:nr.id,type:$.BUTTON,icon:"TodoListDoubleIcon",title:"rightClick.checkList"}),yu=e=>({id:Xs.id,type:$.BUTTON,icon:"ReduceIcon",title:"toolbar.horizontalLine"}),Al="doc.menu.insert-bellow";function Ou(e){return{id:Al,type:$.SUBITEMS,title:"rightClick.insertBellow"}}const Eo=4;var Tu=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Un=(e,t)=>(n,i)=>t(n,i,e);function cl(e,t){const n=Io(e.left,e.top,t),i=Io(e.right,e.bottom,t);return{left:n.x,top:n.y,right:i.x,bottom:i.y}}function Io(e,t,n){const{scaleX:i,scaleY:s}=n.getAncestorScale(),r=n.getViewport(Pe.VIEW_MAIN);if(!r)return{x:e,y:t};const{viewportScrollX:o,viewportScrollY:a}=r,l=(e-o)*i,d=(t-a)*s;return{x:l,y:d}}function Co(e,t,n){const{scaleX:i,scaleY:s}=n.getAncestorScale(),r=n.getViewport(Pe.VIEW_MAIN);if(!r)return{x:e,y:t};const{viewportScrollX:o,viewportScrollY:a}=r,l=e/i+o,d=t/s+a;return{x:l,y:d}}const Ki=(e,t)=>{const{scene:n,mainComponent:i,engine:s}=t,r=t.with(ae).getSkeleton(),o=r.findNodePositionByCharIndex(e.startOffset,!0,e.segmentId,e.segmentPage),a=e.collapsed?e.startOffset:e.endOffset-1,l=r.findNodePositionByCharIndex(a,!0,e.segmentId,e.segmentPage),d=i;if(!l||!o)return;const c=d.getOffsetConfig(),{docsLeft:A,docsTop:g}=c,u=s.getCanvasElement(),h=u.getBoundingClientRect(),p=Ko(u.style.width),{top:f,left:m,width:C}=h,v=C/p,{scaleX:I,scaleY:E}=n.getAncestorScale(),S=new ct(c,r),{borderBoxPointGroup:R}=S.getRangePointData(o,l);return dr(R).map(b=>cl(b,n)).map(b=>({left:(b.left+A*I)*v+m,right:(b.right+A*I)*v+m,top:(b.top+g*E)*v+f,bottom:(b.bottom+g*E)*v+f}))};let xn=class extends pe{constructor(e,t,n,i){super(),this._globalPopupManagerService=e,this._renderManagerService=t,this._univerInstanceService=n,this._commandService=i}_createRectPositionObserver(e,t){const n=()=>{const{scene:a,engine:l}=t,d=typeof e=="function"?e():e,c=l.getCanvasElement(),A=c.getBoundingClientRect(),g=Ko(c.style.width),u=cl(d,a),{top:h,left:p,width:f}=A,m=f/g;return{left:u.left*m+p,right:u.right*m+p,top:u.top*m+h,bottom:u.bottom*m+h}},i=n(),s=new _e(i),r=new un;r.add(this._commandService.onCommandExecuted(a=>{if(a.id===Ge.id||a.id===X.id){const l=n();l&&s.next(l)}}));const o=t.scene.getViewport(Pe.VIEW_MAIN);return o&&r.add(o.onScrollAfter$.subscribeEvent(()=>{s.next(n())})),{position:i,position$:s,disposable:r}}_createObjectPositionObserver(e,t){const n=()=>{const{left:i,top:s,width:r,height:o}=e;return{left:i,right:i+r,top:s,bottom:s+o}};return this._createRectPositionObserver(n,t)}_createRangePositionObserver(e,t){var n;const i=(n=Ki(e,t))!=null?n:[],s=new _e(i),r=new un;r.add(this._commandService.onCommandExecuted(a=>{if((a.id===Ge.id||a.id===X.id)&&a.params.unitId===t.unitId){const l=Ki(e,t);l&&s.next(l)}}));const o=t.scene.getViewport(Pe.VIEW_MAIN);return o&&r.add(o.onScrollAfter$.subscribeEvent(()=>{const a=Ki(e,t);a&&s.next(a)})),{positions:i,positions$:s,disposable:r}}attachPopupToRect(e,t,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:s,position$:r,disposable:o}=this._createRectPositionObserver(e,i),a=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:s,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(a),r.complete(),o.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==a}}attachPopupToObject(e,t,n){const i=this._renderManagerService.getRenderById(n);if(!i)throw new Error(`Current render not found, unitId: ${n}`);const{position:s,position$:r,disposable:o}=this._createObjectPositionObserver(e,i),a=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:s,anchorRect$:r,canvasElement:i.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(a),r.complete(),o.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==a}}attachPopupToRange(e,t,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:i="top",multipleDirection:s}=t,r=this._renderManagerService.getRenderById(n);if(!r)throw new Error(`Current render not found, unitId: ${n}`);const{positions:o,positions$:a,disposable:l}=this._createRangePositionObserver(e,r),d=a.pipe(Zt(A=>i.includes("top")?A[0]:A[A.length-1])),c=this._globalPopupManagerService.addPopup({...t,unitId:n,subUnitId:"default",anchorRect:i.includes("top")?o[0]:o[o.length-1],anchorRect$:d,excludeRects:o,excludeRects$:a,direction:["top","bottom","horizontal"].some(A=>i.includes(A))&&o.length>1&&s!=null?s:i,canvasElement:r.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(c),a.complete(),l.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==c}}};xn=Tu([Un(0,W(Dd)),Un(1,ce),Un(2,U),Un(3,T)],xn);var Bu=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Mu=(e,t)=>(n,i)=>t(n,i,e);const wu=(e,t,n,i)=>{var s,r,o,a,l;const d=n.findNodePositionByCharIndex(e.startOffset,!0,e.segmentId,i),c=n.getSkeletonData();let A=e.endOffset-1;if(e.segmentId){const f=(l=Array.from((r=(s=c?.skeFooters.get(e.segmentId))==null?void 0:s.values())!=null?r:[])[0])!=null?l:Array.from((a=(o=c?.skeHeaders.get(e.segmentId))==null?void 0:o.values())!=null?a:[])[0];f&&(A=Math.min(f.ed,A))}const g=n.findNodePositionByCharIndex(A,!0,e.segmentId,i);if(!g||!d)return;const u=t.getOffsetConfig(),h=new ct(u,n),{borderBoxPointGroup:p}=h.getRangePointData(d,g);return dr(p).map(f=>({top:f.top+u.docsTop-Eo,bottom:f.bottom+u.docsTop+Eo,left:f.left+u.docsLeft,right:f.right+u.docsLeft}))},So=(e,t,n,i)=>{const s=[];for(const r of e){const o=r.top;for(const a of r.columns){const l=a.left,d=r.colCount===1?i:a.width;let c=null;for(const A of a.lines){const g=A.paragraphIndex;if(A.paragraphStart){c&&(s.push(c),c=null);const u={top:t+o+A.top,left:n+l,right:n+l+d,bottom:t+o+A.top+A.lineHeight};c={paragraphStart:A.st,paragraphEnd:g,startIndex:g,rect:u,fisrtLine:{top:t+o+A.top+A.marginTop+A.paddingTop,left:n+l,right:n+l+d,bottom:t+o+A.top+A.marginTop+A.paddingTop+A.contentHeight}}}else c&&c.startIndex===g&&(c.rect.bottom=t+o+A.top+A.lineHeight)}c&&s.push(c)}}return s},Nu=(e,t,n,i=-1)=>{const s=n.findPositionByGlyph(e,i);if(!s)return;const r=t.getOffsetConfig(),o={...s,isBack:!0},a=new ct(r,n),{borderBoxPointGroup:l}=a.getRangePointData(o,o),d=dr(l)[0];return{top:d.top+r.docsTop,bottom:d.bottom+r.docsTop,left:d.left+r.docsLeft,right:d.left+r.docsLeft+e.width}};function Et(e,t,n){const{left:i,right:s,top:r,bottom:o}=n;return e>=i&&e<=s&&t>=r&&t<=o}let yt=class extends pe{constructor(e,t){super(),y(this,"_hoverCustomRanges$",new _e([])),y(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(Ut((n,i)=>n.length===i.length&&n.every((s,r)=>i[r].range.rangeId===s.range.rangeId&&i[r].segmentId===s.segmentId&&i[r].segmentPageIndex===s.segmentPageIndex&&i[r].range.startIndex===s.range.startIndex)))),y(this,"_clickCustomRanges$",new Ce),y(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable()),y(this,"_hoverBullet$",new Ce),y(this,"hoverBullet$",this._hoverBullet$.pipe(Ut((n,i)=>n?.paragraph.startIndex===i?.paragraph.startIndex&&n?.segmentId===i?.segmentId&&n?.segmentPageIndex===i?.segmentPageIndex))),y(this,"_clickBullet$",new Ce),y(this,"clickBullets$",this._clickBullet$.asObservable()),y(this,"_hoverParagraph$",new _e(null)),y(this,"hoverParagraph$",this._hoverParagraph$.pipe(Ut((n,i)=>n?.startIndex===i?.startIndex&&n?.segmentId===i?.segmentId&&n?.pageIndex===i?.pageIndex))),y(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable()),y(this,"_hoverParagraphLeft$",new _e(null)),y(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(Ut((n,i)=>n?.startIndex===i?.startIndex&&n?.segmentId===i?.segmentId&&n?.pageIndex===i?.pageIndex))),y(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable()),y(this,"_hoverTableCell$",new Ce),y(this,"hoverTableCell$",this._hoverTableCell$.pipe(Ut((n,i)=>n?.rowIndex===i?.rowIndex&&n?.colIndex===i?.colIndex&&n?.tableId===i?.tableId&&n?.pageIndex===i?.pageIndex))),y(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable()),y(this,"_hoverTable$",new Ce),y(this,"hoverTable$",this._hoverTable$.pipe(Ut((n,i)=>n?.tableId===i?.tableId&&n?.pageIndex===i?.pageIndex))),y(this,"hoverTableRealTime$",this._hoverTable$.asObservable()),y(this,"_customRangeDirty",!0),y(this,"_bulletDirty",!0),y(this,"_paragraphDirty",!0),y(this,"_customRangeBounds",[]),y(this,"_bulletBounds",[]),y(this,"_paragraphBounds",new Map),y(this,"_paragraphLeftBounds",[]),y(this,"_tableParagraphBounds",new Map),y(this,"_segmentParagraphBounds",new Map),y(this,"_tableCellBounds",new Map),y(this,"_tableBounds",new Map),this._context=e,this._docSkeletonManagerService=t,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=bt.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(t=>{t.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(bt.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(Ct(this._context.engine.onTransformChange$).pipe(xt(e=>e.type===Jo.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(Ct(this._context.scene.onPointerMove$).pipe(mn(30)).subscribe(n=>{if(n.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:i,y:s}=Co(n.offsetX,n.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:i,y:s})),this._hoverParagraph$.next(this._calcActiveParagraph({x:i,y:s})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:i,y:s})),this._hoverBullet$.next(this._calcActiveBullet({x:i,y:s}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=Ct(this._context.mainComponent.onPointerDown$),t=Ct(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(pd(n=>t.pipe(Gl(1),Zt(i=>({down:n,up:i})))),xt(({down:n,up:i})=>n.target===i.target&&i.timeStamp-n.timeStamp<300)).subscribe(({down:n})=>{if(n.button===2)return;const i=Co(n.offsetX,n.offsetY,this._context.scene),s=this._calcActiveRanges(i);s.length&&this._clickCustomRanges$.next(s.pop());const r=this._calcActiveBullet(i);r&&this._clickBullet$.next(r)}))}_buildCustomRangeBoundsBySegment(e,t=-1){var n,i,s;const r=(s=(i=(n=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:n.getBody())==null?void 0:i.customRanges)!=null?s:[],o=[];return r.forEach(a=>{const l={startOffset:a.startIndex,endOffset:a.endIndex+1,segmentId:e},d=wu(l,this._documents,this._skeleton,t);if(!d)return null;o.push({customRange:a,rects:d,segmentId:e,segmentPageIndex:t})}),o}_buildCustomRangeBounds(){var e;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const t=[];t.push(...this._buildCustomRangeBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,i)=>{n.headerId&&t.push(...this._buildCustomRangeBoundsBySegment(n.headerId,i)),n.footerId&&t.push(...this._buildCustomRangeBoundsBySegment(n.footerId,i))}),this._customRangeBounds=t}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:t,y:n}=e;return this._customRangeBounds.filter(i=>i.rects.some(s=>Et(t,n,s))).map(i=>({segmentId:i.segmentId,range:i.customRange,segmentPageIndex:i.segmentPageIndex,rects:i.rects}))}_buildBulletBoundsBySegment(e,t=-1){var n,i,s,r,o;const a=(n=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:n.getBody(),l=((i=a?.paragraphs)!=null?i:[]).filter(g=>g.bullet&&g.bullet.listType.indexOf("CHECK_LIST")===0),d=[],c=this._skeleton.getSkeletonData();if(!c)return d;const A=g=>{var u,h,p;for(const f of g){const m=[...f.sections];if(f.skeTables){const C=Array.from(f.skeTables.values());m.push(...C.map(v=>v.rows.map(I=>I.cells.map(E=>E.sections))).flat(4))}for(const C of m)for(const v of C.columns)for(const I of v.lines)if(I.paragraphStart){const E=l.find(S=>S.startIndex===I.paragraphIndex);if(E){const S=I,R=(p=(h=(u=S?.divides)==null?void 0:u[0])==null?void 0:h.glyphGroup)==null?void 0:p[0];if(!R)continue;const b=Nu(R,this._documents,this._skeleton,t);if(!b)continue;d.push({rect:b,segmentId:e,segmentPageIndex:t,paragraph:E})}}}return d};if(e){const g=(o=(s=c.skeFooters.get(e))==null?void 0:s.values())!=null?o:(r=c.skeHeaders.get(e))==null?void 0:r.values();return g?A(Array.from(g)):d}return A(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((t,n)=>{t.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(t.headerId,n)),t.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(t.footerId,n))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:t,y:n}=e;return this._bulletBounds.find(i=>Et(t,n,i.rect))}_buildParagraphBoundsBySegment(e){var t,n,i;const s=this._skeleton.getSkeletonData(),r=this._documents.getOffsetConfig();if(!s)return null;const o=a=>{const l=new Map,d=(c,A,g,u)=>{So(c.sections,g,u,c.pageWidth-c.marginLeft-c.marginRight).forEach(h=>{if(!l.has(h.startIndex))l.set(h.startIndex,{rect:h.rect,paragraphStart:h.paragraphStart,paragraphEnd:h.paragraphEnd,startIndex:h.startIndex,rects:[h.rect],pageIndex:A,segmentId:e,firstLine:h.fisrtLine});else{const p=l.get(h.startIndex);p&&(p.rect.bottom=h.rect.bottom,p.rects.push(h.rect))}})};for(let c=0;c<a.length;c++){const A=a[c],g=((A.pageHeight===1/0?0:A.pageHeight)+r.pageMarginTop)*c+A.marginTop+r.docsTop,u=A.marginLeft+r.docsLeft;A.skeTables&&Array.from(A.skeTables.values()).forEach(h=>{const p=h.left+u,f=h.top+g,m=p+h.width,C=f+h.height,v=h.tableId;this._tableBounds.set(v,{rect:{left:p,top:f,right:m,bottom:C},pageIndex:c,tableId:v}),h.rows.forEach((I,E)=>{I.cells.forEach((S,R)=>{const b=((A.pageHeight===1/0?0:A.pageHeight)+r.pageMarginTop)*c+h.top+r.docsTop+A.marginTop+I.top+S.marginTop,x=h.left+r.docsLeft+A.marginLeft+S.left+S.marginLeft,O=So(S.sections,b,x,S.pageWidth-S.marginLeft-S.marginRight);let w=this._tableParagraphBounds.get(v);w||(w=[],this._tableParagraphBounds.set(v,w)),w.push(...O.map(Q=>({rect:Q.rect,paragraphStart:Q.paragraphStart,paragraphEnd:Q.paragraphEnd,startIndex:Q.startIndex,pageIndex:c,segmentId:e,rowIndex:E,colIndex:R,firstLine:Q.fisrtLine,tableId:v})));let P=this._tableCellBounds.get(v);P||(P=[],this._tableCellBounds.set(v,P)),P.push({rect:{top:b,left:x,right:x+S.pageWidth-S.marginLeft-S.marginRight,bottom:b+S.pageHeight-S.marginBottom-S.marginTop},pageIndex:c,rowIndex:E,colIndex:R,tableId:v})})})}),d(A,c,g,u)}return l};if(e){const a=(i=(t=s.skeFooters.get(e))==null?void 0:t.values())!=null?i:(n=s.skeHeaders.get(e))==null?void 0:n.values();return a?o(Array.from(a)):null}return o(s.pages)}_buildParagraphBounds(){var e,t;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(e=this._buildParagraphBoundsBySegment())!=null?e:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(i=>({...i,rect:{left:i.rect.left-60,right:i.rect.left,top:i.rect.top,bottom:i.rect.bottom}}));const n=i=>{var s;this._segmentParagraphBounds.set(i,(s=this._buildParagraphBoundsBySegment(i))!=null?s:new Map)};(t=this._skeleton.getSkeletonData())==null||t.pages.forEach(i=>{i.headerId&&n(i.headerId),i.footerId&&n(i.footerId)})}_calcActiveParagraph(e){var t,n;this._buildParagraphBounds();const{x:i,y:s}=e,r=Array.from(this._tableBounds.values()).find(a=>Et(i,s,a.rect));if(this._hoverTable$.next(r),r){const a=(t=this._tableCellBounds.get(r.tableId))==null?void 0:t.find(c=>Et(i,s,c.rect));if(this._hoverTableCell$.next(a),!a)return null;const l=(n=this._tableParagraphBounds.get(a.tableId))==null?void 0:n.filter(c=>c.colIndex===a.colIndex&&c.rowIndex===a.rowIndex),d=l?.find(c=>Et(i,s,c.rect));return d&&{...d,rects:[d.rect]}}let o;for(const a of this._paragraphBounds){const l=a[1];if(l.rects.some(d=>Et(i,s,d))){o=l;break}}return o}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:t,y:n}=e;return this._paragraphLeftBounds.find(i=>Et(t,n,i.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){return this._buildParagraphBounds(),this._paragraphBounds.get(e)||Array.from(this._tableParagraphBounds.values()).flat().find(n=>n.startIndex===e)}};yt=Bu([Mu(1,W(ae))],yt);const _u=[tt.id,Bt.id,Mt.id,wt.id,Nt.id,pt.id,_t.id,dt.id,At.id];function Du(e){const{avaliableMenus:t=_u}=e,n=J(sa),[i,s]=M.useState([]);return M.useEffect(()=>{function r(){const a=n.getFlatMenuByPositionKey(Nd.RIBBON),l=[];for(const d of t){const c=a.find(A=>A.key===d);c&&l.push(c)}s(l)}r();const o=n.menuChanged$.subscribe(r);return()=>{o.unsubscribe()}},[n]),B.jsx("div",{className:ke("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:!univer-border-gray-700 dark:!univer-bg-gray-900",Tn),children:i.map(r=>r.item&&B.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:B.jsx(Md,{...r.item},r.key)},r.key))})}var Qu=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},nn=(e,t)=>(n,i)=>t(n,i,e);const xo="univer.doc.float-menu";function Pu(e,t){if(e==null||t==null)return!1;const{glyph:n,...i}=e,{glyph:s,...r}=t;return Wl(i,r)}const Uu=[k.CUSTOM_BLOCK,k.PARAGRAPH];let ni=class extends pe{constructor(e,t,n,i,s,r){super(),y(this,"_floatMenu",null),this._context=e,this._docSelectionManagerService=t,this._docCanvasPopManagerService=n,this._componentManager=i,this._univerInstanceService=s,this._docSelectionRenderService=r,!Xe(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(xo,Du))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(e=>{var t,n;const{unitId:i,textRanges:s}=e;if(i!==this._context.unitId)return;const r=s.length>0&&s.find(o=>!o.collapsed);if(r){if(r.startOffset===((t=this._floatMenu)==null?void 0:t.start)&&r.endOffset===((n=this._floatMenu)==null?void 0:n.end))return;this._hideFloatMenu(),this._showFloatMenu(i,r);return}this._hideFloatMenu()}))}_hideFloatMenu(){var e;(e=this._floatMenu)==null||e.disposable.dispose(),this._floatMenu=null}_showFloatMenu(e,t){var n,i,s;const r=this._univerInstanceService.getUnit(e,N.UNIVER_DOC);if(!r||r.getDisabled())return;const o=(n=r.getBody())==null?void 0:n.dataStream[t.startOffset];if(t.endOffset-t.startOffset===1&&o&&Uu.includes(o))return;const a=(s=(i=r.getBody())==null?void 0:i.customRanges)==null?void 0:s.filter(l=>l.wholeEntity);if(!(a!=null&&a.some(l=>l.startIndex===t.startOffset&&l.endIndex===t.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(t,{componentKey:xo,direction:t.direction==="backward"||Pu(t.startNodePosition,t.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},e),start:t.startOffset,end:t.endOffset},bn(()=>this._hideFloatMenu())}};ni=Qu([nn(1,W(Y)),nn(2,W(xn)),nn(3,W(Xt)),nn(4,W(U)),nn(5,W(Ie))],ni);var Lu=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},sn=(e,t)=>(n,i)=>t(n,i,e);let ii=class extends pe{constructor(e,t,n,i,s,r){super(),y(this,"_paragrahMenu",null),this._context=e,this._docSelectionManagerService=t,this._docEventManagerService=n,this._docPopupManagerService=i,this._docSkeletonManagerService=s,this._floatMenuService=r,!Xe(this._context.unitId)&&this._init()}get activeParagraph(){var e;return(e=this._paragrahMenu)==null?void 0:e.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const e=this._docSelectionManagerService.getActiveTextRange();return!(!(e!=null&&e.collapsed)||!(e!=null&&e.collapsed)||e.startOffset<this._paragrahMenu.paragraph.paragraphStart||e.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(e){this._paragrahMenu&&(this._paragrahMenu.active=e,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const e=n=>{var i;if(this._docSkeletonManagerService.getViewModel().getEditArea()===Ee.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((i=this._paragrahMenu)!=null&&i.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(yn([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(mn(16)).subscribe(([n,i])=>{e(n??i)}));let t=0;this.disposeWithMe(this._context.scene.getViewport(Pe.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{t!==n.scrollY&&(t=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(e){var t,n,i;if(((t=this._paragrahMenu)==null?void 0:t.paragraph.startIndex)===e.startIndex)return;this.hideParagraphMenu(!0);const s=(i=(n=this._context.unit.getBody())==null?void 0:n.dataStream)!=null?i:"",r=e?s.slice(e.paragraphStart,e.paragraphEnd):"";if(r==="\b"||r==="")return;const o=this._docPopupManagerService.attachPopupToRect(e.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(Ll()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:e,disposable:o,active:!1}}hideParagraphMenu(e=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||e)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};ii=Lu([sn(1,W(Y)),sn(2,W(yt)),sn(3,W(xn)),sn(4,W(ae)),sn(5,W(ni))],ii);const Hu=({popup:e})=>{var t,n;const[i,s]=M.useState(!1),r=M.useRef(null),o=J(T),a=J(Ii),l=M.useRef(null),d=M.useRef(!1),c=J(ce),A=J(U),g=c.getRenderById(e.unitId),u=A.getUnit(e.unitId,N.UNIVER_DOC),h=g?.with(ii),p=g?.with(yt),f=$e(p?.hoverParagraph$),m=$e(p?.hoverParagraphLeft$),C=(t=f??m)==null?void 0:t.startIndex,v=M.useMemo(()=>{var b,x;return(x=(b=u?.getBody())==null?void 0:b.paragraphs)==null?void 0:x.find(O=>O.startIndex===C)},[u,f]),I=(n=v?.paragraphStyle)==null?void 0:n.namedStyleType,E=dl[I??q.NORMAL_TEXT],S=M.useMemo(()=>new _e({left:0,right:0,top:0,bottom:0}),[]),R=()=>{s(!1),h?.hideParagraphMenu(!0)};return B.jsxs(B.Fragment,{children:[B.jsxs("div",{"data-u-comp":"paragraph-menu",ref:l,className:ke("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 hover:univer-bg-gray-100 dark:hover:!univer-bg-gray-600",Tn,{"univer-bg-gray-100 dark:!univer-bg-gray-700":i,"univer-bg-white dark:!univer-bg-gray-700":!i}),onMouseEnter:b=>{var x,O,w,P,Q,H;(x=e.onPointerEnter)==null||x.call(e,b),d.current=!0;const _=(O=l.current)==null?void 0:O.getBoundingClientRect();S.next({left:((w=_?.left)!=null?w:0)-4,right:(P=_?.right)!=null?P:0,top:(Q=_?.top)!=null?Q:0,bottom:(H=_?.bottom)!=null?H:0})},onMouseLeave:()=>{d.current=!1},onClick:()=>{s(!0),h?.setParagraphMenuActive(!0)},children:[B.jsx(E.component,{className:"univer-size-4 univer-text-gray-900 dark:!univer-text-white"}),B.jsx(Wa,{className:"univer-size-3 univer-text-gray-600 dark:!univer-text-gray-200"})]}),i&&B.jsx(xd,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:S,direction:"left",onMaskClick:R,children:B.jsx("section",{ref:r,onMouseEnter:b=>{var x;(x=e.onPointerEnter)==null||x.call(e,b),d.current=!0},onMouseLeave:()=>{d.current=!1},children:B.jsx(bd,{style:{width:212},menuType:Jn.PARAGRAPH,onOptionSelect:b=>{const{label:x,commandId:O,value:w}=b;o&&o.executeCommand(O??x,{value:w}),a.focus(),R()}})})})]})};function me(e){return e.getContextValue(Rn)&&e.getContextValue(Bs)&&!e.getContextValue(jo)}function ku(e){return e.getContextValue(Rn)&&e.getContextValue(Bs)&&!e.getContextValue(jo)}const Fu={id:Gt.id,binding:Z.TAB,preconditions:me},Vu={id:Gt.id,binding:Z.TAB|te.SHIFT,preconditions:me,staticParameters:{shift:!0}},ju={id:Bt.id,binding:Z.B|te.CTRL_COMMAND,preconditions:me},Wu={id:Mt.id,binding:Z.I|te.CTRL_COMMAND,preconditions:me},zu={id:wt.id,binding:Z.U|te.CTRL_COMMAND,preconditions:me},Gu={id:Nt.id,binding:Z.X|te.SHIFT|te.CTRL_COMMAND,preconditions:me},Yu={id:pt.id,binding:Z.COMMA|te.CTRL_COMMAND,preconditions:me},qu={id:_t.id,binding:Z.PERIOD|te.CTRL_COMMAND,preconditions:me},Ku={id:Mi.id,binding:Z.L|te.CTRL_COMMAND|te.SHIFT,preconditions:me},Zu={id:Ni.id,binding:Z.R|te.CTRL_COMMAND|te.SHIFT,preconditions:me},Ju={id:wi.id,binding:Z.E|te.CTRL_COMMAND|te.SHIFT,preconditions:me},Xu={id:_i.id,binding:Z.J|te.CTRL_COMMAND|te.SHIFT,preconditions:me},$u={id:Cn.id,binding:Z.Digit7|te.CTRL_COMMAND|te.SHIFT,preconditions:me},eh={id:In.id,binding:Z.Digit8|te.CTRL_COMMAND|te.SHIFT,preconditions:me},Qi="docs-ui.config",bo={layout:{docContainerConfig:zd,toolbarConfig:Wd}},th=[50,80,100,130,150,170,200,400],nh=[10,400];function ih(){const e=J(T),t=J(U),[n,i]=M.useState(null),[s,r]=M.useState(100),o=M.useCallback(()=>{var l,d;if(!n)return 100;const c=((d=(l=n.getSettings())==null?void 0:l.zoomRatio)!=null?d:1)*100;return Math.round(c)},[n]);M.useEffect(()=>{const l=t.getCurrentTypeOfUnit$(N.UNIVER_DOC).subscribe(d=>{d&&(i(d),r(o()))});return()=>{l.unsubscribe()}},[t,o]),M.useEffect(()=>e.onCommandExecuted(l=>{if(l.id===Ge.id){const d=o();r(d)}}).dispose,[e,o]);function a(l){if(r(l),n==null)return;const d=l/100;e.executeCommand(Ge.id,{unitId:n.getUnitId(),zoomRatio:d})}return B.jsx(wd,{min:nh[0],value:s,shortcuts:th,onChange:a})}function sh(e){return B.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:B.jsx(ih,{})})}function rh(){var e,t,n;const i=J(U),s=ea(Qi),r=$e(()=>i.getCurrentTypeOfUnit$(N.UNIVER_SHEET),void 0,void 0,[]),o=(n=(t=(e=s?.layout)==null?void 0:e.docContainerConfig)==null?void 0:t.footer)!=null?n:!0;return r?null:o&&B.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5 univer-py-1.5",children:[B.jsx("div",{}),B.jsx(sh,{})]})}const oh="univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-cursor-pointer univer-pr-1 ",ah="univer-text-base univer-font-semibold",lh="univer-text-sm univer-font-semibold",dh="univer-text-sm",Ah=M.forwardRef((e,t)=>{const{menus:n,onClick:i,className:s,style:r,mode:o,maxHeight:a,activeId:l,open:d,onOpenChange:c,maxWidth:A,wrapperClass:g,wrapperStyle:u,iconClass:h,iconStyle:p}=e,f=o==="side-bar",m=M.useRef(null),C=M.useRef(n);C.current=n;const v=M.useMemo(()=>({scrollTo:I=>{var E;if(!C.current||C.current.findIndex(w=>w.id===I)===-1||!m.current)return;const S=document.getElementById(`univer-side-menu-${I}`);if(!S)return;const R=S.offsetTop,b=m.current.clientHeight,x=m.current.scrollHeight-b,O=Math.max(0,Math.min(R-b/2+S.clientHeight/2,x));(E=m.current)==null||E.scrollTo({behavior:"smooth",top:O})}}),[]);return M.useImperativeHandle(t,()=>v),M.useEffect(()=>{l&&v.scrollTo(l)},[l,v]),B.jsxs("div",{className:ke("univer-relative",g),style:u,children:[B.jsx("div",{onClick:()=>c?.(!d),className:ke("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-size-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-sm dark:!univer-bg-gray-600 dark:!univer-text-gray-200",h),style:p,children:d?B.jsx(Ja,{}):B.jsx(Fa,{})}),B.jsx("div",{className:ke(s,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-px-4 univer-pb-4 univer-pt-14 univer-transition-all univer-duration-300
                    `,{"univer-rounded-r-2xl univer-bg-white univer-shadow univer-backdrop-blur-[10px] dark:!univer-bg-gray-900":f}),style:{...r,transform:d?"translateX(0)":"translateX(-100%)",maxHeight:a,opacity:d?1:0,maxWidth:A??(o==="side-bar"?320:180),paddingRight:o==="float"?void 0:0},children:B.jsx("div",{ref:m,className:ke("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden",Ud),children:n?.map(I=>B.jsx("div",{id:`univer-side-menu-${I.id}`,className:ke(oh,{[ah]:I.isTitle,[lh]:I.level===1,[dh]:I.level>1,"univer-text-gray-500 dark:!univer-text-gray-400":I.id!==l,"univer-text-gray-800 dark:!univer-text-gray-200":I.id===l}),style:{paddingLeft:(I.level-1)*12},onClick:()=>{i?.(I)},children:I.text},I.id))})})]})}),ch=e=>{switch(e){case q.HEADING_1:return 1;case q.HEADING_2:return 2;case q.HEADING_3:return 3;case q.HEADING_4:return 4;case q.HEADING_5:return 5;case q.TITLE:return 1;default:return 1}};function uh(e,t,n,i){var s,r;if(!e)return;const o=Array.from(e.values()),a=o.findIndex(d=>d.paragraphStart!==d.paragraphEnd&&d.rect.top<i&&d.rect.bottom>n);if(a===-1)return;const l=o?.findLastIndex(d=>d.paragraphStart!==d.paragraphEnd&&d.rect.top<i&&d.rect.bottom>n);for(let d=a;d<=l;d++){const c=o[d],A=t.get(c.startIndex);if((s=A?.paragraphStyle)!=null&&s.headingId)return A.paragraphStyle.headingId}for(let d=a;d>=0;d--){const c=o[d],A=t.get(c.startIndex);if((r=A?.paragraphStyle)!=null&&r.headingId)return A.paragraphStyle.headingId}}const Ro="__title";function hh(){var e,t,n;const i=ea(Qi);return(n=(t=(e=i?.layout)==null?void 0:e.docContainerConfig)==null?void 0:t.sideMenu)==null||n?B.jsx(gh,{}):null}function gh(){var e,t,n,i,s,r,o,a,l;const d=J(T),c=J(U),A=$e(M.useMemo(()=>c.getCurrentTypeOfUnit$(N.UNIVER_DOC),[])),g=J(ce),u=(t=(e=A?.getBody())==null?void 0:e.dataStream)!=null?t:"",[h,p]=M.useState(0),[f,m]=M.useState(void 0),C=(n=A?.getUnitId())!=null?n:"",v=g.getRenderById(C),I=A?.getTitle(),E=v?.with(yt),S=E?.paragraphBounds,R=(s=(i=v?.mainComponent)==null?void 0:i.left)!=null?s:0,b=(r=v?.engine.height)!=null?r:0,x=(o=v?.scene.scaleY)!=null?o:1,O=(l=(a=A?.getBody())==null?void 0:a.paragraphs)!=null?l:[],w=M.useMemo(()=>{const L=new Map;return O.forEach(F=>{L.set(F.startIndex,F)}),L},[O]);$e(M.useMemo(()=>v!=null&&v.engine.onTransformChange$?Ct(v?.engine.onTransformChange$).pipe(mn(33)):kl(null),[v?.engine.onTransformChange$]));const P=R<180?"float":"side-bar",Q=O?.filter(L=>{var F;return((F=L.paragraphStyle)==null?void 0:F.namedStyleType)!==void 0&&L.paragraphStyle.namedStyleType!==q.SUBTITLE&&L.paragraphStyle.namedStyleType!==q.NORMAL_TEXT}).map(L=>{var F;const ie=ch(L.paragraphStyle.namedStyleType),Ae=S?.get(L.startIndex);if(!Ae)return null;const{paragraphStart:ge,paragraphEnd:se}=Ae;return{id:L.paragraphStyle.headingId,text:Kn(u.slice(ge,se)),level:ie,isTitle:((F=L.paragraphStyle)==null?void 0:F.namedStyleType)===q.TITLE}}).filter(L=>L?.text),H=cn(L=>{const F=L.viewportScrollY,ie=F+b/x,Ae=uh(S,w,F,ie);Ae&&m(Ae)}),_=Q!=null&&Q.find(L=>L.isTitle)?Q:[...I?[{id:Ro,text:I,level:1,isTitle:!0}]:[],...Q??[]].filter(Boolean),[j,K]=M.useState(!0);M.useEffect(()=>{const L=Ts(p,100),F=d.onCommandExecuted(ie=>{ie.id===X.id&&ie.params.unitId===A?.getUnitId()&&L(Ae=>Ae+1)});return()=>{F.dispose()}},[d,A]),M.useEffect(()=>{const L=v?.scene.getViewport(Pe.VIEW_MAIN);if(!L)return;const F=Ct(L.onScrollAfter$).pipe(mn(33)).subscribe(H);return()=>{F.unsubscribe()}},[v]);const ee=cn(L=>{const F=v?.scene.getViewport(Pe.VIEW_MAIN);if(!F)return;if(L.id===Ro){F.scrollToViewportPos({viewportScrollY:0});return}const ie=O.find(ge=>{var se;return((se=ge.paragraphStyle)==null?void 0:se.headingId)===L.id});if(!ie)return;const Ae=S?.get(ie.startIndex);Ae&&(F.scrollToViewportPos({viewportScrollY:Ae.rect.top}),m(L.id))});return!A||Xe(C)||!(_!=null&&_.length)?null:B.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:B.jsx(Ah,{menus:_,open:j,onOpenChange:K,mode:P,maxWidth:P==="float"?void 0:Math.floor(R)-10,wrapperClass:"univer-mt-12",activeId:f,onClick:ee,maxHeight:b-48})})}const Ke={id:"doc-paragraph-setting.command",type:D.COMMAND,handler:async(e,t)=>{var n,i,s,r,o;const a=e.get(Y),l=e.get(U),d=e.get(T),c=l.getCurrentUnitForType(N.UNIVER_DOC),A=a.getDocRanges();if(!c||A.length===0||!t)return!1;const g=A[0].segmentId,u=c.getUnitId(),h=c.getSelfOrHeaderFooterModel(g),p=(i=(n=h.getBody())==null?void 0:n.paragraphs)!=null?i:[],f=(r=(s=h.getBody())==null?void 0:s.dataStream)!=null?r:"",m=(o=re.range.getParagraphsInRanges(A,p,f))!=null?o:[],C={id:X.id,params:{unitId:u,actions:[],textRanges:A}},v=new Ot;v.reset();const I=new fe,E=V.getInstance();for(const R of m){const{startIndex:b}=R;I.push({t:G.RETAIN,len:b-v.cursor});const x={...R.paragraphStyle,...t.paragraph};I.push({t:G.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...R,paragraphStyle:x,startIndex:0}]},coverType:Kt.REPLACE}),v.moveCursorTo(b+1)}const S=le(c,g);return C.params.actions=E.editOp(I.serialize(),S),!!d.syncExecuteCommand(C.id,C.params)}},ph=()=>{const e=J(Y),t=J(qt),n=M.useMemo(()=>e.getDocRanges(),[]);return M.useEffect(()=>{n.length||t.closePanel()},[n]),n},fh=()=>{var e,t,n,i,s;const r=J(U).getCurrentUnitForType(N.UNIVER_DOC),o=ph();if(!r||o.length===0)return[];const a=o[0].segmentId,l=r.getSelfOrHeaderFooterModel(a),d=(t=(e=l.getBody())==null?void 0:e.paragraphs)!=null?t:[],c=(i=(n=l.getBody())==null?void 0:n.dataStream)!=null?i:"";return(s=re.range.getParagraphsInRanges(o,d,c))!=null?s:[]},mh=(e,t)=>{const n=J(T),[i,s]=M.useState(()=>{var r,o;const a=e[0];return a?String((o=(r=a.paragraphStyle)==null?void 0:r.horizontalAlign)!=null?o:t):t});return[i,r=>(s(r),n.executeCommand(Ke.id,{paragraph:{horizontalAlign:Number(r)}}))]},vh=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.indentStart,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{indentStart:{v:s}}}))]},Eh=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.indentEnd,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{indentEnd:{v:s}}}))]},Ih=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.indentFirstLine,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{indentFirstLine:{v:s}}}))]},Ch=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.hanging,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{hanging:{v:s}}}))]},Sh=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.spaceAbove,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{spaceAbove:{v:s}}}))]},xh=e=>{const t=J(T),[n,i]=M.useState(()=>{var s;const r=e[0];return r?Jt((s=r.paragraphStyle)==null?void 0:s.spaceBelow,0):0});return[n,s=>(i(s),t.executeCommand(Ke.id,{paragraph:{spaceBelow:{v:s}}}))]},bh=e=>{const t=J(T),n=J(ce),i=J(U),s=M.useMemo(()=>{var u;const h=i.getCurrentUnitForType(N.UNIVER_DOC);if(h)return(u=n.getRenderById(h?.getUnitId()))==null?void 0:u.with(ae).getSkeleton()},[]),r=M.useMemo(()=>new _e({}),[]),[o,a]=M.useState(()=>{var u,h;const p=e[0];return p&&(h=(u=p.paragraphStyle)==null?void 0:u.lineSpacing)!=null?h:1}),l=M.useRef(o),[d,c]=M.useState(()=>{var u,h;const p=e[0];return p?(h=(u=p.paragraphStyle)==null?void 0:u.spacingRule)!=null?h:Wt.AUTO:Wt.AUTO}),A=async u=>{a(u),r.next({lineSpacing:u,spacingRule:d})},g=async u=>{if(u!==d){let h=l.current;if(u===Wt.AT_LEAST){const p=s?.findNodeByCharIndex(e[0].startIndex),f=p?.parent,m=f?.parent;m?.contentHeight!==void 0&&(h=Math.max(m.contentHeight,h))}else h>5&&(h=2);l.current=o,A(h),c(u),r.next({spacingRule:u})}};return M.useEffect(()=>{const u=r.pipe(xt(h=>!!Object.keys(h).length),kd(16),xt(h=>!!h.length),Zt(h=>h.reduce((p,f)=>(Object.keys(f).forEach(m=>{p[m]=f[m]}),p),{}))).subscribe(h=>t.executeCommand(Ke.id,{paragraph:{...h}}));return()=>u.unsubscribe()},[]),{lineSpacing:[o,A],spacingRule:[d,g]}},It=e=>{const{value:t,onChange:n,className:i="",min:s=0,max:r=100,step:o=1}=e,a=M.useRef(null);return B.jsx(Je,{step:o,ref:a,min:s,max:r,value:t,onChange:l=>{n(l??0).finally(()=>{setTimeout(()=>{var d;(d=a.current)==null||d.focus()},30)})},className:i})};function Rh(){const e=J(Fe),t=M.useMemo(()=>[{label:e.t("toolbar.alignLeft"),value:String(Ne.LEFT),icon:B.jsx(Xa,{})},{label:e.t("toolbar.alignCenter"),value:String(Ne.CENTER),icon:B.jsx(Za,{})},{label:e.t("toolbar.alignRight"),value:String(Ne.RIGHT),icon:B.jsx($a,{})},{label:e.t("toolbar.alignJustify"),value:String(Ne.JUSTIFIED),icon:B.jsx(ka,{})}],[]),n=fh(),[i,s]=mh(n,t[0].value),[r,o]=vh(n),[a,l]=Eh(n),[d,c]=Ih(n),[A,g]=Ch(n),[u,h]=Sh(n),[p,f]=xh(n),{lineSpacing:[m,C],spacingRule:[v,I]}=bh(n),E=M.useMemo(()=>v===Wt.AUTO?{min:1,max:5,step:m<2?.5:1}:{min:1,max:100},[v,m]);return B.jsxs("div",{children:[B.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:e.t("doc.paragraphSetting.alignment")}),B.jsx("div",{className:ke("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",Tn),children:t.map(S=>B.jsx(Ld,{title:S.label,placement:"bottom",children:B.jsx("span",{className:ke("hover:univer-bg-black/60 univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1",{"univer-bg-blend-color-dodge/90":i===S.value}),onClick:()=>s(S.value),children:S.icon})},S.value))}),B.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:e.t("doc.paragraphSetting.indentation")}),B.jsxs("div",{children:[B.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.left"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:r,onChange:S=>o(S??0)})]}),B.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.right"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:a,onChange:S=>l(S??0)})]}),B.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.firstLine"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:d,onChange:S=>c(S??0)})]}),B.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.hanging"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:A,onChange:S=>g(S??0)})]})]}),B.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:e.t("doc.paragraphSetting.spacing")}),B.jsxs("div",{children:[B.jsxs("div",{className:"univer-justify-betweenuniver-item-center univer-flex",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.before"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:u,onChange:S=>h(S??0)})]}),B.jsxs("div",{className:"univer-item-center univer-flex univer-justify-between",children:[B.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[e.t("doc.paragraphSetting.after"),"(px)"]}),B.jsx(It,{className:"univer-mt-4",value:p,onChange:S=>f(S??0)})]}),B.jsxs("div",{className:"item-center univer-flex univer-justify-between",children:[B.jsx("div",{className:"univer-mt-3 univer-text-xs",children:e.t("doc.paragraphSetting.lineSpace")}),B.jsxs("div",{className:"univer-mt-4 univer-flex univer-w-[162px] univer-flex-col univer-gap-1.5",children:[B.jsx(ra,{value:`${v}`,options:[{label:e.t("doc.paragraphSetting.multiSpace"),value:`${Wt.AUTO}`},{label:e.t("doc.paragraphSetting.fixedValue"),value:`${Wt.AT_LEAST}`}],onChange:S=>I(Number(S))}),B.jsx(It,{...E,value:m,onChange:S=>C(S??0)})]})]})]})]})}const yh=(e,t)=>t.length===e.length&&e.some(n=>t.some(i=>i.startOffset===n.startOffset&&i.endOffset===n.endOffset));function Oh(){const e=J(T),t=J(Fe),n=$e(t.currentLocale$),[i,s]=M.useState(""),r=M.useMemo(()=>Ts(()=>s(ue(4)),300),[]),o=M.useRef([]);return M.useEffect(()=>{const a=e.onCommandExecuted(l=>{if(Me.id===l.id){const d=l.params.ranges;yh(d,o.current)||s(ue(4)),o.current=d}X.id===l.id&&l.params.trigger!==Ke.id&&r()});return()=>a.dispose()},[r]),M.useEffect(()=>{s(ue(4))},[n]),M.useEffect(()=>()=>r.cancel(),[r]),B.jsx(Rh,{},i)}var Th=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Zi=(e,t)=>(n,i)=>t(n,i,e);const yo="doc_ui_paragraph-setting-panel";let qt=class extends pe{constructor(e,t,n){super(),y(this,"_id"),this._commandService=e,this._componentManager=t,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(yo,Oh))}openPanel(){const e={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:yo},width:300};this._sidebarService.open(e)}closePanel(){this._sidebarService.close(this._id)}};qt=Th([Zi(0,T),Zi(1,W(Xt)),Zi(2,W(ta))],qt);const xr={id:"sidebar.operation.doc-paragraph-setting-panel",type:D.OPERATION,handler:e=>(e.get(qt).openPanel(),!0)},br=e=>{const t=e.get(Y);return new he(n=>{const i=t.textSelection$.subscribe(()=>{t.getDocRanges().some(s=>s.collapsed===!1||s.rangeType===De.RECT)?n.next(!1):n.next(!0)});return()=>i.unsubscribe()})};function Bh(e){if(e.length<2)return!0;const t=e.map(n=>n.tableId);return t.every(n=>n===t[0])}function Oo(e,t,n){var i;const s=t.getRectRanges(),r=t.getActiveTextRange();if(s&&s.length&&Bh(s)&&r==null){e.next(!1);return}if(r&&(s==null||s.length===0)){const{segmentId:o,startOffset:a,endOffset:l}=r,d=n.getCurrentUniverDocInstance(),c=(i=d?.getSelfOrHeaderFooterModel(o).getBody())==null?void 0:i.tables;if(c&&c.length&&c.some(A=>{const{startIndex:g,endIndex:u}=A;return a>g&&a<u||l>g&&l<u})){e.next(!1);return}}e.next(!0)}const it=e=>{const t=e.get(Y),n=e.get(U);return new he(i=>{const s=t.textSelection$.subscribe(()=>{Oo(i,t,n)});return Oo(i,t,n),()=>s.unsubscribe()})},Mh=e=>({id:Xn.name,commandId:Xn.id,type:$.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.copy",disabled$:br(e),hidden$:ne(e,N.UNIVER_DOC)}),wh=e=>({id:xr.id,type:$.BUTTON,icon:"MenuIcon",title:"doc.menu.paragraphSetting",hidden$:ne(e,N.UNIVER_DOC)}),Nh=e=>({id:Ks.id,type:$.BUTTON,icon:"CopyDoubleIcon",title:"rightClick.cut",disabled$:br(e),hidden$:ne(e,N.UNIVER_DOC)}),_h=e=>({id:Js.id,type:$.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.paste",hidden$:ne(e,N.UNIVER_DOC)}),Dh=e=>({id:bi.id,type:$.BUTTON,icon:"PasteSpecialDoubleIcon",title:"rightClick.delete",disabled$:br(e),hidden$:ne(e,N.UNIVER_DOC)}),ul="doc.menu.table-insert";function Qh(e){return{id:ul,type:$.SUBITEMS,title:"table.insert",icon:"InsertDoubleIcon",hidden$:yn(ne(e,N.UNIVER_DOC),it(e),(t,n)=>t||n)}}function Ph(e){return{id:gr.id,type:$.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAboveDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}function Uh(e){return{id:pr.id,type:$.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelowDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}function Lh(e){return{id:fr.id,type:$.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumnDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}function Hh(e){return{id:mr.id,type:$.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumnDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}const hl="doc.menu.table-delete";function kh(e){return{id:hl,type:$.SUBITEMS,title:"table.delete",icon:"ReduceDoubleIcon",hidden$:yn(ne(e,N.UNIVER_DOC),it(e),(t,n)=>t||n)}}function Fh(e){return{id:Ar.id,type:$.BUTTON,title:"table.deleteRows",icon:"DeleteRowDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}function Vh(e){return{id:cr.id,type:$.BUTTON,title:"table.deleteColumns",icon:"DeleteColumnDoubleIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}function jh(e){return{id:_n.id,type:$.BUTTON,title:"table.deleteTable",icon:"GridIcon",disabled$:it(e),hidden$:ne(e,N.UNIVER_DOC)}}const Wh={[kr.FORMAT]:{[Bt.id]:{order:0,menuItemFactory:Wc},[Mt.id]:{order:1,menuItemFactory:zc},[wt.id]:{order:2,menuItemFactory:Gc},[Nt.id]:{order:3,menuItemFactory:Yc},[pt.id]:{order:4,menuItemFactory:qc},[_t.id]:{order:5,menuItemFactory:Kc},[We.id]:{order:5.5,menuItemFactory:Xc},[tt.id]:{order:6,menuItemFactory:Jc},[St.id]:{order:7,menuItemFactory:Zc},[dt.id]:{order:8,menuItemFactory:$c},[At.id]:{order:9,menuItemFactory:cu,[wn.id]:{order:0,menuItemFactory:Au}}},[kr.LAYOUT]:{[Mi.id]:{order:2,menuItemFactory:su},[wi.id]:{order:3,menuItemFactory:ru},[Ni.id]:{order:4,menuItemFactory:ou},[_i.id]:{order:5,menuItemFactory:au},[Oi.id]:{order:6,menuItemFactory:lu},[Cn.id]:{order:7,menuItemFactory:fo},[In.id]:{order:8,menuItemFactory:mo},[$n.id]:{order:9,menuItemFactory:vo},[Ir.id]:{order:10,menuItemFactory:eu},[Di.id]:{order:11,menuItemFactory:du},[Sr.id]:{order:12,menuItemFactory:uu}},[fd.MEDIA]:{[ll]:{order:2,menuItemFactory:nu,[vr.id]:{order:0,menuItemFactory:iu}}},[Jn.MAIN_AREA]:{[en.FORMAT]:{[Xn.name]:{order:0,menuItemFactory:Mh},[Ks.id]:{order:1,menuItemFactory:Nh},[Js.id]:{order:2,menuItemFactory:_h},[bi.id]:{order:3,menuItemFactory:Dh}},[en.LAYOUT]:{[xr.id]:{order:0,menuItemFactory:wh},[ul]:{order:1,menuItemFactory:Qh,[gr.id]:{order:1,menuItemFactory:Ph},[pr.id]:{order:2,menuItemFactory:Uh},[fr.id]:{order:3,menuItemFactory:Lh},[mr.id]:{order:4,menuItemFactory:Hh}},[hl]:{order:2,menuItemFactory:kh,[Ar.id]:{order:1,menuItemFactory:Fh},[cr.id]:{order:2,menuItemFactory:Vh},[_n.id]:{order:3,menuItemFactory:jh}}}},[Jn.PARAGRAPH]:{[en.QUICK]:{[ir.id]:{order:0,menuItemFactory:gu},[sr.id]:{order:1,menuItemFactory:pu},[rr.id]:{order:2,menuItemFactory:fu},[or.id]:{order:3,menuItemFactory:mu},[ar.id]:{order:4,menuItemFactory:vu},[ei.id]:{order:5,menuItemFactory:Eu},[Cn.id]:{order:6,menuItemFactory:fo},[In.id]:{order:7,menuItemFactory:mo},[$n.id]:{order:8,menuItemFactory:vo}},[en.FORMAT]:{[qs.id]:{order:0,menuItemFactory:Iu},[Zs.id]:{order:1,menuItemFactory:Cu},[zs.id]:{order:2,menuItemFactory:Su}},[en.LAYOUT]:{[Al]:{menuItemFactory:Ou,[er.id]:{order:0,menuItemFactory:xu},[tr.id]:{order:1,menuItemFactory:bu},[nr.id]:{order:2,menuItemFactory:Ru},[Xs.id]:{order:3,menuItemFactory:yu}}}}};var zh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Ze=(e,t)=>(n,i)=>t(n,i,e);let si=class extends pe{constructor(e,t,n,i,s,r,o,a,l){super(),this._injector=e,this._componentManager=t,this._commandService=n,this._layoutService=i,this._menuManagerService=s,this._uiPartsService=r,this._univerInstanceService=o,this._shortcutService=a,this._configService=l,this._init()}_initCustomComponents(){[[ol,Lc],[rl,Pc],["TodoListDoubleIcon",el],["doc.paragraph.menu",Hu],["DeleteIcon",Va],[gs,kc],["DocumentSettingIcon",ja]].forEach(([e,t])=>{this.disposeWithMe(this._componentManager.register(e,t))})}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(Lr.FOOTER,()=>Hr(rh,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(Lr.CONTENT,()=>Hr(hh,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(Wh)}_initShortCut(){[ju,Wu,zu,Gu,Yu,qu,Ju,Xu,Zu,Ku,$u,eh,Fu].forEach(e=>{this.disposeWithMe(this._shortcutService.registerShortcut(e))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[nl,Ir,Er].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(N.UNIVER_DOC,e=>{this._injector.get(ce).getRenderById(e).with(Ie).focus()}))}};si=zh([Ze(0,W(On)),Ze(1,W(Xt)),Ze(2,T),Ze(3,Ii),Ze(4,sa),Ze(5,Qd),Ze(6,U),Ze(7,Ei),Ze(8,_s)],si);var Gh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Ji=(e,t)=>(n,i)=>t(n,i,e);const To=1.5;let ri=class extends gt{constructor(e,t,n,i){super(),this._context=e,this._textSelectionManagerService=t,this._editorService=n,this._docSkeletonManagerService=i,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(at(this.dispose$)).subscribe(e=>{if(e==null)return;const{isEditing:t,unitId:n}=e;n!==this._context.unitId||!t||this._context.unitId!==fi&&this._scrollToSelection()})}scrollToRange(e){const t=this._docSkeletonManagerService.getSkeleton();if(!t)return;const{startOffset:n}=e,i=t.findNodePositionByCharIndex(n);i&&this.scrollToNode(i)}scrollToNode(e){var t;const{unitId:n,scene:i,mainComponent:s}=this._context,r=this._docSkeletonManagerService.getSkeleton();if(s==null||r==null)return;const o=s.getOffsetConfig(),{docsLeft:a,docsTop:l}=o,d=new ct(o,r),{contentBoxPointGroup:c}=d.getRangePointData(e,e),{left:A,top:g,height:u}=Gn(c),h=A+a,p=g+l,f=i.getViewport(Pe.VIEW_MAIN),m=this._editorService.getEditor(n);if(f==null)return;const{left:C,top:v,right:I,bottom:E}=f.getBounding().viewBound;let S=0,R=0;const b=m?(t=m.params.backScrollOffset)!=null?t:0:100;p<v?S=p-v-b:p>E-u&&(S=p-E+u+b),h<C?R=h-C:h>I-To&&(R=h-I+To);const x=f.transViewportScroll2ScrollValue(R,S);f.scrollByBarDeltaValue(x)}_scrollToSelection(){const e=this._textSelectionManagerService.getActiveTextRange();if(e==null)return;const{collapsed:t,startNodePosition:n}=e;t&&this.scrollToNode(n)}};ri=Gh([Ji(1,W(Y)),Ji(2,Ue),Ji(3,W(ae))],ri);var Yh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Ht=(e,t)=>(n,i)=>t(n,i,e);let ps=class extends gt{constructor(e,t,n,i,s,r,o){super(),this._context=e,this._commandService=t,this._docSelectionRenderService=n,this._docSkeletonManagerService=i,this._editorService=s,this._renderManagerService=r,this._univerInstanceService=o,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(e){var t,n;const i=(t=this._renderManagerService.getRenderById(e))==null?void 0:t.with(ae),s=i?.getSkeleton();if(!s||s.getViewModel().getDataModel().getSnapshot().disabled)return;s.calculate();const r=this._editorService.getEditor(e);if(this._editorService.isEditor(e)&&!(r!=null&&r.params.scrollBar)){(n=this._context.mainComponent)==null||n.makeDirty();return}this._recalculateSizeBySkeleton(s)}_addNewRender(){const{scene:e,engine:t}=this._context,n=new $l(Pe.VIEW_MAIN,e,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});e.attachControl(),e.onMouseWheel$.subscribeEvent((s,r)=>{const o=this._univerInstanceService.getCurrentUnitForType(N.UNIVER_DOC);if(o?.getUnitId()!==this._context.unitId)return;const a=s;if(a.ctrlKey){const l=Math.abs(a.deltaX);let d=l<40?.2:l<80?.4:.2;d*=a.deltaY>0?-1:1,e.scaleX<1&&(d/=2),e.scaleX+d>4?e.scale(4,4):e.scaleX+d<.1?e.scale(.1,.1):a.preventDefault()}else n.onMouseWheel(a,r)}),new es(n),e.addLayer(new Dr(e,[],Li),new Dr(e,[],qd)),this._addComponent();const i=()=>e.render();this.disposeWithMe(this._context.activated$.subscribe(s=>{s?t.runRenderLoop(i):t.stopRenderLoop(i)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:e,unit:t,components:n}=this._context,i={pageMarginLeft:20,pageMarginTop:20},s=new ed(ze.MAIN,void 0,i);s.zIndex=Wr;const r=new td(ze.BACKGROUND,void 0,i);r.zIndex=Wr,this._context.mainComponent=s,n.set(ze.MAIN,s),n.set(ze.BACKGROUND,r),e.addObjects([s],Li),e.addObjects([r],Yd),this._editorService.getEditor(t.getUnitId())==null&&e.enableLayerCache(Li)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(at(this.dispose$)).subscribe(e=>{this._create(e)})}_create(e){var t;if(!e)return;const{mainComponent:n,components:i}=this._context,s=n,r=i.get(ze.BACKGROUND);s.changeSkeleton(e),r.changeSkeleton(e);const{unitId:o}=this._context,a=this._editorService.getEditor(o);if(this._editorService.isEditor(o)&&!(a!=null&&a.params.scrollBar)){(t=this._context.mainComponent)==null||t.makeDirty();return}this._recalculateSizeBySkeleton(e)}_initCommandListener(){const e=[X.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){const n=t.params,{unitId:i}=n;this.reRender(i)}}))}_recalculateSizeBySkeleton(e){var t;const{mainComponent:n,scene:i,unitId:s,components:r}=this._context,o=n,a=r.get(ze.BACKGROUND),l=(t=e.getSkeletonData())==null?void 0:t.pages;if(l==null)return;let d=0,c=0;const A=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let u=0,h=l.length;u<h;u++){const p=l[u];let{pageWidth:f,pageHeight:m}=p;if(A===Te.MODERN){const C=qh(p);f=C.pageWidth,m=C.pageHeight}o.pageLayoutType===pn.VERTICAL?(c+=m,c+=o.pageMarginTop,u===h-1&&(c+=o.pageMarginTop),d=Math.max(d,f)):o.pageLayoutType===pn.HORIZONTAL&&(d+=f,u!==h-1&&(d+=o.pageMarginLeft),c=Math.max(c,m))}o.resize(d,c),a.resize(d,c);const g=this._editorService.getEditor(s);(!this._editorService.isEditor(s)||g!=null&&g.params.scrollBar)&&i.resize(d,c)}};ps=Yh([Ht(1,T),Ht(2,W(Ie)),Ht(3,W(ae)),Ht(4,Ue),Ht(5,ce),Ht(6,U)],ps);function qh(e){let{pageWidth:t,pageHeight:n}=e;const{marginLeft:i,marginRight:s,marginTop:r,marginBottom:o,skeDrawings:a,skeTables:l}=e;t===Number.POSITIVE_INFINITY&&(t=e.width+i+s),n===Number.POSITIVE_INFINITY&&(n=e.height+r+o);for(const d of a.values())t=Math.max(t,d.aLeft+d.width+i+s),n=Math.max(n,d.aTop+d.height+r+o);for(const d of l.values())t=Math.max(t,d.left+d.width+i+s),n=Math.max(n,d.top+d.height+r+o);return{pageWidth:t,pageHeight:n}}var Kh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Xi=(e,t)=>(n,i)=>t(n,i,e);let fs=class{constructor(e,t,n){y(this,"_docContainer"),y(this,"getComponent",i=>{if(this._docContainer=i,!i.getContentRef().current)throw new Error("container is not ready")}),y(this,"changeLocale",i=>{this._localeService.setLocale(i)}),this._localeService=e,this._injector=t,this._configService=n}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(Qi),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(e){if(this._docContainer)return e(this._docContainer)}getDocContainer(){return this._docContainer}};fs=Kh([Xi(0,W(Fe)),Xi(1,W(On)),Xi(2,_s)],fs);var Zh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Jh=(e,t)=>(n,i)=>t(n,i,e);let oi=class extends gt{constructor(e){super(),y(this,"_docContainerController"),this._injector=e,this._docContainerController=this._injector.createInstance(fs)}};oi=Zh([Jh(0,W(On))],oi);var Xh=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Bo=(e,t)=>(n,i)=>t(n,i,e);let ai=class extends pe{constructor(e,t){super(),this._docAutoFormatService=e,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:Gt.id,match:e=>{var t;const{selection:n,paragraphs:i,unit:s}=e;if(i.length===1&&n.startOffset===i[0].paragraphStart&&i[0].bullet){const r=(t=s.getBody())==null?void 0:t.paragraphs,o=r?.filter(a=>{var l;return((l=a.bullet)==null?void 0:l.listId)===i[0].bullet.listId});return o?.findIndex(a=>a.startIndex===i[0].startIndex)!==0}else if(i.length>1&&i.some(r=>r.bullet))return!0;return!1},getMutations(e){const t=e.commandParams;return[{id:rs.id,params:{type:t!=null&&t.shift?jn.decrease:jn.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:Gt.id,match:e=>{const{selection:t,unit:n}=e,{startNodePosition:i,endNodePosition:s}=t,r=this._renderManagerService.getRenderById(n.getUnitId()),o=r?.with(ae).getSkeleton();return o==null?!1:!!(i&&s&&Na(o,i,s)||i&&!s&&i.path.indexOf("cells")>-1)},getMutations(e){const t=e.commandParams;return[{id:Ua.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:Si.id,match:e=>{var t;const{selection:n,paragraphs:i,unit:s}=e;if(!n.collapsed||i.length!==1||!n.collapsed)return!1;const r=(t=s.getBody())==null?void 0:t.dataStream.slice(i[0].paragraphStart,n.startOffset-1);return!!(r&&(Object.keys(Ui).includes(r)||Object.keys(Vi).includes(r)))},getMutations(e){var t;const{paragraphs:n,unit:i,selection:s}=e,r=(t=i.getBody())==null?void 0:t.dataStream.slice(n[0].paragraphStart,s.startOffset-1);if(r&&Object.keys(Ui).includes(r)){const o=Ui[r];return[{id:Oa.id,params:{listType:o,paragraph:n[0]}}]}if(r&&Object.keys(Vi).includes(r)){const o=Vi[r];return[{id:Ta.id,params:{value:o}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:vn.id,match:e=>{const{paragraphs:t}=e;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:e=>{const t=e.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:rs.id,params:{type:jn.decrease}}]:[{id:Nn.id,params:{listType:e.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:vn.id,match:()=>!0,getMutations(){return[{id:Us.id}]},priority:-9999}))}};ai=Xh([Bo(0,W(Rt)),Bo(1,ce)],ai);function $h(e){return e.rows[0].cells[0].sections[0].columns[0].lines[0]}function eg(e){const t=e.rows[e.rows.length-1],n=t.cells[t.cells.length-1];return cd(n)}function tg(e,t){const{ed:n}=e,{skeTables:i}=t;let s=null;for(const r of i.values())if(r.st===n+1){s=r;break}return s}function Mo(e){const t=e?.parent;let n=null,i=null;if(e==null||t==null)return{lineBeforeTable:n,lineAfterTable:i};const{st:s,ed:r}=e,o=t.type===be.CELL?[t]:t.parent.pages;return ld(o,a=>{a.st===r+1?i=a:a.ed===s-1&&(n=a)}),{lineBeforeTable:n,lineAfterTable:i}}function gl(e){return e.sections[0].columns[0].lines.length===0}function pl(e){var t,n;const i=e.parent,s=i?.parent,r=s?.tableId;if(i==null||s==null)return;const o=i.cells.indexOf(e);let a=s.rows[s.rows.indexOf(i)+1];if(a==null&&r.indexOf("#-#")){const[l,d]=r.split("#-#"),c=(n=(t=s.parent)==null?void 0:t.parent)==null?void 0:n.pages,A=`${l}#-#${Number.parseInt(d)+1}`;if(c)for(const g of c){const{skeTables:u}=g;if(u.has(A)){const h=u.get(A);if(h!=null&&h.rows.length){a=h.rows.find(p=>!p.isRepeatRow);break}}}}if(a!=null){const l=a.cells[o];return gl(l)?pl(l):l}}function fl(e){var t,n;const i=e.parent,s=i?.parent;if(i==null||s==null)return;let r=s.rows[s.rows.indexOf(i)-1];const o=i.cells.indexOf(e);if((r==null||r.isRepeatRow)&&s.tableId.indexOf("#-#")){const[a,l]=s.tableId.split("#-#"),d=(n=(t=s.parent)==null?void 0:t.parent)==null?void 0:n.pages,c=`${a}#-#${Number.parseInt(l)-1}`;if(d)for(const A of d){const{skeTables:g}=A;if(g.has(c)){const u=g.get(c);if(u!=null&&u.rows.length){r=u.rows[u.rows.length-1];break}}}}if(r!=null){const a=r.cells[o];return gl(a)?fl(a):a}}function ng(e,t){const{st:n}=e,{skeTables:i}=t;let s=null;for(const r of i.values())if(r.ed===n-1){s=r;break}return s}function ig(e){return e.sections[0].columns[0].lines[0]}function sg(e){const t=dd(e);return t.lines[t.lines.length-1]}var rg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Ln=(e,t)=>(n,i)=>t(n,i,e);let li=class extends pe{constructor(e,t,n,i){super(),y(this,"_onInputSubscription"),this._univerInstanceService=e,this._renderManagerService=t,this._textSelectionManagerService=n,this._commandService=i,this._commandExecutedListener()}dispose(){var e;super.dispose(),(e=this._onInputSubscription)==null||e.unsubscribe()}_commandExecutedListener(){const e=[ut.id,ht.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(!e.includes(t.id))return;const n=t.params;switch(t.id){case ut.id:return this._handleMoveCursor(n.direction);case ht.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(e){var t,n,i;const s=this._textSelectionManagerService.getActiveTextRange(),r=this._textSelectionManagerService.getTextRanges(),o=this._univerInstanceService.getCurrentUniverDocInstance();if(o==null)return;const a=(t=this._renderManagerService.getRenderById(o.getUnitId()))==null?void 0:t.with(ae).getSkeleton(),l=this._getDocObject();if(s==null||a==null||l==null)return;const{startOffset:d,endOffset:c,style:A,collapsed:g,direction:u,segmentId:h,startNodePosition:p,endNodePosition:f,segmentPage:m}=s;if(r.length>1){let E=Number.POSITIVE_INFINITY,S=Number.NEGATIVE_INFINITY;for(const R of r)E=Math.min(E,R.startOffset),S=Math.max(S,R.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:e===oe.LEFT||e===oe.UP?S:E,endOffset:e===oe.LEFT||e===oe.UP?E:S,style:A}],!1);return}const C=g||u===ye.FORWARD?d:c;let v=g||u===ye.FORWARD?c:d;const I=(n=o.getSelfOrHeaderFooterModel(h).getBody().dataStream.length)!=null?n:Number.POSITIVE_INFINITY;if(e===oe.LEFT||e===oe.RIGHT){const E=a.findNodeByCharIndex(v-1,h,m),S=a.findNodeByCharIndex(v,h,m);v=e===oe.RIGHT?v+S.count:v-((i=E?.count)!=null?i:0),v=Math.min(I-2,Math.max(0,v)),this._textSelectionManagerService.replaceTextRanges([{startOffset:C,endOffset:v,style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),v)}else{const E=a.findNodeByCharIndex(v,h,m),S=l.document.getOffsetConfig(),R=g?p:u===ye.FORWARD?f:p,b=this._getTopOrBottomPosition(a,E,R,e===oe.DOWN,!0);if(b==null){const O=e===oe.UP?0:I-2;if(O===v)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:C,endOffset:O,style:A}],!1);return}const x=new ct(S,a).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:C,endOffset:x.endOffset,style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),x.endOffset)}}_handleMoveCursor(e){var t,n,i,s;const r=this._textSelectionManagerService.getActiveTextRange(),o=this._textSelectionManagerService.getTextRanges(),a=this._univerInstanceService.getCurrentUniverDocInstance();if(a==null)return!1;const l=(t=this._renderManagerService.getRenderById(a.getUnitId()))==null?void 0:t.with(ae).getSkeleton(),d=this._getDocObject();if(r==null||l==null||d==null||o==null)return;const{startOffset:c,endOffset:A,style:g,collapsed:u,segmentId:h,startNodePosition:p,endNodePosition:f,segmentPage:m}=r,C=a.getSelfOrHeaderFooterModel(h).getBody();if(C==null)return;const v=(n=C.dataStream.length)!=null?n:Number.POSITIVE_INFINITY,I=(i=a.getCustomRanges())!=null?i:[];if(e===oe.LEFT||e===oe.RIGHT){let E;if(!r.collapsed||o.length>1){let R=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY;for(const x of o)R=Math.min(R,x.startOffset),b=Math.max(b,x.endOffset);E=e===oe.LEFT?R:b}else{const R=l.findNodeByCharIndex(c-1,h,m),b=l.findNodeByCharIndex(c,h,m),x=l.findNodeByCharIndex(c+1,h,m);e===oe.LEFT?E=Math.max(0,c-((s=R?.count)!=null?s:1)):E=Math.min(v-2,A+b.count+(x?.streamType===k.SECTION_BREAK?1:0))}const S=[k.TABLE_START,k.TABLE_END,k.TABLE_ROW_START,k.TABLE_ROW_END,k.TABLE_CELL_START,k.TABLE_CELL_END,k.SECTION_BREAK];if(e===oe.LEFT)for(;S.includes(C.dataStream[E]);)E--;else for(;S.includes(C.dataStream[E]);)E++;I.filter(R=>R.wholeEntity&&R.startIndex<E&&R.endIndex>=E).forEach(R=>{e===oe.LEFT?E=Math.min(R.startIndex,E):E=Math.max(R.endIndex+1,E)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,E),endOffset:Math.max(0,E),style:g}],!1),this._scrollToFocusNodePosition(a.getUnitId(),E)}else{const E=l.findNodeByCharIndex(c,h,m),S=l.findNodeByCharIndex(A,h,m),R=d.document.getOffsetConfig(),b=this._getTopOrBottomPosition(l,e===oe.UP||u?E:S,e===oe.UP||u?p:f,e===oe.DOWN);if(b==null){let O;u?O=e===oe.UP?0:v-2:O=e===oe.UP?c:A,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,O),endOffset:Math.max(0,O),style:g}],!1);return}const x=new ct(R,l).getRangePointData(b,b).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...x,style:g}],!1),this._scrollToFocusNodePosition(a.getUnitId(),x.endOffset)}}_getTopOrBottomPosition(e,t,n,i,s=!1){if(t==null||n==null)return;const r=this._getGlyphLeftOffsetInLine(t),o=this._getNextOrPrevLine(t,i,s);if(o==null)return;const a=this._matchPositionByLeftOffset(e,o,r,n);if(a!=null)return{...a,isBack:!0}}_getGlyphLeftOffsetInLine(e){const t=e.parent;if(t==null)return Number.NEGATIVE_INFINITY;const n=t.left,{left:i}=e;return n+i}_matchPositionByLeftOffset(e,t,n,i){const s={distance:Number.POSITIVE_INFINITY};for(const o of t.divides){const a=o.left;for(const l of o.glyphGroup){if(l.streamType===k.SECTION_BREAK)continue;const{left:d}=l,c=a+d,A=Math.abs(n-c);A<s.distance&&(s.glyph=l,s.distance=A)}}if(s.glyph==null)return;const{segmentPage:r}=i;return e.findPositionByGlyph(s.glyph,r)}_getNextOrPrevLine(e,t,n=!1){var i,s,r,o,a,l,d,c,A,g,u,h;const p=e.parent,f=p?.parent,m=f?.parent,C=m?.parent,v=C?.parent;if(p==null||f==null||m==null||C==null||v==null)return;const I=m.lines.indexOf(f);if(I===-1)return;let E;if(v.type===be.CELL&&n){const O=wo(v,t);if(O)return O}if(t===!0){E=m.lines[I+1];const O=tg(f,v);if(O){const w=$h(O);w&&(E=w)}}else{E=m.lines[I-1];const O=ng(f,v);if(O){const w=eg(O);w&&(E=w)}}if(E!=null)return E;const S=C.columns.indexOf(m);if(S===-1)return;if(t===!0)E=(i=C.columns[S+1])==null?void 0:i.lines[0];else{const O=(r=(s=C.columns)==null?void 0:s[S-1])==null?void 0:r.lines;E=O?.[O.length-1]}if(E!=null)return E;const R=v.sections.indexOf(C);if(R===-1)return;if(t===!0)E=(a=(o=v.sections[R-1])==null?void 0:o.columns[0])==null?void 0:a.lines[0];else{const O=(d=(l=v.sections)==null?void 0:l[R-1])==null?void 0:d.columns,w=O?.[O.length-1],P=w?.lines;E=P?.[P.length-1]}if(E!=null)return E;if(v.type===be.CELL)return wo(v,t);const b=v.parent;if(b==null)return;const x=b.pages.indexOf(v);if(x!==-1){if(t===!0)E=(g=(A=(c=b.pages[x+1])==null?void 0:c.sections[0])==null?void 0:A.columns[0])==null?void 0:g.lines[0];else{const O=(u=b.pages[x-1])==null?void 0:u.sections;if(O==null)return;const w=(h=O[O.length-1])==null?void 0:h.columns,P=w[w.length-1],Q=P?.lines;E=Q[Q.length-1]}if(E!=null)return E}}_scrollToFocusNodePosition(e,t){var n;const i=(n=this._renderManagerService.getRenderById(e))==null?void 0:n.with(ri);i?.scrollToRange({startOffset:t,endOffset:t,collapsed:!0})}_getDocObject(){return Kd(this._univerInstanceService,this._renderManagerService)}};li=rg([Ln(0,U),Ln(1,ce),Ln(2,W(Y)),Ln(3,T)],li);function wo(e,t){var n,i;let s=null;if(t===!0){const r=pl(e);if(r)s=ig(r);else{const o=(n=e.parent)==null?void 0:n.parent,{lineAfterTable:a}=Mo(o);a&&(s=a)}}else{const r=fl(e);if(r)s=sg(r);else{const o=(i=e.parent)==null?void 0:i.parent,{lineBeforeTable:a}=Mo(o);a&&(s=a)}}return s}const og=({handleRowColChange:e,tableCreateParams:t})=>{const n=J(Fe),[i,s]=M.useState(3),[r,o]=M.useState(5);function a(l,d){s(l),o(d),e(l,d)}return M.useEffect(()=>{s(t.rowCount),o(t.colCount)},[t]),B.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between univer-gap-2",children:[B.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[B.jsx("span",{children:n.t("toolbar.table.rowCount")}),B.jsx(Je,{className:"univer-w-28",min:1,max:20,precision:0,value:i,onChange:l=>{a(l,r)}})]}),B.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[B.jsx("span",{children:n.t("toolbar.table.colCount")}),B.jsx(Je,{className:"univer-w-28",min:1,max:20,precision:0,value:r,onChange:l=>{a(i,l)}})]})]})};var ag=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},No=(e,t)=>(n,i)=>t(n,i,e);let di=class extends pe{constructor(e,t){super(),this._commandService=e,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[vr].forEach(e=>this.disposeWithMe(this._commandService.registerCommand(e)))}_initCustomComponents(){const e=this._componentManager;this.disposeWithMe(e.register(La,og))}_init(){}};di=ag([No(0,T),No(1,W(Xt))],di);var lg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Hn=(e,t)=>(n,i)=>t(n,i,e);let ms=class extends pe{constructor(e,t,n,i,s){super(),this._context=e,this._docSkeletonManagerService=t,this._commandService=n,this._docEventManagerService=i,this._textSelectionManagerService=s,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(e=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(ya.id,{index:e.paragraph.startIndex,segmentId:e.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(e=>{e?this._context.mainComponent.setCursor(bt.POINTER):this._context.mainComponent.setCursor(bt.TEXT)}))}_getTransformCoordForDocumentOffset(e,t,n,i){const{documentTransform:s}=e.getOffsetConfig(),r=t.transformVector2SceneCoord(fn.FromArray([n,i]));if(r)return s.clone().invert().applyPoint(r)}};ms=lg([Hn(1,W(ae)),Hn(2,T),Hn(3,W(yt)),Hn(4,W(Y))],ms);var dg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},rn=(e,t)=>(n,i)=>t(n,i,e);let Ai=class extends gt{constructor(e,t,n,i,s,r){super(),this._context=e,this._commandService=t,this._docClipboardService=n,this._docSelectionRenderService=i,this._contextService=s,this._editorService=r,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var e;(e=this._docSelectionRenderService)==null||e.onPaste$.pipe(at(this.dispose$)).subscribe(t=>{var n,i,s;if(!yi(this._contextService))return;t.event.preventDefault();const r=t.event;let o=(n=r.clipboardData)==null?void 0:n.getData(na);const a=(i=r.clipboardData)==null?void 0:i.getData(ia),l=[...((s=r.clipboardData)==null?void 0:s.items)||[]].filter(d=>Rd.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(o??"").indexOf("</table>")>-1&&(o=""),this._docClipboardService.legacyPaste({html:o,text:a,files:l})})}};Ai=dg([rn(1,T),rn(2,Tt),rn(3,W(Ie)),rn(4,Ds),rn(5,Ue)],Ai);var Ag=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},_o=(e,t)=>(n,i)=>t(n,i,e);const cg=[ko,Hl,fi,Ye];let vs=class extends pe{constructor(e,t,n){super(),this._context=e,this._contextMenuService=t,this._commandService=n,cg.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,t;const n=((t=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:t.onPointerDown$).subscribeEvent(i=>{i.button===2&&this._contextMenuService.triggerContextMenu(i,Jn.MAIN_AREA)});this.disposeWithMe(n)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(e=>{e.id===X.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};vs=Ag([_o(1,Pd),_o(2,T)],vs);var ug=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},kt=(e,t)=>(n,i)=>t(n,i,e);let ci=class extends pe{constructor(e,t,n,i,s,r,o){super(),y(this,"_initialEditors",new Set),this._context=e,this._univerInstanceService=t,this._editorService=n,this._commandService=i,this._docSelectionRenderService=s,this._docSkeletonManagerService=r,this._renderManagerService=o,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(e=>{const t=e.getEditorId();t===this._context.unitId&&(this._initialEditors.has(t)||(this._initialEditors.add(t),this._resize(t)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(e){if(e==null)return;const t=this._editorService.getEditor(e);if(t?.cancelDefaultResizeListener===!0)return;const n=this._univerInstanceService.getUniverDocInstance(e);if(!n)return;const i=this._docSkeletonManagerService.getSkeleton();if(t==null||t.render==null||i==null||n==null)return;i.calculate();const{marginTop:s=0,marginBottom:r=0,marginLeft:o=0,marginRight:a=0}=n.getSnapshot().documentStyle,{scene:l,mainComponent:d}=t.render;let{actualHeight:c,actualWidth:A}=i.getActualSize();c+=s+r,A+=o+a;const{width:g,height:u}=t.getBoundingClientRect(),h=Math.max(A,g),p=Math.max(c,u);l.transformByState({width:h,height:p}),d?.resize(h,p)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:e}=this._context,t=this._editorService.getEditor(e),n=this._editorService.getFocusEditor();t==null||t.isSheetEditor()||n&&n.getEditorId()===e||e.includes("range_selector")||e.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const e=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(He(window,"mousedown").subscribe(n=>{const i=n.target.classList[0]||"";Pl(i,e)&&n.stopPropagation()}));const t=new un;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(N.UNIVER_SHEET).subscribe(n=>{if(t.dispose(),!n)return;const i=n.getUnitId(),s=this._renderManagerService.getRenderById(i),r=s?.engine.getCanvas().getCanvasEle();if(r==null)return;const o=He(r,"mousedown").subscribe(a=>{a.stopPropagation()});t.add(o)})),this.disposeWithMe(()=>t.dispose())}_commandExecutedListener(){const e=[X.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)){const n=t.params,{unitId:i}=n;if(this._editorService.isSheetEditor(i)||i!==this._context.unitId)return;const s=this._editorService.getEditor(i);s&&!s.params.scrollBar&&this._resize(i)}}))}};ci=ug([kt(1,U),kt(2,Ue),kt(3,T),kt(4,W(Ie)),kt(5,W(ae)),kt(6,ce)],ci);var hg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},kn=(e,t)=>(n,i)=>t(n,i,e);let Es=class extends pe{constructor(e,t,n,i,s){super(),y(this,"_previousIMEContent",""),y(this,"_isCompositionStart",!0),y(this,"_onStartSubscription"),y(this,"_onUpdateSubscription"),y(this,"_onEndSubscription"),this._context=e,this._docSelectionRenderService=t,this._docImeInputManagerService=n,this._docSkeletonManagerService=i,this._commandService=s,this._initialize()}dispose(){var e,t,n;(e=this._onStartSubscription)==null||e.unsubscribe(),(t=this._onUpdateSubscription)==null||t.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(e=>{if(e==null)return;this._resetIME();const{activeRange:t}=e;t!=null&&this._docImeInputManagerService.setActiveRange(de.deepClone(t))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(e=>{this._updateContent(e,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(e=>{this._updateContent(e,!1)})}async _updateContent(e,t){if(e==null)return;const n=this._context.unitId,i=this._docSkeletonManagerService.getSkeleton(),{event:s,activeRange:r}=e;if(i==null||r==null)return;const o=s.data;o===this._previousIMEContent&&t||(await this._commandService.executeCommand(Ia.id,{unitId:n,newText:o,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!t}),t?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=o):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};Es=hg([kn(1,W(Ie)),kn(2,W(Ti)),kn(3,W(ae)),kn(4,T)],Es);var gg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Fn=(e,t)=>(n,i)=>t(n,i,e);let Is=class extends pe{constructor(e,t,n,i,s){super(),y(this,"_onInputSubscription"),this._context=e,this._docSelectionRenderService=t,this._docSkeletonManagerService=n,this._commandService=i,this._docMenuStyleService=s,this._init()}dispose(){var e;super.dispose(),(e=this._onInputSubscription)==null||e.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async e=>{var t,n;if(e==null)return;const{unitId:i}=this._context,{event:s,content:r="",activeRange:o}=e,a=s,l=this._docSkeletonManagerService.getSkeleton();if(a.data==null||l==null||o==null)return;const{segmentId:d}=o,c=this._context.unit.getSelfOrHeaderFooterModel(d).getBody(),A=this._docMenuStyleService.getDefaultStyle(),g=this._docMenuStyleService.getStyleCache(),u=Qs((t=c?.customRanges)!=null?t:[],o.endOffset,hn.includes(i)),h=Ci(c,o.endOffset,A,g,hn.includes(i)),p=Ps((n=c?.customDecorations)!=null?n:[],o.endOffset);await this._commandService.executeCommand(ca.id,{unitId:i,body:{dataStream:r,textRuns:h?[{...h,st:0,ed:r.length}]:[],customRanges:u?[{...u,startIndex:0,endIndex:r.length-1}]:[],customDecorations:p.map(f=>({...f,startIndex:0,endIndex:r.length-1}))},range:o,segmentId:d}),r===" "&&await this._commandService.executeCommand(Si.id)})}};Is=gg([Fn(1,W(Ie)),Fn(2,W(ae)),Fn(3,T),Fn(4,W(et))],Is);class Rr extends pe{constructor(t){super(),this._context=t}calculatePagePosition(){var t,n;if(this._disposed)return;const i=lt(this._context),s=(n=(t=this._context.unit.getSettings())==null?void 0:t.zoomRatio)!=null?n:1,{document:r,scene:o,docBackground:a}=i,l=o?.getParent(),{width:d,height:c,pageMarginLeft:A,pageMarginTop:g}=r;if(l==null||d===Number.POSITIVE_INFINITY||c===Number.POSITIVE_INFINITY)return;const{width:u,height:h}=l;let p=0,f=g,m=0,C=0,v=Number.POSITIVE_INFINITY;u>(d+A*2)*s?(p=u/2-d*s/2,p/=s,m=(u-A*2)/s,v=0):(p=A,m=d+A*2,v=(m-u/s)/2),h>c?C=(h-g*2)/s:C=c+g*2,o.resize(m,C),u<=1&&(p=-1e4,f=-1e4),r.translate(p,f),a.translate(p,f);const I=o.getViewport(Pe.VIEW_MAIN);return v!==Number.POSITIVE_INFINITY&&I!=null&&I.scrollToViewportPos({viewportScrollX:v}),this}}var pg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Do=(e,t)=>(n,i)=>t(n,i,e);let Cs=class extends pe{constructor(e,t,n){super(),this._context=e,this._docPageLayoutService=t,this._textSelectionManagerService=n;const i=this._context.unitId;if(Xe(i)&&i!==Ye)return this;this._initResize()}_initResize(){this.disposeWithMe(Ct(this._context.engine.onTransformChange$).pipe(xt(e=>e.type===Jo.resize),mn(0,_d)).subscribe(()=>{this._disposed||(this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection())}))}};Cs=pg([Do(1,W(Rr)),Do(2,W(Y))],Cs);var fg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Ft=(e,t)=>(n,i)=>t(n,i,e);let Ss=class extends pe{constructor(e,t,n,i,s,r,o){super(),y(this,"_loadedMap",new WeakSet),this._context=e,this._commandService=t,this._editorService=n,this._instanceSrv=i,this._docSelectionRenderService=s,this._docSkeletonManagerService=r,this._docSelectionManagerService=o,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:e}=this._context,t=lt(this._context);t==null||t.document==null||this._loadedMap.has(t.document)||(this._initialMain(e),this._loadedMap.add(t.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(e=>{if(e==null)return;const{unitId:t,docRanges:n,isEditing:i,options:s}=e;t===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,i,s))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(e=>{e!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(e,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(e){const t=lt(this._context),{document:n,scene:i}=t;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(e)||(n.cursor=bt.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=bt.DEFAULT,i.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((s,r)=>{if(this._isEditorReadOnly(e))return;const o=this._instanceSrv.getCurrentUnitForType(N.UNIVER_DOC);o?.getUnitId()!==e&&this._instanceSrv.setCurrentUnitForType(e);const a=this._docSkeletonManagerService.getSkeleton(),{offsetX:l,offsetY:d}=s,c=this._getTransformCoordForDocumentOffset(l,d);if(c!=null){const{pageLayoutType:A=pn.VERTICAL,pageMarginLeft:g,pageMarginTop:u}=n.getOffsetConfig(),{editArea:h}=a.findEditAreaByCoord(c,A,g,u),p=this._docSkeletonManagerService.getViewModel(),f=p.getEditArea();f!==Ee.BODY&&h!==Ee.BODY&&h!==f&&p.setEditArea(h)}if(this._docSelectionRenderService.__onPointDown(s),this._editorService.getEditor(e)){this._setEditorFocus(e);const{offsetX:A,offsetY:g}=s;setTimeout(()=>{e===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(e),this._docSelectionRenderService.setCursorManually(A,g))},0)}s.button!==2&&r.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(s=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleDblClick(s)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(s=>{this._isEditorReadOnly(e)||this._docSelectionRenderService.__handleTripleClick(s)}))}_getTransformCoordForDocumentOffset(e,t){const n=lt(this._context),{document:i,scene:s}=n,{documentTransform:r}=i.getOffsetConfig(),o=s.getViewports()[0];if(o==null)return;const a=o.transformVector2SceneCoord(fn.FromArray([e,t]));return r.clone().invert().applyPoint(a)}_isEditorReadOnly(e){const t=this._editorService.getEditor(e);return t?t.isReadOnly():!1}_setEditorFocus(e){this._editorService.focus(e)}_commandExecutedListener(){const e=[Ge.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{var n;if(e.includes(t.id)){const i=t.params,{unitId:s}=i,r=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(s!==r)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(!e)return;const{unitId:t}=this._context;if(!Xe(t)){this._docSelectionRenderService.focus();const n=this._context.unit.getSnapshot(),i=tl(n);this._docSelectionManagerService.replaceDocRanges([{startOffset:i,endOffset:i}],{unitId:t,subUnitId:t},!1)}}))}};Ss=fg([Ft(1,T),Ft(2,Ue),Ft(3,U),Ft(4,W(Ie)),Ft(5,W(ae)),Ft(6,W(Y))],Ss);var mg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},rt=(e,t)=>(n,i)=>t(n,i,e);let xs=class extends pe{constructor(e,t,n,i,s,r,o,a,l){super(),y(this,"_isSheetEditor",!1),y(this,"_initTimer"),y(this,"_updateTimer"),this._context=e,this._contextService=t,this._docSkeletonManagerService=n,this._univerInstanceService=i,this._commandService=s,this._textSelectionManagerService=r,this._editorService=o,this._docPageLayoutService=a,this._renderManagerService=l,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),this._isSheetEditor=this._context.unitId===fi;const d=this._univerInstanceService.getCurrentUnitOfType(N.UNIVER_SHEET),c=d&&this._renderManagerService.getRenderById(d.getUnitId());this._initTimer=window.setTimeout(()=>this.updateViewZoom(c&&this._isSheetEditor?c.scene.scaleX:1,!0),20),Xe(this._context.unitId)||this._initZoomEventListener()}dispose(){window.clearTimeout(this._initTimer),window.clearTimeout(this._updateTimer)}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const{unitId:t,scene:n}=this._context;this._editorService.isEditor(t)||this.disposeWithMe(n.onMouseWheel$.subscribeEvent(i=>{if(!i.ctrlKey||!this._contextService.getContextValue(Rn))return;const s=this._univerInstanceService.getCurrentUniverDocInstance();if(!s)return;const{documentFlavor:r}=s.getSnapshot().documentStyle;if(r===Te.MODERN)return;const o=Math.abs(i.deltaX);let a=o<40?.2:o<80?.4:.2;a*=i.deltaY>0?-1:1,n.scaleX<1&&(a/=2);const l=s.zoomRatio;let d=+Number.parseFloat(`${l+a}`).toFixed(1);d=d>=4?4:d<=.1?.1:d,this._commandService.executeCommand(Wn.id,{zoomRatio:d,unitId:s.getUnitId()}),i.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(e=>{if(e==null)return;const t=this._univerInstanceService.getCurrentUniverDocInstance();t&&(this._updateTimer=window.setTimeout(()=>{const n=this._univerInstanceService.getCurrentUnitOfType(N.UNIVER_SHEET),i=n&&this._renderManagerService.getRenderById(n.getUnitId()),s=this._isSheetEditor?i?.scene.scaleX||1:t.zoomRatio;this.updateViewZoom(s,!1)}))}))}_initCommandExecutedListener(){const e=[Ge.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(e.includes(t.id)&&t.params.unitId===this._context.unitId){const n=this._context.unit.zoomRatio||1;this.updateViewZoom(n)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{t.id===Di.id&&this._commandService.executeCommand(Wn.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(e,t=!0){var n;const i=lt(this._context);i.scene.scale(e,e),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),t&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),!Xe(this._context.unitId)&&((n=i.scene.getTransformer())==null||n.clearSelectedObjects())}_initZoomEventListener(){const e=this._context.scene;this.disposeWithMe(e.onMouseWheel$.subscribeEvent(t=>{if(!t.ctrlKey)return;const n=Math.abs(t.deltaX);let i=n<40?.2:n<80?.4:.2;i*=t.deltaY>0?-1:1,e.scaleX<1&&(i/=2);const s=this._context.unit.zoomRatio;let r=+Number.parseFloat(`${s+i}`).toFixed(1);r=r>=4?4:r<=.1?.1:r,this._commandService.executeCommand(Wn.id,{zoomRatio:Math.round(r*10)/10,documentId:this._context.unitId}),t.preventDefault()}))}};xs=mg([rt(1,Ds),rt(2,W(ae)),rt(3,U),rt(4,T),rt(5,W(Y)),rt(6,Ue),rt(7,W(Rr)),rt(8,ce)],xs);const vg=Wo("PRINTING_COMPONENT_COLLECT"),Eg=Wo("PRINTING_DOM_COLLECT");class Ig extends pe{constructor(){super(),y(this,"_printComponentMap",new Map),y(this,"interceptor",new Cl({PRINTING_COMPONENT_COLLECT:vg,PRINTING_DOM_COLLECT:Eg})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:t=>t})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:t=>t}))}registerPrintComponent(t,n){this._printComponentMap.set(t,n)}getPrintComponent(t){return this._printComponentMap.get(t)}}var Cg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},on=(e,t)=>(n,i)=>t(n,i,e);const Qo=300;let ui=class extends gt{constructor(e,t,n,i,s){super(),y(this,"_docStateChange$",new _e(null)),y(this,"docStateChange$",this._docStateChange$.asObservable()),y(this,"_historyStateCache",new Map),y(this,"_changeStateCache",new Map),y(this,"_historyTimer",null),y(this,"_changeStateCacheTimer",null),this._undoRedoService=e,this._commandService=t,this._univerInstanceService=n,this._docStateEmitService=i,this._renderManagerService=s,this._initialize(),this._listenDocStateChange()}getStateCache(e){var t,n;return{history:(t=this._historyStateCache.get(e))!=null?t:[],collaboration:(n=this._changeStateCache.get(e))!=null?n:[]}}setStateCache(e,t){this._historyStateCache.set(e,t.history),this._changeStateCache.set(e,t.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===Tr||e.id===Br){const t=this._univerInstanceService.getCurrentUniverDocInstance();if(t==null)return;const n=t.getUnitId();this._pushHistory(n),this._emitChangeState(n)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(at(this.dispose$)).subscribe(e=>{var t;if(e==null)return;const{isCompositionEnd:n,isSync:i,syncer:s,...r}=e,o=(t=this._renderManagerService.getRenderById(i?s:e.unitId))==null?void 0:t.with(Ti);if(o!=null){if(n){const a=o.fetchComposedUndoRedoMutationParams();if(a==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:l,redoMutationParams:d,previousActiveRange:c}=a;r.redoState.actions=d.actions,r.undoState.actions=l.actions,r.undoState.textRanges=[c]}this._setChangeState(r)}})}_cacheChangeState(e,t="history"){const{trigger:n,unitId:i,noHistory:s,debounce:r=!1}=e;if(s||n==null||t==="history"&&(n===Br||n===Tr))return;const o=t==="history"?this._historyStateCache:this._changeStateCache,a=t==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(o.has(i)){const l=o.get(i);l?.push(e)}else o.set(i,[e]);r?t==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{a(i)},Qo)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{a(i)},Qo)):a(i)}_pushHistory(e){const t=this._undoRedoService,n=this._historyStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const i=n.length,s=n[0].commandId,r=n[0],o=n[i-1],a={unitId:e,actions:n.reduce((d,c)=>V.compose(d,c.redoState.actions),null),textRanges:o.redoState.textRanges},l={unitId:e,actions:n.reverse().reduce((d,c)=>V.compose(d,c.undoState.actions),null),textRanges:r.undoState.textRanges};t.pushUndoRedo({unitID:e,undoMutations:[{id:s,params:l}],redoMutations:[{id:s,params:a}]}),n.length=0}_emitChangeState(e){const t=this._changeStateCache.get(e);if(!Array.isArray(t)||t.length===0)return;const n=t.length,{commandId:i,trigger:s,segmentId:r,noHistory:o,debounce:a}=t[0],l=t[0],d=t[n-1],c={unitId:e,actions:t.reduce((u,h)=>V.compose(u,h.redoState.actions),null),textRanges:d.redoState.textRanges},A={unitId:e,actions:t.reverse().reduce((u,h)=>V.compose(u,h.undoState.actions),null),textRanges:l.undoState.textRanges},g={commandId:i,unitId:e,trigger:s,redoState:c,undoState:A,segmentId:r,noHistory:o,debounce:a};t.length=0,this._docStateChange$.next(g)}};ui=Cg([on(0,W(gi)),on(1,T),on(2,U),on(3,W(ql)),on(4,ce)],ui);var Sg=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},Po=(e,t)=>(n,i)=>t(n,i,e);const Uo="univer-doc-main-canvas";let hi=class extends gt{constructor(e,t){super(),this._instanceSrv=e,this._renderManagerService=t,this._init()}_init(){this._renderManagerService.createRender$.pipe(at(this.dispose$)).subscribe(e=>this._createRenderWithId(e)),this._instanceSrv.getAllUnitsForType(N.UNIVER_DOC).forEach(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitAdded$(N.UNIVER_DOC).pipe(at(this.dispose$)).subscribe(e=>this._createRenderer(e)),this._instanceSrv.getTypeOfUnitDisposed$(N.UNIVER_DOC).pipe(at(this.dispose$)).subscribe(e=>this._disposeRenderer(e))}_createRenderer(e){var t;const n=e.getUnitId(),i=(t=this._instanceSrv.getCurrentUnitForType(N.UNIVER_DOC))==null?void 0:t.getUnitId();this._renderManagerService.created$.subscribe(s=>{s.unitId===i&&(s.engine.getCanvas().setId(Uo),s.engine.getCanvas().getContext().setId(Uo))}),this._renderManagerService.has(n)||this._createRenderWithId(n)}_createRenderWithId(e){this._renderManagerService.createRender(e)}_disposeRenderer(e){const t=e.getUnitId();this._renderManagerService.removeRender(t)}};hi=Sg([Po(0,U),Po(1,ce)],hi);const xg={id:vn.id,preconditions:ku,binding:Z.ENTER},bg={id:bi.id,preconditions:me,binding:Z.BACKSPACE},Rg={id:ga.id,preconditions:me,binding:Z.DELETE},yg={id:ut.id,binding:Z.ARROW_UP,preconditions:me,staticParameters:{direction:oe.UP}},Og={id:ut.id,binding:Z.ARROW_DOWN,preconditions:me,staticParameters:{direction:oe.DOWN}},Tg={id:ut.id,binding:Z.ARROW_LEFT,preconditions:me,staticParameters:{direction:oe.LEFT}},Bg={id:ut.id,binding:Z.ARROW_RIGHT,preconditions:me,staticParameters:{direction:oe.RIGHT}},Mg={id:ht.id,binding:Z.ARROW_UP|te.SHIFT,preconditions:me,staticParameters:{direction:oe.UP}},wg={id:ht.id,binding:Z.ARROW_DOWN|te.SHIFT,preconditions:me,staticParameters:{direction:oe.DOWN}},Ng={id:ht.id,binding:Z.ARROW_LEFT|te.SHIFT,preconditions:me,staticParameters:{direction:oe.LEFT}},_g={id:ht.id,binding:Z.ARROW_RIGHT|te.SHIFT,preconditions:me,staticParameters:{direction:oe.RIGHT}},Dg={id:Ea.id,binding:Z.A|te.CTRL_COMMAND,preconditions:e=>e.getContextValue(Bs)&&(e.getContextValue(Rn)||e.getContextValue(qn))};var Qg=Object.defineProperty,Pg=(e,t,n)=>t in e?Qg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ug=(e,t,n,i)=>{for(var s=t,r=e.length-1,o;r>=0;r--)(o=e[r])&&(s=o(s)||s);return s},an=(e,t)=>(n,i)=>t(n,i,e),Lg=(e,t,n)=>Pg(e,t+"",n);let bs=class extends Tl{constructor(e=bo,t,n,i,s,r){super(),this._config=e,this._injector=t,this._renderManagerSrv=n,this._commandService=i,this._logService=s,this._configService=r;const{menu:o,...a}=Bl({},bo,this._config);o&&this._configService.setConfig("menu",o,{merge:!0}),this._configService.setConfig(Qi,a),this._initDependencies(t),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),Nr(this._injector,[[ui],[hi]])}onRendered(){this._initUI(),this._initRenderModules(),Nr(this._injector,[[ai],[li],[qt],[di],[si]])}_initCommand(){[bi,ga,Bt,Mt,wt,Nt,pt,_t,tt,St,dt,wn,At,ft,Us,ca,En,Vs,ua,js,ha,Ge,Cn,In,Nn,Mi,wi,Ni,nt,_i,Oi,Qa,Pa,gr,pr,rc,fr,mr,Ar,cr,_n,Cr,Ua,Gt,Si,vn,rs,Bi,$n,ya,Oa,Ia,Di,Ke,Aa,Yt,QA,xa,PA,Wn,Ea,xr,ut,ht,LA,Ra,HA,We,Ta,zs,qs,Zs,ir,sr,rr,or,ar,ei,Ba,Ma,er,tr,nr,Xs,al,Sr].forEach(e=>{this.disposeWithMe(this._commandService.registerCommand(e))}),[Xn,Ks,Js].forEach(e=>this.disposeWithMe(this._commandService.registerMultipleCommand(e)))}_initializeShortcut(){[yg,Og,Bg,Tg,Mg,wg,Ng,_g,Dg,bg,Rg,xg,Vu].forEach(e=>{this._injector.get(Ei).registerShortcut(e)})}_initDependencies(e){Ml([[Ig],[Ai],[ci],[si],[ai],[di],[li],[oi],[qt],[Ue,{useClass:cs}],[Tt,{useClass:is}],[xn],[hi],[ui],[Rt],[et]],this._config.override).forEach(t=>e.add(t))}_markDocAsFocused(){const e=this._injector.get(U),t=this._injector.get(Ue);try{const n=e.getCurrentUnitForType(N.UNIVER_DOC);if(!n)return;const i=n.getUnitId();t.isEditor(i)||e.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(oi)}_initRenderBasics(){[[ae],[Ie],[Yl],[Rr],[Ti],[ps],[xs]].forEach(e=>{this._renderManagerSrv.registerRenderModule(N.UNIVER_DOC,e)})}_initRenderModules(){[[yt],[ni],[ii],[ri],[Ss],[hs],[Cs],[vs],[ms],[Ai],[Is],[Es],[ci]].forEach(e=>{this._renderManagerSrv.registerRenderModule(N.UNIVER_DOC,e)})}};Lg(bs,"pluginName",Gd);bs=Ug([zl(Ad),an(1,W(On)),an(2,ce),an(3,T),an(4,Ns),an(5,_s)],bs);function Hg(e){const{editorId:t,initialValue:n,container:i,autoFocus:s,isSingle:r}=e,o=M.useMemo(()=>s??!1,[]),[a,l]=M.useState(),d=J(Ue);return M.useLayoutEffect(()=>{var c,A;if(i.current){const g=typeof n=="string"?void 0:de.deepClone(n),u={body:{dataStream:typeof n=="string"?`${n}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...g,documentStyle:{...g?.documentStyle,pageSize:{width:r?1/0:i.current.clientWidth,height:1/0}},id:t},h=d.register({autofocus:!0,editorUnitId:t,initialSnapshot:u},i.current),p=d.getEditor(t);if(l(p),o){d.focus(t);const f=((A=(c=u.body)==null?void 0:c.dataStream.length)!=null?A:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{h?.dispose()}}},[]),a}const kg=(e,t,n)=>{const i=J(Ue);M.useEffect(()=>{const s=o=>{var a,l;i.getFocusId()!==e||((l=(a=o.target)==null?void 0:a.dataset)==null?void 0:l.editorid)===e||t.current&&!t.current.contains(o.target)&&n?.()},r=setTimeout(()=>{document.addEventListener("click",s)},100);return()=>{document.removeEventListener("click",s),clearTimeout(r)}},[e,i,n,t])};function Fg(e){var t;const n=J(ce).getRenderById(e),i=n?.with(Ie),s=$e(i?.textSelectionInner$);return!!((t=i?.isFocusing)!=null&&t&&s!=null&&s.textRanges.some(r=>r.collapsed))}function Vg(e,t,n){const i=J(T),s=J(Ei),r=M.useMemo(()=>ue(4),[]);M.useEffect(()=>{if(!n||!e||!t)return;const o=`sheet.operation.editor-${n.getEditorId()}-keyboard-${r}`,a=new un;return a.add(i.registerCommand({id:o,type:D.OPERATION,handler(l,d){const{keyCode:c,metaKey:A}=d;t.handler(c,A)}})),t.keyCodes.map(l=>({id:o,binding:l.metaKey?l.keyCode|l.metaKey:l.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:Zo.Keyboard,keyCode:l.keyCode,metaKey:l.metaKey}})).forEach(l=>{a.add(s.registerShortcut(l))}),()=>{a.dispose()}},[i,t,n,e,r,s])}const jg=(e,t,n,i)=>{const s=J(T),r=J(Ei),o=M.useRef(t);o.current=t;const a=M.useRef(i);a.current=i,M.useEffect(()=>{if(!n||!e)return;const l=`sheet.formula-embedding-editor.${n.getEditorId()}`,d=new un,c=(A,g)=>{if(a.current){a.current(A,g);return}let u=oe.LEFT;A===Z.ARROW_DOWN?u=oe.DOWN:A===Z.ARROW_UP?u=oe.UP:A===Z.ARROW_RIGHT&&(u=oe.RIGHT),g===te.SHIFT?s.executeCommand(ht.id,{direction:u}):s.executeCommand(ut.id,{direction:u})};return d.add(s.registerCommand({id:l,type:D.OPERATION,handler(A,g){const{keyCode:u}=g;c(u)}})),[{keyCode:Z.ARROW_DOWN},{keyCode:Z.ARROW_LEFT},{keyCode:Z.ARROW_RIGHT},{keyCode:Z.ARROW_UP},{keyCode:Z.ARROW_DOWN,metaKey:te.SHIFT},{keyCode:Z.ARROW_LEFT,metaKey:te.SHIFT},{keyCode:Z.ARROW_RIGHT,metaKey:te.SHIFT},{keyCode:Z.ARROW_UP,metaKey:te.SHIFT},{keyCode:Z.ARROW_DOWN,metaKey:te.CTRL_COMMAND},{keyCode:Z.ARROW_LEFT,metaKey:te.CTRL_COMMAND},{keyCode:Z.ARROW_RIGHT,metaKey:te.CTRL_COMMAND},{keyCode:Z.ARROW_UP,metaKey:te.CTRL_COMMAND},{keyCode:Z.ARROW_DOWN,metaKey:te.CTRL_COMMAND|te.SHIFT},{keyCode:Z.ARROW_LEFT,metaKey:te.CTRL_COMMAND|te.SHIFT},{keyCode:Z.ARROW_RIGHT,metaKey:te.CTRL_COMMAND|te.SHIFT},{keyCode:Z.ARROW_UP,metaKey:te.CTRL_COMMAND|te.SHIFT}].map(({keyCode:A,metaKey:g})=>({id:l,binding:g?A|g:A,preconditions:()=>!0,priority:900,staticParameters:{eventType:Zo.Keyboard,keyCode:A}})).forEach(A=>{d.add(r.registerShortcut(A))}),()=>{d.dispose()}},[s,n,e,r])};function Wg(e,t){const n=J(T);M.useEffect(()=>{if(!e)return;const i=n.onCommandExecuted(s=>{var r,o;if(s.id===X.id){if(s.params.unitId!==e.getEditorId())return;const a=e.getDocumentData();t(a,Kn((o=(r=a.body)==null?void 0:r.dataStream)!=null?o:""))}});return()=>{i.dispose()}},[e,t,n])}const zg=(e,t=!0,n,i)=>{const s=M.useCallback(()=>{if(e){const{scene:o,mainComponent:a}=e.render,l=e.render.with(ae),{width:d,height:c}=e.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:d,1/0),o.transformByState({width:d,height:c}),a?.resize(d,c)}},[e,t]),r=M.useMemo(()=>Ts(()=>{var o,a;if(!n||!e||!n)return;const l=e.render.with(ae).getSkeleton(),{scene:d,mainComponent:c}=e.render,A=d.getViewport(Pe.VIEW_MAIN),{actualWidth:g,actualHeight:u}=l.getActualSize(),{width:h,height:p}=e.getBoundingClientRect();let f=A?.getScrollBar();const m=Math.max(g,h),C=Math.max(u,p);d.transformByState({width:m,height:C}),c?.resize(m,C),t?g>h?(f==null?A&&new es(A,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):A?.resetCanvasSizeAndUpdateScroll(),i&&A?.scrollToBarPos({x:1/0,y:0})):(f=null,A?.scrollToBarPos({x:0,y:0}),(a=A?.getScrollBar())==null||a.dispose()):u>p?(f==null?A&&(f=new es(A,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):A?.resetCanvasSizeAndUpdateScroll(),i&&A?.scrollToBarPos({x:0,y:1/0})):(f=null,A?.scrollToBarPos({x:0,y:0}),(o=A?.getScrollBar())==null||o.dispose())},30),[e,n,t,i]);return M.useEffect(()=>{if(n&&e){const o=setTimeout(()=>{s(),r()},500);return()=>{clearTimeout(o)}}},[e,n,s,r]),M.useEffect(()=>{if(n&&e){const o=e.input$.subscribe(()=>{r()});return()=>{o.unsubscribe()}}},[e,n,r]),{resize:s,checkScrollBar:r}},dp=e=>{const{className:t,autoFocus:n,onFocusChange:i,initialValue:s,onClickOutside:r,keyboardEventConfig:o,moveCursor:a=!0,style:l,isSingle:d,editorId:c,onHeightChange:A,onChange:g,defaultHeight:u=32,maxHeight:h=32,icon:p,editorRef:f,placeholder:m,noStyle:C}=e;J(Ue);const v=cn(i),I=cn(r),[E,S]=M.useState(u),R=M.useRef(null),b=M.useMemo(()=>c??Ol(`RICH_TEXT_EDITOR-${ue(4)}`),[c]),x=Hg({editorId:b,initialValue:s,container:R,autoFocus:n,isSingle:d}),O=J(ce).getRenderById(b),w=Fg(b),P=M.useRef(null),[Q,H]=M.useState(()=>{var K,ee;return!re.transform.getPlainText((ee=(K=x?.getDocumentData().body)==null?void 0:K.dataStream)!=null?ee:"")}),{checkScrollBar:_}=zg(x,d,!0,!0);M.useLayoutEffect(()=>{if(!(!f||!x)){if(typeof f=="function"){f(x);return}f.current=x}},[x]);const j=cn(K=>{var ee,L;const F=O?.with(ae),ie=F?.getSkeleton().getActualSize();ie&&(A?.(ie.actualHeight),S(Math.max(u,Math.min(ie.actualHeight+10,h)))),g?.(K,Kn((L=(ee=K.body)==null?void 0:ee.dataStream)!=null?L:"")),_()});return M.useEffect(()=>{var K,ee;H(!re.transform.getPlainText((ee=(K=x?.getDocumentData().body)==null?void 0:K.dataStream)!=null?ee:""));const L=x?.selectionChange$.subscribe(()=>{var F,ie;H(!re.transform.getPlainText((ie=(F=x?.getDocumentData().body)==null?void 0:F.dataStream)!=null?ie:""))});return()=>L?.unsubscribe()},[x]),$e(x?.blur$),$e(x?.focus$),M.useEffect(()=>{var K,ee;const L=x?.getDocumentData();v?.(w,Kn((ee=(K=L?.body)==null?void 0:K.dataStream)!=null?ee:""))},[w,v]),kg(b,P,I),jg(w&&a,!1,x),Vg(w,o,x),Wg(x,j),B.jsx("div",{className:t,style:l,children:B.jsxs("div",{className:ke({"univer-border-primary-500":w&&!C,"\n                          univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center\n                          univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2\n                          univer-pt-1.5\n                        ":!C,"univer-size-full":C,[Tn]:!C}),style:{height:E},ref:P,children:[B.jsx("div",{ref:R,className:"univer-relative univer-size-full",onMouseUp:()=>x?.focus()}),p,Q?B.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:m}):null]})})};export{Si as AfterSpaceCommand,wi as AlignCenterCommand,_i as AlignJustifyCommand,Mi as AlignLeftCommand,nt as AlignOperationCommand,Ni as AlignRightCommand,Us as BreakLineCommand,In as BulletListCommand,rs as ChangeListNestingLevelCommand,jn as ChangeListNestingLevelType,Bi as ChangeListTypeCommand,$n as CheckListCommand,PA as CoverContentCommand,Qa as CreateDocTableCommand,Yt as CutContentCommand,Yd as DOCS_COMPONENT_BACKGROUND_LAYER_INDEX,Wr as DOCS_COMPONENT_DEFAULT_Z_INDEX,qd as DOCS_COMPONENT_HEADER_LAYER_INDEX,Li as DOCS_COMPONENT_MAIN_LAYER_INDEX,ze as DOCS_VIEW_KEY,Gd as DOC_UI_PLUGIN_NAME,Eo as DOC_VERTICAL_PADDING,zd as DefaultDocContainerConfig,Wd as DefaultToolbarConfig,En as DeleteCommand,Vs as DeleteCustomBlockCommand,bi as DeleteLeftCommand,ga as DeleteRightCommand,Rt as DocAutoFormatService,ri as DocBackScrollRenderController,xn as DocCanvasPopManagerService,Xn as DocCopyCommand,vr as DocCreateTableOperation,Ks as DocCutCommand,yt as DocEventManagerService,Ti as DocIMEInputManagerService,Js as DocPasteCommand,Ig as DocPrintInterceptorService,ps as DocRenderController,Ea as DocSelectAllCommand,Ie as DocSelectionRenderService,ui as DocStateChangeManagerService,cr as DocTableDeleteColumnsCommand,Ar as DocTableDeleteRowsCommand,_n as DocTableDeleteTableCommand,rc as DocTableInsertColumnCommand,fr as DocTableInsertColumnLeftCommand,mr as DocTableInsertColumnRightCommand,gr as DocTableInsertRowAboveCommand,pr as DocTableInsertRowBellowCommand,Pa as DocTableInsertRowCommand,Ua as DocTableTabCommand,si as DocUIController,hi as DocsRenderService,Wh as DocsUIMenuSchema,Rc as Editor,mA as EditorInsertTextCommandId,cs as EditorService,vn as EnterCommand,Oi as HorizontalLineCommand,Tt as IDocClipboardService,Ue as IEditorService,Ia as IMEInputCommand,Aa as InnerPasteCommand,ca as InsertCommand,HA as InsertCustomRangeCommand,Nn as ListOperationCommand,js as MergeTwoParagraphCommand,ut as MoveCursorOperation,ht as MoveSelectionOperation,np as NORMAL_TEXT_SELECTION_PLUGIN_NAME,ct as NodePositionConvertToCursor,_a as NodePositionConvertToRectRange,Cn as OrderListCommand,bA as PastePluginLark,RA as PastePluginUniver,yA as PastePluginWord,Oa as QuickListCommand,Da as RectRange,QA as ReplaceContentCommand,Ra as ReplaceSelectionCommand,xa as ReplaceSnapshotCommand,LA as ReplaceTextRunsCommand,wn as ResetInlineFormatTextBackgroundColorCommand,dp as RichTextEditor,Wn as SetDocZoomRatioCommand,Ge as SetDocZoomRatioOperation,Bt as SetInlineFormatBoldCommand,ft as SetInlineFormatCommand,St as SetInlineFormatFontFamilyCommand,tt as SetInlineFormatFontSizeCommand,Mt as SetInlineFormatItalicCommand,Nt as SetInlineFormatStrikethroughCommand,pt as SetInlineFormatSubscriptCommand,_t as SetInlineFormatSuperscriptCommand,At as SetInlineFormatTextBackgroundColorCommand,dt as SetInlineFormatTextColorCommand,wt as SetInlineFormatUnderlineCommand,We as SetParagraphNamedStyleCommand,Di as SwitchDocModeCommand,ls as TEXT_RANGE_LAYER_INDEX,Gt as TabCommand,zt as TextRange,ya as ToggleCheckListCommand,bs as UniverDocsUIPlugin,ua as UpdateCommand,Pe as VIEWPORT_KEY,sp as addCustomDecorationBySelectionFactory,Zd as addCustomDecorationFactory,Ki as calcDocRangePositions,BA as convertBodyToHtml,zi as convertPositionsToRectRanges,rp as deleteCustomDecorationFactory,ap as docDrawingPositionToTransform,aa as genTableSource,oa as generateParagraphs,Gn as getAnchorBounding,JA as getCanvasOffsetByEngine,Ve as getCommandSkeleton,Ws as getCursorWhenDelete,AA as getCustomBlockIdsInSelections,fA as getCutActionsFromDocRanges,Kd as getDocObject,ip as getDocObjectById,Hs as getEmptyTableCell,ks as getEmptyTableRow,dr as getLineBounding,oo as getOneTextSelectionRange,le as getRichTextEditPath,Fs as getTableColumn,op as hasParagraphInTable,wa as isInSameTableCell,VA as isValidRectRange,lt as neoGetDocObject,lp as transformToDocDrawingPosition,Hg as useEditor,kg as useEditorClickOutside,Fg as useIsFocusing,Vg as useKeyboardEvent,jg as useLeftAndRightArrow,Wg as useOnChange,zg as useResize,me as whenDocAndEditorFocused};
