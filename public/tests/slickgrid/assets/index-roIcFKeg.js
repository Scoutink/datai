var Q1=Object.defineProperty;var Z1=(i,e,t)=>e in i?Q1(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Ui=(i,e,t)=>(Z1(i,typeof e!="symbol"?e+"":e,t),t);function J1(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const s=Object.getOwnPropertyDescriptor(r,n);s&&Object.defineProperty(i,n,s.get?s:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var ri;(function(i){i.local="local",i.remote="remote"})(ri||(ri={}));class Dm{constructor(e){this.rxjs=e}addRxJsResource(e){this.rxjs=e}executeBackendProcessesCallback(e,t,r,n){const s=new Date;t&&r.service.postProcess&&r.service.postProcess(t),t&&(r!=null&&r.internalPostProcess)&&r.internalPostProcess(t),r.postProcess!==void 0&&(t instanceof Object&&(t.metrics={startTime:e,endTime:s,executionTime:s.valueOf()-e.valueOf(),itemCount:n,totalItemCount:n}),r.postProcess(t))}onBackendError(e,t){if(typeof(t==null?void 0:t.onError)=="function")t.onError(e);else throw e}executeBackendCallback(e,t,r,n,s,a){var o;if(e){r&&!r.clearFilterTriggered&&!r.clearSortTriggered&&(a!=null&&a.emitActionChangedCallback)&&a.emitActionChangedCallback.call(this,ri.remote);const c=e.process(t);if(c instanceof Promise&&c.then)c.then(h=>{var l;this.executeBackendProcessesCallback(n,h,e,s),(l=a==null?void 0:a.successCallback)==null||l.call(this,r)}).catch(h=>{var l;(l=a==null?void 0:a.errorCallback)==null||l.call(this,r),this.onBackendError(h,e)});else if((o=this.rxjs)!=null&&o.isObservable(c)){const h=this.rxjs;h.isObservable(a==null?void 0:a.httpCancelRequestSubject)&&(a==null||a.httpCancelRequestSubject.next()),c.pipe(h.takeUntil(h.iif(()=>h.isObservable(a==null?void 0:a.httpCancelRequestSubject),a==null?void 0:a.httpCancelRequestSubject,h.EMPTY))).subscribe(l=>{var u;this.executeBackendProcessesCallback(n,l,e,s),(u=a==null?void 0:a.successCallback)==null||u.call(this,r)},l=>{var u;(u=a==null?void 0:a.errorCallback)==null||u.call(this,r),this.onBackendError(l,e)})}}}refreshBackendDataset(e){var n;let t="";const r=e==null?void 0:e.backendServiceApi;if(!r||!r.service||!r.process)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');if(r.service&&(t=r.service.buildQuery()),t&&t!==""){const s=new Date;r.preProcess&&r.preProcess();const a=((n=e==null?void 0:e.pagination)==null?void 0:n.totalItems)??0;this.executeBackendCallback(r,t,null,s,a)}}}const eE=Object.freeze(Object.defineProperty({__proto__:null,BackendUtilityService:Dm},Symbol.toStringTag,{value:"Module"}));function Jo(i,e){["pop","push","reverse","shift","unshift","splice","sort"].forEach(r=>{i[r]=(...n)=>{const s=Array.prototype[r].apply(i,n);return e.apply(i,[i,n]),s}})}function Od(i,e,t){let r=i[e];Object.defineProperty(i,e,{configurable:!0,get(){return r},set(n){r=n,t.apply(i,[n,i[e]])}})}const tE=Object.freeze(Object.defineProperty({__proto__:null,collectionObserver:Jo,propertyObserver:Od},Symbol.toStringTag,{value:"Module"})),iE=i=>i;function rE(i,e,t=iE,r=()=>{}){const n=i&&i.length?[{pointer:i,offset:0}]:[],s=[];let a;for(;n.length;)for(a=n.pop();a.offset<a.pointer.length;){const o=a.pointer[a.offset],c=r(o),h=e(o);s.push(t(o,a.node,c,a.nodeId)),a.offset+=1,h&&(n.push(a),a={pointer:h,offset:0,node:o,nodeId:c})}return s}var Id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function nE(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fm={exports:{}};(function(i,e){(function(t,r){i.exports=r()})(Id,function(){var t;function r(){return t.apply(null,arguments)}function n(g){return g instanceof Array||Object.prototype.toString.call(g)==="[object Array]"}function s(g){return g!=null&&Object.prototype.toString.call(g)==="[object Object]"}function a(g,w){return Object.prototype.hasOwnProperty.call(g,w)}function o(g){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(g).length===0;for(var w in g)if(a(g,w))return;return 1}function c(g){return g===void 0}function h(g){return typeof g=="number"||Object.prototype.toString.call(g)==="[object Number]"}function l(g){return g instanceof Date||Object.prototype.toString.call(g)==="[object Date]"}function u(g,w){for(var S=[],A=g.length,B=0;B<A;++B)S.push(w(g[B],B));return S}function d(g,w){for(var S in w)a(w,S)&&(g[S]=w[S]);return a(w,"toString")&&(g.toString=w.toString),a(w,"valueOf")&&(g.valueOf=w.valueOf),g}function f(g,w,S,A){return n0(g,w,S,A,!0).utc()}function p(g){return g._pf==null&&(g._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),g._pf}function m(g){if(g._isValid==null){var w=p(g),S=_.call(w.parsedDateParts,function(A){return A!=null}),S=!isNaN(g._d.getTime())&&w.overflow<0&&!w.empty&&!w.invalidEra&&!w.invalidMonth&&!w.invalidWeekday&&!w.weekdayMismatch&&!w.nullInput&&!w.invalidFormat&&!w.userInvalidated&&(!w.meridiem||w.meridiem&&S);if(g._strict&&(S=S&&w.charsLeftOver===0&&w.unusedTokens.length===0&&w.bigHour===void 0),Object.isFrozen!=null&&Object.isFrozen(g))return S;g._isValid=S}return g._isValid}function v(g){var w=f(NaN);return g!=null?d(p(w),g):p(w).userInvalidated=!0,w}var _=Array.prototype.some||function(g){for(var w=Object(this),S=w.length>>>0,A=0;A<S;A++)if(A in w&&g.call(this,w[A],A,w))return!0;return!1},x=r.momentProperties=[],E=!1;function C(g,w){var S,A,B,te=x.length;if(c(w._isAMomentObject)||(g._isAMomentObject=w._isAMomentObject),c(w._i)||(g._i=w._i),c(w._f)||(g._f=w._f),c(w._l)||(g._l=w._l),c(w._strict)||(g._strict=w._strict),c(w._tzm)||(g._tzm=w._tzm),c(w._isUTC)||(g._isUTC=w._isUTC),c(w._offset)||(g._offset=w._offset),c(w._pf)||(g._pf=p(w)),c(w._locale)||(g._locale=w._locale),0<te)for(S=0;S<te;S++)c(B=w[A=x[S]])||(g[A]=B);return g}function y(g){C(this,g),this._d=new Date(g._d!=null?g._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),E===!1&&(E=!0,r.updateOffset(this),E=!1)}function b(g){return g instanceof y||g!=null&&g._isAMomentObject!=null}function T(g){r.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+g)}function R(g,w){var S=!0;return d(function(){if(r.deprecationHandler!=null&&r.deprecationHandler(null,g),S){for(var A,B,te=[],ve=arguments.length,Oe=0;Oe<ve;Oe++){if(A="",typeof arguments[Oe]=="object"){for(B in A+=`
[`+Oe+"] ",arguments[0])a(arguments[0],B)&&(A+=B+": "+arguments[0][B]+", ");A=A.slice(0,-2)}else A=arguments[Oe];te.push(A)}T(g+`
Arguments: `+Array.prototype.slice.call(te).join("")+`
`+new Error().stack),S=!1}return w.apply(this,arguments)},w)}var O={};function W(g,w){r.deprecationHandler!=null&&r.deprecationHandler(g,w),O[g]||(T(w),O[g]=!0)}function G(g){return typeof Function<"u"&&g instanceof Function||Object.prototype.toString.call(g)==="[object Function]"}function Q(g,w){var S,A=d({},g);for(S in w)a(w,S)&&(s(g[S])&&s(w[S])?(A[S]={},d(A[S],g[S]),d(A[S],w[S])):w[S]!=null?A[S]=w[S]:delete A[S]);for(S in g)a(g,S)&&!a(w,S)&&s(g[S])&&(A[S]=d({},A[S]));return A}function ne(g){g!=null&&this.set(g)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null;var xe=Object.keys||function(g){var w,S=[];for(w in g)a(g,w)&&S.push(w);return S};function Ce(g,w,S){var A=""+Math.abs(g);return(0<=g?S?"+":"":"-")+Math.pow(10,Math.max(0,w-A.length)).toString().substr(1)+A}var Fe=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ke=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Ze={},ie={};function Ee(g,w,S,A){var B=typeof A=="string"?function(){return this[A]()}:A;g&&(ie[g]=B),w&&(ie[w[0]]=function(){return Ce(B.apply(this,arguments),w[1],w[2])}),S&&(ie[S]=function(){return this.localeData().ordinal(B.apply(this,arguments),g)})}function Pe(g,w){return g.isValid()?(w=U(w,g.localeData()),Ze[w]=Ze[w]||function(S){for(var A,B=S.match(Fe),te=0,ve=B.length;te<ve;te++)ie[B[te]]?B[te]=ie[B[te]]:B[te]=(A=B[te]).match(/\[[\s\S]/)?A.replace(/^\[|\]$/g,""):A.replace(/\\/g,"");return function(Oe){for(var Xe="",Be=0;Be<ve;Be++)Xe+=G(B[Be])?B[Be].call(Oe,S):B[Be];return Xe}}(w),Ze[w](g)):g.localeData().invalidDate()}function U(g,w){var S=5;function A(B){return w.longDateFormat(B)||B}for(ke.lastIndex=0;0<=S&&ke.test(g);)g=g.replace(ke,A),ke.lastIndex=0,--S;return g}var Z={};function q(g,w){var S=g.toLowerCase();Z[S]=Z[S+"s"]=Z[w]=g}function X(g){return typeof g=="string"?Z[g]||Z[g.toLowerCase()]:void 0}function de(g){var w,S,A={};for(S in g)a(g,S)&&(w=X(S))&&(A[w]=g[S]);return A}var Ie={};function we(g,w){Ie[g]=w}function Re(g){return g%4==0&&g%100!=0||g%400==0}function be(g){return g<0?Math.ceil(g)||0:Math.floor(g)}function ue(w){var w=+w,S=0;return S=w!=0&&isFinite(w)?be(w):S}function M(g,w){return function(S){return S!=null?(et(this,g,S),r.updateOffset(this,w),this):it(this,g)}}function it(g,w){return g.isValid()?g._d["get"+(g._isUTC?"UTC":"")+w]():NaN}function et(g,w,S){g.isValid()&&!isNaN(S)&&(w==="FullYear"&&Re(g.year())&&g.month()===1&&g.date()===29?(S=ue(S),g._d["set"+(g._isUTC?"UTC":"")+w](S,g.month(),ir(S,g.month()))):g._d["set"+(g._isUTC?"UTC":"")+w](S))}var he=/\d/,ft=/\d\d/,Qe=/\d{3}/,Qs=/\d{4}/,bs=/[+-]?\d{6}/,Te=/\d\d?/,dt=/\d\d\d\d?/,wt=/\d\d\d\d\d\d?/,Gt=/\d{1,3}/,Ts=/\d{1,4}/,Ss=/[+-]?\d{1,6}/,Ri=/\d+/,or=/[+-]?\d+/,lr=/Z|[+-]\d\d:?\d\d/gi,ni=/Z|[+-]\d\d(?::?\d\d)?/gi,$t=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function He(g,w,S){Li[g]=G(w)?w:function(A,B){return A&&S?S:w}}function Di(g,w){return a(Li,g)?Li[g](w._strict,w._locale):new RegExp(Nt(g.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(S,A,B,te,ve){return A||B||te||ve})))}function Nt(g){return g.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Li={},vt={};function rt(g,w){var S,A,B=w;for(typeof g=="string"&&(g=[g]),h(w)&&(B=function(te,ve){ve[w]=ue(te)}),A=g.length,S=0;S<A;S++)vt[g[S]]=B}function fi(g,w){rt(g,function(S,A,B,te){B._w=B._w||{},w(S,B._w,B,te)})}var _t,Wt=0,Et=1,vi=2,Xt=3,Bi=4,qi=5,Ki=6,Zi=7,qs=8;function ir(g,w){if(isNaN(g)||isNaN(w))return NaN;var S=(w%(S=12)+S)%S;return g+=(w-S)/12,S==1?Re(g)?29:28:31-S%7%2}_t=Array.prototype.indexOf||function(g){for(var w=0;w<this.length;++w)if(this[w]===g)return w;return-1},Ee("M",["MM",2],"Mo",function(){return this.month()+1}),Ee("MMM",0,0,function(g){return this.localeData().monthsShort(this,g)}),Ee("MMMM",0,0,function(g){return this.localeData().months(this,g)}),q("month","M"),we("month",8),He("M",Te),He("MM",Te,ft),He("MMM",function(g,w){return w.monthsShortRegex(g)}),He("MMMM",function(g,w){return w.monthsRegex(g)}),rt(["M","MM"],function(g,w){w[Et]=ue(g)-1}),rt(["MMM","MMMM"],function(g,w,S,A){A=S._locale.monthsParse(g,A,S._strict),A!=null?w[Et]=A:p(S).invalidMonth=g});var F="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),V="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ee=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,fe=$t,Me=$t;function Ge(g,w){var S;if(g.isValid()){if(typeof w=="string"){if(/^\d+$/.test(w))w=ue(w);else if(!h(w=g.localeData().monthsParse(w)))return}S=Math.min(g.date(),ir(g.year(),w)),g._d["set"+(g._isUTC?"UTC":"")+"Month"](w,S)}}function lt(g){return g!=null?(Ge(this,g),r.updateOffset(this,!0),this):it(this,"Month")}function qe(){function g(ve,Oe){return Oe.length-ve.length}for(var w,S=[],A=[],B=[],te=0;te<12;te++)w=f([2e3,te]),S.push(this.monthsShort(w,"")),A.push(this.months(w,"")),B.push(this.months(w,"")),B.push(this.monthsShort(w,""));for(S.sort(g),A.sort(g),B.sort(g),te=0;te<12;te++)S[te]=Nt(S[te]),A[te]=Nt(A[te]);for(te=0;te<24;te++)B[te]=Nt(B[te]);this._monthsRegex=new RegExp("^("+B.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+A.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+S.join("|")+")","i")}function ot(g){return Re(g)?366:365}Ee("Y",0,0,function(){var g=this.year();return g<=9999?Ce(g,4):"+"+g}),Ee(0,["YY",2],0,function(){return this.year()%100}),Ee(0,["YYYY",4],0,"year"),Ee(0,["YYYYY",5],0,"year"),Ee(0,["YYYYYY",6,!0],0,"year"),q("year","y"),we("year",1),He("Y",or),He("YY",Te,ft),He("YYYY",Ts,Qs),He("YYYYY",Ss,bs),He("YYYYYY",Ss,bs),rt(["YYYYY","YYYYYY"],Wt),rt("YYYY",function(g,w){w[Wt]=g.length===2?r.parseTwoDigitYear(g):ue(g)}),rt("YY",function(g,w){w[Wt]=r.parseTwoDigitYear(g)}),rt("Y",function(g,w){w[Wt]=parseInt(g,10)}),r.parseTwoDigitYear=function(g){return ue(g)+(68<ue(g)?1900:2e3)};var Xl=M("FullYear",!0);function Ke(g,w,S,A,B,te,ve){var Oe;return g<100&&0<=g?(Oe=new Date(g+400,w,S,A,B,te,ve),isFinite(Oe.getFullYear())&&Oe.setFullYear(g)):Oe=new Date(g,w,S,A,B,te,ve),Oe}function je(g){var w;return g<100&&0<=g?((w=Array.prototype.slice.call(arguments))[0]=g+400,w=new Date(Date.UTC.apply(null,w)),isFinite(w.getUTCFullYear())&&w.setUTCFullYear(g)):w=new Date(Date.UTC.apply(null,arguments)),w}function bt(g,w,S){return S=7+w-S,S-(7+je(g,0,S).getUTCDay()-w)%7-1}function k(g,ve,Oe,A,B){var te,ve=1+7*(ve-1)+(7+Oe-A)%7+bt(g,A,B),Oe=ve<=0?ot(te=g-1)+ve:ve>ot(g)?(te=g+1,ve-ot(g)):(te=g,ve);return{year:te,dayOfYear:Oe}}function L(g,w,S){var A,B,te=bt(g.year(),w,S),te=Math.floor((g.dayOfYear()-te-1)/7)+1;return te<1?A=te+D(B=g.year()-1,w,S):te>D(g.year(),w,S)?(A=te-D(g.year(),w,S),B=g.year()+1):(B=g.year(),A=te),{week:A,year:B}}function D(g,B,S){var A=bt(g,B,S),B=bt(g+1,B,S);return(ot(g)-A+B)/7}Ee("w",["ww",2],"wo","week"),Ee("W",["WW",2],"Wo","isoWeek"),q("week","w"),q("isoWeek","W"),we("week",5),we("isoWeek",5),He("w",Te),He("ww",Te,ft),He("W",Te),He("WW",Te,ft),fi(["w","ww","W","WW"],function(g,w,S,A){w[A.substr(0,1)]=ue(g)});function N(g,w){return g.slice(w,7).concat(g.slice(0,w))}Ee("d",0,"do","day"),Ee("dd",0,0,function(g){return this.localeData().weekdaysMin(this,g)}),Ee("ddd",0,0,function(g){return this.localeData().weekdaysShort(this,g)}),Ee("dddd",0,0,function(g){return this.localeData().weekdays(this,g)}),Ee("e",0,0,"weekday"),Ee("E",0,0,"isoWeekday"),q("day","d"),q("weekday","e"),q("isoWeekday","E"),we("day",11),we("weekday",11),we("isoWeekday",11),He("d",Te),He("e",Te),He("E",Te),He("dd",function(g,w){return w.weekdaysMinRegex(g)}),He("ddd",function(g,w){return w.weekdaysShortRegex(g)}),He("dddd",function(g,w){return w.weekdaysRegex(g)}),fi(["dd","ddd","dddd"],function(g,w,S,A){A=S._locale.weekdaysParse(g,A,S._strict),A!=null?w.d=A:p(S).invalidWeekday=g}),fi(["d","e","E"],function(g,w,S,A){w[A]=ue(g)});var H="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),z="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),se="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),ge=$t,ae=$t,ce=$t;function J(){function g(Be,pt){return pt.length-Be.length}for(var w,S,A,B=[],te=[],ve=[],Oe=[],Xe=0;Xe<7;Xe++)A=f([2e3,1]).day(Xe),w=Nt(this.weekdaysMin(A,"")),S=Nt(this.weekdaysShort(A,"")),A=Nt(this.weekdays(A,"")),B.push(w),te.push(S),ve.push(A),Oe.push(w),Oe.push(S),Oe.push(A);B.sort(g),te.sort(g),ve.sort(g),Oe.sort(g),this._weekdaysRegex=new RegExp("^("+Oe.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+ve.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+te.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+B.join("|")+")","i")}function P(){return this.hours()%12||12}function re(g,w){Ee(g,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),w)})}function pe(g,w){return w._meridiemParse}Ee("H",["HH",2],0,"hour"),Ee("h",["hh",2],0,P),Ee("k",["kk",2],0,function(){return this.hours()||24}),Ee("hmm",0,0,function(){return""+P.apply(this)+Ce(this.minutes(),2)}),Ee("hmmss",0,0,function(){return""+P.apply(this)+Ce(this.minutes(),2)+Ce(this.seconds(),2)}),Ee("Hmm",0,0,function(){return""+this.hours()+Ce(this.minutes(),2)}),Ee("Hmmss",0,0,function(){return""+this.hours()+Ce(this.minutes(),2)+Ce(this.seconds(),2)}),re("a",!0),re("A",!1),q("hour","h"),we("hour",13),He("a",pe),He("A",pe),He("H",Te),He("h",Te),He("k",Te),He("HH",Te,ft),He("hh",Te,ft),He("kk",Te,ft),He("hmm",dt),He("hmmss",wt),He("Hmm",dt),He("Hmmss",wt),rt(["H","HH"],Xt),rt(["k","kk"],function(g,w,S){g=ue(g),w[Xt]=g===24?0:g}),rt(["a","A"],function(g,w,S){S._isPm=S._locale.isPM(g),S._meridiem=g}),rt(["h","hh"],function(g,w,S){w[Xt]=ue(g),p(S).bigHour=!0}),rt("hmm",function(g,w,S){var A=g.length-2;w[Xt]=ue(g.substr(0,A)),w[Bi]=ue(g.substr(A)),p(S).bigHour=!0}),rt("hmmss",function(g,w,S){var A=g.length-4,B=g.length-2;w[Xt]=ue(g.substr(0,A)),w[Bi]=ue(g.substr(A,2)),w[qi]=ue(g.substr(B)),p(S).bigHour=!0}),rt("Hmm",function(g,w,S){var A=g.length-2;w[Xt]=ue(g.substr(0,A)),w[Bi]=ue(g.substr(A))}),rt("Hmmss",function(g,w,S){var A=g.length-4,B=g.length-2;w[Xt]=ue(g.substr(0,A)),w[Bi]=ue(g.substr(A,2)),w[qi]=ue(g.substr(B))}),$t=M("Hours",!0);var Se,Ne={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:F,monthsShort:V,week:{dow:0,doy:6},weekdays:H,weekdaysMin:se,weekdaysShort:z,meridiemParse:/[ap]\.?m?\.?/i},Le={},Ct={};function Ft(g){return g&&g.toLowerCase().replace("_","-")}function si(g){for(var w,S,A,B,te=0;te<g.length;){for(w=(B=Ft(g[te]).split("-")).length,S=(S=Ft(g[te+1]))?S.split("-"):null;0<w;){if(A=Dr(B.slice(0,w).join("-")))return A;if(S&&S.length>=w&&function(ve,Oe){for(var Xe=Math.min(ve.length,Oe.length),Be=0;Be<Xe;Be+=1)if(ve[Be]!==Oe[Be])return Be;return Xe}(B,S)>=w-1)break;w--}te++}return Se}function Dr(g){var w;if(Le[g]===void 0&&i&&i.exports&&g.match("^[^/\\\\]*$")!=null)try{w=Se._abbr,nE("./locale/"+g),Vt(w)}catch{Le[g]=null}return Le[g]}function Vt(g,w){return g&&((w=c(w)?Hi(g):an(g,w))?Se=w:typeof console<"u"&&console.warn&&console.warn("Locale "+g+" not found. Did you forget to load it?")),Se._abbr}function an(g,w){if(w===null)return delete Le[g],null;var S,A=Ne;if(w.abbr=g,Le[g]!=null)W("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),A=Le[g]._config;else if(w.parentLocale!=null)if(Le[w.parentLocale]!=null)A=Le[w.parentLocale]._config;else{if((S=Dr(w.parentLocale))==null)return Ct[w.parentLocale]||(Ct[w.parentLocale]=[]),Ct[w.parentLocale].push({name:g,config:w}),null;A=S._config}return Le[g]=new ne(Q(A,w)),Ct[g]&&Ct[g].forEach(function(B){an(B.name,B.config)}),Vt(g),Le[g]}function Hi(g){var w;if(!(g=g&&g._locale&&g._locale._abbr?g._locale._abbr:g))return Se;if(!n(g)){if(w=Dr(g))return w;g=[g]}return si(g)}function Ks(g){var w=g._a;return w&&p(g).overflow===-2&&(w=w[Et]<0||11<w[Et]?Et:w[vi]<1||w[vi]>ir(w[Wt],w[Et])?vi:w[Xt]<0||24<w[Xt]||w[Xt]===24&&(w[Bi]!==0||w[qi]!==0||w[Ki]!==0)?Xt:w[Bi]<0||59<w[Bi]?Bi:w[qi]<0||59<w[qi]?qi:w[Ki]<0||999<w[Ki]?Ki:-1,p(g)._overflowDayOfYear&&(w<Wt||vi<w)&&(w=vi),p(g)._overflowWeeks&&w===-1&&(w=Zi),p(g)._overflowWeekday&&w===-1&&(w=qs),p(g).overflow=w),g}var Cn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,M1=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,L1=/Z|[+-]\d\d(?::?\d\d)?/,Ul=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Wh=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],B1=/^\/?Date\((-?\d+)/i,H1=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,V1={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function t0(g){var w,S,A,B,te,ve,Xe=g._i,Oe=Cn.exec(Xe)||M1.exec(Xe),Xe=Ul.length,Be=Wh.length;if(Oe){for(p(g).iso=!0,w=0,S=Xe;w<S;w++)if(Ul[w][1].exec(Oe[1])){B=Ul[w][0],A=Ul[w][2]!==!1;break}if(B==null)g._isValid=!1;else{if(Oe[3]){for(w=0,S=Be;w<S;w++)if(Wh[w][1].exec(Oe[3])){te=(Oe[2]||" ")+Wh[w][0];break}if(te==null)return void(g._isValid=!1)}if(A||te==null){if(Oe[4]){if(!L1.exec(Oe[4]))return void(g._isValid=!1);ve="Z"}g._f=B+(te||"")+(ve||""),Gh(g)}else g._isValid=!1}}else g._isValid=!1}function U1(g,w,S,A,B,te){return g=[function(ve){ve=parseInt(ve,10);{if(ve<=49)return 2e3+ve;if(ve<=999)return 1900+ve}return ve}(g),V.indexOf(w),parseInt(S,10),parseInt(A,10),parseInt(B,10)],te&&g.push(parseInt(te,10)),g}function i0(g){var w,S,A,B,te=H1.exec(g._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));te?(w=U1(te[4],te[3],te[2],te[5],te[6],te[7]),S=te[1],A=w,B=g,S&&z.indexOf(S)!==new Date(A[0],A[1],A[2]).getDay()?(p(B).weekdayMismatch=!0,B._isValid=!1):(g._a=w,g._tzm=(S=te[8],A=te[9],B=te[10],S?V1[S]:A?0:60*(((S=parseInt(B,10))-(A=S%100))/100)+A),g._d=je.apply(null,g._a),g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),p(g).rfc2822=!0)):g._isValid=!1}function Fa(g,w,S){return g??w??S}function zh(g){var w,S,A,B,te,ve,Oe,Xe,Be,pt,at,_i=[];if(!g._d){for(A=g,B=new Date(r.now()),S=A._useUTC?[B.getUTCFullYear(),B.getUTCMonth(),B.getUTCDate()]:[B.getFullYear(),B.getMonth(),B.getDate()],g._w&&g._a[vi]==null&&g._a[Et]==null&&((B=(A=g)._w).GG!=null||B.W!=null||B.E!=null?(Xe=1,Be=4,te=Fa(B.GG,A._a[Wt],L(ai(),1,4).year),ve=Fa(B.W,1),((Oe=Fa(B.E,1))<1||7<Oe)&&(pt=!0)):(Xe=A._locale._week.dow,Be=A._locale._week.doy,at=L(ai(),Xe,Be),te=Fa(B.gg,A._a[Wt],at.year),ve=Fa(B.w,at.week),B.d!=null?((Oe=B.d)<0||6<Oe)&&(pt=!0):B.e!=null?(Oe=B.e+Xe,(B.e<0||6<B.e)&&(pt=!0)):Oe=Xe),ve<1||ve>D(te,Xe,Be)?p(A)._overflowWeeks=!0:pt!=null?p(A)._overflowWeekday=!0:(at=k(te,ve,Oe,Xe,Be),A._a[Wt]=at.year,A._dayOfYear=at.dayOfYear)),g._dayOfYear!=null&&(B=Fa(g._a[Wt],S[Wt]),(g._dayOfYear>ot(B)||g._dayOfYear===0)&&(p(g)._overflowDayOfYear=!0),pt=je(B,0,g._dayOfYear),g._a[Et]=pt.getUTCMonth(),g._a[vi]=pt.getUTCDate()),w=0;w<3&&g._a[w]==null;++w)g._a[w]=_i[w]=S[w];for(;w<7;w++)g._a[w]=_i[w]=g._a[w]==null?w===2?1:0:g._a[w];g._a[Xt]===24&&g._a[Bi]===0&&g._a[qi]===0&&g._a[Ki]===0&&(g._nextDay=!0,g._a[Xt]=0),g._d=(g._useUTC?je:Ke).apply(null,_i),te=g._useUTC?g._d.getUTCDay():g._d.getDay(),g._tzm!=null&&g._d.setUTCMinutes(g._d.getUTCMinutes()-g._tzm),g._nextDay&&(g._a[Xt]=24),g._w&&g._w.d!==void 0&&g._w.d!==te&&(p(g).weekdayMismatch=!0)}}function Gh(g){if(g._f===r.ISO_8601)t0(g);else if(g._f===r.RFC_2822)i0(g);else{g._a=[],p(g).empty=!0;for(var w,S,A,B,te,ve=""+g._i,Oe=ve.length,Xe=0,Be=U(g._f,g._locale).match(Fe)||[],pt=Be.length,at=0;at<pt;at++)S=Be[at],(w=(ve.match(Di(S,g))||[])[0])&&(0<(A=ve.substr(0,ve.indexOf(w))).length&&p(g).unusedInput.push(A),ve=ve.slice(ve.indexOf(w)+w.length),Xe+=w.length),ie[S]?(w?p(g).empty=!1:p(g).unusedTokens.push(S),A=S,te=g,(B=w)!=null&&a(vt,A)&&vt[A](B,te._a,te,A)):g._strict&&!w&&p(g).unusedTokens.push(S);p(g).charsLeftOver=Oe-Xe,0<ve.length&&p(g).unusedInput.push(ve),g._a[Xt]<=12&&p(g).bigHour===!0&&0<g._a[Xt]&&(p(g).bigHour=void 0),p(g).parsedDateParts=g._a.slice(0),p(g).meridiem=g._meridiem,g._a[Xt]=function(_i,Vi,Sn){return Sn==null?Vi:_i.meridiemHour!=null?_i.meridiemHour(Vi,Sn):_i.isPM!=null?((_i=_i.isPM(Sn))&&Vi<12&&(Vi+=12),Vi=_i||Vi!==12?Vi:0):Vi}(g._locale,g._a[Xt],g._meridiem),(Oe=p(g).era)!==null&&(g._a[Wt]=g._locale.erasConvertYear(Oe,g._a[Wt])),zh(g),Ks(g)}}function r0(g){var w,S,A,B=g._i,te=g._f;return g._locale=g._locale||Hi(g._l),B===null||te===void 0&&B===""?v({nullInput:!0}):(typeof B=="string"&&(g._i=B=g._locale.preparse(B)),b(B)?new y(Ks(B)):(l(B)?g._d=B:n(te)?function(ve){var Oe,Xe,Be,pt,at,_i,Vi=!1,Sn=ve._f.length;if(Sn===0)return p(ve).invalidFormat=!0,ve._d=new Date(NaN);for(pt=0;pt<Sn;pt++)at=0,_i=!1,Oe=C({},ve),ve._useUTC!=null&&(Oe._useUTC=ve._useUTC),Oe._f=ve._f[pt],Gh(Oe),m(Oe)&&(_i=!0),at=(at+=p(Oe).charsLeftOver)+10*p(Oe).unusedTokens.length,p(Oe).score=at,Vi?at<Be&&(Be=at,Xe=Oe):(Be==null||at<Be||_i)&&(Be=at,Xe=Oe,_i&&(Vi=!0));d(ve,Xe||Oe)}(g):te?Gh(g):c(te=(B=g)._i)?B._d=new Date(r.now()):l(te)?B._d=new Date(te.valueOf()):typeof te=="string"?(S=B,(w=B1.exec(S._i))!==null?S._d=new Date(+w[1]):(t0(S),S._isValid===!1&&(delete S._isValid,i0(S),S._isValid===!1&&(delete S._isValid,S._strict?S._isValid=!1:r.createFromInputFallback(S))))):n(te)?(B._a=u(te.slice(0),function(ve){return parseInt(ve,10)}),zh(B)):s(te)?(w=B)._d||(A=(S=de(w._i)).day===void 0?S.date:S.day,w._a=u([S.year,S.month,A,S.hour,S.minute,S.second,S.millisecond],function(ve){return ve&&parseInt(ve,10)}),zh(w)):h(te)?B._d=new Date(te):r.createFromInputFallback(B),m(g)||(g._d=null),g))}function n0(g,w,S,A,B){var te={};return w!==!0&&w!==!1||(A=w,w=void 0),S!==!0&&S!==!1||(A=S,S=void 0),(s(g)&&o(g)||n(g)&&g.length===0)&&(g=void 0),te._isAMomentObject=!0,te._useUTC=te._isUTC=B,te._l=S,te._i=g,te._f=w,te._strict=A,(B=new y(Ks(r0(B=te))))._nextDay&&(B.add(1,"d"),B._nextDay=void 0),B}function ai(g,w,S,A){return n0(g,w,S,A,!1)}r.createFromInputFallback=R("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(g){g._d=new Date(g._i+(g._useUTC?" UTC":""))}),r.ISO_8601=function(){},r.RFC_2822=function(){},dt=R("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var g=ai.apply(null,arguments);return this.isValid()&&g.isValid()?g<this?this:g:v()}),wt=R("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var g=ai.apply(null,arguments);return this.isValid()&&g.isValid()?this<g?this:g:v()});function s0(g,w){var S,A;if(!(w=w.length===1&&n(w[0])?w[0]:w).length)return ai();for(S=w[0],A=1;A<w.length;++A)w[A].isValid()&&!w[A][g](S)||(S=w[A]);return S}var yo=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Wl(w){var w=de(w),S=w.year||0,A=w.quarter||0,B=w.month||0,te=w.week||w.isoWeek||0,ve=w.day||0,Oe=w.hour||0,Xe=w.minute||0,Be=w.second||0,pt=w.millisecond||0;this._isValid=function(at){var _i,Vi,Sn=!1,eu=yo.length;for(_i in at)if(a(at,_i)&&(_t.call(yo,_i)===-1||at[_i]!=null&&isNaN(at[_i])))return!1;for(Vi=0;Vi<eu;++Vi)if(at[yo[Vi]]){if(Sn)return!1;parseFloat(at[yo[Vi]])!==ue(at[yo[Vi]])&&(Sn=!0)}return!0}(w),this._milliseconds=+pt+1e3*Be+6e4*Xe+1e3*Oe*60*60,this._days=+ve+7*te,this._months=+B+3*A+12*S,this._data={},this._locale=Hi(),this._bubble()}function zl(g){return g instanceof Wl}function $h(g){return g<0?-1*Math.round(-1*g):Math.round(g)}function a0(g,w){Ee(g,0,0,function(){var S=this.utcOffset(),A="+";return S<0&&(S=-S,A="-"),A+Ce(~~(S/60),2)+w+Ce(~~S%60,2)})}a0("Z",":"),a0("ZZ",""),He("Z",ni),He("ZZ",ni),rt(["Z","ZZ"],function(g,w,S){S._useUTC=!0,S._tzm=Yh(ni,g)});var W1=/([\+\-]|\d\d)/gi;function Yh(g,S){var S=(S||"").match(g);return S===null?null:(S=60*(g=((S[S.length-1]||[])+"").match(W1)||["-",0,0])[1]+ue(g[2]))===0?0:g[0]==="+"?S:-S}function Xh(g,w){var S;return w._isUTC?(w=w.clone(),S=(b(g)||l(g)?g:ai(g)).valueOf()-w.valueOf(),w._d.setTime(w._d.valueOf()+S),r.updateOffset(w,!1),w):ai(g).local()}function qh(g){return-Math.round(g._d.getTimezoneOffset())}function o0(){return!!this.isValid()&&this._isUTC&&this._offset===0}r.updateOffset=function(){};var z1=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,G1=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function yn(g,w){var S,A=g,B=null;return zl(g)?A={ms:g._milliseconds,d:g._days,M:g._months}:h(g)||!isNaN(+g)?(A={},w?A[w]=+g:A.milliseconds=+g):(B=z1.exec(g))?(S=B[1]==="-"?-1:1,A={y:0,d:ue(B[vi])*S,h:ue(B[Xt])*S,m:ue(B[Bi])*S,s:ue(B[qi])*S,ms:ue($h(1e3*B[Ki]))*S}):(B=G1.exec(g))?(S=B[1]==="-"?-1:1,A={y:js(B[2],S),M:js(B[3],S),w:js(B[4],S),d:js(B[5],S),h:js(B[6],S),m:js(B[7],S),s:js(B[8],S)}):A==null?A={}:typeof A=="object"&&("from"in A||"to"in A)&&(w=function(te,ve){var Oe;return!te.isValid()||!ve.isValid()?{milliseconds:0,months:0}:(ve=Xh(ve,te),te.isBefore(ve)?Oe=l0(te,ve):((Oe=l0(ve,te)).milliseconds=-Oe.milliseconds,Oe.months=-Oe.months),Oe)}(ai(A.from),ai(A.to)),(A={}).ms=w.milliseconds,A.M=w.months),B=new Wl(A),zl(g)&&a(g,"_locale")&&(B._locale=g._locale),zl(g)&&a(g,"_isValid")&&(B._isValid=g._isValid),B}function js(g,w){return g=g&&parseFloat(g.replace(",",".")),(isNaN(g)?0:g)*w}function l0(g,w){var S={};return S.months=w.month()-g.month()+12*(w.year()-g.year()),g.clone().add(S.months,"M").isAfter(w)&&--S.months,S.milliseconds=+w-+g.clone().add(S.months,"M"),S}function c0(g,w){return function(S,A){var B;return A===null||isNaN(+A)||(W(w,"moment()."+w+"(period, number) is deprecated. Please use moment()."+w+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),B=S,S=A,A=B),h0(this,yn(S,A),g),this}}function h0(g,ve,S,A){var B=ve._milliseconds,te=$h(ve._days),ve=$h(ve._months);g.isValid()&&(A=A==null||A,ve&&Ge(g,it(g,"Month")+ve*S),te&&et(g,"Date",it(g,"Date")+te*S),B&&g._d.setTime(g._d.valueOf()+B*S),A&&r.updateOffset(g,te||ve))}yn.fn=Wl.prototype,yn.invalid=function(){return yn(NaN)},F=c0(1,"add"),H=c0(-1,"subtract");function u0(g){return typeof g=="string"||g instanceof String}function $1(g){return b(g)||l(g)||u0(g)||h(g)||function(w){var S=n(w),A=!1;return S&&(A=w.filter(function(B){return!h(B)&&u0(w)}).length===0),S&&A}(g)||function(w){var S,A,B=s(w)&&!o(w),te=!1,ve=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],Oe=ve.length;for(S=0;S<Oe;S+=1)A=ve[S],te=te||a(w,A);return B&&te}(g)||g==null}function Gl(g,B){if(g.date()<B.date())return-Gl(B,g);var S=12*(B.year()-g.year())+(B.month()-g.month()),A=g.clone().add(S,"months"),B=B-A<0?(B-A)/(A-g.clone().add(S-1,"months")):(B-A)/(g.clone().add(1+S,"months")-A);return-(S+B)||0}function d0(g){return g===void 0?this._locale._abbr:((g=Hi(g))!=null&&(this._locale=g),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]",se=R("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(g){return g===void 0?this.localeData():this.locale(g)});function f0(){return this._locale}var p0=126227808e5;function Pa(g,w){return(g%w+w)%w}function m0(g,w,S){return g<100&&0<=g?new Date(g+400,w,S)-p0:new Date(g,w,S).valueOf()}function g0(g,w,S){return g<100&&0<=g?Date.UTC(g+400,w,S)-p0:Date.UTC(g,w,S)}function Kh(g,w){return w.erasAbbrRegex(g)}function jh(){for(var g=[],w=[],S=[],A=[],B=this.eras(),te=0,ve=B.length;te<ve;++te)w.push(Nt(B[te].name)),g.push(Nt(B[te].abbr)),S.push(Nt(B[te].narrow)),A.push(Nt(B[te].name)),A.push(Nt(B[te].abbr)),A.push(Nt(B[te].narrow));this._erasRegex=new RegExp("^("+A.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+w.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+g.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+S.join("|")+")","i")}function $l(g,w){Ee(0,[g,g.length],0,w)}function v0(g,w,S,A,B){var te;return g==null?L(this,A,B).year:(te=D(g,A,B),(function(ve,Oe,Xe,Be,pt){return ve=k(ve,Oe,Xe,Be,pt),Oe=je(ve.year,0,ve.dayOfYear),this.year(Oe.getUTCFullYear()),this.month(Oe.getUTCMonth()),this.date(Oe.getUTCDate()),this}).call(this,g,w=te<w?te:w,S,A,B))}Ee("N",0,0,"eraAbbr"),Ee("NN",0,0,"eraAbbr"),Ee("NNN",0,0,"eraAbbr"),Ee("NNNN",0,0,"eraName"),Ee("NNNNN",0,0,"eraNarrow"),Ee("y",["y",1],"yo","eraYear"),Ee("y",["yy",2],0,"eraYear"),Ee("y",["yyy",3],0,"eraYear"),Ee("y",["yyyy",4],0,"eraYear"),He("N",Kh),He("NN",Kh),He("NNN",Kh),He("NNNN",function(g,w){return w.erasNameRegex(g)}),He("NNNNN",function(g,w){return w.erasNarrowRegex(g)}),rt(["N","NN","NNN","NNNN","NNNNN"],function(g,w,S,A){A=S._locale.erasParse(g,A,S._strict),A?p(S).era=A:p(S).invalidEra=g}),He("y",Ri),He("yy",Ri),He("yyy",Ri),He("yyyy",Ri),He("yo",function(g,w){return w._eraYearOrdinalRegex||Ri}),rt(["y","yy","yyy","yyyy"],Wt),rt(["yo"],function(g,w,S,A){var B;S._locale._eraYearOrdinalRegex&&(B=g.match(S._locale._eraYearOrdinalRegex)),S._locale.eraYearOrdinalParse?w[Wt]=S._locale.eraYearOrdinalParse(g,B):w[Wt]=parseInt(g,10)}),Ee(0,["gg",2],0,function(){return this.weekYear()%100}),Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100}),$l("gggg","weekYear"),$l("ggggg","weekYear"),$l("GGGG","isoWeekYear"),$l("GGGGG","isoWeekYear"),q("weekYear","gg"),q("isoWeekYear","GG"),we("weekYear",1),we("isoWeekYear",1),He("G",or),He("g",or),He("GG",Te,ft),He("gg",Te,ft),He("GGGG",Ts,Qs),He("gggg",Ts,Qs),He("GGGGG",Ss,bs),He("ggggg",Ss,bs),fi(["gggg","ggggg","GGGG","GGGGG"],function(g,w,S,A){w[A.substr(0,2)]=ue(g)}),fi(["gg","GG"],function(g,w,S,A){w[A]=r.parseTwoDigitYear(g)}),Ee("Q",0,"Qo","quarter"),q("quarter","Q"),we("quarter",7),He("Q",he),rt("Q",function(g,w){w[Et]=3*(ue(g)-1)}),Ee("D",["DD",2],"Do","date"),q("date","D"),we("date",9),He("D",Te),He("DD",Te,ft),He("Do",function(g,w){return g?w._dayOfMonthOrdinalParse||w._ordinalParse:w._dayOfMonthOrdinalParseLenient}),rt(["D","DD"],vi),rt("Do",function(g,w){w[vi]=ue(g.match(Te)[0])}),Ts=M("Date",!0),Ee("DDD",["DDDD",3],"DDDo","dayOfYear"),q("dayOfYear","DDD"),we("dayOfYear",4),He("DDD",Gt),He("DDDD",Qe),rt(["DDD","DDDD"],function(g,w,S){S._dayOfYear=ue(g)}),Ee("m",["mm",2],0,"minute"),q("minute","m"),we("minute",14),He("m",Te),He("mm",Te,ft),rt(["m","mm"],Bi);var ys,Qs=M("Minutes",!1),Ss=(Ee("s",["ss",2],0,"second"),q("second","s"),we("second",15),He("s",Te),He("ss",Te,ft),rt(["s","ss"],qi),M("Seconds",!1));for(Ee("S",0,0,function(){return~~(this.millisecond()/100)}),Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Ee(0,["SSS",3],0,"millisecond"),Ee(0,["SSSS",4],0,function(){return 10*this.millisecond()}),Ee(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),Ee(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),Ee(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),Ee(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),Ee(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),q("millisecond","ms"),we("millisecond",16),He("S",Gt,he),He("SS",Gt,ft),He("SSS",Gt,Qe),ys="SSSS";ys.length<=9;ys+="S")He(ys,Ri);function Y1(g,w){w[Ki]=ue(1e3*("0."+g))}for(ys="S";ys.length<=9;ys+="S")rt(ys,Y1);bs=M("Milliseconds",!1),Ee("z",0,0,"zoneAbbr"),Ee("zz",0,0,"zoneName"),he=y.prototype;function _0(g){return g}he.add=F,he.calendar=function(S,B){arguments.length===1&&(arguments[0]?$1(arguments[0])?(S=arguments[0],B=void 0):function(te){for(var ve=s(te)&&!o(te),Oe=!1,Xe=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],Be=0;Be<Xe.length;Be+=1)Oe=Oe||a(te,Xe[Be]);return ve&&Oe}(arguments[0])&&(B=arguments[0],S=void 0):B=S=void 0);var S=S||ai(),A=Xh(S,this).startOf("day"),A=r.calendarFormat(this,A)||"sameElse",B=B&&(G(B[A])?B[A].call(this,S):B[A]);return this.format(B||this.localeData().calendar(A,this,ai(S)))},he.clone=function(){return new y(this)},he.diff=function(g,w,S){var A,B,te;if(!this.isValid())return NaN;if(!(A=Xh(g,this)).isValid())return NaN;switch(B=6e4*(A.utcOffset()-this.utcOffset()),w=X(w)){case"year":te=Gl(this,A)/12;break;case"month":te=Gl(this,A);break;case"quarter":te=Gl(this,A)/3;break;case"second":te=(this-A)/1e3;break;case"minute":te=(this-A)/6e4;break;case"hour":te=(this-A)/36e5;break;case"day":te=(this-A-B)/864e5;break;case"week":te=(this-A-B)/6048e5;break;default:te=this-A}return S?te:be(te)},he.endOf=function(g){var w,S;if((g=X(g))===void 0||g==="millisecond"||!this.isValid())return this;switch(S=this._isUTC?g0:m0,g){case"year":w=S(this.year()+1,0,1)-1;break;case"quarter":w=S(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":w=S(this.year(),this.month()+1,1)-1;break;case"week":w=S(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":w=S(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":w=S(this.year(),this.month(),this.date()+1)-1;break;case"hour":w=this._d.valueOf(),w+=36e5-Pa(w+(this._isUTC?0:6e4*this.utcOffset()),36e5)-1;break;case"minute":w=this._d.valueOf(),w+=6e4-Pa(w,6e4)-1;break;case"second":w=this._d.valueOf(),w+=1e3-Pa(w,1e3)-1;break}return this._d.setTime(w),r.updateOffset(this,!0),this},he.format=function(g){return g=g||(this.isUtc()?r.defaultFormatUtc:r.defaultFormat),g=Pe(this,g),this.localeData().postformat(g)},he.from=function(g,w){return this.isValid()&&(b(g)&&g.isValid()||ai(g).isValid())?yn({to:this,from:g}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()},he.fromNow=function(g){return this.from(ai(),g)},he.to=function(g,w){return this.isValid()&&(b(g)&&g.isValid()||ai(g).isValid())?yn({from:this,to:g}).locale(this.locale()).humanize(!w):this.localeData().invalidDate()},he.toNow=function(g){return this.to(ai(),g)},he.get=function(g){return G(this[g=X(g)])?this[g]():this},he.invalidAt=function(){return p(this).overflow},he.isAfter=function(g,w){return g=b(g)?g:ai(g),!(!this.isValid()||!g.isValid())&&((w=X(w)||"millisecond")==="millisecond"?this.valueOf()>g.valueOf():g.valueOf()<this.clone().startOf(w).valueOf())},he.isBefore=function(g,w){return g=b(g)?g:ai(g),!(!this.isValid()||!g.isValid())&&((w=X(w)||"millisecond")==="millisecond"?this.valueOf()<g.valueOf():this.clone().endOf(w).valueOf()<g.valueOf())},he.isBetween=function(g,w,S,A){return g=b(g)?g:ai(g),w=b(w)?w:ai(w),!!(this.isValid()&&g.isValid()&&w.isValid())&&((A=A||"()")[0]==="("?this.isAfter(g,S):!this.isBefore(g,S))&&(A[1]===")"?this.isBefore(w,S):!this.isAfter(w,S))},he.isSame=function(S,w){var S=b(S)?S:ai(S);return!(!this.isValid()||!S.isValid())&&((w=X(w)||"millisecond")==="millisecond"?this.valueOf()===S.valueOf():(S=S.valueOf(),this.clone().startOf(w).valueOf()<=S&&S<=this.clone().endOf(w).valueOf()))},he.isSameOrAfter=function(g,w){return this.isSame(g,w)||this.isAfter(g,w)},he.isSameOrBefore=function(g,w){return this.isSame(g,w)||this.isBefore(g,w)},he.isValid=function(){return m(this)},he.lang=se,he.locale=d0,he.localeData=f0,he.max=wt,he.min=dt,he.parsingFlags=function(){return d({},p(this))},he.set=function(g,w){if(typeof g=="object")for(var S=function(te){var ve,Oe=[];for(ve in te)a(te,ve)&&Oe.push({unit:ve,priority:Ie[ve]});return Oe.sort(function(Xe,Be){return Xe.priority-Be.priority}),Oe}(g=de(g)),A=S.length,B=0;B<A;B++)this[S[B].unit](g[S[B].unit]);else if(G(this[g=X(g)]))return this[g](w);return this},he.startOf=function(g){var w,S;if((g=X(g))===void 0||g==="millisecond"||!this.isValid())return this;switch(S=this._isUTC?g0:m0,g){case"year":w=S(this.year(),0,1);break;case"quarter":w=S(this.year(),this.month()-this.month()%3,1);break;case"month":w=S(this.year(),this.month(),1);break;case"week":w=S(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":w=S(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":w=S(this.year(),this.month(),this.date());break;case"hour":w=this._d.valueOf(),w-=Pa(w+(this._isUTC?0:6e4*this.utcOffset()),36e5);break;case"minute":w=this._d.valueOf(),w-=Pa(w,6e4);break;case"second":w=this._d.valueOf(),w-=Pa(w,1e3);break}return this._d.setTime(w),r.updateOffset(this,!0),this},he.subtract=H,he.toArray=function(){var g=this;return[g.year(),g.month(),g.date(),g.hour(),g.minute(),g.second(),g.millisecond()]},he.toObject=function(){var g=this;return{years:g.year(),months:g.month(),date:g.date(),hours:g.hours(),minutes:g.minutes(),seconds:g.seconds(),milliseconds:g.milliseconds()}},he.toDate=function(){return new Date(this.valueOf())},he.toISOString=function(g){if(!this.isValid())return null;var w=(g=g!==!0)?this.clone().utc():this;return w.year()<0||9999<w.year()?Pe(w,g?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):G(Date.prototype.toISOString)?g?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",Pe(w,"Z")):Pe(w,g?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},he.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var g,w="moment",S="";return this.isLocal()||(w=this.utcOffset()===0?"moment.utc":"moment.parseZone",S="Z"),w="["+w+'("]',g=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",this.format(w+g+"-MM-DD[T]HH:mm:ss.SSS"+(S+'[")]'))},typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),he.toJSON=function(){return this.isValid()?this.toISOString():null},he.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},he.unix=function(){return Math.floor(this.valueOf()/1e3)},he.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},he.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},he.eraName=function(){for(var g,w=this.localeData().eras(),S=0,A=w.length;S<A;++S)if(g=this.clone().startOf("day").valueOf(),w[S].since<=g&&g<=w[S].until||w[S].until<=g&&g<=w[S].since)return w[S].name;return""},he.eraNarrow=function(){for(var g,w=this.localeData().eras(),S=0,A=w.length;S<A;++S)if(g=this.clone().startOf("day").valueOf(),w[S].since<=g&&g<=w[S].until||w[S].until<=g&&g<=w[S].since)return w[S].narrow;return""},he.eraAbbr=function(){for(var g,w=this.localeData().eras(),S=0,A=w.length;S<A;++S)if(g=this.clone().startOf("day").valueOf(),w[S].since<=g&&g<=w[S].until||w[S].until<=g&&g<=w[S].since)return w[S].abbr;return""},he.eraYear=function(){for(var g,w,S=this.localeData().eras(),A=0,B=S.length;A<B;++A)if(g=S[A].since<=S[A].until?1:-1,w=this.clone().startOf("day").valueOf(),S[A].since<=w&&w<=S[A].until||S[A].until<=w&&w<=S[A].since)return(this.year()-r(S[A].since).year())*g+S[A].offset;return this.year()},he.year=Xl,he.isLeapYear=function(){return Re(this.year())},he.weekYear=function(g){return v0.call(this,g,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},he.isoWeekYear=function(g){return v0.call(this,g,this.isoWeek(),this.isoWeekday(),1,4)},he.quarter=he.quarters=function(g){return g==null?Math.ceil((this.month()+1)/3):this.month(3*(g-1)+this.month()%3)},he.month=lt,he.daysInMonth=function(){return ir(this.year(),this.month())},he.week=he.weeks=function(g){var w=this.localeData().week(this);return g==null?w:this.add(7*(g-w),"d")},he.isoWeek=he.isoWeeks=function(g){var w=L(this,1,4).week;return g==null?w:this.add(7*(g-w),"d")},he.weeksInYear=function(){var g=this.localeData()._week;return D(this.year(),g.dow,g.doy)},he.weeksInWeekYear=function(){var g=this.localeData()._week;return D(this.weekYear(),g.dow,g.doy)},he.isoWeeksInYear=function(){return D(this.year(),1,4)},he.isoWeeksInISOWeekYear=function(){return D(this.isoWeekYear(),1,4)},he.date=Ts,he.day=he.days=function(g){if(!this.isValid())return g!=null?this:NaN;var w,S,A=this._isUTC?this._d.getUTCDay():this._d.getDay();return g!=null?(w=g,S=this.localeData(),g=typeof w!="string"?w:isNaN(w)?typeof(w=S.weekdaysParse(w))=="number"?w:null:parseInt(w,10),this.add(g-A,"d")):A},he.weekday=function(g){if(!this.isValid())return g!=null?this:NaN;var w=(this.day()+7-this.localeData()._week.dow)%7;return g==null?w:this.add(g-w,"d")},he.isoWeekday=function(g){return this.isValid()?g!=null?(w=g,S=this.localeData(),S=typeof w=="string"?S.weekdaysParse(w)%7||7:isNaN(w)?null:w,this.day(this.day()%7?S:S-7)):this.day()||7:g!=null?this:NaN;var w,S},he.dayOfYear=function(g){var w=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return g==null?w:this.add(g-w,"d")},he.hour=he.hours=$t,he.minute=he.minutes=Qs,he.second=he.seconds=Ss,he.millisecond=he.milliseconds=bs,he.utcOffset=function(g,w,S){var A,B=this._offset||0;if(!this.isValid())return g!=null?this:NaN;if(g==null)return this._isUTC?B:qh(this);if(typeof g=="string"){if((g=Yh(ni,g))===null)return this}else Math.abs(g)<16&&!S&&(g*=60);return!this._isUTC&&w&&(A=qh(this)),this._offset=g,this._isUTC=!0,A!=null&&this.add(A,"m"),B!==g&&(!w||this._changeInProgress?h0(this,yn(g-B,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this},he.utc=function(g){return this.utcOffset(0,g)},he.local=function(g){return this._isUTC&&(this.utcOffset(0,g),this._isUTC=!1,g&&this.subtract(qh(this),"m")),this},he.parseZone=function(){var g;return this._tzm!=null?this.utcOffset(this._tzm,!1,!0):typeof this._i=="string"&&((g=Yh(lr,this._i))!=null?this.utcOffset(g):this.utcOffset(0,!0)),this},he.hasAlignedHourOffset=function(g){return!!this.isValid()&&(g=g?ai(g).utcOffset():0,(this.utcOffset()-g)%60==0)},he.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},he.isLocal=function(){return!!this.isValid()&&!this._isUTC},he.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},he.isUtc=o0,he.isUTC=o0,he.zoneAbbr=function(){return this._isUTC?"UTC":""},he.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},he.dates=R("dates accessor is deprecated. Use date instead.",Ts),he.months=R("months accessor is deprecated. Use month instead",lt),he.years=R("years accessor is deprecated. Use year instead",Xl),he.zone=R("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(g,w){return g!=null?(this.utcOffset(g=typeof g!="string"?-g:g,w),this):-this.utcOffset()}),he.isDSTShifted=R("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!c(this._isDSTShifted))return this._isDSTShifted;var g,w={};return C(w,this),(w=r0(w))._a?(g=(w._isUTC?f:ai)(w._a),this._isDSTShifted=this.isValid()&&0<function(S,A,B){for(var te=Math.min(S.length,A.length),ve=Math.abs(S.length-A.length),Oe=0,Xe=0;Xe<te;Xe++)ue(S[Xe])!==ue(A[Xe])&&Oe++;return Oe+ve}(w._a,g.toArray())):this._isDSTShifted=!1,this._isDSTShifted}),ft=ne.prototype;function Yl(g,w,S,te){var B=Hi(),te=f().set(te,w);return B[S](te,g)}function E0(g,w,S){if(h(g)&&(w=g,g=void 0),g=g||"",w!=null)return Yl(g,w,S,"month");for(var A=[],B=0;B<12;B++)A[B]=Yl(g,B,S,"month");return A}function Qh(g,w,S,A){w=(typeof g=="boolean"?h(w)&&(S=w,w=void 0):(w=g,g=!1,h(S=w)&&(S=w,w=void 0)),w||"");var B,te=Hi(),ve=g?te._week.dow:0,Oe=[];if(S!=null)return Yl(w,(S+ve)%7,A,"day");for(B=0;B<7;B++)Oe[B]=Yl(w,(B+ve)%7,A,"day");return Oe}ft.calendar=function(g,w,S){return G(g=this._calendar[g]||this._calendar.sameElse)?g.call(w,S):g},ft.longDateFormat=function(g){var w=this._longDateFormat[g],S=this._longDateFormat[g.toUpperCase()];return w||!S?w:(this._longDateFormat[g]=S.match(Fe).map(function(A){return A==="MMMM"||A==="MM"||A==="DD"||A==="dddd"?A.slice(1):A}).join(""),this._longDateFormat[g])},ft.invalidDate=function(){return this._invalidDate},ft.ordinal=function(g){return this._ordinal.replace("%d",g)},ft.preparse=_0,ft.postformat=_0,ft.relativeTime=function(g,w,S,A){var B=this._relativeTime[S];return G(B)?B(g,w,S,A):B.replace(/%d/i,g)},ft.pastFuture=function(g,w){return G(g=this._relativeTime[0<g?"future":"past"])?g(w):g.replace(/%s/i,w)},ft.set=function(g){var w,S;for(S in g)a(g,S)&&(G(w=g[S])?this[S]=w:this["_"+S]=w);this._config=g,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},ft.eras=function(g,w){for(var S,A=this._eras||Hi("en")._eras,B=0,te=A.length;B<te;++B){switch(typeof A[B].since){case"string":S=r(A[B].since).startOf("day"),A[B].since=S.valueOf();break}switch(typeof A[B].until){case"undefined":A[B].until=1/0;break;case"string":S=r(A[B].until).startOf("day").valueOf(),A[B].until=S.valueOf();break}}return A},ft.erasParse=function(g,w,S){var A,B,te,ve,Oe,Xe=this.eras();for(g=g.toUpperCase(),A=0,B=Xe.length;A<B;++A)if(te=Xe[A].name.toUpperCase(),ve=Xe[A].abbr.toUpperCase(),Oe=Xe[A].narrow.toUpperCase(),S)switch(w){case"N":case"NN":case"NNN":if(ve===g)return Xe[A];break;case"NNNN":if(te===g)return Xe[A];break;case"NNNNN":if(Oe===g)return Xe[A];break}else if(0<=[te,ve,Oe].indexOf(g))return Xe[A]},ft.erasConvertYear=function(g,w){var S=g.since<=g.until?1:-1;return w===void 0?r(g.since).year():r(g.since).year()+(w-g.offset)*S},ft.erasAbbrRegex=function(g){return a(this,"_erasAbbrRegex")||jh.call(this),g?this._erasAbbrRegex:this._erasRegex},ft.erasNameRegex=function(g){return a(this,"_erasNameRegex")||jh.call(this),g?this._erasNameRegex:this._erasRegex},ft.erasNarrowRegex=function(g){return a(this,"_erasNarrowRegex")||jh.call(this),g?this._erasNarrowRegex:this._erasRegex},ft.months=function(g,w){return g?(n(this._months)?this._months:this._months[(this._months.isFormat||ee).test(w)?"format":"standalone"])[g.month()]:n(this._months)?this._months:this._months.standalone},ft.monthsShort=function(g,w){return g?(n(this._monthsShort)?this._monthsShort:this._monthsShort[ee.test(w)?"format":"standalone"])[g.month()]:n(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},ft.monthsParse=function(g,w,S){var A,B;if(this._monthsParseExact)return(function(at,ve,Oe){var Xe,Be,pt,at=at.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],Xe=0;Xe<12;++Xe)pt=f([2e3,Xe]),this._shortMonthsParse[Xe]=this.monthsShort(pt,"").toLocaleLowerCase(),this._longMonthsParse[Xe]=this.months(pt,"").toLocaleLowerCase();return Oe?ve==="MMM"?(Be=_t.call(this._shortMonthsParse,at))!==-1?Be:null:(Be=_t.call(this._longMonthsParse,at))!==-1?Be:null:ve==="MMM"?(Be=_t.call(this._shortMonthsParse,at))!==-1||(Be=_t.call(this._longMonthsParse,at))!==-1?Be:null:(Be=_t.call(this._longMonthsParse,at))!==-1||(Be=_t.call(this._shortMonthsParse,at))!==-1?Be:null}).call(this,g,w,S);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),A=0;A<12;A++)if(B=f([2e3,A]),S&&!this._longMonthsParse[A]&&(this._longMonthsParse[A]=new RegExp("^"+this.months(B,"").replace(".","")+"$","i"),this._shortMonthsParse[A]=new RegExp("^"+this.monthsShort(B,"").replace(".","")+"$","i")),S||this._monthsParse[A]||(B="^"+this.months(B,"")+"|^"+this.monthsShort(B,""),this._monthsParse[A]=new RegExp(B.replace(".",""),"i")),S&&w==="MMMM"&&this._longMonthsParse[A].test(g)||S&&w==="MMM"&&this._shortMonthsParse[A].test(g)||!S&&this._monthsParse[A].test(g))return A},ft.monthsRegex=function(g){return this._monthsParseExact?(a(this,"_monthsRegex")||qe.call(this),g?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=Me),this._monthsStrictRegex&&g?this._monthsStrictRegex:this._monthsRegex)},ft.monthsShortRegex=function(g){return this._monthsParseExact?(a(this,"_monthsRegex")||qe.call(this),g?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=fe),this._monthsShortStrictRegex&&g?this._monthsShortStrictRegex:this._monthsShortRegex)},ft.week=function(g){return L(g,this._week.dow,this._week.doy).week},ft.firstDayOfYear=function(){return this._week.doy},ft.firstDayOfWeek=function(){return this._week.dow},ft.weekdays=function(g,w){return w=n(this._weekdays)?this._weekdays:this._weekdays[g&&g!==!0&&this._weekdays.isFormat.test(w)?"format":"standalone"],g===!0?N(w,this._week.dow):g?w[g.day()]:w},ft.weekdaysMin=function(g){return g===!0?N(this._weekdaysMin,this._week.dow):g?this._weekdaysMin[g.day()]:this._weekdaysMin},ft.weekdaysShort=function(g){return g===!0?N(this._weekdaysShort,this._week.dow):g?this._weekdaysShort[g.day()]:this._weekdaysShort},ft.weekdaysParse=function(g,w,S){var A,B;if(this._weekdaysParseExact)return(function(at,ve,Oe){var Xe,Be,pt,at=at.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],Xe=0;Xe<7;++Xe)pt=f([2e3,1]).day(Xe),this._minWeekdaysParse[Xe]=this.weekdaysMin(pt,"").toLocaleLowerCase(),this._shortWeekdaysParse[Xe]=this.weekdaysShort(pt,"").toLocaleLowerCase(),this._weekdaysParse[Xe]=this.weekdays(pt,"").toLocaleLowerCase();return Oe?ve==="dddd"?(Be=_t.call(this._weekdaysParse,at))!==-1?Be:null:ve==="ddd"?(Be=_t.call(this._shortWeekdaysParse,at))!==-1?Be:null:(Be=_t.call(this._minWeekdaysParse,at))!==-1?Be:null:ve==="dddd"?(Be=_t.call(this._weekdaysParse,at))!==-1||(Be=_t.call(this._shortWeekdaysParse,at))!==-1||(Be=_t.call(this._minWeekdaysParse,at))!==-1?Be:null:ve==="ddd"?(Be=_t.call(this._shortWeekdaysParse,at))!==-1||(Be=_t.call(this._weekdaysParse,at))!==-1||(Be=_t.call(this._minWeekdaysParse,at))!==-1?Be:null:(Be=_t.call(this._minWeekdaysParse,at))!==-1||(Be=_t.call(this._weekdaysParse,at))!==-1||(Be=_t.call(this._shortWeekdaysParse,at))!==-1?Be:null}).call(this,g,w,S);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),A=0;A<7;A++)if(B=f([2e3,1]).day(A),S&&!this._fullWeekdaysParse[A]&&(this._fullWeekdaysParse[A]=new RegExp("^"+this.weekdays(B,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[A]=new RegExp("^"+this.weekdaysShort(B,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[A]=new RegExp("^"+this.weekdaysMin(B,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[A]||(B="^"+this.weekdays(B,"")+"|^"+this.weekdaysShort(B,"")+"|^"+this.weekdaysMin(B,""),this._weekdaysParse[A]=new RegExp(B.replace(".",""),"i")),S&&w==="dddd"&&this._fullWeekdaysParse[A].test(g)||S&&w==="ddd"&&this._shortWeekdaysParse[A].test(g)||S&&w==="dd"&&this._minWeekdaysParse[A].test(g)||!S&&this._weekdaysParse[A].test(g))return A},ft.weekdaysRegex=function(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||J.call(this),g?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=ge),this._weekdaysStrictRegex&&g?this._weekdaysStrictRegex:this._weekdaysRegex)},ft.weekdaysShortRegex=function(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||J.call(this),g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ae),this._weekdaysShortStrictRegex&&g?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},ft.weekdaysMinRegex=function(g){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||J.call(this),g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ce),this._weekdaysMinStrictRegex&&g?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},ft.isPM=function(g){return(g+"").toLowerCase().charAt(0)==="p"},ft.meridiem=function(g,w,S){return 11<g?S?"pm":"PM":S?"am":"AM"},Vt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(g){var w=g%10;return g+(ue(g%100/10)===1?"th":w==1?"st":w==2?"nd":w==3?"rd":"th")}}),r.lang=R("moment.lang is deprecated. Use moment.locale instead.",Vt),r.langData=R("moment.langData is deprecated. Use moment.localeData instead.",Hi);var Zn=Math.abs;function x0(g,w,S,A){return w=yn(w,S),g._milliseconds+=A*w._milliseconds,g._days+=A*w._days,g._months+=A*w._months,g._bubble()}function w0(g){return g<0?Math.floor(g):Math.ceil(g)}function C0(g){return 4800*g/146097}function Zh(g){return 146097*g/4800}function Jn(g){return function(){return this.as(g)}}Gt=Jn("ms"),Qe=Jn("s"),F=Jn("m"),wt=Jn("h"),dt=Jn("d"),H=Jn("w"),$t=Jn("M"),Qs=Jn("Q"),Ss=Jn("y");function Zs(g){return function(){return this.isValid()?this._data[g]:NaN}}var bs=Zs("milliseconds"),Ts=Zs("seconds"),Xl=Zs("minutes"),ft=Zs("hours"),X1=Zs("days"),q1=Zs("months"),K1=Zs("years"),es=Math.round,Na={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function j1(g,w,S,A){var Be=yn(g).abs(),pt=es(Be.as("s")),B=es(Be.as("m")),te=es(Be.as("h")),ve=es(Be.as("d")),Oe=es(Be.as("M")),Xe=es(Be.as("w")),Be=es(Be.as("y")),pt=(pt<=S.ss?["s",pt]:pt<S.s&&["ss",pt])||B<=1&&["m"]||B<S.m&&["mm",B]||te<=1&&["h"]||te<S.h&&["hh",te]||ve<=1&&["d"]||ve<S.d&&["dd",ve];return(pt=(pt=S.w!=null?pt||Xe<=1&&["w"]||Xe<S.w&&["ww",Xe]:pt)||Oe<=1&&["M"]||Oe<S.M&&["MM",Oe]||Be<=1&&["y"]||["yy",Be])[2]=w,pt[3]=0<+g,pt[4]=A,(function(at,_i,Vi,Sn,eu){return eu.relativeTime(_i||1,!!Vi,at,Sn)}).apply(null,pt)}var Jh=Math.abs;function Ma(g){return(0<g)-(g<0)||+g}function ql(){if(!this.isValid())return this.localeData().invalidDate();var g,w,S,A,B,te,ve,Oe=Jh(this._milliseconds)/1e3,Xe=Jh(this._days),Be=Jh(this._months),pt=this.asSeconds();return pt?(g=be(Oe/60),w=be(g/60),Oe%=60,g%=60,S=be(Be/12),Be%=12,A=Oe?Oe.toFixed(3).replace(/\.?0+$/,""):"",B=Ma(this._months)!==Ma(pt)?"-":"",te=Ma(this._days)!==Ma(pt)?"-":"",ve=Ma(this._milliseconds)!==Ma(pt)?"-":"",(pt<0?"-":"")+"P"+(S?B+S+"Y":"")+(Be?B+Be+"M":"")+(Xe?te+Xe+"D":"")+(w||g||Oe?"T":"")+(w?ve+w+"H":"")+(g?ve+g+"M":"")+(Oe?ve+A+"S":"")):"P0D"}var Lt=Wl.prototype;return Lt.isValid=function(){return this._isValid},Lt.abs=function(){var g=this._data;return this._milliseconds=Zn(this._milliseconds),this._days=Zn(this._days),this._months=Zn(this._months),g.milliseconds=Zn(g.milliseconds),g.seconds=Zn(g.seconds),g.minutes=Zn(g.minutes),g.hours=Zn(g.hours),g.months=Zn(g.months),g.years=Zn(g.years),this},Lt.add=function(g,w){return x0(this,g,w,1)},Lt.subtract=function(g,w){return x0(this,g,w,-1)},Lt.as=function(g){if(!this.isValid())return NaN;var w,S,A=this._milliseconds;if((g=X(g))==="month"||g==="quarter"||g==="year")switch(w=this._days+A/864e5,S=this._months+C0(w),g){case"month":return S;case"quarter":return S/3;case"year":return S/12}else switch(w=this._days+Math.round(Zh(this._months)),g){case"week":return w/7+A/6048e5;case"day":return w+A/864e5;case"hour":return 24*w+A/36e5;case"minute":return 1440*w+A/6e4;case"second":return 86400*w+A/1e3;case"millisecond":return Math.floor(864e5*w)+A;default:throw new Error("Unknown unit "+g)}},Lt.asMilliseconds=Gt,Lt.asSeconds=Qe,Lt.asMinutes=F,Lt.asHours=wt,Lt.asDays=dt,Lt.asWeeks=H,Lt.asMonths=$t,Lt.asQuarters=Qs,Lt.asYears=Ss,Lt.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ue(this._months/12):NaN},Lt._bubble=function(){var g=this._milliseconds,w=this._days,S=this._months,A=this._data;return 0<=g&&0<=w&&0<=S||g<=0&&w<=0&&S<=0||(g+=864e5*w0(Zh(S)+w),S=w=0),A.milliseconds=g%1e3,g=be(g/1e3),A.seconds=g%60,g=be(g/60),A.minutes=g%60,g=be(g/60),A.hours=g%24,w+=be(g/24),S+=g=be(C0(w)),w-=w0(Zh(g)),g=be(S/12),S%=12,A.days=w,A.months=S,A.years=g,this},Lt.clone=function(){return yn(this)},Lt.get=function(g){return g=X(g),this.isValid()?this[g+"s"]():NaN},Lt.milliseconds=bs,Lt.seconds=Ts,Lt.minutes=Xl,Lt.hours=ft,Lt.days=X1,Lt.weeks=function(){return be(this.days()/7)},Lt.months=q1,Lt.years=K1,Lt.humanize=function(g,w){if(!this.isValid())return this.localeData().invalidDate();var S=!1,A=Na;return typeof g=="object"&&(w=g,g=!1),typeof g=="boolean"&&(S=g),typeof w=="object"&&(A=Object.assign({},Na,w),w.s!=null&&w.ss==null&&(A.ss=w.s-1)),g=this.localeData(),w=j1(this,!S,A,g),S&&(w=g.pastFuture(+this,w)),g.postformat(w)},Lt.toISOString=ql,Lt.toString=ql,Lt.toJSON=ql,Lt.locale=d0,Lt.localeData=f0,Lt.toIsoString=R("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ql),Lt.lang=se,Ee("X",0,0,"unix"),Ee("x",0,0,"valueOf"),He("x",or),He("X",/[+-]?\d+(\.\d{1,3})?/),rt("X",function(g,w,S){S._d=new Date(1e3*parseFloat(g))}),rt("x",function(g,w,S){S._d=new Date(ue(g))}),r.version="2.29.4",t=ai,r.fn=he,r.min=function(){return s0("isBefore",[].slice.call(arguments,0))},r.max=function(){return s0("isAfter",[].slice.call(arguments,0))},r.now=function(){return Date.now?Date.now():+new Date},r.utc=f,r.unix=function(g){return ai(1e3*g)},r.months=function(g,w){return E0(g,w,"months")},r.isDate=l,r.locale=Vt,r.invalid=v,r.duration=yn,r.isMoment=b,r.weekdays=function(g,w,S){return Qh(g,w,S,"weekdays")},r.parseZone=function(){return ai.apply(null,arguments).parseZone()},r.localeData=Hi,r.isDuration=zl,r.monthsShort=function(g,w){return E0(g,w,"monthsShort")},r.weekdaysMin=function(g,w,S){return Qh(g,w,S,"weekdaysMin")},r.defineLocale=an,r.updateLocale=function(g,w){var S,A;return w!=null?(A=Ne,Le[g]!=null&&Le[g].parentLocale!=null?Le[g].set(Q(Le[g]._config,w)):(w=Q(A=(S=Dr(g))!=null?S._config:A,w),S==null&&(w.abbr=g),(A=new ne(w)).parentLocale=Le[g],Le[g]=A),Vt(g)):Le[g]!=null&&(Le[g].parentLocale!=null?(Le[g]=Le[g].parentLocale,g===Vt()&&Vt(g)):Le[g]!=null&&delete Le[g]),Le[g]},r.locales=function(){return xe(Le)},r.weekdaysShort=function(g,w,S){return Qh(g,w,S,"weekdaysShort")},r.normalizeUnits=X,r.relativeTimeRounding=function(g){return g===void 0?es:typeof g=="function"&&(es=g,!0)},r.relativeTimeThreshold=function(g,w){return Na[g]!==void 0&&(w===void 0?Na[g]:(Na[g]=w,g==="s"&&(Na.ss=w-1),!0))},r.calendarFormat=function(g,w){return(g=g.diff(w,"days",!0))<-6?"sameElse":g<-1?"lastWeek":g<0?"lastDay":g<1?"sameDay":g<2?"nextDay":g<7?"nextWeek":"sameElse"},r.prototype=he,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r})})(Fm);var Pm=Fm.exports;const Wr=Rd(Pm),uh=J1({__proto__:null,default:Wr},[Pm]);class ye{}ye.locales={TEXT_ALL_SELECTED:"All Selected",TEXT_ALL_X_RECORDS_SELECTED:"All {{x}} records selected",TEXT_APPLY_MASS_UPDATE:"Apply Mass Update",TEXT_APPLY_TO_SELECTION:"Update Selection",TEXT_CANCEL:"Cancel",TEXT_CLEAR_ALL_FILTERS:"Clear all Filters",TEXT_CLEAR_ALL_GROUPING:"Clear all Grouping",TEXT_CLEAR_ALL_SORTING:"Clear all Sorting",TEXT_CLEAR_PINNING:"Unfreeze Columns/Rows",TEXT_CLONE:"Clone",TEXT_COLLAPSE_ALL_GROUPS:"Collapse all Groups",TEXT_CONTAINS:"Contains",TEXT_COLUMNS:"Columns",TEXT_COLUMN_RESIZE_BY_CONTENT:"Resize by Content",TEXT_COMMANDS:"Commands",TEXT_COPY:"Copy",TEXT_DROP_COLUMN_HEADER_TO_GROUP_BY:"Drop a column header here to group by the column",TEXT_EQUALS:"Equals",TEXT_EQUAL_TO:"Equal to",TEXT_ENDS_WITH:"Ends With",TEXT_ERROR_EDITABLE_GRID_REQUIRED:"Your grid must be editable in order to use the Composite Editor Modal.",TEXT_ERROR_ENABLE_CELL_NAVIGATION_REQUIRED:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.',TEXT_ERROR_NO_CHANGES_DETECTED:"Sorry we could not detect any changes.",TEXT_ERROR_NO_EDITOR_FOUND:"We could not find any Editor in your Column Definition.",TEXT_ERROR_NO_RECORD_FOUND:"No records selected for edit or clone operation.",TEXT_ERROR_ROW_NOT_EDITABLE:"Current row is not editable.",TEXT_ERROR_ROW_SELECTION_REQUIRED:"You must select some rows before trying to apply new value(s).",TEXT_EXPAND_ALL_GROUPS:"Expand all Groups",TEXT_EXPORT_TO_CSV:"Export in CSV format",TEXT_EXPORT_TO_TEXT_FORMAT:"Export in Text format (Tab delimited)",TEXT_EXPORT_TO_EXCEL:"Export to Excel",TEXT_EXPORT_TO_TAB_DELIMITED:"Export in Text format (Tab delimited)",TEXT_FORCE_FIT_COLUMNS:"Force fit columns",TEXT_FREEZE_COLUMNS:"Freeze Columns",TEXT_GREATER_THAN:"Greater than",TEXT_GREATER_THAN_OR_EQUAL_TO:"Greater than or equal to",TEXT_GROUP_BY:"Group By",TEXT_HIDE_COLUMN:"Hide Column",TEXT_ITEMS:"items",TEXT_ITEMS_PER_PAGE:"items per page",TEXT_ITEMS_SELECTED:"items selected",TEXT_OF:"of",TEXT_OK:"OK",TEXT_LAST_UPDATE:"Last Update",TEXT_LESS_THAN:"Less than",TEXT_LESS_THAN_OR_EQUAL_TO:"Less than or equal to",TEXT_NOT_CONTAINS:"Not contains",TEXT_NOT_EQUAL_TO:"Not equal to",TEXT_PAGE:"Page",TEXT_RECORDS_SELECTED:"records selected",TEXT_REFRESH_DATASET:"Refresh Dataset",TEXT_REMOVE_FILTER:"Remove Filter",TEXT_REMOVE_SORT:"Remove Sort",TEXT_RESET_INPUT_VALUE:"Reset Input Value",TEXT_RESET_FORM:"Reset Form",TEXT_SAVE:"Save",TEXT_SELECT_ALL:"Select All",TEXT_SYNCHRONOUS_RESIZE:"Synchronous resize",TEXT_SORT_ASCENDING:"Sort Ascending",TEXT_SORT_DESCENDING:"Sort Descending",TEXT_STARTS_WITH:"Starts With",TEXT_TOGGLE_ALL_GROUPS:"Toggle all Groups",TEXT_TOGGLE_FILTER_ROW:"Toggle Filter Row",TEXT_TOGGLE_PRE_HEADER_ROW:"Toggle Pre-Header Row",TEXT_UNFREEZE_COLUMNS:"Unfreeze Columns",TEXT_X_OF_Y_SELECTED:"# of % selected",TEXT_X_OF_Y_MASS_SELECTED:"{{x}} of {{y}} selected"};ye.treeDataProperties={CHILDREN_PROP:"children",COLLAPSED_PROP:"__collapsed",HAS_CHILDREN_PROP:"__hasChildren",TREE_LEVEL_PROP:"__treeLevel",PARENT_PROP:"__parentId"};ye.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL=2;ye.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL=2;ye.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL=2;ye.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL=4;ye.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL=void 0;ye.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL=void 0;ye.DEFAULT_NUMBER_DECIMAL_SEPARATOR=".";ye.DEFAULT_NUMBER_THOUSAND_SEPARATOR="";ye.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET=!1;ye.SLIDER_DEFAULT_MIN_VALUE=0;ye.SLIDER_DEFAULT_MAX_VALUE=100;ye.SLIDER_DEFAULT_STEP=1;ye.VALIDATION_REQUIRED_FIELD="Field is required";ye.VALIDATION_EDITOR_VALID_NUMBER="Please enter a valid number";ye.VALIDATION_EDITOR_VALID_INTEGER="Please enter a valid integer number";ye.VALIDATION_EDITOR_INTEGER_BETWEEN="Please enter a valid integer number between {{minValue}} and {{maxValue}}";ye.VALIDATION_EDITOR_INTEGER_MAX="Please enter a valid integer number that is lower than {{maxValue}}";ye.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE="Please enter a valid integer number that is lower than or equal to {{maxValue}}";ye.VALIDATION_EDITOR_INTEGER_MIN="Please enter a valid integer number that is greater than {{minValue}}";ye.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE="Please enter a valid integer number that is greater than or equal to {{minValue}}";ye.VALIDATION_EDITOR_NUMBER_BETWEEN="Please enter a valid number between {{minValue}} and {{maxValue}}";ye.VALIDATION_EDITOR_NUMBER_MAX="Please enter a valid number that is lower than {{maxValue}}";ye.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE="Please enter a valid number that is lower than or equal to {{maxValue}}";ye.VALIDATION_EDITOR_NUMBER_MIN="Please enter a valid number that is greater than {{minValue}}";ye.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE="Please enter a valid number that is greater than or equal to {{minValue}}";ye.VALIDATION_EDITOR_DECIMAL_BETWEEN="Please enter a valid number with a maximum of {{maxDecimal}} decimals";ye.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN="Please make sure your text length is between {{minLength}} and {{maxLength}} characters";ye.VALIDATION_EDITOR_TEXT_MAX_LENGTH="Please make sure your text is less than {{maxLength}} characters";ye.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE="Please make sure your text is less than or equal to {{maxLength}} characters";ye.VALIDATION_EDITOR_TEXT_MIN_LENGTH="Please make sure your text is more than {{minLength}} character(s)";ye.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE="Please make sure your text is at least {{minLength}} character(s)";var Qu;(function(i){i[i.camelCase=0]="camelCase",i[i.pascalCase=1]="pascalCase",i[i.snakeCase=2]="snakeCase",i[i.kebabCase=3]="kebabCase"})(Qu||(Qu={}));var Ms;(function(i){i.colon=":",i.comma=",",i.equalSign="=",i.pipe="|",i.semicolon=";",i.space=" ",i.tab="	",i.doubleColon="::",i.doublePipe="||",i.doubleSemicolon=";;"})(Ms||(Ms={}));var xt;(function(i){i.autoTooltip="autoTooltip",i.cellExternalCopyManager="cellExternalCopyManager",i.cellMenu="cellMenu",i.checkboxSelector="checkboxSelector",i.columnPicker="columnPicker",i.contextMenu="contextMenu",i.customTooltip="customTooltip",i.draggableGrouping="draggableGrouping",i.groupItemMetaProvider="groupItemMetaProvider",i.gridMenu="gridMenu",i.headerButton="headerButton",i.headerMenu="headerMenu",i.rowBasedEdit="rowBasedEdit",i.rowDetailView="rowDetailView",i.rowMoveManager="rowMoveManager",i.rowSelection="rowSelection"})(xt||(xt={}));const Y={unknown:"unknown",string:"string",boolean:"boolean",integer:"integer",float:"float",number:"number",date:"date",dateIso:"dateIso",dateUtc:"dateUtc",dateTime:"dateTime",dateTimeIso:"dateTimeIso",dateTimeIsoAmPm:"dateTimeIsoAmPm",dateTimeIsoAM_PM:"dateTimeIsoAM_PM",dateTimeShortIso:"dateTimeShortIso",dateEuro:"dateEuro",dateEuroShort:"dateEuroShort",dateTimeShortEuro:"dateTimeShortEuro",dateTimeEuro:"dateTimeEuro",dateTimeEuroAmPm:"dateTimeEuroAmPm",dateTimeEuroAM_PM:"dateTimeEuroAM_PM",dateTimeEuroShort:"dateTimeEuroShort",dateTimeEuroShortAmPm:"dateTimeEuroShortAmPm",dateTimeEuroShortAM_PM:"dateTimeEuroShortAM_PM",dateUs:"dateUs",dateUsShort:"dateUsShort",dateTimeShortUs:"dateTimeShortUs",dateTimeUs:"dateTimeUs",dateTimeUsAmPm:"dateTimeUsAmPm",dateTimeUsAM_PM:"dateTimeUsAM_PM",dateTimeUsShort:"dateTimeUsShort",dateTimeUsShortAmPm:"dateTimeUsShortAmPm",dateTimeUsShortAM_PM:"dateTimeUsShortAM_PM",object:"object",password:"password",text:"text",readonly:"readonly"};var ps;(function(i){i.csv="csv",i.txt="txt",i.xls="xls",i.xlsx="xlsx"})(ps||(ps={}));var Xa;(function(i){i.merge="merge",i.chain="chain"})(Xa||(Xa={}));var ur;(function(i){i.columns="columns",i.filter="filter",i.pagination="pagination",i.pinning="pinning",i.rowSelection="rowSelection",i.sorter="sorter",i.treeData="treeData"})(ur||(ur={}));var tt;(function(i){i.empty="",i.contains="Contains",i.notContains="Not_Contains",i.lessThan="LT",i.lessThanOrEqual="LE",i.greaterThan="GT",i.greaterThanOrEqual="GE",i.notEqual="NE",i.equal="EQ",i.endsWith="EndsWith",i.rangeInclusive="RangeInclusive",i.rangeExclusive="RangeExclusive",i.startsWith="StartsWith",i.in="IN",i.notIn="NOT_IN",i.inContains="IN_CONTAINS",i.notInContains="NOT_IN_CONTAINS",i.inCollection="IN_COLLECTION",i.notInCollection="NOT_IN_COLLECTION"})(tt||(tt={}));var kn;(function(i){i.asc="asc",i.ASC="ASC",i.desc="desc",i.DESC="DESC"})(kn||(kn={}));var ii;(function(i){i[i.asc=1]="asc",i[i.desc=-1]="desc",i[i.neutral=0]="neutral"})(ii||(ii={}));var is;(function(i){i.toggleCollapse="toggle-collapse",i.fullExpand="full-expand",i.fullCollapse="full-collapse",i.toggleExpand="toggle-expand"})(is||(is={}));const sE=Object.freeze(Object.defineProperty({__proto__:null,get CaseType(){return Qu},get DelimiterType(){return Ms},get EmitterType(){return ri},get ExtensionName(){return xt},FieldType:Y,get FileType(){return ps},get FilterMultiplePassType(){return Xa},get GridStateType(){return ur},get OperatorType(){return tt},get SortDirection(){return kn},get SortDirectionNumber(){return ii},get ToggleStateChangeType(){return is}},Symbol.toStringTag,{value:"Module"})),aE=Wr||uh;class dh extends Error{constructor(e){super(e),Object.setPrototypeOf(this,dh.prototype)}}function oE(i){let e=!1;return i instanceof Promise?{promise:i.then(t=>{if(e)throw new dh("Cancelled Promise");return t}),cancel:()=>e=!0}:i}function Nm(i,e,t=""){let r=e;if(e instanceof Promise)return e;if(i.isObservable(e)&&(r=i.firstValueFrom(e)),!(r instanceof Promise))throw new Error(`Something went wrong, Slickgrid-Universal ${t} is not able to convert the Observable into a Promise.`);return r}function fh(i,e,t=0){const r=(e==null?void 0:e.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP;Array.isArray(i)&&i.forEach(n=>{n&&(Array.isArray(n[r])&&n[r].length>0&&(t++,fh(n[r],e,t),t--),n[e.levelPropName]=t)})}function yl(i,e,t=0,r=null){const n=(e==null?void 0:e.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP,{aggregator:s}=e;Array.isArray(i)&&i.forEach(a=>{if(a){const o=Array.isArray(a[n]);Array.isArray(a[n])&&a[n].length>0&&(s.init(a,!0),t++,yl(a[n],e,t,a),t--),r&&s.isInitialized&&typeof s.accumulate=="function"&&!(a!=null&&a.__filteredOut)&&(s.accumulate(a,o),s.storeResult(r.__treeTotals)),a[e.levelPropName]=t}})}function Mm(i,e){const t=(e==null?void 0:e.identifierPropName)??"id",r=(e==null?void 0:e.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP,n=(e==null?void 0:e.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP,s=(e==null?void 0:e.parentPropName)??ye.treeDataProperties.PARENT_PROP,a=(e==null?void 0:e.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP;return e!=null&&e.shouldAddTreeLevelNumber&&(e!=null&&e.aggregators?e.aggregators.forEach(c=>{yl(i,{childrenPropName:r,levelPropName:a,aggregator:c})}):fh(i,{childrenPropName:r,levelPropName:a})),rE(i,c=>c[r],(c,h)=>({[t]:c[t],[s]:h!==void 0?h[t]:null,[n]:!!c[r],...Hm(c,r)}))}function Lm(i,e){const t=(e==null?void 0:e.identifierPropName)??"id",r=(e==null?void 0:e.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP,n=(e==null?void 0:e.parentPropName)??ye.treeDataProperties.PARENT_PROP,s=(e==null?void 0:e.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP,a=(e==null?void 0:e.collapsedPropName)??ye.treeDataProperties.COLLAPSED_PROP,o=i||[],c=[],h={};return o.forEach(l=>h[l[t]]=l),Object.keys(h).forEach(l=>{const u=h[l];if(!(n in u)||u[n]===null||u[n]===void 0||u[n]==="")c.push(u);else if(u[n]in h){const d=h[u[n]];r in d||(d[r]=[]),d[r].push(u),d[a]===void 0&&(d[a]=(e==null?void 0:e.initiallyCollapsed)??!1)}}),e!=null&&e.aggregators?e.aggregators.forEach(l=>{yl(c,{childrenPropName:r,levelPropName:s,aggregator:l},0)}):fh(c,{childrenPropName:r,levelPropName:s},0),c}function el(i,e,t){if(!t)throw new Error('findRecursive requires parameter "childrenPropertyName"');const r=i.find(e),n=i.filter(s=>(s==null?void 0:s.hasOwnProperty(t))&&s[t]);if(r)return r;if(n.length){const s=[];return n.forEach(a=>{a!=null&&a.hasOwnProperty(t)&&s.push(...a[t])}),el(s,e,t)}}function Ps(i,e,t,r=".",n=""){if(isNaN(+i))return i;const s=e===void 0?2:e,a=t===void 0?2:t;let o=String(Math.round(+i*Math.pow(10,a))/Math.pow(10,a));for(o.indexOf(".")<0&&s>0&&(o+=".");o.length-o.indexOf(".")<=s;)o+="0";const c=o.split(".");let h,l;n?h=c.length>=1?ns(c[0],n):void 0:h=c.length>=1?c[0]:o,c.length>1&&(l=c[1]);let u="";return h!==void 0&&l!==void 0?u=`${h}${r}${l}`:h!=null&&(u=h),u}function Ii(i,e,t,r,n="",s="",a=".",o=""){if(isNaN(+i))return i;const c=Math.round(parseFloat(i)*1e6)/1e6;if(c<0){const h=Math.abs(c);if(r){if(!isNaN(e)||!isNaN(t))return`(${n}${Ps(h,e,t,a,o)}${s})`;const l=ns(`${h}`,o);return`(${n}${l}${s})`}else{if(!isNaN(e)||!isNaN(t))return`-${n}${Ps(h,e,t,a,o)}${s}`;const l=ns(`${h}`,o);return`-${n}${l}${s}`}}else{if(!isNaN(e)||!isNaN(t))return`${n}${Ps(i,e,t,a,o)}${s}`;const h=ns(`${i}`,o);return`${n}${h}${s}`}}function tl(i,e,t){if(typeof i.queryFieldNameGetterFn=="function"){const r=i.queryFieldNameGetterFn(e);(r==null?void 0:r.indexOf("."))>=0?t=Ti(e,r):t=e.hasOwnProperty(r)?e[r]:t}return t}function Ti(i,e){return!i||!e?i:e.split(".").reduce((t,r)=>t&&t[r],i)}function Kn(i){return i&&i.translationNamespace?i.translationNamespace+(i.translationNamespaceSeparator||""):""}function lE(i){return i.outputType||i.type||Y.string}function Bm(i){switch(i){case Y.date:case Y.dateTime:case Y.dateIso:case Y.dateTimeIso:case Y.dateTimeShortIso:case Y.dateTimeIsoAmPm:case Y.dateTimeIsoAM_PM:case Y.dateEuro:case Y.dateEuroShort:case Y.dateTimeEuro:case Y.dateTimeShortEuro:case Y.dateTimeEuroAmPm:case Y.dateTimeEuroAM_PM:case Y.dateTimeEuroShort:case Y.dateTimeEuroShortAmPm:case Y.dateTimeEuroShortAM_PM:case Y.dateUs:case Y.dateUsShort:case Y.dateTimeUs:case Y.dateTimeShortUs:case Y.dateTimeUsAmPm:case Y.dateTimeUsAM_PM:case Y.dateTimeUsShort:case Y.dateTimeUsShortAmPm:case Y.dateTimeUsShortAM_PM:case Y.dateUtc:return!0;default:return!1}}function Lr(i){let e;switch(i){case Y.dateTime:case Y.dateTimeIso:e="YYYY-MM-DD HH:mm:ss";break;case Y.dateTimeIsoAmPm:e="YYYY-MM-DD hh:mm:ss a";break;case Y.dateTimeIsoAM_PM:e="YYYY-MM-DD hh:mm:ss A";break;case Y.dateTimeShortIso:e="YYYY-MM-DD HH:mm";break;case Y.dateEuro:e="DD/MM/YYYY";break;case Y.dateEuroShort:e="D/M/YY";break;case Y.dateTimeEuro:e="DD/MM/YYYY HH:mm:ss";break;case Y.dateTimeShortEuro:e="DD/MM/YYYY HH:mm";break;case Y.dateTimeEuroAmPm:e="DD/MM/YYYY hh:mm:ss a";break;case Y.dateTimeEuroAM_PM:e="DD/MM/YYYY hh:mm:ss A";break;case Y.dateTimeEuroShort:e="D/M/YY H:m:s";break;case Y.dateTimeEuroShortAmPm:e="D/M/YY h:m:s a";break;case Y.dateTimeEuroShortAM_PM:e="D/M/YY h:m:s A";break;case Y.dateUs:e="MM/DD/YYYY";break;case Y.dateUsShort:e="M/D/YY";break;case Y.dateTimeUs:e="MM/DD/YYYY HH:mm:ss";break;case Y.dateTimeUsAmPm:e="MM/DD/YYYY hh:mm:ss a";break;case Y.dateTimeUsAM_PM:e="MM/DD/YYYY hh:mm:ss A";break;case Y.dateTimeUsShort:e="M/D/YY H:m:s";break;case Y.dateTimeUsShortAmPm:e="M/D/YY h:m:s a";break;case Y.dateTimeUsShortAM_PM:e="M/D/YY h:m:s A";break;case Y.dateTimeShortUs:e="MM/DD/YYYY HH:mm";break;case Y.dateUtc:e="YYYY-MM-DDTHH:mm:ss.SSSZ";break;case Y.date:case Y.dateIso:default:e="YYYY-MM-DD";break}return e}function il(i){let e;switch(i){case Y.dateTime:case Y.dateTimeIso:e="Y-m-d H:i:S";break;case Y.dateTimeShortIso:e="Y-m-d H:i";break;case Y.dateTimeIsoAmPm:case Y.dateTimeIsoAM_PM:e="Y-m-d h:i:S K";break;case Y.dateEuro:e="d/m/Y";break;case Y.dateEuroShort:e="d/m/y";break;case Y.dateTimeEuro:e="d/m/Y H:i:S";break;case Y.dateTimeShortEuro:e="d/m/y H:i";break;case Y.dateTimeEuroAmPm:e="d/m/Y h:i:S K";break;case Y.dateTimeEuroAM_PM:e="d/m/Y h:i:s K";break;case Y.dateTimeEuroShort:e="d/m/y H:i:s";break;case Y.dateTimeEuroShortAmPm:e="d/m/y h:i:s K";break;case Y.dateUs:e="m/d/Y";break;case Y.dateUsShort:e="m/d/y";break;case Y.dateTimeUs:e="m/d/Y H:i:S";break;case Y.dateTimeShortUs:e="m/d/y H:i";break;case Y.dateTimeUsAmPm:e="m/d/Y h:i:S K";break;case Y.dateTimeUsAM_PM:e="m/d/Y h:i:s K";break;case Y.dateTimeUsShort:e="m/d/y H:i:s";break;case Y.dateTimeUsShortAmPm:e="m/d/y h:i:s K";break;case Y.dateUtc:e="Z";break;case Y.date:case Y.dateIso:default:e="Y-m-d";break}return e}function cE(i){let e;switch(i){case"<":case"LT":e=tt.lessThan;break;case"<=":case"LE":e=tt.lessThanOrEqual;break;case">":case"GT":e=tt.greaterThan;break;case">=":case"GE":e=tt.greaterThanOrEqual;break;case"<>":case"!=":case"NE":e=tt.notEqual;break;case"*":case"a*":case"StartsWith":e=tt.startsWith;break;case"*z":case"EndsWith":e=tt.endsWith;break;case"=":case"==":case"EQ":e=tt.equal;break;case"IN":e=tt.in;break;case"NIN":case"NOT_IN":e=tt.notIn;break;case"Not_Contains":case"NOT_CONTAINS":e=tt.notContains;break;case"Contains":case"CONTAINS":default:e=tt.contains;break}return e}function no(i){let e="";switch(i){case tt.greaterThan:case">":e=">";break;case tt.greaterThanOrEqual:case">=":e=">=";break;case tt.lessThan:case"<":e="<";break;case tt.lessThanOrEqual:case"<=":e="<=";break;case tt.notEqual:case"<>":e="<>";break;case tt.equal:case"=":case"==":case"EQ":e="=";break;case tt.startsWith:case"a*":case"*":e="a*";break;case tt.endsWith:case"*z":e="*z";break;default:e=i;break}return e}function Zu(i){let e;if(Bm(i))e=tt.equal;else switch(i){case Y.unknown:case Y.string:case Y.text:case Y.password:case Y.readonly:e=tt.contains;break;case Y.float:case Y.number:default:e=tt.equal;break}return e}function Hm(i,e){return Object.keys(i).reduce((t,r)=>(r!==e&&(t[r]=i[r]),t),{})}function hE(i,e){let t="";if(typeof i=="string"&&/^[0-9\-\/]*$/.test(i)){const r=decodeURIComponent(i),n=aE(new Date(r));n.isValid()&&n.year().toString().length===4&&(t=e?n.utc().format():n.format())}return t}function ns(i,e=","){if(i!=null){const t=`${i}`,r=t.split(".");return r.length===2?`${r[0].replace(/\B(?=(\d{3})+(?!\d))/g,e)}.${r[1]}`:t.replace(/\B(?=(\d{3})+(?!\d))/g,e)}return i}function ss(i,e,t={}){return Array.isArray(i)?i.find(e)||t:i}function ph(i){if(Array.isArray(i))for(;i.length>0;){const e=i.pop();e!=null&&e.unsubscribe&&e.unsubscribe()}return i}const uE=Object.freeze(Object.defineProperty({__proto__:null,CancelledException:dh,addTreeLevelAndAggregatorsByMutation:yl,addTreeLevelByMutation:fh,cancellablePromise:oE,castObservableToPromise:Nm,decimalFormatted:Ps,findItemInTreeStructure:el,findOrDefault:ss,flattenToParentChildArray:Mm,formatNumber:Ii,getCellValueFromQueryFieldGetter:tl,getColumnFieldType:lE,getDescendantProperty:Ti,getTranslationPrefix:Kn,isColumnDateType:Bm,mapFlatpickrDateFormatWithFieldType:il,mapMomentDateFormatWithFieldType:Lr,mapOperatorByFieldType:Zu,mapOperatorToShorthandDesignation:no,mapOperatorType:cE,objectWithoutKey:Hm,parseUtcDate:hE,thousandSeparatorFormatted:ns,unflattenParentChildArrayToTree:Lm,unsubscribeAll:ph},Symbol.toStringTag,{value:"Module"})),dE=(i,e,t)=>{t==null&&(t=ii.neutral);let r=0;return i===e?r=0:i===null?r=-1:e===null?r=1:t?r=i<e?-1:1:r=i<e?1:-1,t*r},fE=(i,e,t,r,n)=>{if(!r||!r.dataKey)throw new Error('Sorting a "FieldType.object" requires you to provide the "dataKey" (object property name) of the object so that we can use it to sort correctly');const s=i!=null&&i.hasOwnProperty(r.dataKey)?i[r.dataKey]:i,a=e!=null&&e.hasOwnProperty(r.dataKey)?e[r.dataKey]:e,o=(r==null?void 0:r.valueCouldBeUndefined)??(n==null?void 0:n.cellValueCouldBeUndefined)??!1;t==null&&(t=ii.neutral);let c=0;return typeof i!="object"?c=-99e10:typeof e!="object"?c=99e10:s===null||o&&s===void 0?c=-1:a===null||o&&a===void 0?c=1:s===a?c=0:t?c=s<a?-1:1:c=s<a?1:-1,t*c};function mh(i){let e=0,t=0,r=0,n=0;const s=window.innerHeight??0,a=window.innerWidth??0,o=Dd(),c=o.top,h=o.left,l=xi(i);if(l){const u=l.top??0,d=l.left??0;t=u-c,e=s-(u-c),r=d-h,n=a-(d-h)}return{top:t,bottom:e,left:r,right:n}}function K(i,e,t){const r=document.createElement(i);return e&&Object.keys(e).forEach(n=>{n==="innerHTML"&&console.warn(`[Slickgrid-Universal] For better CSP (Content Security Policy) support, do not use "innerHTML" directly in "createDomElement('${i}', { innerHTML: 'some html'})", it is better as separate assignment: "const elm = createDomElement('span'); elm.innerHTML = 'some html';"`);const s=e[n];typeof s=="object"?Object.assign(r[n],s):r[n]=e[n]}),t!=null&&t.appendChild&&t.appendChild(r),r}function gi(i=""){return i.split(" ").filter(e=>e)}function Sl(i){typeof i=="object"&&Object.keys(i).forEach(e=>{Array.isArray(i[e])&&Sl(i[e]),i[e]instanceof HTMLElement&&(i[e]=null)})}function Rt(i){for(;i!=null&&i.firstChild;)i.removeChild(i.firstChild);return i}function pE(i,e="innerHTML"){return Ls(i,e)}function Ls(i,e="innerHTML"){return i instanceof DocumentFragment?[].map.call(i.childNodes,t=>t[e]).join("")||i.textContent||"":i instanceof HTMLElement?i[e]:String(i??"")}function Vm(i,e){if(!i||!e)return;const t=i.getBoundingClientRect(),r=e.getBoundingClientRect();return{top:r.top-t.top,right:r.right-t.right,bottom:r.bottom-t.bottom,left:r.left-t.left}}function xi(i){if(!i||!i.getBoundingClientRect)return;const e=i.getBoundingClientRect(),t=document.documentElement;let r=0,n=0,s=0,a=0;return(e==null?void 0:e.top)!==void 0&&e.left!==void 0&&(r=e.top+window.pageYOffset-t.clientTop,n=e.left+window.pageXOffset-t.clientLeft,a=e.right,s=e.bottom),{top:r,left:n,bottom:s,right:a}}function Dc(i,e){let t=0;if(i){const r=e==="height"?"clientHeight":"clientWidth",n=e==="height"?["top","bottom"]:["left","right"];t=i[r];for(const s of n){const a=parseFloat(Um(i,`padding-${s}`)||"")||0;t-=a}}return t}function Um(i,e){return i?window.getComputedStyle(i).getPropertyValue(e):null}function mE(i,e){if(i)for(const t of e){const r=i.getAttribute(t);if(r)return r}return null}function as(i,e="auto"){return(/^[0-9]+$/i.test(`${i}`)?`${+i}px`:i)||e}function Wm(i){const e=typeof i=="string"?i:String(i),t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return(e||"").toString().replace(/[&<>"']/g,r=>t[r])}function gE(i){return i.replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t))}function zm(i,e){const t=i.length;let r=Wm(i);if(t<e)for(let n=t;n<e;n++)r+="&nbsp;";return r}function Gm(i,e){var t;(t=i.parentNode)==null||t.insertBefore(e,i.nextSibling)}function Dd(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}const yc=Object.prototype.hasOwnProperty,$m=Object.prototype.toString,y0=Object.defineProperty,S0=Object.getOwnPropertyDescriptor,b0=function(e){return typeof Array.isArray=="function"?Array.isArray(e):$m.call(e)==="[object Array]"},T0=function(e){if(!e||$m.call(e)!=="[object Object]")return!1;const t=yc.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&yc.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!r)return!1;let n;for(n in e);return typeof n>"u"||yc.call(e,n)},A0=function(e,t){y0&&t.name==="__proto__"?y0(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},k0=function(e,t){if(t==="__proto__")if(yc.call(e,t)){if(S0)return S0(e,t).value}else return;return e[t]};function Br(...i){let e,t,r,n,s,a,o=i[0],c=1;const h=i.length;let l=!1;for(typeof o=="boolean"&&(l=o,o=i[1]||{},c=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});c<h;++c)if(e=i[c],e!=null)for(t in e)r=k0(o,t),n=k0(e,t),o!==n&&(l&&n&&(T0(n)||(s=b0(n)))?(s?(s=!1,a=r&&b0(r)?r:[]):a=r&&T0(r)?r:{},A0(o,{name:t,newValue:Br(l,a,n)})):typeof n<"u"&&A0(o,{name:t,newValue:n}));return o}function vE(i,e,t="id"){let r=-1;e&&typeof e=="object"&&t in e?r=i.findIndex(n=>n[t]===e[t]):r=i.findIndex(n=>n===e),r<0&&i.push(e)}function Ju(i,e=" "){let t="";for(let r=0;r<i;r++)t+=e;return t}function Fd(i,e){return i.filter((t,r)=>e!==r)}function da(i){const e=()=>{const n={};return Object.keys(i).forEach(s=>{Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=da(i[s]))}),n},t=()=>i.map(n=>da(n)),r=Object.prototype.toString.call(i).slice(8,-1).toLowerCase();return r==="object"?e():r==="array"?t():i}function so(i,...e){if(!e.length)return i;const t=e.shift();return i=!sa(i)&&sa(t)?{}:i,sa(i)&&sa(t)&&Object.keys(t).forEach(r=>{t.hasOwnProperty(r)&&(r in i?typeof i[r]!="object"||typeof t[r]!="object"?i[r]=t[r]:i[r].concat&&t[r].concat?i[r]=i[r].concat(t[r]):i[r]=so(i[r],t[r]):i[r]=t[r])}),so(i,...e)}function _E(i){return sa(i)&&Object.keys(i).forEach(e=>{i.hasOwnProperty(e)&&delete i[e]}),i=null,i={},i}function ed(i,e=!0){let t=!1;const r=s=>{const a=s.toString();if(t=a.includes("async "),a.replaceAll(" ","").includes("=>({")){const h=a.match(/(({.*}))/g)||[];return h.length>=1?`return ${h[0].trimStart()}`:a}const o=!a.includes("{")&&a.includes("=>"),c=a.substring(a.indexOf("{")+1||a.indexOf("=>")+2,a.includes("}")?a.lastIndexOf("}"):a.length);return e&&o&&!c.startsWith("return")?"return "+c.trimStart():c};return{params:(s=>{const a=/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,\)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,\)]*))/mg,o=/([^\s,]+)/g,c=s.toString().replace(a,"");return c.slice(c.indexOf("(")+1,c.indexOf(")")).match(o)??[]})(i),body:r(i),isAsync:t}}function td(i){return i==null?!0:Object.entries(i).length===0}function oi(i){return i!=null&&i!==""}function ta(i){return i!==null&&!isNaN(i)&&i!==""}function sa(i){return i!==null&&typeof i=="object"&&!Array.isArray(i)&&!(i instanceof Date)}function bl(i){return typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i===null||i===void 0}function rl(i){return i instanceof HTMLElement||i instanceof DocumentFragment||bl(i)}function gh(i){return i!=null&&i!==""}function ti(i,e=!1){return e?i==null||typeof i=="string"?!1:!isNaN(i):i==null||i===""?!1:!isNaN(+i)}function Ym(i){return!i||i&&typeof i=="object"&&Object.keys(i).length===0}function Fc(i){return/(true|1)/i.test(i+"")}function qa(i,e=!1){const t=typeof i.normalize=="function"?i.normalize("NFD").replace(/[\u0300-\u036f]/g,""):i;return e?t.toLowerCase():t}function Hr(i,e,t){if(typeof e=="string"&&(e=e.split(".")),e.length>1){const r=e.shift();i&&r!==void 0&&Hr(i[r]=gh(i[r])&&(Array.isArray(i[r])||Object.prototype.toString.call(i[r])==="[object Object]")?i[r]:{},e,t)}else i&&e[0]&&(i[e[0]]=t)}function nl(i,e=!1){return typeof i=="string"?e?i.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()):i.charAt(0).toUpperCase()+i.slice(1):i}function Pd(i){return typeof i=="string"?i.replace(/(?:^\w|[A-Z]|\b\w|[\s+\-_\/])/g,(e,t)=>/[\s+\-_\/]/.test(e)?"":t===0?e.toLowerCase():e.toUpperCase()):i}function sl(i){return typeof i=="string"?Pd(i).replace(/([A-Z])/g,"-$1").toLowerCase():i}function rn(i){if(typeof i=="string"){const e=i.replace(/([A-Z])|(\-)/g," $1").replace(/\s+/g," ").trim();return e.charAt(0).toUpperCase()+e.slice(1)}return i}function EE(i){return typeof i=="string"?Pd(i).replace(/([A-Z])/g,"_$1").toLowerCase():i}function Xm(i){return Array.isArray(i)&&i.length>0?i.filter((e,t)=>i.indexOf(e)>=t):i}function xE(i,e="id"){if(Array.isArray(i)&&i.length>0){const t=[],r=new Map;for(const n of i)n&&!r.has(n[e])&&(r.set(n[e],!0),t.push({id:n[e],name:n.name}));return t}return i}const So=Symbol("plaintext"),O0=Symbol("html"),I0=Symbol("comment"),wE=/<(\w*)>/g,CE=/<\/?([^\s\/>]+)/;function Rn(i,e,t){function r(c,h,l){if(typeof c!="string"&&(ti(c)||typeof c=="boolean"))return String(c);if(c instanceof HTMLElement&&(c=c.innerHTML),typeof c!="string"&&c!==void 0&&c!==null)throw new TypeError("'html' parameter must be a string");return s(c||"",n(h||"",l||""))}function n(c,h){return{allowable_tags:a(c),tag_replacement:h,state:So,tag_buffer:"",depth:0,in_quote_char:""}}function s(c,h){const l=h.allowable_tags,u=h.tag_replacement;let d=h.state,f=h.tag_buffer,p=h.depth,m=h.in_quote_char,v="";for(let _=0,x=c.length;_<x;_++){const E=c[_];if(d===So)switch(E){case"<":d=O0,f+=E;break;default:v+=E;break}else if(d===O0)switch(E){case"<":if(m)break;p++;break;case">":if(m)break;if(p){p--;break}m="",d=So,f+=">",l.has(o(f))?v+=f:v+=u,f="";break;case'"':case"'":E===m?m="":m=m||E,f+=E;break;case"-":f==="<!-"&&(d=I0),f+=E;break;case" ":case`
`:if(f==="<"){d=So,v+="< ",f="";break}f+=E;break;default:f+=E;break}else if(d===I0)switch(E){case">":f.slice(-2)==="--"&&(d=So),f="";break;default:f+=E;break}}return h.state=d,h.tag_buffer=f,h.depth=p,h.in_quote_char=m,v}function a(c){let h=new Set;if(typeof c=="string"){let l;for(;l=wE.exec(c);)h.add(l[1])}else typeof c[Symbol.iterator]=="function"&&(h=new Set(c));return h}function o(c){const h=CE.exec(c);return h?h[1].toLowerCase():null}return r(i,e,t)}const yE=Object.freeze(Object.defineProperty({__proto__:null,addToArrayWhenNotExists:vE,addWhiteSpaces:Ju,arrayRemoveItemByIndex:Fd,calculateAvailableSpace:mh,classNameToList:gi,createDomElement:K,deepCopy:da,deepMerge:so,destroyAllElementProps:Sl,emptyElement:Rt,emptyObject:_E,extend:Br,findFirstAttribute:mE,findWidthOrDefault:as,getFunctionDetails:ed,getHTMLFromFragment:pE,getHtmlStringOutput:Ls,getInnerSize:Dc,getOffset:xi,getOffsetRelativeToParent:Vm,getStyleProp:Um,hasData:gh,htmlEncode:Wm,htmlEncodeWithPadding:zm,htmlEntityDecode:gE,insertAfterElement:Gm,isDefined:oi,isDefinedNumber:ta,isEmptyObject:td,isNumber:ti,isObject:sa,isObjectEmpty:Ym,isPrimitiveOrHTML:rl,isPrimitiveValue:bl,parseBoolean:Fc,removeAccentFromText:qa,setDeepValue:Hr,stripTags:Rn,titleCase:nl,toCamelCase:Pd,toKebabCase:sl,toSentenceCase:rn,toSnakeCase:EE,uniqueArray:Xm,uniqueObjectArray:xE,windowScrollPosition:Dd},Symbol.toStringTag,{value:"Module"})),SE=(i,e,t,r,n)=>{t==null&&(t=ii.neutral);let s=0;const a=(r==null?void 0:r.valueCouldBeUndefined)??(n==null?void 0:n.cellValueCouldBeUndefined)??!1;return i===e?s=0:i===null||a&&i===void 0?s=-1:e===null||a&&e===void 0?s=1:(n!=null&&n.ignoreAccentOnStringFilterAndSort&&(i=qa(i,!1),e=qa(e,!1)),t?s=i<e?-1:1:s=i<e?1:-1),t*s},bE=(i,e,t,r,n)=>{const s=(r==null?void 0:r.valueCouldBeUndefined)??(n==null?void 0:n.cellValueCouldBeUndefined)??!1,a=isNaN(i)||i===""||i===null||s&&i===void 0?-99e10:parseFloat(i),o=isNaN(e)||e===""||e===null||s&&e===void 0?-99e10:parseFloat(e);return t*(a===o?0:a>o?1:-1)},Pc=Wr||uh;function R0(i,e,t,r,n){let s=0;if(i===e)s=0;else{let a=Pc(i,r,n),o=Pc(e,r,n);a.isValid()||(a=new Date(1001,1,1)),o.isValid()||(o=new Date(1001,1,1)),s=a.valueOf()-o.valueOf()}return t*s}function ei(i){const e=i===Y.date?Pc.ISO_8601:Lr(i);return(t,r,n)=>e===Pc.ISO_8601?R0(t,r,n,e,!1):R0(t,r,n,e,!0)}const Do={boolean:dE,date:ei(Y.date),dateIso:ei(Y.dateIso),dateUtc:ei(Y.dateUtc),dateTime:ei(Y.dateTime),dateTimeIso:ei(Y.dateTimeIso),dateTimeIsoAmPm:ei(Y.dateTimeIsoAmPm),dateTimeIsoAM_PM:ei(Y.dateTimeIsoAM_PM),dateTimeShortIso:ei(Y.dateTimeShortIso),dateEuro:ei(Y.dateEuro),dateEuroShort:ei(Y.dateEuroShort),dateTimeShortEuro:ei(Y.dateTimeShortEuro),dateTimeEuro:ei(Y.dateTimeEuro),dateTimeEuroAmPm:ei(Y.dateTimeEuroAmPm),dateTimeEuroAM_PM:ei(Y.dateTimeEuroAM_PM),dateTimeEuroShort:ei(Y.dateTimeEuroShort),dateTimeEuroShortAmPm:ei(Y.dateTimeEuroShortAmPm),dateTimeEuroShortAM_PM:ei(Y.dateTimeEuroShortAM_PM),dateUs:ei(Y.dateUs),dateUsShort:ei(Y.dateUsShort),dateTimeShortUs:ei(Y.dateTimeShortUs),dateTimeUs:ei(Y.dateTimeUs),dateTimeUsAmPm:ei(Y.dateTimeUsAmPm),dateTimeUsAM_PM:ei(Y.dateTimeUsAM_PM),dateTimeUsShort:ei(Y.dateTimeUsShort),dateTimeUsShortAmPm:ei(Y.dateTimeUsShortAmPm),dateTimeUsShortAM_PM:ei(Y.dateTimeUsShortAM_PM),numeric:bE,objectString:fE,string:SE};function Ka(i,e,t,r,n,s){let a=0;switch(i){case Y.boolean:a=Do.boolean(e,t,r,n,s);break;case Y.float:case Y.integer:case Y.number:a=Do.numeric(e,t,r,n,s);break;case Y.date:case Y.dateIso:case Y.dateUtc:case Y.dateTime:case Y.dateTimeIso:case Y.dateTimeIsoAmPm:case Y.dateTimeIsoAM_PM:case Y.dateTimeShortIso:case Y.dateEuro:case Y.dateEuroShort:case Y.dateTimeShortEuro:case Y.dateTimeEuro:case Y.dateTimeEuroAmPm:case Y.dateTimeEuroAM_PM:case Y.dateTimeEuroShort:case Y.dateTimeEuroShortAmPm:case Y.dateTimeEuroShortAM_PM:case Y.dateUs:case Y.dateUsShort:case Y.dateTimeShortUs:case Y.dateTimeUs:case Y.dateTimeUsAmPm:case Y.dateTimeUsAM_PM:case Y.dateTimeUsShort:case Y.dateTimeUsShortAmPm:case Y.dateTimeUsShortAM_PM:a=ei(i).call(this,e,t,r,n,s);break;case Y.object:a=Do.objectString(e,t,r,n,s);break;case Y.string:case Y.text:case Y.password:case Y.readonly:default:a=Do.string(e,t,r,n,s);break}return a}const TE=Object.freeze(Object.defineProperty({__proto__:null,sortByFieldType:Ka},Symbol.toStringTag,{value:"Module"}));var zn;(function(i){i.camelCase="camelCase",i.kebabCase="kebabCase",i.lowerCase="lowerCase",i.lowerCaseWithoutOnPrefix="lowerCaseWithoutOnPrefix"})(zn||(zn={}));class AE{get elementSource(){return this._elementSource}set elementSource(e){this._elementSource=e}get subscribedEvents(){return this._subscribedEvents}get subscribedEventNames(){return this._subscribedEvents.map(e=>e.name)}constructor(e){this._subscribedEvents=[],this.eventNamingStyle=zn.camelCase,this._elementSource=e||document.createElement("div")}dispose(){var e;this.unsubscribeAll(),this._subscribedEvents=[],clearTimeout(this._timer),(e=this._elementSource)==null||e.remove(),this._elementSource=null}dispatchCustomEvent(e,t,r=!0,n=!0){var a;const s={bubbles:r,cancelable:n};return t&&(s.detail=t),(a=this._elementSource)==null?void 0:a.dispatchEvent(new CustomEvent(e,s))}getEventNameByNamingConvention(e,t){let r="";switch(this.eventNamingStyle){case zn.camelCase:r=t!==""?`${t}${nl(e)}`:e;break;case zn.kebabCase:r=t!==""?`${t}-${sl(e)}`:sl(e);break;case zn.lowerCase:r=`${t}${e}`.toLowerCase();break;case zn.lowerCaseWithoutOnPrefix:r=`${t}${e.replace(/^on/,"")}`.toLowerCase();break}return r}publish(e,t,r){const n=this.getEventNameByNamingConvention(e,"");return r?new Promise(s=>{clearTimeout(this._timer),this._timer=setTimeout(()=>s(this.dispatchCustomEvent(n,t,!0,!0)),r)}):this.dispatchCustomEvent(n,t,!0,!0)}subscribe(e,t){const r=this.getEventNameByNamingConvention(e,"");return this._elementSource.addEventListener(r,n=>t.call(null,n.detail)),this._subscribedEvents.push({name:r,listener:t}),{unsubscribe:()=>this.unsubscribe(r,t)}}subscribeEvent(e,t){const r=this.getEventNameByNamingConvention(e,"");return this._elementSource.addEventListener(r,t),this._subscribedEvents.push({name:r,listener:t}),{unsubscribe:()=>this.unsubscribe(r,t)}}unsubscribe(e,t,r=!0){const n=this.getEventNameByNamingConvention(e,"");this._elementSource.removeEventListener(n,t),r&&this.removeSubscribedEventWhenFound(e,t)}unsubscribeAll(e){if(Array.isArray(e)){let t;do t=e.pop(),t!=null&&t.dispose?t.dispose():t!=null&&t.unsubscribe&&t.unsubscribe();while(t)}else{let t=this._subscribedEvents.pop();for(;t;)this.unsubscribe(t.name,t.listener,!1),t=this._subscribedEvents.pop()}}removeSubscribedEventWhenFound(e,t){const r=this._subscribedEvents.findIndex(n=>n.name===e&&n.listener===t);r>=0&&this._subscribedEvents.splice(r,1)}}function Nc(i){var e=document,t=i.container||e.createElement("div"),r=i.preventSubmit||0;t.id=t.id||"autocomplete-"+x();var n=t.style,s=i.debounceWaitMs||0,a=i.disableAutoSelect||!1,o=t.parentElement,c=[],h="",l=2,u=i.showOnFocus,d,f=0,p,m=!1,v=!1;if(i.minLength!==void 0&&(l=i.minLength),!i.input)throw new Error("input undefined");var _=i.input;t.className=[t.className,"autocomplete",i.className||""].join(" ").trim(),t.setAttribute("role","listbox"),_.setAttribute("role","combobox"),_.setAttribute("aria-expanded","false"),_.setAttribute("aria-autocomplete","list"),_.setAttribute("aria-controls",t.id),_.setAttribute("aria-owns",t.id),_.setAttribute("aria-activedescendant",""),_.setAttribute("aria-haspopup","listbox"),n.position="absolute";function x(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function E(){var ue=t.parentNode;ue&&ue.removeChild(t)}function C(){p&&window.clearTimeout(p)}function y(){t.parentNode||(o||e.body).appendChild(t)}function b(){return!!t.parentNode}function T(){f++,c=[],h="",d=void 0,_.setAttribute("aria-activedescendant",""),_.setAttribute("aria-expanded","false"),E()}function R(){if(!b())return;_.setAttribute("aria-expanded","true"),n.height="auto",n.width=_.offsetWidth+"px";var ue=0,M;function it(){var et=e.documentElement,he=et.clientTop||e.body.clientTop||0,Qe=et.clientLeft||e.body.clientLeft||0,Te=window.pageYOffset||et.scrollTop,dt=window.pageXOffset||et.scrollLeft;M=_.getBoundingClientRect();var wt=M.top+_.offsetHeight+Te-he,Gt=M.left+dt-Qe;n.top=wt+"px",n.left=Gt+"px",ue=window.innerHeight-(M.top+_.offsetHeight),ue<0&&(ue=0),n.top=wt+"px",n.bottom="",n.left=Gt+"px",n.maxHeight=ue+"px"}it(),it(),i.customize&&M&&i.customize(_,M,t,ue)}function O(){t.textContent="",_.setAttribute("aria-activedescendant","");var ue=function(Qe,Te,dt){var wt=e.createElement("div");return wt.textContent=Qe.label||"",wt};i.render&&(ue=i.render);var M=function(Qe,Te){var dt=e.createElement("div");return dt.textContent=Qe,dt};i.renderGroup&&(M=i.renderGroup);var it=e.createDocumentFragment(),et=x();if(c.forEach(function(Qe,Te){if(Qe.group&&Qe.group!==et){et=Qe.group;var dt=M(Qe.group,h);dt&&(dt.className+=" group",it.appendChild(dt))}var wt=ue(Qe,h,Te);wt&&(wt.id=t.id+"_"+Te,wt.setAttribute("role","option"),wt.addEventListener("click",function(Gt){v=!0;try{i.onSelect(Qe,_)}finally{v=!1}T(),Gt.preventDefault(),Gt.stopPropagation()}),Qe===d&&(wt.className+=" selected",wt.setAttribute("aria-selected","true"),_.setAttribute("aria-activedescendant",wt.id)),it.appendChild(wt))}),t.appendChild(it),c.length<1)if(i.emptyMsg){var he=e.createElement("div");he.id=t.id+"_"+x(),he.className="empty",he.textContent=i.emptyMsg,t.appendChild(he),_.setAttribute("aria-activedescendant",he.id)}else{T();return}y(),R(),xe()}function W(){b()&&O()}function G(){W()}function Q(ue){ue.target!==t?W():ue.preventDefault()}function ne(){v||q(0)}function xe(){var ue=t.getElementsByClassName("selected");if(ue.length>0){var M=ue[0],it=M.previousElementSibling;if(it&&it.className.indexOf("group")!==-1&&!it.previousElementSibling&&(M=it),M.offsetTop<t.scrollTop)t.scrollTop=M.offsetTop;else{var et=M.offsetTop+M.offsetHeight,he=t.scrollTop+t.offsetHeight;et>he&&(t.scrollTop+=et-he)}}}function Ce(){var ue=c.indexOf(d);d=ue===-1?void 0:c[(ue+c.length-1)%c.length],ke(ue)}function Fe(){var ue=c.indexOf(d);d=c.length<1?void 0:ue===-1?c[0]:c[(ue+1)%c.length],ke(ue)}function ke(ue){c.length>0&&(ie(ue),Ze(c.indexOf(d)),xe())}function Ze(ue){var M=e.getElementById(t.id+"_"+ue);M&&(M.classList.add("selected"),M.setAttribute("aria-selected","true"),_.setAttribute("aria-activedescendant",M.id))}function ie(ue){var M=e.getElementById(t.id+"_"+ue);M&&(M.classList.remove("selected"),M.removeAttribute("aria-selected"),_.removeAttribute("aria-activedescendant"))}function Ee(ue,M){var it=b();if(M==="Escape")T();else{if(!it||c.length<1)return;M==="ArrowUp"?Ce():Fe()}ue.preventDefault(),it&&ue.stopPropagation()}function Pe(ue){if(d){r===2&&ue.preventDefault(),v=!0;try{i.onSelect(d,_)}finally{v=!1}T()}r===1&&ue.preventDefault()}function U(ue){var M=ue.key;switch(M){case"ArrowUp":case"ArrowDown":case"Escape":Ee(ue,M);break;case"Enter":Pe(ue);break}}function Z(){u&&q(1)}function q(ue){_.value.length>=l||ue===1?(C(),p=window.setTimeout(function(){return X(_.value,ue,_.selectionStart||0)},ue===0||ue===2?s:0)):T()}function X(ue,M,it){if(!m){var et=++f;i.fetch(ue,function(he){f===et&&he&&(c=he,h=ue,d=c.length<1||a?void 0:c[0],O())},M,it)}}function de(ue){if(i.keyup){i.keyup({event:ue,fetch:function(){return q(0)}});return}!b()&&ue.key==="ArrowDown"&&q(0)}function Ie(ue){i.click&&i.click({event:ue,fetch:function(){return q(2)}})}function we(){setTimeout(function(){e.activeElement!==_&&T()},200)}function Re(){X(_.value,3,_.selectionStart||0)}t.addEventListener("mousedown",function(ue){ue.stopPropagation(),ue.preventDefault()}),t.addEventListener("focus",function(){return _.focus()}),E();function be(){_.removeEventListener("focus",Z),_.removeEventListener("keyup",de),_.removeEventListener("click",Ie),_.removeEventListener("keydown",U),_.removeEventListener("input",ne),_.removeEventListener("blur",we),window.removeEventListener("resize",G),e.removeEventListener("scroll",Q,!0),_.removeAttribute("role"),_.removeAttribute("aria-expanded"),_.removeAttribute("aria-autocomplete"),_.removeAttribute("aria-controls"),_.removeAttribute("aria-activedescendant"),_.removeAttribute("aria-owns"),_.removeAttribute("aria-haspopup"),C(),T(),m=!0}return _.addEventListener("keyup",de),_.addEventListener("click",Ie),_.addEventListener("keydown",U),_.addEventListener("input",ne),_.addEventListener("blur",we),_.addEventListener("focus",Z),window.addEventListener("resize",G),e.addEventListener("scroll",Q,!0),{destroy:be,fetch:Re}}class qm{constructor(e){this._value=null,this._boundedEventWithListeners=[],this._elementBindings=[],this._binding=e,this._property=e.property||"",this._elementBindings=[],e.property&&e.variable&&(e.variable.hasOwnProperty(e.property)||e.property in e.variable)?this._value=e.variable[e.property]:this._value=e.variable,typeof e.variable=="object"&&Object.defineProperty(e.variable,e.property,{get:this.valueGetter.bind(this),set:this.valueSetter.bind(this)})}get boundedEventWithListeners(){return this._boundedEventWithListeners}get elementBindings(){return this._elementBindings}get property(){return this._property}dispose(){this.unbindAll(),this._boundedEventWithListeners=[],this._elementBindings=[]}valueGetter(){return this._value}valueSetter(e){if(this._value=e,Array.isArray(this._elementBindings))for(const t of this._elementBindings)t!=null&&t.element&&(t!=null&&t.attribute)&&(t.element[t.attribute]=e)}bind(e,t,r,n){return e&&e.forEach?e.forEach(s=>this.bindSingleElement(s,t,r,n)):e&&this.bindSingleElement(e,t,r,n),this}unbind(e,t,r,n,s){if(e){e.removeEventListener(t,r,n);const a=this._boundedEventWithListeners.findIndex(o=>o.uid===s);a>=0&&this._boundedEventWithListeners.splice(a,1)}}unbindAll(){let e=this._boundedEventWithListeners.pop();for(;e;){const{element:t,eventName:r,listener:n,uid:s}=e;this.unbind(t,r,n,void 0,s),e=this._boundedEventWithListeners.pop()}this._boundedEventWithListeners=[]}bindSingleElement(e,t,r,n){const s={element:e,attribute:t};if(e){if(r){const a=()=>{let o=e[t];if(this.hasData(o)&&(e==null?void 0:e.type)==="number"&&(o=+o),this.valueSetter(o),(this._binding.variable.hasOwnProperty(this._binding.property)||this._binding.property in this._binding.variable)&&(this._binding.variable[this._binding.property]=this.valueGetter()),typeof n=="function")return n(this.valueGetter())};s.event=r,s.listener=a,e.addEventListener(r,a),this._boundedEventWithListeners.push({element:e,eventName:r,listener:a,uid:this.generateUuidV4()})}this._elementBindings.push(s),e[t]=this._value}}generateUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}hasData(e){return e!=null&&e!==""}}class Km{constructor(){this._observers=[],this._querySelectorPrefix=""}get querySelectorPrefix(){return this._querySelectorPrefix||""}set querySelectorPrefix(e){this._querySelectorPrefix=e}get observers(){return this._observers}dispose(){let e=this._observers.pop();for(;e;)e.dispose(),e=this._observers.pop();this._observers=[]}addElementBinding(e,t,r,n,s,a){const o=document.querySelectorAll(`${this.querySelectorPrefix}${r}`);let c=this._observers.find(h=>h.property===e);c||(c=new qm({variable:e,property:t})),Array.isArray(s)?s.forEach(h=>c==null?void 0:c.bind(o,n,h,a)):c==null||c.bind(o,n,s,a),this._observers.push(c)}bindEventHandler(e,t,r,n){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach(a=>{a!=null&&a.addEventListener&&a.addEventListener(t,r,n)})}setElementAttributeValue(e,t,r){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach(s=>{s.textContent="",s&&t in s&&(s[t]=r)})}}class Xi{constructor(){this._boundedEvents=[]}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,r,n,s=""){const a=Array.isArray(t)?t:[t];if(e!=null&&e.forEach)e.forEach(o=>{for(const c of a)o.addEventListener(c,r,n),this._boundedEvents.push({element:o,eventName:c,listener:r,groupName:s})});else for(const o of a)e.addEventListener(o,r,n),this._boundedEvents.push({element:e,eventName:o,listener:r,groupName:s})}unbind(e,t,r){const n=Array.isArray(e)?e:[e],s=Array.isArray(t)?t:[t];for(const a of s)for(const o of n)typeof(o==null?void 0:o.removeEventListener)=="function"&&o.removeEventListener(a,r)}unbindByEventName(e,t){const r=this._boundedEvents.find(n=>n.element===e&&n.eventName===t);r&&this.unbind(r.element,r.eventName,r.listener)}unbindAll(e){if(e){const t=Array.isArray(e)?e:[e];for(let r=this._boundedEvents.length-1;r>=0;--r){const n=this._boundedEvents[r];if(t.some(s=>s===n.groupName)){const{element:s,eventName:a,listener:o}=n;this.unbind(s,a,o),this._boundedEvents.splice(r,1)}}}else for(;this._boundedEvents.length>0;){const t=this._boundedEvents.pop(),{element:r,eventName:n,listener:s}=t;this.unbind(r,n,s)}}}function jm(i,e){const t=e.fetch;t&&(e.fetch=(r,n,s,a)=>{i.classList.add("slick-autocomplete-loading");const o=n;t(r,h=>{o(h),i.classList.remove("slick-autocomplete-loading")},s,a)})}/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Qm,setPrototypeOf:D0,isFrozen:kE,getPrototypeOf:OE,getOwnPropertyDescriptor:IE}=Object;let{freeze:Ir,seal:vn,create:id}=Object,{apply:rd,construct:nd}=typeof Reflect<"u"&&Reflect;Ir||(Ir=function(e){return e});vn||(vn=function(e){return e});rd||(rd=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),s=2;s<r;s++)n[s-2]=arguments[s];return e.apply(t,n)});nd||(nd=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new e(...r)});const Kl=Rr(Array.prototype.forEach),RE=Rr(Array.prototype.lastIndexOf),F0=Rr(Array.prototype.pop),bo=Rr(Array.prototype.push),DE=Rr(Array.prototype.splice),Sc=Rr(String.prototype.toLowerCase),tu=Rr(String.prototype.toString),iu=Rr(String.prototype.match),To=Rr(String.prototype.replace),FE=Rr(String.prototype.indexOf),PE=Rr(String.prototype.trim),An=Rr(Object.prototype.hasOwnProperty),yr=Rr(RegExp.prototype.test),Ao=NE(TypeError);function Rr(i){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return rd(i,e,r)}}function NE(i){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return nd(i,t)}}function It(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Sc;D0&&D0(i,null);let r=e.length;for(;r--;){let n=e[r];if(typeof n=="string"){const s=t(n);s!==n&&(kE(e)||(e[r]=s),n=s)}i[n]=!0}return i}function ME(i){for(let e=0;e<i.length;e++)An(i,e)||(i[e]=null);return i}function Vn(i){const e=id(null);for(const[t,r]of Qm(i))An(i,t)&&(Array.isArray(r)?e[t]=ME(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=Vn(r):e[t]=r);return e}function ko(i,e){for(;i!==null;){const r=IE(i,e);if(r){if(r.get)return Rr(r.get);if(typeof r.value=="function")return Rr(r.value)}i=OE(i)}function t(){return null}return t}const P0=Ir(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ru=Ir(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),nu=Ir(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),LE=Ir(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),su=Ir(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),BE=Ir(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N0=Ir(["#text"]),M0=Ir(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),au=Ir(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),L0=Ir(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),jl=Ir(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),HE=vn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),VE=vn(/<%[\w\W]*|[\w\W]*%>/gm),UE=vn(/\$\{[\w\W]*/gm),WE=vn(/^data-[\-\w.\u00B7-\uFFFF]+$/),zE=vn(/^aria-[\-\w]+$/),Zm=vn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),GE=vn(/^(?:\w+script|data):/i),$E=vn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Jm=vn(/^html$/i),YE=vn(/^[a-z][.\w]*(-[.\w]+)+$/i);var B0=Object.freeze({__proto__:null,ARIA_ATTR:zE,ATTR_WHITESPACE:$E,CUSTOM_ELEMENT:YE,DATA_ATTR:WE,DOCTYPE_NAME:Jm,ERB_EXPR:VE,IS_ALLOWED_URI:Zm,IS_SCRIPT_OR_DATA:GE,MUSTACHE_EXPR:HE,TMPLIT_EXPR:UE});const Oo={element:1,text:3,progressingInstruction:7,comment:8,document:9},XE=function(){return typeof window>"u"?null:window},qE=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(r=t.getAttribute(n));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},H0=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function eg(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:XE();const e=J=>eg(J);if(e.version="3.3.1",e.removed=[],!i||!i.document||i.document.nodeType!==Oo.document||!i.Element)return e.isSupported=!1,e;let{document:t}=i;const r=t,n=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:o,Element:c,NodeFilter:h,NamedNodeMap:l=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:u,DOMParser:d,trustedTypes:f}=i,p=c.prototype,m=ko(p,"cloneNode"),v=ko(p,"remove"),_=ko(p,"nextSibling"),x=ko(p,"childNodes"),E=ko(p,"parentNode");if(typeof a=="function"){const J=t.createElement("template");J.content&&J.content.ownerDocument&&(t=J.content.ownerDocument)}let C,y="";const{implementation:b,createNodeIterator:T,createDocumentFragment:R,getElementsByTagName:O}=t,{importNode:W}=r;let G=H0();e.isSupported=typeof Qm=="function"&&typeof E=="function"&&b&&b.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Q,ERB_EXPR:ne,TMPLIT_EXPR:xe,DATA_ATTR:Ce,ARIA_ATTR:Fe,IS_SCRIPT_OR_DATA:ke,ATTR_WHITESPACE:Ze,CUSTOM_ELEMENT:ie}=B0;let{IS_ALLOWED_URI:Ee}=B0,Pe=null;const U=It({},[...P0,...ru,...nu,...su,...N0]);let Z=null;const q=It({},[...M0,...au,...L0,...jl]);let X=Object.seal(id(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),de=null,Ie=null;const we=Object.seal(id(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Re=!0,be=!0,ue=!1,M=!0,it=!1,et=!0,he=!1,Qe=!1,Te=!1,dt=!1,wt=!1,Gt=!1,Ri=!0,or=!1;const lr="user-content-";let ni=!0,$t=!1,He={},Di=null;const Nt=It({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Li=null;const vt=It({},["audio","video","img","source","image","track"]);let rt=null;const fi=It({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),_t="http://www.w3.org/1998/Math/MathML",Wt="http://www.w3.org/2000/svg",Et="http://www.w3.org/1999/xhtml";let vi=Et,Xt=!1,Bi=null;const qi=It({},[_t,Wt,Et],tu);let Ki=It({},["mi","mo","mn","ms","mtext"]),Zi=It({},["annotation-xml"]);const qs=It({},["title","style","font","a","script"]);let ir=null;const F=["application/xhtml+xml","text/html"],V="text/html";let ee=null,fe=null;const Me=t.createElement("form"),Ge=function(P){return P instanceof RegExp||P instanceof Function},lt=function(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(fe&&fe===P)){if((!P||typeof P!="object")&&(P={}),P=Vn(P),ir=F.indexOf(P.PARSER_MEDIA_TYPE)===-1?V:P.PARSER_MEDIA_TYPE,ee=ir==="application/xhtml+xml"?tu:Sc,Pe=An(P,"ALLOWED_TAGS")?It({},P.ALLOWED_TAGS,ee):U,Z=An(P,"ALLOWED_ATTR")?It({},P.ALLOWED_ATTR,ee):q,Bi=An(P,"ALLOWED_NAMESPACES")?It({},P.ALLOWED_NAMESPACES,tu):qi,rt=An(P,"ADD_URI_SAFE_ATTR")?It(Vn(fi),P.ADD_URI_SAFE_ATTR,ee):fi,Li=An(P,"ADD_DATA_URI_TAGS")?It(Vn(vt),P.ADD_DATA_URI_TAGS,ee):vt,Di=An(P,"FORBID_CONTENTS")?It({},P.FORBID_CONTENTS,ee):Nt,de=An(P,"FORBID_TAGS")?It({},P.FORBID_TAGS,ee):Vn({}),Ie=An(P,"FORBID_ATTR")?It({},P.FORBID_ATTR,ee):Vn({}),He=An(P,"USE_PROFILES")?P.USE_PROFILES:!1,Re=P.ALLOW_ARIA_ATTR!==!1,be=P.ALLOW_DATA_ATTR!==!1,ue=P.ALLOW_UNKNOWN_PROTOCOLS||!1,M=P.ALLOW_SELF_CLOSE_IN_ATTR!==!1,it=P.SAFE_FOR_TEMPLATES||!1,et=P.SAFE_FOR_XML!==!1,he=P.WHOLE_DOCUMENT||!1,dt=P.RETURN_DOM||!1,wt=P.RETURN_DOM_FRAGMENT||!1,Gt=P.RETURN_TRUSTED_TYPE||!1,Te=P.FORCE_BODY||!1,Ri=P.SANITIZE_DOM!==!1,or=P.SANITIZE_NAMED_PROPS||!1,ni=P.KEEP_CONTENT!==!1,$t=P.IN_PLACE||!1,Ee=P.ALLOWED_URI_REGEXP||Zm,vi=P.NAMESPACE||Et,Ki=P.MATHML_TEXT_INTEGRATION_POINTS||Ki,Zi=P.HTML_INTEGRATION_POINTS||Zi,X=P.CUSTOM_ELEMENT_HANDLING||{},P.CUSTOM_ELEMENT_HANDLING&&Ge(P.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(X.tagNameCheck=P.CUSTOM_ELEMENT_HANDLING.tagNameCheck),P.CUSTOM_ELEMENT_HANDLING&&Ge(P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(X.attributeNameCheck=P.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),P.CUSTOM_ELEMENT_HANDLING&&typeof P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(X.allowCustomizedBuiltInElements=P.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),it&&(be=!1),wt&&(dt=!0),He&&(Pe=It({},N0),Z=[],He.html===!0&&(It(Pe,P0),It(Z,M0)),He.svg===!0&&(It(Pe,ru),It(Z,au),It(Z,jl)),He.svgFilters===!0&&(It(Pe,nu),It(Z,au),It(Z,jl)),He.mathMl===!0&&(It(Pe,su),It(Z,L0),It(Z,jl))),P.ADD_TAGS&&(typeof P.ADD_TAGS=="function"?we.tagCheck=P.ADD_TAGS:(Pe===U&&(Pe=Vn(Pe)),It(Pe,P.ADD_TAGS,ee))),P.ADD_ATTR&&(typeof P.ADD_ATTR=="function"?we.attributeCheck=P.ADD_ATTR:(Z===q&&(Z=Vn(Z)),It(Z,P.ADD_ATTR,ee))),P.ADD_URI_SAFE_ATTR&&It(rt,P.ADD_URI_SAFE_ATTR,ee),P.FORBID_CONTENTS&&(Di===Nt&&(Di=Vn(Di)),It(Di,P.FORBID_CONTENTS,ee)),P.ADD_FORBID_CONTENTS&&(Di===Nt&&(Di=Vn(Di)),It(Di,P.ADD_FORBID_CONTENTS,ee)),ni&&(Pe["#text"]=!0),he&&It(Pe,["html","head","body"]),Pe.table&&(It(Pe,["tbody"]),delete de.tbody),P.TRUSTED_TYPES_POLICY){if(typeof P.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ao('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof P.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ao('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=P.TRUSTED_TYPES_POLICY,y=C.createHTML("")}else C===void 0&&(C=qE(f,n)),C!==null&&typeof y=="string"&&(y=C.createHTML(""));Ir&&Ir(P),fe=P}},qe=It({},[...ru,...nu,...LE]),ot=It({},[...su,...BE]),Ke=function(P){let re=E(P);(!re||!re.tagName)&&(re={namespaceURI:vi,tagName:"template"});const pe=Sc(P.tagName),Se=Sc(re.tagName);return Bi[P.namespaceURI]?P.namespaceURI===Wt?re.namespaceURI===Et?pe==="svg":re.namespaceURI===_t?pe==="svg"&&(Se==="annotation-xml"||Ki[Se]):!!qe[pe]:P.namespaceURI===_t?re.namespaceURI===Et?pe==="math":re.namespaceURI===Wt?pe==="math"&&Zi[Se]:!!ot[pe]:P.namespaceURI===Et?re.namespaceURI===Wt&&!Zi[Se]||re.namespaceURI===_t&&!Ki[Se]?!1:!ot[pe]&&(qs[pe]||!qe[pe]):!!(ir==="application/xhtml+xml"&&Bi[P.namespaceURI]):!1},je=function(P){bo(e.removed,{element:P});try{E(P).removeChild(P)}catch{v(P)}},bt=function(P,re){try{bo(e.removed,{attribute:re.getAttributeNode(P),from:re})}catch{bo(e.removed,{attribute:null,from:re})}if(re.removeAttribute(P),P==="is")if(dt||wt)try{je(re)}catch{}else try{re.setAttribute(P,"")}catch{}},k=function(P){let re=null,pe=null;if(Te)P="<remove></remove>"+P;else{const Le=iu(P,/^[\r\n\t ]+/);pe=Le&&Le[0]}ir==="application/xhtml+xml"&&vi===Et&&(P='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+P+"</body></html>");const Se=C?C.createHTML(P):P;if(vi===Et)try{re=new d().parseFromString(Se,ir)}catch{}if(!re||!re.documentElement){re=b.createDocument(vi,"template",null);try{re.documentElement.innerHTML=Xt?y:Se}catch{}}const Ne=re.body||re.documentElement;return P&&pe&&Ne.insertBefore(t.createTextNode(pe),Ne.childNodes[0]||null),vi===Et?O.call(re,he?"html":"body")[0]:he?re.documentElement:Ne},L=function(P){return T.call(P.ownerDocument||P,P,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},D=function(P){return P instanceof u&&(typeof P.nodeName!="string"||typeof P.textContent!="string"||typeof P.removeChild!="function"||!(P.attributes instanceof l)||typeof P.removeAttribute!="function"||typeof P.setAttribute!="function"||typeof P.namespaceURI!="string"||typeof P.insertBefore!="function"||typeof P.hasChildNodes!="function")},N=function(P){return typeof o=="function"&&P instanceof o};function H(J,P,re){Kl(J,pe=>{pe.call(e,P,re,fe)})}const z=function(P){let re=null;if(H(G.beforeSanitizeElements,P,null),D(P))return je(P),!0;const pe=ee(P.nodeName);if(H(G.uponSanitizeElement,P,{tagName:pe,allowedTags:Pe}),et&&P.hasChildNodes()&&!N(P.firstElementChild)&&yr(/<[/\w!]/g,P.innerHTML)&&yr(/<[/\w!]/g,P.textContent)||P.nodeType===Oo.progressingInstruction||et&&P.nodeType===Oo.comment&&yr(/<[/\w]/g,P.data))return je(P),!0;if(!(we.tagCheck instanceof Function&&we.tagCheck(pe))&&(!Pe[pe]||de[pe])){if(!de[pe]&&ge(pe)&&(X.tagNameCheck instanceof RegExp&&yr(X.tagNameCheck,pe)||X.tagNameCheck instanceof Function&&X.tagNameCheck(pe)))return!1;if(ni&&!Di[pe]){const Se=E(P)||P.parentNode,Ne=x(P)||P.childNodes;if(Ne&&Se){const Le=Ne.length;for(let Ct=Le-1;Ct>=0;--Ct){const Ft=m(Ne[Ct],!0);Ft.__removalCount=(P.__removalCount||0)+1,Se.insertBefore(Ft,_(P))}}}return je(P),!0}return P instanceof c&&!Ke(P)||(pe==="noscript"||pe==="noembed"||pe==="noframes")&&yr(/<\/no(script|embed|frames)/i,P.innerHTML)?(je(P),!0):(it&&P.nodeType===Oo.text&&(re=P.textContent,Kl([Q,ne,xe],Se=>{re=To(re,Se," ")}),P.textContent!==re&&(bo(e.removed,{element:P.cloneNode()}),P.textContent=re)),H(G.afterSanitizeElements,P,null),!1)},se=function(P,re,pe){if(Ri&&(re==="id"||re==="name")&&(pe in t||pe in Me))return!1;if(!(be&&!Ie[re]&&yr(Ce,re))){if(!(Re&&yr(Fe,re))){if(!(we.attributeCheck instanceof Function&&we.attributeCheck(re,P))){if(!Z[re]||Ie[re]){if(!(ge(P)&&(X.tagNameCheck instanceof RegExp&&yr(X.tagNameCheck,P)||X.tagNameCheck instanceof Function&&X.tagNameCheck(P))&&(X.attributeNameCheck instanceof RegExp&&yr(X.attributeNameCheck,re)||X.attributeNameCheck instanceof Function&&X.attributeNameCheck(re,P))||re==="is"&&X.allowCustomizedBuiltInElements&&(X.tagNameCheck instanceof RegExp&&yr(X.tagNameCheck,pe)||X.tagNameCheck instanceof Function&&X.tagNameCheck(pe))))return!1}else if(!rt[re]){if(!yr(Ee,To(pe,Ze,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&P!=="script"&&FE(pe,"data:")===0&&Li[P])){if(!(ue&&!yr(ke,To(pe,Ze,"")))){if(pe)return!1}}}}}}}return!0},ge=function(P){return P!=="annotation-xml"&&iu(P,ie)},ae=function(P){H(G.beforeSanitizeAttributes,P,null);const{attributes:re}=P;if(!re||D(P))return;const pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Z,forceKeepAttr:void 0};let Se=re.length;for(;Se--;){const Ne=re[Se],{name:Le,namespaceURI:Ct,value:Ft}=Ne,si=ee(Le),Dr=Ft;let Vt=Le==="value"?Dr:PE(Dr);if(pe.attrName=si,pe.attrValue=Vt,pe.keepAttr=!0,pe.forceKeepAttr=void 0,H(G.uponSanitizeAttribute,P,pe),Vt=pe.attrValue,or&&(si==="id"||si==="name")&&(bt(Le,P),Vt=lr+Vt),et&&yr(/((--!?|])>)|<\/(style|title|textarea)/i,Vt)){bt(Le,P);continue}if(si==="attributename"&&iu(Vt,"href")){bt(Le,P);continue}if(pe.forceKeepAttr)continue;if(!pe.keepAttr){bt(Le,P);continue}if(!M&&yr(/\/>/i,Vt)){bt(Le,P);continue}it&&Kl([Q,ne,xe],Hi=>{Vt=To(Vt,Hi," ")});const an=ee(P.nodeName);if(!se(an,si,Vt)){bt(Le,P);continue}if(C&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Ct)switch(f.getAttributeType(an,si)){case"TrustedHTML":{Vt=C.createHTML(Vt);break}case"TrustedScriptURL":{Vt=C.createScriptURL(Vt);break}}if(Vt!==Dr)try{Ct?P.setAttributeNS(Ct,Le,Vt):P.setAttribute(Le,Vt),D(P)?je(P):F0(e.removed)}catch{bt(Le,P)}}H(G.afterSanitizeAttributes,P,null)},ce=function J(P){let re=null;const pe=L(P);for(H(G.beforeSanitizeShadowDOM,P,null);re=pe.nextNode();)H(G.uponSanitizeShadowNode,re,null),z(re),ae(re),re.content instanceof s&&J(re.content);H(G.afterSanitizeShadowDOM,P,null)};return e.sanitize=function(J){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=null,pe=null,Se=null,Ne=null;if(Xt=!J,Xt&&(J="<!-->"),typeof J!="string"&&!N(J))if(typeof J.toString=="function"){if(J=J.toString(),typeof J!="string")throw Ao("dirty is not a string, aborting")}else throw Ao("toString is not a function");if(!e.isSupported)return J;if(Qe||lt(P),e.removed=[],typeof J=="string"&&($t=!1),$t){if(J.nodeName){const Ft=ee(J.nodeName);if(!Pe[Ft]||de[Ft])throw Ao("root node is forbidden and cannot be sanitized in-place")}}else if(J instanceof o)re=k("<!---->"),pe=re.ownerDocument.importNode(J,!0),pe.nodeType===Oo.element&&pe.nodeName==="BODY"||pe.nodeName==="HTML"?re=pe:re.appendChild(pe);else{if(!dt&&!it&&!he&&J.indexOf("<")===-1)return C&&Gt?C.createHTML(J):J;if(re=k(J),!re)return dt?null:Gt?y:""}re&&Te&&je(re.firstChild);const Le=L($t?J:re);for(;Se=Le.nextNode();)z(Se),ae(Se),Se.content instanceof s&&ce(Se.content);if($t)return J;if(dt){if(wt)for(Ne=R.call(re.ownerDocument);re.firstChild;)Ne.appendChild(re.firstChild);else Ne=re;return(Z.shadowroot||Z.shadowrootmode)&&(Ne=W.call(r,Ne,!0)),Ne}let Ct=he?re.outerHTML:re.innerHTML;return he&&Pe["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&yr(Jm,re.ownerDocument.doctype.name)&&(Ct="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+Ct),it&&Kl([Q,ne,xe],Ft=>{Ct=To(Ct,Ft," ")}),C&&Gt?C.createHTML(Ct):Ct},e.setConfig=function(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};lt(J),Qe=!0},e.clearConfig=function(){fe=null,Qe=!1},e.isValidAttribute=function(J,P,re){fe||lt({});const pe=ee(J),Se=ee(P);return se(pe,Se,re)},e.addHook=function(J,P){typeof P=="function"&&bo(G[J],P)},e.removeHook=function(J,P){if(P!==void 0){const re=RE(G[J],P);return re===-1?void 0:DE(G[J],re,1)[0]}return F0(G[J])},e.removeHooks=function(J){G[J]=[]},e.removeAllHooks=function(){G=H0()},e}var Is=eg();function tg(i,e,t,r,n=!1,s,a){var O,W,G,Q,ne;const o=(t==null?void 0:t.id)??"",c=r.getOptions(),h=(i==="editor"?t==null?void 0:t.internalColumnEditor:t==null?void 0:t.filter)??{},l=(h==null?void 0:h.collectionOptions)??{},u=(l==null?void 0:l.separatorBetweenTextLabels)??"",d=(h==null?void 0:h.enableTranslateLabel)??!1,f=(c==null?void 0:c.enableTranslate)??!1,p=(h==null?void 0:h.enableRenderHtml)??!1,m=(c==null?void 0:c.sanitizerOptions)??{},v=((O=h==null?void 0:h.customStructure)==null?void 0:O.label)??"label",_=((W=h==null?void 0:h.customStructure)==null?void 0:W.labelPrefix)??"labelPrefix",x=((G=h==null?void 0:h.customStructure)==null?void 0:G.labelSuffix)??"labelSuffix",E=((Q=h==null?void 0:h.customStructure)==null?void 0:Q.optionLabel)??"value",C=((ne=h==null?void 0:h.customStructure)==null?void 0:ne.value)??"value",y=K("select",{className:"ms-filter search-filter"}),b=i==="filter"?["search-filter",`filter-${o}`]:["select-editor",`editor-${o}`];y.classList.add(...b),y.multiple=n;const T=[];let R=!1;return Array.isArray(e)&&(e.every(xe=>typeof xe=="number"||typeof xe=="string")?e.forEach(xe=>{const Ce={text:xe,value:xe};i==="filter"&&Array.isArray(a)&&(Ce.selected=a.findIndex(Fe=>Fe===xe)>=0),T.push(Ce),(Ce.selected&&n||Ce.selected&&!n&&xe!=="")&&(R=!0)}):e.forEach(xe=>{if(xe===void 0||typeof xe=="object"&&xe[v]===void 0&&xe.labelKey===void 0)throw new Error("[Slickgrid-Universal] Select Filter/Editor collection with value/label (or value/labelKey when using Locale) is required to populate the Select list, for example:: { filter: model: Filters.multipleSelect, collection: [ { value: '1', label: 'One' } ]')");const Ce=xe.labelKey||xe[v],Fe=(xe.labelKey||d&&s)&&Ce&&f?s==null?void 0:s.translate(Ce||" "):Ce;let ke=xe[_]||"",Ze=xe[x]||"",ie=xe.hasOwnProperty(E)?xe[E]:"";ie!=null&&ie.toString&&(ie=ie.toString().replace(/\"/g,"'")),ke=d&&s&&ke&&typeof ke=="string"?s.translate(ke||" "):ke,Ze=d&&s&&Ze&&typeof Ze=="string"?s.translate(Ze||" "):Ze,ie=d&&s&&ie&&typeof ie=="string"?s.translate(ie||" "):ie;let Pe=[ke,typeof Fe=="string"||typeof Fe=="number"?Fe.toString():Fe,Ze].filter(q=>q).join(u);const U={text:"",value:""};p&&(Pe=fa(c,Pe,m)),U.text=Pe;let Z=xe[C];Z==null&&(Z=""),i==="filter"&&Array.isArray(a)&&(U.selected=a.findIndex(q=>`${q}`==`${xe[C]}`)>=0),U.value=`${Z??""}`,T.push(U),(U.selected&&n||U.selected&&!n&&xe[C]!=="")&&(R=!0)})),{selectElement:y,dataCollection:T,hasFoundSearchTerm:R}}function fa(i,e,t){let r=e;return typeof(i==null?void 0:i.sanitizer)=="function"?r=i.sanitizer(e||""):typeof(Is==null?void 0:Is.sanitize)=="function"&&(r=(Is.sanitize(e||"",t||{ADD_ATTR:["level"],RETURN_TRUSTED_TYPE:!0})||"").toString()),r}function Nd(i,e){const t=K("select",{className:"form-control"});for(const r of i){const n=document.createElement("option");n.value=r.operator,e.applyHtmlCode(n,`${zm(r.operatorAlt||r.operator,3)}${r.descAlt||r.desc}`),t.appendChild(n)}return t}function KE(i,e,t){const r=(e==null?void 0:e.filter)??{},n=(r==null?void 0:r.collectionOptions)??{};if(n&&n.collectionInsideObjectProperty){const s=n.collectionInsideObjectProperty;i=Ti(i,s)}if(!Array.isArray(i))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');r.collection=i,t(i)}async function ig(i,e,t,r,n){const s=(e==null?void 0:e.filter)??{},a=(s==null?void 0:s.collectionOptions)??{};let o=null;if(i){const c=(r==null?void 0:r.isObservable(i))??!1;c&&r&&(o=await Nm(r,i));const h=await i;if(Array.isArray(h)?o=h:(h==null?void 0:h.status)>=200&&h.status<300&&typeof h.json=="function"?o=await h.json():h&&h.content&&(o=h.content),!Array.isArray(o)&&(a!=null&&a.collectionInsideObjectProperty)){const l=o||h,u=a.collectionInsideObjectProperty;o=Ti(l,u||"")}if(!Array.isArray(o))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');s.collection=o,t(o),c&&jE(e,t,r,n)}return o}function jE(i,e,t,r){const n=(i==null?void 0:i.filter)??{},s=t==null?void 0:t.createSubject();n.collectionAsync=s,r&&s&&r.push(s.subscribe(a=>KE(a,i,e)))}function mn(i,e,t,r,n){if(r!=null&&r.enableTranslate&&(n!=null&&n.translate)){const a=Kn(r);return n.translate(`${a}${i}`)}const s=r.locales||ye.locales;return(s==null?void 0:s[e])??t}function QE(i,e){const t=[{operator:"",desc:mn("CONTAINS","TEXT_CONTAINS","Contains",i,e)},{operator:"<>",desc:mn("NOT_CONTAINS","TEXT_NOT_CONTAINS","Not Contains",i,e)},{operator:"=",desc:mn("EQUALS","TEXT_EQUALS","Equals",i,e)},{operator:"!=",desc:mn("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",i,e)},{operator:"a*",desc:mn("STARTS_WITH","TEXT_STARTS_WITH","Starts with",i,e)},{operator:"*z",desc:mn("ENDS_WITH","TEXT_ENDS_WITH","Ends with",i,e)}];return rg(i,t,"text"),t}function Md(i,e){const t=[{operator:"",desc:""},{operator:"=",desc:mn("EQUAL_TO","TEXT_EQUAL_TO","Equal to",i,e)},{operator:"<",desc:mn("LESS_THAN","TEXT_LESS_THAN","Less than",i,e)},{operator:"<=",desc:mn("LESS_THAN_OR_EQUAL_TO","TEXT_LESS_THAN_OR_EQUAL_TO","Less than or equal to",i,e)},{operator:">",desc:mn("GREATER_THAN","TEXT_GREATER_THAN","Greater than",i,e)},{operator:">=",desc:mn("GREATER_THAN_OR_EQUAL_TO","TEXT_GREATER_THAN_OR_EQUAL_TO","Greater than or equal to",i,e)},{operator:"<>",desc:mn("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",i,e)}];return rg(i,t,"numeric"),t}function rg(i,e,t){if(i.compoundOperatorAltTexts){for(const r of e)if(i.compoundOperatorAltTexts.hasOwnProperty(t)){const n=i.compoundOperatorAltTexts[t][r.operator];r.operatorAlt=(n==null?void 0:n.operatorAlt)||"",r.descAlt=(n==null?void 0:n.descAlt)||""}}}class ZE{constructor(e,t,r){this.translaterService=e,this.collectionService=t,this.rxjs=r,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.searchTerms=[],this.isFilled=!1,this.isItemSelected=!1,this.valueName="label",this.enableTranslateLabel=!1,this.subscriptions=[],this._bindEventService=new Xi}get autocompleterOptions(){return this._autocompleterOptions||{}}get collectionOptions(){var e,t;return((t=(e=this.columnDef)==null?void 0:e.filter)==null?void 0:t.collectionOptions)??{}}get collection(){return this._collection}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)||{}}get filterDomElement(){return this._filterElm}get filterOptions(){var e;return((e=this.columnFilter)==null?void 0:e.filterOptions)||{}}get customStructure(){var r,n,s,a,o;let e=(r=this.columnFilter)==null?void 0:r.customStructure;const t=((n=this.columnFilter)==null?void 0:n.type)??((s=this.columnDef)==null?void 0:s.type);return!e&&t===Y.object&&((a=this.columnDef)!=null&&a.dataKey)&&((o=this.columnDef)!=null&&o.labelKey)&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get defaultOperator(){return tt.equal}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get instance(){return this._instance}get operator(){var e;return((e=this.columnFilter)==null?void 0:e.operator)??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){var r,n,s,a,o,c;if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync&&!this.columnFilter.filterOptions)throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") for the AutoComplete Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.autocompleter, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }`);this.enableTranslateLabel=((r=this.columnFilter)==null?void 0:r.enableTranslateLabel)??!1,this.labelName=((n=this.customStructure)==null?void 0:n.label)??"label",this.valueName=((s=this.customStructure)==null?void 0:s.value)??"value",this.labelPrefixName=((a=this.customStructure)==null?void 0:a.labelPrefix)??"labelPrefix",this.labelSuffixName=((o=this.customStructure)==null?void 0:o.labelSuffix)??"labelSuffix",this._locales=((c=this.gridOptions)==null?void 0:c.locales)??ye.locales;const t=this.columnFilter.collection;return this._collection=t,this.renderDomElement(t),new Promise(async(h,l)=>{try{const u=this.columnFilter.collectionAsync;let d;u&&!this.columnFilter.collection?(d=ig(u,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),h(d)):(d=t,h(t)),(u||this.columnFilter.enableCollectionWatch)&&(await(d??u),this.watchCollectionChanges())}catch(u){l(u)}})}clear(e=!0){this._filterElm&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._filterElm.value="",this._filterElm.dispatchEvent(new CustomEvent("input")),this._filterElm.classList.remove("filled"))}destroy(){var e,t,r;typeof((e=this._instance)==null?void 0:e.destroy)=="function"&&this._instance.destroy(),this._filterElm,(r=(t=this._filterElm)==null?void 0:t.remove)==null||r.call(t),this._collection=void 0,this._bindEventService.unbindAll(),ph(this.subscriptions)}getValues(){var e;return(e=this._filterElm)==null?void 0:e.value}setValues(e,t){var n;e&&this._filterElm&&(this._filterElm.value=e);const r=this.getValues()!==""?"add":"remove";(n=this._filterElm)==null||n.classList[r]("filled"),this.operator=t||this.defaultOperator}filterCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const r=this.columnFilter.collectionFilterBy,n=this.columnFilter.collectionOptions&&this.columnFilter.collectionOptions.filterResultAfterEachPass||null;t=this.collectionService.filterCollection(t,r,n)}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const r=this.columnFilter.collectionSortBy;t=this.collectionService.sortCollection(this.columnDef,t,r,this.enableTranslateLabel)}return t}watchCollectionChanges(){var e;(e=this.columnFilter)!=null&&e.collection&&(Jo(this.columnFilter.collection,t=>{this.renderDomElement(this.columnFilter.collection||t||[])}),Od(this.columnFilter,"collection",t=>{this.renderDomElement(t||[]),this.columnFilter.collection&&Jo(this.columnFilter.collection,r=>{this.renderDomElement(this.columnFilter.collection||r||[])})}))}renderDomElement(e){var n;if(!Array.isArray(e)&&((n=this.collectionOptions)!=null&&n.collectionInsideObjectProperty)){const s=this.collectionOptions.collectionInsideObjectProperty;e=Ti(e,s||"")}let t=e;t&&(t=this.filterCollection(t),t=this.sortCollection(t));const r=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this._collection=t,this._filterElm=this.createFilterElement(t,r),this._bindEventService.bind(this._filterElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._filterElm,"blur",()=>{this.isItemSelected||this.clear()})}createFilterElement(e,t){var o,c,h,l,u,d,f,p,m,v;this._collection=e;const r=((o=this.columnDef)==null?void 0:o.id)??"";Rt(this.filterContainerElm);let n=((c=this.gridOptions)==null?void 0:c.defaultFilterPlaceholder)??"";(h=this.columnFilter)!=null&&h.placeholder&&(n=this.columnFilter.placeholder),this._filterElm=K("input",{type:"text",ariaLabel:((l=this.columnFilter)==null?void 0:l.ariaLabel)??`${rn(r+"")} Search Filter`,autocomplete:"off",ariaAutoComplete:"none",placeholder:n,className:`form-control search-filter filter-${r} slick-autocomplete-container`,value:t??"",dataset:{columnid:`${r}`}});const s=t;Array.isArray(e)&&(e.every(_=>bl(_))?e=e.map(_=>({label:_,value:_})):e=e.map(_=>({label:_==null?void 0:_[this.labelName],value:_==null?void 0:_[this.valueName],labelPrefix:(_==null?void 0:_[this.labelPrefixName])??"",labelSuffix:(_==null?void 0:_[this.labelSuffixName])??""}))),this._autocompleterOptions={input:this._filterElm,debounceWaitMs:200,className:`slick-autocomplete ${((u=this.filterOptions)==null?void 0:u.className)??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&((d=this.translaterService)!=null&&d.translate)?this.translaterService.translate("NO_ELEMENTS_FOUND"):((f=this._locales)==null?void 0:f.TEXT_NO_ELEMENTS_FOUND)??"No elements found",customize:(_,x,E)=>{E.style.width=""},onSelect:_=>{this.isItemSelected=!0,this.handleSelect(_)},...this.filterOptions},(p=this._autocompleterOptions.renderItem)!=null&&p.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${sl(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=((m=this._autocompleterOptions.render)==null?void 0:m.bind(this))??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),(v=this.filterOptions)!=null&&v.fetch?(jm(this._filterElm,this._autocompleterOptions),this._instance=Nc(this._autocompleterOptions)):this._instance=Nc({...this._autocompleterOptions,fetch:(_,x)=>{e&&x(e.filter(E=>((typeof E=="string"?E:E==null?void 0:E.label)||"").toLowerCase().includes(_.toLowerCase())))}}),this._filterElm.value=s??"";const a=K("div",{className:"autocomplete-filter-container"});return a.appendChild(this._filterElm),a.appendChild(K("span")),t&&this._filterElm.classList.add("filled"),this.filterContainerElm.appendChild(a),this.filterContainerElm.appendChild(document.createElement("span")),this._filterElm}handleSelect(e){var t,r,n;if(e!==void 0){const a=((r=(t=this.columnFilter)==null?void 0:t.filterOptions)==null?void 0:r.renderItem)??!1,o=typeof e=="string"?e:a?e[this.labelName]:e.label;let c=typeof e=="string"?e:a?e[this.valueName]:e.value;c=this.trimWhitespaceWhenEnabled(c);const h=c===""?"remove":"add";(n=this._filterElm)==null||n.classList[h]("filled"),this.setValues(o),this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:[c],shouldTriggerQuery:this._shouldTriggerQuery}),this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}return!1}handleOnInputChange(e){var n,s,a;let t=((n=e==null?void 0:e.target)==null?void 0:n.value)??"";const r=this.filterOptions.triggerOnEveryKeyStroke??!1;if(t=this.trimWhitespaceWhenEnabled(t),this._clearFilterTriggered||t===""||r){const o={columnDef:this.columnDef,shouldTriggerQuery:this._shouldTriggerQuery};this._clearFilterTriggered?o.clearFilterTriggered=this._clearFilterTriggered:(o.operator=this.operator,o.searchTerms=[t]),t!==""?(this.isItemSelected=!0,(s=this._filterElm)==null||s.classList.add("filled")):(this.isItemSelected=!1,(a=this._filterElm)==null||a.classList.remove("filled")),this.callback(e,o)}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}renderRegularItem(e){const t=typeof e=="string"?e:(e==null?void 0:e.label)??"";return K("div",{textContent:t||""})}renderCustomItem(e){var n,s;const t=((s=(n=this._autocompleterOptions)==null?void 0:n.renderItem)==null?void 0:s.templateCallback(e))??"",r=document.createElement("div");return this.grid.applyHtmlCode(r,t),r}renderCollectionItem(e){var h;const t=((h=this.columnFilter)==null?void 0:h.enableRenderHtml)??!1,r=e.labelPrefix||"",n=e.label||"",s=e.labelSuffix||"",a=r+n+s,o=fa(this.gridOptions,a)||"",c=document.createElement("div");return c[t?"innerHTML":"textContent"]=o,c}trimWhitespaceWhenEnabled(e){let t=e;const r=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;return typeof e=="string"&&r&&(t=e.trim()),t}}var ou=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],ja={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(i){return typeof console<"u"&&console.warn(i)},getWeek:function(i){var e=new Date(i.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},al={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(i){var e=i%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Mr=function(i,e){return e===void 0&&(e=2),("000"+i).slice(e*-1)},un=function(i){return i===!0?1:0};function V0(i,e){var t;return function(){var r=this,n=arguments;clearTimeout(t),t=setTimeout(function(){return i.apply(r,n)},e)}}var lu=function(i){return i instanceof Array?i:[i]};function Sr(i,e,t){if(t===!0)return i.classList.add(e);i.classList.remove(e)}function zt(i,e,t){var r=window.document.createElement(i);return e=e||"",t=t||"",r.className=e,t!==void 0&&(r.textContent=t),r}function Ql(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function ng(i,e){if(e(i))return i;if(i.parentNode)return ng(i.parentNode,e)}function Zl(i,e){var t=zt("div","numInputWrapper"),r=zt("input","numInput "+i),n=zt("span","arrowUp"),s=zt("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?r.type="number":(r.type="text",r.pattern="\\d*"),e!==void 0)for(var a in e)r.setAttribute(a,e[a]);return t.appendChild(r),t.appendChild(n),t.appendChild(s),t}function $r(i){try{if(typeof i.composedPath=="function"){var e=i.composedPath();return e[0]}return i.target}catch{return i.target}}var cu=function(){},Mc=function(i,e,t){return t.months[e?"shorthand":"longhand"][i]},JE={D:cu,F:function(i,e,t){i.setMonth(t.months.longhand.indexOf(e))},G:function(i,e){i.setHours((i.getHours()>=12?12:0)+parseFloat(e))},H:function(i,e){i.setHours(parseFloat(e))},J:function(i,e){i.setDate(parseFloat(e))},K:function(i,e,t){i.setHours(i.getHours()%12+12*un(new RegExp(t.amPM[1],"i").test(e)))},M:function(i,e,t){i.setMonth(t.months.shorthand.indexOf(e))},S:function(i,e){i.setSeconds(parseFloat(e))},U:function(i,e){return new Date(parseFloat(e)*1e3)},W:function(i,e,t){var r=parseInt(e),n=new Date(i.getFullYear(),0,2+(r-1)*7,0,0,0,0);return n.setDate(n.getDate()-n.getDay()+t.firstDayOfWeek),n},Y:function(i,e){i.setFullYear(parseFloat(e))},Z:function(i,e){return new Date(e)},d:function(i,e){i.setDate(parseFloat(e))},h:function(i,e){i.setHours((i.getHours()>=12?12:0)+parseFloat(e))},i:function(i,e){i.setMinutes(parseFloat(e))},j:function(i,e){i.setDate(parseFloat(e))},l:cu,m:function(i,e){i.setMonth(parseFloat(e)-1)},n:function(i,e){i.setMonth(parseFloat(e)-1)},s:function(i,e){i.setSeconds(parseFloat(e))},u:function(i,e){return new Date(parseFloat(e))},w:cu,y:function(i,e){i.setFullYear(2e3+parseFloat(e))}},ra={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},Ho={Z:function(i){return i.toISOString()},D:function(i,e,t){return e.weekdays.shorthand[Ho.w(i,e,t)]},F:function(i,e,t){return Mc(Ho.n(i,e,t)-1,!1,e)},G:function(i,e,t){return Mr(Ho.h(i,e,t))},H:function(i){return Mr(i.getHours())},J:function(i,e){return e.ordinal!==void 0?i.getDate()+e.ordinal(i.getDate()):i.getDate()},K:function(i,e){return e.amPM[un(i.getHours()>11)]},M:function(i,e){return Mc(i.getMonth(),!0,e)},S:function(i){return Mr(i.getSeconds())},U:function(i){return i.getTime()/1e3},W:function(i,e,t){return t.getWeek(i)},Y:function(i){return Mr(i.getFullYear(),4)},d:function(i){return Mr(i.getDate())},h:function(i){return i.getHours()%12?i.getHours()%12:12},i:function(i){return Mr(i.getMinutes())},j:function(i){return i.getDate()},l:function(i,e){return e.weekdays.longhand[i.getDay()]},m:function(i){return Mr(i.getMonth()+1)},n:function(i){return i.getMonth()+1},s:function(i){return i.getSeconds()},u:function(i){return i.getTime()},w:function(i){return i.getDay()},y:function(i){return String(i.getFullYear()).substring(2)}},sg=function(i){var e=i.config,t=e===void 0?ja:e,r=i.l10n,n=r===void 0?al:r,s=i.isMobile,a=s===void 0?!1:s;return function(o,c,h){var l=h||n;return t.formatDate!==void 0&&!a?t.formatDate(o,c,l):c.split("").map(function(u,d,f){return Ho[u]&&f[d-1]!=="\\"?Ho[u](o,l,t):u!=="\\"?u:""}).join("")}},sd=function(i){var e=i.config,t=e===void 0?ja:e,r=i.l10n,n=r===void 0?al:r;return function(s,a,o,c){if(!(s!==0&&!s)){var h=c||n,l,u=s;if(s instanceof Date)l=new Date(s.getTime());else if(typeof s!="string"&&s.toFixed!==void 0)l=new Date(s);else if(typeof s=="string"){var d=a||(t||ja).dateFormat,f=String(s).trim();if(f==="today")l=new Date,o=!0;else if(t&&t.parseDate)l=t.parseDate(s,d);else if(/Z$/.test(f)||/GMT$/.test(f))l=new Date(s);else{for(var p=void 0,m=[],v=0,_=0,x="";v<d.length;v++){var E=d[v],C=E==="\\",y=d[v-1]==="\\"||C;if(ra[E]&&!y){x+=ra[E];var b=new RegExp(x).exec(s);b&&(p=!0)&&m[E!=="Y"?"push":"unshift"]({fn:JE[E],val:b[++_]})}else C||(x+=".")}l=!t||!t.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),m.forEach(function(T){var R=T.fn,O=T.val;return l=R(l,O,h)||l}),l=p?l:void 0}}if(!(l instanceof Date&&!isNaN(l.getTime()))){t.errorHandler(new Error("Invalid date provided: "+u));return}return o===!0&&l.setHours(0,0,0,0),l}}};function Yr(i,e,t){return t===void 0&&(t=!0),t!==!1?new Date(i.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):i.getTime()-e.getTime()}var ex=function(i,e,t){return i>Math.min(e,t)&&i<Math.max(e,t)},hu=function(i,e,t){return i*3600+e*60+t},tx=function(i){var e=Math.floor(i/3600),t=(i-e*3600)/60;return[e,t,i-e*3600-t*60]},ix={DAY:864e5};function uu(i){var e=i.defaultHour,t=i.defaultMinute,r=i.defaultSeconds;if(i.minDate!==void 0){var n=i.minDate.getHours(),s=i.minDate.getMinutes(),a=i.minDate.getSeconds();e<n&&(e=n),e===n&&t<s&&(t=s),e===n&&t===s&&r<a&&(r=i.minDate.getSeconds())}if(i.maxDate!==void 0){var o=i.maxDate.getHours(),c=i.maxDate.getMinutes();e=Math.min(e,o),e===o&&(t=Math.min(c,t)),e===o&&t===c&&(r=i.maxDate.getSeconds())}return{hours:e,minutes:t,seconds:r}}typeof Object.assign!="function"&&(Object.assign=function(i){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(!i)throw TypeError("Cannot convert undefined or null to object");for(var r=function(o){o&&Object.keys(o).forEach(function(c){return i[c]=o[c]})},n=0,s=e;n<s.length;n++){var a=s[n];r(a)}return i});var dr=function(){return dr=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i},dr.apply(this,arguments)},U0=function(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var r=Array(i),n=0,e=0;e<t;e++)for(var s=arguments[e],a=0,o=s.length;a<o;a++,n++)r[n]=s[a];return r},rx=300;function nx(i,e){var t={config:dr(dr({},ja),Pi.defaultConfig),l10n:al};t.parseDate=sd({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=m,t._setHoursFromDate=d,t._positionCalendar=wt,t.changeMonth=Pe,t.changeYear=Ie,t.clear=U,t.close=Z,t.onMouseOver=M,t._createElement=zt,t.createDay=b,t.destroy=q,t.isEnabled=we,t.jumpToDate=x,t.updateValue=Zi,t.open=et,t.redraw=or,t.set=He,t.setDate=Nt,t.toggle=Wt;function r(){t.utils={getDaysInMonth:function(F,V){return F===void 0&&(F=t.currentMonth),V===void 0&&(V=t.currentYear),F===1&&(V%4===0&&V%100!==0||V%400===0)?29:t.l10n.daysInMonth[F]}}}function n(){t.element=t.input=i,t.isOpen=!1,Qe(),dt(),rt(),vt(),r(),t.isMobile||y(),_(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&d(t.config.noCalendar?t.latestSelectedDateObj:void 0),Zi(!1)),o();var F=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&F&&wt(),Et("onReady")}function s(){var F;return((F=t.calendarContainer)===null||F===void 0?void 0:F.getRootNode()).activeElement||document.activeElement}function a(F){return F.bind(t)}function o(){var F=t.config;F.weekNumbers===!1&&F.showMonths===1||F.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){var V=(t.days.offsetWidth+1)*F.showMonths;t.daysContainer.style.width=V+"px",t.calendarContainer.style.width=V+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function c(F){if(t.selectedDates.length===0){var V=t.config.minDate===void 0||Yr(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),ee=uu(t.config);V.setHours(ee.hours,ee.minutes,ee.seconds,V.getMilliseconds()),t.selectedDates=[V],t.latestSelectedDateObj=V}F!==void 0&&F.type!=="blur"&&ir(F);var fe=t._input.value;u(),Zi(),t._input.value!==fe&&t._debouncedChange()}function h(F,V){return F%12+12*un(V===t.l10n.amPM[1])}function l(F){switch(F%24){case 0:case 12:return 12;default:return F%12}}function u(){if(!(t.hourElement===void 0||t.minuteElement===void 0)){var F=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,V=(parseInt(t.minuteElement.value,10)||0)%60,ee=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(F=h(F,t.amPM.textContent));var fe=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&Yr(t.latestSelectedDateObj,t.config.minDate,!0)===0,Me=t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&Yr(t.latestSelectedDateObj,t.config.maxDate,!0)===0;if(t.config.maxTime!==void 0&&t.config.minTime!==void 0&&t.config.minTime>t.config.maxTime){var Ge=hu(t.config.minTime.getHours(),t.config.minTime.getMinutes(),t.config.minTime.getSeconds()),lt=hu(t.config.maxTime.getHours(),t.config.maxTime.getMinutes(),t.config.maxTime.getSeconds()),qe=hu(F,V,ee);if(qe>lt&&qe<Ge){var ot=tx(Ge);F=ot[0],V=ot[1],ee=ot[2]}}else{if(Me){var Ke=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;F=Math.min(F,Ke.getHours()),F===Ke.getHours()&&(V=Math.min(V,Ke.getMinutes())),V===Ke.getMinutes()&&(ee=Math.min(ee,Ke.getSeconds()))}if(fe){var je=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;F=Math.max(F,je.getHours()),F===je.getHours()&&V<je.getMinutes()&&(V=je.getMinutes()),V===je.getMinutes()&&(ee=Math.max(ee,je.getSeconds()))}}f(F,V,ee)}}function d(F){var V=F||t.latestSelectedDateObj;V&&V instanceof Date&&f(V.getHours(),V.getMinutes(),V.getSeconds())}function f(F,V,ee){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(F%24,V,ee||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Mr(t.config.time_24hr?F:(12+F)%12+12*un(F%12===0)),t.minuteElement.value=Mr(V),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[un(F>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Mr(ee)))}function p(F){var V=$r(F),ee=parseInt(V.value)+(F.delta||0);(ee/1e3>1||F.key==="Enter"&&!/[^\d]/.test(ee.toString()))&&Ie(ee)}function m(F,V,ee,fe){if(V instanceof Array)return V.forEach(function(Me){return m(F,Me,ee,fe)});if(F instanceof Array)return F.forEach(function(Me){return m(Me,V,ee,fe)});F.addEventListener(V,ee,fe),t._handlers.push({remove:function(){return F.removeEventListener(V,ee,fe)}})}function v(){Et("onChange")}function _(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(function(ee){Array.prototype.forEach.call(t.element.querySelectorAll("[data-"+ee+"]"),function(fe){return m(fe,"click",t[ee])})}),t.isMobile){_t();return}var F=V0(it,50);if(t._debouncedChange=V0(v,rx),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&m(t.daysContainer,"mouseover",function(ee){t.config.mode==="range"&&M($r(ee))}),m(t._input,"keydown",ue),t.calendarContainer!==void 0&&m(t.calendarContainer,"keydown",ue),!t.config.inline&&!t.config.static&&m(window,"resize",F),window.ontouchstart!==void 0?m(window.document,"touchstart",de):m(window.document,"mousedown",de),m(window.document,"focus",de,{capture:!0}),t.config.clickOpens===!0&&(m(t._input,"focus",t.open),m(t._input,"click",t.open)),t.daysContainer!==void 0&&(m(t.monthNav,"click",qs),m(t.monthNav,["keyup","increment"],p),m(t.daysContainer,"click",ni)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){var V=function(ee){return $r(ee).select()};m(t.timeContainer,["increment"],c),m(t.timeContainer,"blur",c,{capture:!0}),m(t.timeContainer,"click",E),m([t.hourElement,t.minuteElement],["focus","click"],V),t.secondElement!==void 0&&m(t.secondElement,"focus",function(){return t.secondElement&&t.secondElement.select()}),t.amPM!==void 0&&m(t.amPM,"click",function(ee){c(ee)})}t.config.allowInput&&m(t._input,"blur",be)}function x(F,V){var ee=F!==void 0?t.parseDate(F):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),fe=t.currentYear,Me=t.currentMonth;try{ee!==void 0&&(t.currentYear=ee.getFullYear(),t.currentMonth=ee.getMonth())}catch(Ge){Ge.message="Invalid date supplied: "+ee,t.config.errorHandler(Ge)}V&&t.currentYear!==fe&&(Et("onYearChange"),ne()),V&&(t.currentYear!==fe||t.currentMonth!==Me)&&Et("onMonthChange"),t.redraw()}function E(F){var V=$r(F);~V.className.indexOf("arrow")&&C(F,V.classList.contains("arrowUp")?1:-1)}function C(F,V,ee){var fe=F&&$r(F),Me=ee||fe&&fe.parentNode&&fe.parentNode.firstChild,Ge=vi("increment");Ge.delta=V,Me&&Me.dispatchEvent(Ge)}function y(){var F=window.document.createDocumentFragment();if(t.calendarContainer=zt("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(F.appendChild(Fe()),t.innerContainer=zt("div","flatpickr-innerContainer"),t.config.weekNumbers){var V=Ee(),ee=V.weekWrapper,fe=V.weekNumbers;t.innerContainer.appendChild(ee),t.weekNumbers=fe,t.weekWrapper=ee}t.rContainer=zt("div","flatpickr-rContainer"),t.rContainer.appendChild(Ze()),t.daysContainer||(t.daysContainer=zt("div","flatpickr-days"),t.daysContainer.tabIndex=-1),Q(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),F.appendChild(t.innerContainer)}t.config.enableTime&&F.appendChild(ke()),Sr(t.calendarContainer,"rangeMode",t.config.mode==="range"),Sr(t.calendarContainer,"animate",t.config.animate===!0),Sr(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(F);var Me=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!Me&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){var Ge=zt("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(Ge,t.element),Ge.appendChild(t.element),t.altInput&&Ge.appendChild(t.altInput),Ge.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function b(F,V,ee,fe){var Me=we(V,!0),Ge=zt("span",F,V.getDate().toString());return Ge.dateObj=V,Ge.$i=fe,Ge.setAttribute("aria-label",t.formatDate(V,t.config.ariaDateFormat)),F.indexOf("hidden")===-1&&Yr(V,t.now)===0&&(t.todayDateElem=Ge,Ge.classList.add("today"),Ge.setAttribute("aria-current","date")),Me?(Ge.tabIndex=-1,Xt(V)&&(Ge.classList.add("selected"),t.selectedDateElem=Ge,t.config.mode==="range"&&(Sr(Ge,"startRange",t.selectedDates[0]&&Yr(V,t.selectedDates[0],!0)===0),Sr(Ge,"endRange",t.selectedDates[1]&&Yr(V,t.selectedDates[1],!0)===0),F==="nextMonthDay"&&Ge.classList.add("inRange")))):Ge.classList.add("flatpickr-disabled"),t.config.mode==="range"&&Bi(V)&&!Xt(V)&&Ge.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&F!=="prevMonthDay"&&fe%7===6&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(V)+"</span>"),Et("onDayCreate",Ge),Ge}function T(F){F.focus(),t.config.mode==="range"&&M(F)}function R(F){for(var V=F>0?0:t.config.showMonths-1,ee=F>0?t.config.showMonths:-1,fe=V;fe!=ee;fe+=F)for(var Me=t.daysContainer.children[fe],Ge=F>0?0:Me.children.length-1,lt=F>0?Me.children.length:-1,qe=Ge;qe!=lt;qe+=F){var ot=Me.children[qe];if(ot.className.indexOf("hidden")===-1&&we(ot.dateObj))return ot}}function O(F,V){for(var ee=F.className.indexOf("Month")===-1?F.dateObj.getMonth():t.currentMonth,fe=V>0?t.config.showMonths:-1,Me=V>0?1:-1,Ge=ee-t.currentMonth;Ge!=fe;Ge+=Me)for(var lt=t.daysContainer.children[Ge],qe=ee-t.currentMonth===Ge?F.$i+V:V<0?lt.children.length-1:0,ot=lt.children.length,Ke=qe;Ke>=0&&Ke<ot&&Ke!=(V>0?ot:-1);Ke+=Me){var je=lt.children[Ke];if(je.className.indexOf("hidden")===-1&&we(je.dateObj)&&Math.abs(F.$i-Ke)>=Math.abs(V))return T(je)}t.changeMonth(Me),W(R(Me),0)}function W(F,V){var ee=s(),fe=Re(ee||document.body),Me=F!==void 0?F:fe?ee:t.selectedDateElem!==void 0&&Re(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&Re(t.todayDateElem)?t.todayDateElem:R(V>0?1:-1);Me===void 0?t._input.focus():fe?O(Me,V):T(Me)}function G(F,V){for(var ee=(new Date(F,V,1).getDay()-t.l10n.firstDayOfWeek+7)%7,fe=t.utils.getDaysInMonth((V-1+12)%12,F),Me=t.utils.getDaysInMonth(V,F),Ge=window.document.createDocumentFragment(),lt=t.config.showMonths>1,qe=lt?"prevMonthDay hidden":"prevMonthDay",ot=lt?"nextMonthDay hidden":"nextMonthDay",Ke=fe+1-ee,je=0;Ke<=fe;Ke++,je++)Ge.appendChild(b("flatpickr-day "+qe,new Date(F,V-1,Ke),Ke,je));for(Ke=1;Ke<=Me;Ke++,je++)Ge.appendChild(b("flatpickr-day",new Date(F,V,Ke),Ke,je));for(var bt=Me+1;bt<=42-ee&&(t.config.showMonths===1||je%7!==0);bt++,je++)Ge.appendChild(b("flatpickr-day "+ot,new Date(F,V+1,bt%Me),bt,je));var k=zt("div","dayContainer");return k.appendChild(Ge),k}function Q(){if(t.daysContainer!==void 0){Ql(t.daysContainer),t.weekNumbers&&Ql(t.weekNumbers);for(var F=document.createDocumentFragment(),V=0;V<t.config.showMonths;V++){var ee=new Date(t.currentYear,t.currentMonth,1);ee.setMonth(t.currentMonth+V),F.appendChild(G(ee.getFullYear(),ee.getMonth()))}t.daysContainer.appendChild(F),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&M()}}function ne(){if(!(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")){var F=function(fe){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&fe<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&fe>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(var V=0;V<12;V++)if(F(V)){var ee=zt("option","flatpickr-monthDropdown-month");ee.value=new Date(t.currentYear,V).getMonth().toString(),ee.textContent=Mc(V,t.config.shorthandCurrentMonth,t.l10n),ee.tabIndex=-1,t.currentMonth===V&&(ee.selected=!0),t.monthsDropdownContainer.appendChild(ee)}}}function xe(){var F=zt("div","flatpickr-month"),V=window.document.createDocumentFragment(),ee;t.config.showMonths>1||t.config.monthSelectorType==="static"?ee=zt("span","cur-month"):(t.monthsDropdownContainer=zt("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),m(t.monthsDropdownContainer,"change",function(lt){var qe=$r(lt),ot=parseInt(qe.value,10);t.changeMonth(ot-t.currentMonth),Et("onMonthChange")}),ne(),ee=t.monthsDropdownContainer);var fe=Zl("cur-year",{tabindex:"-1"}),Me=fe.getElementsByTagName("input")[0];Me.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Me.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Me.setAttribute("max",t.config.maxDate.getFullYear().toString()),Me.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());var Ge=zt("div","flatpickr-current-month");return Ge.appendChild(ee),Ge.appendChild(fe),V.appendChild(Ge),F.appendChild(V),{container:F,yearElement:Me,monthElement:ee}}function Ce(){Ql(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(var F=t.config.showMonths;F--;){var V=xe();t.yearElements.push(V.yearElement),t.monthElements.push(V.monthElement),t.monthNav.appendChild(V.container)}t.monthNav.appendChild(t.nextMonthNav)}function Fe(){return t.monthNav=zt("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=zt("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=zt("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,Ce(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:function(){return t.__hidePrevMonthArrow},set:function(F){t.__hidePrevMonthArrow!==F&&(Sr(t.prevMonthNav,"flatpickr-disabled",F),t.__hidePrevMonthArrow=F)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:function(){return t.__hideNextMonthArrow},set:function(F){t.__hideNextMonthArrow!==F&&(Sr(t.nextMonthNav,"flatpickr-disabled",F),t.__hideNextMonthArrow=F)}}),t.currentYearElement=t.yearElements[0],qi(),t.monthNav}function ke(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");var F=uu(t.config);t.timeContainer=zt("div","flatpickr-time"),t.timeContainer.tabIndex=-1;var V=zt("span","flatpickr-time-separator",":"),ee=Zl("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=ee.getElementsByTagName("input")[0];var fe=Zl("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=fe.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Mr(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?F.hours:l(F.hours)),t.minuteElement.value=Mr(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():F.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(ee),t.timeContainer.appendChild(V),t.timeContainer.appendChild(fe),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");var Me=Zl("flatpickr-second");t.secondElement=Me.getElementsByTagName("input")[0],t.secondElement.value=Mr(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():F.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(zt("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Me)}return t.config.time_24hr||(t.amPM=zt("span","flatpickr-am-pm",t.l10n.amPM[un((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function Ze(){t.weekdayContainer?Ql(t.weekdayContainer):t.weekdayContainer=zt("div","flatpickr-weekdays");for(var F=t.config.showMonths;F--;){var V=zt("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(V)}return ie(),t.weekdayContainer}function ie(){if(t.weekdayContainer){var F=t.l10n.firstDayOfWeek,V=U0(t.l10n.weekdays.shorthand);F>0&&F<V.length&&(V=U0(V.splice(F,V.length),V.splice(0,F)));for(var ee=t.config.showMonths;ee--;)t.weekdayContainer.children[ee].innerHTML=`
      <span class='flatpickr-weekday'>
        `+V.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function Ee(){t.calendarContainer.classList.add("hasWeeks");var F=zt("div","flatpickr-weekwrapper");F.appendChild(zt("span","flatpickr-weekday",t.l10n.weekAbbreviation));var V=zt("div","flatpickr-weeks");return F.appendChild(V),{weekWrapper:F,weekNumbers:V}}function Pe(F,V){V===void 0&&(V=!0);var ee=V?F:F-t.currentMonth;ee<0&&t._hidePrevMonthArrow===!0||ee>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=ee,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,Et("onYearChange"),ne()),Q(),Et("onMonthChange"),qi())}function U(F,V){if(F===void 0&&(F=!0),V===void 0&&(V=!0),t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,V===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){var ee=uu(t.config),fe=ee.hours,Me=ee.minutes,Ge=ee.seconds;f(fe,Me,Ge)}t.redraw(),F&&Et("onChange")}function Z(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),Et("onClose")}function q(){t.config!==void 0&&Et("onDestroy");for(var F=t._handlers.length;F--;)t._handlers[F].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){var V=t.calendarContainer.parentNode;if(V.lastChild&&V.removeChild(V.lastChild),V.parentNode){for(;V.firstChild;)V.parentNode.insertBefore(V.firstChild,V);V.parentNode.removeChild(V)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(ee){try{delete t[ee]}catch{}})}function X(F){return t.calendarContainer.contains(F)}function de(F){if(t.isOpen&&!t.config.inline){var V=$r(F),ee=X(V),fe=V===t.input||V===t.altInput||t.element.contains(V)||F.path&&F.path.indexOf&&(~F.path.indexOf(t.input)||~F.path.indexOf(t.altInput)),Me=!fe&&!ee&&!X(F.relatedTarget),Ge=!t.config.ignoredFocusElements.some(function(lt){return lt.contains(V)});Me&&Ge&&(t.config.allowInput&&t.setDate(t._input.value,!1,t.config.altInput?t.config.altFormat:t.config.dateFormat),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&c(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&t.clear(!1))}}function Ie(F){if(!(!F||t.config.minDate&&F<t.config.minDate.getFullYear()||t.config.maxDate&&F>t.config.maxDate.getFullYear())){var V=F,ee=t.currentYear!==V;t.currentYear=V||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),ee&&(t.redraw(),Et("onYearChange"),ne())}}function we(F,V){var ee;V===void 0&&(V=!0);var fe=t.parseDate(F,void 0,V);if(t.config.minDate&&fe&&Yr(fe,t.config.minDate,V!==void 0?V:!t.minDateHasTime)<0||t.config.maxDate&&fe&&Yr(fe,t.config.maxDate,V!==void 0?V:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(fe===void 0)return!1;for(var Me=!!t.config.enable,Ge=(ee=t.config.enable)!==null&&ee!==void 0?ee:t.config.disable,lt=0,qe=void 0;lt<Ge.length;lt++){if(qe=Ge[lt],typeof qe=="function"&&qe(fe))return Me;if(qe instanceof Date&&fe!==void 0&&qe.getTime()===fe.getTime())return Me;if(typeof qe=="string"){var ot=t.parseDate(qe,void 0,!0);return ot&&ot.getTime()===fe.getTime()?Me:!Me}else if(typeof qe=="object"&&fe!==void 0&&qe.from&&qe.to&&fe.getTime()>=qe.from.getTime()&&fe.getTime()<=qe.to.getTime())return Me}return!Me}function Re(F){return t.daysContainer!==void 0?F.className.indexOf("hidden")===-1&&F.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(F):!1}function be(F){var V=F.target===t._input,ee=t._input.value.trimEnd()!==Ki();V&&ee&&!(F.relatedTarget&&X(F.relatedTarget))&&t.setDate(t._input.value,!0,F.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function ue(F){var V=$r(F),ee=t.config.wrap?i.contains(V):V===t._input,fe=t.config.allowInput,Me=t.isOpen&&(!fe||!ee),Ge=t.config.inline&&ee&&!fe;if(F.keyCode===13&&ee){if(fe)return t.setDate(t._input.value,!0,V===t.altInput?t.config.altFormat:t.config.dateFormat),t.close(),V.blur();t.open()}else if(X(V)||Me||Ge){var lt=!!t.timeContainer&&t.timeContainer.contains(V);switch(F.keyCode){case 13:lt?(F.preventDefault(),c(),lr()):ni(F);break;case 27:F.preventDefault(),lr();break;case 8:case 46:ee&&!t.config.allowInput&&(F.preventDefault(),t.clear());break;case 37:case 39:if(!lt&&!ee){F.preventDefault();var qe=s();if(t.daysContainer!==void 0&&(fe===!1||qe&&Re(qe))){var ot=F.keyCode===39?1:-1;F.ctrlKey?(F.stopPropagation(),Pe(ot),W(R(1),0)):W(void 0,ot)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:F.preventDefault();var Ke=F.keyCode===40?1:-1;t.daysContainer&&V.$i!==void 0||V===t.input||V===t.altInput?F.ctrlKey?(F.stopPropagation(),Ie(t.currentYear-Ke),W(R(1),0)):lt||W(void 0,Ke*7):V===t.currentYearElement?Ie(t.currentYear-Ke):t.config.enableTime&&(!lt&&t.hourElement&&t.hourElement.focus(),c(F),t._debouncedChange());break;case 9:if(lt){var je=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(function(L){return L}),bt=je.indexOf(V);if(bt!==-1){var k=je[bt+(F.shiftKey?-1:1)];F.preventDefault(),(k||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(V)&&F.shiftKey&&(F.preventDefault(),t._input.focus());break}}if(t.amPM!==void 0&&V===t.amPM)switch(F.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],u(),Zi();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],u(),Zi();break}(ee||X(V))&&Et("onKeyDown",F)}function M(F,V){if(V===void 0&&(V="flatpickr-day"),!(t.selectedDates.length!==1||F&&(!F.classList.contains(V)||F.classList.contains("flatpickr-disabled")))){for(var ee=F?F.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),fe=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),Me=Math.min(ee,t.selectedDates[0].getTime()),Ge=Math.max(ee,t.selectedDates[0].getTime()),lt=!1,qe=0,ot=0,Ke=Me;Ke<Ge;Ke+=ix.DAY)we(new Date(Ke),!0)||(lt=lt||Ke>Me&&Ke<Ge,Ke<fe&&(!qe||Ke>qe)?qe=Ke:Ke>fe&&(!ot||Ke<ot)&&(ot=Ke));var je=Array.from(t.rContainer.querySelectorAll("*:nth-child(-n+"+t.config.showMonths+") > ."+V));je.forEach(function(bt){var k=bt.dateObj,L=k.getTime(),D=qe>0&&L<qe||ot>0&&L>ot;if(D){bt.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(N){bt.classList.remove(N)});return}else if(lt&&!D)return;["startRange","inRange","endRange","notAllowed"].forEach(function(N){bt.classList.remove(N)}),F!==void 0&&(F.classList.add(ee<=t.selectedDates[0].getTime()?"startRange":"endRange"),fe<ee&&L===fe?bt.classList.add("startRange"):fe>ee&&L===fe&&bt.classList.add("endRange"),L>=qe&&(ot===0||L<=ot)&&ex(L,fe,ee)&&bt.classList.add("inRange"))})}}function it(){t.isOpen&&!t.config.static&&!t.config.inline&&wt()}function et(F,V){if(V===void 0&&(V=t._positionElement),t.isMobile===!0){if(F){F.preventDefault();var ee=$r(F);ee&&ee.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),Et("onOpen");return}else if(t._input.disabled||t.config.inline)return;var fe=t.isOpen;t.isOpen=!0,fe||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),Et("onOpen"),wt(V)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(F===void 0||!t.timeContainer.contains(F.relatedTarget))&&setTimeout(function(){return t.hourElement.select()},50)}function he(F){return function(V){var ee=t.config["_"+F+"Date"]=t.parseDate(V,t.config.dateFormat),fe=t.config["_"+(F==="min"?"max":"min")+"Date"];ee!==void 0&&(t[F==="min"?"minDateHasTime":"maxDateHasTime"]=ee.getHours()>0||ee.getMinutes()>0||ee.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(function(Me){return we(Me)}),!t.selectedDates.length&&F==="min"&&d(ee),Zi()),t.daysContainer&&(or(),ee!==void 0?t.currentYearElement[F]=ee.getFullYear().toString():t.currentYearElement.removeAttribute(F),t.currentYearElement.disabled=!!fe&&ee!==void 0&&fe.getFullYear()===ee.getFullYear())}}function Qe(){var F=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],V=dr(dr({},JSON.parse(JSON.stringify(i.dataset||{}))),e),ee={};t.config.parseDate=V.parseDate,t.config.formatDate=V.formatDate,Object.defineProperty(t.config,"enable",{get:function(){return t.config._enable},set:function(je){t.config._enable=Li(je)}}),Object.defineProperty(t.config,"disable",{get:function(){return t.config._disable},set:function(je){t.config._disable=Li(je)}});var fe=V.mode==="time";if(!V.dateFormat&&(V.enableTime||fe)){var Me=Pi.defaultConfig.dateFormat||ja.dateFormat;ee.dateFormat=V.noCalendar||fe?"H:i"+(V.enableSeconds?":S":""):Me+" H:i"+(V.enableSeconds?":S":"")}if(V.altInput&&(V.enableTime||fe)&&!V.altFormat){var Ge=Pi.defaultConfig.altFormat||ja.altFormat;ee.altFormat=V.noCalendar||fe?"h:i"+(V.enableSeconds?":S K":" K"):Ge+(" h:i"+(V.enableSeconds?":S":"")+" K")}Object.defineProperty(t.config,"minDate",{get:function(){return t.config._minDate},set:he("min")}),Object.defineProperty(t.config,"maxDate",{get:function(){return t.config._maxDate},set:he("max")});var lt=function(je){return function(bt){t.config[je==="min"?"_minTime":"_maxTime"]=t.parseDate(bt,"H:i:S")}};Object.defineProperty(t.config,"minTime",{get:function(){return t.config._minTime},set:lt("min")}),Object.defineProperty(t.config,"maxTime",{get:function(){return t.config._maxTime},set:lt("max")}),V.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,ee,V);for(var qe=0;qe<F.length;qe++)t.config[F[qe]]=t.config[F[qe]]===!0||t.config[F[qe]]==="true";ou.filter(function(je){return t.config[je]!==void 0}).forEach(function(je){t.config[je]=lu(t.config[je]||[]).map(a)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var qe=0;qe<t.config.plugins.length;qe++){var ot=t.config.plugins[qe](t)||{};for(var Ke in ot)ou.indexOf(Ke)>-1?t.config[Ke]=lu(ot[Ke]).map(a).concat(t.config[Ke]):typeof V[Ke]>"u"&&(t.config[Ke]=ot[Ke])}V.altInputClass||(t.config.altInputClass=Te().className+" "+t.config.altInputClass),Et("onParseConfig")}function Te(){return t.config.wrap?i.querySelector("[data-input]"):i}function dt(){typeof t.config.locale!="object"&&typeof Pi.l10ns[t.config.locale]>"u"&&t.config.errorHandler(new Error("flatpickr: invalid locale "+t.config.locale)),t.l10n=dr(dr({},Pi.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?Pi.l10ns[t.config.locale]:void 0),ra.D="("+t.l10n.weekdays.shorthand.join("|")+")",ra.l="("+t.l10n.weekdays.longhand.join("|")+")",ra.M="("+t.l10n.months.shorthand.join("|")+")",ra.F="("+t.l10n.months.longhand.join("|")+")",ra.K="("+t.l10n.amPM[0]+"|"+t.l10n.amPM[1]+"|"+t.l10n.amPM[0].toLowerCase()+"|"+t.l10n.amPM[1].toLowerCase()+")";var F=dr(dr({},e),JSON.parse(JSON.stringify(i.dataset||{})));F.time_24hr===void 0&&Pi.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=sg(t),t.parseDate=sd({config:t.config,l10n:t.l10n})}function wt(F){if(typeof t.config.position=="function")return void t.config.position(t,F);if(t.calendarContainer!==void 0){Et("onPreCalendarPosition");var V=F||t._positionElement,ee=Array.prototype.reduce.call(t.calendarContainer.children,function(re,pe){return re+pe.offsetHeight},0),fe=t.calendarContainer.offsetWidth,Me=t.config.position.split(" "),Ge=Me[0],lt=Me.length>1?Me[1]:null,qe=V.getBoundingClientRect(),ot=window.innerHeight-qe.bottom,Ke=Ge==="above"||Ge!=="below"&&ot<ee&&qe.top>ee,je=window.pageYOffset+qe.top+(Ke?-ee-2:V.offsetHeight+2);if(Sr(t.calendarContainer,"arrowTop",!Ke),Sr(t.calendarContainer,"arrowBottom",Ke),!t.config.inline){var bt=window.pageXOffset+qe.left,k=!1,L=!1;lt==="center"?(bt-=(fe-qe.width)/2,k=!0):lt==="right"&&(bt-=fe-qe.width,L=!0),Sr(t.calendarContainer,"arrowLeft",!k&&!L),Sr(t.calendarContainer,"arrowCenter",k),Sr(t.calendarContainer,"arrowRight",L);var D=window.document.body.offsetWidth-(window.pageXOffset+qe.right),N=bt+fe>window.document.body.offsetWidth,H=D+fe>window.document.body.offsetWidth;if(Sr(t.calendarContainer,"rightMost",N),!t.config.static)if(t.calendarContainer.style.top=je+"px",!N)t.calendarContainer.style.left=bt+"px",t.calendarContainer.style.right="auto";else if(!H)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=D+"px";else{var z=Gt();if(z===void 0)return;var se=window.document.body.offsetWidth,ge=Math.max(0,se/2-fe/2),ae=".flatpickr-calendar.centerMost:before",ce=".flatpickr-calendar.centerMost:after",J=z.cssRules.length,P="{left:"+qe.left+"px;right:auto;}";Sr(t.calendarContainer,"rightMost",!1),Sr(t.calendarContainer,"centerMost",!0),z.insertRule(ae+","+ce+P,J),t.calendarContainer.style.left=ge+"px",t.calendarContainer.style.right="auto"}}}}function Gt(){for(var F=null,V=0;V<document.styleSheets.length;V++){var ee=document.styleSheets[V];if(ee.cssRules){try{ee.cssRules}catch{continue}F=ee;break}}return F??Ri()}function Ri(){var F=document.createElement("style");return document.head.appendChild(F),F.sheet}function or(){t.config.noCalendar||t.isMobile||(ne(),qi(),Q())}function lr(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function ni(F){F.preventDefault(),F.stopPropagation();var V=function(je){return je.classList&&je.classList.contains("flatpickr-day")&&!je.classList.contains("flatpickr-disabled")&&!je.classList.contains("notAllowed")},ee=ng($r(F),V);if(ee!==void 0){var fe=ee,Me=t.latestSelectedDateObj=new Date(fe.dateObj.getTime()),Ge=(Me.getMonth()<t.currentMonth||Me.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=fe,t.config.mode==="single")t.selectedDates=[Me];else if(t.config.mode==="multiple"){var lt=Xt(Me);lt?t.selectedDates.splice(parseInt(lt),1):t.selectedDates.push(Me)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Me,t.selectedDates.push(Me),Yr(Me,t.selectedDates[0],!0)!==0&&t.selectedDates.sort(function(je,bt){return je.getTime()-bt.getTime()}));if(u(),Ge){var qe=t.currentYear!==Me.getFullYear();t.currentYear=Me.getFullYear(),t.currentMonth=Me.getMonth(),qe&&(Et("onYearChange"),ne()),Et("onMonthChange")}if(qi(),Q(),Zi(),!Ge&&t.config.mode!=="range"&&t.config.showMonths===1?T(fe):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){var ot=t.config.mode==="single"&&!t.config.enableTime,Ke=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(ot||Ke)&&lr()}v()}}var $t={locale:[dt,ie],showMonths:[Ce,o,Ze],minDate:[x],maxDate:[x],positionElement:[fi],clickOpens:[function(){t.config.clickOpens===!0?(m(t._input,"focus",t.open),m(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function He(F,V){if(F!==null&&typeof F=="object"){Object.assign(t.config,F);for(var ee in F)$t[ee]!==void 0&&$t[ee].forEach(function(fe){return fe()})}else t.config[F]=V,$t[F]!==void 0?$t[F].forEach(function(fe){return fe()}):ou.indexOf(F)>-1&&(t.config[F]=lu(V));t.redraw(),Zi(!0)}function Di(F,V){var ee=[];if(F instanceof Array)ee=F.map(function(fe){return t.parseDate(fe,V)});else if(F instanceof Date||typeof F=="number")ee=[t.parseDate(F,V)];else if(typeof F=="string")switch(t.config.mode){case"single":case"time":ee=[t.parseDate(F,V)];break;case"multiple":ee=F.split(t.config.conjunction).map(function(fe){return t.parseDate(fe,V)});break;case"range":ee=F.split(t.l10n.rangeSeparator).map(function(fe){return t.parseDate(fe,V)});break}else t.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(F)));t.selectedDates=t.config.allowInvalidPreload?ee:ee.filter(function(fe){return fe instanceof Date&&we(fe,!1)}),t.config.mode==="range"&&t.selectedDates.sort(function(fe,Me){return fe.getTime()-Me.getTime()})}function Nt(F,V,ee){if(V===void 0&&(V=!1),ee===void 0&&(ee=t.config.dateFormat),F!==0&&!F||F instanceof Array&&F.length===0)return t.clear(V);Di(F,ee),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),x(void 0,V),d(),t.selectedDates.length===0&&t.clear(!1),Zi(V),V&&Et("onChange")}function Li(F){return F.slice().map(function(V){return typeof V=="string"||typeof V=="number"||V instanceof Date?t.parseDate(V,void 0,!0):V&&typeof V=="object"&&V.from&&V.to?{from:t.parseDate(V.from,void 0),to:t.parseDate(V.to,void 0)}:V}).filter(function(V){return V})}function vt(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;var F=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);F&&Di(F,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function rt(){if(t.input=Te(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=zt(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),fi()}function fi(){t._positionElement=t.config.positionElement||t._input}function _t(){var F=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=zt("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=F,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=F==="datetime-local"?"Y-m-d\\TH:i:S":F==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch{}m(t.mobileInput,"change",function(V){t.setDate($r(V).value,!1,t.mobileFormatStr),Et("onChange"),Et("onClose")})}function Wt(F){if(t.isOpen===!0)return t.close();t.open(F)}function Et(F,V){if(t.config!==void 0){var ee=t.config[F];if(ee!==void 0&&ee.length>0)for(var fe=0;ee[fe]&&fe<ee.length;fe++)ee[fe](t.selectedDates,t.input.value,t,V);F==="onChange"&&(t.input.dispatchEvent(vi("change")),t.input.dispatchEvent(vi("input")))}}function vi(F){var V=document.createEvent("Event");return V.initEvent(F,!0,!0),V}function Xt(F){for(var V=0;V<t.selectedDates.length;V++){var ee=t.selectedDates[V];if(ee instanceof Date&&Yr(ee,F)===0)return""+V}return!1}function Bi(F){return t.config.mode!=="range"||t.selectedDates.length<2?!1:Yr(F,t.selectedDates[0])>=0&&Yr(F,t.selectedDates[1])<=0}function qi(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach(function(F,V){var ee=new Date(t.currentYear,t.currentMonth,1);ee.setMonth(t.currentMonth+V),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[V].textContent=Mc(ee.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=ee.getMonth().toString(),F.value=ee.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function Ki(F){var V=F||(t.config.altInput?t.config.altFormat:t.config.dateFormat);return t.selectedDates.map(function(ee){return t.formatDate(ee,V)}).filter(function(ee,fe,Me){return t.config.mode!=="range"||t.config.enableTime||Me.indexOf(ee)===fe}).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function Zi(F){F===void 0&&(F=!0),t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=Ki(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=Ki(t.config.altFormat)),F!==!1&&Et("onValueUpdate")}function qs(F){var V=$r(F),ee=t.prevMonthNav.contains(V),fe=t.nextMonthNav.contains(V);ee||fe?Pe(ee?-1:1):t.yearElements.indexOf(V)>=0?V.select():V.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):V.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function ir(F){F.preventDefault();var V=F.type==="keydown",ee=$r(F),fe=ee;t.amPM!==void 0&&ee===t.amPM&&(t.amPM.textContent=t.l10n.amPM[un(t.amPM.textContent===t.l10n.amPM[0])]);var Me=parseFloat(fe.getAttribute("min")),Ge=parseFloat(fe.getAttribute("max")),lt=parseFloat(fe.getAttribute("step")),qe=parseInt(fe.value,10),ot=F.delta||(V?F.which===38?1:-1:0),Ke=qe+lt*ot;if(typeof fe.value<"u"&&fe.value.length===2){var je=fe===t.hourElement,bt=fe===t.minuteElement;Ke<Me?(Ke=Ge+Ke+un(!je)+(un(je)&&un(!t.amPM)),bt&&C(void 0,-1,t.hourElement)):Ke>Ge&&(Ke=fe===t.hourElement?Ke-Ge-un(!t.amPM):Me,bt&&C(void 0,1,t.hourElement)),t.amPM&&je&&(lt===1?Ke+qe===23:Math.abs(Ke-qe)>lt)&&(t.amPM.textContent=t.l10n.amPM[un(t.amPM.textContent===t.l10n.amPM[0])]),fe.value=Mr(Ke)}}return n(),t}function Qa(i,e){for(var t=Array.prototype.slice.call(i).filter(function(a){return a instanceof HTMLElement}),r=[],n=0;n<t.length;n++){var s=t[n];try{if(s.getAttribute("data-fp-omit")!==null)continue;s._flatpickr!==void 0&&(s._flatpickr.destroy(),s._flatpickr=void 0),s._flatpickr=nx(s,e||{}),r.push(s._flatpickr)}catch(a){console.error(a)}}return r.length===1?r[0]:r}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(i){return Qa(this,i)},HTMLElement.prototype.flatpickr=function(i){return Qa([this],i)});var Pi=function(i,e){return typeof i=="string"?Qa(window.document.querySelectorAll(i),e):i instanceof Node?Qa([i],e):Qa(i,e)};Pi.defaultConfig={};Pi.l10ns={en:dr({},al),default:dr({},al)};Pi.localize=function(i){Pi.l10ns.default=dr(dr({},Pi.l10ns.default),i)};Pi.setDefaults=function(i){Pi.defaultConfig=dr(dr({},Pi.defaultConfig),i)};Pi.parseDate=sd({});Pi.formatDate=sg({});Pi.compareDates=Yr;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(i){return Qa(this,i)});Date.prototype.fp_incr=function(i){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof i=="string"?parseInt(i,10):i))};typeof window<"u"&&(window.flatpickr=Pi);const W0=Wr||uh;class ag{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.inputFilterType="range",this.searchTerms=[],this._bindEventService=new Xi}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)||{}}get currentDateOrDates(){return this._currentDateOrDates}get defaultOperator(){return this.inputFilterType==="compound"?tt.empty:this.gridOptions.defaultFilterRangeOperator||tt.rangeInclusive}get flatpickrOptions(){return this._flatpickrOptions||{}}get operator(){var e;return this.inputFilterType==="compound"?this._operator||this.columnFilter.operator||this.defaultOperator:((e=this.columnFilter)==null?void 0:e.operator)??this.defaultOperator}set operator(e){this.inputFilterType==="compound"?this._operator=e:this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.inputFilterType==="compound"&&(this.operator=e.operator||""),this.searchTerms=(e==null?void 0:e.searchTerms)??[],this.filterContainerElm=e.filterContainerElm;const t=this.inputFilterType==="compound"?Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"":this.searchTerms;this._filterElm=this.createDomFilterElement(t),this._bindEventService.bind(this._filterDivInputElm,"keyup",this.onTriggerEvent.bind(this)),this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this))}clear(e=!0){this.flatInstance&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.flatInstance.input&&this.flatInstance.clear()),this._filterElm.classList.remove("filled"),this._filterDivInputElm.classList.remove("filled")}destroy(){var e,t,r,n,s;this._bindEventService.unbindAll(),typeof((e=this.flatInstance)==null?void 0:e.destroy)=="function"&&(this.flatInstance.destroy(),this.flatInstance.element&&Sl(this.flatInstance)),Rt(this.filterContainerElm),Rt(this._filterDivInputElm),(t=this._filterDivInputElm)==null||t.remove(),(r=this.filterContainerElm)==null||r.remove(),(n=this._selectOperatorElm)==null||n.remove(),(s=this._filterElm)==null||s.remove()}hide(){var e;typeof((e=this.flatInstance)==null?void 0:e.close)=="function"&&this.flatInstance.close()}show(){var e;typeof((e=this.flatInstance)==null?void 0:e.open)=="function"&&this.flatInstance.open()}getValues(){return this._currentDateOrDates}setValues(e,t){let r;this.inputFilterType==="compound"?r=Array.isArray(e)?e[0]:e:typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"&&e[0].indexOf("..")>0?r=typeof e=="string"?[e]:e[0].split(".."):Array.isArray(e)&&(r=e),this.flatInstance&&(this._currentDateOrDates=e&&r?r:void 0,this.flatInstance.setDate(this._currentDateOrDates||""));const n=this.getValues()||[];if(this.getValues()||Array.isArray(n)&&n.length>0&&e?(this._filterElm.classList.add("filled"),this._filterDivInputElm.classList.add("filled")):(this._filterElm.classList.remove("filled"),this._filterDivInputElm.classList.remove("filled")),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const s=no(this.operator);this._selectOperatorElm.value=s}}buildDatePickerInput(e){var u,d,f,p,m,v;const t=((u=this.columnDef)==null?void 0:u.id)??"",r=il(this.columnFilter.type||this.columnDef.type||Y.dateIso),n=il(this.columnDef.outputType||this.columnFilter.type||this.columnDef.type||Y.dateUtc),s=((d=this.columnFilter)==null?void 0:d.filterOptions)??{};let a=((s==null?void 0:s.locale)??((p=(f=this.translaterService)==null?void 0:f.getCurrentLanguage)==null?void 0:p.call(f)))||this.gridOptions.locale||"en";(a==null?void 0:a.length)>2&&(a=a.substring(0,2));let o;if(this.inputFilterType==="compound")e&&(o=e,this._currentDateOrDates=e);else if(typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"&&e[0].indexOf("..")>0?o=typeof e=="string"?[e]:e[0].split(".."):Array.isArray(e)&&(o=e),Array.isArray(o)){this._currentDateOrDates=o;const _=Lr(this.columnFilter.type||this.columnDef.type||Y.dateIso);this._currentDateStrings=o.map(x=>W0(x).format(_))}const c={defaultDate:o||"",altInput:!0,altFormat:n,dateFormat:r,mode:this.inputFilterType==="range"?"range":"single",wrap:!0,closeOnSelect:!0,locale:a,onChange:(_,x)=>{if(this.inputFilterType==="compound")this._currentValue=x,this._currentDateOrDates=Array.isArray(_)&&_[0]||void 0;else if(Array.isArray(_)){this._currentDateOrDates=_;const C=Lr(this.columnDef.outputType||this.columnFilter.type||this.columnDef.type||Y.dateIso);this._currentDateStrings=_.map(y=>W0(y).format(C)),this._currentValue=this._currentDateStrings.join("..")}const E=c.enableTime?new Event("keyup"):void 0;this.onTriggerEvent(E)},errorHandler:_=>{_.toString().includes("invalid locale")&&console.warn(`[Slickgrid-Universal] Flatpickr missing locale imports (${a}), will revert to English as the default locale.
          See Flatpickr Localization for more info, for example if we want to use French, then we can import it with:  import 'flatpickr/dist/l10n/fr';`)}};n&&(n==="Z"||n.toLowerCase().includes("h"))&&(c.enableTime=!0),this._flatpickrOptions={...c,...s};let h=((m=this.gridOptions)==null?void 0:m.defaultFilterPlaceholder)??"";(v=this.columnFilter)!=null&&v.placeholder&&(h=this.columnFilter.placeholder);const l=K("div",{className:"flatpickr"});return this.inputFilterType==="range"&&l.classList.add("search-filter",`filter-${t}`),l.appendChild(K("input",{type:"text",className:"form-control",placeholder:h,dataset:{input:"",columnid:`${t}`}})),this.flatInstance=Pi(l,this._flatpickrOptions),l}getOperatorOptionValues(){var e;return(e=this.columnFilter)!=null&&e.compoundOperatorList?this.columnFilter.compoundOperatorList:Md(this.gridOptions,this.translaterService)}createDomFilterElement(e){var r;const t=((r=this.columnDef)==null?void 0:r.id)??"";if(Rt(this.filterContainerElm),this._filterDivInputElm=this.buildDatePickerInput(e),this.inputFilterType==="range")return Array.isArray(e)&&e.length>0&&e[0]!==""&&(this._filterDivInputElm.classList.add("filled"),this._currentDateOrDates=e,this._currentValue=e[0]),this._filterDivInputElm&&this.filterContainerElm.appendChild(this._filterDivInputElm),this._filterDivInputElm;{this._selectOperatorElm=Nd(this.getOperatorOptionValues(),this.grid);const n=K("div",{className:`form-group search-filter filter-${t}`}),s=K("div",{className:"input-group flatpickr"},n);if(K("div",{className:"input-group-addon input-group-prepend operator"},s).appendChild(this._selectOperatorElm),s.appendChild(this._filterDivInputElm),this.operator){const o=no(this.operator);this._selectOperatorElm.value=o}return e!==""&&(this._filterDivInputElm.classList.add("filled"),this._currentDateOrDates=e,this._currentValue=e),n&&this.filterContainerElm.appendChild(n),n}}onTriggerEvent(e){if(this._clearFilterTriggered)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterElm.classList.remove("filled");else if(this.inputFilterType==="range")this._currentDateStrings?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled"),this.callback(e,{columnDef:this.columnDef,searchTerms:this._currentDateStrings?this._currentDateStrings:[this._currentValue],operator:this.operator||"",shouldTriggerQuery:this._shouldTriggerQuery});else if(this.inputFilterType==="compound"&&this._selectOperatorElm){const t=this._selectOperatorElm.value;this._currentValue?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled"),(!(this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput===void 0)||this._currentDateOrDates!==void 0)&&this.callback(e,{columnDef:this.columnDef,searchTerms:this._currentValue?[this._currentValue]:null,operator:t||"",shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}}class sx extends ag{constructor(e){super(e),this.translaterService=e,this.inputFilterType="compound"}}class og{constructor(e){this.translaterService=e}filterCollection(e,t,r=Xa.chain){let n=[];return Array.isArray(t)?(n=r===Xa.merge?[]:[...e],t.forEach(s=>{if(r===Xa.merge){const a=this.singleFilterCollection(e,s);n=Xm([...n,...a])}else n=this.singleFilterCollection(n,s)})):n=this.singleFilterCollection(e,t),n}singleFilterCollection(e,t){let r=[];if(t){const n=t.property,s=t.operator||tt.equal,a=typeof t.value>"u"?"":t.value;switch(s){case tt.equal:n?r=e.filter(o=>o[n]===a):r=e.filter(o=>o===a);break;case tt.contains:n?r=e.filter(o=>{var c;return((c=o[n])==null?void 0:c.toString().indexOf(a.toString()))!==-1}):r=e.filter(o=>o!=null&&o.toString().indexOf(a.toString())!==-1);break;case tt.notContains:n?r=e.filter(o=>{var c;return((c=o[n])==null?void 0:c.toString().indexOf(a.toString()))===-1}):r=e.filter(o=>o!=null&&o.toString().indexOf(a.toString())===-1);break;case tt.notEqual:default:n?r=e.filter(o=>o[n]!==a):r=e.filter(o=>o!==a)}}return r}sortCollection(e,t,r,n){if(n&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let s=[];if(r){if(Array.isArray(r))s=t.sort((a,o)=>{var c,h;for(let l=0,u=r.length;l<u;l++){const d=r[l];if(d!=null&&d.property){const f=d.sortDesc?ii.desc:ii.asc,p=d.property,m=(d==null?void 0:d.fieldType)??(e==null?void 0:e.type)??Y.string,v=n?((c=this.translaterService)==null?void 0:c.translate)&&this.translaterService.translate(a[p]||" "):a[p],_=n?((h=this.translaterService)==null?void 0:h.translate)&&this.translaterService.translate(o[p]||" "):o[p],x=Ka(m,v,_,f,e);if(x!==ii.neutral)return x}}return ii.neutral});else if(r!=null&&r.property){const a=r.property,o=r.sortDesc?ii.desc:ii.asc,c=(r==null?void 0:r.fieldType)??(e==null?void 0:e.type)??Y.string;s=t.sort((h,l)=>{var p,m;const u=n?((p=this.translaterService)==null?void 0:p.translate)&&this.translaterService.translate(h[a]||" "):h[a],d=n?((m=this.translaterService)==null?void 0:m.translate)&&this.translaterService.translate(l[a]||" "):l[a],f=Ka(c,u,d,o,e);return f!==ii.neutral?f:ii.neutral})}else if(r&&!r.property){const a=r.sortDesc?ii.desc:ii.asc,o=(r==null?void 0:r.fieldType)??(e==null?void 0:e.type)??Y.string;s=t.sort((c,h)=>{var f,p;const l=n?((f=this.translaterService)==null?void 0:f.translate)&&this.translaterService.translate(c||" "):c,u=n?((p=this.translaterService)==null?void 0:p.translate)&&this.translaterService.translate(h||" "):h,d=Ka(o,l,u,a,e);return d!==ii.neutral?d:ii.neutral})}}return s}}class ax{constructor(e,t,r){this.sharedService=e,this.backendUtilities=t,this.translaterService=r}getPickerTitleOutputString(e,t){var u,d,f,p,m,v,_,x,E,C,y,b,T,R;if((u=this.sharedService.gridOptions)!=null&&u.enableTranslate&&!((d=this.translaterService)!=null&&d.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let r="";const n=((f=this.sharedService.gridOptions)==null?void 0:f[t])??{},s=((p=this.sharedService.gridOptions)==null?void 0:p.enableTranslate)??!1,a=((m=this.sharedService.gridOptions)==null?void 0:m.locales)??ye.locales,o=n==null?void 0:n[e],c=n==null?void 0:n[`${e}Key`],h=this.sharedService.gridOptions,l=Kn(h);if(c&&((v=this.translaterService)!=null&&v.translate))r=this.translaterService.translate(c||" ");else switch(e){case"commandTitle":r=o||s&&((_=this.translaterService)==null?void 0:_.getCurrentLanguage)&&((x=this.translaterService)==null?void 0:x.translate(`${l}COMMANDS`||" "))||(a==null?void 0:a.TEXT_COMMANDS);break;case"columnTitle":r=o||s&&((E=this.translaterService)==null?void 0:E.getCurrentLanguage)&&((C=this.translaterService)==null?void 0:C.translate(`${l}COLUMNS`||" "))||(a==null?void 0:a.TEXT_COLUMNS);break;case"forceFitTitle":r=o||s&&((y=this.translaterService)==null?void 0:y.getCurrentLanguage)&&((b=this.translaterService)==null?void 0:b.translate(`${l}FORCE_FIT_COLUMNS`||" "))||(a==null?void 0:a.TEXT_FORCE_FIT_COLUMNS);break;case"syncResizeTitle":r=o||s&&((T=this.translaterService)==null?void 0:T.getCurrentLanguage)&&((R=this.translaterService)==null?void 0:R.translate(`${l}SYNCHRONOUS_RESIZE`||" "))||(a==null?void 0:a.TEXT_SYNCHRONOUS_RESIZE);break;default:r=o;break}return r}readjustFrozenColumnIndexWhenNeeded(e,t,r){if(e>=0){const n=r.findIndex(s=>s.id===this.sharedService.frozenVisibleColumnId);n>=0&&n!==e&&(this.sharedService.gridOptions.frozenColumn=n,this.sharedService.slickGrid.setOptions({frozenColumn:n})),Array.isArray(r)&&Array.isArray(t)&&r.length!==t.length&&this.sharedService.slickGrid.setColumns(r)}}refreshBackendDataset(e){var r;let t=this.sharedService.gridOptions;e&&(t={...this.sharedService.gridOptions,...e},this.sharedService.gridOptions=t),(r=this.backendUtilities)==null||r.refreshBackendDataset(t)}runOverrideFunctionWhenExists(e,t){return typeof e=="function"?!!e.call(this,t):!0}sortItems(e,t){Array.isArray(e)&&e.sort((r,n)=>r&&n&&r.hasOwnProperty(t)&&n.hasOwnProperty(t)?r[t]-n[t]:0)}translateItems(e,t,r){var n,s;if(Array.isArray(e))for(const a of e)a.hasOwnProperty(t)&&(a[r]=(s=(n=this.translaterService)==null?void 0:n.translate)==null?void 0:s.call(n,a[t]))}translateMenuItemsFromTitleKey(e,t="commandItems"){for(const r of e)typeof r=="object"&&(r.titleKey&&(r.title=this.translateWhenEnabledAndServiceExist(`${r.titleKey}`,`TEXT_${r.titleKey}`)),r.subMenuTitleKey&&(r.subMenuTitle=this.translateWhenEnabledAndServiceExist(`${r.subMenuTitleKey}`,`TEXT_${r.subMenuTitleKey}`))),Array.isArray(r==null?void 0:r[t])&&this.translateMenuItemsFromTitleKey(r==null?void 0:r[t])}translateWhenEnabledAndServiceExist(e,t,r){var o,c;let n="";const s=(o=this.sharedService)==null?void 0:o.gridOptions,a=(s==null?void 0:s.locales)??ye.locales;return r?n=r:s.enableTranslate&&((c=this.translaterService)!=null&&c.translate)?n=this.translaterService.translate(e||" "):t in a?n=a[t]:n=t,n}}class Yt{get defaultPrevented(){return this._isDefaultPrevented}constructor(e,t){this.event=e,this.args=t,this._isPropagationStopped=!1,this._isImmediatePropagationStopped=!1,this._isDefaultPrevented=!1,this.returnValue=void 0,this.nativeEvent=e,this._arguments=t,e&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach(r=>this[r]=e[r]),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}stopPropagation(){var e;this._isPropagationStopped=!0,(e=this.nativeEvent)==null||e.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(e){this.returnValue===void 0&&e!==void 0&&(this.returnValue=e)}getReturnValue(){return this.returnValue}getArguments(){return this._arguments}resetReturnValue(){this.returnValue=void 0}}class ze{get subscriberCount(){return this._handlers.length}constructor(e,t){this.eventName=e,this.pubSub=t,this._handlers=[],this._pubSubService=t}subscribe(e){this._handlers.push(e)}unsubscribe(e){for(let t=this._handlers.length-1;t>=0;t--)this._handlers[t]===e&&this._handlers.splice(t,1)}notify(e,t,r,n=!1){var a;const s=t instanceof Yt?t:new Yt(t,e);n&&s.resetReturnValue(),r=r||this;for(let o=0;o<this._handlers.length&&!(s.isPropagationStopped()||s.isImmediatePropagationStopped());o++){const c=this._handlers[o].call(r,s,e);s.addReturnValue(c)}if(typeof((a=this._pubSubService)==null?void 0:a.publish)=="function"&&this.eventName){const o=this._pubSubService.publish(this.eventName,{args:e,eventData:s});s.addReturnValue(o)}return s}setPubSubService(e){this._pubSubService=e}}class di{constructor(){this.handlers=[]}get subscriberCount(){return this.handlers.length}subscribe(e,t){return this.handlers.push({event:e,handler:t}),e.subscribe(t),this}unsubscribe(e,t){let r=this.handlers.length;for(;r--;)if(this.handlers[r].event===e&&this.handlers[r].handler===t){this.handlers.splice(r,1),e.unsubscribe(t);return}return this}unsubscribeAll(){let e=this.handlers.length;for(;e--;)this.handlers[e].event.unsubscribe(this.handlers[e].handler);return this.handlers=[],this}}class Jr{constructor(e,t,r,n){r===void 0&&n===void 0&&(r=e,n=t),this.fromRow=Math.min(e,r),this.fromCell=Math.min(t,n),this.toRow=Math.max(e,r),this.toCell=Math.max(t,n)}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}isSingleRow(){return this.fromRow===this.toRow}contains(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}}class lg{constructor(){this.__nonDataRow=!0}}class Lc extends lg{constructor(){super(),this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=""}equals(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title}}class ox extends lg{constructor(){super(),this.__groupTotals=!0,this.group=null,this.initialized=!1}}class lx{constructor(){this.activeEditController=null}isActive(e){return e?this.activeEditController===e:this.activeEditController!==null}activate(e){if(e!==this.activeEditController){if(this.activeEditController!==null)throw new Error("SlickEditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=e}}deactivate(e){if(this.activeEditController){if(this.activeEditController!==e)throw new Error("SlickEditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return this.activeEditController?this.activeEditController.commitCurrentEdit():!0}cancelCurrentEdit(){return this.activeEditController?this.activeEditController.cancelCurrentEdit():!0}}class oe{static height(e,t){if(e){if(t===void 0)return e.getBoundingClientRect().height;oe.setStyleSize(e,"height",t)}}static width(e,t){if(!(!e||!e.getBoundingClientRect)){if(t===void 0)return e.getBoundingClientRect().width;oe.setStyleSize(e,"width",t)}}static setStyleSize(e,t,r){typeof r=="function"&&(r=r()),e.style[t]=typeof r=="string"?r:`${r}px`}static isHidden(e){return e.offsetWidth===0&&e.offsetHeight===0}static parents(e,t){const r=[],n=t===":visible",s=t===":hidden";for(;(e=e.parentNode)&&e!==document&&!(!e||!e.parentNode);)s?oe.isHidden(e)&&r.push(e):n?oe.isHidden(e)||r.push(e):(!t||e.matches(t))&&r.push(e);return r}static toFloat(e){const t=parseFloat(e);return isNaN(t)?0:t}static show(e,t=""){Array.isArray(e)?e.forEach(r=>r.style.display=t):e.style.display=t}static hide(e){Array.isArray(e)?e.forEach(t=>t.style.display="none"):e.style.display="none"}static applyDefaults(e,t){typeof t=="object"&&Object.keys(t).forEach(r=>{t.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=t[r])})}static addSlickEventPubSubWhenDefined(e,t){if(e)for(const r in t)t[r]instanceof ze&&typeof t[r].setPubSubService=="function"&&t[r].setPubSubService(e)}}oe.storage={_storage:new WeakMap,put:function(i,e,t){this._storage.has(i)||this._storage.set(i,new Map),this._storage.get(i).set(e,t)},get:function(i,e){const t=this._storage.get(i);return t?t.get(e):null},remove:function(i,e){const t=this._storage.get(i).delete(e);return this._storage.get(i).size!==0&&this._storage.delete(i),t}};const Bc=new lx,cx="slick-edit-preclick";class cg{constructor(e){this.pluginName="GroupItemMetadataProvider",this._defaults={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,indentation:15,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:this.defaultGroupCellFormatter.bind(this),totalsFormatter:this.defaultTotalsCellFormatter.bind(this),includeHeaderTotals:!1},this._eventHandler=new di,this._options=Br(!0,{},this._defaults,e)}get eventHandler(){return this._eventHandler}get dataView(){var e;return((e=this._grid)==null?void 0:e.getData())??{}}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())||{}}init(e,t){this._grid=e,this._options={...this._defaults,...t},this._eventHandler.subscribe(e.onClick,this.handleGridClick.bind(this)),this._eventHandler.subscribe(e.onKeyDown,this.handleGridKeyDown.bind(this))}destroy(){this.dispose()}dispose(){var e;(e=this._eventHandler)==null||e.unsubscribeAll()}getOptions(){return this._options}setOptions(e){this._options={...this._options,...e}}getGroupRowMetadata(e){return{selectable:!1,focusable:this._options.groupFocusable,cssClasses:`${this._options.groupCssClass} slick-group-level-${(e==null?void 0:e.level)||0}`,formatter:this._options.includeHeaderTotals&&this._options.totalsFormatter||void 0,columns:{0:{colspan:this._options.includeHeaderTotals?"1":"*",formatter:this._options.groupFormatter,editor:null}}}}getTotalsRowMetadata(e){var t;return{selectable:!1,focusable:this._options.totalsFocusable,cssClasses:`${this._options.totalsCssClass} slick-group-level-${((t=e==null?void 0:e.group)==null?void 0:t.level)||0}`,formatter:this._options.totalsFormatter,editor:null}}defaultGroupCellFormatter(e,t,r,n,s){var d,f;if(!this._options.enableExpandCollapse)return s.title;const a=s.level||0,o=((d=this._options)==null?void 0:d.indentation)??15,c=`${a*o}px`,h=s.collapsed?this._options.toggleCollapsedCssClass:this._options.toggleExpandedCssClass,l=(f=this.gridOptions)!=null&&f.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;l.appendChild(K("span",{className:`${this._options.toggleCssClass} ${h}`,ariaExpanded:String(!s.collapsed),style:{marginLeft:c}}));const u=K("span",{className:this._options.groupTitleCssClass||""});return u.setAttribute("level",a),s.title instanceof HTMLElement||s.title instanceof DocumentFragment?u.appendChild(s.title):this._grid.applyHtmlCode(u,s.title??""),l.appendChild(u),l}defaultTotalsCellFormatter(e,t,r,n,s,a){var o;return((o=n==null?void 0:n.groupTotalsFormatter)==null?void 0:o.call(n,s,n,a))??""}handleGridClick(e,t){var s;const r=e.target,n=(s=this._grid)==null?void 0:s.getDataItem(t.row);n instanceof Lc&&r.classList.contains(this._options.toggleCssClass||"")&&(this.handleDataViewExpandOrCollapse(n),e.stopImmediatePropagation(),e.preventDefault())}handleGridKeyDown(e){var t;if(this._options.enableExpandCollapse&&e.key===" "){const r=(t=this._grid)==null?void 0:t.getActiveCell();if(r){const n=this._grid.getDataItem(r.row);n instanceof Lc&&(this.handleDataViewExpandOrCollapse(n),e.stopImmediatePropagation(),e.preventDefault())}}}handleDataViewExpandOrCollapse(e){var r;const t=(r=this._grid)==null?void 0:r.getRenderedRange();this.dataView.setRefreshHints({ignoreDiffsBefore:t.top,ignoreDiffsAfter:t.bottom+1}),e.collapsed?this.dataView.expandGroup(e.groupingKey):this.dataView.collapseGroup(e.groupingKey)}}class hx{constructor(e,t){this.externalPubSub=t,this.defaults={groupItemMetadataProvider:null,inlineFilters:!1,useCSPSafeFilter:!1},this.idProperty="id",this.items=[],this.rows=[],this.idxById=new Map,this.rowsById=void 0,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.suspend=!1,this.isBulkSuspend=!1,this.bulkDeleteIds=new Map,this.sortAsc=!0,this.refreshHints={},this.prevRefreshHints={},this.filteredItems=[],this.filterCache=[],this.groupingInfoDefaults={getter:void 0,formatter:void 0,comparer:(r,n)=>r.value===n.value?0:r.value>n.value?1:-1,predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},this.groupingInfos=[],this.groups=[],this.toggledGroupsByLevel=[],this.groupingDelimiter=":|:",this.selectedRowIds=[],this.pagesize=0,this.pagenum=0,this.totalRows=0,this.onBeforePagingInfoChanged=new ze("onBeforePagingInfoChanged",t),this.onGroupExpanded=new ze("onGroupExpanded",t),this.onGroupCollapsed=new ze("onGroupCollapsed",t),this.onPagingInfoChanged=new ze("onPagingInfoChanged",t),this.onRowCountChanged=new ze("onRowCountChanged",t),this.onRowsChanged=new ze("onRowsChanged",t),this.onRowsOrCountChanged=new ze("onRowsOrCountChanged",t),this.onSelectedRowIdsChanged=new ze("onSelectedRowIdsChanged",t),this.onSetItemsCalled=new ze("onSetItemsCalled",t),this._options=Br(!0,{},this.defaults,e)}beginUpdate(e){this.suspend=!0,this.isBulkSuspend=e===!0}endUpdate(){const e=this.isBulkSuspend;this.isBulkSuspend=!1,this.suspend=!1,e&&(this.processBulkDelete(),this.ensureIdUniqueness()),this.refresh()}destroy(){var e,t,r;this.items=[],this.idProperty="id",this.idxById=null,this.rowsById=null,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.sortComparer=null,this.filterCache=[],this.filteredItems=[],this.compiledFilter=null,this.compiledFilterCSPSafe=null,this.compiledFilterWithCaching=null,this.compiledFilterWithCachingCSPSafe=null,this._grid&&((e=this._grid.onSelectedRowsChanged)==null||e.unsubscribe(),(t=this._grid.onCellCssStylesChanged)==null||t.unsubscribe()),(r=this.onRowsOrCountChanged)==null||r.unsubscribe()}setRefreshHints(e){this.refreshHints=e}setFilterArgs(e){this.filterArgs=e}processBulkDelete(){if(!this.idxById)return;let e,t,r=0;for(let n=0,s=this.items.length;n<s;n++){if(t=this.items[n],e=t[this.idProperty],e===void 0)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.bulkDeleteIds.has(e)?this.idxById.delete(e):(this.items[r]=t,this.idxById.set(e,r),++r)}this.items.length=r,this.bulkDeleteIds=new Map}updateIdxById(e){if(this.isBulkSuspend||!this.idxById)return;e=e||0;let t;for(let r=e,n=this.items.length;r<n;r++){if(t=this.items[r][this.idProperty],t===void 0)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.idxById.set(t,r)}}ensureIdUniqueness(){if(this.isBulkSuspend||!this.idxById)return;let e;for(let t=0,r=this.items.length;t<r;t++)if(e=this.items[t][this.idProperty],e===void 0||this.idxById.get(e)!==t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}getItems(){return this.items}getIdPropertyName(){return this.idProperty}setItems(e,t){t!==void 0&&(this.idProperty=t),this.items=this.filteredItems=e,this.onSetItemsCalled.notify({idProperty:this.idProperty,itemCount:this.items.length},null,this),this.idxById=new Map,this.updateIdxById(),this.ensureIdUniqueness(),this.refresh()}setPagingOptions(e){this.onBeforePagingInfoChanged.notify(this.getPagingInfo(),null,this).getReturnValue()!==!1&&(oi(e.pageSize)&&(this.pagesize=e.pageSize,this.pagenum=this.pagesize?Math.min(this.pagenum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1)):0),oi(e.pageNum)&&(this.pagenum=Math.min(e.pageNum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1))),this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),this.refresh())}getPagingInfo(){const e=this.pagesize?Math.max(1,Math.ceil(this.totalRows/this.pagesize)):1;return{pageSize:this.pagesize,pageNum:this.pagenum,totalRows:this.totalRows,totalPages:e,dataView:this}}sort(e,t){this.sortAsc=t,this.sortComparer=e,t===!1&&this.items.reverse(),this.items.sort(e),t===!1&&this.items.reverse(),this.idxById=new Map,this.updateIdxById(),this.refresh()}reSort(){this.sortComparer&&this.sort(this.sortComparer,this.sortAsc)}getFilteredItems(){return this.filteredItems}getFilteredItemCount(){return this.filteredItems.length}getFilter(){return this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter}setFilter(e){this.filterCSPSafe=e,this.filter=e,this._options.inlineFilters&&(this.compiledFilterCSPSafe=this.compileFilterCSPSafe,this.compiledFilterWithCachingCSPSafe=this.compileFilterWithCachingCSPSafe,this.compiledFilter=this.compileFilter(this._options.useCSPSafeFilter),this.compiledFilterWithCaching=this.compileFilterWithCaching(this._options.useCSPSafeFilter)),this.refresh()}getGrouping(){return this.groupingInfos}setGrouping(e){this._options.groupItemMetadataProvider||(this._options.groupItemMetadataProvider=new cg),this.groups=[],this.toggledGroupsByLevel=[],e=e||[],this.groupingInfos=e instanceof Array?e:[e];for(let t=0;t<this.groupingInfos.length;t++){const r=this.groupingInfos[t]=Br(!0,{},this.groupingInfoDefaults,this.groupingInfos[t]);r.getterIsAFn=typeof r.getter=="function",r.compiledAccumulators=[];let n=r.aggregators.length;for(;n--;)r.compiledAccumulators[n]=this.compileAccumulatorLoopCSPSafe(r.aggregators[n]);this.toggledGroupsByLevel[t]={}}this.refresh()}getItemByIdx(e){return this.items[e]}getIdxById(e){var t;return(t=this.idxById)==null?void 0:t.get(e)}ensureRowsByIdCache(){if(!this.rowsById){this.rowsById={};for(let e=0,t=this.rows.length;e<t;e++)this.rowsById[this.rows[e][this.idProperty]]=e}}getRowByItem(e){var t;return this.ensureRowsByIdCache(),(t=this.rowsById)==null?void 0:t[e[this.idProperty]]}getRowById(e){var t;return this.ensureRowsByIdCache(),(t=this.rowsById)==null?void 0:t[e]}getItemById(e){return this.items[this.idxById.get(e)]}mapItemsToRows(e){var r;const t=[];this.ensureRowsByIdCache();for(let n=0,s=e.length;n<s;n++){const a=(r=this.rowsById)==null?void 0:r[e[n][this.idProperty]];oi(a)&&(t[t.length]=a)}return t}mapIdsToRows(e){var r;const t=[];this.ensureRowsByIdCache();for(let n=0,s=e.length;n<s;n++){const a=(r=this.rowsById)==null?void 0:r[e[n]];oi(a)&&(t[t.length]=a)}return t}mapRowsToIds(e){const t=[];for(let r=0,n=e.length;r<n;r++)if(e[r]<this.rows.length){const s=this.rows[e[r]];t[t.length]=s[this.idProperty]}return t}updateSingleItem(e,t){var r;if(this.idxById){if(!this.idxById.has(e))throw new Error("[SlickGrid DataView] Invalid id");if(e!==t[this.idProperty]){const n=t[this.idProperty];if(!oi(n))throw new Error("[SlickGrid DataView] Cannot update item to associate with a null id");if(this.idxById.has(n))throw new Error("[SlickGrid DataView] Cannot update item to associate with a non-unique id");this.idxById.set(n,this.idxById.get(e)),this.idxById.delete(e),(r=this.updated)!=null&&r[e]&&delete this.updated[e],e=n}this.items[this.idxById.get(e)]=t,this.updated||(this.updated={}),this.updated[e]=!0}}updateItem(e,t){this.updateSingleItem(e,t),this.refresh()}updateItems(e,t){if(e.length!==t.length)throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update");for(let r=0,n=t.length;r<n;r++)this.updateSingleItem(e[r],t[r]);this.refresh()}insertItem(e,t){this.items.splice(e,0,t),this.updateIdxById(e),this.refresh()}insertItems(e,t){Array.prototype.splice.apply(this.items,[e,0].concat(t)),this.updateIdxById(e),this.refresh()}addItem(e){this.items.push(e),this.updateIdxById(this.items.length-1),this.refresh()}addItems(e){this.items=this.items.concat(e),this.updateIdxById(this.items.length-e.length),this.refresh()}deleteItem(e){if(this.idxById)if(this.isBulkSuspend)this.bulkDeleteIds.set(e,!0);else{const t=this.idxById.get(e);if(t===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(e),this.items.splice(t,1),this.updateIdxById(t),this.refresh()}}deleteItems(e){if(!(e.length===0||!this.idxById))if(this.isBulkSuspend)for(let t=0,r=e.length;t<r;t++){const n=e[t];if(this.idxById.get(n)===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.bulkDeleteIds.set(n,!0)}else{const t=[];for(let r=0,n=e.length;r<n;r++){const s=e[r],a=this.idxById.get(s);if(a===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(s),t.push(a)}t.sort();for(let r=t.length-1;r>=0;--r)this.items.splice(t[r],1);this.updateIdxById(t[0]),this.refresh()}}sortedAddItem(e){if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()");this.insertItem(this.sortedIndex(e),e)}sortedUpdateItem(e,t){if(!this.idxById)return;if(!this.idxById.has(e)||e!==t[this.idProperty])throw new Error(`[SlickGrid DataView] Invalid or non-matching id ${e}`);if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()");const r=this.getItemById(e);this.sortComparer(r,t)!==0?(this.deleteItem(e),this.sortedAddItem(t)):this.updateItem(e,t)}sortedIndex(e){let t=0,r=this.items.length;for(;t<r;){const n=t+r>>>1;this.sortComparer(this.items[n],e)===-1?t=n+1:r=n}return t}getItemCount(){return this.items.length}getLength(){return this.rows.length}getItem(e){var r;const t=this.rows[e];if(t!=null&&t.__group&&t.totals&&!((r=t.totals)!=null&&r.initialized)){const n=this.groupingInfos[t.level];n.displayTotalsRow||(this.calculateTotals(t.totals),t.title=n.formatter?n.formatter(t):t.value)}else t!=null&&t.__groupTotals&&!t.initialized&&this.calculateTotals(t);return t}getItemMetadata(e){const t=this.rows[e];return t===void 0?null:t.__group?this._options.groupItemMetadataProvider.getGroupRowMetadata(t):t.__groupTotals?this._options.groupItemMetadataProvider.getTotalsRowMetadata(t):null}expandCollapseAllGroups(e,t){if(oi(e))this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,t===!0?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});else for(let r=0;r<this.groupingInfos.length;r++)this.toggledGroupsByLevel[r]={},this.groupingInfos[r].collapsed=t,t===!0?this.onGroupCollapsed.notify({level:r,groupingKey:null}):this.onGroupExpanded.notify({level:r,groupingKey:null});this.refresh()}collapseAllGroups(e){this.expandCollapseAllGroups(e,!0)}expandAllGroups(e){this.expandCollapseAllGroups(e,!1)}expandCollapseGroup(e,t,r){this.toggledGroupsByLevel[e]&&(this.toggledGroupsByLevel[e][t]=this.groupingInfos[e].collapsed^r),this.refresh()}collapseGroup(...e){const r=Array.prototype.slice.call(e)[0];let n,s;e.length===1&&r.indexOf(this.groupingDelimiter)!==-1?(n=r,s=r.split(this.groupingDelimiter).length-1):(n=e.join(this.groupingDelimiter),s=e.length-1),this.expandCollapseGroup(s,n,!0),this.onGroupCollapsed.notify({level:s,groupingKey:n})}expandGroup(...e){const r=Array.prototype.slice.call(e)[0];let n,s;e.length===1&&r.indexOf(this.groupingDelimiter)!==-1?(s=r.split(this.groupingDelimiter).length-1,n=r):(s=e.length-1,n=e.join(this.groupingDelimiter)),this.expandCollapseGroup(s,n,!1),this.onGroupExpanded.notify({level:s,groupingKey:n})}getGroups(){return this.groups}extractGroups(e,t){var l,u;let r,n;const s=[],a={};let o;const c=t?t.level+1:0,h=this.groupingInfos[c];for(let d=0,f=((l=h.predefinedValues)==null?void 0:l.length)??0;d<f;d++)n=(u=h.predefinedValues)==null?void 0:u[d],r=a[n],r||(r=new Lc,r.value=n,r.level=c,r.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+n,s[s.length]=r,a[n]=r);for(let d=0,f=e.length;d<f;d++)o=e[d],n=h.getterIsAFn?h.getter(o):o[h.getter],r=a[n],r||(r=new Lc,r.value=n,r.level=c,r.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+n,s[s.length]=r,a[n]=r),r.rows[r.count++]=o;if(c<this.groupingInfos.length-1)for(let d=0;d<s.length;d++)r=s[d],r.groups=this.extractGroups(r.rows,r);return s.length&&this.addTotals(s,c),s.sort(this.groupingInfos[c].comparer),s}calculateTotals(e){var o;const t=e.group,r=this.groupingInfos[(t==null?void 0:t.level)??0],n=t.level===this.groupingInfos.length;let s,a=r.aggregators.length;if(!n&&r.aggregateChildGroups){let c=((o=t.groups)==null?void 0:o.length)??0;for(;c--;)t.groups[c].totals.initialized||this.calculateTotals(t.groups[c].totals)}for(;a--;)s=r.aggregators[a],s.init(),!n&&r.aggregateChildGroups?r.compiledAccumulators[a].call(s,t.groups):r.compiledAccumulators[a].call(s,t.rows),s.storeResult(e);e.initialized=!0}addGroupTotals(e){const t=this.groupingInfos[e.level],r=new ox;r.group=e,e.totals=r,t.lazyTotalsCalculation||this.calculateTotals(r)}addTotals(e,t){var c,h;t=t||0;const r=this.groupingInfos[t],n=r.collapsed,s=this.toggledGroupsByLevel[t];let a=e.length,o;for(;a--;)o=e[a],!(o.collapsed&&!r.aggregateCollapsed)&&(o.groups&&this.addTotals(o.groups,t+1),(c=r.aggregators)!=null&&c.length&&(r.aggregateEmpty||o.rows.length||(h=o.groups)!=null&&h.length)&&this.addGroupTotals(o),o.collapsed=n^s[o.groupingKey],o.title=r.formatter?r.formatter(o):o.value)}flattenGroupedRows(e,t){t=t||0;const r=this.groupingInfos[t],n=[];let s,a=0,o;for(let c=0,h=e.length;c<h;c++){if(o=e[c],n[a++]=o,!o.collapsed){s=o.groups?this.flattenGroupedRows(o.groups,t+1):o.rows;for(let l=0,u=s.length;l<u;l++)n[a++]=s[l]}o.totals&&r.displayTotalsRow&&(!o.collapsed||r.aggregateCollapsed)&&(n[a++]=o.totals)}return n}compileAccumulatorLoopCSPSafe(e){return e.accumulate?function(t){let r;if(Array.isArray(t))for(let n=0;n<t.length;n++){const s=t[n];r=e.accumulate.call(e,s)}return r}:function(){}}compileFilterCSPSafe(e,t){if(typeof this.filterCSPSafe!="function")return[];const r=[],n=e.length;for(let s=0;s<n;s++)this.filterCSPSafe(e[s],t)&&r.push(e[s]);return r}compileFilter(e=!1){if(e)return null;const t=ed(this.filter),r="{ continue _coreloop; }$1",n="{ _retval[_idx++] = $item$; continue _coreloop; }$1",s=t.body.replace(/return false\s*([;}]|\}|$)/gi,r).replace(/return!1([;}]|\}|$)/gi,r).replace(/return true\s*([;}]|\}|$)/gi,n).replace(/return!0([;}]|\}|$)/gi,n).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let a=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");a=a.replace(/\$filter\$/gi,s),a=a.replace(/\$item\$/gi,t.params[0]),a=a.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args",a),c="compiledFilter";return o.displayName=c,o.name=this.setFunctionName(o,c),o}compileFilterWithCaching(e=!1){if(e)return null;const t=ed(this.filter),r="{ continue _coreloop; }$1",n="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",s=t.body.replace(/return false\s*([;}]|\}|$)/gi,r).replace(/return!1([;}]|\}|$)/gi,r).replace(/return true\s*([;}]|\}|$)/gi,n).replace(/return!0([;}]|\}|$)/gi,n).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");let a=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");a=a.replace(/\$filter\$/gi,s),a=a.replace(/\$item\$/gi,t.params[0]),a=a.replace(/\$args\$/gi,t.params[1]);const o=new Function("_items,_args,_cache",a),c="compiledFilterWithCaching";return o.displayName=c,o.name=this.setFunctionName(o,c),o}compileFilterWithCachingCSPSafe(e,t,r){if(typeof this.filterCSPSafe!="function")return[];const n=[],s=e.length;for(let a=0;a<s;a++)(r[a]||this.filterCSPSafe(e[a],t))&&n.push(e[a]);return n}setFunctionName(e,t){try{Object.defineProperty(e,"name",{writable:!0,value:t})}catch{e.name=t}}uncompiledFilter(e,t){var s;const r=[];let n=0;for(let a=0,o=e.length;a<o;a++)(s=this.filter)!=null&&s.call(this,e[a],t)&&(r[n++]=e[a]);return r}uncompiledFilterWithCaching(e,t,r){var o;const n=[];let s=0,a;for(let c=0,h=e.length;c<h;c++)a=e[c],r[c]?n[s++]=a:(o=this.filter)!=null&&o.call(this,a,t)&&(n[s++]=a,r[c]=!0);return n}getFilteredAndPagedItems(e){if(this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter){let r,n;this._options.useCSPSafeFilter?(r=this._options.inlineFilters?this.compiledFilterCSPSafe:this.uncompiledFilter,n=this._options.inlineFilters?this.compiledFilterWithCachingCSPSafe:this.uncompiledFilterWithCaching):(r=this._options.inlineFilters?this.compiledFilter:this.uncompiledFilter,n=this._options.inlineFilters?this.compiledFilterWithCaching:this.uncompiledFilterWithCaching),this.refreshHints.isFilterNarrowing?this.filteredItems=r.call(this,this.filteredItems,this.filterArgs):this.refreshHints.isFilterExpanding?this.filteredItems=n.call(this,e,this.filterArgs,this.filterCache):this.refreshHints.isFilterUnchanged||(this.filteredItems=r.call(this,e,this.filterArgs))}else this.filteredItems=this.pagesize?e:e.concat();let t;return this.pagesize?(this.filteredItems.length<=this.pagenum*this.pagesize&&(this.filteredItems.length===0?this.pagenum=0:this.pagenum=Math.floor((this.filteredItems.length-1)/this.pagesize)),t=this.filteredItems.slice(this.pagesize*this.pagenum,this.pagesize*this.pagenum+this.pagesize)):t=this.filteredItems,{totalRows:this.filteredItems.length,rows:t}}getRowDiffs(e,t){var h,l,u;let r,n,s;const a=[];let o=0,c=Math.max(t.length,e.length);(h=this.refreshHints)!=null&&h.ignoreDiffsBefore&&(o=Math.max(0,Math.min(t.length,this.refreshHints.ignoreDiffsBefore))),(l=this.refreshHints)!=null&&l.ignoreDiffsAfter&&(c=Math.min(t.length,Math.max(0,this.refreshHints.ignoreDiffsAfter)));for(let d=o,f=e.length;d<c;d++)d>=f?a[a.length]=d:(r=t[d],n=e[d],(!r||this.groupingInfos.length&&(s=r.__nonDataRow||n.__nonDataRow)&&r.__group!==n.__group||r.__group&&!r.equals(n)||s&&(r.__groupTotals||n.__groupTotals)||r[this.idProperty]!==n[this.idProperty]||(u=this.updated)!=null&&u[r[this.idProperty]])&&(a[a.length]=d));return a}recalc(e){this.rowsById=void 0,(this.refreshHints.isFilterNarrowing!==this.prevRefreshHints.isFilterNarrowing||this.refreshHints.isFilterExpanding!==this.prevRefreshHints.isFilterExpanding)&&(this.filterCache=[]);const t=this.getFilteredAndPagedItems(e);this.totalRows=t.totalRows;let r=t.rows;this.groups=[],this.groupingInfos.length&&(this.groups=this.extractGroups(r),this.groups.length&&(r=this.flattenGroupedRows(this.groups)));const n=this.getRowDiffs(this.rows,r);return this.rows=r,n}refresh(){if(this.suspend)return;const e=Br(!0,{},this.getPagingInfo()),t=this.rows.length,r=this.totalRows;let n=this.recalc(this.items);this.pagesize&&this.totalRows<this.pagenum*this.pagesize&&(this.pagenum=Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1),n=this.recalc(this.items)),this.updated=null,this.prevRefreshHints=this.refreshHints,this.refreshHints={},r!==this.totalRows&&this.onBeforePagingInfoChanged.notify(e,null,this).getReturnValue()!==!1&&this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),t!==this.rows.length&&this.onRowCountChanged.notify({previous:t,current:this.rows.length,itemCount:this.items.length,dataView:this,callingOnRowsChanged:n.length>0},null,this),n.length>0&&this.onRowsChanged.notify({rows:n,itemCount:this.items.length,dataView:this,calledOnRowCountChanged:t!==this.rows.length},null,this),(t!==this.rows.length||n.length>0)&&this.onRowsOrCountChanged.notify({rowsDiff:n,previousRowCount:t,currentRowCount:this.rows.length,itemCount:this.items.length,rowCountChanged:t!==this.rows.length,rowsChanged:n.length>0,dataView:this},null,this)}syncGridSelection(e,t,r){this._grid=e;let n;this.selectedRowIds=this.mapRowsToIds(e.getSelectedRows());const s=e.getOptions(),a=c=>{c===!1?this.selectedRowIds=[]:this.selectedRowIds.sort().join(",")!==c.sort().join(",")&&(this.selectedRowIds=c)},o=()=>{if((this.selectedRowIds||[]).length>0&&!n){n=!0;const c=this.mapIdsToRows(this.selectedRowIds||[]);if(!t){const h={grid:this._grid,ids:this.mapRowsToIds(c),rows:c,dataView:this};this.preSelectedRowIdsChangeFn(h),this.onSelectedRowIdsChanged.notify(Object.assign(h,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new Yt,this)}e.setSelectedRows(c),n=!1}};return e.onSelectedRowsChanged.subscribe((c,h)=>{if(!n){const l=this.mapRowsToIds(h.rows),u={grid:this._grid,ids:l,rows:h.rows,added:!0,dataView:this};this.preSelectedRowIdsChangeFn(u),this.onSelectedRowIdsChanged.notify(Object.assign(u,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new Yt,this)}}),this.preSelectedRowIdsChangeFn=c=>{var h,l;if(!n){if(n=!0,typeof c.added>"u")a(c.ids);else{let d;c.added?r&&s.multiSelect?d=((h=this.selectedRowIds)==null?void 0:h.filter(p=>this.getRowById(p)===void 0)).concat(c.ids):d=c.ids:r&&s.multiSelect?d=(l=this.selectedRowIds)==null?void 0:l.filter(f=>c.ids.indexOf(f)===-1):d=[],a(d)}n=!1}},this.onRowsOrCountChanged.subscribe(o.bind(this)),this.onSelectedRowIdsChanged}getAllSelectedIds(){return this.selectedRowIds}getAllSelectedFilteredIds(){return this.getAllSelectedFilteredItems().map(e=>e[this.idProperty])}setSelectedIds(e,t){var c;let r=t==null?void 0:t.isRowBeingAdded;const n=t==null?void 0:t.shouldTriggerEvent,s=t==null?void 0:t.applyRowSelectionToGrid;r!==!1&&(r=!0);const a=this.mapIdsToRows(e),o={grid:this._grid,ids:e,rows:a,added:r,dataView:this};(c=this.preSelectedRowIdsChangeFn)==null||c.call(this,o),n!==!1&&this.onSelectedRowIdsChanged.notify(Object.assign(o,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new Yt,this),s!==!1&&this._grid&&this._grid.setSelectedRows(a)}getAllSelectedItems(){const e=[];return this.getAllSelectedIds().forEach(r=>{e.push(this.getItemById(r))}),e}getAllSelectedFilteredItems(){return Array.isArray(this.selectedRowIds)?this.filteredItems.filter(t=>this.selectedRowIds.some(r=>t[this.idProperty]===r))||[]:[]}syncGridCellCssStyles(e,t){let r,n;const s=o=>{r={},typeof o=="object"&&Object.keys(o).forEach(c=>{if(o&&this.rows[c]){const h=this.rows[c][this.idProperty];r[h]=o[c]}})};s(e.getCellCssStyles(t));const a=()=>{if(typeof r=="object"){n=!0,this.ensureRowsByIdCache();const o={};Object.keys(r).forEach(c=>{var l;const h=(l=this.rowsById)==null?void 0:l[c];oi(h)&&(o[h]=r[c])}),e.setCellCssStyles(t,o),n=!1}};e.onCellCssStylesChanged.subscribe((o,c)=>{n||t!==c.key||(c.hash?s(c.hash):(e.onCellCssStylesChanged.unsubscribe(),this.onRowsOrCountChanged.unsubscribe(a)))}),this.onRowsOrCountChanged.subscribe(a.bind(this))}}/**!
 * Sortable 1.15.7
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ux(i,e,t){return(e=mx(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ms(){return ms=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},ms.apply(null,arguments)}function z0(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),t.push.apply(t,r)}return t}function Xn(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?z0(Object(t),!0).forEach(function(r){ux(i,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):z0(Object(t)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(t,r))})}return i}function dx(i,e){if(i==null)return{};var t,r,n=fx(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(n[t]=i[t])}return n}function fx(i,e){if(i==null)return{};var t={};for(var r in i)if({}.hasOwnProperty.call(i,r)){if(e.indexOf(r)!==-1)continue;t[r]=i[r]}return t}function px(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function mx(i){var e=px(i,"string");return typeof e=="symbol"?e:e+""}function ad(i){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(i)}var gx="1.15.7";function os(i){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(i)}var Es=os(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Tl=os(/Edge/i),G0=os(/firefox/i),Vo=os(/safari/i)&&!os(/chrome/i)&&!os(/android/i),Ld=os(/iP(ad|od|hone)/i),hg=os(/chrome/i)&&os(/android/i),ug={capture:!1,passive:!1};function Mt(i,e,t){i.addEventListener(e,t,!Es&&ug)}function Pt(i,e,t){i.removeEventListener(e,t,!Es&&ug)}function Hc(i,e){if(e){if(e[0]===">"&&(e=e.substring(1)),i)try{if(i.matches)return i.matches(e);if(i.msMatchesSelector)return i.msMatchesSelector(e);if(i.webkitMatchesSelector)return i.webkitMatchesSelector(e)}catch{return!1}return!1}}function dg(i){return i.host&&i!==document&&i.host.nodeType&&i.host!==i?i.host:i.parentNode}function On(i,e,t,r){if(i){t=t||document;do{if(e!=null&&(e[0]===">"?i.parentNode===t&&Hc(i,e):Hc(i,e))||r&&i===t)return i;if(i===t)break}while(i=dg(i))}return null}var $0=/\s+/g;function Xr(i,e,t){if(i&&e)if(i.classList)i.classList[t?"add":"remove"](e);else{var r=(" "+i.className+" ").replace($0," ").replace(" "+e+" "," ");i.className=(r+(t?" "+e:"")).replace($0," ")}}function mt(i,e,t){var r=i&&i.style;if(r){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(i,""):i.currentStyle&&(t=i.currentStyle),e===void 0?t:t[e];!(e in r)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),r[e]=t+(typeof t=="string"?"":"px")}}function Za(i,e){var t="";if(typeof i=="string")t=i;else do{var r=mt(i,"transform");r&&r!=="none"&&(t=r+" "+t)}while(!e&&(i=i.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(t)}function fg(i,e,t){if(i){var r=i.getElementsByTagName(e),n=0,s=r.length;if(t)for(;n<s;n++)t(r[n],n);return r}return[]}function $n(){var i=document.scrollingElement;return i||document.documentElement}function Yi(i,e,t,r,n){if(!(!i.getBoundingClientRect&&i!==window)){var s,a,o,c,h,l,u;if(i!==window&&i.parentNode&&i!==$n()?(s=i.getBoundingClientRect(),a=s.top,o=s.left,c=s.bottom,h=s.right,l=s.height,u=s.width):(a=0,o=0,c=window.innerHeight,h=window.innerWidth,l=window.innerHeight,u=window.innerWidth),(e||t)&&i!==window&&(n=n||i.parentNode,!Es))do if(n&&n.getBoundingClientRect&&(mt(n,"transform")!=="none"||t&&mt(n,"position")!=="static")){var d=n.getBoundingClientRect();a-=d.top+parseInt(mt(n,"border-top-width")),o-=d.left+parseInt(mt(n,"border-left-width")),c=a+s.height,h=o+s.width;break}while(n=n.parentNode);if(r&&i!==window){var f=Za(n||i),p=f&&f.a,m=f&&f.d;f&&(a/=m,o/=p,u/=p,l/=m,c=a+l,h=o+u)}return{top:a,left:o,bottom:c,right:h,width:u,height:l}}}function Y0(i,e,t){for(var r=Rs(i,!0),n=Yi(i)[e];r;){var s=Yi(r)[t],a=void 0;if(a=n>=s,!a)return r;if(r===$n())break;r=Rs(r,!1)}return!1}function ao(i,e,t,r){for(var n=0,s=0,a=i.children;s<a.length;){if(a[s].style.display!=="none"&&a[s]!==nt.ghost&&(r||a[s]!==nt.dragged)&&On(a[s],t.draggable,i,!1)){if(n===e)return a[s];n++}s++}return null}function Bd(i,e){for(var t=i.lastElementChild;t&&(t===nt.ghost||mt(t,"display")==="none"||e&&!Hc(t,e));)t=t.previousElementSibling;return t||null}function dn(i,e){var t=0;if(!i||!i.parentNode)return-1;for(;i=i.previousElementSibling;)i.nodeName.toUpperCase()!=="TEMPLATE"&&i!==nt.clone&&(!e||Hc(i,e))&&t++;return t}function X0(i){var e=0,t=0,r=$n();if(i)do{var n=Za(i),s=n.a,a=n.d;e+=i.scrollLeft*s,t+=i.scrollTop*a}while(i!==r&&(i=i.parentNode));return[e,t]}function vx(i,e){for(var t in i)if(i.hasOwnProperty(t)){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===i[t][r])return Number(t)}return-1}function Rs(i,e){if(!i||!i.getBoundingClientRect)return $n();var t=i,r=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var n=mt(t);if(t.clientWidth<t.scrollWidth&&(n.overflowX=="auto"||n.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(n.overflowY=="auto"||n.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return $n();if(r||e)return t;r=!0}}while(t=t.parentNode);return $n()}function _x(i,e){if(i&&e)for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function du(i,e){return Math.round(i.top)===Math.round(e.top)&&Math.round(i.left)===Math.round(e.left)&&Math.round(i.height)===Math.round(e.height)&&Math.round(i.width)===Math.round(e.width)}var Uo;function pg(i,e){return function(){if(!Uo){var t=arguments,r=this;t.length===1?i.call(r,t[0]):i.apply(r,t),Uo=setTimeout(function(){Uo=void 0},e)}}}function Ex(){clearTimeout(Uo),Uo=void 0}function mg(i,e,t){i.scrollLeft+=e,i.scrollTop+=t}function gg(i){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(i).cloneNode(!0):t?t(i).clone(!0)[0]:i.cloneNode(!0)}function vg(i,e,t){var r={};return Array.from(i.children).forEach(function(n){var s,a,o,c;if(!(!On(n,e.draggable,i,!1)||n.animated||n===t)){var h=Yi(n);r.left=Math.min((s=r.left)!==null&&s!==void 0?s:1/0,h.left),r.top=Math.min((a=r.top)!==null&&a!==void 0?a:1/0,h.top),r.right=Math.max((o=r.right)!==null&&o!==void 0?o:-1/0,h.right),r.bottom=Math.max((c=r.bottom)!==null&&c!==void 0?c:-1/0,h.bottom)}}),r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}var Vr="Sortable"+new Date().getTime();function xx(){var i=[],e;return{captureAnimationState:function(){if(i=[],!!this.options.animation){var r=[].slice.call(this.el.children);r.forEach(function(n){if(!(mt(n,"display")==="none"||n===nt.ghost)){i.push({target:n,rect:Yi(n)});var s=Xn({},i[i.length-1].rect);if(n.thisAnimationDuration){var a=Za(n,!0);a&&(s.top-=a.f,s.left-=a.e)}n.fromRect=s}})}},addAnimationState:function(r){i.push(r)},removeAnimationState:function(r){i.splice(vx(i,{target:r}),1)},animateAll:function(r){var n=this;if(!this.options.animation){clearTimeout(e),typeof r=="function"&&r();return}var s=!1,a=0;i.forEach(function(o){var c=0,h=o.target,l=h.fromRect,u=Yi(h),d=h.prevFromRect,f=h.prevToRect,p=o.rect,m=Za(h,!0);m&&(u.top-=m.f,u.left-=m.e),h.toRect=u,h.thisAnimationDuration&&du(d,u)&&!du(l,u)&&(p.top-u.top)/(p.left-u.left)===(l.top-u.top)/(l.left-u.left)&&(c=Cx(p,d,f,n.options)),du(u,l)||(h.prevFromRect=l,h.prevToRect=u,c||(c=n.options.animation),n.animate(h,p,u,c)),c&&(s=!0,a=Math.max(a,c),clearTimeout(h.animationResetTimer),h.animationResetTimer=setTimeout(function(){h.animationTime=0,h.prevFromRect=null,h.fromRect=null,h.prevToRect=null,h.thisAnimationDuration=null},c),h.thisAnimationDuration=c)}),clearTimeout(e),s?e=setTimeout(function(){typeof r=="function"&&r()},a):typeof r=="function"&&r(),i=[]},animate:function(r,n,s,a){if(a){mt(r,"transition",""),mt(r,"transform","");var o=Za(this.el),c=o&&o.a,h=o&&o.d,l=(n.left-s.left)/(c||1),u=(n.top-s.top)/(h||1);r.animatingX=!!l,r.animatingY=!!u,mt(r,"transform","translate3d("+l+"px,"+u+"px,0)"),this.forRepaintDummy=wx(r),mt(r,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),mt(r,"transform","translate3d(0,0,0)"),typeof r.animated=="number"&&clearTimeout(r.animated),r.animated=setTimeout(function(){mt(r,"transition",""),mt(r,"transform",""),r.animated=!1,r.animatingX=!1,r.animatingY=!1},a)}}}}function wx(i){return i.offsetWidth}function Cx(i,e,t,r){return Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*r.animation}var La=[],fu={initializeByDefault:!0},Al={mount:function(e){for(var t in fu)fu.hasOwnProperty(t)&&!(t in e)&&(e[t]=fu[t]);La.forEach(function(r){if(r.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),La.push(e)},pluginEvent:function(e,t,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var s=e+"Global";La.forEach(function(a){t[a.pluginName]&&(t[a.pluginName][s]&&t[a.pluginName][s](Xn({sortable:t},r)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](Xn({sortable:t},r)))})},initializePlugins:function(e,t,r,n){La.forEach(function(o){var c=o.pluginName;if(!(!e.options[c]&&!o.initializeByDefault)){var h=new o(e,t,e.options);h.sortable=e,h.options=e.options,e[c]=h,ms(r,h.defaults)}});for(var s in e.options)if(e.options.hasOwnProperty(s)){var a=this.modifyOption(e,s,e.options[s]);typeof a<"u"&&(e.options[s]=a)}},getEventProperties:function(e,t){var r={};return La.forEach(function(n){typeof n.eventProperties=="function"&&ms(r,n.eventProperties.call(t[n.pluginName],e))}),r},modifyOption:function(e,t,r){var n;return La.forEach(function(s){e[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[t]=="function"&&(n=s.optionListeners[t].call(e[s.pluginName],r))}),n}};function yx(i){var e=i.sortable,t=i.rootEl,r=i.name,n=i.targetEl,s=i.cloneEl,a=i.toEl,o=i.fromEl,c=i.oldIndex,h=i.newIndex,l=i.oldDraggableIndex,u=i.newDraggableIndex,d=i.originalEvent,f=i.putSortable,p=i.extraEventProperties;if(e=e||t&&t[Vr],!!e){var m,v=e.options,_="on"+r.charAt(0).toUpperCase()+r.substr(1);window.CustomEvent&&!Es&&!Tl?m=new CustomEvent(r,{bubbles:!0,cancelable:!0}):(m=document.createEvent("Event"),m.initEvent(r,!0,!0)),m.to=a||t,m.from=o||t,m.item=n||t,m.clone=s,m.oldIndex=c,m.newIndex=h,m.oldDraggableIndex=l,m.newDraggableIndex=u,m.originalEvent=d,m.pullMode=f?f.lastPutMode:void 0;var x=Xn(Xn({},p),Al.getEventProperties(r,e));for(var E in x)m[E]=x[E];t&&t.dispatchEvent(m),v[_]&&v[_].call(e,m)}}var Sx=["evt"],Fr=function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.evt,s=dx(r,Sx);Al.pluginEvent.bind(nt)(e,t,Xn({dragEl:We,parentEl:Si,ghostEl:yt,rootEl:mi,nextEl:ia,lastDownEl:bc,cloneEl:Ei,cloneHidden:Os,dragStarted:Fo,putSortable:rr,activeSortable:nt.active,originalEvent:n,oldIndex:$a,oldDraggableIndex:Wo,newIndex:qr,newDraggableIndex:ks,hideGhostForTarget:wg,unhideGhostForTarget:Cg,cloneNowHidden:function(){Os=!0},cloneNowShown:function(){Os=!1},dispatchSortableEvent:function(o){br({sortable:t,name:o,originalEvent:n})}},s))};function br(i){yx(Xn({putSortable:rr,cloneEl:Ei,targetEl:We,rootEl:mi,oldIndex:$a,oldDraggableIndex:Wo,newIndex:qr,newDraggableIndex:ks},i))}var We,Si,yt,mi,ia,bc,Ei,Os,$a,qr,Wo,ks,Jl,rr,za=!1,Vc=!1,Uc=[],Js,bn,pu,mu,q0,K0,Fo,Ba,zo,Go=!1,ec=!1,Tc,cr,gu=[],od=!1,Wc=[],vh=typeof document<"u",tc=Ld,j0=Tl||Es?"cssFloat":"float",bx=vh&&!hg&&!Ld&&"draggable"in document.createElement("div"),_g=function(){if(vh){if(Es)return!1;var i=document.createElement("x");return i.style.cssText="pointer-events:auto",i.style.pointerEvents==="auto"}}(),Eg=function(e,t){var r=mt(e),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),s=ao(e,0,t),a=ao(e,1,t),o=s&&mt(s),c=a&&mt(a),h=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Yi(s).width,l=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+Yi(a).width;if(r.display==="flex")return r.flexDirection==="column"||r.flexDirection==="column-reverse"?"vertical":"horizontal";if(r.display==="grid")return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&o.float&&o.float!=="none"){var u=o.float==="left"?"left":"right";return a&&(c.clear==="both"||c.clear===u)?"vertical":"horizontal"}return s&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||h>=n&&r[j0]==="none"||a&&r[j0]==="none"&&h+l>n)?"vertical":"horizontal"},Tx=function(e,t,r){var n=r?e.left:e.top,s=r?e.right:e.bottom,a=r?e.width:e.height,o=r?t.left:t.top,c=r?t.right:t.bottom,h=r?t.width:t.height;return n===o||s===c||n+a/2===o+h/2},Ax=function(e,t){var r;return Uc.some(function(n){var s=n[Vr].options.emptyInsertThreshold;if(!(!s||Bd(n))){var a=Yi(n),o=e>=a.left-s&&e<=a.right+s,c=t>=a.top-s&&t<=a.bottom+s;if(o&&c)return r=n}}),r},xg=function(e){function t(s,a){return function(o,c,h,l){var u=o.options.group.name&&c.options.group.name&&o.options.group.name===c.options.group.name;if(s==null&&(a||u))return!0;if(s==null||s===!1)return!1;if(a&&s==="clone")return s;if(typeof s=="function")return t(s(o,c,h,l),a)(o,c,h,l);var d=(a?o:c).options.group.name;return s===!0||typeof s=="string"&&s===d||s.join&&s.indexOf(d)>-1}}var r={},n=e.group;(!n||ad(n)!="object")&&(n={name:n}),r.name=n.name,r.checkPull=t(n.pull,!0),r.checkPut=t(n.put),r.revertClone=n.revertClone,e.group=r},wg=function(){!_g&&yt&&mt(yt,"display","none")},Cg=function(){!_g&&yt&&mt(yt,"display","")};vh&&!hg&&document.addEventListener("click",function(i){if(Vc)return i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.stopImmediatePropagation&&i.stopImmediatePropagation(),Vc=!1,!1},!0);var ea=function(e){if(We){e=e.touches?e.touches[0]:e;var t=Ax(e.clientX,e.clientY);if(t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[Vr]._onDragOver(r)}}},kx=function(e){We&&We.parentNode[Vr]._isOutsideThisEl(e.target)};function nt(i,e){if(!(i&&i.nodeType&&i.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(i));this.el=i,this.options=e=ms({},e),i[Vr]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(i.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Eg(i,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:nt.supportPointer!==!1&&"PointerEvent"in window&&(!Vo||Ld),emptyInsertThreshold:5};Al.initializePlugins(this,i,t);for(var r in t)!(r in e)&&(e[r]=t[r]);xg(e);for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));this.nativeDraggable=e.forceFallback?!1:bx,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Mt(i,"pointerdown",this._onTapStart):(Mt(i,"mousedown",this._onTapStart),Mt(i,"touchstart",this._onTapStart)),this.nativeDraggable&&(Mt(i,"dragover",this),Mt(i,"dragenter",this)),Uc.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ms(this,xx())}nt.prototype={constructor:nt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ba=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,We):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,n=this.options,s=n.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,c=(o||e).target,h=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||c,l=n.filter;if(Mx(r),!We&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||n.disabled)&&!h.isContentEditable&&!(!this.nativeDraggable&&Vo&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=On(c,n.draggable,r,!1),!(c&&c.animated)&&bc!==c)){if($a=dn(c),Wo=dn(c,n.draggable),typeof l=="function"){if(l.call(this,e,c,this)){br({sortable:t,rootEl:h,name:"filter",targetEl:c,toEl:r,fromEl:r}),Fr("filter",t,{evt:e}),s&&e.preventDefault();return}}else if(l&&(l=l.split(",").some(function(u){if(u=On(h,u.trim(),r,!1),u)return br({sortable:t,rootEl:u,name:"filter",targetEl:c,fromEl:r,toEl:r}),Fr("filter",t,{evt:e}),!0}),l)){s&&e.preventDefault();return}n.handle&&!On(h,n.handle,r,!1)||this._prepareDragStart(e,o,c)}}},_prepareDragStart:function(e,t,r){var n=this,s=n.el,a=n.options,o=s.ownerDocument,c;if(r&&!We&&r.parentNode===s){var h=Yi(r);if(mi=s,We=r,Si=We.parentNode,ia=We.nextSibling,bc=r,Jl=a.group,nt.dragged=We,Js={target:We,clientX:(t||e).clientX,clientY:(t||e).clientY},q0=Js.clientX-h.left,K0=Js.clientY-h.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,We.style["will-change"]="all",c=function(){if(Fr("delayEnded",n,{evt:e}),nt.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!G0&&n.nativeDraggable&&(We.draggable=!0),n._triggerDragStart(e,t),br({sortable:n,name:"choose",originalEvent:e}),Xr(We,a.chosenClass,!0)},a.ignore.split(",").forEach(function(l){fg(We,l.trim(),vu)}),Mt(o,"dragover",ea),Mt(o,"mousemove",ea),Mt(o,"touchmove",ea),a.supportPointer?(Mt(o,"pointerup",n._onDrop),!this.nativeDraggable&&Mt(o,"pointercancel",n._onDrop)):(Mt(o,"mouseup",n._onDrop),Mt(o,"touchend",n._onDrop),Mt(o,"touchcancel",n._onDrop)),G0&&this.nativeDraggable&&(this.options.touchStartThreshold=4,We.draggable=!0),Fr("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(Tl||Es))){if(nt.eventCanceled){this._onDrop();return}a.supportPointer?(Mt(o,"pointerup",n._disableDelayedDrag),Mt(o,"pointercancel",n._disableDelayedDrag)):(Mt(o,"mouseup",n._disableDelayedDrag),Mt(o,"touchend",n._disableDelayedDrag),Mt(o,"touchcancel",n._disableDelayedDrag)),Mt(o,"mousemove",n._delayedDragTouchMoveHandler),Mt(o,"touchmove",n._delayedDragTouchMoveHandler),a.supportPointer&&Mt(o,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(c,a.delay)}else c()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){We&&vu(We),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Pt(e,"mouseup",this._disableDelayedDrag),Pt(e,"touchend",this._disableDelayedDrag),Pt(e,"touchcancel",this._disableDelayedDrag),Pt(e,"pointerup",this._disableDelayedDrag),Pt(e,"pointercancel",this._disableDelayedDrag),Pt(e,"mousemove",this._delayedDragTouchMoveHandler),Pt(e,"touchmove",this._delayedDragTouchMoveHandler),Pt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?Mt(document,"pointermove",this._onTouchMove):t?Mt(document,"touchmove",this._onTouchMove):Mt(document,"mousemove",this._onTouchMove):(Mt(We,"dragend",this),Mt(mi,"dragstart",this._onDragStart));try{document.selection?Ac(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(za=!1,mi&&We){Fr("dragStarted",this,{evt:t}),this.nativeDraggable&&Mt(document,"dragover",kx);var r=this.options;!e&&Xr(We,r.dragClass,!1),Xr(We,r.ghostClass,!0),nt.active=this,e&&this._appendGhost(),br({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(bn){this._lastX=bn.clientX,this._lastY=bn.clientY,wg();for(var e=document.elementFromPoint(bn.clientX,bn.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(bn.clientX,bn.clientY),e!==t);)t=e;if(We.parentNode[Vr]._isOutsideThisEl(e),t)do{if(t[Vr]){var r=void 0;if(r=t[Vr]._onDragOver({clientX:bn.clientX,clientY:bn.clientY,target:e,rootEl:t}),r&&!this.options.dragoverBubble)break}e=t}while(t=dg(t));Cg()}},_onTouchMove:function(e){if(Js){var t=this.options,r=t.fallbackTolerance,n=t.fallbackOffset,s=e.touches?e.touches[0]:e,a=yt&&Za(yt,!0),o=yt&&a&&a.a,c=yt&&a&&a.d,h=tc&&cr&&X0(cr),l=(s.clientX-Js.clientX+n.x)/(o||1)+(h?h[0]-gu[0]:0)/(o||1),u=(s.clientY-Js.clientY+n.y)/(c||1)+(h?h[1]-gu[1]:0)/(c||1);if(!nt.active&&!za){if(r&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if(yt){a?(a.e+=l-(pu||0),a.f+=u-(mu||0)):a={a:1,b:0,c:0,d:1,e:l,f:u};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");mt(yt,"webkitTransform",d),mt(yt,"mozTransform",d),mt(yt,"msTransform",d),mt(yt,"transform",d),pu=l,mu=u,bn=s}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!yt){var e=this.options.fallbackOnBody?document.body:mi,t=Yi(We,!0,tc,!0,e),r=this.options;if(tc){for(cr=e;mt(cr,"position")==="static"&&mt(cr,"transform")==="none"&&cr!==document;)cr=cr.parentNode;cr!==document.body&&cr!==document.documentElement?(cr===document&&(cr=$n()),t.top+=cr.scrollTop,t.left+=cr.scrollLeft):cr=$n(),gu=X0(cr)}yt=We.cloneNode(!0),Xr(yt,r.ghostClass,!1),Xr(yt,r.fallbackClass,!0),Xr(yt,r.dragClass,!0),mt(yt,"transition",""),mt(yt,"transform",""),mt(yt,"box-sizing","border-box"),mt(yt,"margin",0),mt(yt,"top",t.top),mt(yt,"left",t.left),mt(yt,"width",t.width),mt(yt,"height",t.height),mt(yt,"opacity","0.8"),mt(yt,"position",tc?"absolute":"fixed"),mt(yt,"zIndex","100000"),mt(yt,"pointerEvents","none"),nt.ghost=yt,e.appendChild(yt),mt(yt,"transform-origin",q0/parseInt(yt.style.width)*100+"% "+K0/parseInt(yt.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,n=e.dataTransfer,s=r.options;if(Fr("dragStart",this,{evt:e}),nt.eventCanceled){this._onDrop();return}Fr("setupClone",this),nt.eventCanceled||(Ei=gg(We),Ei.removeAttribute("id"),Ei.draggable=!1,Ei.style["will-change"]="",this._hideClone(),Xr(Ei,this.options.chosenClass,!1),nt.clone=Ei),r.cloneId=Ac(function(){Fr("clone",r),!nt.eventCanceled&&(r.options.removeCloneOnHide||mi.insertBefore(Ei,We),r._hideClone(),br({sortable:r,name:"clone"}))}),!t&&Xr(We,s.dragClass,!0),t?(Vc=!0,r._loopId=setInterval(r._emulateDragOver,50)):(Pt(document,"mouseup",r._onDrop),Pt(document,"touchend",r._onDrop),Pt(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",s.setData&&s.setData.call(r,n,We)),Mt(document,"drop",r),mt(We,"transform","translateZ(0)")),za=!0,r._dragStartId=Ac(r._dragStarted.bind(r,t,e)),Mt(document,"selectstart",r),Fo=!0,window.getSelection().removeAllRanges(),Vo&&mt(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,r=e.target,n,s,a,o=this.options,c=o.group,h=nt.active,l=Jl===c,u=o.sort,d=rr||h,f,p=this,m=!1;if(od)return;function v(Ze,ie){Fr(Ze,p,Xn({evt:e,isOwner:l,axis:f?"vertical":"horizontal",revert:a,dragRect:n,targetRect:s,canSort:u,fromSortable:d,target:r,completed:x,onMove:function(Pe,U){return ic(mi,t,We,n,Pe,Yi(Pe),e,U)},changed:E},ie))}function _(){v("dragOverAnimationCapture"),p.captureAnimationState(),p!==d&&d.captureAnimationState()}function x(Ze){return v("dragOverCompleted",{insertion:Ze}),Ze&&(l?h._hideClone():h._showClone(p),p!==d&&(Xr(We,rr?rr.options.ghostClass:h.options.ghostClass,!1),Xr(We,o.ghostClass,!0)),rr!==p&&p!==nt.active?rr=p:p===nt.active&&rr&&(rr=null),d===p&&(p._ignoreWhileAnimating=r),p.animateAll(function(){v("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(r===We&&!We.animated||r===t&&!r.animated)&&(Ba=null),!o.dragoverBubble&&!e.rootEl&&r!==document&&(We.parentNode[Vr]._isOutsideThisEl(e.target),!Ze&&ea(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function E(){qr=dn(We),ks=dn(We,o.draggable),br({sortable:p,name:"change",toEl:t,newIndex:qr,newDraggableIndex:ks,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),r=On(r,o.draggable,t,!0),v("dragOver"),nt.eventCanceled)return m;if(We.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||p._ignoreWhileAnimating===r)return x(!1);if(Vc=!1,h&&!o.disabled&&(l?u||(a=Si!==mi):rr===this||(this.lastPutMode=Jl.checkPull(this,h,We,e))&&c.checkPut(this,h,We,e))){if(f=this._getDirection(e,r)==="vertical",n=Yi(We),v("dragOverValid"),nt.eventCanceled)return m;if(a)return Si=mi,_(),this._hideClone(),v("revert"),nt.eventCanceled||(ia?mi.insertBefore(We,ia):mi.appendChild(We)),x(!0);var C=Bd(t,o.draggable);if(!C||Dx(e,f,this)&&!C.animated){if(C===We)return x(!1);if(C&&t===e.target&&(r=C),r&&(s=Yi(r)),ic(mi,t,We,n,r,s,e,!!r)!==!1)return _(),C&&C.nextSibling?t.insertBefore(We,C.nextSibling):t.appendChild(We),Si=t,E(),x(!0)}else if(C&&Rx(e,f,this)){var y=ao(t,0,o,!0);if(y===We)return x(!1);if(r=y,s=Yi(r),ic(mi,t,We,n,r,s,e,!1)!==!1)return _(),t.insertBefore(We,y),Si=t,E(),x(!0)}else if(r.parentNode===t){s=Yi(r);var b=0,T,R=We.parentNode!==t,O=!Tx(We.animated&&We.toRect||n,r.animated&&r.toRect||s,f),W=f?"top":"left",G=Y0(r,"top","top")||Y0(We,"top","top"),Q=G?G.scrollTop:void 0;Ba!==r&&(T=s[W],Go=!1,ec=!O&&o.invertSwap||R),b=Fx(e,r,s,f,O?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,ec,Ba===r);var ne;if(b!==0){var xe=dn(We);do xe-=b,ne=Si.children[xe];while(ne&&(mt(ne,"display")==="none"||ne===yt))}if(b===0||ne===r)return x(!1);Ba=r,zo=b;var Ce=r.nextElementSibling,Fe=!1;Fe=b===1;var ke=ic(mi,t,We,n,r,s,e,Fe);if(ke!==!1)return(ke===1||ke===-1)&&(Fe=ke===1),od=!0,setTimeout(Ix,30),_(),Fe&&!Ce?t.appendChild(We):r.parentNode.insertBefore(We,Fe?Ce:r),G&&mg(G,0,Q-G.scrollTop),Si=We.parentNode,T!==void 0&&!ec&&(Tc=Math.abs(T-Yi(r)[W])),E(),x(!0)}if(t.contains(We))return x(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Pt(document,"mousemove",this._onTouchMove),Pt(document,"touchmove",this._onTouchMove),Pt(document,"pointermove",this._onTouchMove),Pt(document,"dragover",ea),Pt(document,"mousemove",ea),Pt(document,"touchmove",ea)},_offUpEvents:function(){var e=this.el.ownerDocument;Pt(e,"mouseup",this._onDrop),Pt(e,"touchend",this._onDrop),Pt(e,"pointerup",this._onDrop),Pt(e,"pointercancel",this._onDrop),Pt(e,"touchcancel",this._onDrop),Pt(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;if(qr=dn(We),ks=dn(We,r.draggable),Fr("drop",this,{evt:e}),Si=We&&We.parentNode,qr=dn(We),ks=dn(We,r.draggable),nt.eventCanceled){this._nulling();return}za=!1,ec=!1,Go=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ld(this.cloneId),ld(this._dragStartId),this.nativeDraggable&&(Pt(document,"drop",this),Pt(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Vo&&mt(document.body,"user-select",""),mt(We,"transform",""),e&&(Fo&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),yt&&yt.parentNode&&yt.parentNode.removeChild(yt),(mi===Si||rr&&rr.lastPutMode!=="clone")&&Ei&&Ei.parentNode&&Ei.parentNode.removeChild(Ei),We&&(this.nativeDraggable&&Pt(We,"dragend",this),vu(We),We.style["will-change"]="",Fo&&!za&&Xr(We,rr?rr.options.ghostClass:this.options.ghostClass,!1),Xr(We,this.options.chosenClass,!1),br({sortable:this,name:"unchoose",toEl:Si,newIndex:null,newDraggableIndex:null,originalEvent:e}),mi!==Si?(qr>=0&&(br({rootEl:Si,name:"add",toEl:Si,fromEl:mi,originalEvent:e}),br({sortable:this,name:"remove",toEl:Si,originalEvent:e}),br({rootEl:Si,name:"sort",toEl:Si,fromEl:mi,originalEvent:e}),br({sortable:this,name:"sort",toEl:Si,originalEvent:e})),rr&&rr.save()):qr!==$a&&qr>=0&&(br({sortable:this,name:"update",toEl:Si,originalEvent:e}),br({sortable:this,name:"sort",toEl:Si,originalEvent:e})),nt.active&&((qr==null||qr===-1)&&(qr=$a,ks=Wo),br({sortable:this,name:"end",toEl:Si,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){Fr("nulling",this),mi=We=Si=yt=ia=Ei=bc=Os=Js=bn=Fo=qr=ks=$a=Wo=Ba=zo=rr=Jl=nt.dragged=nt.ghost=nt.clone=nt.active=null;var e=this.el;Wc.forEach(function(t){e.contains(t)&&(t.checked=!0)}),Wc.length=pu=mu=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":We&&(this._onDragOver(e),Ox(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,r=this.el.children,n=0,s=r.length,a=this.options;n<s;n++)t=r[n],On(t,a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||Nx(t));return e},sort:function(e,t){var r={},n=this.el;this.toArray().forEach(function(s,a){var o=n.children[a];On(o,this.options.draggable,n,!1)&&(r[s]=o)},this),t&&this.captureAnimationState(),e.forEach(function(s){r[s]&&(n.removeChild(r[s]),n.appendChild(r[s]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return On(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(t===void 0)return r[e];var n=Al.modifyOption(this,e,t);typeof n<"u"?r[e]=n:r[e]=t,e==="group"&&xg(r)},destroy:function(){Fr("destroy",this);var e=this.el;e[Vr]=null,Pt(e,"mousedown",this._onTapStart),Pt(e,"touchstart",this._onTapStart),Pt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Pt(e,"dragover",this),Pt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Uc.splice(Uc.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Os){if(Fr("hideClone",this),nt.eventCanceled)return;mt(Ei,"display","none"),this.options.removeCloneOnHide&&Ei.parentNode&&Ei.parentNode.removeChild(Ei),Os=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Os){if(Fr("showClone",this),nt.eventCanceled)return;We.parentNode==mi&&!this.options.group.revertClone?mi.insertBefore(Ei,We):ia?mi.insertBefore(Ei,ia):mi.appendChild(Ei),this.options.group.revertClone&&this.animate(We,Ei),mt(Ei,"display",""),Os=!1}}};function Ox(i){i.dataTransfer&&(i.dataTransfer.dropEffect="move"),i.cancelable&&i.preventDefault()}function ic(i,e,t,r,n,s,a,o){var c,h=i[Vr],l=h.options.onMove,u;return window.CustomEvent&&!Es&&!Tl?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=e,c.from=i,c.dragged=t,c.draggedRect=r,c.related=n||e,c.relatedRect=s||Yi(e),c.willInsertAfter=o,c.originalEvent=a,i.dispatchEvent(c),l&&(u=l.call(h,c,a)),u}function vu(i){i.draggable=!1}function Ix(){od=!1}function Rx(i,e,t){var r=Yi(ao(t.el,0,t.options,!0)),n=vg(t.el,t.options,yt),s=10;return e?i.clientX<n.left-s||i.clientY<r.top&&i.clientX<r.right:i.clientY<n.top-s||i.clientY<r.bottom&&i.clientX<r.left}function Dx(i,e,t){var r=Yi(Bd(t.el,t.options.draggable)),n=vg(t.el,t.options,yt),s=10;return e?i.clientX>n.right+s||i.clientY>r.bottom&&i.clientX>r.left:i.clientY>n.bottom+s||i.clientX>r.right&&i.clientY>r.top}function Fx(i,e,t,r,n,s,a,o){var c=r?i.clientY:i.clientX,h=r?t.height:t.width,l=r?t.top:t.left,u=r?t.bottom:t.right,d=!1;if(!a){if(o&&Tc<h*n){if(!Go&&(zo===1?c>l+h*s/2:c<u-h*s/2)&&(Go=!0),Go)d=!0;else if(zo===1?c<l+Tc:c>u-Tc)return-zo}else if(c>l+h*(1-n)/2&&c<u-h*(1-n)/2)return Px(e)}return d=d||a,d&&(c<l+h*s/2||c>u-h*s/2)?c>l+h/2?1:-1:0}function Px(i){return dn(We)<dn(i)?1:-1}function Nx(i){for(var e=i.tagName+i.className+i.src+i.href+i.textContent,t=e.length,r=0;t--;)r+=e.charCodeAt(t);return r.toString(36)}function Mx(i){Wc.length=0;for(var e=i.getElementsByTagName("input"),t=e.length;t--;){var r=e[t];r.checked&&Wc.push(r)}}function Ac(i){return setTimeout(i,0)}function ld(i){return clearTimeout(i)}vh&&Mt(document,"touchmove",function(i){(nt.active||za)&&i.cancelable&&i.preventDefault()});nt.utils={on:Mt,off:Pt,css:mt,find:fg,is:function(e,t){return!!On(e,t,e,!1)},extend:_x,throttle:pg,closest:On,toggleClass:Xr,clone:gg,index:dn,nextTick:Ac,cancelNextTick:ld,detectDirection:Eg,getChild:ao,expando:Vr};nt.get=function(i){return i[Vr]};nt.mount=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(r){if(!r.prototype||!r.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(r));r.utils&&(nt.utils=Xn(Xn({},nt.utils),r.utils)),Al.mount(r)})};nt.create=function(i,e){return new nt(i,e)};nt.version=gx;var zi=[],Po,cd,hd=!1,_u,Eu,zc,No;function Lx(){function i(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return i.prototype={dragStarted:function(t){var r=t.originalEvent;this.sortable.nativeDraggable?Mt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Mt(document,"pointermove",this._handleFallbackAutoScroll):r.touches?Mt(document,"touchmove",this._handleFallbackAutoScroll):Mt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var r=t.originalEvent;!this.options.dragOverBubble&&!r.rootEl&&this._handleAutoScroll(r)},drop:function(){this.sortable.nativeDraggable?Pt(document,"dragover",this._handleAutoScroll):(Pt(document,"pointermove",this._handleFallbackAutoScroll),Pt(document,"touchmove",this._handleFallbackAutoScroll),Pt(document,"mousemove",this._handleFallbackAutoScroll)),Q0(),kc(),Ex()},nulling:function(){zc=cd=Po=hd=No=_u=Eu=null,zi.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,r){var n=this,s=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,o=document.elementFromPoint(s,a);if(zc=t,r||this.options.forceAutoScrollFallback||Tl||Es||Vo){xu(t,this.options,o,r);var c=Rs(o,!0);hd&&(!No||s!==_u||a!==Eu)&&(No&&Q0(),No=setInterval(function(){var h=Rs(document.elementFromPoint(s,a),!0);h!==c&&(c=h,kc()),xu(t,n.options,h,r)},10),_u=s,Eu=a)}else{if(!this.options.bubbleScroll||Rs(o,!0)===$n()){kc();return}xu(t,this.options,Rs(o,!1),!1)}}},ms(i,{pluginName:"scroll",initializeByDefault:!0})}function kc(){zi.forEach(function(i){clearInterval(i.pid)}),zi=[]}function Q0(){clearInterval(No)}var xu=pg(function(i,e,t,r){if(e.scroll){var n=(i.touches?i.touches[0]:i).clientX,s=(i.touches?i.touches[0]:i).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,c=$n(),h=!1,l;cd!==t&&(cd=t,kc(),Po=e.scroll,l=e.scrollFn,Po===!0&&(Po=Rs(t,!0)));var u=0,d=Po;do{var f=d,p=Yi(f),m=p.top,v=p.bottom,_=p.left,x=p.right,E=p.width,C=p.height,y=void 0,b=void 0,T=f.scrollWidth,R=f.scrollHeight,O=mt(f),W=f.scrollLeft,G=f.scrollTop;f===c?(y=E<T&&(O.overflowX==="auto"||O.overflowX==="scroll"||O.overflowX==="visible"),b=C<R&&(O.overflowY==="auto"||O.overflowY==="scroll"||O.overflowY==="visible")):(y=E<T&&(O.overflowX==="auto"||O.overflowX==="scroll"),b=C<R&&(O.overflowY==="auto"||O.overflowY==="scroll"));var Q=y&&(Math.abs(x-n)<=a&&W+E<T)-(Math.abs(_-n)<=a&&!!W),ne=b&&(Math.abs(v-s)<=a&&G+C<R)-(Math.abs(m-s)<=a&&!!G);if(!zi[u])for(var xe=0;xe<=u;xe++)zi[xe]||(zi[xe]={});(zi[u].vx!=Q||zi[u].vy!=ne||zi[u].el!==f)&&(zi[u].el=f,zi[u].vx=Q,zi[u].vy=ne,clearInterval(zi[u].pid),(Q!=0||ne!=0)&&(h=!0,zi[u].pid=setInterval((function(){r&&this.layer===0&&nt.active._onTouchMove(zc);var Ce=zi[this.layer].vy?zi[this.layer].vy*o:0,Fe=zi[this.layer].vx?zi[this.layer].vx*o:0;typeof l=="function"&&l.call(nt.dragged.parentNode[Vr],Fe,Ce,i,zc,zi[this.layer].el)!=="continue"||mg(zi[this.layer].el,Fe,Ce)}).bind({layer:u}),24))),u++}while(e.bubbleScroll&&d!==c&&(d=Rs(d,!1)));hd=h}},30),yg=function(e){var t=e.originalEvent,r=e.putSortable,n=e.dragEl,s=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,c=e.unhideGhostForTarget;if(t){var h=r||s;o();var l=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(l.clientX,l.clientY);c(),h&&!h.el.contains(u)&&(a("spill"),this.onSpill({dragEl:n,putSortable:r}))}};function Hd(){}Hd.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=ao(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:yg};ms(Hd,{pluginName:"revertOnSpill"});function Vd(){}Vd.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable,n=r||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:yg};ms(Vd,{pluginName:"removeOnSpill"});nt.mount(new Lx);nt.mount(Vd,Hd);function Z0(i){let{containerElement:e}=i;const{onDragInit:t,onDragStart:r,onDrag:n,onDragEnd:s}=i;let a,o,c,h,l,u;e||(e=document.body);let d={dragSource:e,dragHandle:null};function f(){e&&(e.addEventListener("mousedown",v),e.addEventListener("touchstart",v))}function p(E,C,y){if(typeof E=="function")return E(C,y)}function m(){e&&(e.removeEventListener("mousedown",v),e.removeEventListener("touchstart",v))}function v(E){var b;a=E.target;const C=((b=E==null?void 0:E.touches)==null?void 0:b[0])??E,{target:y}=C;if(!i.allowDragFrom||i.allowDragFrom&&a.matches(i.allowDragFrom)||i.allowDragFromClosest&&a.closest(i.allowDragFromClosest)){d.dragHandle=a;const T=Dd();o=T.left+C.clientX,c=T.top+C.clientY,h=C.clientX-C.clientX,l=C.clientY-C.clientY,d=Object.assign(d,{deltaX:h,deltaY:l,startX:o,startY:c,target:y}),p(t,E,d)!==!1&&(document.body.addEventListener("mousemove",_),document.body.addEventListener("touchmove",_),document.body.addEventListener("mouseup",x),document.body.addEventListener("touchend",x),document.body.addEventListener("touchcancel",x))}}function _(E){var b;const C=((b=E==null?void 0:E.touches)==null?void 0:b[0])??E;h=C.clientX-o,l=C.clientY-c;const{target:y}=C;u||(d=Object.assign(d,{deltaX:h,deltaY:l,startX:o,startY:c,target:y}),p(r,E,d),u=!0),d=Object.assign(d,{deltaX:h,deltaY:l,startX:o,startY:c,target:y}),p(n,E,d)}function x(E){if(document.body.removeEventListener("mousemove",_),document.body.removeEventListener("touchmove",_),document.body.removeEventListener("mouseup",x),document.body.removeEventListener("touchend",x),document.body.removeEventListener("touchcancel",x),u){const{target:C}=E;d=Object.assign(d,{target:C}),p(s,E,d),u=!1}}return f(),{destroy:m}}function J0(i){const{element:e,onMouseWheel:t}=i;function r(){e.removeEventListener("wheel",s),e.removeEventListener("mousewheel",s)}function n(){e.addEventListener("wheel",s),e.addEventListener("mousewheel",s)}function s(a){const o=a||window.event;let c=0,h=0,l=0;o.wheelDelta&&(c=o.wheelDelta/120),o.detail&&(c=-o.detail/3),l=c,o.axis!==void 0&&o.axis===o.HORIZONTAL_AXIS&&(l=0,h=-1*c),o.wheelDeltaY!==void 0&&(l=o.wheelDeltaY/120),o.wheelDeltaX!==void 0&&(h=-1*o.wheelDeltaX/120),typeof t=="function"&&t(a,c,h,l)}return n(),{destroy:r}}function ep(i){const{resizeableElement:e,resizeableHandleElement:t,onResizeStart:r,onResize:n,onResizeEnd:s}=i;if(!t||typeof t.addEventListener!="function")throw new Error("[SlickResizable] You did not provide a valid html element that will be used for the handle to resize.");function a(){t.addEventListener("mousedown",h),t.addEventListener("touchstart",h)}function o(){typeof(t==null?void 0:t.removeEventListener)=="function"&&(t.removeEventListener("mousedown",h),t.removeEventListener("touchstart",h))}function c(d,f){if(typeof d=="function")return d(f,{resizeableElement:e,resizeableHandleElement:t})}function h(d){d.preventDefault();const f=d.touches?d.changedTouches[0]:d;c(r,f)!==!1&&(document.body.addEventListener("mousemove",l),document.body.addEventListener("mouseup",u),document.body.addEventListener("touchmove",l),document.body.addEventListener("touchend",u))}function l(d){d.preventDefault&&d.type!=="touchmove"&&d.preventDefault();const f=d.touches?d.changedTouches[0]:d;typeof n=="function"&&n(f,{resizeableElement:e,resizeableHandleElement:t})}function u(d){const f=d.touches?d.changedTouches[0]:d;c(s,f),document.body.removeEventListener("mousemove",l),document.body.removeEventListener("mouseup",u),document.body.removeEventListener("touchmove",l),document.body.removeEventListener("touchend",u)}return a(),{destroy:o}}class Bx{constructor(e,t,r,n,s){if(this.container=e,this.data=t,this.columns=r,this.externalPubSub=s,this.slickGridVersion="5.7.1",this.cid="",this.canvas=null,this.canvas_context=null,this._defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,columnResizingDelay:300,nonce:"",editorLock:Bc,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,scrollRenderThrottling:50,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,sanitizer:void 0,mixinDefaults:!1,shadowRoot:void 0},this._columnDefaults={name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0},this.page=0,this.offset=0,this.vScrollDir=1,this._bindingEventService=new Xi,this.initialized=!1,this.uid=`slickgrid_${Math.round(1e6*Math.random())}`,this._groupHeaders=[],this._headerScroller=[],this._headers=[],this._boundAncestors=[],this.viewportH=0,this.viewportW=0,this.canvasWidth=0,this.canvasWidthL=0,this.canvasWidthR=0,this.headersWidth=0,this.headersWidthL=0,this.headersWidthR=0,this.viewportHasHScroll=!1,this.viewportHasVScroll=!1,this.headerColumnWidthDiff=0,this.headerColumnHeightDiff=0,this.cellWidthDiff=0,this.cellHeightDiff=0,this.hasFrozenRows=!1,this.frozenRowsHeight=0,this.actualFrozenRow=-1,this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.topPanelH=0,this.headerRowH=0,this.footerRowH=0,this.tabbingDirection=1,this.activeCellNode=null,this.currentEditor=null,this.rowsCache={},this.renderedRows=0,this.numVisibleRows=0,this.prevScrollTop=0,this.scrollTop=0,this.lastRenderedScrollTop=0,this.lastRenderedScrollLeft=0,this.prevScrollLeft=0,this.scrollLeft=0,this.selectedRows=[],this.plugins=[],this.cellCssClasses={},this.columnsById={},this.sortColumns=[],this.columnPosLeft=[],this.columnPosRight=[],this.pagingActive=!1,this.pagingIsLastPage=!1,this.h_editorLoader=null,this.h_render=null,this.h_postrenderCleanup=null,this.postProcessedRows={},this.postProcessToRow=null,this.postProcessFromRow=null,this.postProcessedCleanupQueue=[],this.postProcessgroupId=0,this.counter_rows_rendered=0,this.counter_rows_removed=0,this.cssShow={position:"absolute",visibility:"hidden",display:"block"},this._hiddenParents=[],this.oldProps=[],this.enforceFrozenRowHeightRecalc=!1,this.columnResizeDragging=!1,this.slickDraggableInstance=null,this.slickMouseWheelInstances=[],this.slickResizableInstances=[],this.logMessageMaxCount=30,this._container=typeof this.container=="string"?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=s,this.onActiveCellChanged=new ze("onActiveCellChanged",s),this.onActiveCellPositionChanged=new ze("onActiveCellPositionChanged",s),this.onAddNewRow=new ze("onAddNewRow",s),this.onAutosizeColumns=new ze("onAutosizeColumns",s),this.onBeforeAppendCell=new ze("onBeforeAppendCell",s),this.onBeforeCellEditorDestroy=new ze("onBeforeCellEditorDestroy",s),this.onBeforeColumnsResize=new ze("onBeforeColumnsResize",s),this.onBeforeDestroy=new ze("onBeforeDestroy",s),this.onBeforeEditCell=new ze("onBeforeEditCell",s),this.onBeforeFooterRowCellDestroy=new ze("onBeforeFooterRowCellDestroy",s),this.onBeforeHeaderCellDestroy=new ze("onBeforeHeaderCellDestroy",s),this.onBeforeHeaderRowCellDestroy=new ze("onBeforeHeaderRowCellDestroy",s),this.onBeforeSetColumns=new ze("onBeforeSetColumns",s),this.onBeforeSort=new ze("onBeforeSort",s),this.onBeforeUpdateColumns=new ze("onBeforeUpdateColumns",s),this.onCellChange=new ze("onCellChange",s),this.onCellCssStylesChanged=new ze("onCellCssStylesChanged",s),this.onClick=new ze("onClick",s),this.onColumnsReordered=new ze("onColumnsReordered",s),this.onColumnsDrag=new ze("onColumnsDrag",s),this.onColumnsResized=new ze("onColumnsResized",s),this.onColumnsResizeDblClick=new ze("onColumnsResizeDblClick",s),this.onCompositeEditorChange=new ze("onCompositeEditorChange",s),this.onContextMenu=new ze("onContextMenu",s),this.onDrag=new ze("onDrag",s),this.onDblClick=new ze("onDblClick",s),this.onDragInit=new ze("onDragInit",s),this.onDragStart=new ze("onDragStart",s),this.onDragEnd=new ze("onDragEnd",s),this.onFooterClick=new ze("onFooterClick",s),this.onFooterContextMenu=new ze("onFooterContextMenu",s),this.onFooterRowCellRendered=new ze("onFooterRowCellRendered",s),this.onHeaderCellRendered=new ze("onHeaderCellRendered",s),this.onHeaderClick=new ze("onHeaderClick",s),this.onHeaderContextMenu=new ze("onHeaderContextMenu",s),this.onHeaderMouseEnter=new ze("onHeaderMouseEnter",s),this.onHeaderMouseLeave=new ze("onHeaderMouseLeave",s),this.onHeaderRowCellRendered=new ze("onHeaderRowCellRendered",s),this.onHeaderRowMouseEnter=new ze("onHeaderRowMouseEnter",s),this.onHeaderRowMouseLeave=new ze("onHeaderRowMouseLeave",s),this.onKeyDown=new ze("onKeyDown",s),this.onMouseEnter=new ze("onMouseEnter",s),this.onMouseLeave=new ze("onMouseLeave",s),this.onRendered=new ze("onRendered",s),this.onScroll=new ze("onScroll",s),this.onSelectedRowsChanged=new ze("onSelectedRowsChanged",s),this.onSetOptions=new ze("onSetOptions",s),this.onActivateChangedOptions=new ze("onActivateChangedOptions",s),this.onSort=new ze("onSort",s),this.onValidationError=new ze("onValidationError",s),this.onViewportChanged=new ze("onViewportChanged",s),this.initialize(n)}init(){this.finishInitialization()}applyHtmlCode(e,t="",r){var n;if(e)if(t instanceof HTMLElement||t instanceof DocumentFragment)(r==null?void 0:r.emptyTarget)!==!1&&Rt(e),e.appendChild(t);else{if((r==null?void 0:r.skipEmptyReassignment)!==!1&&!oi(t)&&!e.innerHTML)return;let a=t;if(typeof a=="number"||typeof a=="boolean")e.textContent=String(a);else{if(typeof((n=this._options)==null?void 0:n.sanitizer)=="function")a=this._options.sanitizer(t);else if(typeof(Is==null?void 0:Is.sanitize)=="function"){const o=(r==null?void 0:r.sanitizerOptions)??this._options.sanitizerOptions??{ADD_ATTR:["level"],RETURN_TRUSTED_TYPE:!0};a=Is.sanitize(t,o)}this._options.enableHtmlRendering&&a?e.innerHTML=a:e.textContent=a}}}initialize(e){if(e!=null&&e.mixinDefaults?(this._options||(this._options=e),oe.applyDefaults(this._options,this._defaults)):this._options=Br(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this._options.enableColumnReorder&&(!nt||!nt.create))throw new Error("SlickGrid requires Sortable.js module to be loaded");this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},Rt(this._container),this._container.style.overflow="hidden",this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("ui-widget"),this._container.setAttribute("role","grid");const t=window.getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=K("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._paneHeaderL=K("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=K("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=K("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=K("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=K("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=K("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=K("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=K("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=K("div",{className:"slick-preheader-panel ui-state-default slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=K("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(oe.hide(this._preHeaderPanelScroller),oe.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=K("div",{className:"slick-header ui-state-default slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=K("div",{className:"slick-header ui-state-default slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=K("div",{className:"slick-header-columns slick-header-columns-left",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=K("div",{className:"slick-header-columns slick-header-columns-right",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=K("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopL),this._headerRowScrollerR=K("div",{className:"slick-headerrow ui-state-default slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=K("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=K("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=K("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopL),this._topPanelScrollerR=K("div",{className:"slick-top-panel-scroller ui-state-default slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=K("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=K("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach(r=>{oe.hide(r)}),this._options.showTopPanel||this._topPanelScrollers.forEach(r=>{oe.hide(r)}),this._options.showHeaderRow||this._headerRowScroller.forEach(r=>{oe.hide(r)}),this._viewportTopL=K("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=K("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=K("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=K("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach(r=>{r.classList.add(...gi(this._options.viewportClass))}),this._activeViewportNode=this._viewportTopL,this._canvasTopL=K("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=K("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=K("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=K("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar(),this._activeCanvasNode=this._canvasTopL,this._preHeaderPanelSpacer&&oe.width(this._preHeaderPanelSpacer,this.getCanvasWidth()+this.scrollbarDimensions.width),this._headers.forEach(r=>{oe.width(r,this.getHeadersWidth())}),oe.width(this._headerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),oe.width(this._headerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._options.createFooterRow&&(this._footerRowScrollerR=K("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopR),this._footerRowScrollerL=K("div",{className:"slick-footerrow ui-state-default slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),oe.width(this._footerRowSpacerL,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowSpacerR=K("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),oe.width(this._footerRowSpacerR,this.getCanvasWidth()+this.scrollbarDimensions.width),this._footerRowL=K("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=K("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach(r=>{oe.hide(r)})),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach(e=>{this._bindingEventService.bind(e,"selectstart",t=>{t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement})}),this.setFrozenOptions(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))}),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach(e=>{this.slickMouseWheelInstances.push(J0({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}),this._headerScroller.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))}),this._headerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))}),this._options.createFooterRow&&(this._footerRow.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))}),this._footerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))})),this._options.createPreHeaderPanel&&this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach(e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))}),Z0&&(this.slickDraggableInstance=Z0({containerElement:this._container,allowDragFrom:"div.slick-cell",allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=oe.parents(this._container,":hidden"),this._hiddenParents.forEach(e=>{const t={};Object.keys(this.cssShow).forEach(r=>{this.cssShow&&(t[r]=e.style[r],e.style[r]=this.cssShow[r])}),this.oldProps.push(t)})}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&this._hiddenParents.forEach(t=>{const r=this.oldProps[e++];Object.keys(this.cssShow).forEach(n=>{this.cssShow&&(t.style[n]=r[n])})})}hasFrozenColumns(){return this._options.frozenColumn>-1}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){var t;for(let r=this.plugins.length;r>=0;r--)if(this.plugins[r]===e){(t=this.plugins[r])==null||t.destroy(),this.plugins.splice(r,1);break}}getPluginByName(e){var t;for(let r=this.plugins.length-1;r>=0;r--)if(((t=this.plugins[r])==null?void 0:t.pluginName)===e)return this.plugins[r]}getPubSubService(){return this._pubSubService}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){var t;return e===void 0?this._activeCanvasNode:(e instanceof Yt&&(e=e.getNativeEvent()),this._activeCanvasNode=(t=e==null?void 0:e.target)==null?void 0:t.closest(".grid-canvas"),this._activeCanvasNode)}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){var t;return e instanceof Yt&&(e=e.getNativeEvent()),this._activeViewportNode=(t=e==null?void 0:e.target)==null?void 0:t.closest(".slick-viewport"),this._activeViewportNode}_getContainerElement(e,t,r){if(!e)return;t||(t=0),r||(r=0);const n=typeof t=="number"?t:this.getColumnIndex(t),s=this.hasFrozenRows&&r>=this.actualFrozenRow+(this._options.frozenBottom?0:1),a=this.hasFrozenColumns()&&n>this._options.frozenColumn;return e[(s?2:0)+(a?1:0)]}measureScrollbar(){let e="";this._viewport.forEach(s=>e+=s.className);const t=K("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),r=K("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),n={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return r.remove(),t.remove(),n}getHeadersWidth(){var n,s,a,o;this.headersWidth=this.headersWidthL=this.headersWidthR=0;const e=!this._options.autoHeight;let t=0;const r=this.columns.length;for(t=0;t<r;t++){if(!this.columns[t]||this.columns[t].hidden)continue;const c=this.columns[t].width;this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=c||0:this.headersWidthL+=c||0}return e&&(this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=((n=this.scrollbarDimensions)==null?void 0:n.width)||0:this.headersWidthL+=((s=this.scrollbarDimensions)==null?void 0:s.width)||0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=((a=this.scrollbarDimensions)==null?void 0:a.width)||0):(this.headersWidthL+=((o=this.scrollbarDimensions)==null?void 0:o.width)||0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){var n;const e=this.viewportHasVScroll?this.viewportW-(((n=this.scrollbarDimensions)==null?void 0:n.width)||0):this.viewportW;let t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)!this.columns[t]||this.columns[t].hidden||(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let r=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){const s=Math.max(r,e)-r;s>0&&(r+=s,this.hasFrozenColumns()?this.canvasWidthR+=s:this.canvasWidthL+=s)}return r}updateCanvasWidth(e){var a,o,c,h,l;const t=this.canvasWidth,r=this.canvasWidthL,n=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth();const s=this.canvasWidth!==t||this.canvasWidthL!==r||this.canvasWidthR!==n;if(s||this.hasFrozenColumns()||this.hasFrozenRows)if(oe.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),oe.width(this._headerL,this.headersWidthL),oe.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()){const u=oe.width(this._container)||0;if(u>0&&this.canvasWidthL>u&&this._options.throwWhenFrozenNotAllViewable)throw new Error("[SlickGrid] Frozen columns cannot be wider than the actual grid container width. Make sure to have less columns freezed or make your grid container wider");oe.width(this._canvasTopR,this.canvasWidthR),oe.width(this._paneHeaderL,this.canvasWidthL),oe.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),oe.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),oe.width(this._paneTopL,this.canvasWidthL),oe.setStyleSize(this._paneTopR,"left",this.canvasWidthL),oe.width(this._paneTopR,this.viewportW-this.canvasWidthL),oe.width(this._headerRowScrollerL,this.canvasWidthL),oe.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),oe.width(this._headerRowL,this.canvasWidthL),oe.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(oe.width(this._footerRowScrollerL,this.canvasWidthL),oe.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),oe.width(this._footerRowL,this.canvasWidthL),oe.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&oe.width(this._preHeaderPanel,this.canvasWidth),oe.width(this._viewportTopL,this.canvasWidthL),oe.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(oe.width(this._paneBottomL,this.canvasWidthL),oe.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),oe.width(this._viewportBottomL,this.canvasWidthL),oe.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),oe.width(this._canvasBottomL,this.canvasWidthL),oe.width(this._canvasBottomR,this.canvasWidthR))}else oe.width(this._paneHeaderL,"100%"),oe.width(this._paneTopL,"100%"),oe.width(this._headerRowScrollerL,"100%"),oe.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(oe.width(this._footerRowScrollerL,"100%"),oe.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&oe.width(this._preHeaderPanel,this.canvasWidth),oe.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(oe.width(this._viewportBottomL,"100%"),oe.width(this._canvasBottomL,this.canvasWidthL));this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(((a=this.scrollbarDimensions)==null?void 0:a.width)||0),oe.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&((o=this.scrollbarDimensions)==null?void 0:o.width)||0)),oe.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&((c=this.scrollbarDimensions)==null?void 0:c.width)||0)),this._options.createFooterRow&&(oe.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&((h=this.scrollbarDimensions)==null?void 0:h.width)||0)),oe.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&((l=this.scrollbarDimensions)==null?void 0:l.width)||0))),(s||e)&&this.applyColumnWidths()}disableSelection(e){e.forEach(t=>{t.setAttribute("unselectable","on"),t.style.mozUserSelect="none",this._bindingEventService.bind(t,"selectstart",()=>!1)})}getMaxSupportedCssHeight(){let e=1e6;const t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,r=K("div",{style:{display:"hidden"}},document.body);for(;;){const n=e*2;oe.height(r,n);const s=oe.height(r);if(n>t||s!==n)break;e=n}return r.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){var e,t;return{width:this.viewportHasVScroll&&((e=this.scrollbarDimensions)==null?void 0:e.width)||0,height:this.viewportHasHScroll&&((t=this.scrollbarDimensions)==null?void 0:t.height)||0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)(e===this._viewportTopL||e.scrollWidth!==e.clientWidth||e.scrollHeight!==e.clientHeight)&&(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach(e=>{this._bindingEventService.unbindByEventName(e,"scroll")}),this._boundAncestors=[]}updateColumnHeader(e,t,r){if(this.initialized){const n=this.getColumnIndex(e);if(!oi(n))return;const s=this.columns[n],a=this.getColumnByIndex(n);a&&(t!==void 0&&(this.columns[n].name=t),r!==void 0&&(this.columns[n].toolTip=r),this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:a,column:s,grid:this}),a.setAttribute("title",r||""),t!==void 0&&this.applyHtmlCode(a.children[0],t),this.triggerEvent(this.onHeaderCellRendered,{node:a,column:s,grid:this}))}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;const t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){const t=typeof e=="number"?e:this.getColumnIndex(e),r=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,n=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return r.children[n]}getHeaderRow(){var e;return this.hasFrozenColumns()?this._headerRows:(e=this._headerRows)==null?void 0:e[0]}getFooterRow(){var e;return this.hasFrozenColumns()?this._footerRow:(e=this._footerRow)==null?void 0:e[0]}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getHeaderRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),r;return this.hasFrozenColumns()?t<=this._options.frozenColumn?r=this._headerRowL:(r=this._headerRowR,t-=this._options.frozenColumn+1):r=this._headerRowL,r.children[t]}getFooterRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),r;return this.hasFrozenColumns()?t<=this._options.frozenColumn?r=this._footerRowL:(r=this._footerRowR,t-=this._options.frozenColumn+1):r=this._footerRowL,r==null?void 0:r.children[t]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach(e=>{e.querySelectorAll(".slick-footerrow-column").forEach(r=>{const n=oe.storage.get(r,"column");this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:r,column:n,grid:this})})}),Rt(this._footerRowL),Rt(this._footerRowR);for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(!t||t.hidden)continue;const r=K("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),n=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;n&&r.classList.add(n),oe.storage.put(r,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:r,column:t,grid:this})}}}handleHeaderMouseHoverOn(e){e==null||e.target.classList.add("ui-state-hover","slick-state-hover")}handleHeaderMouseHoverOff(e){e==null||e.target.classList.remove("ui-state-hover","slick-state-hover")}createColumnHeaders(){this._headers.forEach(e=>{e.querySelectorAll(".slick-header-column").forEach(r=>{const n=oe.storage.get(r,"column");n&&this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:r,column:n,grid:this})})}),Rt(this._headerL),Rt(this._headerR),this.getHeadersWidth(),oe.width(this._headerL,this.headersWidthL),oe.width(this._headerR,this.headersWidthR),this._headerRows.forEach(e=>{e.querySelectorAll(".slick-headerrow-column").forEach(r=>{const n=oe.storage.get(r,"column");n&&this.triggerEvent(this.onBeforeHeaderRowCellDestroy,{node:this,column:n,grid:this})})}),Rt(this._headerRowL),Rt(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach(t=>{const r=oe.storage.get(t,"column");r&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:r,grid:this})}),Rt(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach(r=>{const n=oe.storage.get(r,"column");n&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:n,grid:this})}),Rt(this._footerRowR)));for(let e=0;e<this.columns.length;e++){const t=this.columns[e];if(t.hidden)continue;const r=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,n=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,s=K("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"ui-state-default slick-state-default slick-header-column"},r);t.toolTip&&(s.title=t.toolTip),t.reorderable||s.classList.add(this._options.unorderableColumnCssClass);const a=K("span",{className:"slick-column-name"},s);this.applyHtmlCode(a,t.name),oe.width(s,t.width-this.headerColumnWidthDiff);let o=t.headerCssClass||null;if(o&&s.classList.add(...gi(o)),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,o&&s.classList.add(o),this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseLeave.bind(this)),oe.storage.put(s,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(s,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(s,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach(c=>{t.headerCellAttrs.hasOwnProperty(c)&&s.setAttribute(c,t.headerCellAttrs[c])}),t.sortable&&(s.classList.add("slick-header-sortable"),K("div",{className:`slick-sort-indicator ${this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":""}`},s),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&K("div",{className:"slick-sort-indicator-numbered"},s)),this.triggerEvent(this.onHeaderCellRendered,{node:s,column:t,grid:this}),this._options.showHeaderRow){const c=K("div",{className:`ui-state-default slick-state-default slick-headerrow-column l${e} r${e}`},n),h=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;h&&c.classList.add(h),this._bindingEventService.bind(c,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(c,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),oe.storage.put(c,"column",t),this.triggerEvent(this.onHeaderRowCellRendered,{node:c,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){const c=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0],h=K("div",{className:`ui-state-default slick-state-default slick-footerrow-column l${e} r${e}`},c);oe.storage.put(h,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:h,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&(typeof this._options.enableColumnReorder=="function"?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.triggerEvent):this.setupColumnReorder())}setupColumnSort(){this._headers.forEach(e=>{this._bindingEventService.bind(e,"click",t=>{var s;if(this.columnResizeDragging||t.target.classList.contains("slick-resizable-handle"))return;const r=t.target.closest(".slick-header-column");if(!r)return;const n=oe.storage.get(r,"column");if(n!=null&&n.sortable){if(!((s=this.getEditorLock())!=null&&s.commitCurrentEdit()))return;const a=this.sortColumns.slice();let o=null,c=0;for(;c<this.sortColumns.length;c++)if(this.sortColumns[c].columnId===n.id){o=this.sortColumns[c],o.sortAsc=!o.sortAsc;break}const h=!!o;this._options.tristateMultiColumnSort?(o||(o={columnId:n.id,sortAsc:n.defaultSortAsc,sortCol:n}),h&&o.sortAsc&&(this.sortColumns.splice(c,1),o=null),this._options.multiColumnSort||(this.sortColumns=[]),o&&(!h||!this._options.multiColumnSort)&&this.sortColumns.push(o)):t.metaKey&&this._options.multiColumnSort?o&&this.sortColumns.splice(c,1):((!t.shiftKey&&!t.metaKey||!this._options.multiColumnSort)&&(this.sortColumns=[]),o?this.sortColumns.length===0&&this.sortColumns.push(o):(o={columnId:n.id,sortAsc:n.defaultSortAsc,sortCol:n},this.sortColumns.push(o)));let l;this._options.multiColumnSort?l={multiColumnSort:!0,previousSortColumns:a,sortCols:this.sortColumns.map(u=>({columnId:this.columns[this.getColumnIndex(u.columnId)].id,sortCol:this.columns[this.getColumnIndex(u.columnId)],sortAsc:u.sortAsc}))}:l={multiColumnSort:!1,previousSortColumns:a,columnId:this.sortColumns.length>0?n.id:null,sortCol:this.sortColumns.length>0?n:null,sortAsc:this.sortColumns.length>0?this.sortColumns[0].sortAsc:!0},this.triggerEvent(this.onBeforeSort,l,t).getReturnValue()!==!1&&(this.setSortColumns(this.sortColumns),this.triggerEvent(this.onSort,l,t))}})})}setupColumnReorder(){var a,o;(a=this.sortableSideLeftInstance)==null||a.destroy(),(o=this.sortableSideRightInstance)==null||o.destroy();let e=null;const t=()=>this._viewportScrollContainerX.scrollLeft+=10,r=()=>this._viewportScrollContainerX.scrollLeft-=10;let n=!1;const s={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:c=>!c.related.classList.contains(this._options.unorderableColumnCssClass),onStart:c=>{n=!this.hasFrozenColumns()||xi(c.item).left>xi(this._viewportScrollContainerX).left,n&&c.originalEvent.pageX>this._container.clientWidth?e||(e=setInterval(t,100)):n&&c.originalEvent.pageX<xi(this._viewportScrollContainerX).left?e||(e=setInterval(r,100)):(clearInterval(e),e=null)},onEnd:c=>{var u,d,f;if(clearInterval(e),e=null,!((u=this.getEditorLock())!=null&&u.commitCurrentEdit()))return;let h=((d=this.sortableSideLeftInstance)==null?void 0:d.toArray())??[];h=h.concat(((f=this.sortableSideRightInstance)==null?void 0:f.toArray())??[]);const l=[];for(let p=0;p<h.length;p++)l.push(this.columns[this.getColumnIndex(h[p])]);this.setColumns(l),this.triggerEvent(this.onColumnsReordered,{impactedColumns:this.columns}),c.stopPropagation(),this.setupColumnResize(),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=nt.create(this._headerL,s),this.sortableSideRightInstance=nt.create(this._headerR,s)}getHeaderChildren(){const e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){const t=e.target.parentElement.id.replace(this.uid,"");this.triggerEvent(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){if(typeof ep>"u")throw new Error('SlickResizable is undefined, make sure to import "slick.interactions.js"');let e,t,r,n,s,a,o,c=-1,h=0;const l=this.getHeaderChildren(),u=this.getVisibleColumns();for(let d=0;d<l.length;d++)l[d].querySelectorAll(".slick-resizable-handle").forEach(m=>m.remove()),!(d>=u.length||!u[d])&&u[d].resizable&&(o===void 0&&(o=d),c=d);if(o!==void 0)for(let d=0;d<l.length;d++){const f=l[d];if(d>=u.length||!u[d]||d<o||this._options.forceFitColumns&&d>=c)continue;const p=K("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},f);this._bindingEventService.bind(p,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(ep({resizeableElement:f,resizeableHandleElement:p,onResizeStart:(m,v)=>{var b;const _=m.touches?m.changedTouches[0]:m;if(!((b=this.getEditorLock())!=null&&b.commitCurrentEdit()))return!1;n=_.pageX,h=0,v.resizeableElement.classList.add("slick-header-column-active");let x=null,E=null;for(let T=0;T<l.length;T++)T>=u.length||!u[T]||(u[T].previousWidth=l[T].offsetWidth);if(this._options.forceFitColumns)for(x=0,E=0,e=d+1;e<u.length;e++)r=u[e],r!=null&&r.resizable&&(E!==null&&(r.maxWidth?E+=r.maxWidth-(r.previousWidth||0):E=null),x+=(r.previousWidth||0)-Math.max(r.minWidth||0,this.absoluteColumnMinWidth));let C=0,y=0;for(e=0;e<=d;e++)r=u[e],r!=null&&r.resizable&&(y!==null&&(r.maxWidth?y+=r.maxWidth-(r.previousWidth||0):y=null),C+=(r.previousWidth||0)-Math.max(r.minWidth||0,this.absoluteColumnMinWidth));x===null&&(x=1e5),C===null&&(C=1e5),E===null&&(E=1e5),y===null&&(y=1e5),a=n+Math.min(x,y),s=n-Math.min(C,E)},onResize:(m,v)=>{var R;const _=m.touches?m.changedTouches[0]:m;this.columnResizeDragging=!0;let x;const E=Math.min(a,Math.max(s,_.pageX))-n;let C,y=0,b=0;const T=this.viewportHasVScroll?this.viewportW-(((R=this.scrollbarDimensions)==null?void 0:R.width)||0):this.viewportW;if(E<0){for(C=E,e=d;e>=0;e--)r=u[e],r&&r.resizable&&!r.hidden&&(x=Math.max(r.minWidth||0,this.absoluteColumnMinWidth),C&&(r.previousWidth||0)+C<x?(C+=(r.previousWidth||0)-x,r.width=x):(r.width=(r.previousWidth||0)+C,C=0));for(t=0;t<=d;t++)r=u[t],!(!r||r.hidden)&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?b+=r.width||0:y+=r.width||0);if(this._options.forceFitColumns)for(C=-E,e=d+1;e<u.length;e++)r=u[e],!(!r||r.hidden)&&r.resizable&&(C&&r.maxWidth&&r.maxWidth-(r.previousWidth||0)<C?(C-=r.maxWidth-(r.previousWidth||0),r.width=r.maxWidth):(r.width=(r.previousWidth||0)+C,C=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?b+=r.width||0:y+=r.width||0);else for(e=d+1;e<u.length;e++)r=u[e],!(!r||r.hidden)&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?b+=r.width||0:y+=r.width||0);if(this._options.forceFitColumns)for(C=-E,e=d+1;e<u.length;e++)r=u[e],!(!r||r.hidden)&&r.resizable&&(C&&r.maxWidth&&r.maxWidth-(r.previousWidth||0)<C?(C-=r.maxWidth-(r.previousWidth||0),r.width=r.maxWidth):(r.width=(r.previousWidth||0)+C,C=0))}else{for(C=E,y=0,b=0,e=d;e>=0;e--)if(r=u[e],!(!r||r.hidden)&&r.resizable)if(C&&r.maxWidth&&r.maxWidth-(r.previousWidth||0)<C)C-=r.maxWidth-(r.previousWidth||0),r.width=r.maxWidth;else{const O=(r.previousWidth||0)+C,W=this.canvasWidthL+C;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(O>h&&W<T-this._options.frozenRightViewportMinWidth&&(h=O),r.width=W+this._options.frozenRightViewportMinWidth>T?h:O):r.width=O,C=0}for(t=0;t<=d;t++)r=u[t],!(!r||r.hidden)&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?b+=r.width||0:y+=r.width||0);if(this._options.forceFitColumns)for(C=-E,e=d+1;e<u.length;e++)r=u[e],!(!r||r.hidden)&&r.resizable&&(x=Math.max(r.minWidth||0,this.absoluteColumnMinWidth),C&&(r.previousWidth||0)+C<x?(C+=(r.previousWidth||0)-x,r.width=x):(r.width=(r.previousWidth||0)+C,C=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?b+=r.width||0:y+=r.width||0);else for(e=d+1;e<u.length;e++)r=u[e],!(!r||r.hidden)&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?b+=r.width||0:y+=r.width||0)}this.hasFrozenColumns()&&y!==this.canvasWidthL&&(oe.width(this._headerL,y+1e3),oe.setStyleSize(this._paneHeaderR,"left",y)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.triggerEvent(this.onColumnsDrag,{triggeredByColumn:v.resizeableElement,resizeHandle:v.resizeableHandleElement})},onResizeEnd:(m,v)=>{v.resizeableElement.classList.remove("slick-header-column-active");const _=v.resizeableElement.id.replace(this.uid,"");this.triggerEvent(this.onBeforeColumnsResize,{triggeredByColumn:_}).getReturnValue()===!0&&this.applyColumnHeaderWidths();let x;for(e=0;e<u.length;e++)r=u[e],!(!r||r.hidden||!l[e])&&(x=l[e].offsetWidth,r.previousWidth!==x&&r.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.triggerEvent(this.onColumnsResized,{triggeredByColumn:_}),clearTimeout(this._columnResizeTimer),this._columnResizeTimer=setTimeout(()=>this.columnResizeDragging=!1,this._options.columnResizingDelay)}}))}}getVBoxDelta(e){const t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],r=getComputedStyle(e);let n=0;return t.forEach(s=>n+=oe.toFloat(r[s])),n}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;const e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}setPaneVisibility(){this.hasFrozenColumns()?(oe.show(this._paneHeaderR),oe.show(this._paneTopR),this.hasFrozenRows?(oe.show(this._paneBottomL),oe.show(this._paneBottomR)):(oe.hide(this._paneBottomR),oe.hide(this._paneBottomL))):(oe.hide(this._paneHeaderR),oe.hide(this._paneTopR),oe.hide(this._paneBottomR),this.hasFrozenRows?oe.show(this._paneBottomL):(oe.hide(this._paneBottomR),oe.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?this.hasFrozenRows?"scroll":"auto":this.hasFrozenRows?"scroll":"auto",this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"auto"):(this.hasFrozenRows,"auto"),this._options.viewportClass){const e=gi(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}measureCellPaddingAndBorder(){const e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],r=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let n=K("div",{className:"ui-state-default slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},r),s=getComputedStyle(n);s.boxSizing!=="border-box"&&(e.forEach(o=>this.headerColumnWidthDiff+=oe.toFloat(s[o])),t.forEach(o=>this.headerColumnHeightDiff+=oe.toFloat(s[o]))),n.remove();const a=K("div",{className:"slick-row"},this._canvas[0]);n=K("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},a),s=getComputedStyle(n),s.boxSizing!=="border-box"&&(e.forEach(o=>this.cellWidthDiff+=oe.toFloat(s[o])),t.forEach(o=>this.cellHeightDiff+=oe.toFloat(s[o]))),a.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);const e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],r=this._style.sheet;if(r){t.forEach(n=>{r.insertRule(n)});for(let n=0;n<this.columns.length;n++)!this.columns[n]||this.columns[n].hidden||(r.insertRule(`.${this.uid} .l${n} { }`),r.insertRule(`.${this.uid} .r${n} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){const t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let r=0;r<this.columns.length;r++)!this.columns[r]||this.columns[r].hidden||(e.push(`.${this.uid} .l${r} { }`),e.push(`.${this.uid} .r${r} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){let t;if(!this.stylesheet){const r=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&typeof this._options.devMode.ownerNodeIndex=="number"&&this._options.devMode.ownerNodeIndex>=0&&(r[this._options.devMode.ownerNodeIndex].ownerNode=this._style),t=0;t<r.length;t++){const o=r[t];if((o.ownerNode||o.owningElement)===this._style){this.stylesheet=o;break}}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];const n=this.stylesheet.cssRules||this.stylesheet.rules;let s,a;for(t=0;t<n.length;t++){const o=n[t].selectorText;(s=/\.l\d+/.exec(o))?(a=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesL[a]=n[t]):(s=/\.r\d+/.exec(o))&&(a=parseInt(s[0].substr(2,s[0].length-2),10),this.columnCssRulesR[a]=n[t])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){var e;(e=this._style)==null||e.remove(),this.stylesheet=null}clearAllTimers(){clearTimeout(this._columnResizeTimer),clearTimeout(this._executionBlockTimer),clearTimeout(this._flashCellTimer),clearTimeout(this._highlightRowTimer),clearTimeout(this.h_editorLoader)}destroy(e){var s,a,o;this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),(s=this.getEditorLock())==null||s.cancelCurrentEdit(),this.triggerEvent(this.onBeforeDestroy,{});let t=this.plugins.length;for(;t--;)this.unregisterPlugin(this.plugins[t]);this._options.enableColumnReorder&&typeof((a=this.sortableSideLeftInstance)==null?void 0:a.destroy)=="function"&&typeof((o=this.sortableSideRightInstance)==null?void 0:o.destroy)=="function"&&(this.sortableSideLeftInstance.destroy(),this.sortableSideRightInstance.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach(c=>{this._bindingEventService.unbindByEventName(c,"keydown"),this._bindingEventService.unbindByEventName(c,"click"),this._bindingEventService.unbindByEventName(c,"dblclick"),this._bindingEventService.unbindByEventName(c,"contextmenu"),this._bindingEventService.unbindByEventName(c,"mouseover"),this._bindingEventService.unbindByEventName(c,"mouseout")}),this._viewport.forEach(c=>{this._bindingEventService.unbindByEventName(c,"scroll")}),this._headerScroller.forEach(c=>{this._bindingEventService.unbindByEventName(c,"contextmenu"),this._bindingEventService.unbindByEventName(c,"click")}),this._headerRowScroller.forEach(c=>{this._bindingEventService.unbindByEventName(c,"scroll")}),this._footerRow&&this._footerRow.forEach(c=>{this._bindingEventService.unbindByEventName(c,"contextmenu"),this._bindingEventService.unbindByEventName(c,"click")}),this._footerRowScroller&&this._footerRowScroller.forEach(c=>{this._bindingEventService.unbindByEventName(c,"scroll")}),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");const r=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(r,c=>{this._bindingEventService.unbindByEventName(c,"dblclick")});const n=this._container.querySelectorAll(".slick-header-column");[].forEach.call(n,c=>{this._bindingEventService.unbindByEventName(c,"mouseenter"),this._bindingEventService.unbindByEventName(c,"mouseleave"),this._bindingEventService.unbindByEventName(c,"mouseenter"),this._bindingEventService.unbindByEventName(c,"mouseleave")}),Rt(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&Sl(this)}destroyAllInstances(e){if(e){const t=Array.isArray(e)?e:[e];let r;for(;oi(r=t.pop());)r&&typeof r.destroy=="function"&&r.destroy()}return e=Array.isArray(e)?[]:null,e}autosizeColumns(){this.legacyAutosizeColumns()}legacyAutosizeColumns(){var h;let e,t,r=0,n=0,s=0;const a=[],o=this.viewportHasVScroll?this.viewportW-(((h=this.scrollbarDimensions)==null?void 0:h.width)||0):this.viewportW;for(e=0;e<this.columns.length;e++){if(t=this.columns[e],!t||t.hidden){a.push(0);continue}a.push(t.width||0),n+=t.width||0,t.resizable&&(r+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))}for(s=n;n>o&&r;){const l=(n-o)/r;for(e=0;e<this.columns.length&&n>o;e++){if(t=this.columns[e],!t||t.hidden)continue;const u=a[e];if(!t.resizable||u<=t.minWidth||u<=this.absoluteColumnMinWidth)continue;const d=Math.max(t.minWidth,this.absoluteColumnMinWidth);let f=Math.floor(l*(u-d))||1;f=Math.min(f,u-d),n-=f,r-=f,a[e]-=f}if(s<=n)break;s=n}for(s=n;n<o;){const l=o/n;for(e=0;e<this.columns.length&&n<o;e++){if(t=this.columns[e],!t||t.hidden)continue;const u=a[e];let d;!t.resizable||t.maxWidth<=u?d=0:d=Math.min(Math.floor(l*u)-u,t.maxWidth-u||1e6)||1,n+=d,a[e]+=n<=o?d:0}if(s>=n)break;s=n}let c=!1;for(e=0;e<this.columns.length;e++)!t||t.hidden||(this.columns[e].rerenderOnResize&&this.columns[e].width!==a[e]&&(c=!0),this.columns[e].width=a[e]);this.reRenderColumns(c)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.triggerEvent(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter(e=>!e.hidden)}triggerEvent(e,t,r){const n=r||new Yt(r,t),s=t||{};return s.grid=this,e.notify(s,n,this)}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(this.initialized){let e=0;const t=this.getVisibleColumns();this._headers.forEach(r=>{for(let n=0;n<r.children.length;n++,e++){const s=r.children[n],o=((t[e]||{}).width||0)-this.headerColumnWidthDiff;oe.width(s)!==o&&oe.width(s,o)}}),this.updateColumnCaches()}}applyColumnWidths(){var n;let e=0,t=0,r;for(let s=0;s<this.columns.length;s++)(n=this.columns[s])!=null&&n.hidden||(t=this.columns[s].width||0,r=this.getColumnCssRules(s),r.left.style.left=`${e}px`,r.right.style.right=(this._options.frozenColumn!==-1&&s>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-e-t+"px",this._options.frozenColumn!==s&&(e+=this.columns[s].width)),this._options.frozenColumn===s&&(e=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every(r=>{const n=r.children.length;return e<n?(t=r.children[e],!1):(e-=n,!0)}),t}setSortColumns(e){this.sortColumns=e;const t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach(n=>{let s=n.querySelectorAll(".slick-header-column-sorted");s.forEach(a=>a.classList.remove("slick-header-column-sorted")),s=n.querySelectorAll(".slick-sort-indicator"),s.forEach(a=>a.classList.remove("slick-sort-indicator-asc","slick-sort-indicator-desc")),s=n.querySelectorAll(".slick-sort-indicator-numbered"),s.forEach(a=>a.textContent="")});let r=1;this.sortColumns.forEach(n=>{oi(n.sortAsc)||(n.sortAsc=!0);const s=this.getColumnIndex(n.columnId);if(oi(s)){const a=this.getColumnByIndex(s);if(a){a.classList.add("slick-header-column-sorted");let o=a.querySelector(".slick-sort-indicator");o==null||o.classList.add(n.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(o=a.querySelector(".slick-sort-indicator-numbered"),o&&(o.textContent=String(r)))}}r++})}getSortColumns(){return this.sortColumns}handleSelectedRangesChanged(e,t){var a;const r=e.getNativeEvent(),n=this.selectedRows.slice(0);this.selectedRows=[];const s={};for(let o=0;o<t.length;o++)for(let c=t[o].fromRow;c<=t[o].toRow;c++){s[c]||(this.selectedRows.push(c),s[c]={});for(let h=t[o].fromCell;h<=t[o].toCell;h++)this.canCellBeSelected(c,h)&&(s[c][this.columns[h].id]=this._options.selectedCellCssClass)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",s),this.simpleArrayEquals(n,this.selectedRows)){const o=((a=r==null?void 0:r.detail)==null?void 0:a.caller)??"click",c=this.getSelectedRows().filter(l=>n.indexOf(l)<0),h=n.filter(l=>this.getSelectedRows().indexOf(l)<0);this.triggerEvent(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:n,caller:o,changedSelectedRows:c,changedUnselectedRows:h},e)}}simpleArrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.sort().toString()!==e.sort().toString()}getColumns(){return this.columns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,r=this.columns.length;t<r;t++)!this.columns[t]||this.columns[t].hidden||(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e];t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?oe.applyDefaults(t,this._columnDefaults):t=this.columns[e]=Br({},this._columnDefaults,t),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.triggerEvent(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal()}updateColumns(){this.triggerEvent(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){var e;this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnWidths(),this.handleScroll(),(e=this.getSelectionModel())==null||e.refreshSelections())}getOptions(){return this._options}setOptions(e,t,r,n){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),e.frozenColumn&&(this.getViewports().forEach(a=>a.scrollLeft=0),this.handleScroll());const s=Br(!0,{},this._options);this._options=Br(this._options,e),this.triggerEvent(this.onSetOptions,{optionsBefore:s,optionsAfter:this._options}),this.internal_setOptions(t,r,n)}activateChangedOptions(e,t,r){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.triggerEvent(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,r)}prepareForOptionsChange(){var e;(e=this.getEditorLock())!=null&&e.commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,r){this._options.showColumnHeader!==void 0&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),this._options.frozenBottom!==void 0&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach(n=>{n.style.overflowY=this._options.autoHeight?"hidden":"auto"}),e||this.render(),this.setScroller(),r||this.setOverflow(),t||this.setColumns(this.columns),this._options.enableMouseWheelScrollHandler&&this._viewport&&(!this.slickMouseWheelInstances||this.slickMouseWheelInstances.length===0)?this._viewport.forEach(n=>{this.slickMouseWheelInstances.push(J0({element:n,onMouseWheel:this.handleMouseWheel.bind(this)}))}):this._options.enableMouseWheelScrollHandler===!1&&this.destroyAllInstances(this.slickMouseWheelInstances)}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1)}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){var e;return this.data.getLength?this.data.getLength():((e=this.data)==null?void 0:e.length)||0}getDataLengthIncludingAddNew(){return this.getDataLength()+(this._options.enableAddRow&&(!this.pagingActive||this.pagingIsLastPage)?1:0)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}hasDataView(){return!Array.isArray(this.data)}togglePanelVisibility(e,t,r){this._options[e]!==r&&(this._options[e]=r,r?oe.show(t):oe.hide(t),this.resizeCanvas())}setTopPanelVisibility(e){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e)}setHeaderRowVisibility(e){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e)}setColumnHeaderVisibility(e){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e)}setFooterRowVisibility(e){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e)}setPreHeaderPanelVisibility(e){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e)}getContainerNode(){return this._container}getRowTop(e){return this._options.rowHeight*e-this.offset}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}scrollTo(e){var n;e=Math.max(e,0),e=Math.min(e,(this.th||0)-oe.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&((n=this.scrollbarDimensions)==null?void 0:n.height)||0));const t=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));const r=e-this.offset;if(this.offset!==t){const s=this.getVisibleRange(r);this.cleanupRows(s),this.updateRowPositions()}this.prevScrollTop!==r&&(this.vScrollDir=this.prevScrollTop+t<r+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=r,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=r),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=r),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=r),this.triggerEvent(this.onViewportChanged,{}))}defaultFormatter(e,t,r){return oi(r)?(r+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}getFormatter(e,t){var s,a,o;const r=(a=(s=this.data)==null?void 0:s.getItemMetadata)==null?void 0:a.call(s,e),n=(r==null?void 0:r.columns)&&(r.columns[t.id]||r.columns[this.getColumnIndex(t.id)]);return(n==null?void 0:n.formatter)||(r==null?void 0:r.formatter)||t.formatter||((o=this._options.formatterFactory)==null?void 0:o.getFormatter(t))||this._options.defaultFormatter}getEditor(e,t){var a,o,c,h,l,u;const r=this.columns[t],n=(o=(a=this.data)==null?void 0:a.getItemMetadata)==null?void 0:o.call(a,e),s=n==null?void 0:n.columns;return((c=s==null?void 0:s[r.id])==null?void 0:c.editor)!==void 0?s[r.id].editor:((h=s==null?void 0:s[t])==null?void 0:h.editor)!==void 0?s[t].editor:r.editor||((u=(l=this._options)==null?void 0:l.editorFactory)==null?void 0:u.getEditor(r))}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}appendRowHtml(e,t,r,n,s){var m,v;const a=this.getDataItem(r),o=r<s&&!a;let c="slick-row"+(this.hasFrozenRows&&r<=this._options.frozenRow?" frozen":"")+(o?" loading":"")+(r===this.activeRow&&this._options.showCellSelection?" active":"")+(r%2===1?" odd":" even");a||(c+=` ${this._options.addNewRowCssClass}`);const h=(v=(m=this.data)==null?void 0:m.getItemMetadata)==null?void 0:v.call(m,r);h!=null&&h.cssClasses&&(c+=` ${h.cssClasses}`);const l=this.getFrozenRowOffset(r),u=K("div",{className:`ui-widget-content ${c}`,role:"row",style:{top:`${this.getRowTop(r)-l}px`}});let d;e.push(u),this.hasFrozenColumns()&&(d=u.cloneNode(!0),t.push(d));let f,p;for(let _=0,x=this.columns.length;_<x;_++)if(p=this.columns[_],!(!p||p.hidden)){if(f=1,h!=null&&h.columns){const E=h.columns[p.id]||h.columns[_];f=(E==null?void 0:E.colspan)||1,f==="*"&&(f=x-_)}if(this.columnPosRight[Math.min(x-1,_+f-1)]>n.leftPx){if(!p.alwaysRenderColumn&&this.columnPosLeft[_]>n.rightPx)break;this.hasFrozenColumns()&&_>this._options.frozenColumn?this.appendCellHtml(d,r,_,f,a):this.appendCellHtml(u,r,_,f,a)}else(p.alwaysRenderColumn||this.hasFrozenColumns()&&_<=this._options.frozenColumn)&&this.appendCellHtml(u,r,_,f,a);f>1&&(_+=f-1)}}appendCellHtml(e,t,r,n,s){const a=this.columns[r];let o="slick-cell l"+r+" r"+Math.min(this.columns.length-1,r+n-1)+(a.cssClass?" "+a.cssClass:"");this.hasFrozenColumns()&&r<=this._options.frozenColumn&&(o+=" frozen"),t===this.activeRow&&r===this.activeCell&&this._options.showCellSelection&&(o+=" active"),Object.keys(this.cellCssClasses).forEach(m=>{var v;(v=this.cellCssClasses[m][t])!=null&&v[a.id]&&(o+=` ${this.cellCssClasses[m][t][a.id]}`)});let c=null,h="";s&&(c=this.getDataItemValueForColumn(s,a),h=this.getFormatter(t,a)(t,r,c,a,s,this),h==null&&(h=""));const u=this.triggerEvent(this.onBeforeAppendCell,{row:t,cell:r,value:c,dataContext:s}).getReturnValue();let d=typeof u=="string"?u:"";h!=null&&h.addClasses&&(d+=gi((d?" ":"")+h.addClasses).join(" "));const f=h!=null&&h.toolTip?`${h.toolTip}`:"",p=K("div",{className:gi(`${o} ${d||""}`).join(" "),role:"gridcell",tabIndex:-1});if(p.setAttribute("aria-describedby",this.uid+a.id),f&&p.setAttribute("title",f),a.hasOwnProperty("cellAttrs")&&a.cellAttrs instanceof Object&&Object.keys(a.cellAttrs).forEach(m=>{a.cellAttrs.hasOwnProperty(m)&&p.setAttribute(m,a.cellAttrs[m])}),s){const m=rl(h)?h:h.html||h.text;this.applyHtmlCode(p,m)}e.appendChild(p),h.insertElementAfterTarget&&Gm(p,h.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(r),this.rowsCache[t].cellColSpans[r]=n}cleanupRows(e){Object.keys(this.rowsCache).forEach(t=>{if(this.rowsCache){let r=+t,n=!0;this.hasFrozenRows&&(this._options.frozenBottom&&r>=this.actualFrozenRow||!this._options.frozenBottom&&r<=this.actualFrozenRow)&&(n=!1),(r=parseInt(t,10))!==this.activeRow&&(r<e.top||r>e.bottom)&&n&&this.removeRowFromCache(r)}}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(e=>{this.rowsCache&&this.removeRowFromCache(+e)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(e!=null&&e.length){this.vScrollDir=0;const t=e.length;for(let r=0;r<t;r++)this.currentEditor&&this.activeRow===e[r]&&this.makeActiveCellNormal(),this.rowsCache[e[r]]&&this.removeRowFromCache(e[r]);this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}}invalidateRow(e){e>=0&&this.invalidateRows([e])}queuePostProcessedRowForCleanup(e,t,r){var n;this.postProcessgroupId++,typeof t=="object"&&Object.keys(t).forEach(s=>{t.hasOwnProperty(s)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+s],columnIdx:+s,rowIdx:r})}),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),(n=e.rowNode)==null||n.forEach(s=>s.remove())}queuePostProcessedCellForCleanup(e,t,r){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:r}),e.remove()}removeRowFromCache(e){var r;const t=this.rowsCache[e];t!=null&&t.rowNode&&(this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(t,this.postProcessedRows[e],e):(r=t.rowNode)==null||r.forEach(n=>{var s;return(s=n.parentElement)==null?void 0:s.removeChild(n)}),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}applyFormatResultToCellNode(e,t,r){if(e==null&&(e=""),rl(e)){this.applyHtmlCode(t,e);return}const n=e.html||e.text;this.applyHtmlCode(t,n),e.removeClasses&&!r&&t.classList.remove(...gi(e.removeClasses)),e.addClasses&&t.classList.add(...gi(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}updateCell(e,t){const r=this.getCellNode(e,t);if(r){const n=this.columns[t],s=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(s);else{const a=s?this.getFormatter(e,n)(e,t,this.getDataItemValueForColumn(s,n),n,s,this):"";this.applyFormatResultToCellNode(a,r),this.invalidatePostProcessingResults(e)}}}updateRow(e){const t=this.rowsCache[e];if(!t)return;this.ensureCellNodesInRowsCache(e);let r;const n=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach(s=>{if(!t.cellNodesByColumnIdx.hasOwnProperty(s))return;const a=+s,o=this.columns[a],c=t.cellNodesByColumnIdx[a];this.currentEditor&&e===this.activeRow&&a===this.activeCell?this.currentEditor.loadValue(n):n?(r=this.getFormatter(e,o)(e,a,this.getDataItemValueForColumn(n,o),o,n,this),this.applyFormatResultToCellNode(r,c)):Rt(c)}),this.invalidatePostProcessingResults(e)}getViewportRowCount(){var r;const e=this.getViewportHeight(),t=((r=this.getScrollbarDimensions())==null?void 0:r.height)||0;return Math.floor((e-t)/this._options.rowHeight)}getViewportHeight(){var e;if((!this._options.autoHeight||this._options.frozenColumn!==-1)&&(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let t=this._paneHeaderL.offsetHeight;t+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,t+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,t+=this.getCanvasWidth()>this.viewportW&&((e=this.scrollbarDimensions)==null?void 0:e.height)||0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(this._options.frozenColumn===-1?t:0)}else{const t=this._options.showColumnHeader?oe.toFloat(oe.height(this._headerScroller[0]))+this.getVBoxDelta(this._headerScroller[0]):0,r=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,n=getComputedStyle(this._container);this.viewportH=oe.toFloat(n.height)-oe.toFloat(n.paddingTop)-oe.toFloat(n.paddingBottom)-t-this.topPanelH-this.headerRowH-this.footerRowH-r}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportWidth(){return this.viewportW=parseFloat(Dc(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){var e,t,r;if(this.initialized){if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(((e=this.scrollbarDimensions)==null?void 0:e.height)||0),this.paneBottomH=this.frozenRowsHeight+(((t=this.scrollbarDimensions)==null?void 0:t.height)||0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=((r=this.scrollbarDimensions)==null?void 0:r.height)||0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){const s=getComputedStyle(this._headerScrollerL);oe.height(this._container,this.paneTopH+oe.toFloat(s.height))}this._paneTopL.style.position="relative"}oe.setStyleSize(this._paneTopL,"top",oe.height(this._paneHeaderL)||(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0)),oe.height(this._paneTopL,this.paneTopH);const n=this._paneTopL.offsetTop+this.paneTopH;this._options.autoHeight||oe.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()?(oe.setStyleSize(this._paneTopR,"top",oe.height(this._paneHeaderL)),oe.height(this._paneTopR,this.paneTopH),oe.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(oe.setStyleSize(this._paneBottomL,"top",n),oe.height(this._paneBottomL,this.paneBottomH),oe.setStyleSize(this._paneBottomR,"top",n),oe.height(this._paneBottomR,this.paneBottomH),oe.height(this._viewportBottomR,this.paneBottomH))):this.hasFrozenRows&&(oe.width(this._paneBottomL,"100%"),oe.height(this._paneBottomL,this.paneBottomH),oe.setStyleSize(this._paneBottomL,"top",n)),this.hasFrozenRows?(oe.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(oe.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&oe.height(this._canvasBottomR,this.frozenRowsHeight)):(oe.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&oe.height(this._canvasTopR,this.frozenRowsHeight))):oe.height(this._viewportTopR,this.viewportTopH),(!this.scrollbarDimensions||!this.scrollbarDimensions.width)&&(this.scrollbarDimensions=this.measureScrollbar()),this._options.forceFitColumns&&this.legacyAutosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}}updatePagingStatusFromView(e){this.pagingActive=e.pageSize!==0,this.pagingIsLastPage=e.pageNum===e.totalPages-1}updateRowCount(){var e,t;if(this.initialized){const r=this.getDataLength(),n=this.getDataLengthIncludingAddNew();let s=0,a=this.hasFrozenRows&&!this._options.frozenBottom?oe.height(this._canvasBottomL):oe.height(this._canvasTopL);this.hasFrozenRows?s=this.getDataLength()-this._options.frozenRow:s=n+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);const o=oe.height(this._viewportScrollContainerY),c=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&s*this._options.rowHeight>o,this.makeActiveCellNormal();const h=r-1;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(u=>{const d=+u;d>h&&this.removeRowFromCache(d)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>h&&this.resetActiveCell(),a=this.h,this._options.autoHeight?this.h=this._options.rowHeight*s:(this.th=Math.max(this._options.rowHeight*s,o-(((e=this.scrollbarDimensions)==null?void 0:e.height)||0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==a||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(oe.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&oe.height(this._canvasBottomR,this.h)):(oe.height(this._canvasTopL,this.h),oe.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.enforceFrozenRowHeightRecalc=!1);const l=this.scrollTop+this.offset<=this.th-o;this.th===0||this.scrollTop===0?this.page=this.offset=0:l?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-o+(((t=this.scrollbarDimensions)==null?void 0:t.height)||0)),this.h!==a&&this._options.autoHeight&&this.resizeCanvas(),this._options.forceFitColumns&&c!==this.viewportHasVScroll&&this.legacyAutosizeColumns(),this.updateCanvasWidth(!1)}}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return e??(e=this.scrollTop),t??(t=this.scrollLeft),{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){const r=this.getVisibleRange(e,t),n=Math.round(this.viewportH/this._options.rowHeight),s=this._options.minRowBuffer;return this.vScrollDir===-1?(r.top-=n,r.bottom+=s):this.vScrollDir===1?(r.top-=s,r.bottom+=n):(r.top-=s,r.bottom+=s),r.top=Math.max(0,r.top),r.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,r.bottom),r.leftPx-=this.viewportW,r.rightPx+=this.viewportW,r.leftPx=Math.max(0,r.leftPx),r.rightPx=Math.min(this.canvasWidth,r.rightPx),r}ensureCellNodesInRowsCache(e){var r;const t=this.rowsCache[e];if(t!=null&&t.cellRenderQueue.length&&((r=t.rowNode)!=null&&r.length)){const n=t.rowNode;let s=Array.from(n[0].children);n.length>1&&(s=s.concat(Array.from(n[1].children)));let a=s.length-1;for(;t.cellRenderQueue.length;){const o=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[o]=s[a--]}}}cleanUpCells(e,t){var o,c;if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;const r=this.rowsCache[t],n=[];Object.keys(r.cellNodesByColumnIdx).forEach(h=>{if(!r.cellNodesByColumnIdx.hasOwnProperty(h))return;const l=+h;if(l<=this._options.frozenColumn||Array.isArray(this.columns)&&this.columns[l]&&this.columns[l].alwaysRenderColumn)return;const u=r.cellColSpans[l];(this.columnPosLeft[l]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(l||0)+u-1)]<e.leftPx)&&(t===this.activeRow&&Number(l)===this.activeCell||n.push(l))});let s,a;for(;oi(s=n.pop());)a=r.cellNodesByColumnIdx[s],this._options.enableAsyncPostRenderCleanup&&((o=this.postProcessedRows[t])!=null&&o[s])?this.queuePostProcessedCellForCleanup(a,s,t):(c=a.parentElement)==null||c.removeChild(a),delete r.cellColSpans[s],delete r.cellNodesByColumnIdx[s],this.postProcessedRows[t]&&delete this.postProcessedRows[t][s]}cleanUpAndRenderCells(e){var h,l;let t;const r=document.createElement("div"),n=[];let s,a;for(let u=e.top,d=e.bottom;u<=d;u++){if(t=this.rowsCache[u],!t)continue;this.ensureCellNodesInRowsCache(u),this.cleanUpCells(e,u),s=0;let f=((l=(h=this.data)==null?void 0:h.getItemMetadata)==null?void 0:l.call(h,u))??{};f=f==null?void 0:f.columns;const p=this.getDataItem(u);for(let m=0,v=this.columns.length;m<v;m++){if(!this.columns[m]||this.columns[m].hidden)continue;if(this.columnPosLeft[m]>e.rightPx)break;if(oi(a=t.cellColSpans[m])){m+=a>1?a-1:0;continue}if(a=1,f){const x=f[this.columns[m].id]||f[m];a=(x==null?void 0:x.colspan)??1,a==="*"&&(a=v-m)}const _=a;this.columnPosRight[Math.min(v-1,m+_-1)]>e.leftPx&&(this.appendCellHtml(r,u,m,_,p),s++),m+=_>1?_-1:0}s&&n.push(u)}if(!r.children.length)return;let o,c;for(;oi(o=n.pop());){t=this.rowsCache[o];let u;for(;oi(u=t.cellRenderQueue.pop());)c=r.lastChild,c&&(this.hasFrozenColumns()&&u>this._options.frozenColumn?t.rowNode[1].appendChild(c):t.rowNode[0].appendChild(c),t.cellNodesByColumnIdx[u]=c)}}renderRows(e){var h,l,u,d;const t=[],r=[],n=[];let s=!1;const a=this.getDataLength();for(let f=e.top,p=e.bottom;f<=p;f++)this.rowsCache[f]||this.hasFrozenRows&&this._options.frozenBottom&&f===this.getDataLength()||(this.renderedRows++,n.push(f),this.rowsCache[f]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},this.appendRowHtml(t,r,f,e,a),this.activeCellNode&&this.activeRow===f&&(s=!0),this.counter_rows_rendered++);if(!n.length)return;const o=document.createElement("div"),c=document.createElement("div");t.forEach(f=>o.appendChild(f)),r.forEach(f=>c.appendChild(f));for(let f=0,p=n.length;f<p;f++)this.hasFrozenRows&&n[f]>=this.actualFrozenRow?this.hasFrozenColumns()?(h=this.rowsCache)!=null&&h.hasOwnProperty(n[f])&&o.firstChild&&c.firstChild&&(this.rowsCache[n[f]].rowNode=[o.firstChild,c.firstChild],this._canvasBottomL.appendChild(o.firstChild),this._canvasBottomR.appendChild(c.firstChild)):(l=this.rowsCache)!=null&&l.hasOwnProperty(n[f])&&o.firstChild&&(this.rowsCache[n[f]].rowNode=[o.firstChild],this._canvasBottomL.appendChild(o.firstChild)):this.hasFrozenColumns()?(u=this.rowsCache)!=null&&u.hasOwnProperty(n[f])&&o.firstChild&&c.firstChild&&(this.rowsCache[n[f]].rowNode=[o.firstChild,c.firstChild],this._canvasTopL.appendChild(o.firstChild),this._canvasTopR.appendChild(c.firstChild)):(d=this.rowsCache)!=null&&d.hasOwnProperty(n[f])&&o.firstChild&&(this.rowsCache[n[f]].rowNode=[o.firstChild],this._canvasTopL.appendChild(o.firstChild));s&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}startPostProcessing(){this._options.enableAsyncPostRender&&(clearTimeout(this.h_postrender),this.h_postrender=setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){typeof this.postProcessedRows[e]=="object"&&Object.keys(this.postProcessedRows[e]).forEach(t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")}),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}updateRowPositions(){this.rowsCache&&typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(e=>{const t=e?parseInt(e,10):0;oe.setStyleSize(this.rowsCache[t].rowNode[0],"top",this.getRowTop(t))})}render(){if(this.initialized){this.scrollThrottle.dequeue();const e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){const r=Br(!0,{},t);this._options.frozenBottom?(r.top=this.actualFrozenRow,r.bottom=this.getDataLength()):(r.top=0,r.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(r)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.h_render=null,this.triggerEvent(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}}handleHeaderRowScroll(){const e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){const e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleElementScroll(e){const t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(){return this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(!1)}_handleScroll(e){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,r=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),r=Math.max(0,r),this.scrollTop>t&&(this.scrollTop=t),this.scrollLeft>r&&(this.scrollLeft=r);const n=Math.abs(this.scrollTop-this.prevScrollTop),s=Math.abs(this.scrollLeft-this.prevScrollLeft);if(s&&(this.prevScrollLeft=this.scrollLeft,this._viewportScrollContainerX.scrollLeft=this.scrollLeft,this._headerScrollContainer.scrollLeft=this.scrollLeft,this._topPanelScrollers[0].scrollLeft=this.scrollLeft,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=this.scrollLeft),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=this.scrollLeft:this._preHeaderPanelScroller.scrollLeft=this.scrollLeft),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=this.scrollLeft),this._headerRowScrollerR.scrollLeft=this.scrollLeft):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=this.scrollLeft),this._headerRowScrollerL.scrollLeft=this.scrollLeft)),n&&!this._options.autoHeight)if(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,e&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),n<this.viewportH)this.scrollTo(this.scrollTop+this.offset);else{const a=this.offset;this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj),a!==this.offset&&this.invalidateAllRows()}if(s||n){const a=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),o=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(a>20||o>20)&&(this._options.forceSyncScrolling||o<this.viewportH&&a<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.triggerEvent(this.onViewportChanged,{}))}return this.triggerEvent(this.onScroll,{scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!!(s||n)}actionThrottle(e,t){let r=!1,n=!1;const s=()=>{r?n=!0:o()},a=()=>{n=!1},o=()=>{r=!0,clearTimeout(this._executionBlockTimer),this._executionBlockTimer=setTimeout(c,t),e.call(this)},c=()=>{n?(a(),o()):r=!1};return{enqueue:s.bind(this),dequeue:a.bind(this)}}asyncPostProcessRows(){const e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){const t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,r=this.rowsCache[t];if(!(!r||t>=e)){this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(r.cellNodesByColumnIdx).forEach(n=>{if(r.cellNodesByColumnIdx.hasOwnProperty(n)){const s=+n,a=this.columns[s],o=this.postProcessedRows[t][s];if(a.asyncPostRender&&o!=="R"){const c=r.cellNodesByColumnIdx[s];c&&a.asyncPostRender(c,t,this.getDataItem(t),a,o==="C"),this.postProcessedRows[t][s]="R"}}}),this.h_postrender=setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay);return}}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){const e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){const t=this.postProcessedCleanupQueue.shift();if((t==null?void 0:t.actionType)==="R"&&t.node.forEach(r=>{r.remove()}),(t==null?void 0:t.actionType)==="C"){const r=this.columns[t.columnIdx];r.asyncPostRenderCleanup&&t.node&&r.asyncPostRenderCleanup(t.node,t.rowIdx,r)}}this.h_postrenderCleanup=setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let r,n,s;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(a=>{this.rowsCache&&(s=t==null?void 0:t[a],n=e==null?void 0:e[a],s&&Object.keys(s).forEach(o=>{(!n||s[o]!==n[o])&&(r=this.getCellNode(+a,this.getColumnIndex(o)),r&&r.classList.remove(s[o]))}),n&&Object.keys(n).forEach(o=>{(!s||s[o]!==n[o])&&(r=this.getCellNode(+a,this.getColumnIndex(o)),r&&r.classList.add(n[o]))}))})}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){const r=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,r),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,r=250){const n=(s,a)=>{a<1||(clearTimeout(this._flashCellTimer),this._flashCellTimer=setTimeout(()=>{a%2===0?s.classList.add(this._options.cellFlashingCssClass||""):s.classList.remove(this._options.cellFlashingCssClass||""),n(s,a-1)},r))};if(this.rowsCache[e]){const s=this.getCellNode(e,t);s&&n(s,5)}}highlightRow(e,t){const r=this.rowsCache[e];t||(t=this._options.rowHighlightDuration),Array.isArray(r==null?void 0:r.rowNode)&&this._options.rowHighlightCssClass&&(r.rowNode.forEach(n=>n.classList.add(...gi(this._options.rowHighlightCssClass))),clearTimeout(this._highlightRowTimer),this._highlightRowTimer=setTimeout(()=>{var n;(n=r.rowNode)==null||n.forEach(s=>s.classList.remove(...gi(this._options.rowHighlightCssClass)))},t))}handleMouseWheel(e,t,r,n){this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-n*this._options.rowHeight),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+r*10,this._handleScroll(!0)&&e.preventDefault()}handleDragInit(e,t){const r=this.getCellFromEvent(e);if(!r||!this.cellExists(r.row,r.cell))return!1;const n=this.triggerEvent(this.onDragInit,t,e);return n.isImmediatePropagationStopped()?n.getReturnValue():!1}handleDragStart(e,t){const r=this.getCellFromEvent(e);if(!r||!this.cellExists(r.row,r.cell))return!1;const n=this.triggerEvent(this.onDragStart,t,e);return n.isImmediatePropagationStopped()?n.getReturnValue():!1}handleDrag(e,t){return this.triggerEvent(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.triggerEvent(this.onDragEnd,t,e)}handleKeyDown(e){var n,s,a;let r=this.triggerEvent(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!r&&!e.shiftKey&&!e.altKey){if(this._options.editable&&((n=this.currentEditor)!=null&&n.keyCaptureList)&&this.currentEditor.keyCaptureList.indexOf(String(e.which))>-1)return;e.key==="Home"?r=e.ctrlKey?this.navigateTop():this.navigateRowStart():e.key==="End"&&(r=e.ctrlKey?this.navigateBottom():this.navigateRowEnd())}if(!r)if(!e.shiftKey&&!e.altKey&&!e.ctrlKey)if(e.key==="Escape"){if(!((s=this.getEditorLock())!=null&&s.isActive()))return;this.cancelEditAndSetFocus()}else e.key==="PageDown"?(this.navigatePageDown(),r=!0):e.key==="PageUp"?(this.navigatePageUp(),r=!0):e.key==="ArrowLeft"?r=this.navigateLeft():e.key==="ArrowRight"?r=this.navigateRight():e.key==="ArrowUp"?r=this.navigateUp():e.key==="ArrowDown"?r=this.navigateDown():e.key==="Tab"?r=this.navigateNext():e.key==="Enter"&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():(a=this.getEditorLock())!=null&&a.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),r=!0);else e.key==="Tab"&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(r=this.navigatePrev());r&&(e.stopPropagation(),e.preventDefault())}handleClick(e){var n,s,a;const t=e instanceof Yt?e.getNativeEvent():e;if(!this.currentEditor&&(t.target!==document.activeElement||t.target.classList.contains("slick-cell"))){const o=this.getTextSelection();this.setFocus(),this.setTextSelection(o)}const r=this.getCellFromEvent(t);if(!(!r||this.currentEditor!==null&&this.activeRow===r.row&&this.activeCell===r.cell)&&(e=this.triggerEvent(this.onClick,{row:r.row,cell:r.cell},e||t),!(e.isImmediatePropagationStopped()||t.defaultPrevented)&&this.canCellBeActive(r.row,r.cell)&&(!((n=this.getEditorLock())!=null&&n.isActive())||(s=this.getEditorLock())!=null&&s.commitCurrentEdit()))){this.scrollRowIntoView(r.row,!1);const o=((a=t.target)==null?void 0:a.className)===cx,c=this.columns[r.cell],h=!!(this._options.editable&&(c!=null&&c.editor)&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(r.row,r.cell),null,o,h,t)}}handleContextMenu(e){const t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&this.currentEditor!==null||this.triggerEvent(this.onContextMenu,{},e))}handleDblClick(e){const t=this.getCellFromEvent(e);!t||this.currentEditor!==null&&this.activeRow===t.row&&this.activeCell===t.cell||(this.triggerEvent(this.onDblClick,{row:t.row,cell:t.cell},e),!e.defaultPrevented&&this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){const t=oe.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseLeave(e){const t=oe.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){const t=oe.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){const t=oe.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderContextMenu(e){const t=e.target.closest(".slick-header-column"),r=t&&oe.storage.get(t,"column");this.triggerEvent(this.onHeaderContextMenu,{column:r},e)}handleHeaderClick(e){if(this.columnResizeDragging)return;const t=e.target.closest(".slick-header-column"),r=t&&oe.storage.get(t,"column");r&&this.triggerEvent(this.onHeaderClick,{column:r},e)}handleFooterContextMenu(e){const t=e.target.closest(".slick-footerrow-column"),r=t&&oe.storage.get(t,"column");this.triggerEvent(this.onFooterContextMenu,{column:r},e)}handleFooterClick(e){const t=e.target.closest(".slick-footerrow-column"),r=t&&oe.storage.get(t,"column");this.triggerEvent(this.onFooterClick,{column:r},e)}handleCellMouseOver(e){this.triggerEvent(this.onMouseEnter,{},e)}handleCellMouseOut(e){this.triggerEvent(this.onMouseLeave,{},e)}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromPoint(e,t){let r=this.getRowFromPosition(t),n=0,s=0;for(let a=0;a<this.columns.length&&s<=e;a++)!this.columns[a]||this.columns[a].hidden||(s+=this.columns[a].width,n++);return n-=1,r<-1&&(r=-1),{row:r,cell:n}}getCellFromNode(e){const t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){var t;for(const r in this.rowsCache)if(this.rowsCache){for(const n in this.rowsCache[r].rowNode)if(((t=this.rowsCache[r].rowNode)==null?void 0:t[+n])===e)return r?parseInt(r,10):0}return null}getFrozenRowOffset(e){let t=0;return this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?t=this.actualFrozenRow*this._options.rowHeight:t=this.h:t=0:e>=this.actualFrozenRow?t=this.frozenRowsHeight:t=0:t=0,t}getCellFromEvent(e){const t=e instanceof Yt?e.getNativeEvent():e;if(!t)return null;const r=t.touches?t.touches[0]:t,n=t.target.closest(".slick-cell");if(!n)return null;let s=this.getRowFromNode(n.parentNode);if(this.hasFrozenRows){let o=0;const c=xi(oe.parents(n,".grid-canvas")[0]);oe.parents(n,".grid-canvas-bottom").length&&(o=this._options.frozenBottom?oe.height(this._canvasTopL):this.frozenRowsHeight);const l=r.clientX-c.left,u=r.clientY-c.top+o+document.documentElement.scrollTop;s=this.getCellFromPoint(l,u).row}const a=this.getCellFromNode(n);return!ta(s)||!ta(a)?null:{row:s,cell:a}}getCellNodeBox(e,t){var c;if(!this.cellExists(e,t))return null;const r=this.getFrozenRowOffset(e),n=this.getRowTop(e)-r,s=n+this._options.rowHeight-1;let a=0;for(let h=0;h<t;h++)!this.columns[h]||this.columns[h].hidden||(a+=this.columns[h].width||0,this._options.frozenColumn===h&&(a=0));const o=a+(((c=this.columns[t])==null?void 0:c.width)||0);return{top:n,left:a,bottom:s,right:o}}resetActiveCell(){this.setActiveCellInternal(null,!1)}focus(){this.setFocus()}setFocus(){this.tabbingDirection===-1?this._focusSink.focus():this._focusSink2.focus()}scrollCellIntoView(e,t,r){if(this.scrollRowIntoView(e,r),t<=this._options.frozenColumn)return;const n=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(n>1?n-1:0)])}internalScrollColumnIntoView(e,t){var n;const r=this.scrollLeft+oe.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&((n=this.scrollbarDimensions)==null?void 0:n.width)||0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>r&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}setActiveCellInternal(e,t,r,n,s){var a,o,c,h;if(oi(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),(o=(a=this.rowsCache[this.activeRow])==null?void 0:a.rowNode)==null||o.forEach(l=>l.classList.remove("active"))),this.activeCellNode=e,oi(this.activeCellNode)){const l=xi(this.activeCellNode);let u=Math.floor(xi(oe.parents(this.activeCellNode,".grid-canvas")[0]).top);const d=oe.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&d&&(u-=this._options.frozenBottom?oe.height(this._canvasTopL):this.frozenRowsHeight);const f=this.getCellFromPoint(l.left,Math.ceil(l.top)-u);this.activeRow=f.row,this.activeCell=this.activePosX=this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!oi(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(this.activeCellNode.classList.add("active"),(h=(c=this.rowsCache[this.activeRow])==null?void 0:c.rowNode)==null||h.forEach(p=>p.classList.add("active"))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(clearTimeout(this.h_editorLoader),this.h_editorLoader=setTimeout(()=>{this.makeActiveCellEditable(void 0,r,s)},this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,r,s))}else this.activeRow=this.activeCell=null;n||this.triggerEvent(this.onActiveCellChanged,this.getActiveCell())}clearTextSelection(){var e;if((e=document.selection)!=null&&e.empty)try{document.selection.empty()}catch{}else if(window.getSelection){const t=window.getSelection();t!=null&&t.removeAllRanges&&t.removeAllRanges()}}isCellPotentiallyEditable(e,t){const r=this.getDataLength();return!(e<r&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=r||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){var t;if(this.currentEditor){if(this.triggerEvent(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){const r=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable"),this.activeCellNode.classList.remove("invalid"),r){const n=this.columns[this.activeCell],a=this.getFormatter(this.activeRow,n)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(r,n),n,r,this);this.applyFormatResultToCellNode(a,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}navigator.userAgent.toLowerCase().match(/msie/)&&this.clearTextSelection(),(t=this.getEditorLock())==null||t.deactivate(this.editController)}}editActiveCell(e,t,r){this.makeActiveCellEditable(e,t,r)}makeActiveCellEditable(e,t,r){var h,l,u,d,f,p;if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when grid options.editable is false");if(clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;const n=this.columns[this.activeCell],s=this.getDataItem(this.activeRow);if(this.triggerEvent(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:s,column:n,target:"grid"}).getReturnValue()===!1){this.setFocus();return}(h=this.getEditorLock())==null||h.activate(this.editController),this.activeCellNode.classList.add("editable");const a=e||this.getEditor(this.activeRow,this.activeCell);!e&&!a.suppressClearOnEdit&&Rt(this.activeCellNode);let o=(u=(l=this.data)==null?void 0:l.getItemMetadata)==null?void 0:u.call(l,this.activeRow);o=o==null?void 0:o.columns;const c=o&&(o[n.id]||o[this.activeCell]);this.currentEditor=new a({grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:n,columnMetaData:c,item:s||{},event:r,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)}),s&&this.currentEditor&&(this.currentEditor.loadValue(s),t&&typeof((d=this.currentEditor)==null?void 0:d.preClick)=="function"&&this.currentEditor.preClick()),this.serializedEditorValue=(f=this.currentEditor)==null?void 0:f.serializeValue(),(p=this.currentEditor)!=null&&p.position&&this.handleActiveCellPositionChange()}commitEditAndSetFocus(){var e;(e=this.getEditorLock())!=null&&e.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&this.navigateDown())}cancelEditAndSetFocus(){var e;(e=this.getEditorLock())!=null&&e.cancelCurrentEdit()&&this.setFocus()}absBox(e){const t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;let r=e.offsetParent;for(;(e=e.parentNode)!==document.body&&!(!e||!e.parentNode);){const n=getComputedStyle(e);t.visible&&e.scrollHeight!==e.offsetHeight&&n.overflowY!=="visible"&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!==e.offsetWidth&&n.overflowX!=="visible"&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===r&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,r=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.triggerEvent(this.onActiveCellPositionChanged,{}),this.currentEditor)){const e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){let e=null;if(window.getSelection){const t=window.getSelection();((t==null?void 0:t.rangeCount)||0)>0&&(e=t.getRangeAt(0))}return e}setTextSelection(e){if(window.getSelection&&e){const t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}scrollRowIntoView(e,t){var r;if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){const n=oe.height(this._viewportScrollContainerY),s=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,a=s*this._options.rowHeight,o=(s+1)*this._options.rowHeight-n+(this.viewportHasHScroll&&((r=this.scrollbarDimensions)==null?void 0:r.height)||0);(s+1)*this._options.rowHeight>this.scrollTop+n+this.offset?(this.scrollTo(t?a:o),this.render()):s*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?o:a),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){const t=e*this.numVisibleRows,r=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(r)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&oi(this.activeRow)){let n=this.activeRow+t;const s=this.getDataLengthIncludingAddNew();n>=s&&(n=s-1),n<0&&(n=0);let a=0,o=null;const c=this.activePosX;for(;a<=this.activePosX;)this.canCellBeActive(n,a)&&(o=a),a+=this.getColspan(n,a);o!==null?(this.setActiveCellInternal(this.getCellNode(n,o)),this.activePosX=c):this.resetActiveCell()}}navigatePageDown(){this.scrollPage(1)}navigatePageUp(){this.scrollPage(-1)}navigateTop(){this.navigateToRow(0)}navigateBottom(){return this.navigateToRow(this.getDataLength()-1)}navigateToRow(e){const t=this.getDataLength();if(!t)return!0;if(e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0),this._options.enableCellNavigation&&oi(this.activeRow)){let r=0,n=null;const s=this.activePosX;for(;r<=this.activePosX;)this.canCellBeActive(e,r)&&(n=r),r+=this.getColspan(e,r);n!==null?(this.setActiveCellInternal(this.getCellNode(e,n)),this.activePosX=s):this.resetActiveCell()}return!0}getColspan(e,t){var a,o;const r=(o=(a=this.data)==null?void 0:a.getItemMetadata)==null?void 0:o.call(a,e);if(!r||!r.columns)return 1;const n=r.columns[this.columns[t].id]||r.columns[t];let s=n==null?void 0:n.colspan;return s==="*"?s=this.columns.length-t:s=s||1,s}findFirstFocusableCell(e){let t=0;for(;t<this.columns.length;){if(this.canCellBeActive(e,t))return t;t+=this.getColspan(e,t)}return null}findLastFocusableCell(e){let t=0,r=null;for(;t<this.columns.length;)this.canCellBeActive(e,t)&&(r=t),t+=this.getColspan(e,t);return r}gotoRight(e,t,r){if(t>=this.columns.length)return null;do t+=this.getColspan(e,t);while(t<this.columns.length&&!this.canCellBeActive(e,t));return t<this.columns.length?{row:e,cell:t,posX:t}:null}gotoLeft(e,t,r){if(t<=0)return null;const n=this.findFirstFocusableCell(e);if(n===null||n>=t)return null;let s={row:e,cell:n,posX:n},a;for(;;){if(a=this.gotoRight(s.row,s.cell,s.posX),!a)return null;if(a.cell>=t)return s;s=a}}gotoDown(e,t,r){let n;const s=this.getDataLengthIncludingAddNew();for(;;){if(++e>=s)return null;for(n=t=0;t<=r;)n=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,n))return{row:e,cell:n,posX:r}}}gotoUp(e,t,r){let n;for(;;){if(--e<0)return null;for(n=t=0;t<=r;)n=t,t+=this.getColspan(e,t);if(this.canCellBeActive(e,n))return{row:e,cell:n,posX:r}}}gotoNext(e,t,r){if(!ta(e)&&!ta(t)&&(e=t=r=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};const n=this.gotoRight(e,t,r);if(n)return n;let s=null;const a=this.getDataLengthIncludingAddNew();for(e===a-1&&e--;++e<a;)if(s=this.findFirstFocusableCell(e),s!==null)return{row:e,cell:s,posX:s};return null}gotoPrev(e,t,r){if(!ta(e)&&!ta(t)&&(e=this.getDataLengthIncludingAddNew()-1,t=r=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t};let n,s;for(;!n&&(n=this.gotoLeft(e,t,r),!n);){if(--e<0)return null;t=0,s=this.findLastFocusableCell(e),s!==null&&(n={row:e,cell:s,posX:s})}return n}gotoRowStart(e,t,r){const n=this.findFirstFocusableCell(e);return n===null?null:{row:e,cell:n,posX:n}}gotoRowEnd(e,t,r){const n=this.findLastFocusableCell(e);return n===null?null:{row:e,cell:n,posX:n}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigate(e){var a;if(!this._options.enableCellNavigation||!this.activeCellNode&&e!=="prev"&&e!=="next")return!1;if(!((a=this.getEditorLock())!=null&&a.commitCurrentEdit()))return!0;this.setFocus();const t={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1};this.tabbingDirection=t[e];const s={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosX);if(s){const o=this.getDataLength();if(this.hasFrozenRows&&this._options.frozenBottom&&s.row===o)return;const c=s.row===o;return(!this._options.frozenBottom&&s.row>=this.actualFrozenRow||this._options.frozenBottom&&s.row<this.actualFrozenRow)&&this.scrollCellIntoView(s.row,s.cell,!c&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(s.row,s.cell)),this.activePosX=s.posX,!0}else return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch{return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,r,n,s){!this.initialized||!this._options.enableCellNavigation||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),r,n,s))}setActiveRow(e,t,r){t??(t=0),!(!this.initialized||e>this.getDataLength()||e<0||t>=this.columns.length||t<0)&&(this.activeRow=e,r||this.scrollCellIntoView(e,t,!1))}canCellBeActive(e,t){var s,a,o,c;if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;const r=(a=(s=this.data)==null?void 0:s.getItemMetadata)==null?void 0:a.call(s,e);if((r==null?void 0:r.focusable)!==void 0)return!!r.focusable;const n=r==null?void 0:r.columns;return((o=n==null?void 0:n[this.columns[t].id])==null?void 0:o.focusable)!==void 0?!!n[this.columns[t].id].focusable:((c=n==null?void 0:n[t])==null?void 0:c.focusable)!==void 0?!!n[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){var s,a;if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;const r=(a=(s=this.data)==null?void 0:s.getItemMetadata)==null?void 0:a.call(s,e);if((r==null?void 0:r.selectable)!==void 0)return!!r.selectable;const n=(r==null?void 0:r.columns)&&(r.columns[this.columns[t].id]||r.columns[t]);return(n==null?void 0:n.selectable)!==void 0?!!n.selectable:!!this.columns[t].selectable}gotoCell(e,t,r,n){var c;if(!this.initialized||!this.canCellBeActive(e,t)||!((c=this.getEditorLock())!=null&&c.commitCurrentEdit()))return;this.scrollCellIntoView(e,t,!1);const s=this.getCellNode(e,t),a=this.columns[t],o=!!(this._options.editable&&(a!=null&&a.editor)&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(s,r||e===this.getDataLength()||this._options.autoEdit,null,o,n),this.currentEditor||this.setFocus()}commitCurrentEdit(){var n;const e=this,t=e.getDataItem(e.activeRow),r=e.columns[e.activeCell];if(e.currentEditor){if(e.currentEditor.isValueChanged()){const s=e.currentEditor.validate();if(s.valid){const a=e.activeRow,o=e.activeCell,c=e.currentEditor,h=e.currentEditor.serializeValue(),l=e.serializedEditorValue;if(e.activeRow<e.getDataLength()){const u={row:a,cell:o,editor:c,serializedValue:h,prevSerializedValue:l,execute:()=>{c.applyValue(t,h),e.updateRow(a),e.triggerEvent(e.onCellChange,{command:"execute",row:a,cell:o,item:t,column:r})},undo:()=>{c.applyValue(t,l),e.updateRow(a),e.triggerEvent(e.onCellChange,{command:"undo",row:a,cell:o,item:t,column:r})}};e._options.editCommandHandler?(e.makeActiveCellNormal(!0),e._options.editCommandHandler(t,r,u)):(u.execute(),e.makeActiveCellNormal(!0))}else{const u={};e.currentEditor.applyValue(u,e.currentEditor.serializeValue()),e.makeActiveCellNormal(!0),e.triggerEvent(e.onAddNewRow,{item:u,column:r})}return!((n=e.getEditorLock())!=null&&n.isActive())}else return e.activeCellNode&&(e.activeCellNode.classList.remove("invalid"),oe.width(e.activeCellNode),e.activeCellNode.classList.add("invalid")),e.triggerEvent(e.onValidationError,{editor:e.currentEditor,cellNode:e.activeCellNode,validationResults:s,row:e.activeRow,cell:e.activeCell,column:r}),e.currentEditor.focus(),!1}e.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}rowsToRanges(e){const t=[],r=this.columns.length-1;for(let n=0;n<e.length;n++)t.push(new Jr(e[n],0,e[n],r));return t}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");const r=this.getEditorLock();typeof(r==null?void 0:r.isActive)=="function"&&!r.isActive()&&this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}sanitizeHtmlString(e){return!this._options.sanitizer||typeof e!="string"?e:this._options.sanitizer(e)}}class Hx{constructor(e){this.pluginName="AutoTooltips",this._defaults={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:void 0,replaceExisting:!0},this._eventHandler=new di,this._addonOptions=e}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e){this._addonOptions={...this._defaults,...this.addonOptions},this._grid=e,this._addonOptions.enableForCells&&this._eventHandler.subscribe(this._grid.onMouseEnter,this.handleMouseEnter.bind(this)),this._addonOptions.enableForHeaderCells&&this._eventHandler.subscribe(this._grid.onHeaderMouseEnter,this.handleHeaderMouseEnter.bind(this))}destroy(){this.dispose()}dispose(){var e;(e=this._eventHandler)==null||e.unsubscribeAll()}handleMouseEnter(e){var r,n,s,a;const t=this._grid.getCellFromEvent(e);if(t){let o=this._grid.getCellNode(t.row,t.cell),c;this._addonOptions&&o&&(!o.title||(r=this._addonOptions)!=null&&r.replaceExisting)&&(o.clientWidth<o.scrollWidth?(c=((n=o.textContent)==null?void 0:n.trim())??"",(s=this._addonOptions)!=null&&s.maxToolTipLength&&c.length>((a=this._addonOptions)==null?void 0:a.maxToolTipLength)&&(c=c.substring(0,this._addonOptions.maxToolTipLength-3)+"...")):c="",o.title=c),o=null}}handleHeaderMouseEnter(e,t){const r=t.column;let n;const s=e.target;if(s&&(n=s.closest(".slick-header-column"),n&&!(r!=null&&r.toolTip))){const a=s.clientWidth<n.clientWidth?(r==null?void 0:r.name)??"":"";n.title=Rn(Ls(a,"innerHTML"))}n=null}}class Vx{constructor(){this.pluginName="CellExcelCopyManager",this._eventHandler=new di,this._bindingEventService=new Xi}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get commandQueue(){return this._commandQueue}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get undoRedoBuffer(){return this._undoRedoBuffer}init(e,t){this._grid=e,this.createUndoRedoBuffer(),this._cellSelectionModel=new $x,this._grid.setSelectionModel(this._cellSelectionModel),this._bindingEventService.bind(document.body,"keydown",this.handleBodyKeyDown.bind(this)),this._addonOptions={...this.getDefaultOptions(),...t},this._cellExternalCopyManagerPlugin=new Wx,this._cellExternalCopyManagerPlugin.init(this._grid,this._addonOptions),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCells,(r,n)=>{this._addonOptions&&typeof this._addonOptions.onCopyCells=="function"&&this._addonOptions.onCopyCells(r,n)}),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCancelled,(r,n)=>{this._addonOptions&&typeof this._addonOptions.onCopyCancelled=="function"&&this._addonOptions.onCopyCancelled(r,n)}),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onPasteCells,(r,n)=>{this._addonOptions&&typeof this._addonOptions.onPasteCells=="function"&&this._addonOptions.onPasteCells(r,n)})}dispose(){var e,t;this._eventHandler.unsubscribeAll(),this._bindingEventService.unbindAll(),(e=this._cellSelectionModel)==null||e.dispose(),(t=this._cellExternalCopyManagerPlugin)==null||t.dispose()}createUndoRedoBuffer(){let e=0;this._commandQueue=[],this._undoRedoBuffer={queueAndExecuteCommand:t=>{this._commandQueue[e]=t,e++,t.execute()},undo:()=>{if(e===0)return;e--;const t=this._commandQueue[e];t&&Bc.cancelCurrentEdit()&&t.undo()},redo:()=>{if(e>=this._commandQueue.length)return;const t=this._commandQueue[e];e++,t&&Bc.cancelCurrentEdit()&&t.execute()}}}getDefaultOptions(){let e=0;return{clipboardCommandHandler:t=>{this._undoRedoBuffer.queueAndExecuteCommand.call(this._undoRedoBuffer,t)},dataItemColumnValueExtractor:(t,r,n=0,s=0)=>{var c,h;const a=this._grid.getActiveCell(),o=this._grid.getCellEditor()&&(a==null?void 0:a.row)===n&&(a==null?void 0:a.cell)===s;if(!this.gridOptions.editable||!r.editor||!o){const l=r.exportWithFormatter!==void 0?r.exportWithFormatter:(c=this.gridOptions.textExportOptions)==null?void 0:c.exportWithFormatter;if(r.formatter&&l){const u=r.formatter(n,s,t[r.field],r,t,this._grid),d=rl(u)?u:u.html||u.text;if(r.sanitizeDataExport||(h=this.gridOptions.textExportOptions)!=null&&h.sanitizeDataExport){const f=d instanceof HTMLElement?d.innerHTML:d;return Rn(f??"")}return u}}return null},readOnlyMode:!1,includeHeaderWhenCopying:!1,newRowCreator:t=>{for(let r=0;r<t;r++)this._grid.getData().addItem({[this.gridOptions.datasetIdPropertyName||"id"]:`newRow_${e++}`})}}}handleBodyKeyDown(e){e.key==="Z"&&(e.ctrlKey||e.metaKey)&&(e.shiftKey?this._undoRedoBuffer.redo():this._undoRedoBuffer.undo())}}const Ux=2e3,tp=100;class Wx{constructor(){this.pluginName="CellExternalCopyManager",this.onCopyCells=new ze("onCopyCells"),this.onCopyCancelled=new ze("onCopyCancelled"),this.onPasteCells=new ze("onPasteCells"),this.onBeforePasteCell=new ze("onBeforePasteCell"),this._bodyElement=document.body,this._copiedCellStyle="copied",this._copiedCellStyleLayerKey="copy-manager",this._copiedRanges=null,this._eventHandler=new di}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e,t){var s;this._grid=e,this._addonOptions={...this._addonOptions,...t},this._copiedCellStyleLayerKey=this._addonOptions.copiedCellStyleLayerKey||"copy-manager",this._copiedCellStyle=this._addonOptions.copiedCellStyle||"copied",this._bodyElement=this._addonOptions.bodyElement||document.body,this._onCopyInit=this._addonOptions.onCopyInit||void 0,this._onCopySuccess=this._addonOptions.onCopySuccess||void 0;const r=e.getPubSubService();r&&oe.addSlickEventPubSubWhenDefined(r,this),this._eventHandler.subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this));const n=e.getSelectionModel();if(!n)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new SlickCellSelectionModel())");if(this._eventHandler.subscribe(n.onSelectedRangesChanged,()=>{this._grid.getEditorLock().isActive()||this._grid.focus()}),e&&typeof((s=this._addonOptions)==null?void 0:s.onBeforePasteCell)=="function"){const a=e==null?void 0:e.getData();this._eventHandler.subscribe(this.onBeforePasteCell,(o,c)=>{var u,d;const h=e.getColumns()[c.cell],l={row:c.row,cell:c.cell,dataView:a,grid:e,columnDef:h,dataContext:e.getDataItem(c.row)};return(d=(u=this._addonOptions).onBeforePasteCell)==null?void 0:d.call(u,o,l)})}}dispose(){this._eventHandler.unsubscribeAll()}clearCopySelection(){this._grid.removeCellCssStyles(this._copiedCellStyleLayerKey)}getHeaderValueForColumn(e){if(typeof this._addonOptions.headerColumnValueExtractor=="function"){const t=Ls(this._addonOptions.headerColumnValueExtractor(e),"innerHTML");if(t)return Rn(t)}return Ls(e.name||"","innerHTML")}getDataItemValueForColumn(e,t,r,n,s){if(typeof this._addonOptions.dataItemColumnValueExtractor=="function"){const o=this._addonOptions.dataItemColumnValueExtractor(e,t,r,n);if(o)return o instanceof HTMLElement?Rn(o.innerHTML):o}let a="";if(t)if(t.editor){const o=document.createElement("p"),c=new t.editor({container:o,column:t,event:s,position:{top:0,left:0},grid:this._grid});c.loadValue(e),a=c.serializeValue(),c.destroy(),o.remove()}else a=e[t.field||""];return a}setDataItemValueForColumn(e,t,r){if(!(t!=null&&t.denyPaste)){if(this._addonOptions.dataItemColumnValueSetter)return this._addonOptions.dataItemColumnValueSetter(e,t,r);if(t.editor){const n=document.createElement("div"),s=new t.editor({container:n,column:t,position:{top:0,left:0},grid:this._grid});s.loadValue(e),s.applyValue(e,r),s.destroy(),n.remove()}else e[t.field]=r}}setIncludeHeaderWhenCopying(e){this._addonOptions.includeHeaderWhenCopying=e}createTextBox(e){const t=K("textarea",{value:e,style:{position:"absolute",left:"-1000px",top:`${document.body.scrollTop}px`}},this._bodyElement);return t.select(),t}decodeTabularData(e,t){var C;const r=e.getColumns(),s=t.value.split(/[\n\f\r]/);s[s.length-1]===""&&s.pop();let a=0;const o=[];this._bodyElement.removeChild(t);for(const y of s)o[a++]=y!==""?y.split("	"):[""];const c=this._grid.getActiveCell(),h=(C=this._grid.getSelectionModel())==null?void 0:C.getSelectedRanges(),l=h!=null&&h.length?h[0]:null;let u,d;if(l)u=l.fromRow,d=l.fromCell;else if(c)u=c.row,d=c.cell;else return;let f=!1,p=o.length,m=o.length?o[0].length:0;o.length===1&&o[0].length===1&&l&&(f=!0,p=l.toRow-l.fromRow+1,m=l.toCell-l.fromCell+1);const v=this._grid.getData().length-u;let _=0;if(v<p&&typeof this._addonOptions.newRowCreator=="function"){const y=this._grid.getData();for(_=1;_<=p-v;_++)y.push({});this._grid.setData(y),this._grid.render()}if(u+p>this._grid.getDataLength()&&typeof this._addonOptions.newRowCreator=="function"){const y=u+p-this._grid.getDataLength();this._addonOptions.newRowCreator(y)}const E={isClipboardCommand:!0,clippedRange:o,oldValues:[],cellExternalCopyManager:this,_options:this._addonOptions,setDataItemValueForColumn:this.setDataItemValueForColumn,markCopySelection:this.markCopySelection,oneCellToMultiple:f,activeRow:u,activeCell:d,destH:p,destW:m,maxDestY:this._grid.getDataLength(),maxDestX:this._grid.getColumns().length,h:0,w:0,execute:()=>{var b;E.h=0;for(let T=0;T<E.destH;T++){E.oldValues[T]=[],E.w=0,E.h++;for(let R=0;R<E.destW;R++){E.w++;const O=u+T,W=d+R;if(O<E.maxDestY&&W<E.maxDestX){const G=this._grid.getDataItem(O);if(this._grid.triggerEvent(this.onBeforePasteCell,{row:O,cell:W,dt:G,column:r[W],target:"grid"}).getReturnValue()===!1)continue;E.oldValues[T][R]=G[r[W].field],f?this.setDataItemValueForColumn(G,r[W],o[0][0]):this.setDataItemValueForColumn(G,r[W],o[T]?o[T][R]:""),this._grid.updateCell(O,W),this._grid.onCellChange.notify({row:O,cell:W,item:G,grid:this._grid,column:{}})}}}const y=new Jr(u,d,u+E.h-1,d+E.w-1);this.markCopySelection([y]),(b=this._grid.getSelectionModel())==null||b.setSelectedRanges([y]),this.onPasteCells.notify({ranges:[y]})},undo:()=>{var b;for(let T=0;T<E.destH;T++)for(let R=0;R<E.destW;R++){const O=u+T,W=d+R;if(O<E.maxDestY&&W<E.maxDestX){const G=this._grid.getDataItem(O);f?this.setDataItemValueForColumn(G,r[W],E.oldValues[0][0]):this.setDataItemValueForColumn(G,r[W],E.oldValues[T][R]),this._grid.updateCell(O,W),this._grid.onCellChange.notify({row:O,cell:W,item:G,grid:this._grid,column:{}})}}const y=new Jr(u,d,u+E.h-1,d+E.w-1);if(this.markCopySelection([y]),(b=this._grid.getSelectionModel())==null||b.setSelectedRanges([y]),this.onPasteCells.notify({ranges:[y]}),typeof this._addonOptions.onPasteCells=="function"&&this._addonOptions.onPasteCells(new Yt,{ranges:[y]}),_>1){const T=this._grid.getData();for(;_>1;_--)T.splice(T.length-1,1);this._grid.setData(T),this._grid.render()}}};this._addonOptions.clipboardCommandHandler?this._addonOptions.clipboardCommandHandler(E):E.execute()}handleKeyDown(e){var r,n,s;let t;if(!this._grid.getEditorLock().isActive()||this._grid.getOptions().autoEdit){if(e.key==="Escape"&&this._copiedRanges&&(e.preventDefault(),this.clearCopySelection(),this.onCopyCancelled.notify({ranges:this._copiedRanges}),typeof this._addonOptions.onCopyCancelled=="function"&&this._addonOptions.onCopyCancelled(e,{ranges:this._copiedRanges}),this._copiedRanges=null),(e.key==="c"||e.key==="Insert")&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(typeof this._onCopyInit=="function"&&this._onCopyInit.call(this),t=((r=this._grid.getSelectionModel())==null?void 0:r.getSelectedRanges())??[],t.length!==0)){this._copiedRanges=t,this.markCopySelection(t),this.onCopyCells.notify({ranges:t}),typeof this._addonOptions.onCopyCells=="function"&&this._addonOptions.onCopyCells(e,{ranges:t});const a=this._grid.getColumns();let o="";for(let c=0;c<t.length;c++){const h=t[c],l=[];for(let u=h.fromRow;u<h.toRow+1;u++){const d=[],f=this._grid.getDataItem(u);if(l.length===0&&this._addonOptions.includeHeaderWhenCopying){const p=[];for(let m=h.fromCell;m<h.toCell+1;m++)(a[m].name instanceof HTMLElement?Rn(a[m].name.innerHTML):a[m].name).length>0&&!a[m].hidden&&p.push(this.getHeaderValueForColumn(a[m]));l.push(p.join("	"))}for(let p=h.fromCell;p<h.toCell+1;p++)(a[p].name instanceof HTMLElement?Rn(a[p].name.innerHTML):a[p].name).length>0&&!a[p].hidden&&d.push(this.getDataItemValueForColumn(f,a[p],u,p,e));l.push(d.join("	"))}o+=l.join(`\r
`)+`\r
`}if(window.clipboardData)return window.clipboardData.setData("Text",o),!0;{const c=document.activeElement,h=this.createTextBox(o);if(h.focus(),setTimeout(()=>{this._bodyElement.removeChild(h),c?c.focus():console.log("No element to restore focus to after copy?")},((n=this.addonOptions)==null?void 0:n.clipboardPasteDelay)??tp),typeof this._onCopySuccess=="function"){const l=t.length===1?t[0].toRow+1-t[0].fromRow:t.length;this._onCopySuccess(l)}return!1}}if(!this._addonOptions.readOnlyMode&&(e.key==="v"&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.key==="Insert"&&e.shiftKey&&!e.ctrlKey)){const a=this.createTextBox("");return setTimeout(()=>this.decodeTabularData(this._grid,a),((s=this.addonOptions)==null?void 0:s.clipboardPasteDelay)??tp),!1}}}markCopySelection(e){var n;this.clearCopySelection();const t=this._grid.getColumns(),r={};for(const s of e)for(let a=s.fromRow;a<=s.toRow;a++){r[a]={};for(let o=s.fromCell;o<=s.toCell&&o<t.length;o++)r[a][t[o].id]=this._copiedCellStyle}this._grid.setCellCssStyles(this._copiedCellStyleLayerKey,r),clearTimeout(this._clearCopyTI),this._clearCopyTI=setTimeout(()=>this.clearCopySelection(),((n=this.addonOptions)==null?void 0:n.clearCopySelectionDelay)||Ux)}}class _h{constructor(e,t,r){this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this._addonOptions={},this._camelPluginName="",this._gridUid="",this._menuCssPrefix="",this._menuPluginCssPrefix="",this._bindEventService=new Xi,this._eventHandler=new di}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){var e;return this._gridUid||(((e=this.grid)==null?void 0:e.getUID())??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get menuCssClass(){return this._menuPluginCssPrefix||this._menuCssPrefix}get menuElement(){return this._menuElm||document.querySelector(`.${this.menuCssClass}${this.gridUidSelector}`)}dispose(){var e,t,r,n,s;(e=this._eventHandler)==null||e.unsubscribeAll(),this._bindEventService.unbindAll(),this.pubSubService.unsubscribeAll(),(t=this._commandTitleElm)==null||t.remove(),(r=this._optionTitleElm)==null||r.remove(),this.disposeAllMenus(),Rt(this._menuElm),(n=this.menuElement)==null||n.remove(),(s=this._menuElm)==null||s.remove()}disposeAllMenus(){this.disposeSubMenus(),this._bindEventService.unbindAll("parent-menu"),document.querySelectorAll(`.${this.menuCssClass}${this.gridUidSelector}`).forEach(e=>e.remove())}disposeSubMenus(){this._bindEventService.unbindAll("sub-menu"),document.querySelectorAll(`.${this.menuCssClass}.slick-submenu${this.gridUidSelector}`).forEach(e=>e.remove())}setOptions(e){this._addonOptions={...this._addonOptions,...e}}addSubMenuTitleWhenExists(e,t){if(e!=="divider"&&(e!=null&&e.subMenuTitle)){const r=document.createElement("div");r.className="slick-menu-title",r.textContent=e.subMenuTitle;const n=e.subMenuTitleCssClass;n&&r.classList.add(...gi(n)),t.appendChild(r)}}populateCommandOrOptionItems(e,t,r,n,s,a,o){if(s&&n&&t)for(const c of n)this.populateSingleCommandOrOptionItem(e,t,r,c,s,a,o)}populateCommandOrOptionTitle(e,t,r,n){var s;if(t){const a=n>0,o=((s=this._menuElm)==null?void 0:s.querySelector(`.slick-${e}-header`))??K("div",{className:`slick-${e}-header`}),c=`${e}Title`;a||(t!=null&&t[c]?(Rt(o),this[`_${e}TitleElm`]=K("span",{className:"slick-menu-title",textContent:t[c]}),o.appendChild(this[`_${e}TitleElm`]),o.classList.add("with-title")):o.classList.add("no-title"),r.appendChild(o))}}populateSingleCommandOrOptionItem(e,t,r,n,s,a,o){var h;let c=null;if(s&&n&&t){const l=(s==null?void 0:s.level)||0,u=this._camelPluginName==="headerButtons"?"":"-item",d=`${this._menuCssPrefix}${u}`;let f=!0,p=!0;if(typeof n=="object"&&(f=this.extensionUtility.runOverrideFunctionWhenExists(n.itemVisibilityOverride,s),p=this.extensionUtility.runOverrideFunctionWhenExists(n.itemUsabilityOverride,s)),!f)return null;if(typeof n=="object"&&n.itemUsabilityOverride&&(n.disabled=!p),c=K("li",{className:d,role:"menuitem"}),typeof n=="object"&&gh(n[e])&&(c.dataset[e]=n==null?void 0:n[e]),r&&r.appendChild(c),typeof n=="object"&&n.divider||n==="divider")return c.classList.add(`${d}-divider`),c;if(n.disabled&&c.classList.add(`${d}-disabled`),(n.hidden||n.showOnHover)&&c.classList.add(`${d}-hidden`),n.cssClass&&c.classList.add(...gi(n.cssClass)),n.tooltip&&(c.title=n.tooltip),this._camelPluginName!=="headerButtons"){const v=K("div",{className:`${this._menuCssPrefix}-icon`});c.appendChild(v),n.iconCssClass?v.classList.add(...gi(n.iconCssClass)):!n.commandItems&&!n.optionItems&&(v.textContent="");const _=K("span",{className:`${this._menuCssPrefix}-content`,textContent:typeof n=="object"&&n.title||""},c);n.textCssClass&&_.classList.add(...gi(n.textCssClass))}const m=l>0?"sub-menu":"parent-menu";if(this._bindEventService.bind(c,"click",v=>a.call(this,v,e,n,l,s==null?void 0:s.column),void 0,m),((h=this._addonOptions)==null?void 0:h.subMenuOpenByEvent)==="mouseover"&&typeof o=="function"&&this._bindEventService.bind(c,"mouseover",v=>o.call(this,v,e,n,l),void 0,m),n.commandItems||n.optionItems){const v=document.createElement("span");v.className="sub-item-chevron",this._addonOptions.subItemChevronClass?v.classList.add(...gi(this._addonOptions.subItemChevronClass)):v.textContent="",c.classList.add("slick-submenu-item"),c.appendChild(v)}}return c}}class Sg extends _h{constructor(e,t,r){super(e,t,r),this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this._currentCell=-1,this._currentRow=-1,this._lastMenuTypeClicked="",this._subMenuParentId=""}createParentMenu(e){var r,n,s,a,o;(r=this.menuElement)==null||r.remove(),this._menuElm=void 0;const t=this.grid.getCellFromEvent(e);if(t){this._currentCell=t.cell??0,this._currentRow=t.row??0;const c=((n=this._addonOptions)==null?void 0:n.commandItems)||[],h=((s=this._addonOptions)==null?void 0:s.optionItems)||[],l={cell:this._currentCell,row:this._currentRow,grid:this.grid};if(this.closeMenu(e,l),typeof e.stopPropagation=="function"&&(this.pubSubService.publish(`on${nl(this._camelPluginName)}BeforeMenuShow`,l),typeof((a=this.addonOptions)==null?void 0:a.onBeforeMenuShow)=="function"&&this.addonOptions.onBeforeMenuShow(e,l)===!1)||(this._menuElm=this.createMenu(c,h),this._menuElm&&(this._menuElm.style.top=`${(e.pageY||0)+5}px`,this._menuElm.style.left=`${e.pageX}px`,this._menuElm.style.display="block",document.body.appendChild(this._menuElm)),this.pubSubService.publish(`on${nl(this._camelPluginName)}AfterMenuShow`,l),typeof((o=this.addonOptions)==null?void 0:o.onAfterMenuShow)=="function"&&this.addonOptions.onAfterMenuShow(e,l)===!1))return}return this._menuElm}createMenu(e,t,r=0,n){var _,x,E,C;const s=this.grid.getColumns()[this._currentCell],a=this.grid.getDataItem(this._currentRow),o=(n==null?void 0:n.command)||(n==null?void 0:n.option);let c=r===1&&o?String(o).replace(/\s/g,""):"";c&&(this._subMenuParentId=c),r>1&&(c=this._subMenuParentId);let h=!0,l=!0;if(this._camelPluginName==="contextMenu"){if(h=this.checkIsColumnAllowed(((_=this._addonOptions)==null?void 0:_.optionShownOverColumnIds)??[],s.id),l=this.checkIsColumnAllowed(((x=this._addonOptions)==null?void 0:x.commandShownOverColumnIds)??[],s.id),!s||(!l||!e.length)&&(!h||!t.length)){this.hideMenu();return}}else if(!s||!s.cellMenu||!e.length&&!t.length)return;const u=`${this.menuCssClass} slick-menu-level-${r} ${this.gridUid}`,d=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${r}${this.gridUidSelector}`);if(d){if(d.dataset.subMenuParent===c)return d;this.disposeSubMenus()}const f=document.createElement("div");f.className=u,r>0&&(f.classList.add("slick-submenu"),c&&(f.dataset.subMenuParent=c));const p=isNaN(this.addonOptions.maxHeight)?this.addonOptions.maxHeight:`${this.addonOptions.maxHeight??0}px`,m=isNaN(this.addonOptions.maxWidth)?this.addonOptions.maxWidth:`${this.addonOptions.maxWidth??0}px`;p&&(f.style.maxHeight=p),m&&(f.style.maxWidth=m),(E=this.addonOptions)!=null&&E.width&&(f.style.width=as((C=this.addonOptions)==null?void 0:C.width));const v=K("button",{ariaLabel:"Close",className:"close",type:"button",textContent:"",dataset:{dismiss:this._menuCssPrefix}});if(!this.addonOptions.hideOptionSection&&h&&t.length>0){const y=K("div",{className:`${this._menuCssPrefix}-option-list`,role:"menu"},f);this.populateCommandOrOptionTitle("option",this.addonOptions,y,r),!this.addonOptions.hideCloseButton&&r<1&&this.populateCommandOrOptionCloseBtn("option",v,y),n&&r>0&&this.addSubMenuTitleWhenExists(n,y),this.populateCommandOrOptionItems("option",this.addonOptions,y,t,{cell:this._currentCell,row:this._currentRow,column:s,dataContext:a,grid:this.grid,level:r},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}if(!this.addonOptions.hideCommandSection&&l&&e.length>0){const y=K("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},f);this.populateCommandOrOptionTitle("command",this.addonOptions,y,r),!this.addonOptions.hideCloseButton&&r<1&&(!h||t.length===0||this.addonOptions.hideOptionSection)&&this.populateCommandOrOptionCloseBtn("command",v,y),n&&r>0&&this.addSubMenuTitleWhenExists(n,y),this.populateCommandOrOptionItems("command",this.addonOptions,y,e,{cell:this._currentCell,row:this._currentRow,column:s,dataContext:a,grid:this.grid,level:r},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}return r++,f}closeMenu(e,t){var r;if(this.menuElement){if(typeof((r=this.addonOptions)==null?void 0:r.onBeforeMenuClose)=="function"&&this.addonOptions.onBeforeMenuClose(e,t)===!1)return;this.hideMenu()}}hideMenu(){var e;(e=this.menuElement)==null||e.remove(),this._menuElm=null,this.disposeSubMenus()}checkIsColumnAllowed(e,t){return(e==null?void 0:e.length)>0?e.findIndex(r=>r===t)>=0:!0}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const r=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||r)&&(t=!0),(this.menuElement!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&r)&&this.closeMenu(e,{cell:this._currentCell,row:this._currentRow,grid:this.grid})}}handleCloseButtonClicked(e){e.defaultPrevented||this.closeMenu(e,{cell:0,row:0,grid:this.grid})}handleMenuItemMouseOver(e,t,r,n=0){(r==null?void 0:r[t])!==void 0&&r!=="divider"&&!r.disabled&&!r.divider&&(r.commandItems||r.optionItems?(this.repositionSubMenu(r,t,n,e),this._lastMenuTypeClicked=t):n===0&&this.disposeSubMenus())}handleMenuItemCommandClick(e,t,r,n=0){var s;if((r==null?void 0:r[t])!==void 0&&r!=="divider"&&!r.disabled&&!r.divider&&this._currentCell!==void 0&&this._currentRow!==void 0){if(t==="option"&&!this.grid.getEditorLock().commitCurrentEdit())return;const a=this._currentCell,o=this._currentRow,c=this.grid.getColumns()[this._currentCell],h=this.grid.getDataItem(this._currentRow),l=r[t]!==void 0?r[t]:"";if(l!==void 0&&!r[`${t}Items`]){const u={cell:this._currentCell,row:this._currentRow,grid:this.grid,[t]:l,item:r,column:c,dataContext:h},d=t==="command"?"onCommand":"onOptionSelected",f=`${this._camelPluginName}:${d}`;this.pubSubService.publish(f,u),typeof((s=this._addonOptions)==null?void 0:s[d])=="function"&&this._addonOptions[d](e,u),typeof r.action=="function"&&r.action.call(this,e,u),e.defaultPrevented||this.closeMenu(e,{cell:a,row:o,grid:this.grid})}else(r.commandItems||r.optionItems)&&this.repositionSubMenu(r,t,n,e);this._lastMenuTypeClicked=t}}populateCommandOrOptionCloseBtn(e,t,r){this._bindEventService.bind(t,"click",s=>this.handleCloseButtonClicked(s),void 0,"parent-menu");const n=r.querySelector(`.slick-${e}-header`)??K("div",{className:`slick-${e}-header`});n==null||n.appendChild(t),r.appendChild(n),n.classList.add("with-close")}repositionSubMenu(e,t,r,n){(n.target.classList.contains("slick-cell")||this._lastMenuTypeClicked!==t)&&this.disposeSubMenus();const s=this.createMenu((e==null?void 0:e.commandItems)||[],(e==null?void 0:e.optionItems)||[],r+1,e);s&&(s.style.display="block",document.body.appendChild(s),this.repositionMenu(n,s))}repositionMenu(e,t){var s;const r=t==null?void 0:t.classList.contains("slick-submenu"),n=r?e.target.closest(`.${this._menuCssPrefix}-item`):e.target.closest(".slick-cell");if(t&&n){t.style.top="0px",t.style.left="0px";const a=((s=e==null?void 0:e.touches)==null?void 0:s[0])??e,o=xi(n);let c=n&&this._camelPluginName==="cellMenu"?(o==null?void 0:o.left)??0:a.pageX,h=n&&this._camelPluginName==="cellMenu"?(o==null?void 0:o.top)??0:a.pageY;r&&this._camelPluginName==="contextMenu"&&(c=(o==null?void 0:o.left)??0,h=(o==null?void 0:o.top)??0);const l=n.offsetWidth||0,u=(t==null?void 0:t.offsetHeight)||0,d=(t==null?void 0:t.offsetWidth)||this._addonOptions.width||0,f=this.gridOptions.rowHeight||0,p=Number(this._addonOptions.autoAdjustDropOffset||0),m=Number(this._addonOptions.autoAlignSideOffset||0);if(this._addonOptions.autoAdjustDrop||this._addonOptions.dropDirection){const{bottom:v,top:_}=mh(n),x=v+p-f,E=_-p+f;(x<u&&E>x?"top":"bottom")==="top"||this._addonOptions.dropDirection==="top"?(t.classList.remove("dropdown"),t.classList.add("dropup"),r?h-=u-p-n.clientHeight:h-=u-p):(t.classList.remove("dropup"),t.classList.add("dropdown"),h=h+p,this._camelPluginName==="cellMenu"&&(r?h+=p:h+=f+p))}if(this._addonOptions.autoAlignSide||this._addonOptions.dropSide==="left"){const v=this.grid.getGridPosition();let _=c+Number(d);r&&(_+=n.clientWidth);const x=document.documentElement.clientWidth;(_>=v.width||_>=x?"left":"right")==="left"||!r&&this._addonOptions.dropSide==="left"?(t.classList.remove("dropright"),t.classList.add("dropleft"),this._camelPluginName==="cellMenu"&&!r?c-=Number(d)-l-m:c-=Number(d)-m):(t.classList.remove("dropleft"),t.classList.add("dropright"),r?c+=m+n.offsetWidth:c+=m)}t.style.top=`${h}px`,t.style.left=`${c}px`}}}class zx extends Sg{constructor(e,t,r){super(e,t,r),this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this.pluginName="CellMenu",this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!0,subMenuOpenByEvent:"mouseover"},this._camelPluginName="cellMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-cell-menu",this.init(r.gridOptions.cellMenu)}init(e){this._addonOptions={...this._defaults,...e},this.sortMenuItems(this.sharedService.allColumns),this._eventHandler.subscribe(this.grid.onClick,this.handleCellClick.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateCellMenu(){var r;const e=(r=this.sharedService)==null?void 0:r.gridOptions,t=this.sharedService.allColumns;e!=null&&e.enableTranslate&&Array.isArray(t)&&t.forEach(n=>{if(n!=null&&n.cellMenu&&(Array.isArray(n.cellMenu.commandItems)||Array.isArray(n.cellMenu.optionItems))){const s=n.cellMenu.commandItems||[],a=n.cellMenu.optionItems||[];n.cellMenu.commandTitleKey&&(n.cellMenu.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(n.cellMenu.commandTitleKey,"TEXT_COMMANDS")||n.cellMenu.commandTitle),n.cellMenu.optionTitleKey&&(n.cellMenu.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(n.cellMenu.optionTitleKey,"TEXT_COMMANDS")||n.cellMenu.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(s,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(a,"optionItems")}})}handleCellClick(e,t){this.disposeAllMenus();const r=this.grid.getCellFromEvent(e);if(r){const n=this.grid.getDataItem(r.row),s=this.grid.getColumns()[r.cell];s!=null&&s.cellMenu&&e.preventDefault(),this._addonOptions={...this._addonOptions,...s.cellMenu};const a=t||{};if(a.column=s,a.dataContext=n,a.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,a))return;this._menuElm=this.createParentMenu(e),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.setAttribute("aria-expanded","true"),this._menuElm.style.display="block"),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}sortMenuItems(e){e.forEach(t=>{var r,n;(r=t==null?void 0:t.cellMenu)!=null&&r.commandItems&&this.extensionUtility.sortItems(t.cellMenu.commandItems||[],"positionOrder"),(n=t==null?void 0:t.cellMenu)!=null&&n.optionItems&&this.extensionUtility.sortItems(t.cellMenu.optionItems||[],"positionOrder")})}}class Gx{constructor(e,t){this.grid=e,this.pluginName="CellRangeDecorator",this._defaults={selectionCssClass:"slick-range-decorator",selectionCss:{border:"2px dashed red",zIndex:"9999"},offset:{top:-1,left:-1,height:-2,width:-2}},this._options=so(this._defaults,t)}get addonOptions(){return this._options}get addonElement(){return this._elem}destroy(){this.hide()}init(){}hide(){var e;(e=this._elem)==null||e.remove(),this._elem=null}show(e){var n,s;this._elem||(this._elem=K("div",{className:this._options.selectionCssClass}),Object.keys(this._options.selectionCss).forEach(a=>{this._elem.style[a]=this._options.selectionCss[a]}),this._elem.style.position="absolute",(n=this.grid.getActiveCanvasNode())==null||n.appendChild(this._elem));const t=this.grid.getCellNodeBox(e.fromRow,e.fromCell),r=this.grid.getCellNodeBox(e.toRow,e.toCell);return t&&r&&((s=this._options)!=null&&s.offset)&&(this._elem.style.top=`${t.top+this._options.offset.top}px`,this._elem.style.left=`${t.left+this._options.offset.left}px`,this._elem.style.height=`${r.bottom-t.top+this._options.offset.height}px`,this._elem.style.width=`${r.right-t.left+this._options.offset.width}px`),this._elem}}class bg{constructor(e){this.pluginName="CellRangeSelector",this.onBeforeCellRangeSelected=new ze("onBeforeCellRangeSelected"),this.onCellRangeSelecting=new ze("onCellRangeSelecting"),this.onCellRangeSelected=new ze("onCellRangeSelected"),this._currentlySelectedRange=null,this._canvas=null,this._dragging=!1,this._gridUid="",this._columnOffset=0,this._rowOffset=0,this._isRightCanvas=!1,this._isBottomCanvas=!1,this._xDelayForNextCell=0,this._yDelayForNextCell=0,this._viewportHeight=0,this._viewportWidth=0,this._isRowMoveRegistered=!1,this._scrollLeft=0,this._scrollTop=0,this._defaults={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},this._eventHandler=new di,this._options=so(this._defaults,e)}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridUid(){var e;return this._gridUid||(((e=this._grid)==null?void 0:e.getUID())??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}init(e){this._grid=e,this._decorator=this._options.cellDecorator||new Gx(e,this._options),this._canvas=e.getCanvasNode(),this._gridOptions=e.getOptions(),this._gridUid=e.getUID();const t=e.getPubSubService();t&&oe.addSlickEventPubSubWhenDefined(t,this),this._eventHandler.subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this)).subscribe(this._grid.onScroll,this.handleScroll.bind(this))}destroy(){this.dispose()}dispose(){var e,t;(e=this._eventHandler)==null||e.unsubscribeAll(),Rt(this._activeCanvas),Rt(this._canvas),(t=this._decorator)==null||t.destroy(),this.stopIntervalTimer()}getCellDecorator(){return this._decorator}getCurrentRange(){return this._currentlySelectedRange}getMouseOffsetViewport(e,t){var p;const r=((p=e==null?void 0:e.touches)==null?void 0:p[0])??e,n=this._activeViewport.scrollLeft,s=this._activeViewport.scrollTop,a=n+this._viewportWidth,o=s+this._viewportHeight,c=xi(this._activeViewport),h=(c==null?void 0:c.left)??0,l=(c==null?void 0:c.top)??0,u=h+this._viewportWidth,d=l+this._viewportHeight,f={e,dd:t,viewport:{left:n,top:s,right:a,bottom:o,offset:{left:h,top:l,right:u,bottom:d}},offset:{x:0,y:0},isOutsideViewport:!1};return r.pageX<h?f.offset.x=r.pageX-h:r.pageX>u&&(f.offset.x=r.pageX-u),r.pageY<l?f.offset.y=l-r.pageY:r.pageY>d&&(f.offset.y=d-r.pageY),f.isOutsideViewport=!!f.offset.x||!!f.offset.y,f}stopIntervalTimer(){this._autoScrollTimerId&&(clearInterval(this._autoScrollTimerId),this._autoScrollTimerId=void 0)}handleDrag(e,t){if(!this._dragging&&!this._gridOptions.enableRowMoveManager)return;this._gridOptions.enableRowMoveManager||e.stopImmediatePropagation();const r=e.getNativeEvent();if(this.addonOptions.autoScroll&&(this._draggingMouseOffset=this.getMouseOffsetViewport(r,t),this._draggingMouseOffset.isOutsideViewport))return this.handleDragOutsideViewport();this.stopIntervalTimer(),this.handleDragTo(r,t)}handleDragOutsideViewport(){if(this._xDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.x)*this.addonOptions.accelerateInterval,this._yDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.y)*this.addonOptions.accelerateInterval,!this._autoScrollTimerId){let e=0,t=0;this._autoScrollTimerId=setInterval(()=>{let r=!1,n=!1;this._draggingMouseOffset.offset.x?(e+=this.addonOptions.minIntervalToShowNextCell,r=e>=this._xDelayForNextCell):e=0,this._draggingMouseOffset.offset.y?(t+=this.addonOptions.minIntervalToShowNextCell,n=t>=this._yDelayForNextCell):t=0,(r||n)&&(r&&(e=0),n&&(t=0),this.handleDragToNewPosition(r,n))},this.addonOptions.minIntervalToShowNextCell)}}handleDragToNewPosition(e,t){let r=this._draggingMouseOffset.e.pageX,n=this._draggingMouseOffset.e.pageY;const s=this._draggingMouseOffset.offset.x,a=this._draggingMouseOffset.offset.y,o=this._draggingMouseOffset.viewport.offset;e&&s&&(s>0?r=o.right+this._moveDistanceForOneCell.x:r=o.left-this._moveDistanceForOneCell.x),t&&a&&(a>0?n=o.top-this._moveDistanceForOneCell.y:n=o.bottom+this._moveDistanceForOneCell.y),this.handleDragTo({pageX:r,pageY:n},this._draggingMouseOffset.dd)}handleDragTo(e,t){var s,a,o;const r=((s=e==null?void 0:e.touches)==null?void 0:s[0])??e,n=this._grid.getCellFromPoint(r.pageX-(((a=xi(this._activeCanvas))==null?void 0:a.left)??0)+this._columnOffset,r.pageY-(((o=xi(this._activeCanvas))==null?void 0:o.top)??0)+this._rowOffset);if(n!==void 0){if(this._gridOptions.frozenColumn>=0&&(!this._isRightCanvas&&n.cell>this._gridOptions.frozenColumn||this._isRightCanvas&&n.cell<=this._gridOptions.frozenColumn)||this._gridOptions.frozenRow>=0&&(!this._isBottomCanvas&&n.row>=this._gridOptions.frozenRow||this._isBottomCanvas&&n.row<this._gridOptions.frozenRow))return;if(this.addonOptions.autoScroll&&this._draggingMouseOffset){const c=this._grid.getCellNodeBox(n.row,n.cell);if(c){const h=this._draggingMouseOffset.viewport;(c.left<h.left||c.right>h.right||c.top<h.top||c.bottom>h.bottom)&&this._grid.scrollCellIntoView(n.row,n.cell)}}if(!this._grid.canCellBeSelected(n.row,n.cell))return;if(t!=null&&t.range){t.range.end=n;const c=new Jr(t.range.start.row??0,t.range.start.cell??0,n.row,n.cell);this._decorator.show(c),this.onCellRangeSelecting.notify({range:c})}}}handleDragEnd(e,t){this._decorator.hide(),this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),this.stopIntervalTimer(),this.onCellRangeSelected.notify({range:new Jr(t.range.start.row??0,t.range.start.cell??0,t.range.end.row,t.range.end.cell)}))}handleDragInit(e){var s,a;this._activeCanvas=this._grid.getActiveCanvasNode(e),this._activeViewport=this._grid.getActiveViewportNode(e);const t=this._grid.getDisplayedScrollbarDimensions();if(this._viewportWidth=this._activeViewport.offsetWidth-t.width,this._viewportHeight=this._activeViewport.offsetHeight-t.height,this._moveDistanceForOneCell={x:this._grid.getAbsoluteColumnMinWidth()/2,y:this._gridOptions.rowHeight/2},this._rowOffset=0,this._columnOffset=0,this._isBottomCanvas=this._activeCanvas.classList.contains("grid-canvas-bottom"),this._gridOptions.frozenRow>-1&&this._isBottomCanvas){const o=`${this.gridUidSelector} .grid-canvas-${this._gridOptions.frozenBottom?"bottom":"top"}`;this._rowOffset=((s=document.querySelector(o))==null?void 0:s.clientHeight)??0}this._isRightCanvas=this._activeCanvas.classList.contains("grid-canvas-right"),this._gridOptions.frozenColumn>-1&&this._isRightCanvas&&(this._columnOffset=((a=document.querySelector(`${this.gridUidSelector} .grid-canvas-left`))==null?void 0:a.clientWidth)??0);const r=this._grid.getCellFromEvent(e),n=this._grid.getActiveCell();(!this._grid.getEditorLock().isActive()||!(n&&r&&n.row===r.row&&n.cell===r.cell))&&(e.stopImmediatePropagation(),e.preventDefault())}handleDragStart(e,t){const r=this._grid.getCellFromEvent(e);if(r&&this.onBeforeCellRangeSelected.notify(r).getReturnValue()!==!1&&this._grid.canCellBeSelected(r.row,r.cell)&&(this._dragging=!0,e.stopImmediatePropagation()),!this._dragging)return;this._grid.focus();const n=xi(this._canvas);let s=t.startX-((n==null?void 0:n.left)??0);this._gridOptions.frozenColumn>=0&&this._isRightCanvas&&(s+=this._scrollLeft);let a=t.startY-((n==null?void 0:n.top)??0);this._gridOptions.frozenRow>=0&&this._isBottomCanvas&&(a+=this._scrollTop);const o=this._grid.getCellFromPoint(s,a);return t.range={start:o,end:{}},this._currentlySelectedRange=t.range,this._decorator.show(new Jr(o.row,o.cell))}handleScroll(e,t){this._scrollTop=t.scrollTop,this._scrollLeft=t.scrollLeft}}class $x{constructor(e){this.onSelectedRangesChanged=new ze("onSelectedRangesChanged"),this.pluginName="CellSelectionModel",this._cachedPageRowCount=0,this._prevKeyDown="",this._ranges=[],this._defaults={selectActiveCell:!0},this._eventHandler=new di,e===void 0||e.cellRangeSelector===void 0?this._selector=new bg({selectionCss:{border:"2px solid black"}}):this._selector=e.cellRangeSelector,this._addonOptions=e}get addonOptions(){return this._addonOptions}get cellRangeSelector(){return this._selector}get eventHandler(){return this._eventHandler}init(e){this._grid=e,e.hasDataView()&&(this._dataView=e.getData()),this._addonOptions={...this._defaults,...this._addonOptions};const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)).subscribe(this._selector.onBeforeCellRangeSelected,this.handleBeforeCellRangeSelected.bind(this)).subscribe(this._selector.onCellRangeSelected,this.handleCellRangeSelected.bind(this)),e.registerPlugin(this._selector)}destroy(){this.dispose()}dispose(){var e,t;this._selector&&(this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this))),this._eventHandler.unsubscribeAll(),(e=this._grid)==null||e.unregisterPlugin(this._selector),(t=this._selector)==null||t.dispose()}getSelectedRanges(){return this._ranges}rangesAreEqual(e,t){let r=e.length!==t.length;if(!r){for(let n=0;n<e.length;n++)if(e[n].fromCell!==t[n].fromCell||e[n].fromRow!==t[n].fromRow||e[n].toCell!==t[n].toCell||e[n].toRow!==t[n].toRow){r=!0;break}}return!r}refreshSelections(){this.setSelectedRanges(this.getSelectedRanges())}removeInvalidRanges(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];this._grid.canCellBeSelected(n.fromRow,n.fromCell)&&this._grid.canCellBeSelected(n.toRow,n.toCell)&&t.push(n)}return t}resetPageRowCount(){this._cachedPageRowCount=0}setSelectedRanges(e,t="SlickCellSelectionModel.setSelectedRanges"){if((!this._ranges||this._ranges.length===0)&&(!e||e.length===0))return;const r=!this.rangesAreEqual(this._ranges,e);if(this._ranges=this.removeInvalidRanges(e),r){const n=new Yt(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,n)}}handleActiveCellChange(e,t){var s,a;this._prevSelectedRow=void 0;const r=oi(t.cell),n=oi(t.row);(s=this._addonOptions)!=null&&s.selectActiveCell&&n&&r?this.setSelectedRanges([new Jr(t.row,t.cell)]):(!((a=this._addonOptions)!=null&&a.selectActiveCell)||!n&&!r)&&this.setSelectedRanges([])}handleBeforeCellRangeSelected(e){const t=this._grid.getCellFromEvent(e),r=this._grid.getActiveCell();if(this._grid.getEditorLock().isActive()&&r&&t&&r.row===t.row&&r.cell===t.cell)return e.stopPropagation(),!1}handleCellRangeSelected(e,t){this._grid.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0),this.setSelectedRanges([t.range])}isKeyAllowed(e){return["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","PageDown","PageUp","Home","End"].some(t=>t===e)}handleKeyDown(e){var o;let t,r;const n=this._grid.getColumns().length,s=this._grid.getActiveCell();let a=0;if(this._dataView&&"getPagingInfo"in this._dataView?a=((o=this._dataView)==null?void 0:o.getPagingInfo().pageSize)||this._dataView.getLength():a=this._grid.getDataLength(),s&&(e.shiftKey||e.ctrlKey)&&!e.altKey&&this.isKeyAllowed(e.key)&&(t=this.getSelectedRanges().slice(),t.length||t.push(new Jr(s.row,s.cell)),r=t.pop(),typeof(r==null?void 0:r.contains)=="function")){r.contains(s.row,s.cell)||(r=new Jr(s.row,s.cell));let c=r.toRow-r.fromRow,h=r.toCell-r.fromCell;const l=s.row===r.fromRow?1:-1,u=s.cell===r.fromCell?1:-1,d=e.key.startsWith("Arrow");let f,p=0;d&&!e.ctrlKey?(e.key==="ArrowLeft"?h-=u:e.key==="ArrowRight"?h+=u:e.key==="ArrowUp"?c-=l:e.key==="ArrowDown"&&(c+=l),p=s.row+l*c):(this._cachedPageRowCount<1&&(this._cachedPageRowCount=this._grid.getViewportRowCount()),this._prevSelectedRow===void 0&&(this._prevSelectedRow=s.row),e.shiftKey&&!e.ctrlKey&&e.key==="Home"?(f=0,p=s.row):e.shiftKey&&!e.ctrlKey&&e.key==="End"?(f=n-1,p=s.row):e.ctrlKey&&e.shiftKey&&e.key==="Home"?(f=0,p=0):e.ctrlKey&&e.shiftKey&&e.key==="End"?(f=n-1,p=a-1):e.key==="PageUp"?(this._prevSelectedRow>=0&&(p=this._prevSelectedRow-this._cachedPageRowCount),p<0&&(p=0)):e.key==="PageDown"&&(this._prevSelectedRow<=a-1&&(p=this._prevSelectedRow+this._cachedPageRowCount),p>a-1&&(p=a-1)),this._prevSelectedRow=p),f??(f=s.cell+u*h);const m=new Jr(s.row,s.cell,p,f);if(this.removeInvalidRanges([m]).length){t.push(m);const v=l>0?m.toRow:m.fromRow,_=u>0?m.toCell:m.fromCell;d?(this._grid.scrollRowIntoView(v),this._grid.scrollCellIntoView(v,_,!1)):(this._grid.scrollRowIntoView(p),this._grid.scrollCellIntoView(p,_,!1))}else t.push(r);this.setSelectedRanges(t),e.preventDefault(),e.stopPropagation(),this._prevKeyDown=e.key}}}class Ud{constructor(e){this.pluginName="RowSelectionModel",this.onSelectedRangesChanged=new ze("onSelectedRangesChanged"),this._inHandler=!1,this._ranges=[],this._defaults={autoScrollWhenDrag:!0,cellRangeSelector:void 0,dragToSelect:!1,selectActiveRow:!0},this._eventHandler=new di,this._options={...this._defaults,...e}}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridOptions(){var e;return(e=this._grid)==null?void 0:e.getOptions()}init(e){this._grid=e,this._options={...this._defaults,...this._options},this._selector=this.addonOptions.cellRangeSelector;const t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),!this._selector&&this._options.dragToSelect&&(this._selector=new bg({selectionCss:{border:"none"},autoScroll:this._options.autoScrollWhenDrag}),this.addonOptions.cellRangeSelector=this._selector),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onClick,this.handleClick.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)),this._selector&&(this._grid.registerPlugin(this._selector),this._selector.onCellRangeSelecting.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.subscribe(this.handleBeforeCellRangeSelected.bind(this)))}destroy(){this.dispose()}dispose(){this._eventHandler.unsubscribeAll(),this.disposeSelector()}disposeSelector(){var e,t;this._selector&&(this._selector.onCellRangeSelecting.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._grid.unregisterPlugin(this._selector),(e=this._selector)==null||e.destroy(),(t=this._selector)==null||t.dispose())}getCellRangeSelector(){return this._selector}getSelectedRanges(){return this._ranges}getSelectedRows(){return this.rangesToRows(this._ranges)}refreshSelections(){this.setSelectedRows(this.getSelectedRows())}setSelectedRows(e){this.setSelectedRanges(this.rowsToRanges(e),"SlickRowSelectionModel.setSelectedRows")}setSelectedRanges(e,t="SlickRowSelectionModel.setSelectedRanges"){if((!this._ranges||this._ranges.length===0)&&(!e||e.length===0))return;this._ranges=e;const r=new Yt(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,r)}getRowsRange(e,t){let r;const n=[];for(r=e;r<=t;r++)n.push(r);for(r=t;r<e;r++)n.push(r);return n}handleBeforeCellRangeSelected(e,t){let r=!1;if(this.gridOptions.enableRowMoveManager&&(r=this.isHandlerColumn(t.cell)??!1),this._grid.getEditorLock().isActive()||r)return e.stopPropagation(),!1;this._grid.setActiveCell(t.row,t.cell)}handleCellRangeSelected(e,t){if(!this.gridOptions.multiSelect||!this.addonOptions.selectActiveRow)return!1;this.setSelectedRanges([new Jr(t.range.fromRow,0,t.range.toRow,this._grid.getColumns().length-1)])}handleActiveCellChange(e,t){this._options.selectActiveRow&&t.row!==null&&this.setSelectedRanges([new Jr(t.row,0,t.row,this._grid.getColumns().length-1)])}handleClick(e){const t=this._grid.getCellFromEvent(e);if(!t||!this._grid.canCellBeActive(t.row,t.cell)||!this.gridOptions.multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;let r=this.rangesToRows(this._ranges);const n=r.indexOf(t.row);if(n===-1&&(e.ctrlKey||e.metaKey))r.push(t.row),this._grid.setActiveCell(t.row,t.cell);else if(n!==-1&&(e.ctrlKey||e.metaKey))r=r.filter(a=>a!==t.row),this._grid.setActiveCell(t.row,t.cell);else if(r.length&&e.shiftKey){const a=r.pop(),o=Math.min(t.row,a),c=Math.max(t.row,a);r=[];for(let h=o;h<=c;h++)h!==a&&r.push(h);r.push(a),this._grid.setActiveCell(t.row,t.cell)}const s=this.rowsToRanges(r);return this.setSelectedRanges(s),e.stopImmediatePropagation(),!0}handleKeyDown(e){const t=this._grid.getActiveCell();if(this.gridOptions.multiSelect&&t&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.key==="ArrowUp"||e.key==="ArrowDown")){let r=this.getSelectedRows();r.sort((o,c)=>o-c),r.length||(r=[t.row]);let n,s=r[0],a=r[r.length-1];if(e.key==="ArrowDown"?n=t.row<a||s===a?++a:++s:n=t.row<a?--a:--s,n>=0&&n<this._grid.getDataLength()){this._grid.scrollRowIntoView(n);const o=this.rowsToRanges(this.getRowsRange(s,a));this.setSelectedRanges(o)}e.preventDefault(),e.stopPropagation()}}isHandlerColumn(e){const r=this._grid.getColumns()[e].behavior||"";return/move|selectAndMove/.test(r)}rangesToRows(e){const t=[];for(let r=0;r<e.length;r++)for(let n=e[r].fromRow;n<=e[r].toRow;n++)t.push(n);return t}rowsToRanges(e){const t=[],r=this._grid.getColumns().length-1;return e.forEach(n=>t.push(new Jr(n,0,n,r))),t}}class ip{constructor(e,t){this.pubSubService=e,this.pluginName="CheckboxSelectColumn",this._defaults={columnId:"_checkbox_selector",cssClass:null,field:"_checkbox_selector",hideSelectAllCheckbox:!1,name:"",toolTip:"Select/Deselect All",width:30,reorderable:!1,applySelectOnAllPages:!0,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},this._addonOptions=this._defaults,this._checkboxColumnCellIndex=null,this._isSelectAllChecked=!1,this._isUsingDataView=!1,this._selectedRowsLookup={},this._selectAll_UID=this.createUID(),this._bindEventService=new Xi,this._eventHandler=new di,this._addonOptions={...this._defaults,...t}}get addonOptions(){return this._addonOptions}get headerRowNode(){return this._headerRowNode}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get selectAllUid(){return this._selectAll_UID}set selectedRowsLookup(e){this._selectedRowsLookup=e}init(e){this._grid=e,this._isUsingDataView=!Array.isArray(e.getData()),this._isUsingDataView&&(this._dataView=e.getData()),this.gridOptions.backendServiceApi&&(this._addonOptions.applySelectOnAllPages=!1),this._eventHandler.subscribe(e.onSelectedRowsChanged,this.handleSelectedRowsChanged.bind(this)).subscribe(e.onClick,this.handleClick.bind(this)).subscribe(e.onKeyDown,this.handleKeyDown.bind(this)),this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,this.handleDataViewSelectedIdsChanged.bind(this)).subscribe(this._dataView.onPagingInfoChanged,this.handleDataViewSelectedIdsChanged.bind(this)),this._addonOptions.hideInFilterHeaderRow||this.addCheckboxToFilterHeaderRow(e),this._addonOptions.hideInColumnTitleRow||this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this)),(!this._rowSelectionModel||!this._grid.getSelectionModel())&&(this._rowSelectionModel=new Ud(this.gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionModel)),this.gridOptions.preselectedRows&&this._rowSelectionModel&&this._grid.getSelectionModel()&&setTimeout(()=>this.selectRows(this.gridOptions.preselectedRows||[])),typeof this._addonOptions.selectableOverride=="function"&&this.selectableOverride(this._addonOptions.selectableOverride)}dispose(){this._bindEventService.unbindAll(),this._eventHandler.unsubscribeAll()}create(e,t){var r;if(this._addonOptions={...this._defaults,...t.checkboxSelector},Array.isArray(e)&&t){const n=this.getColumnDefinition();if(!e.some(s=>s.id===n.id)){const s=((r=t==null?void 0:t.checkboxSelector)==null?void 0:r.columnIndexPosition)??0;s>0?e.splice(s,0,n):e.unshift(n),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getOptions(){return this._addonOptions}setOptions(e){var t;if(this._addonOptions={...this._addonOptions,...e},this._addonOptions.hideSelectAllCheckbox)this.hideSelectAllFromColumnHeaderTitleRow(),this.hideSelectAllFromColumnHeaderFilterRow();else if(this._addonOptions.hideInColumnTitleRow?(this.hideSelectAllFromColumnHeaderTitleRow(),this._addonOptions.name&&this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name,"")):(this.renderSelectAllCheckbox(this._isSelectAllChecked),this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this))),this._addonOptions.hideInFilterHeaderRow)this.hideSelectAllFromColumnHeaderFilterRow();else{const r=(t=this.headerRowNode)==null?void 0:t.querySelector("#filter-checkbox-selectall-container");if(r){r.style.display="flex",r.ariaChecked=String(this._isSelectAllChecked);const n=r.querySelector('input[type="checkbox"]');n&&(n.ariaChecked=String(this._isSelectAllChecked),n.checked=this._isSelectAllChecked)}}}deSelectRows(e){const t=[];for(const r of e)this._selectedRowsLookup[r]&&(t[t.length]=r);this._grid.setSelectedRows(this._grid.getSelectedRows().filter(r=>t.indexOf(r)<0),"SlickCheckboxSelectColumn.deSelectRows")}selectRows(e){var n;const t=[];for(const s of e)this._selectedRowsLookup[s]&&(t[t.length]=s);const r=(n=this._grid.getSelectedRows())==null?void 0:n.concat(t);this._grid.setSelectedRows(r)}createCheckboxElement(e,t=!1){const r=new DocumentFragment;return r.appendChild(K("input",{id:e,type:"checkbox",checked:t,ariaChecked:String(t)})),r.appendChild(K("label",{htmlFor:e})),r}getColumnDefinition(){var t;const e=String(((t=this._addonOptions)==null?void 0:t.columnId)??this._defaults.columnId);return{id:e,name:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?this._addonOptions.name||"":this.createCheckboxElement(`header-selector${this._selectAll_UID}`),toolTip:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?"":this._addonOptions.toolTip,field:e,cssClass:this._addonOptions.cssClass,excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,hideSelectAllCheckbox:this._addonOptions.hideSelectAllCheckbox,resizable:!1,reorderable:this._addonOptions.reorderable,sortable:!1,width:this._addonOptions.width||30,formatter:this.checkboxSelectionFormatter.bind(this)}}hideSelectAllFromColumnHeaderTitleRow(){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name||"","")}hideSelectAllFromColumnHeaderFilterRow(){var t;const e=(t=this.headerRowNode)==null?void 0:t.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}toggleRowSelection(e){this.toggleRowSelectionWithEvent(null,e)}toggleRowSelectionWithEvent(e,t){const r=this._grid.getDataItem(t);if(!this.checkSelectableOverride(t,r,this._grid))return;const n=this._grid.getSelectedRows();this._addonOptions.onRowToggleStart&&this._addonOptions.onRowToggleStart(e,{row:t,previousSelectedRows:n});const s=this._selectedRowsLookup[t]?this._grid.getSelectedRows().filter(a=>a!==t):this._grid.getSelectedRows().concat(t);this._grid.setSelectedRows(s,"click.toggle"),this._grid.setActiveCell(t,this.getCheckboxColumnCellIndex()),this._addonOptions.onRowToggleEnd&&this._addonOptions.onRowToggleEnd(e,{row:t,previousSelectedRows:n})}selectableOverride(e){this._selectableOverride=e}addCheckboxToFilterHeaderRow(e){this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,r)=>{if(r.column.field===(this._addonOptions.field||"_checkbox_selector")){Rt(r.node);const n=K("span",{id:"filter-checkbox-selectall-container",ariaChecked:"false"});n.appendChild(K("input",{type:"checkbox",id:`header-filter-selector${this._selectAll_UID}`})),n.appendChild(K("label",{htmlFor:`header-filter-selector${this._selectAll_UID}`})),r.node.appendChild(n),this._headerRowNode=r.node,this._bindEventService.bind(n,"click",s=>this.handleHeaderClick(s,r))}})}checkboxSelectionFormatter(e,t,r,n,s,a){if(s&&this.checkSelectableOverride(e,s,a)){const o=this.createUID()+e;return this.createCheckboxElement(`selector${o}`,!!this._selectedRowsLookup[e])}return null}checkSelectableOverride(e,t,r){return typeof this._selectableOverride=="function"?this._selectableOverride(e,t,r):!0}createUID(){return Math.round(1e7*Math.random())}getCheckboxColumnCellIndex(){if(this._checkboxColumnCellIndex===null){this._checkboxColumnCellIndex=0;const e=this._grid.getColumns();for(let t=0;t<e.length;t++)e[t].id===this._addonOptions.columnId&&(this._checkboxColumnCellIndex=t)}return this._checkboxColumnCellIndex}handleDataViewSelectedIdsChanged(){var n;const e=this._dataView.getAllSelectedFilteredIds(),t=this._dataView.getFilteredItems();let r=0;if(typeof this._selectableOverride=="function"&&e.length>0)for(let s=0;s<this._dataView.getItemCount();s++){const a=this._dataView.getItemByIdx(s),o=this._dataView.getIdPropertyName(),c=a[o];t.findIndex(l=>l[o]===c)>=0&&!this.checkSelectableOverride(s,a,this._grid)&&r++}if(this._isSelectAllChecked=e.length+r>=t.length,!this._addonOptions.hideInColumnTitleRow&&!this._addonOptions.hideSelectAllCheckbox&&this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow){const s=(n=this.headerRowNode)==null?void 0:n.querySelector(`#header-filter-selector${this._selectAll_UID}`);s&&(s.ariaChecked=String(this._isSelectAllChecked),s.checked=this._isSelectAllChecked)}}handleClick(e,t){if(this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&e.target.type==="checkbox"){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()){e.preventDefault(),e.stopImmediatePropagation();return}this.toggleRowSelectionWithEvent(e,t.row),e.stopPropagation(),e.stopImmediatePropagation()}}handleHeaderClick(e,t){if(t.column.id===this._addonOptions.columnId&&e.target.type==="checkbox"){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()){e.preventDefault(),e.stopImmediatePropagation();return}let r=e.target.checked;const n=r?"click.selectAll":"click.unselectAll",s=this._grid.getSelectedRows();this._addonOptions.onSelectAllToggleStart&&this._addonOptions.onSelectAllToggleStart(e,{previousSelectedRows:s,caller:n});let a=[];if(r){const o=[];for(let c=0;c<this._grid.getDataLength();c++){const h=this._grid.getDataItem(c);!h.__group&&!h.__groupTotals&&this.checkSelectableOverride(c,h,this._grid)&&o.push(c)}a=o,r=!0}if(this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages){const o=[],c=this._dataView.getFilteredItems();for(let h=0;h<c.length;h++){const l=c[h];this.checkSelectableOverride(h,l,this._grid)&&o.push(l[this._dataView.getIdPropertyName()])}this._dataView.setSelectedIds(o,{isRowBeingAdded:r})}this._grid.setSelectedRows(a,n),this._addonOptions.onSelectAllToggleEnd&&this._addonOptions.onSelectAllToggleEnd(e,{rows:a,previousSelectedRows:s,caller:n}),e.stopPropagation(),e.stopImmediatePropagation()}}handleKeyDown(e,t){e.key===" "&&this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&((!this._grid.getEditorLock().isActive()||this._grid.getEditorLock().commitCurrentEdit())&&this.toggleRowSelectionWithEvent(e,t.row),e.preventDefault(),e.stopImmediatePropagation())}handleSelectedRowsChanged(){var c;const e=this._grid.getSelectedRows(),t={};let r=0,n=0,s=0,a=0;if(typeof this._selectableOverride=="function")for(s=0;s<this._grid.getDataLength();s++){const h=this._grid.getDataItem(s);this.checkSelectableOverride(n,h,this._grid)||a++}const o=[];for(n=0;n<e.length;n++){r=e[n];const h=this._grid.getDataItem(r);this.checkSelectableOverride(n,h,this._grid)?(t[r]=!0,t[r]!==this._selectedRowsLookup[r]&&(this._grid.invalidateRow(r),delete this._selectedRowsLookup[r])):o.push(r)}if(typeof this._selectedRowsLookup=="object"&&Object.keys(this._selectedRowsLookup).forEach(h=>{h!==void 0&&this._grid.invalidateRow(+h)}),this._selectedRowsLookup=t,this._grid.render(),this._isSelectAllChecked=((e==null?void 0:e.length)??0)+a>=this._grid.getDataLength(),(!this._isUsingDataView||!this._addonOptions.applySelectOnAllPages)&&(!this._addonOptions.hideInColumnTitleRow&&!this._addonOptions.hideSelectAllCheckbox&&this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow)){const h=(c=this.headerRowNode)==null?void 0:c.querySelector(`#header-filter-selector${this._selectAll_UID}`);h&&(h.ariaChecked=String(this._isSelectAllChecked),h.checked=this._isSelectAllChecked)}if(o.length>0){for(const h of o){const l=e.indexOf(h);e.splice(l,1)}this._grid.setSelectedRows(e,"click.toggle")}}renderSelectAllCheckbox(e){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this.createCheckboxElement(`header-selector${this._selectAll_UID}`,!!e),this._addonOptions.toolTip)}}class Tg extends _h{constructor(e,t,r,n,s){var a;super(e,r,n),this.extensionUtility=e,this.filterService=t,this.pubSubService=r,this.sharedService=n,this.sortService=s,this.onAfterMenuShow=new ze("onAfterMenuShow"),this.onBeforeMenuShow=new ze("onBeforeMenuShow"),this.onMenuClose=new ze("onMenuClose"),this.onCommand=new ze("onCommand"),this.onColumnsChanged=new ze("onColumnsChanged"),this._areVisibleColumnDifferent=!1,this._columns=[],this._columnCheckboxes=[],this._commandMenuElm=null,this._headerElm=null,this._isMenuOpen=!1,this._subMenuParentId="",this._defaults={dropSide:"left",showButton:!0,hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",marginBottom:15,menuWidth:18,minHeight:250,contentMinWidth:0,resizeOnShowHeaderRow:!1,syncResizeTitle:"Synchronous resize",subMenuOpenByEvent:"mouseover",headerColumnValueExtractor:o=>Ls(o.name||"","innerHTML")},this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-grid-menu",this._camelPluginName="gridMenu",this._columns=this.sharedService.allColumns??[],this._gridUid=((a=this.grid)==null?void 0:a.getUID())??"",this.initEventHandlers(),this.init()}get addonOptions(){return this._addonOptions||{}}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())||{}}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}initEventHandlers(){this._eventHandler.subscribe(this.grid.onColumnsReordered,Gc.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeDestroy,this.dispose.bind(this)),this._eventHandler.subscribe(this.grid.onSetOptions,(e,t)=>{if(t&&t.optionsBefore&&t.optionsAfter){const r=t.optionsBefore.frozenColumn>=0&&t.optionsAfter.frozenColumn===-1,n=t.optionsBefore.frozenColumn===-1&&t.optionsAfter.frozenColumn>=0;(r||n)&&this.recreateGridMenu()}})}init(){this._gridUid=this.grid.getUID()??"",oe.addSlickEventPubSubWhenDefined(this.pubSubService,this),this._userOriginalGridMenu={...this.sharedService.gridOptions.gridMenu},this._addonOptions={...this._defaults,...this.getDefaultGridMenuOptions(),...this.sharedService.gridOptions.gridMenu},this.sharedService.gridOptions.gridMenu=this._addonOptions;const e=this._userOriginalGridMenu.commandItems,t=this._userOriginalGridMenu&&Array.isArray(e)?e:[];this._addonOptions.commandItems=[...t,...this.addGridMenuCustomCommands(t)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this._addonOptions.commandItems,"positionOrder"),this._addonOptions.commandItems=this._addonOptions.commandItems,this.createGridMenu()}dispose(){this.deleteMenu(),super.dispose()}deleteMenu(){var e,t;this._bindEventService.unbindAll(),(e=this._menuElm)==null||e.remove(),this._menuElm=null,(t=this._gridMenuButtonElm)==null||t.remove(),this._headerElm&&(this._headerElm.style.width="100%")}createColumnPickerContainer(){this._menuElm&&(kg.call(this,this._menuElm),this._listElm=K("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(this._menuElm,"click",Og.bind(this),void 0,"parent-menu"))}createGridMenu(){var s,a;const e=this._gridUid?`.${this._gridUid}`:"",t=((s=this._addonOptions)==null?void 0:s.menuWidth)||this._defaults.menuWidth,r=this.gridOptions.hasOwnProperty("frozenColumn")&&this.gridOptions.frozenColumn>=0?"right":"left",n=this.grid.getContainerNode();if(this._headerElm=n.querySelector(`.slick-header-${r}`),this._headerElm&&this._addonOptions){if(this._headerElm.style.width=`calc(100% - ${t}px)`,(this._addonOptions.resizeOnShowHeaderRow??this._defaults.resizeOnShowHeaderRow)&&this.gridOptions.showHeaderRow){const h=n.querySelector(`${e} .slick-headerrow`);h&&(h.style.width=`calc(100% - ${t}px)`)}(this._addonOptions.showButton??this._defaults.showButton)&&(this._gridMenuButtonElm=K("button",{className:"slick-grid-menu-button",ariaLabel:"Grid Menu"}),(a=this._addonOptions)!=null&&a.iconCssClass&&this._gridMenuButtonElm.classList.add(...gi(this._addonOptions.iconCssClass)),this._headerElm.parentElement.insertBefore(this._gridMenuButtonElm,this._headerElm.parentElement.firstChild),this._bindEventService.bind(this._gridMenuButtonElm,"click",this.showGridMenu.bind(this))),this.sharedService.gridOptions.gridMenu={...this._defaults,...this._addonOptions},this.translateTitleLabels(this._addonOptions),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this)),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this))}}createCommandMenu(e,t=0,r){const n=r==null?void 0:r.command;let s=t===1&&n?n.replace(/\s/g,""):"";s&&(this._subMenuParentId=s),t>1&&(s=this._subMenuParentId);const a=`${this.menuCssClass} slick-menu-level-${t} ${this._gridUid}`,o=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${t}${this.gridUidSelector}`);if(o){if(o.dataset.subMenuParent===s)return o;this.disposeSubMenus()}const c=K("div",{role:"menu",className:a,ariaLabel:t>1?"SubMenu":"Grid Menu"});t>0&&(c.classList.add("slick-submenu"),s&&(c.dataset.subMenuParent=s));const h={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns(),level:t};return this._commandMenuElm=this.recreateCommandList(e,c,h,r),t++,c}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}hideMenu(e){var r,n,s;const t={grid:this.grid,menu:this._menuElm,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};if(this.pubSubService.publish("onGridMenuMenuClose",t),!(typeof((r=this._addonOptions)==null?void 0:r.onMenuClose)=="function"&&this._addonOptions.onMenuClose(e,t)===!1||this.onMenuClose.notify(t,null,this).getReturnValue()===!1)){if(this._isMenuOpen=!1,typeof((n=this.grid)==null?void 0:n.autosizeColumns)=="function"){const a=this.grid.getUID()||"";this._areVisibleColumnDifferent&&a&&document.querySelector(`.${a}`)!==null&&(this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this._areVisibleColumnDifferent=!1)}this.disposeSubMenus(),(s=this._menuElm)==null||s.remove(),this._menuElm=null}}recreateGridMenu(){this.deleteMenu(),this.init()}repositionMenu(e,t,r,n){var c,h;const s=((c=e==null?void 0:e.touches)==null?void 0:c[0])??e,a=t.classList.contains("slick-submenu"),o=a?e.target.closest(".slick-menu-item"):s.target;if(o){const l=r||this._gridMenuButtonElm,u=xi(r),d=xi(o),f=n??this._addonOptions,p=getComputedStyle(l),m=parseInt((p==null?void 0:p.width)??((h=this._defaults)==null?void 0:h.menuWidth),10),v=(t==null?void 0:t.offsetWidth)??0,_=(f==null?void 0:f.contentMinWidth)??this._defaults.contentMinWidth??0,x=(_>v?_:v)||0,E=(u==null?void 0:u.top)??0,C=(u==null?void 0:u.right)??0;let y,b;if(a?(b=(d==null?void 0:d.top)??0,y=(d==null?void 0:d.left)??0):(b=E+l.offsetHeight,y=(f==null?void 0:f.dropSide)==="right"?C-m:C-x),a){const G=(t==null?void 0:t.clientHeight)||0,{bottom:Q,top:ne}=mh(o);(Q<G&&ne>Q?"top":"bottom")==="top"?(t.classList.remove("dropdown"),t.classList.add("dropup"),b-=G-o.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}const T=this.grid.getGridPosition();let R=y+Number(v);a&&(R+=o.clientWidth);const O=document.documentElement.clientWidth;(R>=T.width||R>=O?"left":"right")==="left"||!a&&(f==null?void 0:f.dropSide)==="left"?(t.classList.remove("dropright"),t.classList.add("dropleft"),a&&(y-=Number(v))):(t.classList.remove("dropleft"),t.classList.add("dropright"),a&&(y+=o.offsetWidth)),t.style.top=`${b}px`,t.style.left=`${y}px`,_>0&&(t.style.minWidth=`${_}px`),t.style.opacity="1",t.style.display="block"}}openGridMenu(){const e=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!1});Object.defineProperty(e,"target",{writable:!0,configurable:!0,value:K("button",{className:"slick-grid-menu-button"})}),this.showGridMenu(e)}showGridMenu(e,t){var n,s,a;const r=((n=e==null?void 0:e.touches)==null?void 0:n[0])??e;if(e.preventDefault(),Rt(this._menuElm),(s=this._menuElm)==null||s.remove(),this._addonOptions){const o={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns()},c={...this._addonOptions,...t};if(c&&!this.extensionUtility.runOverrideFunctionWhenExists(c.menuUsabilityOverride,o)||typeof e.stopPropagation=="function"&&(this.pubSubService.publish("onGridMenuBeforeMenuShow",o),typeof(c==null?void 0:c.onBeforeMenuShow)=="function"&&c.onBeforeMenuShow(e,o)===!1||this.onBeforeMenuShow.notify(o,null,this).getReturnValue()===!1))return;this._menuElm=this.createCommandMenu(((a=this._addonOptions)==null?void 0:a.commandItems)??[]),this.createColumnPickerContainer(),Gc.call(this),this._columnCheckboxes=[],Ig.call(this,c),document.body.appendChild(this._menuElm),this._menuElm.style.opacity="0";const h=((c==null?void 0:c.marginBottom)!==void 0?c.marginBottom:this._defaults.marginBottom)||0;this._menuElm.style.minHeight=as(c==null?void 0:c.minHeight,""),(c==null?void 0:c.height)!==void 0?this._menuElm.style.height=as(c.height,""):this._menuElm.style.maxHeight=as(c==null?void 0:c.maxHeight,`${window.innerHeight-r.clientY-h}px`);let l=e.target.nodeName==="BUTTON"?e.target:e.target.querySelector("button");l||(l=e.target.parentElement),this._menuElm.setAttribute("aria-expanded","true"),this._menuElm.appendChild(this._listElm),this.repositionMenu(e,this._menuElm,l,c),this._isMenuOpen=!0,this.pubSubService.publish("onGridMenuAfterMenuShow",o),typeof(c==null?void 0:c.onAfterMenuShow)=="function"&&c.onAfterMenuShow(e,o),this.onAfterMenuShow.notify(o,null,this)}}translateGridMenu(){var e;if(this.sharedService.gridOptions.gridMenu){this.sharedService.gridOptions.gridMenu.commandItems=[],this.sharedService.gridOptions.gridMenu.commandTitle="",this.sharedService.gridOptions.gridMenu.columnTitle="",this.sharedService.gridOptions.gridMenu.forceFitTitle="",this.sharedService.gridOptions.gridMenu.syncResizeTitle="";const t=this._userOriginalGridMenu&&Array.isArray(this._userOriginalGridMenu.commandItems)?this._userOriginalGridMenu.commandItems:[];this.sharedService.gridOptions.gridMenu.commandItems=[...t,...this.addGridMenuCustomCommands(t)],this.extensionUtility.translateMenuItemsFromTitleKey(((e=this._addonOptions)==null?void 0:e.commandItems)||[],"commandItems"),this.extensionUtility.sortItems(this.sharedService.gridOptions.gridMenu.commandItems,"positionOrder"),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this.translateTitleLabels(this._addonOptions),this.extensionUtility.translateItems(this._columns,"nameKey","name")}}translateTitleLabels(e){e&&(e.commandTitle=this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"),e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),e.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),e.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"))}addGridMenuCustomCommands(e){var c,h,l,u;const t=this.gridOptions.backendServiceApi||null,r=[],n=this.gridOptions,s=Kn(n),a=(c=this._addonOptions)==null?void 0:c.commandLabels;if(this.gridOptions&&this._addonOptions&&!this._addonOptions.hideClearFrozenColumnsCommand){const d="clear-pinning";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconClearFrozenColumnsCommand||"fa fa-times",titleKey:`${s}${(a==null?void 0:a.clearFrozenColumnsCommandKey)??"CLEAR_PINNING"}`,disabled:!1,command:d,positionOrder:52})}if(this.gridOptions&&this.gridOptions.enableFiltering&&!this.sharedService.hideHeaderRowAfterPageLoad){if(this.gridOptions&&this._addonOptions&&!this._addonOptions.hideClearAllFiltersCommand){const d="clear-filter";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconClearAllFiltersCommand||"fa fa-filter text-danger",titleKey:`${s}${(a==null?void 0:a.clearAllFiltersCommandKey)??"CLEAR_ALL_FILTERS"}`,disabled:!1,command:d,positionOrder:50})}if(this.gridOptions&&this._addonOptions&&!this._addonOptions.hideToggleFilterCommand){const d="toggle-filter";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconToggleFilterCommand||"fa fa-random",titleKey:`${s}${(a==null?void 0:a.toggleFilterCommandKey)??"TOGGLE_FILTER_ROW"}`,disabled:!1,command:d,positionOrder:53})}if(t&&this.gridOptions&&this._addonOptions&&!this._addonOptions.hideRefreshDatasetCommand){const d="refresh-dataset";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconRefreshDatasetCommand||"fa fa-refresh",titleKey:`${s}${(a==null?void 0:a.refreshDatasetCommandKey)??"REFRESH_DATASET"}`,disabled:!1,command:d,positionOrder:57})}}if(this.gridOptions.showPreHeaderPanel&&this.gridOptions&&this._addonOptions&&!this._addonOptions.hideTogglePreHeaderCommand){const d="toggle-preheader";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconTogglePreHeaderCommand||"fa fa-random",titleKey:`${s}${(a==null?void 0:a.togglePreHeaderCommandKey)??"TOGGLE_PRE_HEADER_ROW"}`,disabled:!1,command:d,positionOrder:53})}if(this.gridOptions.enableSorting&&this.gridOptions&&this._addonOptions&&!this._addonOptions.hideClearAllSortingCommand){const d="clear-sorting";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconClearAllSortingCommand||"fa fa-unsorted text-danger",titleKey:`${s}${(a==null?void 0:a.clearAllSortingCommandKey)??"CLEAR_ALL_SORTING"}`,disabled:!1,command:d,positionOrder:51})}if((h=this.gridOptions)!=null&&h.enableTextExport&&this._addonOptions&&!this._addonOptions.hideExportCsvCommand){const d="export-csv";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconExportCsvCommand||"fa fa-download",titleKey:`${s}${(a==null?void 0:a.exportCsvCommandKey)??"EXPORT_TO_CSV"}`,disabled:!1,command:d,positionOrder:54})}if(this.gridOptions&&this.gridOptions.enableExcelExport&&this._addonOptions&&!this._addonOptions.hideExportExcelCommand){const d="export-excel";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconExportExcelCommand||"fa fa-file-excel-o text-success",titleKey:`${s}${(a==null?void 0:a.exportExcelCommandKey)??"EXPORT_TO_EXCEL"}`,disabled:!1,command:d,positionOrder:55})}if((l=this.gridOptions)!=null&&l.enableTextExport&&this._addonOptions&&!this._addonOptions.hideExportTextDelimitedCommand){const d="export-text-delimited";e.some(f=>f!=="divider"&&f.hasOwnProperty("command")&&f.command===d)||r.push({iconCssClass:this._addonOptions.iconExportTextDelimitedCommand||"fa fa-download",titleKey:`${s}${(a==null?void 0:a.exportTextDelimitedCommandKey)??"EXPORT_TO_TAB_DELIMITED"}`,disabled:!1,command:d,positionOrder:56})}const o=((u=this._addonOptions)==null?void 0:u.commandItems)||[];return this.gridOptions&&this._addonOptions&&(Array.isArray(r)&&r.length>0||Array.isArray(o)&&o.length>0)&&(this._addonOptions.commandTitle=this._addonOptions.commandTitle||this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu")),r}executeGridMenuInternalCustomCommands(e,t){var n,s,a;const r=((n=this.sharedService)==null?void 0:n.externalRegisteredResources)||[];if(t!=null&&t.command)switch(t.command){case"clear-pinning":const o=[...this.sharedService.visibleColumns],c={frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1};this.grid.setOptions(c),this.sharedService.gridOptions.frozenColumn=c.frozenColumn,this.sharedService.gridOptions.frozenRow=c.frozenRow,this.sharedService.gridOptions.frozenBottom=c.frozenBottom,this.sharedService.gridOptions.enableMouseWheelScrollHandler=c.enableMouseWheelScrollHandler,Array.isArray(o)&&this.grid.setColumns(o),this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this.pubSubService.publish("onGridMenuClearAllPinning");break;case"clear-filter":this.filterService.clearFilters(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllFilters");break;case"clear-sorting":this.sortService.clearSorting(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllSorting");break;case"export-csv":const l=r.find(m=>m.className==="TextExportService");l!=null&&l.exportToFile?l.exportToFile({delimiter:Ms.comma,format:ps.csv}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"export-excel":const u=r.find(m=>m.className==="ExcelExportService");u!=null&&u.exportToExcel?u.exportToExcel():console.error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Grid Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");break;case"export-text-delimited":const d=r.find(m=>m.className==="TextExportService");d!=null&&d.exportToFile?d.exportToFile({delimiter:Ms.tab,format:ps.txt}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"toggle-filter":let f=((s=this.gridOptions)==null?void 0:s.showHeaderRow)??!1;f=!f,this.grid.setHeaderRowVisibility(f),f===!0&&(this.grid.setColumns(this.sharedService.columnDefinitions),this.grid.scrollColumnIntoView(0));break;case"toggle-preheader":const p=((a=this.gridOptions)==null?void 0:a.showPreHeaderPanel)??!1;this.grid.setPreHeaderPanelVisibility(!p);break;case"refresh-dataset":this.extensionUtility.refreshBackendDataset();break}}getDefaultGridMenuOptions(){return{commandTitle:void 0,columnTitle:this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),forceFitTitle:this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),syncResizeTitle:this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"),iconCssClass:"fa fa-bars",menuWidth:18,commandItems:[],hideClearAllFiltersCommand:!1,hideRefreshDatasetCommand:!1,hideToggleFilterCommand:!1}}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const r=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||r)&&(t=!0),(this._isMenuOpen&&this.menuElement!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&r)&&this.hideMenu(e)}}handleMenuItemCommandClick(e,t,r,n=0){var s,a;if(r!=="divider"&&!r.disabled&&!r.divider)if((r.command||"")&&!r.commandItems){const c={grid:this.grid,command:r.command,item:r,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};this.executeGridMenuInternalCustomCommands(e,c),this.pubSubService.publish("onGridMenuCommand",c),typeof((s=this._addonOptions)==null?void 0:s.onCommand)=="function"&&this._addonOptions.onCommand(e,c),this.onCommand.notify(c,null,this),typeof r.action=="function"&&r.action.call(this,e,c),!((a=this._addonOptions)!=null&&a.leaveOpen)&&!e.defaultPrevented&&this.hideMenu(e),e.preventDefault(),e.stopPropagation()}else r.commandItems&&this.repositionSubMenu(e,r,n)}handleMenuItemMouseOver(e,t,r,n=0){r!=="divider"&&!r.disabled&&!r.divider&&(r.commandItems?this.repositionSubMenu(e,r,n):n===0&&this.disposeSubMenus())}recreateCommandList(e,t,r,n){const s=r.level||0;if(e.length>0){const a=K("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},t);if(s===0){this.populateCommandOrOptionTitle("command",this.addonOptions,a,s);const o=t.querySelector(".slick-command-header")??K("div",{className:"slick-command-header"});o.classList.add("with-close"),Ag.call(this,o),a.appendChild(o)}return n&&s>0&&this.addSubMenuTitleWhenExists(n,a),this.populateCommandOrOptionItems("command",this._addonOptions,a,e,r,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),a}return null}repositionSubMenu(e,t,r){const n=(t==null?void 0:t.commandItems)||[],s=this.createCommandMenu(n,r+1,t);s.style.display="block",document.body.appendChild(s),this.repositionMenu(e,s)}}function Ag(i){const t=K("button",{type:"button",className:"close",ariaLabel:"Close",textContent:"",dataset:{dismiss:this instanceof Wd?"slick-column-picker":"slick-grid-menu"}});i.appendChild(t)}function kg(i){var t,r;const e=this;(t=e.addonOptions)!=null&&t.columnTitle&&(e._columnTitleElm=K("div",{className:"slick-menu-title",textContent:((r=e.addonOptions)==null?void 0:r.columnTitle)??e._defaults.columnTitle},i))}function Og(i){var r;const e=this,t=e instanceof Wd?"columnPicker":"gridMenu";if(i.target.dataset.option==="autoresize"){const n=e.getVisibleColumns();i.target.ariaChecked=String(i.target.checked);const s=i.target.checked;e.grid.setOptions({forceFitColumns:s}),e.grid.setColumns(n);return}if(i.target.dataset.option==="syncresize"){i.target.ariaChecked=String(i.target.checked),e.grid.setOptions({syncColumnCellResize:!!i.target.checked});return}if(i.target.type==="checkbox"){e._areVisibleColumnDifferent=!0,i.target.ariaChecked=String(i.target.checked);const n=i.target.checked,s=i.target.dataset.columnid||"",a=[];if(e._columnCheckboxes.forEach((h,l)=>{h.checked&&a.push(e.columns[l])}),!a.length){i.target.checked=!0;return}if(e.grid.setColumns(a),(!e.sharedService.visibleColumns||Array.isArray(a)&&a.length!==e.sharedService.visibleColumns.length)&&(e.sharedService.visibleColumns=a),e.gridOptions.enableRowSelection&&n){const h=e.grid.getSelectedRows();e.grid.setSelectedRows(h)}const o=e.gridOptions.frozenColumn??-1;o>=0&&e.extensionUtility.readjustFrozenColumnIndexWhenNeeded(o,e.columns,a);const c={columnId:s,showing:n,allColumns:e.columns,visibleColumns:a,columns:a,grid:e.grid};e.pubSubService.publish(`on${nl(t)}ColumnsChanged`,c),typeof((r=e.addonOptions)==null?void 0:r.onColumnsChanged)=="function"&&e.addonOptions.onColumnsChanged(i,c),e.onColumnsChanged.notify(c,null,e)}}function Ig(i){const e=this,t=e instanceof Tg?"gridmenu-":"";for(const r of e.columns){const n=r.id,s=document.createElement("li");r.excludeFromColumnPicker&&(s.className="hidden");const a=K("input",{type:"checkbox",id:`${e._gridUid}-${t}colpicker-${n}`,dataset:{columnid:`${n}`}});e.grid.getColumnIndex(n)>=0&&(a.ariaChecked="true",a.checked=!0),s.appendChild(a),e._columnCheckboxes.push(a);const h=(typeof(i==null?void 0:i.headerColumnValueExtractor)=="function"?i.headerColumnValueExtractor:e._defaults.headerColumnValueExtractor)(r,e.gridOptions),l=document.createElement("label");l.htmlFor=`${e._gridUid}-${t}colpicker-${n}`,this.grid.applyHtmlCode(l,h),s.appendChild(l),e._listElm.appendChild(s)}if((!i.hideForceFitButton||!i.hideSyncResizeButton)&&e._listElm.appendChild(document.createElement("hr")),!(i!=null&&i.hideForceFitButton)){const r=document.createElement("li");r.appendChild(K("input",{type:"checkbox",id:`${e._gridUid}-${t}colpicker-forcefit`,ariaChecked:String(e.gridOptions.forceFitColumns),checked:e.gridOptions.forceFitColumns,dataset:{option:"autoresize"}})),r.appendChild(K("label",{htmlFor:`${e._gridUid}-${t}colpicker-forcefit`,textContent:(i==null?void 0:i.forceFitTitle)??""})),e._listElm.appendChild(r)}if(!(i!=null&&i.hideSyncResizeButton)){const r=document.createElement("li");r.appendChild(K("input",{type:"checkbox",id:`${e._gridUid}-${t}colpicker-syncresize`,ariaChecked:String(e.gridOptions.syncColumnCellResize),checked:e.gridOptions.syncColumnCellResize,dataset:{option:"syncresize"}})),r.appendChild(K("label",{htmlFor:`${e._gridUid}-${t}colpicker-syncresize`,textContent:(i==null?void 0:i.syncResizeTitle)??""})),e._listElm.appendChild(r)}}function Gc(){const i=this,e=i.grid.getColumns().slice(0),t=new Array(i.columns.length);for(let r=0;r<t.length;r++)i.grid.getColumnIndex(i.columns[r].id)===void 0?t[r]=i.columns[r]:t[r]=e.shift();i._columns=t}class Wd{constructor(e,t,r){var n,s;this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this.onColumnsChanged=new ze("onColumnsChanged"),this._areVisibleColumnDifferent=!1,this._columns=[],this._gridUid="",this._menuElm=null,this._columnCheckboxes=[],this._defaults={hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",minHeight:200,syncResizeTitle:"Synchronous resize",headerColumnValueExtractor:a=>Ls(a.name||"","innerHTML")},this._bindEventService=new Xi,this._eventHandler=new di,this._columns=this.sharedService.allColumns??[],this._gridUid=((s=(n=this.grid)==null?void 0:n.getUID)==null?void 0:s.call(n))??"",this.init()}get addonOptions(){return this.gridOptions.columnPicker||{}}get eventHandler(){return this._eventHandler}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.sharedService.gridOptions??{}}get grid(){return this.sharedService.slickGrid}get menuElement(){return this._menuElm}init(){this._gridUid=this.grid.getUID()??"",this.gridOptions.columnPicker={...this._defaults,...this.gridOptions.columnPicker},this.onColumnsChanged.setPubSubService(this.pubSubService),this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker"),this._eventHandler.subscribe(this.grid.onHeaderContextMenu,this.handleHeaderContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onColumnsReordered,Gc.bind(this)),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this),void 0,"body"),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this),void 0,"body")}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this.disposeMenu()}disposeMenu(){var e,t;this._bindEventService.unbindAll("parent-menu"),(e=this._listElm)==null||e.remove(),(t=this._menuElm)==null||t.remove(),this._menuElm=null}createPickerMenu(){const e=K("div",{ariaExpanded:"true",className:`slick-column-picker ${this._gridUid}`,role:"menu"});return Gc.call(this),kg.call(this,e),Ag.call(this,e),this._listElm=K("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(e,"click",Og.bind(this),void 0,"parent-menu"),document.body.appendChild(e),e}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}translateColumnPicker(){this.addonOptions&&(this.addonOptions.columnTitle="",this.addonOptions.forceFitTitle="",this.addonOptions.syncResizeTitle="",this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker")),this.extensionUtility.translateItems(this._columns,"nameKey","name"),this.translateTitleLabels(this.addonOptions)}handleBodyMouseDown(e){var t;(this._menuElm!==e.target&&!((t=this._menuElm)!=null&&t.contains(e.target))||e.target.className==="close"&&e.target.closest(".slick-column-picker"))&&this.disposeMenu()}handleHeaderContextMenu(e){e.preventDefault(),Rt(this._listElm),this._columnCheckboxes=[],this._menuElm=this.createPickerMenu(),Ig.call(this,this.addonOptions),document.body.appendChild(this._menuElm),this.repositionMenu(e)}repositionMenu(e){var r;const t=((r=e==null?void 0:e.touches)==null?void 0:r[0])??e;this._menuElm&&(this._menuElm.style.top=`${t.pageY-10}px`,this._menuElm.style.left=`${t.pageX-10}px`,this._menuElm.style.minHeight=as(this.addonOptions.minHeight,""),this._menuElm.style.maxHeight=as(this.addonOptions.maxHeight,`${window.innerHeight-t.clientY}px`),this._menuElm.style.display="block",this._menuElm.setAttribute("aria-expanded","true"),this._menuElm.appendChild(this._listElm))}translateTitleLabels(e){e&&(e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"))}}const Oc=(i,e,t,r,n,s)=>{const a=r.params||{};if(!a.formatters||!Array.isArray(a.formatters))throw new Error(`[Slickgrid-Universal] The multiple formatter requires the "formatters" to be provided as a column params.
    For example: this.columnDefinitions = [{ id: title, field: title, formatter: Formatters.multiple, params: { formatters: [Formatters.lowercase, Formatters.uppercase] }`);const o=a.formatters;let c=t;return o.forEach((h,l)=>{if(typeof h!="function")throw new Error(`[Slickgrid-Universal] the "params.formatters" at index(${l}) to be used by "Formatters.multiple" is invalid, please verify all formatter functions.`);c=h.call(void 0,i,e,c,r,n,s)}),c};function rp(i,e){if(Array.isArray(i)){for(const t of i)if(t.editor)if(t.formatter&&t.formatter!==Oc&&t.formatter!==e){const r=t.formatter;t.formatter=Oc,t.params={...t.params,formatters:[r,e]}}else t.formatter&&t.formatter===Oc&&t.params?t.params.formatters.findIndex(r=>r===e)===-1&&(t.params.formatters=[...t.params.formatters,e]):t.formatter=e}}function yi(i,e,t,r){let n,s,a="",o="";switch(t){case"currency":n=ye.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL,s=ye.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL;break;case"decimal":n=ye.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL,s=ye.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL;break;case"percent":n=ye.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL,s=ye.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL;break}const c=e&&typeof e.getOptions=="function"?e.getOptions():{},h=ts("minDecimal",i,c,n),l=ts("maxDecimal",i,c,s),u=ts("decimalSeparator",i,c,ye.DEFAULT_NUMBER_DECIMAL_SEPARATOR),d=ts("thousandSeparator",i,c,ye.DEFAULT_NUMBER_THOUSAND_SEPARATOR),f=ts("displayNegativeNumberWithParentheses",i,c,ye.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET),p=ts("currencyPrefix",i,c,""),m=ts("currencySuffix",i,c,"");return r==="cell"&&(a=ts("numberPrefix",i,c,""),o=ts("numberSuffix",i,c,"")),{minDecimal:h,maxDecimal:l,decimalSeparator:u,thousandSeparator:d,wrapNegativeNumber:f,currencyPrefix:p,currencySuffix:m,numberPrefix:a,numberSuffix:o}}function ts(i,e,t,r){var s;const n=e&&e.params;return n&&n.hasOwnProperty(i)?n[i]:(s=t==null?void 0:t.formatterOptions)!=null&&s.hasOwnProperty(i)?t.formatterOptions[i]:r}function pi(i,e){const t=Lr(i);return(r,n,s,a,o,c)=>{var v,_;const h=c&&typeof c.getOptions=="function"?c.getOptions():{},l=((v=h==null?void 0:h.formatterOptions)==null?void 0:v.dateSeparator)??e,u=(a==null?void 0:a.type)??Y.date,d=Lr(u),f=((_=a==null?void 0:a.params)==null?void 0:_.parseDateAsUtc)??!1,p=Wr(s,d,!1).isValid();let m=s;if(s&&p&&(m=f?Wr.utc(s).format(t):Wr(s).format(t)),m&&l!==e){const x=new RegExp(e,"ig");m=m.replace(x,l)}return m}}function Yx(i,e,t,r,n,s){let a=!1;t!=null&&t.hasOwnProperty("exportWithFormatter")?a=!!t.exportWithFormatter:s!=null&&s.hasOwnProperty("exportWithFormatter")&&(a=!!s.exportWithFormatter);let o;r&&t.exportCustomFormatter?o=t.exportCustomFormatter:a&&t.formatter&&(o=t.formatter);const c=Eh(o,i,e,t,r,n);return s!=null&&s.sanitizeDataExport&&typeof c=="string"?Rn(c):c}function Eh(i,e,t,r,n,s){let a="",c=r.field||r.id||"";if(typeof r.field=="string"&&r.field.indexOf(".")>0){const l=r.field.split(".");c=l.length>0?l[0]:r.field}const h=n!=null&&n.hasOwnProperty(c)?n[c]:null;if(typeof i=="function"){const l=i(e,t,h,r,n,s),u=rl(l)?l:l.html||l.text;a=Ls(u)}else a=n!=null&&n.hasOwnProperty(c)?h:"";return a==null&&(a=""),typeof a=="object"&&!(a instanceof Date)&&Object.entries(a).length===0&&(a=""),a}class Xx extends Sg{constructor(e,t,r,n){super(e,t,r),this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this.treeDataService=n,this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!1,optionShownOverColumnIds:[],commandShownOverColumnIds:[],subMenuOpenByEvent:"mouseover"},this.pluginName="ContextMenu",this._camelPluginName="contextMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-context-menu",this.init(r.gridOptions.contextMenu)}init(e){this._addonOptions={...this._defaults,...e};const t=this._addonOptions&&Array.isArray(this._addonOptions.commandItems)?this._addonOptions.commandItems:[];this._addonOptions.commandItems=[...t,...this.addMenuCustomCommands(t)],this._addonOptions={...this._addonOptions},this.sharedService.gridOptions.contextMenu=this._addonOptions,this.sortMenuItems(),this._eventHandler.subscribe(this.grid.onContextMenu,this.handleOnContextMenu.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateContextMenu(){var r;const e=((r=this.sharedService)==null?void 0:r.gridOptions)??{},t=this.sharedService.gridOptions.contextMenu;if(t&&(e!=null&&e.enableTranslate)){const n=t.commandItems||[],s=t.optionItems||[];t.commandTitleKey&&(t.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.commandTitleKey,"TEXT_COMMANDS")||t.commandTitle),t.optionTitleKey&&(t.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(t.optionTitleKey,"TEXT_COMMANDS")||t.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(n,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(s,"optionItems")}}handleOnContextMenu(e,t){this.disposeAllMenus();const r=this.grid.getCellFromEvent(e);if(r){const n=this.grid.getDataItem(r.row),s=this.grid.getColumns()[r.cell],a=t||{};if(a.cell=r.cell,a.row=r.row,a.column=s,a.dataContext=n,a.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,a))return;this._menuElm=this.createParentMenu(e),this._menuElm&&e.preventDefault(),this._menuElm&&(this.repositionMenu(e,this._menuElm),this._menuElm.setAttribute("aria-expanded","true"),this._menuElm.style.display="block"),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}addMenuCustomCommands(e){var o;const t=[],r=this.sharedService&&this.sharedService.gridOptions||{},n=r==null?void 0:r.contextMenu,s=(o=this.sharedService)==null?void 0:o.dataView,a=Kn(r);if(n&&!n.hideCopyCellValueCommand){const c="copy";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconCopyCellValueCommand||"fa fa-clone",titleKey:`${a}COPY`,disabled:!1,command:c,positionOrder:50,action:(h,l)=>{this.copyToClipboard(l)},itemUsabilityOverride:h=>{const l=h==null?void 0:h.column,u=h==null?void 0:h.dataContext;if(typeof l.queryFieldNameGetterFn=="function"){const d=tl(l,u,"");if(d!==""&&d!==void 0)return!0}else if(l&&u.hasOwnProperty(l.field))return u[l.field]!==""&&u[l.field]!==null&&u[l.field]!==void 0;return!1}})}if(r!=null&&r.enableTextExport&&n&&!n.hideExportCsvCommand){const c="export-csv";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconExportCsvCommand||"fa fa-download",titleKey:`${a}EXPORT_TO_CSV`,disabled:!1,command:c,positionOrder:51,action:()=>{var u;const l=(((u=this.sharedService)==null?void 0:u.externalRegisteredResources)||[]).find(d=>d.className==="TextExportService");if(l!=null&&l.exportToFile)l.exportToFile({delimiter:Ms.comma,format:ps.csv});else throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };")}})}if(r&&r.enableExcelExport&&n&&!n.hideExportExcelCommand){const c="export-excel";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconExportExcelCommand||"fa fa-file-excel-o text-success",titleKey:`${a}EXPORT_TO_EXCEL`,disabled:!1,command:c,positionOrder:52,action:()=>{var u;const l=(((u=this.sharedService)==null?void 0:u.externalRegisteredResources)||[]).find(d=>d.className==="ExcelExportService");if(l!=null&&l.exportToExcel)l.exportToExcel();else throw new Error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Context Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };")}})}if(r!=null&&r.enableTextExport&&n&&!n.hideExportTextDelimitedCommand){const c="export-text-delimited";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconExportTextDelimitedCommand||"fa fa-download",titleKey:`${a}EXPORT_TO_TAB_DELIMITED`,disabled:!1,command:c,positionOrder:53,action:()=>{var u;const l=(((u=this.sharedService)==null?void 0:u.externalRegisteredResources)||[]).find(d=>d.className==="TextExportService");if(l!=null&&l.exportToFile)l.exportToFile({delimiter:Ms.tab,format:ps.txt});else throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };")}})}if(r&&(r.enableGrouping||r.enableDraggableGrouping||r.enableTreeData)){if(n&&!n.hideCopyCellValueCommand&&t.push({divider:!0,command:"",positionOrder:54}),r&&!r.enableTreeData&&n&&!n.hideClearAllGrouping){const c="clear-grouping";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconClearGroupingCommand||"fa fa-times",titleKey:`${a}CLEAR_ALL_GROUPING`,disabled:!1,command:c,positionOrder:55,action:()=>{s.setGrouping([]),this.pubSubService.publish("onContextMenuClearGrouping")},itemUsabilityOverride:()=>{const h=s&&s.getGrouping&&s.getGrouping();return Array.isArray(h)&&h.length>0}})}if(r&&n&&!n.hideCollapseAllGroups){const c="collapse-all-groups";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconCollapseAllGroupsCommand||"fa fa-compress",titleKey:`${a}COLLAPSE_ALL_GROUPS`,disabled:!1,command:c,positionOrder:56,action:()=>{r.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!0):s.collapseAllGroups(),this.pubSubService.publish("onContextMenuCollapseAllGroups")},itemUsabilityOverride:()=>{if(r.enableTreeData)return!0;const h=s&&s.getGrouping&&s.getGrouping();return Array.isArray(h)&&h.length>0}})}if(r&&n&&!n.hideExpandAllGroups){const c="expand-all-groups";e.some(h=>h!=="divider"&&h.hasOwnProperty("command")&&h.command===c)||t.push({iconCssClass:n.iconExpandAllGroupsCommand||"fa fa-expand",titleKey:`${a}EXPAND_ALL_GROUPS`,disabled:!1,command:c,positionOrder:57,action:()=>{r.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!1):s.expandAllGroups(),this.pubSubService.publish("onContextMenuExpandAllGroups")},itemUsabilityOverride:()=>{if(r.enableTreeData)return!0;const h=s&&s.getGrouping&&s.getGrouping();return Array.isArray(h)&&h.length>0}})}}return this.extensionUtility.translateMenuItemsFromTitleKey(t),t}copyToClipboard(e){var t,r;try{if(e&&e.grid&&e.command){const n=((t=this.sharedService)==null?void 0:t.gridOptions)??{},s=(e==null?void 0:e.cell)??0,a=(e==null?void 0:e.row)??0,o=e==null?void 0:e.column,c=e==null?void 0:e.dataContext,h=(r=this.sharedService)==null?void 0:r.slickGrid,l=n&&(n.excelExportOptions||n.textExportOptions);let u=Yx(a,s,o,c,h,l);typeof o.queryFieldNameGetterFn=="function"&&(u=tl(o,c,""));let d=u;typeof u=="string"&&(d=u.replace(/^([||]\s*)|([||])\s*/gi,"").replace(/[\u00b7|\u034f]/gi,"").trim());const f=document.createElement("textarea");f&&document.body&&(f.style.position="absolute",f.style.opacity="0",f.value=d,document.body.appendChild(f),f.select(),document.execCommand("copy",!1,d)&&f.remove())}}catch{}}sortMenuItems(){var t,r;const e=(r=(t=this.sharedService)==null?void 0:t.gridOptions)==null?void 0:r.contextMenu;e&&(this.extensionUtility.sortItems(e.commandItems||[],"positionOrder"),this.extensionUtility.sortItems(e.optionItems||[],"positionOrder"))}}class qx{constructor(e,t,r){this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this.columnsGroupBy=[],this.pluginName="DraggableGrouping",this._gridColumns=[],this._gridUid="",this._reorderedColumns=[],this._subscriptions=[],this._defaults={dropPlaceHolderText:"Drop a column header here to group by the column",hideGroupSortIcons:!1,hideToggleAllButton:!1,toggleAllButtonText:"",toggleAllPlaceholderText:"Toggle all Groups"},this._bindingEventService=new Xi,this._eventHandler=new di,this.onGroupChanged=new ze("onGroupChanged")}get addonOptions(){return this._addonOptions}get dataView(){var e;return((e=this.grid)==null?void 0:e.getData())??{}}get dropboxElement(){return this._dropzoneElm}get droppableInstance(){return this._droppableInstance}get sortableLeftInstance(){return this._sortableLeftInstance}get sortableRightInstance(){return this._sortableRightInstance}get eventHandler(){return this._eventHandler}get grid(){return this._grid??this.sharedService.slickGrid??{}}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){var e;return this._gridUid||(((e=this.grid)==null?void 0:e.getUID())??"")}get gridContainer(){return this.grid.getContainerNode()}init(e,t){var r,n;if(this._addonOptions={...this._defaults,...t},this._grid=e,e){if(this._gridUid=e.getUID(),this._gridColumns=e.getColumns(),this._dropzoneElm=e.getPreHeaderPanel(),this._dropzoneElm.classList.add("slick-dropzone"),this.onGroupChanged.setPubSubService(this.pubSubService),!this._addonOptions.hideToggleAllButton){this._groupToggler=K("div",{className:"slick-group-toggle-all",title:this._addonOptions.toggleAllPlaceholderText??"",style:{display:"none"}});const s=K("span",{className:"slick-group-toggle-all-icon"},this._groupToggler);this.gridOptions.enableTranslate&&this._addonOptions.toggleAllButtonTextKey&&(this._addonOptions.toggleAllButtonText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllButtonTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this.gridOptions.enableTranslate&&this._addonOptions.toggleAllPlaceholderTextKey&&(this._addonOptions.toggleAllPlaceholderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllPlaceholderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._groupToggler.title=this._addonOptions.toggleAllPlaceholderText??"",this._addonOptions.toggleAllButtonText&&this._groupToggler.appendChild(K("span",{className:"slick-group-toggle-all-text",textContent:this._addonOptions.toggleAllButtonText||""})),this._dropzoneElm.appendChild(this._groupToggler),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuCollapseAllGroups",()=>this.toggleGroupToggler(s,!0,!1)),this.pubSubService.subscribe("onContextMenuExpandAllGroups",()=>this.toggleGroupToggler(s,!1,!1)))}this._dropzonePlaceholderElm=K("div",{className:"slick-draggable-dropzone-placeholder"},this._dropzoneElm),this.gridOptions.enableTranslate&&((r=this._addonOptions)!=null&&r.dropPlaceHolderTextKey)&&(this._addonOptions.dropPlaceHolderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.dropPlaceHolderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._dropzonePlaceholderElm.textContent=((n=this._addonOptions)==null?void 0:n.dropPlaceHolderText)??this._defaults.dropPlaceHolderText??"",this.setupColumnDropbox(),this._eventHandler.subscribe(e.onHeaderCellRendered,(s,a)=>{var c;const o=a.node;if(!td((c=a.column)==null?void 0:c.grouping)&&o&&(o.style.cursor="pointer",this._addonOptions.groupIconCssClass)){const h=K("span",{className:"slick-column-groupable"},o);this._addonOptions.groupIconCssClass&&h.classList.add(...gi(this._addonOptions.groupIconCssClass))}}),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuClearGrouping",()=>this.clearDroppedGroups()));for(const s of this._gridColumns){const a=s.field;e.updateColumnHeader(a)}}return this}dispose(){var e,t;this.destroySortableInstances(),(e=this._droppableInstance)!=null&&e.el&&((t=this._droppableInstance)==null||t.destroy()),this.onGroupChanged.unsubscribe(),this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingEventService.unbindAll(),Rt(this.gridContainer.querySelector(`.${this.gridUid} .slick-preheader-panel`))}clearDroppedGroups(){this.columnsGroupBy=[],this.updateGroupBy("clear-all");const e=this._dropzoneElm.querySelectorAll(".slick-dropped-grouping");for(const t of Array.from(e)){const r=this._dropzoneElm.querySelector(".slick-groupby-remove");r==null||r.remove(),t==null||t.remove()}this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")}destroySortableInstances(){var e,t,r,n;(e=this._sortableLeftInstance)!=null&&e.el&&((t=this._sortableLeftInstance)==null||t.destroy()),(r=this._sortableRightInstance)!=null&&r.el&&((n=this._sortableRightInstance)==null||n.destroy())}setAddonOptions(e){this._addonOptions={...this._addonOptions,...e}}setColumns(e){this._gridColumns=e}setDroppedGroups(e){this._dropzonePlaceholderElm.style.display="none";const t=Array.isArray(e)?e:[e];for(const r of t){const n=this.grid.getHeaderColumn(r);this.handleGroupByDrop(this._dropzoneElm,n)}}setupColumnReorder(e,t,r,n,s,a,o,c,h){this.destroySortableInstances();const l=e.getPreHeaderPanel(),u=l.querySelector(".slick-draggable-dropzone-placeholder"),d=l.querySelector(".slick-group-toggle-all"),f={animation:50,chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dataIdAttr:"data-id",group:{name:"shared",pull:"clone",put:!1},revertClone:!0,onStart:()=>{u&&(u.style.display="inline-block"),l.querySelectorAll(".slick-dropped-grouping").forEach(m=>m.style.display="none"),d&&(d.style.display="none")},onEnd:p=>{var E,C,y;l==null||l.classList.remove("slick-dropzone-hover"),(E=u==null?void 0:u.parentElement)==null||E.classList.remove("slick-dropzone-placeholder-hover");const m=l.querySelectorAll(".slick-dropped-grouping");if(m.forEach(b=>b.style.display="flex"),m.length&&(u&&(u.style.display="none"),d&&(d.style.display="inline-block")),!e.getEditorLock().commitCurrentEdit())return;const v=((C=this.sortableLeftInstance)==null?void 0:C.toArray())??[];if(t.length>1){const b=((y=this._sortableRightInstance)==null?void 0:y.toArray())??[];for(const T of b)v.push(T)}const _=[],x=e.getColumns();for(const b of v)_.push(x[o.call(e,b)]);n.call(e,_),h.call(e,e.onColumnsReordered,{grid:e}),p.stopPropagation(),s.call(e)}};return this._sortableLeftInstance=nt.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-left`),f),this._sortableRightInstance=nt.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-right`),f),{sortableLeftInstance:this._sortableLeftInstance,sortableRightInstance:this._sortableRightInstance}}addColumnGroupBy(e){this.columnsGroupBy.push(e),this.updateGroupBy("add-group")}addGroupByRemoveClickHandler(e,t,r,n){this._bindingEventService.bind(t,"click",()=>{const s=this._bindingEventService.boundedEvents.filter(a=>a.element===t);for(const a of s)this._bindingEventService.unbind(a.element,"click",a.listener);this.removeGroupBy(e,r,n)})}addGroupSortClickHandler(e,t){const{grouping:r,type:n}=e;this._bindingEventService.bind(t,"click",()=>{if(this.toggleGroupAll(e,!1),r){const s=r.sortAsc?ii.desc:ii.asc;r.comparer=(a,o)=>Ka(n||"text",a.value,o.value,s,e,this.gridOptions),this.getGroupBySortIcon(t,!r.sortAsc),this.updateGroupBy("sort-group"),r.sortAsc=!r.sortAsc,this.grid.invalidate()}})}getGroupBySortIcon(e,t=!0){t?this._addonOptions.sortAscIconCssClass?(e.classList.remove(...gi(this._addonOptions.sortDescIconCssClass)),e.classList.add(...gi(this._addonOptions.sortAscIconCssClass))):(e.classList.add("slick-groupby-sort-asc-icon"),e.classList.remove("slick-groupby-sort-desc-icon")):this._addonOptions.sortDescIconCssClass?(e.classList.remove(...gi(this._addonOptions.sortAscIconCssClass)),e.classList.add(...gi(this._addonOptions.sortDescIconCssClass))):this._addonOptions.sortDescIconCssClass||(e.classList.add("slick-groupby-sort-desc-icon"),e.classList.remove("slick-groupby-sort-asc-icon"))}handleGroupByDrop(e,t){var s,a,o;const r=(s=t.getAttribute("data-id"))==null?void 0:s.replace(this._gridUid,"");let n=!0;for(const c of this.columnsGroupBy)c.id===r&&(n=!1);if(n){for(const c of this._gridColumns)if(c.id===r&&c.grouping&&!td(c.grouping)){const h=t.querySelector(".slick-column-name"),l=K("div",{id:`${this._gridUid}_${c.id}_entry`,className:"slick-dropped-grouping",dataset:{id:`${c.id}`}});K("div",{className:"slick-dropped-grouping-title",style:{display:"inline-flex"},textContent:h?h.textContent:t.textContent},l);const u=K("div",{className:"slick-groupby-remove"});this._addonOptions.deleteIconCssClass&&u.classList.add(...gi(this._addonOptions.deleteIconCssClass)),this._addonOptions.deleteIconCssClass||u.classList.add("slick-groupby-remove-icon");let d;((a=this._addonOptions)==null?void 0:a.hideGroupSortIcons)!==!0&&c.sortable&&(((o=c.grouping)==null?void 0:o.sortAsc)===void 0&&(c.grouping.sortAsc=!0),d=K("div",{className:"slick-groupby-sort"},l),this.getGroupBySortIcon(d,c.grouping.sortAsc)),l.appendChild(u),l.appendChild(document.createElement("div")),e.appendChild(l),this._groupToggler&&this.columnsGroupBy.length===0&&this.toggleGroupAll(c),this.addColumnGroupBy(c),this.addGroupByRemoveClickHandler(c.id,u,t,l),d&&this.addGroupSortClickHandler(c,d)}this._groupToggler&&this.columnsGroupBy.length>0&&(this._groupToggler.style.display="inline-block")}}toggleGroupAll({grouping:e},t){var n;const r=(n=this._groupToggler)==null?void 0:n.querySelector(".slick-group-toggle-all-icon");t===!0||e!=null&&e.collapsed?(r==null||r.classList.add("collapsed"),r==null||r.classList.remove("expanded")):(r==null||r.classList.add("expanded"),r==null||r.classList.remove("collapsed"))}removeFromArray(e,t){if(Array.isArray(e)){const r=e.findIndex(n=>n.id===t.id);r>=0&&e.splice(r,1)}return e}removeGroupBy(e,t,r){r.remove();const n=[];this._gridColumns.forEach(s=>n[s.id]=s),this.removeFromArray(this.columnsGroupBy,n[e]),this.columnsGroupBy.length===0&&(this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")),this.updateGroupBy("remove-group")}addDragOverDropzoneListeners(){const e=this._dropzoneElm.querySelector(".slick-draggable-dropzone-placeholder");e&&this._dropzoneElm&&(this._bindingEventService.bind(e,"dragover",t=>t.preventDefault()),this._bindingEventService.bind(e,"dragenter",()=>this._dropzoneElm.classList.add("slick-dropzone-hover")),this._bindingEventService.bind(e,"dragleave",()=>this._dropzoneElm.classList.remove("slick-dropzone-hover")))}setupColumnDropbox(){const e=this._dropzoneElm;this._droppableInstance=nt.create(e,{group:"shared",ghostClass:"slick-droppable-sortitem-hover",draggable:".slick-dropped-grouping",dragoverBubble:!0,onAdd:t=>{var n,s;const r=t.item;(n=r.getAttribute("id"))!=null&&n.replace(this._gridUid,"")&&this.handleGroupByDrop(e,nt.utils.clone(t.item)),(s=r.parentNode)==null||s.removeChild(r)},onUpdate:()=>{var n;const t=((n=this._droppableInstance)==null?void 0:n.toArray())??[],r=[];for(const s of t)for(const a of this.columnsGroupBy)if(a.id===s){r.push(a);break}this.columnsGroupBy=r,this.updateGroupBy("sort-group")}}),this.addDragOverDropzoneListeners(),this._groupToggler&&this._bindingEventService.bind(this._groupToggler,"click",t=>{const r=t.target.classList.contains("slick-group-toggle-all-icon")?t.target:t.currentTarget.querySelector(".slick-group-toggle-all-icon");this.toggleGroupToggler(r,r==null?void 0:r.classList.contains("expanded"))})}toggleGroupToggler(e,t=!0,r=!0){e&&(t===!0?(e.classList.add("collapsed"),e.classList.remove("expanded"),r&&this.dataView.collapseAllGroups()):(e.classList.remove("collapsed"),e.classList.add("expanded"),r&&this.dataView.expandAllGroups()))}updateGroupBy(e){if(this.columnsGroupBy.length===0){this.dataView.setGrouping([]),this._dropzonePlaceholderElm.style.display="inline-block",this.triggerOnGroupChangedEvent({caller:e,groupColumns:[]});return}const t=[];this.columnsGroupBy.forEach(r=>t.push(r.grouping)),this.dataView.setGrouping(t),this._dropzonePlaceholderElm.style.display="none",this.triggerOnGroupChangedEvent({caller:e,groupColumns:t})}triggerOnGroupChangedEvent(e){this._addonOptions&&typeof this._addonOptions.onGroupChanged=="function"&&this._addonOptions.onGroupChanged(new Yt,e),this.onGroupChanged.notify(e)}}class Kx extends _h{constructor(e,t,r){super(e,t,r),this.extensionUtility=e,this.pubSubService=t,this.sharedService=r,this._buttonElms=[],this._defaults={buttonCssClass:"slick-header-button"},this.pluginName="HeaderButtons",this._menuCssPrefix="slick-header-button",this._camelPluginName="headerButtons",this._bindEventService=new Xi,this._eventHandler=new di,this.init(r.gridOptions.headerButton)}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this.grid.setColumns(this.grid.getColumns())}dispose(){super.dispose(),this._buttonElms.forEach(e=>e.remove())}handleHeaderCellRendered(e,t){var n;const r=t.column;if((n=r.header)!=null&&n.buttons&&Array.isArray(r.header.buttons)){let s=r.header.buttons.length;for(;s--;){const a=r.header.buttons[s],o=this.populateSingleCommandOrOptionItem("command",this.addonOptions,null,a,t,this.handleButtonClick.bind(this));o&&a.handler&&!a.disabled&&this._bindEventService.bind(o,"click",c=>a.handler.call(this,c)),o&&(this._buttonElms.push(o),t.node.appendChild(o))}}}handleBeforeHeaderCellDestroy(e,t){var n,s,a;if((n=t.column.header)!=null&&n.buttons&&((s=this._addonOptions)!=null&&s.buttonCssClass)){const o=(((a=this._addonOptions)==null?void 0:a.buttonCssClass)||"").replace(/(\s+)/g,".");o&&t.node.querySelectorAll(`.${o}`).forEach(c=>c.remove())}}handleButtonClick(e,t,r,n,s){var a;if(r.command&&!r.disabled){const o=r.command||"",c={grid:this.grid,column:s,button:r};o&&(c.command=o),typeof r.action=="function"&&!r.disabled&&r.action.call(this,e,c),o!==null&&!r.disabled&&((a=this._addonOptions)!=null&&a.onCommand)&&(this.pubSubService.publish("onHeaderButtonCommand",c),this._addonOptions.onCommand(e,c),s!=null&&s.id&&this.grid.updateColumnHeader(s.id))}e.preventDefault(),e.stopPropagation()}}class jx extends _h{constructor(e,t,r,n,s){super(e,r,n),this.extensionUtility=e,this.filterService=t,this.pubSubService=r,this.sharedService=n,this.sortService=s,this._subMenuParentId="",this._defaults={autoAlign:!0,autoAlignOffset:0,buttonCssClass:null,buttonImage:null,minWidth:100,hideColumnHideCommand:!1,hideSortCommands:!1,title:"",subMenuOpenByEvent:"mouseover"},this.pluginName="HeaderMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-header-menu",this._camelPluginName="headerMenu",this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(this.sharedService.columnDefinitions),this.init(n.gridOptions.headerMenu)}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onBeforeSetColumns,(t,r)=>{this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(r.newColumns)}),this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this.grid.setColumns(this.grid.getColumns()),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}dispose(){var e;super.dispose(),this._menuElm=this._menuElm||document.body.querySelector(`.slick-header-menu${this.gridUidSelector}`),(e=this._menuElm)==null||e.remove(),this._activeHeaderColumnElm=void 0}hideColumn(e){var t,r;if((r=(t=this.sharedService)==null?void 0:t.slickGrid)!=null&&r.getColumnIndex){const n=this.sharedService.slickGrid.getColumnIndex(e.id),s=this.sharedService.slickGrid.getColumns(),a=this.sharedService.gridOptions.frozenColumn??-1;a>=0&&a>=n&&(this.sharedService.gridOptions.frozenColumn=a-1,this.sharedService.slickGrid.setOptions({frozenColumn:this.sharedService.gridOptions.frozenColumn}));const o=Fd(s,n);this.sharedService.visibleColumns=o,this.sharedService.slickGrid.setColumns(o),this.pubSubService.publish("onHeaderMenuHideColumns",{columns:o,hiddenColumn:e})}}hideMenu(){var e,t;this.disposeSubMenus(),(e=this._menuElm)==null||e.remove(),this._menuElm=void 0,(t=this._activeHeaderColumnElm)==null||t.classList.remove("slick-header-column-active")}repositionSubMenu(e,t,r,n){const s=this.createCommandMenu(t.commandItems||[],n,r+1,t);document.body.appendChild(s),this.repositionMenu(e,s)}repositionMenu(e,t){var d,f;const r=e.target,n=t.classList.contains("slick-submenu"),s=n?e.target.closest(".slick-menu-item"):r,a=Vm(this.sharedService.gridContainerElement,r),o=this.grid.getGridPosition(),c=t.offsetWidth,h=xi(s);let l=n?(h==null?void 0:h.left)??0:(a==null?void 0:a.left)??0,u=n?(h==null?void 0:h.top)??0:((a==null?void 0:a.top)??0)+(((d=this.addonOptions)==null?void 0:d.menuOffsetTop)??0)+r.clientHeight;if(n){const p=(t==null?void 0:t.clientHeight)||0,{bottom:m,top:v}=mh(s);(m<p&&v>m?"top":"bottom")==="top"?(t.classList.remove("dropdown"),t.classList.add("dropup"),u-=p-s.clientHeight):(t.classList.remove("dropup"),t.classList.add("dropdown"))}if(n&&s){const p=l+Number(c)+s.clientWidth,m=document.documentElement.clientWidth;(p>=o.width||p>=m?"left":"right")==="left"?(t.classList.remove("dropright"),t.classList.add("dropleft"),l-=c):(t.classList.remove("dropleft"),t.classList.add("dropright"),l+=s.offsetWidth)}else l=(a==null?void 0:a.left)??0,this.addonOptions.autoAlign&&(o!=null&&o.width)&&l+(t.clientWidth??0)>=o.width&&(l=l+r.clientWidth-t.clientWidth+(((f=this.addonOptions)==null?void 0:f.autoAlignOffset)||0));t.style.top=`${u}px`,t.style.left=`${l}px`,this._activeHeaderColumnElm=this.grid.getContainerNode().querySelector(":not(.slick-preheader-panel) >.slick-header-columns"),this._activeHeaderColumnElm&&this._activeHeaderColumnElm.classList.add("slick-header-column-active")}translateHeaderMenu(){var e;(e=this.sharedService.gridOptions)!=null&&e.headerMenu&&this.resetHeaderMenuTranslations(this.sharedService.visibleColumns)}handleHeaderCellRendered(e,t){var s;const n=(s=t.column.header)==null?void 0:s.menu;if(n&&t.node){if(!this.extensionUtility.runOverrideFunctionWhenExists(this.addonOptions.menuUsabilityOverride,t))return;const a=K("div",{className:"slick-header-menu-button",ariaLabel:"Header Menu"},t.node);this.addonOptions.buttonCssClass&&a.classList.add(...gi(this.addonOptions.buttonCssClass)),this.addonOptions.tooltip&&(a.title=this.addonOptions.tooltip),this._bindEventService.bind(a,"click",o=>{this.disposeAllMenus(),this.createParentMenu(o,t.column,n)})}}handleBeforeHeaderCellDestroy(e,t){var n;(n=t.column.header)!=null&&n.menu&&t.node.querySelectorAll(".slick-header-menu-button").forEach(s=>s.remove())}handleBodyMouseDown(e){if(this.menuElement){let t=!1;const r=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||r)&&(t=!0),(this._menuElm!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&r)&&this.hideMenu()}}handleMenuItemCommandClick(e,t,r,n=0,s){var a;if(r!=="divider"&&!r.disabled&&!r.divider)if((r.command||"")&&!r.commandItems){const c={grid:this.grid,command:r.command,column:s,item:r};this.executeHeaderMenuInternalCommands(e,c),this.pubSubService.publish("onHeaderMenuCommand",c),typeof((a=this.addonOptions)==null?void 0:a.onCommand)=="function"&&this.addonOptions.onCommand(e,c),typeof r.action=="function"&&r.action.call(this,e,c),e.defaultPrevented||this.hideMenu(),e.preventDefault(),e.stopPropagation()}else r.commandItems&&this.repositionSubMenu(e,r,n,s)}handleMenuItemMouseOver(e,t,r,n=0,s){r!=="divider"&&!r.disabled&&!r.divider&&(r.commandItems?this.repositionSubMenu(e,r,n,s):n===0&&this.disposeSubMenus())}addHeaderMenuCustomCommands(e){const t=this.sharedService.gridOptions,r=t.headerMenu||{},n=Kn(t);return Array.isArray(e)&&t.enableHeaderMenu&&e.forEach(s=>{var a,o;if(s&&!s.excludeFromHeaderMenu){s.header?s.header.menu||(s.header.menu={commandItems:[]}):s.header={menu:{commandItems:[]}};const c=((o=(a=s==null?void 0:s.header)==null?void 0:a.menu)==null?void 0:o.commandItems)??[];let h=!1;r&&!r.hideFreezeColumnsCommand&&(h=!0,c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="freeze-columns")||c.push({iconCssClass:r.iconFreezeColumns||"fa fa-thumb-tack",titleKey:`${n}FREEZE_COLUMNS`,command:"freeze-columns",positionOrder:47})),r&&!r.hideColumnResizeByContentCommand&&this.sharedService.gridOptions.enableColumnResizeOnDoubleClick&&(h=!0,c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="column-resize-by-content")||c.push({iconCssClass:r.iconColumnResizeByContentCommand||"fa fa-arrows-h",titleKey:`${n}COLUMN_RESIZE_BY_CONTENT`,command:"column-resize-by-content",positionOrder:48})),h&&!c.some(l=>l!=="divider"&&l.positionOrder===49)&&c.push({divider:!0,command:"",positionOrder:49}),t.enableSorting&&s.sortable&&r&&!r.hideSortCommands&&(c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="sort-asc")||c.push({iconCssClass:r.iconSortAscCommand||"fa fa-sort-asc",titleKey:`${n}SORT_ASCENDING`,command:"sort-asc",positionOrder:50}),c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="sort-desc")||c.push({iconCssClass:r.iconSortDescCommand||"fa fa-sort-desc",titleKey:`${n}SORT_DESCENDING`,command:"sort-desc",positionOrder:51}),c.some(l=>l!=="divider"&&l.positionOrder===52)||c.push({divider:!0,command:"",positionOrder:52}),!r.hideClearSortCommand&&!c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="clear-sort")&&c.push({iconCssClass:r.iconClearSortCommand||"fa fa-unsorted",titleKey:`${n}REMOVE_SORT`,command:"clear-sort",positionOrder:54})),t.enableFiltering&&s.filterable&&r&&!r.hideFilterCommand&&!r.hideClearFilterCommand&&!c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="clear-filter")&&c.push({iconCssClass:r.iconClearFilterCommand||"fa fa-filter",titleKey:`${n}REMOVE_FILTER`,command:"clear-filter",positionOrder:53}),r&&!r.hideColumnHideCommand&&!c.some(l=>l!=="divider"&&(l==null?void 0:l.command)==="hide-column")&&c.push({iconCssClass:r.iconColumnHideCommand||"fa fa-times",titleKey:`${n}HIDE_COLUMN`,command:"hide-column",positionOrder:55}),this.extensionUtility.translateMenuItemsFromTitleKey(c),this.extensionUtility.sortItems(c,"positionOrder")}}),r}clearColumnFilter(e,t){t!=null&&t.column&&this.filterService.clearFilterByColumnId(e,t.column.id)}clearColumnSort(e,t){t!=null&&t.column&&this.sharedService&&this.sortService.clearSortByColumnId(e,t.column.id)}executeHeaderMenuInternalCommands(e,t){var r;if(t!=null&&t.command)switch(t.command){case"hide-column":this.hideColumn(t.column),(r=this.sharedService.gridOptions)!=null&&r.enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"clear-filter":this.clearColumnFilter(e,t);break;case"clear-sort":this.clearColumnSort(e,t);break;case"column-resize-by-content":this.pubSubService.publish("onHeaderMenuColumnResizeByContent",{columnId:t.column.id});break;case"freeze-columns":const n=[...this.sharedService.visibleColumns],a={frozenColumn:n.findIndex(l=>l.id===t.column.id),enableMouseWheelScrollHandler:!0},o=this.sharedService.slickGrid.getColumns();this.sharedService.slickGrid.setOptions(a,!1,!0),this.sharedService.gridOptions.frozenColumn=a.frozenColumn,this.sharedService.gridOptions.enableMouseWheelScrollHandler=a.enableMouseWheelScrollHandler,this.sharedService.frozenVisibleColumnId=t.column.id,this.sharedService.hasColumnsReordered||Array.isArray(n)&&Array.isArray(this.sharedService.allColumns)&&n.length!==this.sharedService.allColumns.length?this.sharedService.slickGrid.setColumns(n):this.sharedService.slickGrid.setColumns(o),this.sharedService.slickGrid.getOptions().enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"sort-asc":case"sort-desc":const h=t.command==="sort-asc";this.sortColumn(e,t,h);break}}createParentMenu(e,t,r){var s,a,o,c,h;const n={grid:this.grid,column:t,menu:r};typeof e.stopPropagation=="function"&&(this.pubSubService.publish("onHeaderMenuBeforeMenuShow",n),typeof((s=this.addonOptions)==null?void 0:s.onBeforeMenuShow)=="function"&&((a=this.addonOptions)==null?void 0:a.onBeforeMenuShow(e,n))===!1)||(this._menuElm=this.createCommandMenu(r.commandItems,t),(o=this.grid.getContainerNode())==null||o.appendChild(this._menuElm),this.repositionMenu(e,this._menuElm),this.pubSubService.publish("onHeaderMenuAfterMenuShow",n),!(typeof((c=this.addonOptions)==null?void 0:c.onAfterMenuShow)=="function"&&((h=this.addonOptions)==null?void 0:h.onAfterMenuShow(e,n))===!1)&&(e.preventDefault(),e.stopPropagation()))}createCommandMenu(e,t,r=0,n){const s=n==null?void 0:n.command;let a=r===1&&s?s.replace(/\s/g,""):"";a&&(this._subMenuParentId=a),r>1&&(a=this._subMenuParentId);const o=`${this.menuCssClass} slick-menu-level-${r} ${this.gridUid}`,c=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${r}${this.gridUidSelector}`);if(c){if(c.dataset.subMenuParent===a)return c;this.disposeSubMenus()}const h=K("div",{ariaExpanded:"true",ariaLabel:r>1?"SubMenu":"Header Menu",role:"menu",className:o,style:{minWidth:`${this.addonOptions.minWidth}px`}});r>0&&(h.classList.add("slick-submenu"),a&&(h.dataset.subMenuParent=a));const l=K("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},h),u={grid:this.grid,column:t,level:r,menu:{commandItems:e}};return n&&r>0&&this.addSubMenuTitleWhenExists(n,l),this.populateCommandOrOptionItems("command",this.addonOptions,l,e,u,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),r++,h}resetHeaderMenuTranslations(e){e.forEach(t=>{var r,n;if((n=(r=t==null?void 0:t.header)==null?void 0:r.menu)!=null&&n.commandItems&&!t.excludeFromHeaderMenu){const s=t.header.menu.commandItems||[];this.extensionUtility.translateMenuItemsFromTitleKey(s)}})}sortColumn(e,t,r=!0){if(t!=null&&t.column){const n=t.column,s=this.sharedService.gridOptions.multiColumnSort?this.sortService.getCurrentColumnSorts(n.id+""):[];let a=ri.local;s.push({columnId:n.id,sortCol:n,sortAsc:r}),this.sharedService.gridOptions.backendServiceApi?(this.sortService.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:s,grid:this.sharedService.slickGrid}),a=ri.remote):this.sharedService.dataView?(this.sortService.onLocalSortChanged(this.sharedService.slickGrid,s),a=ri.local):t.grid.onSort.notify(s);const o=s.map(c=>{var h;return{columnId:((h=c==null?void 0:c.sortCol)==null?void 0:h.id)??"",sortAsc:(c==null?void 0:c.sortAsc)??!0}});if(this.sharedService.slickGrid.setSortColumns(o),a){const c=[];o.forEach(h=>{c.push({columnId:`${h.columnId}`,direction:h.sortAsc?"ASC":"DESC"})}),this.sortService.emitSortChanged(a,c)}}}}const rc="slick-rbe-editmode",Qx="slick-rbe-unsaved-cell",np="slick-rbe-unsaved-highlight",wu="action-btns--delete",Cu="action-btns--edit",yu="action-btns--update",Su="action-btns--cancel";class sp{constructor(e,t,r){this.extensionUtility=e,this.pubSubService=t,this.pluginName="RowBasedEdit",this._defaults={actionsColumnLabel:"Actions",allowMultipleRows:!1,columnId:"_slick_rowbasededit_action",columnIndexPosition:-1,reorderable:!1},this._editedRows=new Map,this._currentLang="en",this._translations={},this.onBeforeEditCellHandler=(n,s)=>{var a;return this._editedRows.has((a=s.item)==null?void 0:a[this.gridOptions.datasetIdPropertyName??"id"])},this._eventHandler=new di,this._addonOptions=r}get addonOptions(){return this._addonOptions}get gridOptions(){return this._grid.getOptions()||{}}get eventHandler(){return this._eventHandler}init(e,t){var s,a;this._grid=e,this._gridService=t,this._addonOptions={...this._defaults,...this.addonOptions};const r=this._grid.getData();if(this._eventHandler.subscribe(this._grid.onBeforeEditCell,this.onBeforeEditCellHandler),this.checkOptionsRequirements(this.gridOptions),this.gridOptions.autoEdit||(this._grid.setOptions({autoEdit:!0}),console.warn('[Slickgrid-Universal] The Row Based Edit Plugin works best with the gridOption "autoEdit" enabled, the option has now been set automatically for you.')),this._existingEditCommandHandler=this.gridOptions.editCommandHandler,this._grid.setOptions({editCommandHandler:this.rowBasedEditCommandHandler.bind(this)}),this.gridOptions.enableExcelCopyBuffer===!0){const o=(s=this.gridOptions.excelCopyBufferOptions)==null?void 0:s.onBeforePasteCell;this._grid.setOptions({excelCopyBufferOptions:{...this.gridOptions.excelCopyBufferOptions,onBeforePasteCell:(c,h)=>{let l=!0;if(o&&(l=o(c,h),l===!1))return!1;const u=r.getItem(h.row),d=this.gridOptions.datasetIdPropertyName??"id";return!!(this._editedRows.has(u[d])&&l===!0)}}})}const n=r.getItemMetadata;r.getItemMetadata=this.updateItemMetadata((a=n==null?void 0:n.bind)==null?void 0:a.call(n,r)),this._eventHandler.subscribe(this._grid.onSetOptions,this.optionsUpdatedHandler.bind(this)),this._eventHandler.subscribe(r.onRowsOrCountChanged,this.handleAllRowRerender.bind(this)),this.translate()}destroy(){this.dispose()}dispose(){var e,t;(e=this._eventHandler)==null||e.unsubscribeAll(),(t=this.pubSubService)==null||t.unsubscribeAll()}create(e,t){var r;if(this._addonOptions={...this._defaults,...t.rowBasedEditOptions},Array.isArray(e)&&t){const n=this.getColumnDefinition();if(!e.some(s=>s.id===n.id)){const s=((r=t==null?void 0:t.rowBasedEditOptions)==null?void 0:r.columnIndexPosition)??-1;s===-1?e.push(n):s>0&&s<e.length?e.splice(s,0,n):e.unshift(n),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){var t,r,n,s;return{id:String(((t=this._addonOptions)==null?void 0:t.columnId)??this._defaults.columnId),name:(r=this._addonOptions)==null?void 0:r.actionsColumnLabel,field:"action",minWidth:70,width:75,maxWidth:75,excludeFromExport:!0,reorderable:(n=this._addonOptions)==null?void 0:n.reorderable,formatter:this.actionColumnFormatter.bind(this),onCellClick:this.onCellClickHandler.bind(this),...((s=this._addonOptions)==null?void 0:s.actionColumnConfig)??{}}}rowBasedEditCommandHandler(e,t,r){var u;this._existingEditCommandHandler&&this._existingEditCommandHandler(e,t,r);const n=Array.isArray(r.prevSerializedValue)?r.prevSerializedValue:[r.prevSerializedValue],s=Array.isArray(r.serializedValue)?r.serializedValue:[r.serializedValue],a=(u=this._gridService)==null?void 0:u.getAllColumnDefinitions().filter(d=>d.editor!==void 0),o=[],c=this.gridOptions.datasetIdPropertyName??"id";n.forEach((d,f)=>{const p=n[f],m=s[f];if(p!==m||m===""){const v=Array.isArray(r.prevSerializedValue)?a==null?void 0:a[f]:t;if(!v)return;this._grid.invalidate(),r.execute(),this.renderUnsavedCellStyling(e[c],v),o.push(v)}});const h=this._editedRows.get(e[c]),l=[...(h==null?void 0:h.editCommands)||[]];o.length>0&&l.push(r),this._editedRows.set(e[c],{columns:[...(h==null?void 0:h.columns)||[],...o],editCommands:l,cssStyleKeys:(h==null?void 0:h.cssStyleKeys)||[]})}translate(e=!1){var t;return this._currentLang=((t=this.extensionUtility.translaterService)==null?void 0:t.getCurrentLanguage())??"en",(!this._translations[this._currentLang]||e)&&(this._translations[this._currentLang]={btnUpdateTitle:this.getTitleOrDefault("updateButtonTitle","Update the row"),btnEditTitle:this.getTitleOrDefault("editButtonTitle","Edit the Row"),btnDeleteTitle:this.getTitleOrDefault("deleteButtonTitle","Delete the Row"),btnCancelTitle:this.getTitleOrDefault("cancelButtonTitle","Cancel changes of the Row")}),this._translations[this._currentLang]}checkOptionsRequirements(e){if(!(e!=null&&e.enableCellNavigation))throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption cell navigation (enableCellNavigation = true)");if(!(e!=null&&e.editable))throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption editable (editable = true)")}undoRowEdit(e){const t=this.gridOptions.datasetIdPropertyName??"id",r=this._editedRows.get(e[t]),n=this._grid.getData().getRowByItem(e);if(n!==void 0&&(r!=null&&r.editCommands)&&r.editCommands.length||Bc.cancelCurrentEdit()){for(;r.editCommands.length>0;){const s=r.editCommands.pop();s&&s.undo()}r.columns.forEach(s=>{this.removeUnsavedStylingFromCell(s,n)}),r.columns=[],this._grid.invalidate()}}renderUnsavedCellStyling(e,t){var r,n;if(t){const s=(r=this._grid.getData())==null?void 0:r.getRowById(e);if(s!==void 0&&s>=0){const a={[s]:{[t.id]:Qx}},o=`${np}_${[t.id]}${s}`;this._grid.setCellCssStyles(o,a),(n=this._editedRows.get(e))==null||n.cssStyleKeys.push(o)}}}handleAllRowRerender(e,t){this._editedRows.forEach((r,n)=>{r.cssStyleKeys.forEach(s=>{this._grid.removeCellCssStyles(s)}),r.cssStyleKeys=[],r.columns.forEach(s=>{this.renderUnsavedCellStyling(n,s)})})}removeUnsavedStylingFromCell(e,t){const r=`${np}_${[e.id]}${t}`;this._grid.removeCellCssStyles(r)}removeUnsavedStylingFromRow(e){this._grid.getColumns().forEach(t=>{this.removeUnsavedStylingFromCell(t,e)})}optionsUpdatedHandler(e,t){this._addonOptions={...this._defaults,...t.optionsAfter.rowBasedEditOptions}}async onCellClickHandler(e,t){var o,c,h,l,u,d,f,p,m,v,_,x,E,C,y;const r=t.dataContext,n=e.target,s=this.gridOptions.datasetIdPropertyName??"id",a=this._editedRows.get(r[s]);if((n.classList.contains(wu)||(o=n.parentElement)!=null&&o.classList.contains(wu))&&this._gridService){if((h=(c=this._addonOptions)==null?void 0:c.actionButtons)!=null&&h.deleteButtonPrompt&&!window.confirm(this._addonOptions.actionButtons.deleteButtonPrompt))return;this.toggleEditmode(r,!1),this._gridService.deleteItem(r)}else if(n.classList.contains(Cu)||(l=n.parentElement)!=null&&l.classList.contains(Cu)){if(!((u=this._addonOptions)!=null&&u.allowMultipleRows)&&this._editedRows.size>0)return;typeof((d=this._addonOptions)==null?void 0:d.onBeforeEditMode)=="function"&&this._addonOptions.onBeforeEditMode(t),this.toggleEditmode(r,!0)}else if(n.classList.contains(yu)||(f=n.parentElement)!=null&&f.classList.contains(yu)){if((m=(p=this._addonOptions)==null?void 0:p.actionButtons)!=null&&m.updateButtonPrompt&&((a==null?void 0:a.editCommands.length)||0)>0&&!window.confirm(this._addonOptions.actionButtons.updateButtonPrompt)||(this._grid.getCellEditor()&&((v=this._grid.getActiveCell())==null?void 0:v.row)===t.row&&((_=this._grid.getEditController())==null||_.commitCurrentEdit()),(x=this._addonOptions)!=null&&x.onBeforeRowUpdated&&await this._addonOptions.onBeforeRowUpdated(t)!==!0))return;this.removeUnsavedStylingFromRow(t.row),this.toggleEditmode(r,!1)}else if(n.classList.contains(Su)||(E=n.parentElement)!=null&&E.classList.contains(Su)){if((y=(C=this._addonOptions)==null?void 0:C.actionButtons)!=null&&y.cancelButtonPrompt&&((a==null?void 0:a.editCommands.length)||0)>0&&!window.confirm(this._addonOptions.actionButtons.cancelButtonPrompt))return;this.undoRowEdit(r),this.toggleEditmode(r,!1)}}actionColumnFormatter(e,t,r,n,s){var l,u,d,f,p,m,v,_,x,E,C,y,b,T,R,O;const a=this.gridOptions,o=this._editedRows.has(s==null?void 0:s[a.datasetIdPropertyName??"id"]),c=this._translations[this._currentLang]??this.translate(),h=document.createDocumentFragment();return h.appendChild(K("span",{className:`${((u=(l=a.rowBasedEditOptions)==null?void 0:l.actionButtons)==null?void 0:u.editButtonClassName)||"button-style padding-1px mr-2"} action-btns `+Cu,title:c.btnEditTitle,style:{display:o?"none":""}})).appendChild(K("span",{className:((f=(d=a.rowBasedEditOptions)==null?void 0:d.actionButtons)==null?void 0:f.iconEditButtonClassName)||"mdi mdi-table-edit color-primary"})),h.appendChild(K("span",{className:`${((m=(p=a.rowBasedEditOptions)==null?void 0:p.actionButtons)==null?void 0:m.deleteButtonClassName)||"button-style padding-1px"} action-btns `+wu,title:c.btnDeleteTitle,style:{display:o?"none":""}})).appendChild(K("span",{className:((_=(v=a.rowBasedEditOptions)==null?void 0:v.actionButtons)==null?void 0:_.iconDeleteButtonClassName)||"mdi mdi-close color-danger"})),h.appendChild(K("span",{className:`${((E=(x=a.rowBasedEditOptions)==null?void 0:x.actionButtons)==null?void 0:E.updateButtonClassName)||"button-style padding-1px mr-2"} action-btns `+yu,title:c.btnUpdateTitle,style:{display:o?"":"none"}})).appendChild(K("span",{className:((y=(C=a.rowBasedEditOptions)==null?void 0:C.actionButtons)==null?void 0:y.iconUpdateButtonClassName)||"mdi mdi-check-bold color-success"})),h.appendChild(K("span",{className:`${((T=(b=a.rowBasedEditOptions)==null?void 0:b.actionButtons)==null?void 0:T.cancelButtonClassName)||"button-style padding-1px"} action-btns `+Su,title:c.btnCancelTitle,style:{display:o?"":"none"}})).appendChild(K("span",{className:((O=(R=a.rowBasedEditOptions)==null?void 0:R.actionButtons)==null?void 0:O.iconCancelButtonClassName)||"mdi mdi-cancel color-danger"})),h}toggleEditmode(e,t){const r=this.gridOptions.datasetIdPropertyName??"id";t?this._editedRows.set(e[r],{columns:[],editCommands:[],cssStyleKeys:[]}):this._editedRows.delete(e[r]),this._grid.invalidate()}updateItemMetadata(e){return t=>{const r=this._grid.getData().getItem(t);let n={cssClasses:""};if(typeof e=="function"){const s=e(t);s&&(n=s)}if(n&&r){const s=this.gridOptions.datasetIdPropertyName??"id";this._editedRows.has(r[s])&&!n.cssClasses.includes(rc)?n.cssClasses=(n.cssClasses||"")+" "+rc:!this._editedRows.has(r[s])&&n.cssClasses.includes(rc)&&(n.cssClasses=n.cssClasses.replace(rc,""))}return n}}getTitleOrDefault(e,t){var n,s,a;const r=(n=this.gridOptions.rowBasedEditOptions)==null?void 0:n.actionButtons;return(r==null?void 0:r[e+"Key"])&&((a=(s=this.extensionUtility.translaterService)==null?void 0:s.translate)==null?void 0:a.call(s,(r==null?void 0:r[e+"Key"])||""))||(r==null?void 0:r[e])||t}}class ap{constructor(e){this.pubSubService=e,this.onBeforeMoveRows=new ze("onBeforeMoveRows"),this.onMoveRows=new ze("onMoveRows"),this.pluginName="RowMoveManager",this._dragging=!1,this._defaults={autoScroll:!0,columnId:"_move",cssClass:"slick-row-move-column",cancelEditOnDrag:!1,disableRowSelection:!1,hideRowMoveShadow:!0,reorderable:!1,rowMoveShadowMarginTop:0,rowMoveShadowMarginLeft:0,rowMoveShadowOpacity:.9,rowMoveShadowScale:.75,singleRowMove:!1,width:40},this._eventHandler=new di}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}init(e,t){var r;this._addonOptions={...this._defaults,...t},this._grid=e,this._canvas=this._grid.getCanvasNode(),oe.addSlickEventPubSubWhenDefined(this.pubSubService,this),typeof((r=this._addonOptions)==null?void 0:r.usabilityOverride)=="function"&&this.usabilityOverride(this._addonOptions.usabilityOverride),this._eventHandler.subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this))}dispose(){var e;(e=this._eventHandler)==null||e.unsubscribeAll()}create(e,t){var r;if(this._addonOptions={...this._defaults,...t.rowMoveManager},Array.isArray(e)&&t){const n=this.getColumnDefinition();if(!e.some(s=>s.id===n.id)){const s=Array.isArray(e)&&e.find(c=>(c==null?void 0:c.behavior)==="selectAndMove"),a=s||n,o=((r=t==null?void 0:t.rowMoveManager)==null?void 0:r.columnIndexPosition)??0;o>0?e.splice(o,0,a):e.unshift(a),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){var t;const e=String(((t=this._addonOptions)==null?void 0:t.columnId)??this._defaults.columnId);return{id:e,name:"",behavior:"selectAndMove",excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,field:e,reorderable:this._addonOptions.reorderable,resizable:!1,selectable:!1,width:this._addonOptions.width||40,formatter:this.moveIconFormatter.bind(this)}}usabilityOverride(e){this._usabilityOverride=e}setOptions(e){this._addonOptions={...this._addonOptions,...e}}handleDragInit(e){e.stopImmediatePropagation()}handleDragEnd(e,t){var r,n,s;if(this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),(r=t.guide)==null||r.remove(),(n=t.selectionProxy)==null||n.remove(),(s=t.clonedSlickRow)==null||s.remove(),t.canMove)){const a={grid:this._grid,rows:t.selectedRows,insertBefore:t.insertBefore};typeof this._addonOptions.onMoveRows=="function"&&this._addonOptions.onMoveRows(e instanceof Yt?e.getNativeEvent():e,a),this.onMoveRows.notify(a)}}handleDrag(e,t){var r,n,s,a;if(this._dragging){e.stopImmediatePropagation();const o=e.getNativeEvent(),h=(((r=o==null?void 0:o.touches)==null?void 0:r[0])??o).pageY-(((n=xi(this._canvas))==null?void 0:n.top)??0);t.selectionProxy.style.top=`${h-5}px`,t.selectionProxy.style.display="block",t.clonedSlickRow&&(t.clonedSlickRow.style.top=`${h-6}px`,t.clonedSlickRow.style.display="block");const l=Math.max(0,Math.min(Math.round(h/(this.gridOptions.rowHeight||0)),this._grid.getDataLength()));if(l!==t.insertBefore){const u={grid:this._grid,rows:t.selectedRows,insertBefore:l};if(((a=(s=this._addonOptions)==null?void 0:s.onBeforeMoveRows)==null?void 0:a.call(s,o,u))===!1||this.onBeforeMoveRows.notify(u).getReturnValue()===!1?t.canMove=!1:t.canMove=!0,this._usabilityOverride&&t.canMove){const d=this._grid.getDataItem(l);t.canMove=this.checkUsabilityOverride(l,d,this._grid)}t.canMove?t.guide.style.top=`${l*(this.gridOptions.rowHeight||0)}px`:t.guide.style.top="-1000px",t.insertBefore=l}}}handleDragStart(e,t){var a,o,c,h,l;const r=this._grid.getCellFromEvent(e)||{cell:-1,row:-1},n=r.row,s=this._grid.getDataItem(n);if(this.checkUsabilityOverride(n,s,this._grid)){if(this._addonOptions.cancelEditOnDrag&&this._grid.getEditorLock().isActive()&&this._grid.getEditorLock().cancelCurrentEdit(),this._grid.getEditorLock().isActive()||!/move|selectAndMove/.test(this._grid.getColumns()[r.cell].behavior||""))return!1;if(this._dragging=!0,e.stopImmediatePropagation(),!this.addonOptions.hideRowMoveShadow){const f=(a=this._grid.getCellNode(r.row,r.cell))==null?void 0:a.closest(".slick-row");f&&(t.clonedSlickRow=f.cloneNode(!0),t.clonedSlickRow.classList.add("slick-reorder-shadow-row"),t.clonedSlickRow.style.display="none",t.clonedSlickRow.style.marginLeft=as((o=this._addonOptions)==null?void 0:o.rowMoveShadowMarginLeft,"0px"),t.clonedSlickRow.style.marginTop=as((c=this._addonOptions)==null?void 0:c.rowMoveShadowMarginTop,"0px"),t.clonedSlickRow.style.opacity=`${((h=this._addonOptions)==null?void 0:h.rowMoveShadowOpacity)??.95}`,t.clonedSlickRow.style.transform=`scale(${((l=this.addonOptions)==null?void 0:l.rowMoveShadowScale)??.75})`,this._canvas.appendChild(t.clonedSlickRow))}let u=this._addonOptions.singleRowMove?[r.row]:this._grid.getSelectedRows();(u.length===0||!u.some(f=>f===r.row))&&(u=[r.row],this._addonOptions.disableRowSelection||this._grid.setSelectedRows(u));const d=this.gridOptions.rowHeight;t.selectedRows=u,t.selectionProxy=K("div",{className:"slick-reorder-proxy",style:{display:"none",position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,height:`${d*u.length}px`}},this._canvas),t.guide=K("div",{className:"slick-reorder-guide",style:{position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,top:"-1000px"}},this._canvas),t.insertBefore=-1}}checkUsabilityOverride(e,t,r){return typeof this._usabilityOverride=="function"?this._usabilityOverride(e,t,r):!0}moveIconFormatter(e,t,r,n,s,a){return this.checkUsabilityOverride(e,s,a)?{addClasses:`cell-reorder dnd ${this._addonOptions.cssClass||""}`,html:K("div",{className:this._addonOptions.cssClass||""})}:""}}class Zx{get extensionList(){return this._extensionList}get gridOptions(){return this.sharedService.gridOptions||{}}constructor(e,t,r,n,s,a,o,c){this.extensionUtility=e,this.filterService=t,this.pubSubService=r,this.sharedService=n,this.sortService=s,this.treeDataService=a,this.translaterService=o,this.lazyGridService=c,this._extensionCreatedList={},this._extensionList={}}dispose(){if(this.sharedService.visibleColumns=[],typeof this._extensionList=="object"){const e=Object.keys(this._extensionList);e.forEach(t=>{var r;if(this._extensionList.hasOwnProperty(t)){const n=this._extensionList[t];typeof((r=n==null?void 0:n.instance)==null?void 0:r.dispose)=="function"&&n.instance.dispose()}}),e.forEach(t=>{delete this._extensionList[t]})}this._cellMenuPlugin=null,this._cellExcelCopyManagerPlugin=null,this._checkboxSelectColumn=null,this._contextMenuPlugin=null,this._columnPickerControl=null,this._draggleGroupingPlugin=null,this._gridMenuControl=null,this._groupItemMetadataProviderService=null,this._headerMenuPlugin=null,this._rowMoveManagerPlugin=null,this._rowSelectionModel=null,this._extensionCreatedList=null,this._extensionList=null}addExtensionToList(e,t){this._extensionList[e]=t}getAllColumns(){return this.sharedService.allColumns||[]}getVisibleColumns(){return this.sharedService.visibleColumns||[]}getCreatedExtensionByName(e){var t;if((t=this._extensionCreatedList)!=null&&t.hasOwnProperty(e))return this._extensionCreatedList[e]}getExtensionByName(e){var t;return(t=this._extensionList)==null?void 0:t[e]}getExtensionInstanceByName(e){var t;return(t=this.getExtensionByName(e))==null?void 0:t.instance}autoResizeColumns(){this.sharedService.slickGrid.autosizeColumns()}bindDifferentExtensions(){var e,t,r,n,s,a,o,c,h,l,u,d,f;if(this.gridOptions){if(this.gridOptions.enableTranslate&&this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.gridOptions.enableRowBasedEdit){this._rowBasedEdit=this._rowBasedEdit||new sp(this.extensionUtility,this.pubSubService,this.gridOptions.rowBasedEditOptions);const p=(e=this.lazyGridService)==null?void 0:e.call(this);if(!p)throw new Error("[Slickgrid-Universal] the RowBasedEdit Plugin requires a GridService to be configured and available");this._rowBasedEdit.init(this.sharedService.slickGrid,p),(t=this.gridOptions.rowBasedEditOptions)!=null&&t.onExtensionRegistered&&this.gridOptions.rowBasedEditOptions.onExtensionRegistered(this._rowBasedEdit),this._extensionList[xt.rowBasedEdit]={name:xt.rowBasedEdit,instance:this._rowBasedEdit}}if(this.gridOptions.enableAutoTooltip){const p=new Hx((r=this.gridOptions)==null?void 0:r.autoTooltipOptions);this.sharedService.slickGrid.registerPlugin(p),this._extensionList[xt.autoTooltip]={name:xt.autoTooltip,instance:p}}if(this.gridOptions.enableExcelCopyBuffer&&(this._cellExcelCopyManagerPlugin=new Vx,this._cellExcelCopyManagerPlugin.init(this.sharedService.slickGrid,this.sharedService.gridOptions.excelCopyBufferOptions),(n=this.gridOptions.excelCopyBufferOptions)!=null&&n.onExtensionRegistered&&this.gridOptions.excelCopyBufferOptions.onExtensionRegistered(this._cellExcelCopyManagerPlugin),this._extensionList[xt.cellExternalCopyManager]={name:xt.cellExternalCopyManager,instance:this._cellExcelCopyManagerPlugin}),this.gridOptions.enableCellMenu&&(this._cellMenuPlugin=new zx(this.extensionUtility,this.pubSubService,this.sharedService),(s=this.gridOptions.cellMenu)!=null&&s.onExtensionRegistered&&this.gridOptions.cellMenu.onExtensionRegistered(this._cellMenuPlugin),this._extensionList[xt.cellMenu]={name:xt.cellMenu,instance:this._cellMenuPlugin}),!this._rowSelectionModel&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowDetailView||this.gridOptions.enableRowMoveManager)){if(!this._rowSelectionModel||!this.sharedService.slickGrid.getSelectionModel()){const p=this.gridOptions.rowSelectionOptions??{};this.gridOptions.enableRowMoveManager&&((a=this.gridOptions.rowMoveManager)==null?void 0:a.dragToSelect)!==!1&&(p.dragToSelect=!0),this._rowSelectionModel=new Ud(p),this.sharedService.slickGrid.setSelectionModel(this._rowSelectionModel)}this._extensionList[xt.rowSelection]={name:xt.rowSelection,instance:this._rowSelectionModel}}if(this.gridOptions.enableCheckboxSelector){this._checkboxSelectColumn=this._checkboxSelectColumn||new ip(this.pubSubService,this.gridOptions.checkboxSelector),this._checkboxSelectColumn.init(this.sharedService.slickGrid);const p=this.getCreatedExtensionByName(xt.checkboxSelector),m=p==null?void 0:p.instance;m&&((o=this.gridOptions.checkboxSelector)!=null&&o.onExtensionRegistered&&this.gridOptions.checkboxSelector.onExtensionRegistered(m),this._extensionList[xt.checkboxSelector]={name:xt.checkboxSelector,instance:this._checkboxSelectColumn})}if(this.gridOptions.enableColumnPicker&&(this._columnPickerControl=new Wd(this.extensionUtility,this.pubSubService,this.sharedService),(c=this.gridOptions.columnPicker)!=null&&c.onExtensionRegistered&&this.gridOptions.columnPicker.onExtensionRegistered(this._columnPickerControl),this._extensionList[xt.columnPicker]={name:xt.columnPicker,instance:this._columnPickerControl}),this.gridOptions.enableContextMenu&&(this._contextMenuPlugin=new Xx(this.extensionUtility,this.pubSubService,this.sharedService,this.treeDataService),(h=this.gridOptions.contextMenu)!=null&&h.onExtensionRegistered&&this.gridOptions.contextMenu.onExtensionRegistered(this._contextMenuPlugin),this._extensionList[xt.contextMenu]={name:xt.contextMenu,instance:this._contextMenuPlugin}),this.gridOptions.enableDraggableGrouping&&(this._draggleGroupingPlugin&&(this._draggleGroupingPlugin.init(this.sharedService.slickGrid,this.gridOptions.draggableGrouping),(l=this.gridOptions.draggableGrouping)!=null&&l.onExtensionRegistered&&this.gridOptions.draggableGrouping.onExtensionRegistered(this._draggleGroupingPlugin),this._extensionList[xt.contextMenu]={name:xt.contextMenu,instance:this._draggleGroupingPlugin}),this._extensionList[xt.draggableGrouping]={name:xt.draggableGrouping,instance:this._draggleGroupingPlugin}),this.gridOptions.enableGridMenu&&(this._gridMenuControl=new Tg(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),(u=this.gridOptions.gridMenu)!=null&&u.onExtensionRegistered&&this.gridOptions.gridMenu.onExtensionRegistered(this._gridMenuControl),this._extensionList[xt.gridMenu]={name:xt.gridMenu,instance:this._gridMenuControl}),this.gridOptions.enableHeaderButton){const p=new Kx(this.extensionUtility,this.pubSubService,this.sharedService);(d=this.gridOptions.headerButton)!=null&&d.onExtensionRegistered&&this.gridOptions.headerButton.onExtensionRegistered(p),this._extensionList[xt.headerButton]={name:xt.headerButton,instance:p}}if(this.gridOptions.enableHeaderMenu&&(this._headerMenuPlugin=new jx(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),(f=this.gridOptions.headerMenu)!=null&&f.onExtensionRegistered&&this.gridOptions.headerMenu.onExtensionRegistered(this._headerMenuPlugin),this._extensionList[xt.headerMenu]={name:xt.headerMenu,instance:this._headerMenuPlugin}),this.gridOptions.enableRowMoveManager){this._rowMoveManagerPlugin=this._rowMoveManagerPlugin||new ap(this.pubSubService),this._rowMoveManagerPlugin.init(this.sharedService.slickGrid,this.gridOptions.rowMoveManager);const p=this.getCreatedExtensionByName(xt.rowMoveManager);(p==null?void 0:p.instance)&&(this._extensionList[xt.rowMoveManager]={name:xt.rowMoveManager,instance:this._rowMoveManagerPlugin})}}}createExtensionsBeforeGridCreation(e,t){var n,s,a;const r=[];t.enableCheckboxSelector&&(this.getCreatedExtensionByName(xt.checkboxSelector)||(this._checkboxSelectColumn=new ip(this.pubSubService,this.sharedService.gridOptions.checkboxSelector),r.push({name:xt.checkboxSelector,extension:this._checkboxSelectColumn,columnIndexPosition:((n=t==null?void 0:t.checkboxSelector)==null?void 0:n.columnIndexPosition)??r.length}))),t.enableRowMoveManager&&(this.getCreatedExtensionByName(xt.rowMoveManager)||(this._rowMoveManagerPlugin=new ap(this.pubSubService),r.push({name:xt.rowMoveManager,extension:this._rowMoveManagerPlugin,columnIndexPosition:((s=t==null?void 0:t.rowMoveManager)==null?void 0:s.columnIndexPosition)??r.length}))),t.enableRowBasedEdit&&(this.getCreatedExtensionByName(xt.rowBasedEdit)||(this._rowBasedEdit=new sp(this.extensionUtility,this.pubSubService),r.push({name:xt.rowBasedEdit,extension:this._rowBasedEdit,columnIndexPosition:((a=t==null?void 0:t.rowMoveManager)==null?void 0:a.columnIndexPosition)??r.length}))),this.createExtensionByTheirColumnIndex(r,e,t),t.enableDraggableGrouping&&(this.getCreatedExtensionByName(xt.draggableGrouping)||(this._draggleGroupingPlugin=new qx(this.extensionUtility,this.pubSubService,this.sharedService),this._draggleGroupingPlugin&&(t.enableColumnReorder=this._draggleGroupingPlugin.setupColumnReorder.bind(this._draggleGroupingPlugin),this._extensionCreatedList[xt.draggableGrouping]={name:xt.draggableGrouping,instance:this._draggleGroupingPlugin})))}hideColumn(e){var t,r;if(typeof((r=(t=this.sharedService)==null?void 0:t.slickGrid)==null?void 0:r.getColumns)=="function"){const n=this.sharedService.slickGrid.getColumnIndex(e.id);this.sharedService.visibleColumns=this.removeColumnByIndex(this.sharedService.slickGrid.getColumns(),n),this.sharedService.slickGrid.setColumns(this.sharedService.visibleColumns)}}refreshBackendDataset(e){this.extensionUtility.refreshBackendDataset(e)}removeColumnByIndex(e,t){return Array.isArray(e)?e.filter((r,n)=>t!==n):e}translateAllExtensions(e){this.translateCellMenu(),this.translateContextMenu(),this.translateHeaderMenu(),this.translateRowEditPlugin(),this.translateColumnHeaders(e)}translateCellMenu(){var e;(e=this._cellMenuPlugin)==null||e.translateCellMenu()}translateColumnPicker(){var e;(e=this._columnPickerControl)==null||e.translateColumnPicker()}translateContextMenu(){var e;(e=this._contextMenuPlugin)==null||e.translateContextMenu()}translateGridMenu(){var e;(e=this._gridMenuControl)==null||e.translateGridMenu()}translateHeaderMenu(){var e;(e=this._headerMenuPlugin)==null||e.translateHeaderMenu()}translateRowEditPlugin(){var e;(e=this._rowBasedEdit)==null||e.translate()}translateColumnHeaders(e,t){var n;if(this.sharedService&&this.gridOptions&&this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');e&&((n=this.translaterService)!=null&&n.use)&&this.translaterService.getCurrentLanguage()!==e&&this.translaterService.use(e);let r=t;r||(r=this.sharedService.columnDefinitions),this.translateItems(r,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"columnGroupKey","columnGroup"),this.renderColumnHeaders(r,Array.isArray(t))}renderColumnHeaders(e,t=!1){var n;let r=e;r||(r=this.sharedService.columnDefinitions),Array.isArray(r)&&((n=this.sharedService.slickGrid)!=null&&n.setColumns)&&((r.length>this.sharedService.allColumns.length||t)&&(this.sharedService.allColumns=r),this.sharedService.slickGrid.setColumns(r)),this.gridOptions.enableColumnPicker&&this._columnPickerControl&&(this._columnPickerControl.columns=this.sharedService.allColumns,this._columnPickerControl.translateColumnPicker()),this.gridOptions.enableGridMenu&&this._gridMenuControl&&(this._gridMenuControl.columns=this.sharedService.allColumns??[],this._gridMenuControl.recreateGridMenu(),this._gridMenuControl.translateGridMenu())}createExtensionByTheirColumnIndex(e,t,r){e.sort((n,s)=>n.columnIndexPosition-s.columnIndexPosition),e.forEach(n=>{const s=n.extension.create(t,r);s&&(this._extensionCreatedList[n.name]={name:n.name,instance:s})})}translateItems(e,t,r){var n,s;if((n=this.gridOptions)!=null&&n.enableTranslate&&!((s=this.translaterService)!=null&&s.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.extensionUtility.translateItems(e,t,r)}}var op=Object.prototype.hasOwnProperty;function qn(i,e){var t,r;if(i===e)return!0;if(i&&e&&(t=i.constructor)===e.constructor){if(t===Date)return i.getTime()===e.getTime();if(t===RegExp)return i.toString()===e.toString();if(t===Array){if((r=i.length)===e.length)for(;r--&&qn(i[r],e[r]););return r===-1}if(!t||typeof i=="object"){r=0;for(t in i)if(op.call(i,t)&&++r&&!op.call(e,t)||!(t in e)||!qn(i[t],e[t]))return!1;return Object.keys(e).length===r}}return i!==i&&e!==e}function lp(i,e,t){if(t&&(i!=null&&i.hasOwnProperty(t)||e!=null&&e.hasOwnProperty(t)))return i[t]===e||i===e[t]||i[t]===e[t];if(typeof i=="object"&&typeof e=="object"&&Object.keys(i).length!==Object.keys(e).length)return!1;for(const r in i)if(i.hasOwnProperty(r)&&i[r]!==e[r])return!1;return!0}function Jx(i){switch(i&&i.toUpperCase()||""){case"IN":case"NIN":case"NOT_IN":case"IN_CONTAINS":case"NIN_CONTAINS":case"NOT_IN_CONTAINS":case"IN_COLLECTION":case"NOT_IN_COLLECTION":return!0;default:return!1}}const ls=(i,e,t)=>{switch(i.toUpperCase()){case"<":case"LT":return e<t;case"<=":case"LE":return e<=t;case">":case"GT":return e>t;case">=":case"GE":return e>=t;case"!=":case"<>":case"NE":return e!==t;case"=":case"==":case"EQ":return e===t;case"IN":return t&&Array.isArray(t)?t.includes(e):!1;case"NIN":case"NOT_IN":return t&&Array.isArray(t)?!t.includes(e):!1;case"IN_CONTAINS":return t&&Array.isArray(t)&&typeof e=="string"?t.some(r=>e.split(/[,]+/).map(n=>n.trim()).includes(r)):!1;case"NIN_CONTAINS":case"NOT_IN_CONTAINS":return t&&Array.isArray(t)&&typeof e=="string"?!t.some(r=>e.split(/[,]+/).map(n=>n.trim()).includes(r)):!1;case"IN_COLLECTION":return e&&t&&Array.isArray(e)&&Array.isArray(t)?t.some(r=>e.includes(r)):!1;case"NOT_IN_COLLECTION":return e&&t&&Array.isArray(e)&&Array.isArray(t)?!t.some(r=>e.includes(r)):!1}return!0},Rg=(i,e)=>{let[t,r]=e;if(t===void 0&&!i.operator)return!0;i.cellValue=i.cellValue===void 0||i.cellValue===null?"":i.cellValue.toString();const n=i!=null&&i.ignoreAccentOnStringFilterAndSort?qa(i.cellValue,!0):i.cellValue.toLowerCase();if(typeof t=="string"&&(t=i!=null&&i.ignoreAccentOnStringFilterAndSort?qa(t,!0):t.toLowerCase()),typeof r=="string"&&(r=i!=null&&i.ignoreAccentOnStringFilterAndSort?qa(r,!0):r.toLowerCase()),t!==void 0&&r!==void 0){let a=(i==null?void 0:i.operator)??i.defaultFilterRangeOperator;a!==tt.rangeInclusive&&a!==tt.rangeExclusive&&(a=i.defaultFilterRangeOperator);const o=a===tt.rangeInclusive,c=bu(o?">=":">",n,t,i.searchInputLastChar),h=bu(o?"<=":"<",n,r,i.searchInputLastChar);return c&&h}return bu(i.operator,n,t,i.searchInputLastChar)};function ew(i){const t=Array.isArray(i)&&i||[""],r=[];let n,s;if(t.length===2||typeof t[0]=="string"&&t[0].indexOf("..")>0){const a=t.length===2?t:t[0].split("..");n=`${Array.isArray(a)?a[0]:""}`,s=`${Array.isArray(a)?a[1]:""}`}else{const a=Array.isArray(i)&&i.length>0?i[0]:"";n=a==null?"":`${a}`}return n!==void 0&&s!==void 0?r.push(n,s):n!==void 0&&r.push(n),r}function bu(i,e,t,r){return i==="*"||i===tt.endsWith||i==="*z"?e.endsWith(t):i===""&&r==="*"||i===tt.startsWith||i==="a*"?e.startsWith(t):i===""||i===tt.contains?e.indexOf(t)>-1:i==="<>"||i===tt.notContains?e.indexOf(t)===-1:ls(i||"==",e,t)}const tw=(i,e)=>{if(e===void 0&&!i.operator)return!0;switch((i.operator||"").toUpperCase()){case"!=":case"<>":case"NE":return!lp(i.cellValue,e,i.dataKey);case"=":case"==":case"EQ":default:return lp(i.cellValue,e,i.dataKey)}};function iw(i){return(Array.isArray(i)&&i.length>0?i[0]:"")||""}const Dg=(i,e)=>{const t=parseFloat(i.cellValue),[r,n]=e;if(r===void 0&&!i.operator)return!0;if(r!==void 0&&n!==void 0){let s=(i==null?void 0:i.operator)??i.defaultFilterRangeOperator;s!==tt.rangeInclusive&&s!==tt.rangeExclusive&&(s=i.defaultFilterRangeOperator);const a=s===tt.rangeInclusive,o=ls(a?">=":">",t,+r),c=ls(a?"<=":"<",t,+n);return o&&c}return ls(i.operator||"==",t,+r)};function rw(i){const t=Array.isArray(i)&&i||[0],r=[];let n,s;if(t.length===2||typeof t[0]=="string"&&t[0].indexOf("..")>0){const a=t.length===2?t:t[0].split("..");n=parseFloat(Array.isArray(a)?a[0]:""),s=parseFloat(Array.isArray(a)?a[1]:"")}else n=parseFloat(t[0]);return ti(n,!0)&&ti(s,!0)?r.push(n,s):ti(n,!0)&&r.push(n),r}const Fg=(i,e)=>Fc(i.cellValue)===Fc(e);function nw(i){const e=Array.isArray(i)&&i[0]||!1;return Fc(e)}const Pg=i=>{const e=i.operator;let t;return Array.isArray(i.cellValue)&&(e==="IN_COLLECTION"||e==="NOT_IN_COLLECTION")?t=i.cellValue.length?i.cellValue.map(r=>`${r}`):[]:t=i.cellValue===void 0||i.cellValue===null?"":`${i.cellValue}`,ls(e||"IN",t,i.searchTerms||[])};function sw(i,e){const t=i&&(i.filterSearchType||i.fieldType)||Y.dateIso,r=Lr(t),[n,s]=e,a=Wr(i.cellValue,r,!0);if(!n&&!s||!a.isValid())return!1;const o=r.toLowerCase().includes("h")?a.valueOf():a.clone().startOf("day").valueOf();if(n&&s){let h=(i==null?void 0:i.operator)??i.defaultFilterRangeOperator;h!==tt.rangeInclusive&&h!==tt.rangeExclusive&&(h=i.defaultFilterRangeOperator);const l=h===tt.rangeInclusive,u=ls(l?">=":">",o,n.valueOf()),d=ls(l?"<=":"<",o,s.valueOf());return u&&d}const c=r.toLowerCase().includes("h")?n.valueOf():n.clone().startOf("day").valueOf();return ls(i.operator||"==",o,c)}function aw(i,e){const t=Array.isArray(i)&&i||[],r=e||Y.dateIso,n=Lr(r),s=[];if(t.length===2||typeof t[0]=="string"&&t[0].indexOf("..")>0){const a=t.length===2?t:t[0].split(".."),o=Array.isArray(a)&&a[0]||"",c=Array.isArray(a)&&a[1]||"",h=Wr(o,n,!0),l=Wr(c,n,!0);if(!h.isValid()||!l.isValid())return[];s.push(h,l)}else{const a=Wr(t[0],n,!0);if(!a.isValid())return[];s.push(a)}return s}const ow=(i,e)=>{if(Jx(i.operator))return Pg(i);switch(Ng(i.filterSearchType||i.fieldType)){case"boolean":return Fg(i,e);case"date":return sw(i,e||[]);case"number":return Dg(i,e||[]);case"object":return tw(i,e);case"string":default:return Rg(i,e||[])}};function nc(i,e){const t=Ng(e);let r;switch(t){case"boolean":r=nw(i);break;case"date":r=aw(i,e);break;case"number":r=rw(i);break;case"object":r=iw(i);break;case"string":r=ew(i);break}return r}function Ng(i){switch(i){case Y.boolean:return"boolean";case Y.date:case Y.dateIso:case Y.dateUtc:case Y.dateTime:case Y.dateTimeIso:case Y.dateTimeIsoAmPm:case Y.dateTimeIsoAM_PM:case Y.dateTimeShortIso:case Y.dateEuro:case Y.dateEuroShort:case Y.dateTimeShortEuro:case Y.dateTimeEuro:case Y.dateTimeEuroAmPm:case Y.dateTimeEuroAM_PM:case Y.dateTimeEuroShort:case Y.dateTimeEuroShortAmPm:case Y.dateTimeEuroShortAM_PM:case Y.dateUs:case Y.dateUsShort:case Y.dateTimeShortUs:case Y.dateTimeUs:case Y.dateTimeUsAmPm:case Y.dateTimeUsAM_PM:case Y.dateTimeUsShort:case Y.dateTimeUsShortAmPm:case Y.dateTimeUsShortAM_PM:return"date";case Y.integer:case Y.float:case Y.number:return"number";case Y.object:return"object";case Y.string:case Y.text:case Y.password:case Y.readonly:default:return"string"}}const cp={executeFilterConditionTest:ow,booleanFilter:Fg,collectionSearchFilter:Pg,numberFilter:Dg,stringFilter:Rg,testFilter:ls};class lw{constructor(e,t,r,n,s){this.filterFactory=e,this.pubSubService=t,this.sharedService=r,this.backendUtilities=n,this.rxjs=s,this._isFilterFirstRender=!0,this._firstColumnIdRendered="",this._filtersMetadata=[],this._columnFilters={},this._isTreePresetExecuted=!1,this._previousFilters=[],this._onSearchChange=new ze,this._eventHandler=new di,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get isFilterFirstRender(){return this._isFilterFirstRender}get onSearchChange(){return this._onSearchChange}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get _columnDefinitions(){var e;return((e=this._grid)==null?void 0:e.getColumns())??[]}get _dataView(){var e;return((e=this._grid)==null?void 0:e.getData())??{}}addRxJsResource(e){this.rxjs=e}init(e){this._grid=e,this._gridOptions&&this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions&&this._grid.setSortColumns([{columnId:this._gridOptions.treeDataOptions.columnId,sortAsc:!0}])}dispose(){var e;this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&((e=this.rxjs)!=null&&e.isObservable(this.httpCancelRequests$))&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete()),this.disposeColumnFilters(),this._onSearchChange=null}disposeColumnFilters(){if(this.removeAllColumnFiltersProperties(),Array.isArray(this._filtersMetadata)){let e=this._filtersMetadata.pop();for(;e;)typeof(e==null?void 0:e.destroy)=="function"&&e.destroy(),e=this._filtersMetadata.pop()}}bindBackendOnFilter(e){this._filtersMetadata=[],this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,r)=>{r.column.id===this._firstColumnIdRendered&&(this._isFilterFirstRender=!1),this.addFilterTemplateToHeaderRow(r,this._isFilterFirstRender),this._firstColumnIdRendered===""&&(this._firstColumnIdRendered=r.column.id)}),this.subscribeToOnHeaderRowCellRendered(e),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,this.onBackendFilterChange.bind(this))}bindLocalOnFilter(e){this._filtersMetadata=[],this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid,dataView:this._dataView}),this._dataView.setFilter(this.customLocalFilter.bind(this)),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,async(t,r)=>{const n=(r==null?void 0:r.clearFilterTriggered)??!1;n||await this.emitFilterChanged(ri.local,!0),this._gridOptions.enableTreeData===!0&&(this._tmpPreFilteredData=this.preFilterTreeData(this._dataView.getItems(),this._columnFilters)),r.columnId!==null&&this._dataView.refresh(),n||await this.emitFilterChanged(ri.local),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)}),this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,r)=>{this.addFilterTemplateToHeaderRow(r)}),this.subscribeToOnHeaderRowCellRendered(e)}async clearFilterByColumnId(e,t){await this.pubSubService.publish("onBeforeFilterClear",{columnId:t},0);const r=this._gridOptions.backendServiceApi??!1,n=r?ri.remote:ri.local,s=Object.keys(this._columnFilters);let a;Array.isArray(s)&&(a=s.find(c=>c===`${t}`));const o=this._filtersMetadata.find(c=>c.columnDef.id===t);return o!=null&&o.clear&&o.clear(!0),r&&a!==void 0&&this.onBackendFilterChange(e,{grid:this._grid,columnFilters:this._columnFilters}),await this.emitFilterChanged(n),!0}async clearFilters(e=!0){var r,n;e&&await this.pubSubService.publish("onBeforeFilterClear",!0,0),this._filtersMetadata.forEach(s=>{s!=null&&s.clear&&s.clear(!1)}),this.removeAllColumnFiltersProperties(),Array.isArray(this._columnDefinitions)&&this._columnDefinitions.forEach(s=>{var a;(a=s.filter)!=null&&a.searchTerms&&delete s.filter.searchTerms}),this._dataView&&this._grid&&(this._dataView.refresh(),this._grid.invalidate());const t=this._gridOptions.backendServiceApi;if(t&&e){const s={clearFilterTriggered:!0,shouldTriggerQuery:e,grid:this._grid,columnFilters:this._columnFilters},o=t.service.processOnFilterChanged(void 0,s),c=((r=this._gridOptions.pagination)==null?void 0:r.totalItems)??0;(n=this.backendUtilities)==null||n.executeBackendCallback(t,o,s,new Date,c,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:h=>this._previousFilters=this.extractBasicFilterDetails(h.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this)})}else this._previousFilters=this.extractBasicFilterDetails(this._columnFilters);e&&this.pubSubService.publish("onFilterCleared",!0)}customLocalFilter(e,t){const r=t==null?void 0:t.grid,n=(t==null?void 0:t.columnFilters)??{},s=this._gridOptions.enableTreeData??!1,a=this._gridOptions.treeDataOptions;if(s&&a){const o=a.collapsedPropName??ye.treeDataProperties.COLLAPSED_PROP,c=a.parentPropName??ye.treeDataProperties.PARENT_PROP,h=(a==null?void 0:a.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP,l=this._gridOptions.datasetIdPropertyName??"id",u=a.autoRecalcTotalsOnFilterChange??!1;let d=!1;if(e[c]!==null){let f=this._dataView.getItemById(e[c]);for(;f;){if(f[o])if(u)d=!0;else return!1;f=this._dataView.getItemById(f[c])}}if(this._tmpPreFilteredData instanceof Set){const f=this._tmpPreFilteredData.has(e[l]);if(u){const p=el(this.sharedService.hierarchicalDataset,m=>m[l]===e[l],h);if(p&&(p.__filteredOut=!f),d)return!1}return f}}else if(typeof n=="object")for(const o of Object.keys(n)){const c=n[o],h=this.preProcessFilterConditionOnDataContext(e,c,r);if(typeof h=="boolean")return h;let l=c==null?void 0:c.parsedSearchTerms;if(l===void 0&&(l=nc(c.searchTerms,c.columnDef.type||Y.string),l!==void 0&&(c.parsedSearchTerms=l)),!cp.executeFilterConditionTest(h,l))return!1}return!0}parseFormInputFilterConditions(e,t){var u;const r=da(e)||[];let n=Array.isArray(r)&&r.length===1?r[0]:"";const s=t.columnDef,a=((u=s.filter)==null?void 0:u.type)??s.type??Y.string;let o=null;a!==Y.object&&(n=n==null?"":`${n}`,o=(s.autoParseInputFilterOperator??this._gridOptions.autoParseInputFilterOperator)!==!1?n.match(/^([<>!=\*]{0,2})(.*[^<>!=\*])?([\*]?)$/):[n,"",n,""]);let c=(o==null?void 0:o[1])||t.operator;const h=(o==null?void 0:o[2])||"",l=(o==null?void 0:o[3])||(c==="*z"?"*":"");return typeof n=="string"&&(n=n.replace("'","''"),c==="*"||c==="*z"?c=tt.endsWith:(c==="a*"||l==="*")&&(c=tt.startsWith)),Array.isArray(o)&&o.length>=1&&Array.isArray(r)&&r.length===1&&(r[0]=h),{dataKey:s.dataKey,fieldType:a,searchTerms:r||[],operator:c,searchInputLastChar:l,filterSearchType:s.filterSearchType,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preProcessFilterConditionOnDataContext(e,t,r){var d,f,p;const n=t.columnDef,s=t.columnId;let a=r.getColumnIndex(s);if(!n&&this.sharedService&&Array.isArray(this.sharedService.allColumns)&&(a=this.sharedService.allColumns.findIndex(m=>m.field===s)),!n)return!0;if(this._gridOptions.enableRowDetailView){const m=this._gridOptions.rowDetailView&&this._gridOptions.rowDetailView.keyPrefix||"__";e[`${m}isPadding`]&&e[`${m}parent`]&&(e=e[`${m}parent`])}let o=((d=n.filter)==null?void 0:d.queryField)||n.queryFieldFilter||n.queryField||n.field||"";typeof n.queryFieldNameGetterFn=="function"&&(o=n.queryFieldNameGetterFn(e));const c=((f=n.filter)==null?void 0:f.type)??n.type??Y.string;let h=e[o];(o==null?void 0:o.indexOf("."))>=0&&(h=Ti(e,o));const l=t.operator,u=t.searchTerms||[];if(!u||Array.isArray(u)&&(u.length===0||u.length===1&&l===u[0]))return!0;if(u&&Array.isArray(u)&&c!==Y.object)for(let m=0,v=u.length;m<v;m++)u[m]=(u[m]===void 0||u[m]===null?"":u[m])+"";if(((p=n==null?void 0:n.params)==null?void 0:p.useFormatterOuputToFilter)===!0){const m=r.getData(),v=this._gridOptions.datasetIdPropertyName||"id",_=m&&typeof m.getIdxById=="function"?m.getIdxById(e[v]):0,x=n&&typeof n.formatter=="function"?n.formatter(_||0,a,h,n,e,this._grid):"";h=Rn(x)}return typeof h=="number"&&(h=h.toString()),{dataKey:n.dataKey,fieldType:c,searchTerms:u,cellValue:h,operator:l,searchInputLastChar:t.searchInputLastChar,filterSearchType:n.filterSearchType,ignoreAccentOnStringFilterAndSort:this._gridOptions.ignoreAccentOnStringFilterAndSort??!1,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preFilterTreeData(e,t){var v,_,x,E,C,y;const r=this._gridOptions.treeDataOptions,n=(r==null?void 0:r.collapsedPropName)??ye.treeDataProperties.COLLAPSED_PROP,s=(r==null?void 0:r.parentPropName)??ye.treeDataProperties.PARENT_PROP,a=(r==null?void 0:r.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP,o=this._gridOptions.datasetIdPropertyName??"id",c=(_=(v=this._gridOptions.presets)==null?void 0:v.treeData)==null?void 0:_.toggledItems,h=((x=this._gridOptions.treeDataOptions)==null?void 0:x.initiallyCollapsed)??!1,l=(E=this._gridOptions.treeDataOptions)==null?void 0:E.columnId,u=(C=this._gridOptions.treeDataOptions)==null?void 0:C.excludeChildrenWhenFilteringTree,d=!u&&((y=this._gridOptions.treeDataOptions)==null?void 0:y.autoApproveParentItemWhenTreeColumnIsValid)===!0,f={},p=new Set,m=new Map;return Array.isArray(e)&&(e.forEach(b=>{f[b[o]]=b,delete f[b[o]].__used}),typeof t=="object"&&Object.keys(t).forEach(b=>{var ne;const T=t[b],R=T!=null&&T.searchTerms?da(T.searchTerms):[],O=this.parseFormInputFilterConditions(R,T),W=T.columnDef,G=((ne=W==null?void 0:W.filter)==null?void 0:ne.type)??(W==null?void 0:W.type)??Y.string,Q=nc(O.searchTerms,G);Q!==void 0&&(T.parsedSearchTerms=Q)}),e.forEach(b=>{const T=b[a];let R=!0;for(const O of Object.keys(t)){const W=t[O],G=this.preProcessFilterConditionOnDataContext(b,W,this._grid);if(G){const Q=W==null?void 0:W.parsedSearchTerms,ne=typeof G=="boolean"?G:cp.executeFilterConditionTest(G,Q);if(ne&&d&&T&&W.columnId===l){m.set(b[o],!0);break}if(ne||!u&&m.get(b[s])===!0){if(T&&W.columnId===l&&m.set(b[o],!0),ne||!u&&W.columnId===l)continue}else T&&m.get(b[s])!==!0&&W.columnId!==l&&m.set(b[o],!1)}R=!1}if(R){p.add(b[o]);let O=f[b[s]]??!1;const W=!h;for(!this._isTreePresetExecuted&&Array.isArray(c)&&c.some(G=>G.itemId===O.id&&G.isCollapsed===W)&&(O[n]=W);O;)O.__used??p.add(O[o]),f[O[o]].__used=!0,O=f[O[s]]??!1}})),this._isTreePresetExecuted=!0,p}getColumnFilters(){return this._columnFilters}getPreviousFilters(){return this._previousFilters}getFiltersMetadata(){return this._filtersMetadata}getCurrentLocalFilters(){var t;const e=[];if(this._columnFilters)for(const r of Object.keys(this._columnFilters)){const n=this._columnFilters[r],s={columnId:r||""},a=this.sharedService.allColumns.find(c=>c.id===s.columnId),o=((t=a==null?void 0:a.filter)==null?void 0:t.emptySearchTermReturnAllValues)??!0;n!=null&&n.searchTerms&&(s.searchTerms=n.searchTerms),n.operator&&(s.operator=n.operator),n.targetSelector&&(s.targetSelector=n.targetSelector),Array.isArray(s.searchTerms)&&s.searchTerms.length>0&&(!o||s.searchTerms[0]!=="")&&e.push(s)}return e}emitFilterChanged(e,t=!1){const r=t?"onBeforeFilterChange":"onFilterChanged";if(e===ri.remote&&this._gridOptions.backendServiceApi){let n=[];const s=this._gridOptions.backendServiceApi.service;return s!=null&&s.getCurrentFilters&&(n=s.getCurrentFilters()),this.pubSubService.publish(r,n)}else if(e===ri.local)return this.pubSubService.publish(r,this.getCurrentLocalFilters())}async onBackendFilterChange(e,t){var a,o;const r=t==null?void 0:t.shouldTriggerQuery;if(r&&await this.emitFilterChanged(ri.remote,!0),!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendFilterChange(event, args)" function, it seems that "args" is not populated correctly');const n=this._gridOptions.backendServiceApi;if(!n||!n.process||!n.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const s=new Date;if(n.preProcess&&n.preProcess(),r){const c=await n.service.processOnFilterChanged(e,t),h=((a=this._gridOptions.pagination)==null?void 0:a.totalItems)??0;(o=this.backendUtilities)==null||o.executeBackendCallback(n,c,t,s,h,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:l=>this._previousFilters=this.extractBasicFilterDetails(l.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this),httpCancelRequestSubject:this.httpCancelRequests$})}}populateColumnFilterSearchTermPresets(e){return Array.isArray(e)&&(this._columnDefinitions.forEach(t=>{var n;(n=t.filter)!=null&&n.searchTerms&&delete t.filter.searchTerms;const r=e.find(s=>s.columnId===t.id);r&&Array.isArray(r==null?void 0:r.searchTerms)&&(t.filter=t.filter||{},t.filter.operator=r.operator||t.filter.operator||"",t.filter.searchTerms=r.searchTerms)}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)),this._columnDefinitions}refreshTreeDataFilters(e){var r;const t=e??((r=this._dataView)==null?void 0:r.getItems())??[];this._dataView&&this._gridOptions.enableTreeData&&t.length>0?(this._tmpPreFilteredData=this.preFilterTreeData(t,this._columnFilters),this._dataView.refresh()):t.length===0&&Array.isArray(this.sharedService.hierarchicalDataset)&&this.sharedService.hierarchicalDataset.length>0&&setTimeout(()=>this.refreshTreeDataFilters())}disableFilterFunctionality(e=!0,t=!0){const n=!this._gridOptions.enableFiltering;n!==e&&(t&&e&&this.clearFilters(),this.disableAllFilteringCommands(e),this._grid.setOptions({enableFiltering:n},!1,!0),this._grid.setHeaderRowVisibility(n),this._gridOptions.enableFiltering=!e,this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(this.sharedService.columnDefinitions))}resetToPreviousSearchFilters(){this.updateFilters(this._previousFilters,!1,!1,!1)}toggleFilterFunctionality(e=!0){const t=this._gridOptions.enableFiltering;this.disableFilterFunctionality(t,e)}toggleHeaderFilterRow(){let e=this._gridOptions.showHeaderRow??!1;e=!e,this._grid.setHeaderRowVisibility(e),e===!0&&this._grid.setColumns(this.sharedService.columnDefinitions)}setSortColumnIcons(e){this._grid&&Array.isArray(e)&&this._grid.setSortColumns(e)}async updateFilters(e,t=!0,r=!0,n=!1){var s;if(!this._filtersMetadata||this._filtersMetadata.length===0||!this._gridOptions||!this._gridOptions.enableFiltering)throw new Error('[Slickgrid-Universal] in order to use "updateFilters" method, you need to have Filterable Columns defined in your grid and "enableFiltering" set in your Grid Options');if(Array.isArray(e)){this.clearFilters(!1),e.forEach(c=>{const h=this._filtersMetadata.find(l=>c.columnId===l.columnDef.id);if(c&&h){const l=c.operator||h.defaultOperator;this.updateColumnFilters(c.searchTerms,h.columnDef,l),h.setValues(c.searchTerms||[],l),(n||this._gridOptions.enableTreeData)&&this.callbackSearchEvent(void 0,{columnDef:h.columnDef,operator:l,searchTerms:c.searchTerms,shouldTriggerQuery:!0,forceOnSearchChangeEvent:!0})}});const a=this._gridOptions.backendServiceApi,o=a?ri.remote:ri.local;if(t&&await this.emitFilterChanged(o,!0),this._dataView.refresh(),a){const c=a==null?void 0:a.service;c!=null&&c.updateFilters&&(c.updateFilters(e,!0),r&&((s=this.backendUtilities)==null||s.refreshBackendDataset(this._gridOptions)))}t&&await this.emitFilterChanged(o)}return!0}async updateSingleFilter(e,t=!0,r=!0){var s,a;const n=this.sharedService.allColumns.find(o=>o.id===e.columnId);if(n&&e.columnId){this._columnFilters={};const o=((s=n.filter)==null?void 0:s.emptySearchTermReturnAllValues)??!0;Array.isArray(e.searchTerms)&&(e.searchTerms.length>1||e.searchTerms.length===1&&(!o||e.searchTerms[0]!==""))&&(this._columnFilters[e.columnId]={columnId:e.columnId,operator:e.operator,searchTerms:e.searchTerms,columnDef:n,type:n.type??Y.string});const c=this._gridOptions.backendServiceApi,h=c?ri.remote:ri.local;if(t&&await this.emitFilterChanged(h,!0),c){const l=c==null?void 0:c.service;l!=null&&l.updateFilters&&(l.updateFilters(this._columnFilters,!0),r&&((a=this.backendUtilities)==null||a.refreshBackendDataset(this._gridOptions)))}else this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._dataView.refresh();t&&await this.emitFilterChanged(h)}return!0}drawFilterTemplate(e,t){let r;if(typeof t=="string"){if(r=document.querySelector(t),r===null)return null}else r=t;const n=typeof e=="string"?this.sharedService.allColumns.find(a=>a.id===e):e;if(((n==null?void 0:n.id)??"")!=="selector"&&(n!=null&&n.filterable)){let a,o;const c=this.filterFactory.createFilter(n.filter);o=n&&n.filter&&n.filter.operator||c&&c.operator,this._columnFilters[n.id]?(a=this._columnFilters[n.id].searchTerms||void 0,o=this._columnFilters[n.id].operator||void 0):n.filter&&(a=n.filter.searchTerms||void 0,this.updateColumnFilters(a,n,o));const h={grid:this._grid,operator:o,searchTerms:a,columnDef:n,filterContainerElm:r,callback:this.callbackSearchEvent.bind(this)};return c&&(c.init(h),a&&c.setValues&&c.setValues(a,o)),c}return null}addFilterTemplateToHeaderRow(e,t=!0){const r=e.column,n=(r==null?void 0:r.id)??"";if(n!=="selector"&&(r!=null&&r.filterable)){let s,a;const o=this.filterFactory.createFilter(r.filter);a=r&&r.filter&&r.filter.operator||o&&o.operator,this._columnFilters[r.id]?(s=this._columnFilters[r.id].searchTerms||void 0,a=this._columnFilters[r.id].operator||void 0):r.filter&&(s=r.filter.searchTerms||void 0,this.updateColumnFilters(s,r,a));const c={grid:this._grid,operator:a,searchTerms:s,columnDef:r,filterContainerElm:this._grid.getHeaderRowColumn(n),callback:this.callbackSearchEvent.bind(this)};if(o){o.init(c,t);const h=this._filtersMetadata.findIndex(l=>o.columnDef.id===l.columnDef.id);h===-1?this._filtersMetadata.push(o):this._filtersMetadata[h]=o,s&&o.setValues&&o.setValues(s,a)}}}callbackSearchEvent(e,t){var r,n;if(t){const s=e!=null&&e.target?e.target.value:void 0,a=t.searchTerms&&Array.isArray(t.searchTerms)?t.searchTerms:s?[s]:void 0,o=t.columnDef||null,c=(o==null?void 0:o.id)??"",h=((r=o==null?void 0:o.filter)==null?void 0:r.type)??(o==null?void 0:o.type)??Y.string,l=t.operator||void 0,u=a&&Array.isArray(a),d=u&&a&&a.length,f={...this._columnFilters},p=((n=o.filter)==null?void 0:n.emptySearchTermReturnAllValues)??!0;let m;if(o&&c)if(!u||d===0||d===1&&Array.isArray(a)&&p&&a[0]==="")delete this._columnFilters[c];else{const x=`${c}`,E={columnId:x,columnDef:o,parsedSearchTerms:[],type:h,targetSelector:this.getSelectorStringFromElement(e==null?void 0:e.target)},C=this.parseFormInputFilterConditions(a,E);E.operator=l||C.operator||Zu(h),m=nc(C.searchTerms,h),m!==void 0&&(E.parsedSearchTerms=m),E.searchTerms=C.searchTerms||[],this._columnFilters[x]=E}const v=e&&typeof e.isPropagationStopped!="function"?Br({},new Yt,e):e,_=e==null?void 0:e.key;if(this._onSearchChange&&(t.forceOnSearchChangeEvent||_==="Enter"||!qn(f,this._columnFilters))){const x={clearFilterTriggered:t.clearFilterTriggered,shouldTriggerQuery:t.shouldTriggerQuery,columnId:c,columnDef:o,columnFilters:this._columnFilters,operator:l||Zu(h),searchTerms:a,parsedSearchTerms:m,grid:this._grid,target:e==null?void 0:e.target};this.pubSubService.publish("onBeforeSearchChange",x)===!1?this._gridOptions.resetFilterSearchValueAfterOnBeforeCancellation&&this.resetToPreviousSearchFilters():this._onSearchChange.notify(x,v)}}}disableAllFilteringCommands(e=!0){var n;const t=this._grid.getColumns();t.forEach(s=>{var a,o;(a=s==null?void 0:s.header)!=null&&a.menu&&((o=s.header.menu.commandItems)==null||o.forEach(c=>{c&&typeof c!="string"&&c.command==="clear-filter"&&(c.hidden=e)}))});const r=(n=this._gridOptions.gridMenu)==null?void 0:n.commandItems;return r&&r.forEach(s=>{if(s&&typeof s!="string"){const a=s.command;(a==="clear-filter"||a==="toggle-filter")&&(s.hidden=e)}}),t}extractBasicFilterDetails(e){const t=[];if(e&&typeof e=="object")for(const r of Object.keys(e)){const{operator:n,searchTerms:s}=e[`${r}`];t.push({columnId:r,operator:n,searchTerms:s})}return t}getSelectorStringFromElement(e){return e!=null&&e.localName?e!=null&&e.className?`${e.localName}.${Array.from(e.classList).join(".")}`:e.localName:""}removeAllColumnFiltersProperties(){typeof this._columnFilters=="object"&&Object.keys(this._columnFilters).forEach(e=>{e&&this._columnFilters[e]&&delete this._columnFilters[e]})}subscribeToOnHeaderRowCellRendered(e){this._eventHandler.subscribe(e.onBeforeHeaderRowCellDestroy,(t,r)=>{var s;const n=this._filtersMetadata.find(a=>a.columnDef.id===r.column.id);(s=n==null?void 0:n.destroy)==null||s.call(n)})}updateColumnFilters(e,t,r){var a;const n=((a=t.filter)==null?void 0:a.type)??t.type??Y.string,s=nc(e,n);e&&t&&(this._columnFilters[t.id]={columnId:t.id,columnDef:t,searchTerms:e,operator:r,parsedSearchTerms:s,type:n})}}const sc={skipError:!1,triggerEvent:!0},Io={highlightRow:!0,resortGrid:!1,selectRow:!1,scrollRowIntoView:!0,skipError:!1,triggerEvent:!0},Tu={highlightRow:!1,selectRow:!1,scrollRowIntoView:!1,skipError:!1,triggerEvent:!0},hp={autoResizeColumns:!0,triggerEvent:!0,hideFromColumnPicker:!1,hideFromGridMenu:!1};class cw{constructor(e,t,r,n,s,a,o){this.gridStateService=e,this.filterService=t,this.pubSubService=r,this.paginationService=n,this.sharedService=s,this.sortService=a,this.treeDataService=o}get _dataView(){var e;return(e=this._grid)==null?void 0:e.getData()}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}dispose(){var e;(e=this._rowSelectionPlugin)==null||e.dispose()}init(e){this._grid=e}clearAllFiltersAndSorts(){this.sortService&&this.sortService.clearSorting&&this.sortService.clearSorting(!1),this.filterService&&this.filterService.clearFilters&&this.filterService.clearFilters()}clearPinning(e=!0){const t=[...this.sharedService.visibleColumns];this.sharedService.slickGrid.setOptions({frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1}),e&&Array.isArray(t)&&this.sharedService.slickGrid.setColumns(t)}setPinning(e,t=!0,r=!1,n=!0){Ym(e)?this.clearPinning():(this.sharedService.slickGrid.setOptions(e,r,n),this.sharedService.gridOptions={...this.sharedService.gridOptions,...e}),t&&this.sharedService.slickGrid.autosizeColumns()}getAllColumnDefinitions(){return this.sharedService.allColumns}getVisibleColumnDefinitions(){return this.sharedService.visibleColumns}getColumnFromEventArguments(e){if(!e||!e.grid||!e.grid.getColumns||!e.grid.getDataItem)throw new Error("[Slickgrid-Universal] To get the column definition and data, we need to have these arguments passed as objects (row, cell, grid)");return{row:e.row,cell:e.cell,columnDef:e.grid.getColumns()[e.cell],dataContext:e.grid.getDataItem(e.row),dataView:this._dataView,grid:this._grid}}getDataItemByRowNumber(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error(`[Slickgrid-Universal] We could not find SlickGrid Grid object or it's "getDataItem" method`);return this._grid.getDataItem(e)}getDataItemByRowIndex(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndexes(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');const t=[];return Array.isArray(e)&&e.forEach(r=>{t.push(this._grid.getDataItem(r))}),t}getSelectedRows(){if(!this._grid||typeof this._grid.getSelectedRows!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');return this._grid.getSelectedRows()}getSelectedRowsDataItem(){if(!this._grid||typeof this._grid.getSelectedRows!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');const e=this._grid.getSelectedRows();return this.getDataItemByRowIndexes(e)}hideColumnById(e,t){if(t={...hp,...t},this._grid&&this._grid.getColumns&&this._grid.setColumns){const r=this._grid.getColumns(),n=r.findIndex(s=>s.id===e);if(n>=0){const s=Fd(r,n);this.sharedService.visibleColumns=s,this._grid.setColumns(s);const a=this.sharedService.allColumns.findIndex(o=>o.id===e);return a&&(t!=null&&t.hideFromColumnPicker&&(this.sharedService.allColumns[a].excludeFromColumnPicker=!0),t!=null&&t.hideFromGridMenu&&(this.sharedService.allColumns[a].excludeFromGridMenu=!0)),t!=null&&t.autoResizeColumns&&this._grid.autosizeColumns(),t!=null&&t.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:s}),n}}return-1}hideColumnByIds(e,t){if(t={...hp,...t},Array.isArray(e)){for(const r of e)this.hideColumnById(r,{...t,triggerEvent:!1,autoResizeColumns:!1});t!=null&&t.autoResizeColumns&&this._grid.autosizeColumns(),t!=null&&t.triggerEvent&&this.pubSubService.publish("onHeaderMenuHideColumns",{columns:this.sharedService.visibleColumns})}}highlightRow(e,t){this._grid.getSelectionModel()||(this._rowSelectionPlugin=new Ud(this._gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionPlugin)),t||(t=this._gridOptions.rowHighlightDuration),Array.isArray(e)?e.forEach(r=>this._grid.highlightRow(r)):this._grid.highlightRow(e,t)}setSelectedRow(e){var t;(t=this._grid)!=null&&t.setSelectedRows&&this._grid.setSelectedRows([e])}setSelectedRows(e){var t;(t=this._grid)!=null&&t.setSelectedRows&&this._grid.setSelectedRows(e)}renderGrid(){var e;typeof((e=this._grid)==null?void 0:e.invalidate)=="function"&&this._grid.invalidate()}resetGrid(e){var t,r,n;if(this.clearPinning(!1),this._grid){const s=this.sharedService.allColumns||[];Array.isArray(s)&&s.length>0&&(this._grid.setColumns(s),(t=this._gridOptions)!=null&&t.enableAutoSizeColumns&&this._grid.autosizeColumns(),this.gridStateService.resetColumns(e))}typeof((r=this.filterService)==null?void 0:r.clearFilters)=="function"&&this.filterService.clearFilters(),typeof((n=this.sortService)==null?void 0:n.clearSorting)=="function"&&this.sortService.clearSorting()}addItem(e,t){var h,l,u,d;const r={...Io,...t};if(!(r!=null&&r.skipError)&&(!this._grid||!this._gridOptions||!this._dataView))throw new Error("[Slickgrid-Universal] We could not find SlickGrid Grid, DataView objects");const n=this._gridOptions.datasetIdPropertyName||"id";if(!(r!=null&&r.skipError)&&(!e||!e.hasOwnProperty(n)))throw new Error(`[Slickgrid-Universal] Adding an item requires the item to include an "${n}" property`);if((h=this._gridOptions)!=null&&h.enableTreeData&&(t==null?void 0:t.position)==="top")throw new Error('[Slickgrid-Universal] Please note that `addItem({ position: "top" })` is not supported when used with Tree Data because of the extra complexity.');const s=r==null?void 0:r.position;s==="bottom"||(l=this._gridOptions)!=null&&l.enableTreeData?this._dataView.addItem(e):this._dataView.insertItem(0,e);let a=0;const o=(e==null?void 0:e[n])??"";return(u=this._gridOptions)!=null&&u.enableTreeData?(this.invalidateHierarchicalDataset(),a=this._dataView.getRowById(o),r.scrollRowIntoView&&this._grid.scrollRowIntoView(a??0,!1)):r.resortGrid?(this._dataView.reSort(),a=this._dataView.getRowById(o)):(a=s==="bottom"?this._dataView.getRowById(o):0,r.scrollRowIntoView&&this._grid.scrollRowIntoView(a??0)),r.highlightRow&&a!==void 0&&this.highlightRow(a),a!==void 0&&r.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(a),r.triggerEvent&&this.pubSubService.publish("onItemAdded",e),!((d=this._gridOptions)!=null&&d.backendServiceApi)&&this._gridOptions.enablePagination&&(s==="bottom"?this.paginationService.goToLastPage():this.paginationService.goToFirstPage()),a}addItems(e,t){var o,c,h,l;const r={...Io,...t},n=this._gridOptions.datasetIdPropertyName||"id",s=r==null?void 0:r.position,a=[];if(Array.isArray(e))this._dataView.beginUpdate(!0),s==="bottom"||(o=this._gridOptions)!=null&&o.enableTreeData?this._dataView.addItems(e):this._dataView.insertItems(0,e),this._dataView.endUpdate();else return[this.addItem(e,r)||0];if((c=this._gridOptions)!=null&&c.enableTreeData){this.invalidateHierarchicalDataset();const u=((h=e[0])==null?void 0:h[n])??"",d=this._dataView.getRowById(u);r.scrollRowIntoView&&this._grid.scrollRowIntoView(d??0,!1)}else r.resortGrid&&this._dataView.reSort();return s&&r.scrollRowIntoView&&!((l=this._gridOptions)!=null&&l.enableTreeData)&&(s==="bottom"?this._grid.navigateBottom():this._grid.navigateTop()),e.forEach(u=>a.push(this._dataView.getRowById(u[n]))),r.highlightRow&&this.highlightRow(a),r.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(a),r.triggerEvent&&this.pubSubService.publish("onItemAdded",e),a}deleteItem(e,t){t={...sc,...t};const r=this._gridOptions.datasetIdPropertyName||"id";if(!(t!=null&&t.skipError)&&(!e||!e.hasOwnProperty(r)))throw new Error(`[Slickgrid-Universal] Deleting an item requires the item to include an "${r}" property`);return this.deleteItemById(e[r],t)}deleteItems(e,t){t={...sc,...t};const r=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return this.deleteItem(e,t),[e[r]];this._dataView.beginUpdate(!0);const n=[];return e.forEach(s=>{(s==null?void 0:s[r])!==void 0&&n.push(s[r])}),this._dataView.deleteItems(n),this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),n}deleteItemById(e,t){if(t={...sc,...t},!(t!=null&&t.skipError)&&e==null)throw new Error('[Slickgrid-Universal] Cannot delete a row without a valid "id"');return!(this.gridStateService&&this.gridStateService.needToPreserveRowSelection()||!1)&&this._grid&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows([]),this._dataView.deleteItem(e),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}deleteItemByIds(e,t){if(t={...sc,...t},Array.isArray(e)){this._dataView.beginUpdate(!0);for(let r=0;r<e.length;r++)e[r]!==null&&this.deleteItemById(e[r],{triggerEvent:!1});return this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemDeleted",e),e}return[]}updateItem(e,t){t={...Tu,...t};const r=this._gridOptions.datasetIdPropertyName||"id",n=!e||!e.hasOwnProperty(r)?void 0:e[r];if(!(t!=null&&t.skipError)&&n===void 0)throw new Error(`[Slickgrid-Universal] Calling Update of an item requires the item to include an "${r}" property`);return this.updateItemById(n,e,t)}updateItems(e,t){var a;t={...Tu,...t};const r=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return[this.updateItem(e,t)];this._dataView.beginUpdate(!0);const n=[],s=[];return e.forEach(o=>{const c=!o||!o.hasOwnProperty(r)?void 0:o[r];if(s.push(c),this._dataView.getIdxById(c)!==void 0){const h=this._dataView.getRowById(c);h!==void 0&&(n.push(h),this._grid.updateRow(h))}}),this._dataView.updateItems(s,e),this._dataView.endUpdate(),(a=this._gridOptions)!=null&&a.enableTreeData&&this.invalidateHierarchicalDataset(),t.highlightRow&&this.highlightRow(n),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(n),t.triggerEvent&&this.pubSubService.publish("onItemUpdated",e),n}updateItemById(e,t,r){var s;if(r={...Tu,...r},!(r!=null&&r.skipError)&&e===void 0)throw new Error('[Slickgrid-Universal] Cannot update a row without a valid "id"');const n=this._dataView.getRowById(e);if(!(r!=null&&r.skipError)&&!t&&!this._gridOptions.enablePagination)throw new Error(`[Slickgrid-Universal] The item to update in the grid was not found with id: ${e}`);return this._dataView.getIdxById(e)!==void 0&&(this._dataView.updateItem(e,t),n!==void 0&&this._grid.updateRow(n),(s=this._gridOptions)!=null&&s.enableTreeData&&this.invalidateHierarchicalDataset(),r.scrollRowIntoView&&n!==void 0&&this._grid.scrollRowIntoView(n),r.highlightRow&&n!==void 0&&this.highlightRow(n),n!==void 0&&r.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(n),r.triggerEvent&&this.pubSubService.publish("onItemUpdated",t)),n}upsertItem(e,t){t={...Io,...t};const r=this._gridOptions.datasetIdPropertyName||"id",n=!e||!e.hasOwnProperty(r)?void 0:e[r];if(!(t!=null&&t.skipError)&&n===void 0)throw new Error(`[Slickgrid-Universal] Calling Upsert of an item requires the item to include an "${r}" property`);return this.upsertItemById(n,e,t)}upsertItems(e,t){if(t={...Io,...t},!Array.isArray(e))return[this.upsertItem(e,t)];this._dataView.beginUpdate(!0);const r=[];e.forEach(s=>{r.push(this.upsertItem(s,{...t,highlightRow:!1,resortGrid:!1,selectRow:!1,triggerEvent:!1}))}),this._dataView.endUpdate();const n=r.map(s=>s.added!==void 0?s.added:s.updated);if(t.highlightRow&&this.highlightRow(n),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(n),t.triggerEvent){this.pubSubService.publish("onItemUpserted",e);const s=r.filter(o=>o.added!==void 0);Array.isArray(s)&&s.length>0&&this.pubSubService.publish("onItemAdded",s);const a=r.filter(o=>o.updated!==void 0);Array.isArray(a)&&a.length>0&&this.pubSubService.publish("onItemUpdated",a)}return r}upsertItemById(e,t,r){let n=!1;if(r={...Io,...r},!(r!=null&&r.skipError)&&e===void 0&&!this.hasRowSelectionEnabled())throw new Error('[Slickgrid-Universal] Calling Upsert of an item requires the item to include a valid and unique "id" property');let s,a;return this._dataView.getRowById(e)===void 0?(s=this.addItem(t,r),n=!0):(a=this.updateItem(t,{highlightRow:r.highlightRow,selectRow:r.selectRow,triggerEvent:r.triggerEvent}),n=!1),r.triggerEvent&&(this.pubSubService.publish("onItemUpserted",t),n?this.pubSubService.publish("onItemAdded",t):this.pubSubService.publish("onItemUpdated",t)),{added:s,updated:a}}invalidateHierarchicalDataset(e){var t;if((t=this._gridOptions)!=null&&t.enableTreeData&&this.treeDataService){const r=e??this._dataView.getItems(),n=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(r||[],this.sharedService.allColumns,this._gridOptions);this.sharedService.hierarchicalDataset=n.hierarchical,this.filterService.refreshTreeDataFilters(e),this._dataView.setItems(n.flat),this._grid.invalidate()}}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&e}}class hw{get eventHandler(){return this._eventHandler}constructor(){this._eventHandler=new di}dispose(){this._eventHandler.unsubscribeAll()}bindOnBeforeEditCell(e){const t=e==null?void 0:e.getData();this._eventHandler.subscribe(e.onBeforeEditCell,(r,n)=>{if(!r||!n||!e||n.cell===void 0||!e.getColumns||!e.getDataItem)return;const s=e.getColumns()[n.cell];if(typeof s.onBeforeEditCell=="function"){const a={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onBeforeEditCell(r instanceof Yt?r.getNativeEvent():r,a)}})}bindOnCellChange(e){const t=e==null?void 0:e.getData();this._eventHandler.subscribe(e.onCellChange,(r,n)=>{if(!r||!n||!e||n.cell===void 0||!e.getColumns||!e.getDataItem)return;const s=e.getColumns()[n.cell];if(typeof s.onCellChange=="function"){const a={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onCellChange(r instanceof Yt?r.getNativeEvent():r,a)}})}bindOnClick(e){const t=e==null?void 0:e.getData();this._eventHandler.subscribe(e.onClick,(r,n)=>{if(!r||!n||!e||n.cell===void 0||!e.getColumns||!e.getDataItem)return;const s=e.getColumns()[n.cell];if(typeof s.onCellClick=="function"){const a={row:n.row,cell:n.cell,dataView:t,grid:e,columnDef:s,dataContext:e.getDataItem(n.row)};s.onCellClick(r instanceof Yt?r.getNativeEvent():r,a)}})}}class uw{constructor(e,t,r,n,s,a){this.extensionService=e,this.filterService=t,this.pubSubService=r,this.sharedService=n,this.sortService=s,this.treeDataService=a,this._eventHandler=new di,this._columns=[],this._subscriptions=[],this._selectedRowIndexes=[],this._selectedRowDataContextIds=[],this._wasRecheckedAfterPageChange=!0}get _dataView(){var e;return((e=this._grid)==null?void 0:e.getData())??{}}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get selectedRowDataContextIds(){return this._selectedRowDataContextIds}set selectedRowDataContextIds(e){this._selectedRowDataContextIds=e}init(e){this._grid=e,this.subscribeToAllGridChanges(e)}dispose(){this._columns=[],this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}changeColumnsArrangement(e,t=!0,r=!1){var n,s,a,o,c,h;if(Array.isArray(e)&&e.length>0){const l=this.getAssociatedGridColumns(this._grid,e);if(l&&Array.isArray(l)&&l.length>0){if(Array.isArray(this.sharedService.allColumns)){const u=[];if(this._gridOptions.enableCheckboxSelector){const d=((s=(n=this._gridOptions)==null?void 0:n.checkboxSelector)==null?void 0:s.columnIndexPosition)??0;u.push({columnId:"_checkbox_selector",columnIndexPosition:d})}if(this._gridOptions.enableRowDetailView){const d=((o=(a=this._gridOptions)==null?void 0:a.rowDetailView)==null?void 0:o.columnIndexPosition)??0;u.push({columnId:"_detail_selector",columnIndexPosition:d})}if(this._gridOptions.enableRowMoveManager){const d=((h=(c=this._gridOptions)==null?void 0:c.rowMoveManager)==null?void 0:h.columnIndexPosition)??0;u.push({columnId:"_move",columnIndexPosition:d})}this.addColumnDynamicWhenFeatureEnabled(u,this.sharedService.allColumns,l)}l.forEach(u=>u.originalWidth=u.width||u.originalWidth),this._grid.setColumns(l),this.sharedService.visibleColumns=l,t?this._grid.autosizeColumns():(r||this._gridOptions.enableAutoResizeColumnsByCellContent&&!this._gridOptions.autosizeColumnsByCellContentOnFirstLoad)&&this.pubSubService.publish("onFullResizeByContentRequested",{caller:"GridStateService"})}}}getCurrentGridState(){var a;const{frozenColumn:e,frozenRow:t,frozenBottom:r}=this.sharedService.gridOptions,n={columns:this.getCurrentColumns(),filters:this.getCurrentFilters(),sorters:this.getCurrentSorters(),pinning:{frozenColumn:e,frozenRow:t,frozenBottom:r}},s=this.getCurrentPagination();if(s&&(n.pagination=s),this.hasRowSelectionEnabled()){const o=this.getCurrentRowSelections();o&&(n.rowSelection=o)}if((a=this._gridOptions)!=null&&a.enableTreeData){const o=this.getCurrentTreeDataToggleState();o&&(n.treeData=o)}return n}getColumns(){return this._columns}getAssociatedCurrentColumns(e){const t=[];return e&&Array.isArray(e)&&e.forEach(r=>{r!=null&&r.id&&t.push({columnId:r.id,cssClass:r.cssClass||"",headerCssClass:r.headerCssClass||"",width:r.width||0})}),t}getAssociatedGridColumns(e,t){const r=[],n=this.sharedService.allColumns||e.getColumns();return t&&Array.isArray(t)&&t.forEach(s=>{const a=n.find(o=>o.id===s.columnId);a!=null&&a.id&&r.push({...a,cssClass:s.cssClass||a.cssClass,headerCssClass:s.headerCssClass||a.headerCssClass,width:s.width})}),this._columns=r,r}getCurrentColumns(){return this.getAssociatedCurrentColumns(this._grid.getColumns()||[])}getCurrentFilters(){var e,t;if((e=this._gridOptions)!=null&&e.backendServiceApi){const r=this._gridOptions.backendServiceApi.service;if(r!=null&&r.getCurrentFilters)return r.getCurrentFilters()}else if((t=this.filterService)!=null&&t.getCurrentLocalFilters)return this.filterService.getCurrentLocalFilters();return null}getCurrentPagination(){var e;if((e=this._gridOptions)!=null&&e.enablePagination)if(this._gridOptions.backendServiceApi){const t=this._gridOptions.backendServiceApi.service;if(t!=null&&t.getCurrentPagination)return t.getCurrentPagination()}else return this.sharedService.currentPagination;return null}getCurrentRowSelections(){return this._grid&&this._dataView&&this.hasRowSelectionEnabled()?{gridRowIndexes:this._grid.getSelectedRows()||[],dataContextIds:this._dataView.getAllSelectedIds()||[],filteredDataContextIds:this._dataView.getAllSelectedFilteredIds()||[]}:null}getCurrentSorters(){var e,t;if((e=this._gridOptions)!=null&&e.backendServiceApi){const r=this._gridOptions.backendServiceApi.service;if(r!=null&&r.getCurrentSorters)return r.getCurrentSorters()}else if((t=this.sortService)!=null&&t.getCurrentLocalSorters)return this.sortService.getCurrentLocalSorters();return null}getCurrentTreeDataToggleState(){var e;return(e=this._gridOptions)!=null&&e.enableTreeData&&this.treeDataService?this.treeDataService.getCurrentToggleState():null}needToPreserveRowSelection(){var t;let e=!1;if((t=this._gridOptions)!=null&&t.dataView&&this._gridOptions.dataView.hasOwnProperty("syncGridSelection")){const r=this._gridOptions.dataView.syncGridSelection;typeof r=="boolean"?e=this._gridOptions.dataView.syncGridSelection:typeof r=="object"&&(e=r.preserveHidden||r.preserveHiddenOnSelectionChange),e&&this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService)}return e}resetColumns(e){const t=e||this._columns,r=this.getAssociatedCurrentColumns(t);this.pubSubService.publish("onGridStateChanged",{change:{newValues:r,type:ur.columns},gridState:this.getCurrentGridState()})}resetToOriginalColumns(e=!0){this._grid.setColumns(this.sharedService.allColumns),this.sharedService.visibleColumns=this.sharedService.allColumns,e&&this._grid.autosizeColumns()}resetRowSelectionWhenRequired(){var e,t;if(!this.needToPreserveRowSelection()&&(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)){const r=(t=(e=this.extensionService)==null?void 0:e.getExtensionByName)==null?void 0:t.call(e,xt.rowSelection);r!=null&&r.instance&&this._grid.setSelectedRows([])}}subscribeToAllGridChanges(e){this._subscriptions.push(this.pubSubService.subscribe("onFilterChanged",t=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:ur.filter},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onFilterCleared",()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:ur.filter},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",t=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:ur.sorter},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onSortCleared",()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:ur.sorter},gridState:this.getCurrentGridState()})})),this.bindExtensionAddonEventToGridStateChange(xt.columnPicker,"onColumnsChanged"),this.bindExtensionAddonEventToGridStateChange(xt.gridMenu,"onColumnsChanged"),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsReordered",e),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsResized",e),this.bindSlickGridOnSetOptionsEventToGridStateChange(e),(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,(t,r)=>{const n=(this._selectedRowIndexes||[]).slice(),s=(this.selectedRowDataContextIds||[]).slice();if(this.selectedRowDataContextIds=r.filteredIds,this._selectedRowIndexes=r.rows,!qn(this.selectedRowDataContextIds,s)||!qn(this._selectedRowIndexes,n)){const a={gridRowIndexes:this._selectedRowIndexes||[],dataContextIds:r.selectedRowIds,filteredDataContextIds:r.filteredIds};this.pubSubService.publish("onGridStateChanged",{change:{newValues:a,type:ur.rowSelection},gridState:this.getCurrentGridState()})}}),this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuHideColumns",t=>{const r=this.getAssociatedCurrentColumns(t);this.pubSubService.publish("onGridStateChanged",{change:{newValues:r,type:ur.columns},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onTreeItemToggled",t=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:ur.treeData},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onTreeFullToggleEnd",t=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:ur.treeData},gridState:this.getCurrentGridState()})}))}addColumnDynamicWhenFeatureEnabled(e,t,r){e.sort((n,s)=>n.columnIndexPosition-s.columnIndexPosition),e.forEach(n=>{const s=t.findIndex(o=>o.id===n.columnId),a=r.findIndex(o=>o.id===n.columnId);if(s>=0&&a===-1){const o=t[s];s===0?r.unshift(o):r.splice(s,0,o)}})}bindExtensionAddonEventToGridStateChange(e,t){var s,a,o;const r=(a=(s=this.extensionService)==null?void 0:s.getExtensionByName)==null?void 0:a.call(s,e),n=(o=r==null?void 0:r.instance)==null?void 0:o[t];n&&typeof n.subscribe=="function"&&this._eventHandler.subscribe(n,(c,h)=>{const l=h==null?void 0:h.columns,u=this.getAssociatedCurrentColumns(l);this.pubSubService.publish("onGridStateChanged",{change:{newValues:u,type:ur.columns},gridState:this.getCurrentGridState()})})}bindSlickGridColumnChangeEventToGridStateChange(e,t){const r=t==null?void 0:t[e];r&&typeof r.subscribe=="function"&&this._eventHandler.subscribe(r,()=>{const n=t.getColumns(),s=this.getAssociatedCurrentColumns(n);this.pubSubService.publish("onGridStateChanged",{change:{newValues:s,type:ur.columns},gridState:this.getCurrentGridState()})})}bindSlickGridOnSetOptionsEventToGridStateChange(e){const t=e.onSetOptions;this._eventHandler.subscribe(t,(r,n)=>{const{frozenBottom:s,frozenColumn:a,frozenRow:o}=n.optionsBefore,{frozenBottom:c,frozenColumn:h,frozenRow:l}=n.optionsAfter;if(s!==c||a!==h||o!==l){const u={frozenBottom:c,frozenColumn:h,frozenRow:l},d=this.getCurrentGridState();this.pubSubService.publish("onGridStateChanged",{change:{newValues:u,type:ur.pinning},gridState:d})}})}hasRowSelectionEnabled(){const e=this._grid.getSelectionModel();return(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&e}}class dw{constructor(e,t){this.extensionUtility=e,this.pubSubService=t,this._subscriptions=[],this._eventHandler=new di}get _dataView(){var e;return((e=this._grid)==null?void 0:e.getData())??{}}get eventHandler(){return this._eventHandler}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get _columnDefinitions(){var e;return((e=this._grid)==null?void 0:e.getColumns())??[]}init(e){if(this._grid=e,e&&this._gridOptions&&this._gridOptions.createPreHeaderPanel){this._gridOptions.enableTranslate&&this.translateGroupingAndColSpan(),this._eventHandler.subscribe(e.onSort,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onRendered,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onAutosizeColumns,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onColumnsResized,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onColumnsReordered,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(this._dataView.onRowCountChanged,()=>this.delayRenderPreHeaderRowGroupingTitles(0)),this._subscriptions.push(this.pubSubService.subscribe("onColumnPickerColumnsChanged",()=>this.renderPreHeaderRowGroupingTitles()),this.pubSubService.subscribe("onHeaderMenuHideColumns",()=>this.delayRenderPreHeaderRowGroupingTitles(0)),this.pubSubService.subscribe("onGridMenuColumnsChanged",()=>this.renderPreHeaderRowGroupingTitles()),this.pubSubService.subscribe("onGridMenuMenuClose",()=>this.renderPreHeaderRowGroupingTitles()));const t=e.getPluginByName("Resizer");t!=null&&t.onGridAfterResize&&this._eventHandler.subscribe(t.onGridAfterResize,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onSetOptions,(r,n)=>{var s,a;((s=n==null?void 0:n.optionsBefore)==null?void 0:s.frozenColumn)!==((a=n==null?void 0:n.optionsAfter)==null?void 0:a.frozenColumn)&&this.delayRenderPreHeaderRowGroupingTitles(0)}),this.delayRenderPreHeaderRowGroupingTitles(75)}}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}delayRenderPreHeaderRowGroupingTitles(e=0){setTimeout(()=>this.renderPreHeaderRowGroupingTitles(),e)}renderPreHeaderRowGroupingTitles(){var e;if(this._gridOptions&&this._gridOptions.frozenColumn!==void 0&&this._gridOptions.frozenColumn>=0){let t=this._grid.getPreHeaderPanelLeft();this.renderHeaderGroups(t,0,this._gridOptions.frozenColumn+1),t=this._grid.getPreHeaderPanelRight(),this.renderHeaderGroups(t,((e=this._gridOptions)==null?void 0:e.frozenColumn)+1,this._columnDefinitions.length)}else{const t=this._grid.getPreHeaderPanel();this.renderHeaderGroups(t,0,this._columnDefinitions.length)}}renderHeaderGroups(e,t,r){var u,d;Rt(e),e.className="slick-header-columns",e.style.left="-1000px",e.style.width=`${this._grid.getHeadersWidth()}px`,e.parentElement&&e.parentElement.classList.add("slick-header");const n=this._grid.getHeaderColumnWidthDiff();let s,a=null,o="",c=0;const h=((u=this._gridOptions)==null?void 0:u.frozenHeaderWidthCalcDifferential)??0,l=((d=this._gridOptions)==null?void 0:d.frozenColumn)!==void 0&&this._gridOptions.frozenColumn>=0;for(let f=t;f<r;f++)s=this._columnDefinitions[f],s&&(o===s.columnGroup&&f>0?(c+=s.width||0,a!=null&&a.style&&(a.style.width=`${c-n-h}px`)):(c=s.width||0,a=K("div",{className:`ui-state-default slick-header-column ${l?"frozen":""}`,style:{width:`${c-n}px`}}),K("span",{className:"slick-column-name",textContent:s.columnGroup||""},a),e.appendChild(a)),o=s.columnGroup||"")}translateGroupingAndColSpan(){const e=this._grid.getColumns();this.extensionUtility.translateItems(e,"columnGroupKey","columnGroup"),this._grid.setColumns(e),this.renderPreHeaderRowGroupingTitles()}}class fw{constructor(e,t,r,n){this.pubSubService=e,this.sharedService=t,this.backendUtilities=r,this.rxjs=n,this._eventHandler=new di,this._initialized=!1,this._isLocalGrid=!0,this._dataFrom=1,this._dataTo=1,this._itemsPerPage=0,this._pageCount=1,this._pageNumber=1,this._totalItems=0,this._availablePageSizes=[],this._subscriptions=[],this._isCursorBased=!1}get dataView(){var e;return((e=this.grid)==null?void 0:e.getData())??{}}set paginationOptions(e){this._paginationOptions=e}get paginationOptions(){return this._paginationOptions}get availablePageSizes(){return this._availablePageSizes}get dataFrom(){return this._dataFrom}get dataTo(){return this._dataTo}get itemsPerPage(){return this._itemsPerPage}get pageCount(){return this._pageCount}get pageNumber(){return this._pageNumber}get totalItems(){return this._totalItems}set totalItems(e){this._totalItems=e,this._initialized&&this.refreshPagination()}get isCursorBased(){return this._isCursorBased}addRxJsResource(e){this.rxjs=e}init(e,t,r){var s;if(this._availablePageSizes=t.pageSizes,this.grid=e,this._backendServiceApi=r,this._paginationOptions=t,this._isLocalGrid=!r,this._pageNumber=t.pageNumber||1,this._isCursorBased=((s=r==null?void 0:r.options)==null?void 0:s.useCursor)??!1,r&&(!r.service||!r.process))throw new Error('BackendServiceApi requires the following 2 properties "process" and "service" to be defined.');this._isLocalGrid&&this.dataView&&(this._eventHandler.subscribe(this.dataView.onPagingInfoChanged,(a,o)=>{this._totalItems!==o.totalRows&&(this.updateTotalItems(o.totalRows),this._previousPagination={pageNumber:o.pageNum,pageSize:o.pageSize,pageSizes:this.availablePageSizes,totalItems:o.totalRows})}),setTimeout(()=>{this.dataView&&(this.dataView.setRefreshHints({isFilterUnchanged:!0}),this.dataView.setPagingOptions({pageSize:this.paginationOptions.pageSize,pageNum:this._pageNumber-1}))})),this._subscriptions.push(this.pubSubService.subscribe("onFilterChanged",()=>this.resetPagination())),this._subscriptions.push(this.pubSubService.subscribe("onFilterCleared",()=>this.resetPagination())),this.dataView&&(this._subscriptions.push(this.pubSubService.subscribe("onItemAdded",a=>this.processOnItemAddedOrRemoved(a,!0))),this._subscriptions.push(this.pubSubService.subscribe("onItemDeleted",a=>this.processOnItemAddedOrRemoved(a,!1)))),this.refreshPagination(!1,!1,!0);const n=this.getFullPagination();this._previousPagination={pageNumber:n.pageNumber,pageSize:n.pageSize,pageSizes:n.pageSizes,totalItems:this.totalItems},this._initialized=!0}dispose(){this._initialized=!1,this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}getCurrentPagination(){return{pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes}}getFullPagination(){return{pageCount:this._pageCount,pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes,totalItems:this._totalItems,dataFrom:this._dataFrom,dataTo:this._dataTo}}getCurrentPageNumber(){return this._pageNumber}getCurrentItemPerPage(){return this._itemsPerPage}changeItemPerPage(e,t,r=!0){return this._pageNumber=1,this._pageCount=Math.ceil(this._totalItems/e),this._itemsPerPage=e,r?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination())}goToFirstPage(e,t=!0){return this._pageNumber=1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToLastPage(e,t=!0){return this._pageNumber=this._pageCount||1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToNextPage(e,t=!0){return this._pageNumber<this._pageCount?(this._pageNumber++,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage,after:this._cursorPageInfo.endCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}goToPageNumber(e,t,r=!0){if(this.isCursorBased)return console.assert(!0,"Cursor based navigation cannot navigate to arbitrary page"),Promise.resolve(!1);const n=this._pageNumber;return e<1?this._pageNumber=1:e>this._pageCount?this._pageNumber=this._pageCount:this._pageNumber=e,this._pageNumber!==n?r?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination()):Promise.resolve(!1)}goToPreviousPage(e,t=!0){return this._pageNumber>1?(this._pageNumber--,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage,before:this._cursorPageInfo.startCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}refreshPagination(e=!1,t=!0,r=!1){var a,o,c;const n={...this.getFullPagination()};if(this._paginationOptions){const h=this._paginationOptions;this._itemsPerPage||(this._isLocalGrid?this._itemsPerPage=h.pageSize:this._itemsPerPage=+((c=(o=(a=this._backendServiceApi)==null?void 0:a.options)==null?void 0:o.paginationOptions)!=null&&c.first?this._backendServiceApi.options.paginationOptions.first:h.pageSize)),(e||this._totalItems!==h.totalItems)&&(e?(this._pageNumber=1,this.paginationOptions.pageNumber=1):!this._initialized&&h.pageNumber&&h.pageNumber>1&&(this._pageNumber=h.pageNumber||1),this._pageNumber===1&&this._backendServiceApi&&this._backendServiceApi.service.resetPaginationOptions()),this._availablePageSizes=h.pageSizes,!this._totalItems&&h.totalItems&&(this._totalItems=h.totalItems),this.recalculateFromToIndexes()}this._pageCount=Math.ceil(this._totalItems/this._itemsPerPage),this.sharedService.currentPagination=this.getCurrentPagination(),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),t&&!qn(n,this.getFullPagination())&&this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),r&&!qn(n,this.getFullPagination())&&this.pubSubService.publish("onPaginationPresetsInitialized",this.getFullPagination());const s=this.getFullPagination();this._previousPagination={pageNumber:s.pageNumber,pageSize:s.pageSize,pageSizes:s.pageSizes,totalItems:this.totalItems}}resetPagination(e=!0){var t,r;this._isLocalGrid&&this.dataView&&((r=(t=this.sharedService)==null?void 0:t.gridOptions)!=null&&r.enablePagination)&&this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:0}),this._cursorPageInfo=void 0,this.refreshPagination(!0,e)}togglePaginationVisibility(e){var t;if(this.grid&&((t=this.sharedService)!=null&&t.gridOptions)){const r=e!==void 0?e:!this.sharedService.gridOptions.enablePagination;if(r&&this.goToFirstPage(),this._isLocalGrid&&this.dataView){const n=e?this._itemsPerPage:0;this.dataView.setPagingOptions({pageSize:n,pageNum:0})}this.sharedService.gridOptions.enablePagination=r,this.pubSubService.publish("onPaginationVisibilityChanged",{visible:r})}}processOnPageChanged(e,t,r){return console.assert(!this.isCursorBased||r,"Configured for cursor based pagination - cursorArgs expected"),this.pubSubService.publish("onBeforePaginationChange",this.getFullPagination())===!1?(this.resetToPreviousPagination(),Promise.resolve(this.getFullPagination())):new Promise((n,s)=>{var a,o,c;if(this.recalculateFromToIndexes(),this._isLocalGrid&&this.dataView)this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:e-1}),this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),n(this.getFullPagination());else{const h=+this._itemsPerPage,l=new Date;if((a=this._backendServiceApi)!=null&&a.preProcess&&this._backendServiceApi.preProcess(),(o=this._backendServiceApi)!=null&&o.process){const u=this.isCursorBased&&r?this._backendServiceApi.service.processOnPaginationChanged(t,r):this._backendServiceApi.service.processOnPaginationChanged(t,{newPage:e,pageSize:h}),d=this._backendServiceApi.process(u);d instanceof Promise?d.then(f=>{var m;(m=this.backendUtilities)==null||m.executeBackendProcessesCallback(l,f,this._backendServiceApi,this._totalItems);const p=this.getFullPagination();this._previousPagination={pageNumber:p.pageNumber,pageSize:p.pageSize,pageSizes:p.pageSizes,totalItems:this.totalItems},n(this.getFullPagination())}).catch(f=>{var p,m,v;this.resetToPreviousPagination(),(p=this.backendUtilities)==null||p.onBackendError(f,this._backendServiceApi),(!((m=this._backendServiceApi)!=null&&m.onError)||!((v=this.backendUtilities)!=null&&v.onBackendError))&&s(d)}):(c=this.rxjs)!=null&&c.isObservable(d)&&this._subscriptions.push(d.subscribe(f=>{var m;const p=this.getFullPagination();this._previousPagination={pageNumber:p.pageNumber,pageSize:p.pageSize,pageSizes:p.pageSizes,totalItems:this.totalItems},n((m=this.backendUtilities)==null?void 0:m.executeBackendProcessesCallback(l,f,this._backendServiceApi,this._totalItems))},f=>{var p,m,v;this.resetToPreviousPagination(),(p=this.backendUtilities)==null||p.onBackendError(f,this._backendServiceApi),(!((m=this._backendServiceApi)!=null&&m.onError)||!((v=this.backendUtilities)!=null&&v.onBackendError))&&s(d)})),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}})}recalculateFromToIndexes(){this._totalItems===0?(this._dataFrom=0,this._dataTo=1,this._pageNumber=0):(this._dataFrom=this._pageNumber>1?this._pageNumber*this._itemsPerPage-this._itemsPerPage+1:1,this._dataTo=this._totalItems<this._itemsPerPage?this._totalItems:(this._pageNumber||1)*this._itemsPerPage,this._dataTo>this._totalItems&&(this._dataTo=this._totalItems)),this._pageNumber=this._totalItems>0&&this._pageNumber===0?1:this._pageNumber,this._dataTo>this._totalItems?this._dataTo=this._totalItems:this._totalItems<this._itemsPerPage&&(this._dataTo=this._totalItems)}resetToPreviousPagination(){var r,n,s,a,o,c,h,l,u;const e=((r=this._previousPagination)==null?void 0:r.pageNumber)!==this.getFullPagination().pageNumber,t=((n=this._previousPagination)==null?void 0:n.pageSize)!==this.getFullPagination().pageSize;t&&this.changeItemPerPage(((s=this._previousPagination)==null?void 0:s.pageSize)??0,null,!1),e&&this.goToPageNumber(((a=this._previousPagination)==null?void 0:a.pageNumber)??0,null,!1),(e||t)&&(this.refreshPagination(),(u=(c=(o=this._backendServiceApi)==null?void 0:o.service)==null?void 0:c.updatePagination)==null||u.call(c,((h=this._previousPagination)==null?void 0:h.pageNumber)??0,((l=this._previousPagination)==null?void 0:l.pageSize)??0))}setCursorBased(e){this._isCursorBased=e,e&&this.setCursorPageInfo({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1}),this.goToFirstPage(),this.pubSubService.publish("onPaginationSetCursorBased",{isCursorBased:e})}setCursorPageInfo(e){this._cursorPageInfo=e}updateTotalItems(e,t=!1){this._totalItems=e,this._paginationOptions&&(this._paginationOptions.totalItems=e,this.refreshPagination(!1,t))}processOnItemAddedOrRemoved(e,t=!0){if(e!==null){const r=this._dataTo,n=Array.isArray(e)?e.length:1,s=t?+n:-n;this._totalItems+=s,this.recalculateFromToIndexes(),this._dataTo=r+s,this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}}const pw=20,mw=25,gw=35,vw=180,_w=300,Ew=200;class xw{get eventHandler(){return this._eventHandler}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get dataView(){var e;return(e=this._grid)==null?void 0:e.getData()}get gridUid(){var e;return((e=this._grid)==null?void 0:e.getUID())??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get intervalRetryDelay(){return this._intervalRetryDelay}set intervalRetryDelay(e){this._intervalRetryDelay=e}get resizeByContentOptions(){var e;return((e=this.gridOptions)==null?void 0:e.resizeByContentOptions)??{}}constructor(e){this.pubSubService=e,this._intervalRetryDelay=Ew,this._isStopResizeIntervalRequested=!1,this._hasResizedByContentAtLeastOnce=!1,this._totalColumnsWidthByContent=0,this._resizePaused=!1,this._subscriptions=[],this._eventHandler=new di,this._bindingEventService=new Xi}dispose(){var e,t;(e=this._eventHandler)==null||e.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._intervalId&&clearInterval(this._intervalId),clearTimeout(this._timer),((t=this.gridOptions.autoResize)==null?void 0:t.resizeDetection)==="container"&&this._resizeObserver&&this._resizeObserver.disconnect(),this._bindingEventService.unbindAll()}init(e,t){var n,s,a,o,c;if(!e||!this.gridOptions||!t)throw new Error(`
      [Slickgrid-Universal] Resizer Service requires a valid Grid object and DOM Element Container to be provided.
      You can fix this by setting your gridOption to use "enableAutoResize" or create an instance of the ResizerService by calling bindAutoResizeDataGrid() once.`);this._grid=e,this._gridContainerElm=t;const r=(n=this.gridOptions)!=null&&n.gridHeight||(s=this.gridOptions)!=null&&s.gridWidth?{height:(a=this.gridOptions)==null?void 0:a.gridHeight,width:(o=this.gridOptions)==null?void 0:o.gridWidth}:void 0;this._autoResizeOptions=((c=this.gridOptions)==null?void 0:c.autoResize)??{container:"grid1",bottomPadding:0},r!=null&&r.width&&(t!=null&&t.style)&&(t.style.width=typeof r.width=="string"?r.width:`${r.width}px`),this._gridDomElm=e.getContainerNode(),typeof this._autoResizeOptions.container=="string"?this._pageContainerElm=typeof this._autoResizeOptions.container=="string"?document.querySelector(this._autoResizeOptions.container):this._autoResizeOptions.container:this._pageContainerElm=this._autoResizeOptions.container,r&&(this._fixedHeight=r.height,this._fixedWidth=r.width),this.gridOptions.enableAutoResize&&this.bindAutoResizeDataGrid(),this.gridOptions.autoResize&&this._subscriptions.push(this.pubSubService.subscribe("onFullResizeByContentRequested",()=>this.resizeColumnsByCellContent(!0))),this.gridOptions.enableColumnResizeOnDoubleClick&&(this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuColumnResizeByContent",h=>{this.handleSingleColumnResizeByContent(h.columnId)})),this._eventHandler.subscribe(this._grid.onColumnsResizeDblClick,(h,l)=>{this.handleSingleColumnResizeByContent(l.triggeredByColumn)}))}bindAutoResizeDataGrid(e){var t;if(((t=this.gridOptions.autoResize)==null?void 0:t.resizeDetection)==="container"){if(!this._pageContainerElm||!this._pageContainerElm)throw new Error(`
          [Slickgrid-Universal] Resizer Service requires a container when gridOption.autoResize.resizeDetection="container"
          You can fix this by setting your gridOption.autoResize.container`);this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>this.resizeObserverCallback())),this._resizeObserver.observe(this._pageContainerElm)}else{if(this._gridDomElm===void 0||xi(this._gridDomElm)===void 0)return null;this.resizeGrid().then(()=>this.resizeGridWhenStylingIsBrokenUntilCorrected()).catch(r=>console.log("Error:",r)),this.resizeGrid(10,e),this._bindingEventService.bind(window,"resize",this.handleResizeGrid.bind(this,e))}}handleResizeGrid(e){this.pubSubService.publish("onGridBeforeResize"),this._resizePaused||(this.resizeGrid(0,e),this.resizeGrid(0,e))}resizeObserverCallback(){this._resizePaused||this.resizeGrid()}calculateGridNewDimensions(e){var m,v;const t=(e==null?void 0:e.autoResize)??{},r=xi(this._gridDomElm);if(!window||r===void 0)return null;let n=(t==null?void 0:t.bottomPadding)!==void 0?t.bottomPadding:pw;if(n&&e.enablePagination&&(n+=gw),n&&e.showCustomFooter){const _=((v=(m=this.gridOptions)==null?void 0:m.customFooterOptions)==null?void 0:v.footerHeight)??mw;n+=parseInt(`${_}`,10)}let s=0,a=0;t.calculateAvailableSizeBy==="container"?s=Dc(this._pageContainerElm,"height")||0:(s=window.innerHeight||0,a=(r==null?void 0:r.top)??0);const o=s-a-n,c=Dc(this._pageContainerElm,"width")||window.innerWidth||0,h=t==null?void 0:t.maxHeight,l=(t==null?void 0:t.minHeight)??vw,u=t==null?void 0:t.maxWidth,d=(t==null?void 0:t.minWidth)??_w;let f=o,p=t!=null&&t.rightPadding?c-t.rightPadding:c;return f<l&&(f=l),h&&f>h&&(f=h),p<d&&(p=d),u&&p>u&&(p=u),{height:this._fixedHeight||f,width:this._fixedWidth||p}}getLastResizeDimensions(){return this._lastDimensions}pauseResizer(e){this._resizePaused=e}resizeGrid(e,t){return new Promise(r=>{e=e||0,e>0?(clearTimeout(this._timer),this._timer=setTimeout(()=>r(this.resizeGridCallback(t)),e)):r(this.resizeGridCallback(t))})}resizeGridCallback(e){var r,n;const t=this.resizeGridWithDimensions(e);return this.pubSubService.publish("onGridAfterResize",t),this.gridOptions.enableAutoResizeColumnsByCellContent&&(!((r=this._lastDimensions)!=null&&r.width)||(t==null?void 0:t.width)!==((n=this._lastDimensions)==null?void 0:n.width))&&this.resizeColumnsByCellContent(!1),this._lastDimensions=t,t}resizeGridWithDimensions(e){var r,n,s,a;const t=this.calculateGridNewDimensions(this.gridOptions);if((e||t)&&this._gridDomElm){const o=e!=null&&e.height?e.height:t==null?void 0:t.height,c=e!=null&&e.width?e.width:t==null?void 0:t.width;this.gridOptions.autoHeight||(this._gridDomElm.style.height=`${o}px`),this._gridDomElm.style.width=`${c}px`,this._gridContainerElm&&(this._gridContainerElm.style.width=`${c}px`),(r=this._grid)!=null&&r.resizeCanvas&&this._gridContainerElm&&this._grid.resizeCanvas(),this._grid&&((n=this.gridOptions)!=null&&n.enableAutoSizeColumns)?this.gridUid&&document.querySelector(this.gridUidSelector)&&(!this._lastDimensions||this._lastDimensions.height!==o||this._lastDimensions.width!==c)&&this._grid.autosizeColumns():this.gridOptions.enableAutoResizeColumnsByCellContent&&(!((s=this._lastDimensions)!=null&&s.width)||c!==((a=this._lastDimensions)==null?void 0:a.width))&&this.resizeColumnsByCellContent(!1),this._lastDimensions={height:o||0,width:c||0}}return this._lastDimensions}requestStopOfAutoFixResizeGrid(e=!0){this._isStopResizeIntervalRequested=e}resizeColumnsByCellContent(e=!1){var h,l;const t=this._grid.getColumns(),r=this.dataView.getItems(),n={};let s=!1,a=0;const o=((h=this._gridContainerElm)==null?void 0:h.offsetWidth)??0;if(!Array.isArray(r)||r.length===0||!e&&this._totalColumnsWidthByContent>0&&this._totalColumnsWidthByContent<o){this._grid.autosizeColumns();return}if(this._hasResizedByContentAtLeastOnce&&((l=this.gridOptions)!=null&&l.resizeByContentOnlyOnFirstLoad)&&!e)return;if(this.pubSubService.publish("onBeforeResizeByContent",void 0,0),this._totalColumnsWidthByContent===0||e){for(const d of t)n[d.id]=d.originalWidth??d.minWidth??0;a=this.calculateCellWidthByReadingDataset(t,n,this.resizeByContentOptions.maxItemToInspectCellContentWidth);let u=0;for(const d of t){const f=d.resizeAlwaysRecalculateWidth??this.resizeByContentOptions.alwaysRecalculateColumnWidth??!1;d.originalWidth&&!f?d.width=d.originalWidth:n[d.id]!==void 0&&(d.rerenderOnResize&&(s=!0),this.applyNewCalculatedColumnWidthByReference(d,n[d.id])),u+=d.width||0,this._totalColumnsWidthByContent=u}}this._grid.setColumns(t),this._hasResizedByContentAtLeastOnce=!0;const c={};for(const u of t)c[u.id]=u.width;this._totalColumnsWidthByContent>o?this._grid.reRenderColumns(s):this._grid.autosizeColumns(),this.pubSubService.publish("onAfterResizeByContent",{readItemCount:a,calculateColumnWidths:c})}calculateCellWidthByReadingDataset(e,t,r=1e3,n){const s=Array.isArray(e)?e:[e],a=this.dataView.getItems();let o=0;for(const[c,h]of a.entries()){if(c>r)break;Array.isArray(s)&&typeof t=="object"&&s.forEach((l,u)=>{const d=this.calculateCellWidthByContent(h,l,c,n??u,t[l.id]);d!==void 0&&(t[l.id]=d)}),o=c+1}return o}calculateCellWidthByContent(e,t,r,n,s){const a=this.resizeByContentOptions.cellCharWidthInPx??7;if(!t.originalWidth){const o=(t==null?void 0:t.resizeCharWidthInPx)??a,c=Eh(t==null?void 0:t.formatter,r,n,t,e,this._grid),h=Rn(c),l=Math.ceil(h.length*o),u=t.resizeMaxWidthThreshold;t&&(s===void 0||l>s)&&(s=u!==void 0&&l>u?u:t.maxWidth!==void 0&&l>t.maxWidth?t.maxWidth:l)}return s}applyNewCalculatedColumnWidthByReference(e,t){var c;const r=this.resizeByContentOptions.cellPaddingWidthInPx??6,n=this.resizeByContentOptions.formatterPaddingWidthInPx??6,s=((c=e==null?void 0:e.filter)==null?void 0:c.type)??(e==null?void 0:e.type)??Y.string;let a=t;const o=(e==null?void 0:e.resizeCalcWidthRatio)??this.resizeByContentOptions.defaultRatioForStringType??.9;a*=s==="string"?o:1,a+=r,e.resizeExtraWidthPadding&&(a+=e.resizeExtraWidthPadding),e.editor&&this.gridOptions.editable&&(a+=n),e.maxWidth!==void 0&&a>e.maxWidth&&(a=e.maxWidth),e.resizeMaxWidthThreshold!==void 0&&a>e.resizeMaxWidthThreshold&&(a=e.resizeMaxWidthThreshold),a=Math.ceil(a),(e.originalWidth===void 0||e.resizeAlwaysRecalculateWidth===!0||this.resizeByContentOptions.alwaysRecalculateColumnWidth===!0)&&(e.width=this.readjustNewColumnWidthWhenOverLimit(e,a))}handleSingleColumnResizeByContent(e){const t=this._grid.getColumns(),r=t.findIndex(n=>n.id===e);if(r>=0){const n=t[r],s={[e]:n.originalWidth??n.minWidth??0};n.originalWidth=void 0,this.calculateCellWidthByReadingDataset(n,s,this.resizeByContentOptions.maxItemToInspectSingleColumnWidthByContent,r),this.applyNewCalculatedColumnWidthByReference(n,s[e]),this._grid.reRenderColumns((n==null?void 0:n.rerenderOnResize)??!1)}}readjustNewColumnWidthWhenOverLimit(e,t){var a,o;const r=this.gridOptions.frozenColumn??-1,n=this._grid.getColumns().findIndex(c=>c.id===e.id)??0;let s=t;if(r>=0&&n<=r){const c=Array.from(this._grid.getViewports());if(c){const h=((a=c.find(p=>p.classList.contains("slick-viewport-left")))==null?void 0:a.clientWidth)??0,l=((o=c.find(p=>p.classList.contains("slick-viewport-right")))==null?void 0:o.clientWidth)??0,u=h+l,d=h-(e.width??0);if(d+t>u){const p=this.resizeByContentOptions.widthToRemoveFromExceededWidthReadjustment??50;s=h-d+l-p}}}return Math.ceil(s)}checkIsGridShown(){var e;return!!(((e=document.querySelector(`${this.gridUidSelector}`))==null?void 0:e.offsetParent)??!1)}resizeGridWhenStylingIsBrokenUntilCorrected(){var o,c;const e=((o=this.gridOptions)==null?void 0:o.autoFixResizeTimeout)??18e3,t=((c=this.gridOptions)==null?void 0:c.autoFixResizeRequiredGoodCount)??5,r=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-header`),n=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-viewport`);let s=0,a=0;if(r&&n&&this.gridOptions.autoFixResizeWhenBrokenStyleDetected){const h=this.dataView.getItemCount(),l=this._grid.getColumns()||[];this._intervalId=setInterval(async()=>{var E,C,y;const d=xi(r);let f=(d==null?void 0:d.top)??0;(E=this.gridOptions)!=null&&E.enableFiltering&&this.gridOptions.headerRowHeight&&(f+=this.gridOptions.headerRowHeight),(C=this.gridOptions)!=null&&C.createPreHeaderPanel&&this.gridOptions.showPreHeaderPanel&&this.gridOptions.preHeaderPanelHeight&&(f+=this.gridOptions.preHeaderPanelHeight),f+=44;const p=xi(n),m=(p==null?void 0:p.top)??0,v=xi(this._gridContainerElm);let _=(d==null?void 0:d.top)===0||f-m>2||(v==null?void 0:v.left)===0&&(v==null?void 0:v.top)===0;const x=((y=this._grid.getRenderedRange())==null?void 0:y.rightPx)??0;!_&&h>0&&x===0&&l.length>1&&(_=!0),this._isStopResizeIntervalRequested&&(_=!1,s=e),this.checkIsGridShown()&&(_||(v==null?void 0:v.left)===0||(v==null?void 0:v.top)===0)&&(await this.resizeGrid(),this.checkIsGridShown()&&(_=!1)),this.checkIsGridShown()&&a++,this.checkIsGridShown()&&!_&&(a>=t||s++>=e)&&clearInterval(this._intervalId)},this.intervalRetryDelay)}}}class ww{constructor(){this._hasColumnsReordered=!1,this._hideHeaderRowAfterPageLoad=!1}get allColumns(){return this._allColumns}set allColumns(e){this._allColumns=e}get columnDefinitions(){var e;return((e=this._grid)==null?void 0:e.getColumns())??[]}get currentPagination(){return this._currentPagination}set currentPagination(e){this._currentPagination=e}get dataView(){return this._dataView}set dataView(e){this._dataView=e}get frozenVisibleColumnId(){return this._frozenVisibleColumnId}set frozenVisibleColumnId(e){this._frozenVisibleColumnId=e}get hasColumnsReordered(){return this._hasColumnsReordered}set hasColumnsReordered(e){this._hasColumnsReordered=e}get slickGrid(){return this._grid}set slickGrid(e){this._grid=e}get gridContainerElement(){return this._gridContainerElm}set gridContainerElement(e){this._gridContainerElm=e}get gridOptions(){var e;return this._gridOptions||((e=this._grid)==null?void 0:e.getOptions())||{}}set gridOptions(e){this._gridOptions=e}get groupItemMetadataProvider(){return this._groupItemMetadataProvider}set groupItemMetadataProvider(e){this._groupItemMetadataProvider=e}get hideHeaderRowAfterPageLoad(){return this._hideHeaderRowAfterPageLoad}set hideHeaderRowAfterPageLoad(e){this._hideHeaderRowAfterPageLoad=e}get externalRegisteredResources(){return this._externalRegisteredResources}set externalRegisteredResources(e){this._externalRegisteredResources=e}get visibleColumns(){return this._visibleColumns}set visibleColumns(e){this._visibleColumns=e}get hierarchicalDataset(){return this._hierarchicalDataset}set hierarchicalDataset(e){this._hierarchicalDataset=e}}class Cw{constructor(e,t,r,n){this.sharedService=e,this.pubSubService=t,this.backendUtilities=r,this.rxjs=n,this._currentLocalSorters=[],this._isBackendGrid=!1,this._eventHandler=new di,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get _gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get _columnDefinitions(){var e;return((e=this._grid)==null?void 0:e.getColumns())??[]}dispose(){var e,t;(e=this._eventHandler)!=null&&e.unsubscribeAll&&this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&((t=this.rxjs)!=null&&t.isObservable(this.httpCancelRequests$))&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete())}addRxJsResource(e){this.rxjs=e}bindBackendOnSort(e){this._isBackendGrid=!0,this._grid=e,this._dataView=e==null?void 0:e.getData(),this._eventHandler.subscribe(e.onSort,this.onBackendSortChanged.bind(this))}bindLocalOnSort(e){this._isBackendGrid=!1,this._grid=e,this._dataView=e==null?void 0:e.getData(),this.processTreeDataInitialSort(),this._eventHandler.subscribe(e.onSort,this.handleLocalOnSort.bind(this))}handleLocalOnSort(e,t){var n;const r=t.multiColumnSort?t.sortCols:new Array({columnId:((n=t.sortCol)==null?void 0:n.id)??"",sortAsc:t.sortAsc,sortCol:t.sortCol});this._currentLocalSorters=[],Array.isArray(r)&&r.forEach(s=>{s.sortCol&&this._currentLocalSorters.push({columnId:s.sortCol.id,direction:s.sortAsc?kn.ASC:kn.DESC})}),this.onLocalSortChanged(this._grid,r),this.emitSortChanged(ri.local)}clearSortByColumnId(e,t){var s;const r=this.getCurrentColumnSorts(),n=this.getCurrentColumnSorts(`${t}`);if(Array.isArray(r)&&Array.isArray(n)&&r.length!==n.length){if(this._gridOptions.backendServiceApi)this.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:n,grid:this._grid});else if(this._dataView)this.onLocalSortChanged(this._grid,n,!0,!0);else{const c=((s=this._gridOptions)==null?void 0:s.multiColumnSort)??!1?n:n[0];this._grid.onSort.notify(c)}const a=n.map(o=>{var c;return{columnId:((c=o==null?void 0:o.sortCol)==null?void 0:c.id)??"",sortAsc:o==null?void 0:o.sortAsc,sortCol:o==null?void 0:o.sortCol}});this._grid.setSortColumns(a)}Array.isArray(n)&&n.length===0&&this.sortLocalGridByDefaultSortFieldId()}clearSorting(e=!0){var t,r;if(this._grid&&this._gridOptions&&this._dataView){if(this._grid.setSortColumns([]),e)this._isBackendGrid?this.onBackendSortChanged(void 0,{grid:this._grid,multiColumnSort:!0,sortCols:[],clearSortTriggered:!0}):this._columnDefinitions&&Array.isArray(this._columnDefinitions)&&this._columnDefinitions.length>0&&this.sortLocalGridByDefaultSortFieldId();else if(this._isBackendGrid){const n=(r=(t=this._gridOptions)==null?void 0:t.backendServiceApi)==null?void 0:r.service;n!=null&&n.clearSorters&&n.clearSorters()}}this._currentLocalSorters=[],this.pubSubService.publish("onSortCleared",!0)}disableSortFunctionality(e=!0,t=!0){const n=!this._gridOptions.enableSorting;this._gridOptions.enableSorting=n;let s;e?(t&&this.clearSorting(),this._eventHandler.unsubscribeAll(),s=this.disableAllSortingCommands(!0)):(s=this.disableAllSortingCommands(!1),this._eventHandler.subscribe(this._grid.onSort,(a,o)=>this.handleLocalOnSort(a,o))),this._grid.setOptions({enableSorting:this._gridOptions.enableSorting},!1,!0),this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(s)}toggleSortFunctionality(e=!0){const t=this._gridOptions.enableSorting;this.disableSortFunctionality(t,e)}emitSortChanged(e,t){var r;if(e===ri.remote&&((r=this._gridOptions)!=null&&r.backendServiceApi)){let n=[];const s=this._gridOptions.backendServiceApi.service;s!=null&&s.getCurrentSorters&&(n=s.getCurrentSorters()),this.pubSubService.publish("onSortChanged",n)}else e===ri.local&&(t&&(this._currentLocalSorters=t),this.pubSubService.publish("onSortChanged",this.getCurrentLocalSorters()))}getCurrentLocalSorters(){return this._currentLocalSorters}getCurrentColumnSorts(e){if(this._grid){const t=this._grid.getSortColumns();if(Array.isArray(t))return t.reduce((n,s)=>(s&&(!e||s.columnId!==e)&&n.push({columnId:s.columnId||"",sortCol:this._columnDefinitions[this._grid.getColumnIndex(s.columnId||"")],sortAsc:s.sortAsc}),n),[])}return[]}loadGridSorters(e){this._currentLocalSorters=[];const t=[];return Array.isArray(e)&&((this._gridOptions.multiColumnSort?e:e.slice(0,1)).forEach(n=>{const s=this._columnDefinitions.find(a=>a.id===n.columnId);if(s){if(!s.sortable){let a="[Slickgrid-Universal] Cannot add sort icon to a column that is not sortable, please add `sortable: true` to your column or remove it from your list of columns to sort.";throw this._gridOptions.enableTreeData&&(a+=" Also note that TreeData feature requires the column holding the tree (expand/collapse icons) to be sortable."),new Error(a)}t.push({columnId:s.id,sortAsc:n.direction.toUpperCase()===kn.ASC,sortCol:s}),this._currentLocalSorters.push({columnId:String(s.id),direction:n.direction.toUpperCase()})}}),this.onLocalSortChanged(this._grid,t),this._grid.setSortColumns(t.map(n=>({columnId:n.columnId,sortAsc:n.sortAsc})))),t}processTreeDataInitialSort(){var e,t,r;if((e=this._gridOptions)!=null&&e.enableTreeData&&this._gridOptions.treeDataOptions){const n=this._gridOptions.treeDataOptions;if(this._columnDefinitions.find(a=>a.id===n.columnId)){let a=kn.ASC,o={columnId:n.columnId};if((t=n==null?void 0:n.initialSort)!=null&&t.columnId){const c=n.initialSort.columnId,h=this._columnDefinitions.find(l=>l.id===c);a=(n.initialSort.direction||kn.ASC).toUpperCase(),o={columnId:c,sortCol:h,sortAsc:a===kn.ASC}}o!=null&&o.columnId&&((r=this.sharedService)!=null&&r.hierarchicalDataset)&&this.updateSorting([{columnId:o.columnId||"",direction:a}])}}}onBackendSortChanged(e,t){var c,h,l;if(!t||!t.grid)throw new Error('Something went wrong when trying to bind the "onBackendSortChanged(event, args)" function, it seems that "args" is not populated correctly');const r=((c=t.grid)==null?void 0:c.getOptions())??{},n=r.backendServiceApi;if(!n||!n.process||!n.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');const s=new Date;n.preProcess&&n.preProcess();const a=n.service.processOnSortChanged(e,t),o=((h=r==null?void 0:r.pagination)==null?void 0:h.totalItems)||0;(l=this.backendUtilities)==null||l.executeBackendCallback(n,a,t,s,o,{emitActionChangedCallback:this.emitSortChanged.bind(this),errorCallback:()=>{var d,f,p;this._grid.setSortColumns(t.previousSortColumns||[]);const u=(d=t.previousSortColumns)==null?void 0:d.map(m=>({columnId:m.columnId,sortAsc:m.sortAsc,sortCol:this._columnDefinitions.find(v=>v.id===m.columnId)}));(p=(f=n==null?void 0:n.service)==null?void 0:f.updateSorters)==null||p.call(f,u||[])},httpCancelRequestSubject:this.httpCancelRequests$})}async onLocalSortChanged(e,t,r=!1,n=!1){var c,h;const s=((c=this._gridOptions)==null?void 0:c.datasetIdPropertyName)??"id",a=((h=this._gridOptions)==null?void 0:h.enableTreeData)??!1,o=e.getData();if(await this.pubSubService.publish("onBeforeSortChange",{sortColumns:t},0),e&&o){if(r&&!a&&o.reSort(),a&&this.sharedService&&Array.isArray(this.sharedService.hierarchicalDataset)){const l=this.sortHierarchicalDataset(this.sharedService.hierarchicalDataset,t);this._dataView.setItems(l.flat,s),this._dataView.onRowCountChanged.notify({previous:this._dataView.getFilteredItemCount(),current:this._dataView.getLength(),itemCount:this._dataView.getItemCount(),dataView:this._dataView,callingOnRowsChanged:!0})}else o.sort(this.sortComparers.bind(this,t));e.invalidate(),n&&this.emitSortChanged(ri.local,t.map(l=>{var u;return{columnId:((u=l.sortCol)==null?void 0:u.id)??"id",direction:l.sortAsc?kn.ASC:kn.DESC}}))}}sortHierarchicalDataset(e,t,r=!1){var c,h,l;this.sortTreeData(e,t);const n=((c=this._gridOptions)==null?void 0:c.datasetIdPropertyName)??"id",s=((h=this._gridOptions)==null?void 0:h.treeDataOptions)??{columnId:""},a={...s,identifierPropName:s.identifierPropName??n,shouldAddTreeLevelNumber:!0},o=Mm(e,a);if(r){this._currentLocalSorters=[],t.forEach(d=>{this._currentLocalSorters.push({columnId:d.columnId,direction:d.sortAsc?"ASC":"DESC"})});const u=(l=this._gridOptions)!=null&&l.backendServiceApi?ri.remote:ri.local;this.emitSortChanged(u)}return{hierarchical:e,flat:o}}sortLocalGridByDefaultSortFieldId(){const e=this._gridOptions&&this._gridOptions.defaultColumnSortFieldId||this._gridOptions.datasetIdPropertyName||"id",t={id:e,field:e};this.onLocalSortChanged(this._grid,new Array({columnId:t.id,sortAsc:!0,sortCol:t,clearSortTriggered:!0}),!1,!0)}sortComparers(e,t,r){if(Array.isArray(e))for(const n of e){const s=this.sortComparer(n,t,r);if(s!==void 0)return s}return ii.neutral}sortComparer(e,t,r,n){if(e!=null&&e.sortCol){const s=e.sortCol,a=e.sortAsc?ii.asc:ii.desc;let o=n||s.queryFieldSorter||s.queryField||s.field,c=o;const h=s.type||Y.string;typeof s.queryFieldNameGetterFn=="function"&&(o=s.queryFieldNameGetterFn(t),c=s.queryFieldNameGetterFn(r));let l=t[o],u=r[c];if((o==null?void 0:o.indexOf("."))>=0&&(l=Ti(t,o)),(c==null?void 0:c.indexOf("."))>=0&&(u=Ti(r,c)),s.sortComparer){const d=s.sortComparer(l,u,a,s,this._gridOptions);if(d!==ii.neutral)return d}else{const d=Ka(h,l,u,a,s,this._gridOptions);if(d!==ii.neutral)return d}}}sortTreeData(e,t){Array.isArray(t)&&t.forEach(r=>{this.sortTreeChildren(e,r,0)})}sortTreeChildren(e,t,r){var a;const n=(a=this._gridOptions)==null?void 0:a.treeDataOptions,s=(n==null?void 0:n.childrenPropName)??"children";e.sort((o,c)=>this.sortComparer(t,o,c)??ii.neutral),e.forEach(o=>{o&&o.hasOwnProperty(s)&&Array.isArray(o[s])&&(r++,this.sortTreeChildren(o[s],t,r),r--)})}updateSorting(e,t=!0,r=!0){var n,s;if(!this._gridOptions||!this._gridOptions.enableSorting)throw new Error('[Slickgrid-Universal] in order to use "updateSorting" method, you need to have Sortable Columns defined in your grid and "enableSorting" set in your Grid Options');if(Array.isArray(e)){const a=(n=this._gridOptions)==null?void 0:n.backendServiceApi;if(a){const o=a==null?void 0:a.service;o!=null&&o.updateSorters&&(o.updateSorters(void 0,e),r&&((s=this.backendUtilities)==null||s.refreshBackendDataset(this._gridOptions)))}else this.loadGridSorters(e);if(t){const o=a?ri.remote:ri.local;this.emitSortChanged(o)}}}disableAllSortingCommands(e=!0){var n,s;const t=this._grid.getColumns();t.forEach(a=>{var o,c;typeof a.sortable!==void 0&&(a.sortable=!e),(o=a==null?void 0:a.header)!=null&&o.menu&&((c=a.header.menu.commandItems)==null||c.forEach(h=>{if(h&&typeof h!="string"){const l=h.command;(l==="sort-asc"||l==="sort-desc"||l==="clear-sort")&&(h.hidden=e)}}))});const r=(s=(n=this._gridOptions)==null?void 0:n.gridMenu)==null?void 0:s.commandItems;return r&&r.forEach(a=>{a&&typeof a!="string"&&a.command==="clear-sorting"&&(a.hidden=e)}),t}}class yw{constructor(e,t,r){this.pubSubService=e,this.sharedService=t,this.sortService=r,this._currentToggledItems=[],this._isLastFullToggleCollapsed=!1,this._isOneCpuCyclePassed=!1,this._isTreeDataEnabled=!1,this._subscriptions=[],this._treeDataRecalcHandler=null,this._eventHandler=new di,setTimeout(()=>this._isOneCpuCyclePassed=!0)}set currentToggledItems(e){this._currentToggledItems=e}get dataset(){var e;return(e=this.dataView)==null?void 0:e.getItems()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}get dataView(){var e;return(e=this._grid)==null?void 0:e.getData()}get eventHandler(){return this._eventHandler}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}get treeDataOptions(){return this.gridOptions.treeDataOptions}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}init(e){var t,r,n,s,a,o,c,h;if(this._grid=e,this._isTreeDataEnabled=((t=this.gridOptions)==null?void 0:t.enableTreeData)??!1,this._isLastFullToggleCollapsed=((r=this.treeDataOptions)==null?void 0:r.initiallyCollapsed)??!1,this._currentToggledItems=((s=(n=this.gridOptions.presets)==null?void 0:n.treeData)==null?void 0:s.toggledItems)??[],this._lastToggleStateChange={type:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this._isTreeDataEnabled){if((a=this.gridOptions)!=null&&a.multiColumnSort)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data with multi-column sorting, unfortunately it is not supported because of its complexity, you can disable it via "multiColumnSort: false" grid option and/or help in providing support for this feature.');if(!((o=this.gridOptions)!=null&&o.enableFiltering))throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data without using the filtering option, unfortunately that is not possible with Tree Data since it relies heavily on the filters to expand/collapse the tree. You need to enable it via "enableFiltering: true"');if((c=this.gridOptions)!=null&&c.backendServiceApi||(h=this.gridOptions)!=null&&h.enablePagination)throw new Error("[Slickgrid-Universal] It looks like you are trying to use Tree Data with Pagination and/or a Backend Service (OData, GraphQL) but unfortunately that is simply not supported because of its complexity.");if(!this.gridOptions.treeDataOptions||!this.gridOptions.treeDataOptions.columnId)throw new Error('[Slickgrid-Universal] When enabling tree data, you must also provide the "treeDataOption" property in your Grid Options with "childrenPropName" or "parentPropName" (depending if your array is hierarchical or flat) for the Tree Data to work properly.')}this._eventHandler.subscribe(e.onClick,this.handleOnCellClick.bind(this)),this._subscriptions.push(this.pubSubService.subscribe("onGridMenuClearAllSorting",this.clearSorting.bind(this))),this._treeDataRecalcHandler=this.setAutoRecalcTotalsCallbackWhenFeatEnabled(this.gridOptions),this._eventHandler.subscribe(this.dataView.onRowCountChanged,()=>{var l;typeof this._treeDataRecalcHandler=="function"&&this._isOneCpuCyclePassed&&(clearTimeout(this._timer),this._timer=setTimeout(()=>{var u;return(u=this._treeDataRecalcHandler)==null?void 0:u.call(this)},((l=this.treeDataOptions)==null?void 0:l.autoRecalcTotalsDebounce)??0))})}applyToggledItemStateChanges(e,t,r=!0,n=!1){if(Array.isArray(e)){const s=this.getTreeDataOptionPropName("collapsedPropName"),a=this.getTreeDataOptionPropName("hasChildrenPropName");this.dataView.beginUpdate(!0);const c=(t??this._lastToggleStateChange.previousFullToggleType)==="full-collapse";t&&(this._lastToggleStateChange.previousFullToggleType=t),r&&(this.dataView.getItems()||[]).forEach(h=>{h[a]&&(h[s]=c)}),this.dynamicallyToggleItemState(e,n)}}dynamicallyToggleItemState(e,t=!0){Array.isArray(e)&&(this.dataView.beginUpdate(!0),e.forEach(r=>{const n=this.dataView.getItemById(r.itemId);if(this.updateToggledItem(n,r.isCollapsed),t){const s=this._currentToggledItems.findIndex(a=>a.itemId===r.itemId);s>=0?this._currentToggledItems[s].isCollapsed=r.isCollapsed:this._currentToggledItems.push({itemId:r.itemId,isCollapsed:r.isCollapsed}),this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:r.itemId,toggledItems:this._currentToggledItems,type:r.isCollapsed?is.toggleCollapse:is.toggleExpand})}}),this.dataView.endUpdate(),this.dataView.refresh())}getCurrentToggleState(){return this._lastToggleStateChange}getInitialSort(e,t){var a;const r=t==null?void 0:t.treeDataOptions,n=(r==null?void 0:r.initialSort)??{columnId:(r==null?void 0:r.columnId)??"",direction:"ASC"},s=e.find(o=>o.id===n.columnId);return{columnId:n.columnId,sortAsc:((a=n==null?void 0:n.direction)==null?void 0:a.toUpperCase())!=="DESC",sortCol:s}}getItemCount(e){if(e!==void 0){const t=this.getTreeDataOptionPropName("levelPropName");return this.dataView.getItems().filter(r=>r[t]===e).length}return this.dataView.getItemCount()}getToggledItems(){return this._currentToggledItems}getTreeDataOptionPropName(e){var r,n,s,a,o,c,h;let t="";switch(e){case"childrenPropName":t=((r=this.treeDataOptions)==null?void 0:r.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP;break;case"collapsedPropName":t=((n=this.treeDataOptions)==null?void 0:n.collapsedPropName)??ye.treeDataProperties.COLLAPSED_PROP;break;case"hasChildrenPropName":t=((s=this.treeDataOptions)==null?void 0:s.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP;break;case"identifierPropName":t=((a=this.treeDataOptions)==null?void 0:a.identifierPropName)??((o=this.gridOptions)==null?void 0:o.datasetIdPropertyName)??"id";break;case"levelPropName":t=((c=this.treeDataOptions)==null?void 0:c.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP;break;case"parentPropName":t=((h=this.treeDataOptions)==null?void 0:h.parentPropName)??ye.treeDataProperties.PARENT_PROP;break}return t}clearSorting(){const e=this.getInitialSort(this.sharedService.columnDefinitions,this.sharedService.gridOptions);this.sortService.loadGridSorters([{columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"}])}convertFlatParentChildToTreeDatasetAndSort(e,t,r){var o;const n=this.convertFlatParentChildToTreeDataset(e,r),s=this.getInitialSort(t,r),a=this.sortService.sortHierarchicalDataset(n,[s],!0);return(o=this._grid)==null||o.setSortColumns([s]),a}convertFlatParentChildToTreeDataset(e,t){const r=(t==null?void 0:t.datasetIdPropertyName)??"id",n=(t==null?void 0:t.treeDataOptions)??{columnId:"id"},s={...n,identifierPropName:n.identifierPropName??r,initiallyCollapsed:this._isLastFullToggleCollapsed};return Lm(e,s)}enableAutoRecalcTotalsFeature(e=!0){e&&this._isTreeDataEnabled?this._treeDataRecalcHandler=this.recalculateTreeTotals.bind(this,this.gridOptions):this._treeDataRecalcHandler=null}recalculateTreeTotals(e){const t=e.treeDataOptions,r=(t==null?void 0:t.childrenPropName)??ye.treeDataProperties.CHILDREN_PROP,n=(t==null?void 0:t.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP;t!=null&&t.aggregators&&(t.aggregators.forEach(s=>{yl(this.sharedService.hierarchicalDataset||[],{childrenPropName:r,levelPropName:n,aggregator:s})}),this._grid.invalidate())}sortHierarchicalDataset(e,t){const r=t??this.getInitialSort(this.sharedService.allColumns,this.gridOptions),n=Array.isArray(r)?r:[r];return this.sortService.sortHierarchicalDataset(e,n)}async toggleTreeDataCollapse(e,t=!0){var n;if((n=this.gridOptions)!=null&&n.enableTreeData){const s=this.getTreeDataOptionPropName("hasChildrenPropName");t&&await this.pubSubService.publish("onTreeFullToggleStart",{collapsing:e}),this.dataView.beginUpdate(!0),(this.dataView.getItems()||[]).forEach(a=>{a[s]&&this.updateToggledItem(a,e)}),this.dataView.endUpdate(),this.dataView.refresh(),this._isLastFullToggleCollapsed=e}const r=e?is.fullCollapse:is.fullExpand;this._lastToggleStateChange={type:r,previousFullToggleType:r,toggledItems:null},t&&this.pubSubService.publish("onTreeFullToggleEnd",this._lastToggleStateChange)}handleOnCellClick(e,t){if(e&&t){const r=e.target||{},n=this.gridOptions.datasetIdPropertyName??"id",s=this.getTreeDataOptionPropName("collapsedPropName"),a=this.getTreeDataOptionPropName("childrenPropName");if(typeof(r==null?void 0:r.className)=="string"&&(r.className.indexOf("toggle")>=0||!1)){const c=this.dataView.getItem(t.row);if(c){c[s]=!c[s];const h=c[s],l=c[n],u=this._currentToggledItems.findIndex(p=>p.itemId===l);u>=0?this._currentToggledItems[u].isCollapsed=h:this._currentToggledItems.push({itemId:l,isCollapsed:h}),this.dataView.updateItem(l,c);const d=p=>p[n]===l,f=el(this.sharedService.hierarchicalDataset||[],d,a);f&&(f[s]=h),this._grid.invalidate(),this._lastToggleStateChange={type:h?is.toggleCollapse:is.toggleExpand,previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:l})}e.stopImmediatePropagation()}}}updateToggledItem(e,t){var a;const r=((a=this.gridOptions)==null?void 0:a.datasetIdPropertyName)??"id",n=this.getTreeDataOptionPropName("childrenPropName"),s=this.getTreeDataOptionPropName("collapsedPropName");if(e){e[s]=t,this.dataView.updateItem(e[r],e);const o=h=>h[r]===e[r],c=el(this.sharedService.hierarchicalDataset||[],o,n);c&&(c[s]=t)}}setAutoRecalcTotalsCallbackWhenFeatEnabled(e){var t,r;return e!=null&&e.enableTreeData&&((t=e==null?void 0:e.treeDataOptions)!=null&&t.autoRecalcTotalsOnFilterChange)&&((r=e==null?void 0:e.treeDataOptions)!=null&&r.aggregators)?this.recalculateTreeTotals.bind(this,e):null}}class Bs{constructor(e){this.translaterService=e,this._debounceTypingDelay=0,this._shouldTriggerQuery=!0,this._inputType="text",this.inputFilterType="single",this.searchTerms=[],this._bindEventService=new Xi}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)??{}}get defaultOperator(){return tt.empty}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get operator(){var e;return((e=this.columnFilter)==null?void 0:e.operator)??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}init(e){var n,s,a;if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.inputFilterType==="compound"&&(this.operator=e.operator||""),this.searchTerms=(e==null?void 0:e.searchTerms)??[],this._cellContainerElm=e.filterContainerElm;const t=(n=this.gridOptions)==null?void 0:n.backendServiceApi;this._debounceTypingDelay=(t?(t==null?void 0:t.filterTypingDebounce)??((s=this.gridOptions)==null?void 0:s.defaultBackendServiceFilterTypingDebounce):(a=this.gridOptions)==null?void 0:a.filterTypingDebounce)??0;const r=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(r),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this)),this._bindEventService.bind(this._filterInputElm,"wheel",this.onTriggerEvent.bind(this),{passive:!0}),this.inputFilterType==="compound"&&this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this))}clear(e=!0){this._filterInputElm&&(this._shouldTriggerQuery=e,this.searchTerms=[],this._filterInputElm.value="",this._currentValue=void 0,this.inputFilterType==="compound"&&this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0,this._filterContainerElm.classList.remove("filled")),this._filterInputElm.classList.remove("filled"),this.onTriggerEvent(void 0,!0))}destroy(){var e,t,r,n;this._bindEventService.unbindAll(),(t=(e=this._selectOperatorElm)==null?void 0:e.remove)==null||t.call(e),(n=(r=this._filterInputElm)==null?void 0:r.remove)==null||n.call(r)}getValues(){return this._filterInputElm.value}setValues(e,t){const r=Array.isArray(e)?e:[e];let n="";for(const s of r)this.inputFilterType==="single"?n=t?this.addOptionalOperatorIntoSearchString(s,t):s:n=`${s}`,this._filterInputElm.value=`${n??""}`,this._currentValue=this._filterInputElm.value;if(this.getValues()!==""?(this._filterContainerElm.classList.add("filled"),this._filterInputElm.classList.add("filled")):(this._filterContainerElm.classList.remove("filled"),this._filterInputElm.classList.remove("filled")),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){const s=no(this.operator);this._selectOperatorElm.value=s}}addOptionalOperatorIntoSearchString(e,t){let r="",n="",s=e==null?"":`${e}`;if(t&&s){switch(t){case"<>":case"!=":case"=":case"==":case">":case">=":case"<":case"<=":r=t;break;case"EndsWith":case"*z":r="*";break;case"StartsWith":case"a*":n="*";break}s=`${r}${s}${n}`}return s}getCompoundOperatorOptionValues(){var r;const e=this.columnDef.type&&this.columnDef.type?this.columnDef.type:Y.string;let t=[];if((r=this.columnFilter)!=null&&r.compoundOperatorList)return this.columnFilter.compoundOperatorList;switch(e){case Y.string:case Y.text:case Y.readonly:case Y.password:t=QE(this.gridOptions,this.translaterService);break;default:t=Md(this.gridOptions,this.translaterService);break}return t}createDomFilterElement(e){var s,a,o,c;const t=((s=this.columnDef)==null?void 0:s.id)??"";Rt(this._cellContainerElm);let r=((a=this.gridOptions)==null?void 0:a.defaultFilterPlaceholder)??"";(o=this.columnFilter)!=null&&o.placeholder&&(r=this.columnFilter.placeholder);const n=`${e??""}`;if(this._filterInputElm=K("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",placeholder:r,ariaLabel:((c=this.columnFilter)==null?void 0:c.ariaLabel)??`${rn(t+"")} Search Filter`,className:`form-control filter-${t}`,value:n,dataset:{columnid:`${t}`}}),e&&this._filterInputElm.classList.add("filled"),e!==void 0&&(this._currentValue=n),this.inputFilterType==="single")this._filterContainerElm=this._filterInputElm,this._filterInputElm.classList.add("search-filter"),this._cellContainerElm.appendChild(this._filterInputElm),this._cellContainerElm.appendChild(document.createElement("span"));else{this._filterInputElm.classList.add("compound-input"),this._selectOperatorElm=Nd(this.getCompoundOperatorOptionValues(),this.grid),this._filterContainerElm=K("div",{className:`form-group search-filter filter-${t}`});const h=K("div",{className:"input-group"},this._filterContainerElm);K("div",{className:"input-group-addon input-group-prepend operator"},h).appendChild(this._selectOperatorElm),h.appendChild(this._filterInputElm),h.appendChild(K("span")),this.operator&&(this._selectOperatorElm.value=no(this.operator)),this._filterContainerElm&&this._cellContainerElm.appendChild(this._filterContainerElm)}}onTriggerEvent(e,t=!1){var r,n;if(t)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterContainerElm.classList.remove("filled");else{const s=(e==null?void 0:e.type)??"",a=((r=this._selectOperatorElm)==null?void 0:r.value)??this.operator;let o=this._filterInputElm.value;const c=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;typeof o=="string"&&c&&(o=o.trim()),((n=e==null?void 0:e.target)==null?void 0:n.tagName.toLowerCase())!=="select"&&(this._currentValue=o),o===""?this._filterContainerElm.classList.remove("filled"):this._filterContainerElm.classList.add("filled");const h={columnDef:this.columnDef,operator:a,searchTerms:o?[o]:null,shouldTriggerQuery:this._shouldTriggerQuery},l=s==="keyup"&&(e==null?void 0:e.key)!=="Enter"?this._debounceTypingDelay:0,u=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput;(this.inputFilterType==="single"||!u||this._currentValue!==void 0)&&(l>0?(clearTimeout(this._timer),this._timer=setTimeout(()=>this.callback(e,h),l)):this.callback(e,h))}this._shouldTriggerQuery=!0}}class up extends Bs{constructor(e){super(e),this.translaterService=e,this.inputType="text",this.inputFilterType="compound"}}class Sw extends Bs{constructor(e){super(e),this.translaterService=e,this.inputType="number",this.inputFilterType="compound"}}class bw extends Bs{constructor(e){super(e),this.translaterService=e,this.inputType="password",this.inputFilterType="compound"}}const Au="#86bff8",ac=0,Tw=20;class zd{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._sliderTrackFilledColor=Au,this.sliderType="double",this.searchTerms=[],this._bindEventService=new Xi}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)??{}}get currentValue(){return this._currentValue}get currentValues(){return this._currentValues}get defaultOperator(){return this.sliderType==="compound"?tt.empty:this.sliderType==="single"?tt.greaterThanOrEqual:this.gridOptions.defaultFilterRangeOperator||tt.rangeInclusive}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get sliderOptions(){return this._sliderOptions}get operator(){return this._operator||(this.columnFilter.operator??this.defaultOperator)}set operator(e){this._operator=e}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.operator=e.operator||"",this.searchTerms=(e==null?void 0:e.searchTerms)??[],this._argFilterContainerElm=e.filterContainerElm,this._sliderTrackFilledColor=window.getComputedStyle(document.documentElement).getPropertyValue("--slick-slider-filter-filled-track-color")||Au,this._filterElm=this.createDomFilterElement(this.searchTerms)}clear(e=!0){var t,r,n,s,a,o,c;if(this._filterElm){this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[];const h=+(((t=this.columnFilter.filterOptions)==null?void 0:t.sliderStartValue)??ye.SLIDER_DEFAULT_MIN_VALUE),l=+(((r=this.columnFilter.filterOptions)==null?void 0:r.sliderEndValue)??ye.SLIDER_DEFAULT_MAX_VALUE);this.sliderType==="double"?(this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=`${h}`),this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${l}`),this._currentValues=[h,l],(n=this._sliderLeftInputElm)==null||n.dispatchEvent(new Event("change")),(s=this._sliderRightInputElm)==null||s.dispatchEvent(new Event("change"))):(this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${h}`),this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this._currentValue=h,(a=this._sliderRightInputElm)==null||a.dispatchEvent(new Event("change"))),(((o=this.columnFilter.filterOptions)==null?void 0:o.hideSliderNumber)??((c=this.columnFilter.filterOptions)==null?void 0:c.hideSliderNumbers))||(this.sliderType==="double"?this.renderSliderValues(h,l):this.renderSliderValues(void 0,h)),this._divContainerFilterElm.classList.remove("filled"),this._filterElm.classList.remove("filled"),this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:e,searchTerms:[]})}}destroy(){var e,t,r;this._bindEventService.unbindAll(),(e=this._sliderTrackElm)==null||e.remove(),(t=this._sliderLeftInputElm)==null||t.remove(),(r=this._sliderRightInputElm)==null||r.remove()}renderSliderValues(e,t){var r,n;(r=this._leftSliderNumberElm)!=null&&r.textContent&&e&&(this._leftSliderNumberElm.textContent=e.toString()),(n=this._rightSliderNumberElm)!=null&&n.textContent&&t&&(this._rightSliderNumberElm.textContent=t.toString())}getValues(){return this.sliderType==="double"?this._currentValues:this._currentValue}setValues(e,t){var s;if(e){let a=[];const o=Array.isArray(e)?e==null?void 0:e[0]:e;if(Array.isArray(e)&&e.length===2?a=e:typeof o=="string"&&o.indexOf("..")>0?(a=o.split(".."),this._currentValue=+((a==null?void 0:a[0])??0)):(gh(o)||o==="")&&(this._currentValue=o===null?void 0:+o,a=[o]),this.sliderType!=="double"&&this._sliderRightInputElm)this._sliderRightInputElm.value=typeof e=="string"?e:`${o}`,this.renderSliderValues(void 0,this._sliderRightInputElm.value);else if(Array.isArray(a)&&a.length===2&&!((s=this.columnFilter.filterOptions)!=null&&s.hideSliderNumbers)){const[c,h]=a;this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=String(c??ye.SLIDER_DEFAULT_MIN_VALUE)),this._sliderRightInputElm&&(this._sliderRightInputElm.value=String(h??ye.SLIDER_DEFAULT_MAX_VALUE)),this.renderSliderValues(...a)}}else this._currentValue=void 0,this._currentValues=void 0;const r=this.getValues();if((r===void 0?[]:Array.isArray(r)?r:[r]).length>0?this._filterElm.classList.add("filled"):this._filterElm.classList.remove("filled"),t!==void 0&&(this.operator=t),this.operator&&this._selectOperatorElm){const a=no(this.operator);this._selectOperatorElm.value=a}}createDomFilterElement(e){var u,d,f,p,m,v;const t=((u=this.columnDef)==null?void 0:u.id)??"",r=+(this.columnFilter.minValue??ye.SLIDER_DEFAULT_MIN_VALUE),n=+(this.columnFilter.maxValue??ye.SLIDER_DEFAULT_MAX_VALUE),s=+(this.columnFilter.valueStep??ye.SLIDER_DEFAULT_STEP);Rt(this._argFilterContainerElm);const a=+((Array.isArray(e)&&(e==null?void 0:e[0]))??((d=this.columnFilter.filterOptions)==null?void 0:d.sliderStartValue)??r),o=+((Array.isArray(e)&&(e==null?void 0:e[1]))??((f=this.columnFilter.filterOptions)==null?void 0:f.sliderEndValue)??n);if(this._sliderRangeContainElm=K("div",{className:`filter-input filter-${t} slider-input-container slider-values`,title:this.sliderType==="double"?`${a} - ${o}`:`${a}`}),this._sliderTrackElm=K("div",{className:"slider-track"}),this.sliderType==="compound"){const _=K("span",{className:"input-group-addon input-group-prepend operator"});this._selectOperatorElm=Nd(this.getOperatorOptionValues(),this.grid),_.appendChild(this._selectOperatorElm)}this.sliderType==="double"&&(this._sliderLeftInputElm=K("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${rn(t+"")} Search Filter`,defaultValue:`${a}`,value:`${a}`,min:`${r}`,max:`${n}`,step:`${s}`}));const c=this.sliderType==="double"?o:a;this._sliderRightInputElm=K("input",{type:"range",className:"slider-filter-input",ariaLabel:this.columnFilter.ariaLabel??`${rn(t+"")} Search Filter`,defaultValue:`${c}`,value:`${c}`,min:`${r}`,max:`${n}`,step:`${s}`});const h=((p=this.columnFilter.filterOptions)==null?void 0:p.hideSliderNumber)??((m=this.columnFilter.filterOptions)==null?void 0:m.hideSliderNumbers),l=h?"":"input-group";if(this._divContainerFilterElm=K("div",{className:`${l} search-filter slider-container slider-values filter-${t}`.trim()}),this._sliderRangeContainElm.appendChild(this._sliderTrackElm),this.sliderType==="double"&&this._sliderLeftInputElm&&this._sliderRangeContainElm.appendChild(this._sliderLeftInputElm),this._sliderRangeContainElm.appendChild(this._sliderRightInputElm),h)this._divContainerFilterElm.appendChild(this._sliderRangeContainElm);else{let _;this.sliderType==="compound"&&this._selectOperatorElm?(_=K("span",{className:"input-group-addon input-group-prepend operator"}),_.appendChild(this._selectOperatorElm)):this.sliderType==="double"&&(_=K("div",{className:"input-group-addon input-group-prepend slider-range-value"}),this._leftSliderNumberElm=K("span",{className:`input-group-text lowest-range-${t}`,textContent:`${a}`}),_.appendChild(this._leftSliderNumberElm));const x=K("div",{className:"input-group-addon input-group-append slider-range-value"});this._rightSliderNumberElm=K("span",{className:`input-group-text highest-range-${t}`,textContent:`${c}`},x),_&&this._divContainerFilterElm.appendChild(_),this._divContainerFilterElm.appendChild(this._sliderRangeContainElm),this._divContainerFilterElm.appendChild(x)}return this._sliderOptions={minValue:r,maxValue:n,step:s},this._currentValues=[a,o],Array.isArray(e)&&e.length>0&&e[0]!==""&&(this._divContainerFilterElm.classList.add("filled"),this._currentValue=a),(((v=this.columnFilter.filterOptions)==null?void 0:v.sliderStartValue)!==void 0||this.columnFilter.minValue!==void 0)&&(this._currentValue=a),this._argFilterContainerElm.appendChild(this._divContainerFilterElm),this.updateTrackFilledColorWhenEnabled(),this._bindEventService.bind(this._sliderTrackElm,"click",this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["input","change"],this.slideRightInputChanged.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this)),this.sliderType==="compound"&&this._selectOperatorElm?this._bindEventService.bind(this._selectOperatorElm,["change"],this.onValueChanged.bind(this)):this.sliderType==="double"&&this._sliderLeftInputElm&&(this._bindEventService.bind(this._sliderLeftInputElm,["input","change"],this.slideLeftInputChanged.bind(this)),this._bindEventService.bind(this._sliderLeftInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this))),this._divContainerFilterElm}getOperatorOptionValues(){return this.columnFilter.compoundOperatorList?this.columnFilter.compoundOperatorList:Md(this.gridOptions,this.translaterService)}onValueChanged(e){var s,a,o,c,h;const t=parseInt(((s=this._sliderRightInputElm)==null?void 0:s.value)??"",10);let r,n;if(this.sliderType==="compound"||this.sliderType==="single")((o=(a=e==null?void 0:e.target)==null?void 0:a.tagName)==null?void 0:o.toLowerCase())!=="select"&&(this._currentValue=+t),r=this._currentValue,n=[r||"0"];else if(this.sliderType==="double"){const u=[parseInt(((c=this._sliderLeftInputElm)==null?void 0:c.value)??"",10),t];r=u.join(".."),n=u}if(this._clearFilterTriggered)this._filterElm.classList.remove("filled"),this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,searchTerms:[],shouldTriggerQuery:this._shouldTriggerQuery});else{const l=((h=this._selectOperatorElm)==null?void 0:h.value)??this.operator;r===""?this._filterElm.classList.remove("filled"):this._filterElm.classList.add("filled");const u=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput;(this.sliderType!=="compound"||!u||this._currentValue!==void 0)&&this.callback(e,{columnDef:this.columnDef,operator:l||"",searchTerms:n,shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.changeBothSliderFocuses(!1),this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new Yt(e))}changeBothSliderFocuses(e){var r,n;const t=e?"add":"remove";(r=this._sliderLeftInputElm)==null||r.classList[t]("focus"),(n=this._sliderRightInputElm)==null||n.classList[t]("focus")}slideLeftInputChanged(e){var n,s,a,o;const t=parseInt(((n=this._sliderLeftInputElm)==null?void 0:n.value)??"",10),r=parseInt(((s=this._sliderRightInputElm)==null?void 0:s.value)??"",10);this._sliderLeftInputElm&&r-t<=(((a=this.columnFilter.filterOptions)==null?void 0:a.stopGapBetweenSliderHandles)??ac)&&(this._sliderLeftInputElm.value=String(t-(((o=this.columnFilter.filterOptions)==null?void 0:o.stopGapBetweenSliderHandles)??ac))),this._sliderLeftInputElm&&this._sliderRightInputElm&&(+this._sliderLeftInputElm.value>=+this._sliderRightInputElm.value-Tw?(this._sliderLeftInputElm.style.zIndex="1",this._sliderRightInputElm.style.zIndex="0"):(this._sliderLeftInputElm.style.zIndex="0",this._sliderRightInputElm.style.zIndex="1")),this.sliderLeftOrRightChanged(e,t,r)}slideRightInputChanged(e){var n,s,a,o;const t=parseInt(((n=this._sliderLeftInputElm)==null?void 0:n.value)??"",10),r=parseInt(((s=this._sliderRightInputElm)==null?void 0:s.value)??"",10);this.sliderType==="double"&&this._sliderRightInputElm&&r-t<=(((a=this.columnFilter.filterOptions)==null?void 0:a.stopGapBetweenSliderHandles)??ac)&&(this._sliderRightInputElm.value=String(t+(((o=this.columnFilter.filterOptions)==null?void 0:o.stopGapBetweenSliderHandles)??ac))),this.sliderLeftOrRightChanged(e,t,r)}sliderLeftOrRightChanged(e,t,r){var s,a,o,c,h,l;this.updateTrackFilledColorWhenEnabled(),this.changeBothSliderFocuses(!0),this._sliderRangeContainElm.title=this.sliderType==="double"?`${t} - ${r}`:`${r}`,(((s=this.columnFilter.filterOptions)==null?void 0:s.hideSliderNumber)??((a=this.columnFilter.filterOptions)==null?void 0:a.hideSliderNumbers))||((o=this._leftSliderNumberElm)!=null&&o.textContent&&(this._leftSliderNumberElm.textContent=((c=this._sliderLeftInputElm)==null?void 0:c.value)??""),(h=this._rightSliderNumberElm)!=null&&h.textContent&&(this._rightSliderNumberElm.textContent=((l=this._sliderRightInputElm)==null?void 0:l.value)??"")),this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new Yt(e))}sliderTrackClicked(e){e.preventDefault();const t=e.offsetX,r=this._sliderTrackElm.offsetWidth,n=(t+0)*100/r;this._sliderRightInputElm&&this.sliderType!=="double"?(this._sliderRightInputElm.value=`${n}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))):this._sliderLeftInputElm&&this._sliderRightInputElm&&(n<=50?(this._sliderLeftInputElm.value=`${n}`,this._sliderLeftInputElm.dispatchEvent(new Event("change"))):(this._sliderRightInputElm.value=`${n}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))))}updateTrackFilledColorWhenEnabled(){var e,t,r,n;if((e=this.columnFilter.filterOptions)!=null&&e.enableSliderTrackColoring&&this._sliderRightInputElm){let s=0;this._sliderLeftInputElm&&(s=(+this._sliderLeftInputElm.value-+this._sliderLeftInputElm.min)/(((t=this.sliderOptions)==null?void 0:t.maxValue)??0-+this._sliderLeftInputElm.min)*100);const a=(+this._sliderRightInputElm.value-+this._sliderRightInputElm.min)/(((r=this.sliderOptions)==null?void 0:r.maxValue)??0-+this._sliderRightInputElm.min)*100,o="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,((n=this.columnFilter.filterOptions)==null?void 0:n.sliderTrackFilledColor)||this._sliderTrackFilledColor||Au).replace(/%p1/g,`${s}%`).replace(/%p2/g,`${a}%`);this._sliderTrackElm.style.background=o,this._sliderOptions.sliderTrackBackground=o}}}class Aw extends zd{constructor(e){super(e),this.translaterService=e,this.sliderType="compound"}}class kw extends ag{constructor(e){super(e),this.translaterService=e,this.inputFilterType="range"}}class Ow extends Bs{constructor(e){super(e),this.translaterService=e,this._inputMask="",this.inputType="text"}get inputMask(){return this._inputMask}init(e){var r,n,s,a;if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this._cellContainerElm=e.filterContainerElm,(n=(r=this.columnDef)==null?void 0:r.params)!=null&&n.mask?this._inputMask=this.columnDef.params.mask:(a=(s=this.columnFilter)==null?void 0:s.params)!=null&&a.mask&&(this._inputMask=this.columnFilter.params.mask),!this._inputMask)throw new Error(`[Slickgrid-Universal] The Filters.inputMask requires the mask to be passed in the filter params or the column definition params
        for example:: this.columnDefinitions: [{ id: 'phone', field: 'phone', filter: { model: Filters.inputMask, params: { mask: '000-000-0000' }}}]`);const t=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(t),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this))}onTriggerEvent(e,t=!1){var n,s;let r="";if((n=e==null?void 0:e.target)!=null&&n.value){let a=((s=e==null?void 0:e.target)==null?void 0:s.value)??"";const o=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;typeof a=="string"&&o&&(a=a.trim());const c=this.unmaskValue(a),h=this.maskValue(c);r=c,(e==null?void 0:e.keyCode)>=48&&(this._filterInputElm.value=h,e.preventDefault())}t?(this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterInputElm.classList.remove("filled")):(this._filterInputElm.classList.add("filled"),this.callback(e,{columnDef:this.columnDef,operator:this.operator,searchTerms:[r],shouldTriggerQuery:this._shouldTriggerQuery})),this._shouldTriggerQuery=!0}maskValue(e){let t=0,r="";return this._inputMask&&(r=this._inputMask.replace(/[09A]/gi,n=>((n==="0"||n==="9")&&/\d+/g.test(e[t])||n.toUpperCase()==="A"&&/[^\d]+/gi.test(e[t]))&&e[t++]||"")),r}unmaskValue(e){const t=e.replace(/[^0-9a-z]*/gi,""),r=this._inputMask.replace(/[^0-9a-z]*/gi,"");let n="";for(let s=0;s<r.length;s++)t[s]&&((r[s]==="0"||r[s]==="9")&&/\d+/g.test(t[s])||r[s].toUpperCase()==="A"&&/[^\d]+/gi.test(t[s]))&&(n+=t[s]);return n}}class Iw extends Bs{constructor(e){super(e),this.translaterService=e,this.inputType="number"}}class Rw extends Bs{constructor(e){super(e),this.translaterService=e,this.inputType="password"}}var Dw=Object.defineProperty,Fw=(i,e,t)=>e in i?Dw(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ct=(i,e,t)=>(Fw(i,typeof e!="symbol"?e+"":e,t),t),Pw=class{constructor(i){ct(this,"_distinctEvent"),ct(this,"_boundedEvents",[]),this._distinctEvent=(i==null?void 0:i.distinctEvent)??!1}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(i,e,t,r,n=""){let s=Array.isArray(e)?e:[e];if(typeof(i==null?void 0:i.forEach)=="function")i.forEach(a=>{for(let o of s)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(a,o))&&(a.addEventListener(o,t,r),this._boundedEvents.push({element:a,eventName:o,listener:t,groupName:n}))});else for(let a of s)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(i,a))&&(i.addEventListener(a,t,r),this._boundedEvents.push({element:i,eventName:a,listener:t,groupName:n}))}hasBinding(i,e){return this._boundedEvents.some(t=>t.element===i&&(!e||t.eventName===e))}unbind(i,e,t){var r;if(i){let n=Array.isArray(i)?i:[i],s=Array.isArray(e)?e||"":[e||""];for(let a of n){t||(t=this._boundedEvents.find(o=>{if(o.element===a&&(!e||o.eventName===e))return o.listener}));for(let o of s)(r=a==null?void 0:a.removeEventListener)==null||r.call(a,o,t)}}}unbindAll(i){if(i){let e=Array.isArray(i)?i:[i];for(let t=this._boundedEvents.length-1;t>=0;--t){let r=this._boundedEvents[t];if(e.some(n=>n===r.groupName)){let{element:n,eventName:s,listener:a}=r;this.unbind(n,s,a),this._boundedEvents.splice(t,1)}}}else for(;this._boundedEvents.length>0;){let e=this._boundedEvents.pop(),{element:t,eventName:r,listener:n}=e;this.unbind(t,r,n)}}},Mg=typeof window<"u"&&window.multipleSelect!==void 0?window.multipleSelect:{locales:{}};Mg.locales={"en-US":{formatSelectAll(){return"[Select all]"},formatAllSelected(){return"All selected"},formatCountSelected(i,e){return`${i} of ${e} selected`},formatNoMatchesFound(){return"No matches found"},formatOkButton(){return"OK"}}};var Lg=Mg.locales,Nw=50,Mw=4,Bg={name:"",placeholder:"",classes:"",classPrefix:"",data:void 0,locale:void 0,selectAll:!0,single:void 0,singleRadio:!1,multiple:!1,hideOptgroupCheckboxes:!1,multipleWidth:80,width:void 0,dropWidth:void 0,maxHeight:250,maxHeightUnit:"px",position:"bottom",displayValues:!1,displayTitle:!1,displayDelimiter:", ",minimumCountSelected:3,ellipsis:!1,isOpen:!1,keepOpen:!1,openOnHover:!1,container:null,filter:!1,filterGroup:!1,filterPlaceholder:"",filterAcceptOnEnter:!1,filterByDataLength:void 0,customFilter(i){let{text:e,label:t,search:r}=i;return(t||e||"").includes(r)},showClear:!1,autoAdjustDropHeight:!1,autoAdjustDropPosition:!1,autoAdjustDropWidthByTextSize:!1,adjustedHeightPadding:10,useSelectOptionLabel:!1,useSelectOptionLabelToHtml:!1,cssStyler:()=>null,styler:()=>!1,textTemplate:i=>i.innerHTML.trim(),labelTemplate:i=>i.label,onOpen:()=>!1,onClose:()=>!1,onCheckAll:()=>!1,onUncheckAll:()=>!1,onFocus:()=>!1,onBlur:()=>!1,onOptgroupClick:()=>!1,onBeforeClick:()=>!0,onClick:()=>!1,onFilter:()=>!1,onClear:()=>!1,onAfterCreate:()=>!1,onDestroy:()=>!1,onAfterDestroy:()=>!1,onDestroyed:()=>!1},Lw=["init","getOptions","refreshOptions","getSelects","setSelects","enable","disable","open","close","check","uncheck","checkAll","uncheckAll","checkInvert","focus","blur","refresh","destroy"];Object.assign(Bg,Lg["en-US"]);var Bw={BLOCK_ROWS:Nw,CLUSTER_BLOCKS:Mw,DEFAULTS:Bg,METHODS:Lw},In=Bw;function Hw(i,e,t=!1){let r=Object.keys(i),n=Object.keys(e);if(t&&r.length!==n.length)return!1;for(let s of r)if(n.includes(s)&&i[s]!==e[s])return!1;return!0}function ud(i){let e=()=>{let n={};for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=ud(i[s]));return n},t=()=>i.map(n=>ud(n)),r=Object.prototype.toString.call(i).slice(8,-1).toLowerCase();return r==="object"?e():r==="array"?t():i}function ku(i){return i!=null&&i!==""}function Vw(i,e){return typeof i=="object"?Object.fromEntries(e?Object.entries(i).filter(([t,r])=>!ku(r)&&!e.includes(t)||ku(r)):Object.entries(i).filter(([t,r])=>ku(r))):i}function Uw(i){let e=0;return i.forEach((t,r)=>{t.type==="optgroup"?(t._key=`group_${r}`,t.visible=typeof t.visible>"u"?!0:t.visible,t.children.forEach((n,s)=>{n&&(n.visible=typeof(n==null?void 0:n.visible)>"u"?!0:n.visible,n.divider||(n._key=`option_${r}_${s}`,e+=1))})):(t.visible=typeof t.visible>"u"?!0:t.visible,t.divider||(t._key=`option_${r}`,e+=1))}),e}function oc(i,e,t){if(Array.isArray(i))for(let r of i){if(r[e]===t||r[e]===`${+r[e]}`&&+r[e]===t)return r;if(r.type==="optgroup"){for(let n of r.children)if(n&&(n[e]===t||n[e]===`${+n[e]}`&&+n[e]===t))return n}}}function Ww(i){return i.replace(/(\b)(on[a-z]+)(\s*)=([^>]*)|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;|&#60;)(\/*)(script|script defer)(.*)(&#62;|&gt;|&gt;">)/gi,"")}function Ou(i){return Object.keys(i).forEach(e=>i[e]===void 0?delete i[e]:""),i}function zw(i){return i.replace(/[\W_]+(.)/g,(e,t)=>t.toUpperCase())}function Ha(i,e){if(typeof i!="string")return i;if(typeof e=="function")return e(i);if(typeof i.normalize=="function")return i.normalize("NFD").replace(/[\u0300-\u036F]/g,"");throw new Error("[Multiple-Select-Vanilla] `normalize()` function is not defined, you can optionally provide a custom parser via the `diacriticParser` option.")}function dp(i){let e={};if(i){let t=i.replace(/\s/g,"").split(";");for(let r of t){let[n,s]=r.trim().split(":");n&&(e[zw(n)]=s.trim())}console.warn("[multiple-select-vanilla] Please note that `styler` is deprecated, please migrate to `cssStyler` when possible.")}return e}function Iu(i){let e=0,t=0,r=0,n=0,s=window.innerHeight??0,a=window.innerWidth??0,o=Yw(),c=o.top,h=o.left,l=pd(i);if(l){let u=l.top??0,d=l.left??0;t=u-c,e=s-(u-c),r=d-h,n=a-(d-h)}return{top:t,bottom:e,left:r,right:n}}function Pr(i,e,t){let r=document.createElement(i);return e&&Object.keys(e).forEach(n=>{let s=e[n];typeof s=="object"?Object.assign(r[n],s):r[n]=e[n]}),t!=null&&t.appendChild&&t.appendChild(r),r}function Hg(i,e,t){var s;let r=(s=i.props)!=null&&s.innerHTML?$w(i.props,"innerHTML"):i.props,n=Pr(i.tagName,Vw(r,["className","title","style"]),e);if(i.props.innerHTML&&(n.innerHTML=i.props.innerHTML),i.attrs)for(let a of Object.keys(i.attrs))n.setAttribute(a,i.attrs[a]);if(i.children)for(let a of i.children)Hg(a,n);return e==null||e.appendChild(n),n}function dd(i){return i.hasOwnProperty("tagName")?Hg(i):document.createElement("li")}function fd(i){for(;i!=null&&i.firstChild;)i.lastChild&&i.removeChild(i.lastChild);return i}function pd(i){var a;if(!i)return;let e=(a=i==null?void 0:i.getBoundingClientRect)==null?void 0:a.call(i),t=0,r=0,n=0,s=0;return(e==null?void 0:e.top)!==void 0&&e.left!==void 0&&(t=e.top+window.pageYOffset,r=e.left+window.pageXOffset,s=e.right,n=e.bottom),{top:t,left:r,bottom:n,right:s}}function lc(i,e,t){let r=parseFloat(i.style[t]);if(!r||isNaN(r)){switch(e){case"outer":r=i[t==="width"?"offsetWidth":"offsetHeight"];break;case"scroll":r=i[t==="width"?"scrollWidth":"scrollHeight"];break;case"inner":default:r=i[t==="width"?"clientWidth":"clientHeight"];break}r=i.getBoundingClientRect()[t]}if(!r||isNaN(r)){let n=i.style.display,s=i.style.position;i.style.display="block",i.style.position="absolute";let a=window.getComputedStyle(i)[t];r=parseFloat(a),isNaN(r)&&(r=0),i.style.display=n,i.style.position=s}return r||0}function fp(i,e){let t=null,r=i==null?void 0:i.parentElement;for(;r;){let[n,s,a,o]=e.match(/^([a-z]*)([#.]{1})([a-z\-]+)$/i)||[];if(a&&o)for(let c of o.replace(a,"").split(" "))r.classList.contains(c)&&(s?(r==null?void 0:r.tagName.toLowerCase())===s&&(t=r):t=r);r=r.parentElement}return t}function Gw(i,e){var t;(t=i.parentNode)==null||t.insertBefore(e,i.nextSibling)}function $w(i,e){let{[e]:t,...r}=i;return r}function pp(i,e){i!=null&&i.style&&(i.style.display=i.style.display==="none"&&e!==!1||e===!0?"block":"none")}function Yw(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}var Xw=class{constructor(i){var t;ct(this,"cache"),ct(this,"clusterRows"),ct(this,"dataStart"),ct(this,"dataEnd"),ct(this,"rows"),ct(this,"scrollEl"),ct(this,"blockHeight"),ct(this,"clusterHeight"),ct(this,"contentEl"),ct(this,"parentEl"),ct(this,"itemHeight"),ct(this,"lastCluster"),ct(this,"scrollTop"),ct(this,"destroy"),ct(this,"callback"),ct(this,"sanitizer"),this.rows=i.rows,this.scrollEl=i.scrollEl,this.contentEl=i.contentEl,this.parentEl=(t=i.contentEl)==null?void 0:t.parentElement,this.callback=i.callback,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;let e=()=>{this.lastCluster!==(this.lastCluster=this.getNum())&&(this.initDOM(this.rows),this.callback())};this.scrollEl.addEventListener("scroll",e,!1),this.destroy=()=>{fd(this.contentEl),this.scrollEl.removeEventListener("scroll",e,!1)}}initDOM(i){if(typeof this.clusterHeight>"u"){this.cache.scrollTop=this.scrollEl.scrollTop;let s=dd(i[0]);this.contentEl.appendChild(s),this.contentEl.appendChild(s),this.contentEl.appendChild(s),this.cache.data=[i[0]],this.getRowsHeight()}let e=this.initData(i,this.getNum()),t=this.checkChanges("data",e.rows),r=this.checkChanges("top",e.topOffset),n=this.checkChanges("bottom",e.bottomOffset);fd(this.contentEl),t&&r?(e.topOffset&&this.contentEl.appendChild(this.getExtra("top",e.topOffset)),e.rows.forEach(s=>this.contentEl.appendChild(dd(s))),e.bottomOffset&&this.contentEl.appendChild(this.getExtra("bottom",e.bottomOffset))):n&&this.contentEl.lastChild&&(this.contentEl.lastChild.style.height=`${e.bottomOffset}px`)}getRowsHeight(){var i;if(typeof this.itemHeight>"u"){let e=((i=this.parentEl)==null?void 0:i.style.display)||"";this.parentEl&&(e===""||e==="none")&&(this.parentEl.style.display="block");let t=this.contentEl.children,r=t[Math.floor(t.length/2)];this.itemHeight=r.offsetHeight,this.parentEl&&(this.parentEl.style.display=e)}this.blockHeight=this.itemHeight*In.BLOCK_ROWS,this.clusterRows=In.BLOCK_ROWS*In.CLUSTER_BLOCKS,this.clusterHeight=this.blockHeight*In.CLUSTER_BLOCKS}getNum(){this.scrollTop=this.scrollEl.scrollTop;let i=(this.clusterHeight||0)-(this.blockHeight||0);return i&&Math.floor(this.scrollTop/i)||0}initData(i,e){if(i.length<In.BLOCK_ROWS)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:i};let t=Math.max((this.clusterRows-In.BLOCK_ROWS)*e,0),r=t+this.clusterRows,n=Math.max(t*this.itemHeight,0),s=Math.max((i.length-r)*this.itemHeight,0),a=[],o=t;n<1&&o++;for(let c=t;c<r;c++)i[c]&&a.push(i[c]);return this.dataStart=t,this.dataEnd=r,{topOffset:n,bottomOffset:s,rowsAbove:o,rows:a}}checkChanges(i,e){let t=e!==this.cache[i];return this.cache[i]=e,t}getExtra(i,e){let t=document.createElement("li");return t.className=`virtual-scroll-${i}`,e&&(t.style.height=`${e}px`),t}},qw=class{constructor(i,e){this.elm=i,ct(this,"_bindEventService"),ct(this,"allSelected",!1),ct(this,"fromHtml",!1),ct(this,"choiceElm"),ct(this,"closeElm"),ct(this,"closeSearchElm"),ct(this,"filterText",""),ct(this,"updateData",[]),ct(this,"data",[]),ct(this,"dataTotal"),ct(this,"dropElm"),ct(this,"okButtonElm"),ct(this,"filterParentElm"),ct(this,"lastFocusedItemKey",""),ct(this,"ulElm"),ct(this,"parentElm"),ct(this,"labelElm"),ct(this,"selectAllParentElm"),ct(this,"selectAllElm"),ct(this,"searchInputElm"),ct(this,"selectGroupElms"),ct(this,"selectItemElms"),ct(this,"noResultsElm"),ct(this,"options"),ct(this,"selectAllName",""),ct(this,"selectGroupName",""),ct(this,"selectItemName",""),ct(this,"tabIndex"),ct(this,"updateDataStart"),ct(this,"updateDataEnd"),ct(this,"virtualScroll"),ct(this,"locales",{}),this.options=Object.assign({},In.DEFAULTS,this.elm.dataset,e),this._bindEventService=new Pw({distinctEvent:!0})}get isRenderAsHtml(){return this.options.renderOptionLabelAsHtml||this.options.useSelectOptionLabelToHtml}init(){this.initLocale(),this.initContainer(),this.initData(),this.initSelected(!0),this.initFilter(),this.initDrop(),this.initView(),this.options.onAfterCreate()}destroy(i=!0){var e,t,r,n,s;this.elm&&this.parentElm&&(this.options.onDestroy({hardDestroy:i}),i&&this.options.onHardDestroy(),this.elm.parentElement&&this.parentElm.parentElement&&this.elm.parentElement.insertBefore(this.elm,this.parentElm.parentElement.firstChild),this.elm.classList.remove("ms-offscreen"),this._bindEventService.unbindAll(),this.tabIndex&&(this.elm.tabIndex=+this.tabIndex),(e=this.virtualScroll)==null||e.destroy(),(t=this.dropElm)==null||t.remove(),(r=this.parentElm.parentNode)==null||r.removeChild(this.parentElm),this.fromHtml&&(delete this.options.data,this.fromHtml=!1),this.options.onAfterDestroy({hardDestroy:i}),i&&((s=(n=this.options).onAfterHardDestroy)==null||s.call(n),Object.keys(this.options).forEach(a=>delete this[a])))}initLocale(){if(this.options.locale){let i=window.multipleSelect.locales,e=this.options.locale.split(/-|_/);if(e[0]=e[0].toLowerCase(),e[1]&&(e[1]=e[1].toUpperCase()),i[this.options.locale])Object.assign(this.options,i[this.options.locale]);else if(i[e.join("-")])Object.assign(this.options,i[e.join("-")]);else if(i[e[0]])Object.assign(this.options,i[e[0]]);else throw new Error(`[multiple-select-vanilla] invalid locales "${this.options.locale}", make sure to import it before using it`)}}initContainer(){var n;let i=this.elm.getAttribute("name")||this.options.name||"";this.options.classes&&this.elm.classList.add(this.options.classes),this.options.classPrefix&&(this.elm.classList.add(this.options.classPrefix),this.options.size&&this.elm.classList.add(`${this.options.classPrefix}-${this.options.size}`)),this.elm.style.display="none",this.labelElm=this.elm.closest("label"),!this.labelElm&&this.elm.id&&(this.labelElm=document.createElement("label"),this.labelElm.htmlFor=this.elm.id),(n=this.labelElm)!=null&&n.querySelector("input")&&(this.labelElm=null),typeof this.options.single>"u"&&(this.options.single=!this.elm.multiple),this.parentElm=Pr("div",{className:`ms-parent ${this.elm.className||""} ${this.options.classes}`,dataset:{test:"sel"}});let e=this.elm.getAttribute("title")||"";e&&(this.parentElm.title=e),this.options.placeholder=this.options.placeholder||this.elm.getAttribute("placeholder")||"",this.tabIndex=this.elm.tabIndex;let t;this.tabIndex!==null&&(this.elm.tabIndex=-1,t=this.tabIndex),this.choiceElm=Pr("button",{className:"ms-choice",type:"button"},this.parentElm),t!==void 0&&(this.choiceElm.tabIndex=t),this.choiceElm.appendChild(Pr("span",{className:"ms-placeholder",textContent:this.options.placeholder})),this.options.showClear&&this.choiceElm.appendChild(Pr("div",{className:"icon-close"})),this.choiceElm.appendChild(Pr("div",{className:"icon-caret"})),this.dropElm=Pr("div",{className:`ms-drop ${this.options.position}`,ariaExpanded:"false"},this.parentElm),i&&(this.dropElm.dataset.name=i);let r=this.elm.getAttribute("data-test")||this.options.dataTest;r&&(this.parentElm.dataset.test=r,this.dropElm.dataset.test=r),this.closeElm=this.choiceElm.querySelector(".icon-close"),this.options.dropWidth&&(this.dropElm.style.width=typeof this.options.dropWidth=="string"?this.options.dropWidth:`${this.options.dropWidth}px`),Gw(this.elm,this.parentElm),this.elm.disabled&&this.choiceElm.classList.add("disabled"),this.selectAllName=`selectAll${i}`,this.selectGroupName=`selectGroup${i}`,this.selectItemName=`selectItem${i}`,this.options.keepOpen||(this._bindEventService.unbindAll("body-click"),this._bindEventService.bind(document.body,"click",s=>{s.target===this.choiceElm||fp(s.target,".ms-choice")===this.choiceElm||(s.target===this.dropElm||fp(s.target,".ms-drop")!==this.dropElm&&s.target!==this.elm)&&this.options.isOpen&&this.close()},void 0,"body-click"))}initData(){let i=[];if(this.options.data){if(Array.isArray(this.options.data))this.data=this.options.data.map(e=>typeof e=="string"||typeof e=="number"?{text:e,value:e}:e);else if(typeof this.options.data=="object"){for(let[e,t]of Object.entries(this.options.data))i.push({value:e,text:`${t}`});this.data=i}}else this.elm.childNodes.forEach(e=>{let t=this.initRow(e);t&&i.push(t)}),this.options.data=i,this.data=i,this.fromHtml=!0;this.dataTotal=Uw(this.data||[])}initRow(i,e){var r,n;let t={};return((r=i.tagName)==null?void 0:r.toLowerCase())==="option"?(t.type="option",t.text=this.options.textTemplate(i),t.value=i.value,t.visible=!0,t.selected=!!i.selected,t.disabled=e||i.disabled,t.classes=i.getAttribute("class")||"",t.title=i.getAttribute("title")||"",i.dataset.value&&(t._value=i.dataset.value),Object.keys(i.dataset).length&&(t._data=i.dataset,t._data.divider&&(t.divider=t._data.divider)),t):((n=i.tagName)==null?void 0:n.toLowerCase())==="optgroup"?(t.type="optgroup",t.label=this.options.labelTemplate(i),t.visible=!0,t.selected=!!i.selected,t.disabled=i.disabled,t.children=[],Object.keys(i.dataset).length&&(t._data=i.dataset),i.childNodes.forEach(s=>{t.children.push(this.initRow(s,t.disabled))}),t):null}initDrop(){this.initList(),this.update(!0),this.options.isOpen&&this.open(10),this.options.openOnHover&&this.parentElm&&(this._bindEventService.bind(this.parentElm,"mouseover",()=>this.open(null)),this._bindEventService.bind(this.parentElm,"mouseout",()=>this.close()))}initFilter(){if(this.filterText="",this.options.filter||!this.options.filterByDataLength)return;let i=0;for(let e of this.data||[])e.type==="optgroup"?i+=e.children.length:i+=1;this.options.filter=i>this.options.filterByDataLength}initList(){if(this.options.filter&&(this.filterParentElm=Pr("div",{className:"ms-search"},this.dropElm),this.filterParentElm.appendChild(Pr("input",{autocomplete:"off",autocapitalize:"off",spellcheck:!1,type:"text",placeholder:this.options.filterPlaceholder||""})),this.options.showSearchClear&&this.filterParentElm.appendChild(Pr("span",{className:"icon-close"}))),this.options.selectAll&&!this.options.single){let i=this.elm.getAttribute("name")||this.options.name||"";this.selectAllParentElm=Pr("div",{className:"ms-select-all",tabIndex:0});let e=document.createElement("label");Pr("input",{type:"checkbox",ariaChecked:String(this.allSelected),checked:this.allSelected,dataset:{name:`selectAll${i}`},tabIndex:-1},e),e.appendChild(Pr("span",{textContent:this.formatSelectAll()})),this.selectAllParentElm.appendChild(e),this.dropElm.appendChild(this.selectAllParentElm)}this.ulElm=document.createElement("ul"),this.dropElm.appendChild(this.ulElm),this.options.showOkButton&&!this.options.single&&(this.okButtonElm=Pr("button",{className:"ms-ok-button",type:"button",textContent:this.formatOkButton()},this.dropElm)),this.initListItems()}initListItems(){var t;let i=0,e=this.getListRows();if(this.options.selectAll&&!this.options.single&&(i=-1),e.length>In.BLOCK_ROWS*In.CLUSTER_BLOCKS){(t=this.virtualScroll)==null||t.destroy();let r=this.dropElm.style.display!=="none";r||(this.dropElm.style.left="-10000",this.dropElm.style.display="block",this.dropElm.ariaExpanded="true");let n=()=>{this.virtualScroll&&(this.updateDataStart=this.virtualScroll.dataStart+i,this.updateDataEnd=this.virtualScroll.dataEnd+i,this.updateDataStart<0&&(this.updateDataStart=0),this.updateDataEnd>this.getDataLength()&&(this.updateDataEnd=this.getDataLength()))};this.ulElm&&(this.virtualScroll=new Xw({rows:e,scrollEl:this.ulElm,contentEl:this.ulElm,sanitizer:this.options.sanitizer,callback:()=>{n(),this.events()}})),n(),r||(this.dropElm.style.left="0",this.dropElm.style.display="none",this.dropElm.ariaExpanded="false")}else this.ulElm&&(fd(this.ulElm),e.forEach(r=>this.ulElm.appendChild(dd(r)))),this.updateDataStart=0,this.updateDataEnd=this.updateData.length,this.virtualScroll=null;return this.events(),e}getListRows(){var e;let i=[];return this.updateData=[],(e=this.data)==null||e.forEach(t=>i.push(...this.initListItem(t))),i.push({tagName:"li",props:{className:"ms-no-results",textContent:this.formatNoMatchesFound(),tabIndex:0}}),i}initListItem(i,e=0){let t=(i==null?void 0:i.title)||"",r=this.options.multiple?"multiple":"",n=this.options.single?"radio":"checkbox",s="";if(!(i!=null&&i.visible))return[];if(this.updateData.push(i),this.options.single&&!this.options.singleRadio&&(s="hide-radio "),i.selected&&(s+="selected "),i.type==="optgroup"){let f=[],p=this.options.hideOptgroupCheckboxes||this.options.single?{tagName:"span",props:{dataset:{name:this.selectGroupName,key:i._key}}}:{tagName:"input",props:{type:"checkbox",dataset:{name:this.selectGroupName,key:i._key},ariaChecked:String(i.selected||!1),checked:!!i.selected,disabled:i.disabled,tabIndex:-1}};!s.includes("hide-radio")&&(this.options.hideOptgroupCheckboxes||this.options.single)&&(s+="hide-radio ");let m={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(m.props,i.label);let v={tagName:"li",props:{className:`group ${s}`.trim(),tabIndex:s.includes("hide-radio")||i.disabled?-1:0},children:[{tagName:"label",props:{className:`optgroup${this.options.single||i.disabled?" disabled":""}`},children:[p,m]}]},_=this.options.cssStyler(i),x=String(this.options.styler(i)||"");return x&&(v.props.style=dp(x)),_&&(v.props.style=_),f.push(v),i.children.forEach(E=>f.push(...this.initListItem(E,1))),f}if(s+=i.classes||"",e&&this.options.single&&(s+=`option-level-${e} `),i.divider)return[{tagName:"li",props:{className:"option-divider"}}];let a=r||s?(r+s).trim():"",o=`${i.disabled?"disabled":""}`,c={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(c.props,i.text);let h={tagName:"input",props:{type:n,value:encodeURI(i.value),dataset:{key:i._key,name:this.selectItemName},ariaChecked:String(i.selected||!1),checked:!!i.selected,disabled:!!i.disabled,tabIndex:-1}};i.selected&&(h.attrs={checked:"checked"});let l={tagName:"li",props:{className:a,title:t,tabIndex:i.disabled?-1:0,dataset:{key:i._key}},children:[{tagName:"label",props:{className:o},children:[h,c]}]},u=this.options.cssStyler(i),d=String(this.options.styler(i)||"");return d&&(l.props.style=dp(d)),u&&(l.props.style=u),[l]}initSelected(i=!1){var t,r;let e=0;for(let n of this.data||[])if(n.type==="optgroup"){let s=n.children.filter(a=>a&&a.selected&&!a.disabled&&a.visible).length;n.children.length&&(n.selected=!this.options.single&&s&&s===n.children.filter(a=>a&&!a.disabled&&a.visible&&!a.divider).length),e+=s}else e+=n.selected&&!n.disabled&&n.visible?1:0;this.allSelected=((t=this.data)==null?void 0:t.filter(n=>n.selected&&!n.disabled&&n.visible).length)===((r=this.data)==null?void 0:r.filter(n=>!n.disabled&&n.visible&&!n.divider).length),i||(this.allSelected?this.options.onCheckAll():e===0&&this.options.onUncheckAll())}initView(){let i;window.getComputedStyle?(i=window.getComputedStyle(this.elm).width,i==="auto"&&(i=lc(this.dropElm,"outer","width")+20)):i=lc(this.elm,"outer","width")+20,this.parentElm.style.width=`${this.options.width||i}px`,this.elm.classList.add("ms-offscreen")}events(){var t,r;this._bindEventService.unbindAll(["ok-button","search-input","select-all-checkbox","input-checkbox-list","group-checkbox-list"]),this.closeSearchElm=(t=this.filterParentElm)==null?void 0:t.querySelector(".icon-close"),this.searchInputElm=this.dropElm.querySelector(".ms-search input"),this.selectAllElm=this.dropElm.querySelector(`input[data-name="${this.selectAllName}"]`),this.selectGroupElms=this.dropElm.querySelectorAll(`input[data-name="${this.selectGroupName}"],span[data-name="${this.selectGroupName}"]`),this.selectItemElms=this.dropElm.querySelectorAll(`input[data-name="${this.selectItemName}"]:enabled`),this.noResultsElm=this.dropElm.querySelector(".ms-no-results");let i=n=>{n.preventDefault(),!n.target.classList.contains("icon-close")&&this[this.options.isOpen?"close":"open"]()};this.labelElm&&this._bindEventService.bind(this.labelElm,"click",n=>{n.target.nodeName.toLowerCase()==="label"&&(i(n),(!this.options.filter||!this.options.isOpen)&&this.focus(),n.stopPropagation())}),this._bindEventService.bind(this.choiceElm,"click",i),this.options.onFocus&&this._bindEventService.bind(this.choiceElm,"focus",this.options.onFocus),this.options.onBlur&&this._bindEventService.bind(this.choiceElm,"blur",this.options.onBlur),this._bindEventService.bind(this.parentElm,"keydown",n=>{n.code==="Escape"&&!this.options.keepOpen&&(this.close(),this.choiceElm.focus())}),this.closeElm&&this._bindEventService.bind(this.closeElm,"click",n=>{n.preventDefault(),this._checkAll(!1,!0),this.initSelected(!1),this.updateSelected(),this.update(),this.options.onClear()}),this.closeSearchElm&&this._bindEventService.bind(this.closeSearchElm,"click",n=>{n.preventDefault(),this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this.filter()}),this.searchInputElm&&(this._bindEventService.bind(this.searchInputElm,"keydown",n=>{n.code==="Tab"&&n.shiftKey&&this.close()},void 0,"search-input"),this._bindEventService.bind(this.searchInputElm,"keyup",n=>{var s,a,o;if(this.options.filterAcceptOnEnter&&["Enter","Space"].includes(n.code)&&((s=this.searchInputElm)!=null&&s.value)){if(this.options.single){let c=[];(a=this.selectItemElms)==null||a.forEach(h=>{var l;((l=h.closest("li"))==null?void 0:l.style.display)!=="none"&&c.push(h)}),c.length&&c[0].hasAttribute("data-name")&&this.setSelects([c[0].value])}else(o=this.selectAllElm)==null||o.click();this.close(),this.focus();return}this.filter()},void 0,"search-input")),this.selectAllElm&&this._bindEventService.bind(this.selectAllElm,"click",n=>{var s;return this._checkAll((s=n.currentTarget)==null?void 0:s.checked)},void 0,"select-all-checkbox"),this.okButtonElm&&this._bindEventService.bind(this.okButtonElm,"click",n=>{i(n),n.stopPropagation()},void 0,"ok-button"),this._bindEventService.bind(this.selectGroupElms,"click",n=>{let s=n.currentTarget,a=s.checked,o=oc(this.data,"_key",s.dataset.key);this._checkGroup(o,a),this.options.onOptgroupClick(Ou({label:o.label,selected:o.selected,data:o._data,children:o.children.map(c=>{if(c)return Ou({text:c.text,value:c.value,selected:c.selected,disabled:c.disabled,data:c._data})})}))},void 0,"group-checkbox-list"),this._bindEventService.bind(this.selectItemElms,"click",n=>{let s=n.currentTarget,a=s.checked,o=oc(this.data,"_key",s.dataset.key),c=()=>{this.options.single&&this.options.isOpen&&!this.options.keepOpen&&this.close()};if(this.options.onBeforeClick(o)===!1){c();return}this._check(o,a),this.options.onClick(Ou({text:o.text,value:o.value,selected:o.selected,data:o._data})),c()},void 0,"input-checkbox-list"),this.lastFocusedItemKey&&((r=this.dropElm.querySelector(`li[data-key=${this.lastFocusedItemKey}]`))==null||r.focus());let e=Array.from(this.dropElm.querySelectorAll("div.ms-select-all, li"));this._bindEventService.unbindAll("tabindex-arrow"),this._bindEventService.bind(this.dropElm,"keydown",n=>{var a,o,c,h;let s=n.target.closest(".ms-select-all")||n.target.closest("li");if(this.dropElm.contains(s)){let l=0,u=e.length;for(l=0;l<u&&!e[l].isEqualNode(s);l++);switch(n.key){case"ArrowUp":n.preventDefault(),l>0&&(this.lastFocusedItemKey=((a=this.focusOnUpDownItem(e,l,n.key))==null?void 0:a.dataset.key)||"");break;case"ArrowDown":n.preventDefault(),l<e.length-1&&(this.lastFocusedItemKey=((o=this.focusOnUpDownItem(e,l,n.key))==null?void 0:o.dataset.key)||"");break;case"Enter":case" ":n.preventDefault(),(c=s.querySelector("input"))==null||c.click(),this.options.single&&(this.choiceElm.focus(),this.lastFocusedItemKey=((h=this.choiceElm)==null?void 0:h.dataset.key)||"");break}}},void 0,"tabindex-arrow")}focusOnUpDownItem(i,e,t){let r=e,n;for(;n=i[t==="ArrowUp"?r-1:r+1];){if(n.classList.contains("option-divider")){t==="ArrowUp"?r--:r++;continue}break}return n?(n.focus(),n):null}open(i=0){if(i!==null&&i>=0){let e;clearTimeout(e),e=setTimeout(()=>this.openDrop(),i)}else this.openDrop()}openDrop(){var n,s,a,o,c;if((n=this.choiceElm)!=null&&n.classList.contains("disabled"))return;if(this.options.isOpen=!0,this.parentElm.classList.add("ms-parent-open"),(a=(s=this.choiceElm)==null?void 0:s.querySelector("div"))==null||a.classList.add("open"),this.dropElm.style.display="block",this.dropElm.ariaExpanded="true",(o=this.selectAllElm)!=null&&o.parentElement&&(this.selectAllElm.parentElement.style.display="block"),this.noResultsElm&&(this.noResultsElm.style.display="none"),this.getDataLength()||((c=this.selectAllElm)!=null&&c.parentElement&&(this.selectAllElm.parentElement.style.display="none"),this.noResultsElm&&(this.noResultsElm.style.display="block")),this.options.container){let h=pd(this.dropElm),l;this.options.container instanceof Node?l=this.options.container:typeof this.options.container=="string"&&(l=this.options.container==="body"?document.body:document.querySelector(this.options.container)),l.appendChild(this.dropElm),this.dropElm.style.top=`${(h==null?void 0:h.top)??0}px`,this.dropElm.style.left=`${(h==null?void 0:h.left)??0}px`,this.dropElm.style.minWidth="auto",this.dropElm.style.width=`${lc(this.parentElm,"outer","width")}px`}let i=this.options.minHeight,e=this.options.maxHeight;this.options.maxHeightUnit==="row"&&(e=lc(this.dropElm.querySelector("ul>li"),"outer","height")*this.options.maxHeight);let t=this.dropElm.querySelector("ul");t&&(i&&(t.style.minHeight=`${i}px`),t.style.maxHeight=`${e}px`),this.dropElm.querySelectorAll(".multiple").forEach(h=>h.style.width=`${this.options.multipleWidth}px`),this.getDataLength()&&this.options.filter&&(this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this.filter(!0)),this.options.autoAdjustDropWidthByTextSize&&this.adjustDropWidthByText();let r=this.options.position;if(this.options.autoAdjustDropHeight){if(this.options.autoAdjustDropPosition){let{bottom:h,top:l}=Iu(this.dropElm),u=this.dropElm.getBoundingClientRect().height;r=h<u&&l>h?"top":"bottom"}this.adjustDropHeight(r)}this.options.autoAdjustDropPosition&&this.adjustDropPosition(!0),this.options.onOpen()}close(){var i,e;this.options.isOpen=!1,this.parentElm.classList.remove("ms-parent-open"),(e=(i=this.choiceElm)==null?void 0:i.querySelector("div"))==null||e.classList.remove("open"),this.dropElm.style.display="none",this.dropElm.ariaExpanded="false",this.options.container&&(this.parentElm.appendChild(this.dropElm),this.dropElm.style.top="auto",this.dropElm.style.left="auto"),this.options.onClose()}applyAsTextOrHtmlWhenEnabled(i,e){i||(i={}),this.isRenderAsHtml?i.innerHTML=typeof this.options.sanitizer=="function"?this.options.sanitizer(e):e:i.textContent=e}update(i=!1){var c;let e=this.getSelects(),t=this.getSelects("text");this.options.displayValues&&(t=e);let r=(c=this.choiceElm)==null?void 0:c.querySelector("span"),n=e.length,s=null,a=()=>{if(this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml){let h=e.join(this.options.displayDelimiter);return this.options.useSelectOptionLabelToHtml?Ww(h):h}return t.join(this.options.displayDelimiter)};if(r){if(n===0){let h=this.options.placeholder||"";r.classList.add("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(r,h)}else n<this.options.minimumCountSelected?s=a():this.formatAllSelected()&&n===this.dataTotal?s=this.formatAllSelected():this.options.ellipsis&&n>this.options.minimumCountSelected?s=`${t.slice(0,this.options.minimumCountSelected).join(this.options.displayDelimiter)}...`:this.formatCountSelected(n,this.dataTotal)&&n>this.options.minimumCountSelected?s=this.formatCountSelected(n,this.dataTotal):s=a();if(s!==null&&(r==null||r.classList.remove("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(r,s)),this.options.displayTitle||this.options.addTitle){this.options.addTitle&&console.warn("[Multiple-Select-Vanilla] Please note that the `addTitle` option was deprecated and replaced by `displayTitle`.");let h=this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml?"value":"text";r.title=this.getSelects(h).join(this.options.displayDelimiter)}}let o=this.getSelects();this.options.single?this.elm.value=o.length?o[0]:"":Array.from(this.elm.options).forEach(h=>{h.selected=o.some(l=>l===h.value)}),i||this.elm.dispatchEvent(new Event("change"))}updateSelected(i){var t;for(let r=this.updateDataStart;r<this.updateDataEnd;r++){let n=this.updateData[r],s=this.dropElm.querySelector(`input[data-key=${n._key}]`);if(s){s.checked=n.selected;let a=s.closest("li");a&&(n.selected&&!a.classList.contains("selected")?a.classList.add("selected"):n.selected||a.classList.remove("selected"))}}let e=((t=this.data)==null?void 0:t.filter(r=>r.visible).length)===0;this.selectAllElm&&(this.selectAllElm.checked=this.allSelected,pp(this.selectAllElm.closest("li"),!e)),pp(this.noResultsElm,e),this.virtualScroll&&(this.virtualScroll.rows=i??this.getListRows())}getData(){return this.options.data}getDataLength(){var i;return((i=this.data)==null?void 0:i.length)??0}getOptions(i=!0){let e=Object.assign({},this.options);return delete e.data,i?ud(e):this.options}refreshOptions(i){Hw(this.options,i,!0)||(this.options=Object.assign(this.options,i),this.destroy(!1),this.init())}getDropElement(){return this.dropElm}getParentElement(){return this.parentElm}getSelects(i="value"){let e=[];for(let t of this.data||[])if(t.type==="optgroup"){let r=t.children.filter(n=>n==null?void 0:n.selected);if(!r.length)continue;if(i==="value"||this.options.single)e.push(...r.map(n=>i==="value"&&n._value||n[i]));else{let n=[];n.push("["),n.push(t.label),n.push(`: ${r.map(s=>s[i]).join(", ")}`),n.push("]"),e.push(n.join(""))}}else t.selected&&e.push(i==="value"&&t._value||t[i]);return e}setSelects(i,e="value",t=!1){let r=!1,n=s=>{var a;for(let o of s){let c=!1;if(e==="text"){let h=document.createElement("div");this.applyAsTextOrHtmlWhenEnabled(h,o.text),c=i.includes(((a=h.textContent)==null?void 0:a.trim())??"")}else c=i.includes(o._value||o.value),!c&&o.value===`${+o.value}`&&(c=i.includes(+o.value));o.selected!==c&&(r=!0),o.selected=c}};for(let s of this.data||[])s.type==="optgroup"?n(s.children):n([s]);r&&(this.initSelected(t),this.updateSelected(),this.update(t))}enable(){var i;(i=this.choiceElm)==null||i.classList.remove("disabled")}disable(){var i;(i=this.choiceElm)==null||i.classList.add("disabled")}check(i){let e=oc(this.data,"value",i);e&&this._check(e,!0)}uncheck(i){let e=oc(this.data,"value",i);e&&this._check(e,!1)}_check(i,e){this.options.single&&this._checkAll(!1,!0),i.selected=e,this.initSelected(),this.updateSelected(),this.update()}checkAll(){this._checkAll(!0)}uncheckAll(){this._checkAll(!1)}_checkAll(i,e){for(let t of this.data||[])t.type==="optgroup"?this._checkGroup(t,i,!0):!t.disabled&&!t.divider&&(e||t.visible)&&(t.selected=i);e||(this.initSelected(),this.updateSelected(),this.update())}_checkGroup(i,e,t){i.selected=e,i.children.forEach(r=>{r&&!r.disabled&&!r.divider&&(t||r.visible)&&(r.selected=e)}),t||(this.initSelected(),this.updateSelected(),this.update())}checkInvert(){if(!this.options.single){for(let i of this.data||[])if(i.type==="optgroup")for(let e of i.children)e&&(e.divider||(e.selected=!e.selected));else i&&!i.divider&&(i.selected=!i.selected);this.initSelected(),this.updateSelected(),this.update()}}focus(){var i;(i=this.choiceElm)==null||i.focus(),this.options.onFocus()}blur(){var i;(i=this.choiceElm)==null||i.blur(),this.options.onBlur()}refresh(){this.destroy(!1),this.init()}filter(i){var n;let e=((n=this.searchInputElm)==null?void 0:n.value.trim())??"",t=e.toLowerCase();if(this.filterText===t)return;this.filterText=t;for(let s of this.data||[])if(s.type==="optgroup")if(this.options.filterGroup){let a=`${(s==null?void 0:s.label)??""}`;if(s!=null){let o=this.options.customFilter({label:Ha(a.toString().toLowerCase(),this.options.diacriticParser),search:Ha(t,this.options.diacriticParser),originalLabel:a,originalSearch:e,row:s});s.visible=o;for(let c of s.children)c&&(c.visible=o)}}else{for(let a of s.children)if(a!=null){let o=`${(a==null?void 0:a.text)??""}`;a.visible=this.options.customFilter({text:Ha(o.toString().toLowerCase(),this.options.diacriticParser),search:Ha(t,this.options.diacriticParser),originalText:o,originalSearch:e,row:a,parent:s})}s.visible=s.children.filter(a=>a==null?void 0:a.visible).length>0}else{let a=`${(s==null?void 0:s.text)??""}`;s.visible=this.options.customFilter({text:Ha(a.toString().toLowerCase(),this.options.diacriticParser),search:Ha(t,this.options.diacriticParser),originalText:a,originalSearch:e,row:s})}let r=this.initListItems();this.initSelected(i),this.updateSelected(r),i||this.options.onFilter(e)}adjustDropHeight(i){var h,l,u,d;let e=i!=="top",t=((h=this.filterParentElm)==null?void 0:h.getBoundingClientRect().height)??0,r=((l=this.okButtonElm)==null?void 0:l.getBoundingClientRect().height)??0,n=this.options.single?0:((u=this.selectAllParentElm)==null?void 0:u.getBoundingClientRect().height)??0,s=t+r+n+5,{bottom:a,top:o}=Iu(this.parentElm),c=this.options.maxHeight;if(e?c=a-s-this.options.adjustedHeightPadding:c=o-s-this.options.adjustedHeightPadding,!this.options.maxHeight||this.options.maxHeight&&c<this.options.maxHeight){let f=(d=this.dropElm)==null?void 0:d.querySelector("ul");return f&&(f.style.maxHeight=`${c}px`),!0}return!1}adjustDropPosition(i){let e="bottom";if(this.dropElm&&this.parentElm){let{bottom:t,top:r}=Iu(this.dropElm),{top:n,left:s}=pd(this.parentElm),a=this.dropElm.getBoundingClientRect().height,o=this.dropElm.getBoundingClientRect().width,c=document.body.offsetWidth||window.innerWidth,h=this.parentElm.getBoundingClientRect().width;if(t>a)e="bottom";else if(a>t&&r>t){if(this.options.container){let l=n-a;l<0&&(l=0),(l>0||i)&&(e="top",this.dropElm.style.top=`${l<0?0:l}px`)}else e="top",this.dropElm.classList.add(e);this.dropElm.classList.remove("bottom")}c-o<s&&(this.dropElm.style.left=`${s-(o-h)}px`)}return e}adjustDropWidthByText(){let i=this.parentElm.scrollWidth;(this.options.dropWidth||this.options.width)&&(i=this.options.dropWidth||this.options.width||0);let e=this.dropElm.querySelector(".ms-select-all span"),t=this.dropElm.querySelector("ul"),r=26,n=(e==null?void 0:e.clientWidth)??0+r,s=t.scrollHeight>t.clientHeight?this.getScrollbarWidth():0,a=0;this.dropElm.querySelectorAll("li label").forEach(o=>{o.scrollWidth>a&&(a=o.scrollWidth)}),a+=r+s,a<n&&(a=n),this.options.maxWidth&&a>this.options.maxWidth&&(a=this.options.maxWidth),this.options.minWidth&&a<this.options.minWidth&&(a=this.options.minWidth),(i==="100%"||+i<a)&&(this.dropElm.style.width=`${a}px`,this.dropElm.style.maxWidth=`${a}px`)}getScrollbarWidth(){var n;let i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",document.body.appendChild(i);let e=i.offsetWidth;i.style.overflow="scroll";let t=document.createElement("div");t.style.width="100%",i.appendChild(t);let r=t.offsetWidth;return(n=i.parentNode)==null||n.removeChild(i),e-r}formatAllSelected(){return this.options.allSelectedText||this.options.formatAllSelected()}formatCountSelected(i,e){return this.options.countSelectedText?this.options.countSelectedText.replace("#",`${i}`).replace("%",`${e}`):this.options.formatCountSelected(i,e)}formatNoMatchesFound(){return this.options.noMatchesFoundText||this.options.formatNoMatchesFound()}formatOkButton(){return this.options.okButtonText||this.options.formatOkButton()}formatSelectAll(){return this.options.selectAllText||this.options.formatSelectAll()}},uo=function(i,e){return typeof i=="string"?Ru(document.querySelectorAll(i),e):i instanceof Node?Ru([i],e):Ru(i,e)};function Ru(i,e){let t=Array.from(i),r=[];for(let n=0;n<t.length;n++){let s=t[n];try{s._multipleSelect!==void 0&&(s._multipleSelect.destroy(),delete s._multipleSelect),s._multipleSelect=new qw(s,e||{}),s._multipleSelect.init();let a=s._multipleSelect.getOptions(!1);a.onHardDestroy=()=>delete s._multipleSelect,a.onAfterHardDestroyed=()=>r[n]=null,r.push(s._multipleSelect)}catch(a){console.error(a)}}return r.length===1?r[0]:r}uo.defaults=In.DEFAULTS;uo.locales={...Lg};uo.methods=In.METHODS;typeof window<"u"&&(window.multipleSelect=uo);class Vg{constructor(e,t,r,n=!0){this.translaterService=e,this.collectionService=t,this.rxjs=r,this._isMultipleSelect=!0,this._collectionLength=0,this._shouldTriggerQuery=!0,this.isFilled=!1,this.enableTranslateLabel=!1,this.subscriptions=[],this._isMultipleSelect=n}get collectionOptions(){var e,t;return((t=(e=this.columnDef)==null?void 0:e.filter)==null?void 0:t.collectionOptions)??{}}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)??{}}get customStructure(){var e,t;return(t=(e=this.columnDef)==null?void 0:e.filter)==null?void 0:t.customStructure}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get defaultOperator(){return this.isMultipleSelect?tt.in:tt.equal}get isMultipleSelect(){return this._isMultipleSelect}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get operator(){var e;return((e=this.columnFilter)==null?void 0:e.operator)??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){var n,s,a,o,c,h,l,u,d,f,p;if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync)throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") for the MultipleSelect/SingleSelect Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.multipleSelect, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }`);if(this.enableTranslateLabel=((n=this.columnFilter)==null?void 0:n.enableTranslateLabel)??!1,this.labelName=((s=this.customStructure)==null?void 0:s.label)??"label",this.labelPrefixName=((a=this.customStructure)==null?void 0:a.labelPrefix)??"labelPrefix",this.labelSuffixName=((o=this.customStructure)==null?void 0:o.labelSuffix)??"labelSuffix",this.optionLabel=((c=this.customStructure)==null?void 0:c.optionLabel)??"value",this.valueName=((h=this.customStructure)==null?void 0:h.value)??"value",this.enableTranslateLabel&&(!this.translaterService||typeof this.translaterService.translate!="function"))throw new Error('[select-filter] The Translate Service is required for the Select Filter to work correctly when "enableTranslateLabel" is set.');this._locales=((l=this.gridOptions)==null?void 0:l.locales)??ye.locales,this.initMultipleSelectTemplate();let t=((u=this.gridOptions)==null?void 0:u.defaultFilterPlaceholder)||"";(d=this.columnFilter)!=null&&d.placeholder&&(t=this.columnFilter.placeholder),this.defaultOptions.placeholder=t||"",this._isMultipleSelect&&((f=this.columnDef)!=null&&f.filter)&&(this.columnDef.filter.emptySearchTermReturnAllValues=((p=this.columnDef.filter)==null?void 0:p.emptySearchTermReturnAllValues)??!1);const r=this.columnFilter.collection||[];return new Promise(async(m,v)=>{try{let _;this.columnFilter.collectionAsync&&!this.columnFilter.collection?(_=ig(this.columnFilter.collectionAsync,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),m(_)):(_=r,this.renderDomElement(r),m(r)),(this.columnFilter.collectionAsync||this.columnFilter.enableCollectionWatch)&&(await(_??this.columnFilter.collectionAsync),this.watchCollectionChanges())}catch(_){v(_)}})}clear(e=!0){var t,r,n;this._msInstance&&this._collectionLength>0&&(this._msInstance.setSelects([]),(t=this.filterElm)==null||t.classList.remove("filled"),(n=(r=this._msInstance)==null?void 0:r.getParentElement())==null||n.classList.remove("filled"),this.searchTerms=[],this._shouldTriggerQuery=e,this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0)}destroy(){var e,t;typeof((e=this._msInstance)==null?void 0:e.destroy)=="function"&&this._msInstance.destroy(),(t=this.filterElm)==null||t.remove(),ph(this.subscriptions)}getValues(){var e;return((e=this._msInstance)==null?void 0:e.getSelects())??[]}setValues(e,t){e!==void 0&&this._msInstance&&(e=Array.isArray(e)?e.every(r=>bl(r))?e.map(String):e:[e],this._msInstance.setSelects(e)),this.updateFilterStyle(this.getValues().length>0),this.operator=t||this.defaultOperator}filterCollection(e){var r;let t=e;if(this.columnFilter&&this.columnFilter.collectionFilterBy){const n=this.columnFilter.collectionFilterBy,s=((r=this.columnFilter.collectionOptions)==null?void 0:r.filterResultAfterEachPass)||null;t=this.collectionService.filterCollection(t,n,s)}return t}sortCollection(e){let t=e;if(this.columnFilter&&this.columnFilter.collectionSortBy){const r=this.columnFilter.collectionSortBy;t=this.collectionService.sortCollection(this.columnDef,t,r,this.enableTranslateLabel)}return t}watchCollectionChanges(){var e;(e=this.columnFilter)!=null&&e.collection&&(Jo(this.columnFilter.collection,this.watchCallback.bind(this)),Od(this.columnFilter,"collection",this.propertyObserverCallback.bind(this)))}propertyObserverCallback(e){this.renderDomElement(e||[]),this.columnFilter.collection&&Jo(this.columnFilter.collection,this.watchCallback.bind(this))}watchCallback(e){this.renderDomElement(this.columnFilter.collection||e||[])}renderDomElement(e){var s,a,o,c;if(!Array.isArray(e)&&((s=this.collectionOptions)!=null&&s.collectionInsideObjectProperty)){const h=this.collectionOptions.collectionInsideObjectProperty;e=Ti(e,h||"")}if(!Array.isArray(e))throw new Error('The "collection" passed to the Select Filter is not a valid array.');let t=[];if(e.length>0&&(t=[...e]),(a=this.collectionOptions)!=null&&a.addBlankEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==""&&t.unshift(this.createBlankEntry()),(o=this.collectionOptions)!=null&&o.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&t.unshift(this.collectionOptions.addCustomFirstEntry),(c=this.collectionOptions)!=null&&c.addCustomLastEntry&&Array.isArray(t)&&t.length>0){const h=t.length-1;t[h][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry)}let r=t;r=this.filterCollection(r),r=this.sortCollection(r);const n=tg("filter",r,this.columnDef,this.grid,this.isMultipleSelect,this.translaterService,this.searchTerms||[]);this.isFilled=n.hasFoundSearchTerm,this.createFilterElement(n.selectElement,n.dataCollection),this._collectionLength=r.length}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createFilterElement(e,t){var s;const r=((s=this.columnDef)==null?void 0:s.id)??"";this.elementName=`filter-${r}`,this.defaultOptions.name=this.elementName,Rt(this.filterContainerElm),this.filterElm=e,this.filterElm.dataset.columnId=`${r}`,this.updateFilterStyle(this.isFilled),this.filterContainerElm.appendChild(e);const n=this.columnFilter?this.columnFilter.filterOptions:{};this.filterElmOptions={...this.defaultOptions,...n,data:t},this._msInstance=uo(e,this.filterElmOptions)}initMultipleSelectTemplate(){var n,s,a,o,c,h,l,u,d,f,p,m,v;const e=((n=this.gridOptions)==null?void 0:n.enableTranslate)??!1,r={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,name:`${((s=this.columnDef)==null?void 0:s.id)??""}`,container:"body",filter:!1,maxHeight:275,single:!0,renderOptionLabelAsHtml:((a=this.columnFilter)==null?void 0:a.enableRenderHtml)??!1,sanitizer:_=>fa(this.gridOptions,_),onClose:()=>this.onTriggerEvent()};if(this._isMultipleSelect){r.single=!1,r.showOkButton=!0,r.displayTitle=!0;const _=Kn(this.gridOptions);r.countSelectedText=e&&((o=this.translaterService)!=null&&o.translate)?this.translaterService.translate(`${_}X_OF_Y_SELECTED`):(c=this._locales)==null?void 0:c.TEXT_X_OF_Y_SELECTED,r.allSelectedText=e&&((h=this.translaterService)!=null&&h.translate)?this.translaterService.translate(`${_}ALL_SELECTED`):(l=this._locales)==null?void 0:l.TEXT_ALL_SELECTED,r.noMatchesFoundText=e&&((u=this.translaterService)!=null&&u.translate)?this.translaterService.translate(`${_}NO_MATCHES_FOUND`):(d=this._locales)==null?void 0:d.TEXT_NO_MATCHES_FOUND,r.okButtonText=e&&((f=this.translaterService)!=null&&f.translate)?this.translaterService.translate(`${_}OK`):(p=this._locales)==null?void 0:p.TEXT_OK,r.selectAllText=e&&((m=this.translaterService)!=null&&m.translate)?this.translaterService.translate(`${_}SELECT_ALL`):(v=this._locales)==null?void 0:v.TEXT_SELECT_ALL}this.defaultOptions=r}onTriggerEvent(){if(this._msInstance){const e=this.getValues();this.updateFilterStyle(Array.isArray(e)&&e.length>1||e.length===1&&e[0]!==""),this.searchTerms=e,this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:e,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0}}updateFilterStyle(e){var t,r,n,s,a,o;e?(this.isFilled=!0,(t=this.filterElm)==null||t.classList.add("filled"),(n=(r=this._msInstance)==null?void 0:r.getParentElement())==null||n.classList.add("filled")):(this.isFilled=!1,(s=this.filterElm)==null||s.classList.remove("filled"),(o=(a=this._msInstance)==null?void 0:a.getParentElement())==null||o.classList.remove("filled"))}}class Kw extends Vg{constructor(e,t,r){super(e,t,r,!0),this.translaterService=e,this.collectionService=t,this.rxjs=r}}class jw{constructor(e){this.translater=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._currentValues=[],this.searchTerms=[],this._bindEventService=new Xi}get columnFilter(){var e;return((e=this.columnDef)==null?void 0:e.filter)??{}}get defaultOperator(){return tt.equal}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get operator(){var e;return((e=this.columnFilter)==null?void 0:e.operator)??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(!e)throw new Error('[Slickgrid-Universal] A filter must always have an "init()" with valid arguments.');if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection)throw new Error('[Slickgrid-Universal] You need to pass a "collection" for the Native Select Filter to work correctly.');if(this.columnFilter.enableTranslateLabel&&!this.gridOptions.enableTranslate&&(!this.translater||typeof this.translater.translate!="function"))throw new Error('The I18N Service is required for the Native Select Filter to work correctly when "enableTranslateLabel" is set.');let t=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";(typeof t=="boolean"||typeof t=="number")&&(t=`${t??""}`),this.filterElm=this.createFilterElement(t),this._bindEventService.bind(this.filterElm,"change",this.handleOnChange.bind(this))}clear(e=!0){this.filterElm&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._currentValues=[],this.filterElm.value="",this.filterElm.classList.remove("filled"),this.filterElm.dispatchEvent(new Event("change")))}destroy(){var e,t;this._bindEventService.unbindAll(),(t=(e=this.filterElm)==null?void 0:e.remove)==null||t.call(e)}getValues(){return this._currentValues||[]}setValues(e,t){Array.isArray(e)?(this.filterElm.value=`${e[0]??""}`,this._currentValues=e):e&&(this.filterElm.value=`${e??""}`,this._currentValues=[e]),this.getValues().length>0?this.filterElm.classList.add("filled"):this.filterElm.classList.remove("filled"),this.operator=t||this.defaultOperator}buildFilterSelectFromCollection(e){var o,c,h,l,u;const t=((o=this.columnDef)==null?void 0:o.id)??"",r=K("select",{className:`form-control search-filter filter-${t}`,ariaLabel:((c=this.columnFilter)==null?void 0:c.ariaLabel)??`${rn(t+"")} Search Filter`}),n=((h=this.columnFilter.customStructure)==null?void 0:h.label)??"label",s=((l=this.columnFilter.customStructure)==null?void 0:l.value)??"value",a=((u=this.columnFilter)==null?void 0:u.enableTranslateLabel)??!1;return e.every(d=>typeof d=="string")?e.forEach(d=>{r.appendChild(K("option",{value:d,label:d,textContent:d}))}):e.forEach(d=>{var m,v;if(!d||d[n]===void 0&&d.labelKey===void 0)throw new Error("A collection with value/label (or value/labelKey when using Locale) is required to populate the Native Select Filter list, for example:: { filter: model: Filters.select, collection: [ { value: '1', label: 'One' } ]')");const f=d.labelKey||d[n],p=(d.labelKey||a)&&typeof this.translater!==void 0&&((v=(m=this.translater).getCurrentLanguage)!=null&&v.call(m))?this.translater.translate(f||" "):f;r.appendChild(K("option",{value:d[s],textContent:p}))}),r}createFilterElement(e){var a,o;const t=((a=this.columnDef)==null?void 0:a.id)??"";Rt(this.filterContainerElm);const r=e||"",n=((o=this.columnFilter)==null?void 0:o.collection)??[];if(!Array.isArray(n))throw new Error('The "collection" passed to the Native Select Filter is not a valid array.');const s=this.buildFilterSelectFromCollection(n);return s.value=r,s.dataset.columnid=`${t||""}`,r&&(this._currentValues=[r]),this.filterContainerElm.appendChild(s),s}handleOnChange(e){const t=e&&e.target&&e.target.value||"";this._currentValues=[t],this._clearFilterTriggered?(this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,shouldTriggerQuery:this._shouldTriggerQuery}),this.filterElm.classList.remove("filled")):(t===""?this.filterElm.classList.remove("filled"):this.filterElm.classList.add("filled"),this.callback(e,{columnDef:this.columnDef,operator:this.operator,searchTerms:[t],shouldTriggerQuery:this._shouldTriggerQuery})),this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}}class Qw extends Vg{constructor(e,t,r){super(e,t,r,!1),this.translaterService=e,this.collectionService=t,this.rxjs=r}}class Zw extends zd{constructor(e){super(e),this.translaterService=e,this.sliderType="single"}}class Jw extends zd{constructor(e){super(e),this.translaterService=e,this.sliderType="double"}}const Ug={autocompleter:ZE,compoundDate:sx,compoundInput:up,compoundInputNumber:Sw,compoundInputPassword:bw,compoundInputText:up,compoundSlider:Aw,dateRange:kw,input:Bs,inputMask:Ow,inputNumber:Iw,inputPassword:Rw,inputText:Bs,multipleSelect:Kw,select:jw,singleSelect:Qw,slider:Zw,sliderRange:Jw};class eC{constructor(e,t,r,n){var s;this.config=e,this.translaterService=t,this.collectionService=r,this.rxjs=n,this._options=((s=this.config)==null?void 0:s.options)??{}}addRxJsResource(e){this.rxjs=e}createFilter(e){let t;return e!=null&&e.model&&(t=typeof e.model=="function"?new e.model(this.translaterService,this.collectionService,this.rxjs):e.model),!t&&this._options.defaultFilter&&(t=new this._options.defaultFilter(this.translaterService,this.collectionService,this.rxjs)),t}}const Wg={alwaysShowVerticalScroll:!0,autoEdit:!1,asyncEditorLoading:!1,autoFitColumnsOnFirstLoad:!0,autoFixResizeTimeout:5*60*5,autoFixResizeRequiredGoodCount:2,autoFixResizeWhenBrokenStyleDetected:!1,autoParseInputFilterOperator:!0,autoResize:{applyResizeToContainer:!0,calculateAvailableSizeBy:"window",bottomPadding:20,minHeight:180,minWidth:300,rightPadding:0},cellHighlightCssClass:"slick-cell-modified",checkboxSelector:{cssClass:"slick-cell-checkboxsel",width:40},columnGroupSeparator:" - ",columnPicker:{hideForceFitButton:!1,hideSyncResizeButton:!0,headerColumnValueExtractor:mp},cellMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideCommandSection:!1,hideOptionSection:!1,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},compositeEditorOptions:{labels:{cancelButtonKey:"CANCEL",cloneButtonKey:"CLONE",resetEditorButtonTooltipKey:"RESET_INPUT_VALUE",resetFormButtonKey:"RESET_FORM",massSelectionButtonKey:"APPLY_TO_SELECTION",massSelectionStatusKey:"X_OF_Y_MASS_SELECTED",massUpdateButtonKey:"APPLY_MASS_UPDATE",massUpdateStatusKey:"ALL_X_RECORDS_SELECTED",saveButtonKey:"SAVE"}},contextMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideClearAllGrouping:!1,hideCollapseAllGroups:!1,hideCommandSection:!1,hideCopyCellValueCommand:!1,hideExpandAllGroups:!1,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideMenuOnScroll:!0,hideOptionSection:!1,iconCollapseAllGroupsCommand:"fa fa-compress mdi mdi-arrow-collapse",iconExpandAllGroupsCommand:"fa fa-expand mdi mdi-arrow-expand",iconClearGroupingCommand:"fa fa-times mdi mdi-close",iconCopyCellValueCommand:"fa fa-clone mdi mdi-content-copy",iconExportCsvCommand:"fa fa-download mdi mdi-download",iconExportExcelCommand:"fa fa-file-excel-o mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"fa fa-download mdi mdi-download",showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},customFooterOptions:{dateFormat:"YYYY-MM-DD, hh:mm a",hideRowSelectionCount:!1,hideTotalItemCount:!1,hideLastUpdateTimestamp:!0,footerHeight:25,leftContainerClass:"col-xs-12 col-sm-5",rightContainerClass:"col-xs-6 col-sm-7",metricSeparator:"|",metricTexts:{itemsKey:"ITEMS",ofKey:"OF",itemsSelectedKey:"ITEMS_SELECTED"}},customTooltip:{tooltipTextMaxLength:700,maxWidth:500},dataView:{syncGridSelection:{preserveHidden:!1,preserveHiddenOnSelectionChange:!0},syncGridSelectionWithBackendService:!1},datasetIdPropertyName:"id",defaultFilter:Ug.input,defaultBackendServiceFilterTypingDebounce:500,enableFilterTrimWhiteSpace:!1,defaultFilterPlaceholder:"",defaultFilterRangeOperator:tt.rangeInclusive,defaultColumnSortFieldId:"id",draggableGrouping:{hideToggleAllButton:!1,toggleAllButtonText:"",dropPlaceHolderTextKey:"DROP_COLUMN_HEADER_TO_GROUP_BY"},editable:!1,editorTypingDebounce:450,filterTypingDebounce:0,enableEmptyDataWarningMessage:!0,emptyDataWarning:{className:"slick-empty-data-warning",messageKey:"EMPTY_DATA_WARNING_MESSAGE",hideFrozenLeftWarning:!1,hideFrozenRightWarning:!1,leftViewportMarginLeft:"40%",rightViewportMarginLeft:"40%",frozenLeftViewportMarginLeft:"0px",frozenRightViewportMarginLeft:"40%"},enableAutoResize:!0,enableAutoSizeColumns:!0,enableCellNavigation:!1,enableColumnPicker:!0,enableColumnReorder:!0,enableColumnResizeOnDoubleClick:!0,enableContextMenu:!0,enableExcelExport:!1,enableTextExport:!1,enableGridMenu:!0,enableHeaderMenu:!0,enableMouseHoverHighlightRow:!0,enableSorting:!0,enableTextSelectionOnCells:!0,explicitInitialization:!0,excelExportOptions:{addGroupIndentation:!0,autoDetectCellFormat:!0,exportWithFormatter:!1,filename:"export",format:ps.xlsx,groupingColumnHeaderTitle:"Group By",groupCollapsedSymbol:"",groupExpandedSymbol:"",groupingAggregatorRowText:"",sanitizeDataExport:!0},textExportOptions:{delimiter:Ms.comma,exportWithFormatter:!1,filename:"export",format:ps.csv,groupingColumnHeaderTitle:"Group By",groupingAggregatorRowText:"",sanitizeDataExport:!0,useUtf8WithBom:!0},eventNamingStyle:zn.lowerCase,forceFitColumns:!1,frozenHeaderWidthCalcDifferential:1,gridMenu:{dropSide:"left",commandLabels:{clearAllFiltersCommandKey:"CLEAR_ALL_FILTERS",clearAllSortingCommandKey:"CLEAR_ALL_SORTING",clearFrozenColumnsCommandKey:"CLEAR_PINNING",exportCsvCommandKey:"EXPORT_TO_CSV",exportExcelCommandKey:"EXPORT_TO_EXCEL",exportTextDelimitedCommandKey:"EXPORT_TO_TAB_DELIMITED",refreshDatasetCommandKey:"REFRESH_DATASET",toggleFilterCommandKey:"TOGGLE_FILTER_ROW",togglePreHeaderCommandKey:"TOGGLE_PRE_HEADER_ROW"},hideClearAllFiltersCommand:!1,hideClearAllSortingCommand:!1,hideClearFrozenColumnsCommand:!0,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideForceFitButton:!1,hideRefreshDatasetCommand:!1,hideSyncResizeButton:!0,hideToggleFilterCommand:!1,hideTogglePreHeaderCommand:!1,iconCssClass:"fa fa-bars mdi mdi-menu",iconClearAllFiltersCommand:"fa fa-filter mdi mdi-filter-remove-outline",iconClearAllSortingCommand:"fa fa-unsorted mdi mdi-swap-vertical",iconClearFrozenColumnsCommand:"fa fa-times mdi mdi-pin-off-outline",iconExportCsvCommand:"fa fa-download mdi mdi-download",iconExportExcelCommand:"fa fa-file-excel-o mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"fa fa-download mdi mdi-download",iconRefreshDatasetCommand:"fa fa-refresh mdi mdi-sync",iconToggleFilterCommand:"fa fa-random mdi mdi-flip-vertical",iconTogglePreHeaderCommand:"fa fa-random mdi mdi-flip-vertical",menuWidth:16,resizeOnShowHeaderRow:!0,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270",headerColumnValueExtractor:mp},headerMenu:{autoAlign:!0,autoAlignOffset:4,minWidth:140,iconClearFilterCommand:"fa fa-filter mdi mdi mdi-filter-remove-outline",iconClearSortCommand:"fa fa-unsorted mdi mdi-swap-vertical",iconFreezeColumns:"fa fa-thumb-tack mdi mdi-pin-outline",iconSortAscCommand:"fa fa-sort-amount-asc mdi mdi-flip-v mdi-sort-ascending",iconSortDescCommand:"fa fa-sort-amount-desc mdi mdi-flip-v mdi-sort-descending",iconColumnHideCommand:"fa fa-times mdi mdi-close",iconColumnResizeByContentCommand:"fa fa-arrows-h mdi mdi-arrow-expand-horizontal",hideColumnResizeByContentCommand:!1,hideColumnHideCommand:!1,hideClearFilterCommand:!1,hideClearSortCommand:!1,hideFreezeColumnsCommand:!0,hideSortCommands:!1,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},ignoreAccentOnStringFilterAndSort:!1,multiColumnSort:!0,numberedMultiColumnSort:!0,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!0,suppressActiveCellChangeOnEdit:!1,pagination:{pageSizes:[10,15,20,25,30,40,50,75,100],pageSize:25,totalItems:0},headerRowHeight:35,rowHeight:35,topPanelHeight:30,translationNamespaceSeparator:":",resetFilterSearchValueAfterOnBeforeCancellation:!0,resizeByContentOnlyOnFirstLoad:!0,resizeByContentOptions:{alwaysRecalculateColumnWidth:!1,cellCharWidthInPx:7.8,cellPaddingWidthInPx:14,defaultRatioForStringType:.88,formatterPaddingWidthInPx:0,maxItemToInspectCellContentWidth:1e3,maxItemToInspectSingleColumnWidthByContent:5e3,widthToRemoveFromExceededWidthReadjustment:50},sanitizerOptions:{ADD_ATTR:["level"],RETURN_TRUSTED_TYPE:!0},treeDataOptions:{exportIndentMarginLeft:5,exportIndentationLeadingChar:""}};function mp(i,e){const t=(i==null?void 0:i.columnGroup)||"",r=(e==null?void 0:e.columnGroupSeparator)??" - ";return t?t+r+i.name:(i==null?void 0:i.name)??""}class tC{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._sum=0,this._itemCount=0,this._type="sum",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._isTreeAggregator=t,this._isInitialized=!0,this._sum=0,this._itemCount=0,t&&(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={},e.__treeTotals.count={}),e.__treeTotals.count[this._field]=0,e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const r=e!=null&&e.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals[this._type][this._field]??0),this._itemCount=e.__treeTotals.count[this._field]??0):ti(r)&&(this._sum=parseFloat(r),this._itemCount=1):r!==null&&r!==""&&!isNaN(r)&&(this._sum+=parseFloat(r))}storeResult(e){(!e||e[this._type]===void 0)&&(e[this._type]={}),this.addGroupTotalPropertiesWhenNotExist(e);let t=this._sum,r=this._itemCount;this._isTreeAggregator&&(t+=e[this._type][this._field],r+=e.count[this._field],e.count[this._field]=r),e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){e[this._type]===void 0&&(e[this._type]={}),this._isTreeAggregator&&e.count===void 0&&(e.count={})}}class iC{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._max=null,this._type="max",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._max=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const r=e!=null&&e.hasOwnProperty(this._field)?e[this._field]:null;if(!this._isTreeAggregator)this.keepMaxValueWhenFound(r);else if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const n=e.__treeTotals[this._type][this._field]!==null?parseFloat(e.__treeTotals[this._type][this._field]):null;n!==null&&ti(n)&&(this._max===null||n>this._max)&&(this._max=n)}else ti(r)&&this.keepMaxValueWhenFound(r)}storeResult(e){let t=this._max;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&t!==null){const r=e[this._type][this._field];ti(r)&&r>t&&(t=r)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){e[this._type]===void 0&&(e[this._type]={})}keepMaxValueWhenFound(e){e!==null&&e!==""&&!isNaN(e)&&(this._max===null||e>this._max)&&(this._max=parseFloat(e))}}class rC{constructor(e){this._isInitialized=!1,this._distinctValues=[],this._type="distinct",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._distinctValues=[],this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:void 0;this._distinctValues.indexOf(t)===-1&&t!==void 0&&this._distinctValues.push(t)}storeResult(e){(!e||e[this._type]===void 0)&&(e[this._type]={}),e[this._type][this._field]=this._distinctValues}}class nC{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._min=null,this._type="min",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._min=null,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=null)}accumulate(e,t=!1){const r=e!=null&&e.hasOwnProperty(this._field)?e[this._field]:null;if(!this._isTreeAggregator)this.keepMinValueWhenFound(r);else if(t){e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals);const n=e.__treeTotals[this._type][this._field]!==null?parseFloat(e.__treeTotals[this._type][this._field]):null;n!==null&&ti(n)&&(this._min===null||n<this._min)&&(this._min=n)}else ti(r)&&this.keepMinValueWhenFound(r)}storeResult(e){let t=this._min;if(this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&t!==null){const r=e[this._type][this._field];ti(r)&&r<t&&(t=r)}e[this._type][this._field]=t}addGroupTotalPropertiesWhenNotExist(e){e[this._type]===void 0&&(e[this._type]={})}keepMinValueWhenFound(e){e!==null&&e!==""&&!isNaN(e)&&(this._min===null||e<this._min)&&(this._min=parseFloat(e))}}class sC{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._count=0,this._type="count",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._count=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={}),e.__treeTotals[this._type][this._field]=0)}accumulate(e,t=!1){const r=e!=null&&e.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator&&(t?(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={}),this._count=e.__treeTotals[this._type][this._field]??0):ti(r)&&(this._count=1))}storeResult(e){var r;(!e||e[this._type]===void 0)&&(e[this._type]={});let t=this._count;this._isTreeAggregator?t+=e[this._type][this._field]:t=((r=e.group)==null?void 0:r.rows.length)??0,e[this._type][this._field]=t}}class aC{constructor(e){this._isInitialized=!1,this._data="",this._type="clone",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){if(this._data="",this._isInitialized=!0,t)throw new Error("[Slickgrid-Universal] CloneAggregator is not currently supported for use with Tree Data")}accumulate(e){const t=e&&e.hasOwnProperty(this._field)?e[this._field]:null;t!==null&&t!==""&&(this._data=t)}storeResult(e){(!e||e[this._type]===void 0)&&(e[this._type]={}),e[this._type][this._field]=this._data}}class oC{constructor(e){this._isInitialized=!1,this._isTreeAggregator=!1,this._nonNullCount=0,this._sum=0,this._type="avg",this._field=e}get field(){return this._field}get isInitialized(){return this._isInitialized}get type(){return this._type}init(e,t=!1){this._sum=0,this._nonNullCount=0,this._isInitialized=!0,this._isTreeAggregator=t,t&&(e.__treeTotals||(e.__treeTotals={}),e.__treeTotals[this._type]===void 0&&(e.__treeTotals[this._type]={},e.__treeTotals.sum={},e.__treeTotals.count={}),e.__treeTotals[this._type][this._field]=0,e.__treeTotals.count[this._field]=0,e.__treeTotals.sum[this._field]=0)}accumulate(e,t=!1){const r=e!=null&&e.hasOwnProperty(this._field)?e[this._field]:null;this._isTreeAggregator?t?(e.__treeTotals||(e.__treeTotals={}),this.addGroupTotalPropertiesWhenNotExist(e.__treeTotals),this._sum=parseFloat(e.__treeTotals.sum[this._field]??0),this._nonNullCount=e.__treeTotals.count[this._field]??0):ti(r)&&(this._sum=parseFloat(r),this._nonNullCount=1):r!==null&&r!==""&&!isNaN(r)&&(this._nonNullCount++,this._sum+=parseFloat(r))}storeResult(e){let t=this._sum,r=this._nonNullCount;this.addGroupTotalPropertiesWhenNotExist(e),this._isTreeAggregator&&(t+=e.sum[this._field],r+=e.count[this._field],e.sum[this._field]=t,e.count[this._field]=r),r!==0&&(e[this._type][this._field]=r===0?t:t/r)}addGroupTotalPropertiesWhenNotExist(e){e[this._type]===void 0&&(e[this._type]={}),this._isTreeAggregator&&e.sum===void 0&&(e.sum={}),this._isTreeAggregator&&e.count===void 0&&(e.count={})}}const lC={Avg:oC,Clone:aC,Count:sC,Distinct:rC,Min:nC,Max:iC,Sum:tC};function xh(i,e){const t=e.errorMessage,r=e.required,n=e.minLength,s=e.maxLength,a=e.operatorConditionalType||"inclusive",o={"{{minLength}}":n,"{{maxLength}}":s};let c=!0,h="";const l=(i==null?void 0:i.length)??0;if(e.validator)return e.validator(i,e.editorArgs);if(r&&i==="")c=!1,h=t||ye.VALIDATION_REQUIRED_FIELD;else if(n!==void 0&&s!==void 0&&(a==="exclusive"&&(l<=n||l>=s)||a==="inclusive"&&(l<n||l>s)))c=!1,h=t||ye.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN.replace(/{{minLength}}|{{maxLength}}/gi,u=>o[u]);else if(n!==void 0&&l!==null&&(a==="exclusive"&&l<=n||a==="inclusive"&&l!==null&&l<n)){c=!1;const u=a==="inclusive"?ye.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE:ye.VALIDATION_EDITOR_TEXT_MIN_LENGTH;h=t||u.replace(/{{minLength}}/gi,d=>o[d])}else if(s!==void 0&&l!==null&&(a==="exclusive"&&l>=s||a==="inclusive"&&l!==null&&l>s)){c=!1;const u=a==="inclusive"?ye.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE:ye.VALIDATION_EDITOR_TEXT_MAX_LENGTH;h=t||u.replace(/{{maxLength}}/gi,d=>o[d])}return{valid:c,msg:h}}const cC=3;class hC{constructor(e){var t;if(this.args=e,this._isValueTouched=!1,this._lastTriggeredByClearInput=!1,this.disabled=!1,this.forceUserInput=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this._bindEventService=new Xi,(t=this.gridOptions)!=null&&t.translater&&(this._translater=this.gridOptions.translater),this._locales=this.gridOptions&&this.gridOptions.locales||ye.locales,this.init()}get autocompleterOptions(){return this._autocompleterOptions||{}}get collection(){var e;return((e=this.columnEditor)==null?void 0:e.collection)??[]}get editorDomElement(){return this._inputElm}get elementCollection(){return this._elementCollection}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)||{}}get customStructure(){var r,n,s,a,o;let e=(r=this.columnEditor)==null?void 0:r.customStructure;const t=((n=this.columnEditor)==null?void 0:n.type)??((s=this.columnDef)==null?void 0:s.type);return!e&&t===Y.object&&((a=this.columnDef)!=null&&a.dataKey)&&((o=this.columnDef)!=null&&o.labelKey)&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get dataContext(){return this.args.item}get editorOptions(){var e;return((e=this.columnEditor)==null?void 0:e.editorOptions)||{}}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get instance(){return this._instance}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var t,r,n,s,a,o;this.labelName=((t=this.customStructure)==null?void 0:t.label)??"label",this.valueName=((r=this.customStructure)==null?void 0:r.value)??"value",this.labelPrefixName=((n=this.customStructure)==null?void 0:n.labelPrefix)??"labelPrefix",this.labelSuffixName=((s=this.customStructure)==null?void 0:s.labelSuffix)??"labelSuffix";let e=this.columnEditor.collection;(a=this.columnEditor)!=null&&a.collectionAsync&&!e&&(e=[]),this.renderDomElement(e),(this.disabled||(o=this.columnEditor)!=null&&o.collectionAsync&&Array.isArray(e)&&e.length===0)&&this.disable(!0)}destroy(){var e,t,r;this._bindEventService.unbindAll(),typeof((e=this._instance)==null?void 0:e.destroy)=="function"&&this._instance.destroy(),(r=(t=this._inputElm)==null?void 0:t.remove)==null||r.call(t),this._elementCollection=null}disable(e=!0){var r;const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const n=this.getValue();t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&n!==""&&this.clear(!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm&&(this._inputElm.focus(),this._inputElm.select())}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,r=!0){if(this._inputElm.value=e!=null&&e.hasOwnProperty(this.labelName)?e[this.labelName]:e,t){this._currentValue=e,this._defaultTextValue=typeof e=="string"?e:(e==null?void 0:e[this.labelName])??"",this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(null,n,"system")}}applyValue(e,t){var s,a;let r=t;const n=(s=this.columnDef)==null?void 0:s.field;if(n!==void 0){Array.isArray(this.collection)&&this.collection.length>0&&(r=ss(this.collection,h=>h&&sa(t)&&h.hasOwnProperty(this.valueName)?h[this.valueName].toString()===(t.hasOwnProperty(this.valueName)&&t[this.valueName].toString()):h&&typeof t=="string"&&h.hasOwnProperty(this.valueName)?h[this.valueName].toString()===t:(h==null?void 0:h.toString())===t,""));const o=(n==null?void 0:n.indexOf("."))>0,c=this.validate(null,r);if(r=c!=null&&c.valid?r:"",o){const h=((a=this.columnEditor)==null?void 0:a.complexObjectPath)??n??"";Hr(e,h,r)}else e[n]=r}}isValueChanged(){var n,s;const e=this._inputElm.value,t=(n=this._lastInputKeyEvent)==null?void 0:n.key;if((s=this.columnEditor)!=null&&s.alwaysSaveOnEnterKey&&t==="Enter")return!0;const r=!(e===""&&(this._defaultTextValue===null||this._defaultTextValue===void 0))&&e!==this._defaultTextValue;return this._lastTriggeredByClearInput||r}isValueTouched(){return this._isValueTouched}loadValue(e){var r;const t=(r=this.columnDef)==null?void 0:r.field;if(e&&t!==void 0){const s=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._currentValue=s,this._originalValue=s,this._defaultTextValue=typeof s=="string"?s:(s==null?void 0:s[this.labelName])??"",this._inputElm.value=this._defaultTextValue,this._inputElm.select()}}clear(e=!1){this._inputElm&&(this._currentValue="",this._defaultTextValue="",this.setValue("",!0)),this._isValueTouched=!0,this._lastTriggeredByClearInput=!0;const t=this.args.compositeEditorOptions;if(t){const r=!e;this.handleChangeOnCompositeEditor(null,t,"user",r)}else this.save()}reset(e,t=!0,r=!1){const n=e??this._originalValue??"";this._inputElm&&(this._currentValue=n,this._defaultTextValue=typeof n=="string"?n:(n==null?void 0:n[this.labelName])??"",this._inputElm.value=this._defaultTextValue),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(null,s,"user",a)}}save(){const e=this.validate(),t=(e==null?void 0:e.valid)??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){var e,t,r,n,s;if(this._inputElm&&this.editorOptions.forceUserInput){const a=((e=this.editorOptions)==null?void 0:e.minLength)??cC;this._currentValue=this._inputElm.value.length>a?this._inputElm.value:this._currentValue}return this.customStructure&&this._currentValue&&this._currentValue.hasOwnProperty(this.valueName)&&((t=this.columnDef)==null?void 0:t.type)!==Y.object&&((r=this.columnEditor)==null?void 0:r.type)!==Y.object?this._currentValue[this.valueName]:this._currentValue&&this._currentValue.value!==void 0?((n=this.columnDef)==null?void 0:n.type)===Y.object||((s=this.columnEditor)==null?void 0:s.type)===Y.object?{[this.labelName]:this._currentValue.label,[this.valueName]:this._currentValue.value}:this._currentValue.value:this._currentValue}validate(e,t){var n,s;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:(n=this._inputElm)==null?void 0:n.value;return xh(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:(s=this.args)!=null&&s.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var d,f,p;const s=this.grid.getActiveCell(),a=this.args.column,o=((d=this.columnDef)==null?void 0:d.id)??"",c=this.dataContext,h=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(t.formValues,l);const u=((p=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:p.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&u&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],h.onCompositeEditorChange.notify({...s,item:c,grid:h,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}handleSelect(e){var t;if(e!==void 0){const n=e;this._currentValue=n,this._isValueTouched=!0;const s=this.args.compositeEditorOptions,a=((t=this.editorOptions)==null?void 0:t.renderItem)??!1,o=typeof n=="string"?n:a?n[this.labelName]:n.label;if(this.setValue(o),s?this.handleChangeOnCompositeEditor(null,s):this.save(),typeof this.editorOptions.onSelectItem=="function"){const{row:c,cell:h}=this.grid.getActiveCell()||{};this.editorOptions.onSelectItem(e,c,h,this.args.column,this.args.item)}setTimeout(()=>this._lastTriggeredByClearInput=!1)}return!1}renderRegularItem(e){const t=typeof e=="string"?e:(e==null?void 0:e.label)??"";return K("div",{textContent:t||""})}renderCustomItem(e){var n,s;const t=((s=(n=this._autocompleterOptions)==null?void 0:n.renderItem)==null?void 0:s.templateCallback(e))??"",r=document.createElement("div");return this.grid.applyHtmlCode(r,t),r}renderCollectionItem(e){var h;const t=((h=this.columnEditor)==null?void 0:h.enableRenderHtml)??!1,r=e.labelPrefix||"",n=e.label||"",s=e.labelSuffix||"",a=r+n+s,o=fa(this.gridOptions,a)||"",c=document.createElement("div");return c[t?"innerHTML":"textContent"]=o,c}renderDomElement(e){var o,c,h,l,u,d,f,p,m,v,_;const t=((o=this.columnDef)==null?void 0:o.id)??"",r=((c=this.columnEditor)==null?void 0:c.placeholder)??"",n=((h=this.columnEditor)==null?void 0:h.title)??"";this._editorInputGroupElm=K("div",{className:"autocomplete-container input-group"});const s=K("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=K("button",{type:"button",className:"btn btn-default icon-clear"}),this._inputElm=K("input",{type:"text",placeholder:r,title:n,autocomplete:"off",ariaAutoComplete:"none",className:`autocomplete form-control editor-text input-group-editor editor-${t}`,dataset:{input:""}},this._editorInputGroupElm),this._editorInputGroupElm.appendChild(document.createElement("span")),(l=this.columnEditor.editorOptions)!=null&&l.hideClearButton||(s.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(s),this._bindEventService.bind(this._clearButtonElm,"click",()=>this.clear())),this._bindEventService.bind(this._inputElm,"focus",()=>{var x;return(x=this._inputElm)==null?void 0:x.select()}),this._bindEventService.bind(this._inputElm,"keydown",x=>{this._lastInputKeyEvent=x,(x.key==="ArrowLeft"||x.key==="ArrowRight")&&x.stopImmediatePropagation(),this.columnEditor.alwaysSaveOnEnterKey&&x.key==="Enter"&&(this._currentValue=null)});let a=e;if(a&&((u=this.columnEditor)!=null&&u.collectionOverride)){const x={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:E,modalType:C}=this.args.compositeEditorOptions;x.compositeEditorOptions={formValues:E,modalType:C}}a=this.columnEditor.collectionOverride(a,x)}a&&(this.finalCollection=a),Array.isArray(a)&&(this.collection.every(x=>bl(x))?a=a.map(x=>({label:x,value:x})):a=a.map(x=>({label:x==null?void 0:x[this.labelName],value:x==null?void 0:x[this.valueName],labelPrefix:(x==null?void 0:x[this.labelPrefixName])??"",labelSuffix:(x==null?void 0:x[this.labelSuffixName])??""})),this._elementCollection=a),this._autocompleterOptions={input:this._inputElm,debounceWaitMs:200,className:`slick-autocomplete ${((d=this.editorOptions)==null?void 0:d.className)??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&((f=this._translater)!=null&&f.translate)?this._translater.translate("NO_ELEMENTS_FOUND"):((p=this._locales)==null?void 0:p.TEXT_NO_ELEMENTS_FOUND)??"No elements found",customize:(x,E,C)=>{C.style.width=""},onSelect:this.handleSelect.bind(this),...this.editorOptions},(m=this._autocompleterOptions.renderItem)!=null&&m.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${sl(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=((v=this._autocompleterOptions.render)==null?void 0:v.bind(this))??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),(_=this._autocompleterOptions)!=null&&_.fetch?(jm(this._inputElm,this._autocompleterOptions),this._instance=Nc(this._autocompleterOptions)):this._instance=Nc({...this._autocompleterOptions,fetch:(x,E)=>{a&&E(a.filter(C=>((typeof C=="string"?C:C==null?void 0:C.label)||"").toLowerCase().includes(x.toLowerCase())))}}),this.args.container.appendChild(this._editorInputGroupElm),this.args.compositeEditorOptions||setTimeout(()=>this.focus(),50)}}class uC{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Xi,this.init()}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var n,s,a,o;const e=((n=this.columnDef)==null?void 0:n.id)??"",t=this.args.compositeEditorOptions;this._checkboxContainerElm=K("div",{className:`checkbox-editor-container editor-${e}`}),this._input=K("input",{type:"checkbox",value:"true",ariaLabel:((s=this.columnEditor)==null?void 0:s.ariaLabel)??`${rn(e+"")} Checkbox Editor`,className:`editor-checkbox editor-${e}`,title:((a=this.columnEditor)==null?void 0:a.title)??""});const r=(o=this.args)==null?void 0:o.container;r&&typeof r.appendChild=="function"&&(t?(this._checkboxContainerElm.appendChild(this._input),r.appendChild(this._checkboxContainerElm)):r.appendChild(this._input)),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,"click",()=>{this._isValueTouched=!0,this.save()}),t?this._bindEventService.bind(this._input,"change",c=>{this._isValueTouched=!0,this.handleChangeOnCompositeEditor(c,t)}):this.focus()}destroy(){var e,t;this._bindEventService.unbindAll(),(t=(e=this._input)==null?void 0:e.remove)==null||t.call(e)}disable(e=!0){var r;const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled"),this._checkboxContainerElm.classList.add("disabled");const n=this.getValue();t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&n!==!1&&this.reset(!1,!0,!0)}else this._input.removeAttribute("disabled"),this._checkboxContainerElm.classList.remove("disabled")}focus(){var e;this.grid.focus(),(e=this._input)==null||e.focus()}preClick(){this._input&&(this._input.checked=!this._input.checked)}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)&&this.applyInputUsabilityState()}getValue(){var e;return((e=this._input)==null?void 0:e.checked)??!1}setValue(e,t=!1,r=!0){const n=!!e;if(this._input&&(this._input.checked=n),t){this.applyValue(this.args.item,this.serializeValue());const s=this.args.compositeEditorOptions;s&&r&&this.handleChangeOnCompositeEditor(null,s,"system")}}applyValue(e,t){var n;const r=this.columnDef&&this.columnDef.field;if(r!==void 0){const s=(r==null?void 0:r.indexOf("."))>0,a=this.validate(null,t),o=a&&a.valid?t:"";if(s){const c=((n=this.columnEditor)==null?void 0:n.complexObjectPath)??r??"";Hr(e,c,o)}else e[r]=o}}isValueChanged(){return this.serializeValue()!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(e&&t!==void 0&&this._input){const n=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._originalValue=n,this._input.checked=!!this._originalValue}}reset(e,t=!0,r=!1){const n=e??this._originalValue??!1;this._input&&(this._originalValue=n,this._input.checked=!!n),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(null,s,"user",a)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){var e;return((e=this._input)==null?void 0:e.checked)??!1}validate(e,t){var a,o;const r=(a=this.args)!=null&&a.compositeEditorOptions?!1:this.columnEditor.required,n=t!==void 0?t:(o=this._input)==null?void 0:o.checked,s=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(n,this.args):r&&!n?{valid:!1,msg:s||ye.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var d,f,p;const s=this.grid.getActiveCell(),a=this.args.column,o=((d=this.columnDef)==null?void 0:d.id)??"",c=this.dataContext,h=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(t.formValues,l);const u=((p=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:p.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&u&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],h.onCompositeEditorChange.notify({...s,item:c,grid:h,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}}const cc=Wr||uh;class dC{constructor(e){var t;if(this.args=e,this._isValueTouched=!1,this._lastTriggeredByClearDate=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},(t=this.gridOptions)!=null&&t.translater&&(this._translaterService=this.gridOptions.translater),this._bindEventService=new Xi,this.init()}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._inputElm}get editorOptions(){return this.columnEditor.editorOptions||{}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get pickerOptions(){return this._pickerMergedOptions}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var e,t,r,n,s,a;if(this.args&&this.columnDef){const o=this.args.compositeEditorOptions,c=((e=this.columnDef)==null?void 0:e.id)??"",h=this.args.grid.getOptions()||{};this.defaultDate=this.args.item?this.args.item[this.columnDef.field]:null;const l=il(this.columnEditor.type||this.columnDef.type||Y.dateUtc),u=il(this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||Y.dateUtc);let d=((r=(t=this._translaterService)==null?void 0:t.getCurrentLanguage)==null?void 0:r.call(t))||h.locale||"en";d.length>2&&(d=d.substring(0,2));const f={defaultDate:this.defaultDate,altInput:!0,altFormat:u,dateFormat:l,closeOnSelect:!0,wrap:!0,locale:d,onChange:()=>this.handleOnDateChange(),errorHandler:v=>{v.toString().includes("invalid locale")&&console.warn(`[Slickgrid-Universal] Flatpickr missing locale imports (${d}), will revert to English as the default locale.
          See Flatpickr Localization for more info, for example if we want to use French, then we can import it with:  import 'flatpickr/dist/l10n/fr';`)}};this._pickerMergedOptions={...f,...this.editorOptions};const p=`.editor-text.editor-${c}.form-control`;this._pickerMergedOptions.altInput&&(this._pickerMergedOptions.altInputClass="flatpickr-alt-input form-control"),this._editorInputGroupElm=K("div",{className:"flatpickr input-group"});const m=K("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=K("button",{type:"button",className:"btn btn-default icon-clear"}),this._inputElm=K("input",{placeholder:((n=this.columnEditor)==null?void 0:n.placeholder)??"",title:this.columnEditor&&this.columnEditor.title||"",className:p.replace(/\./g," "),dataset:{input:"",defaultdate:this.defaultDate}},this._editorInputGroupElm),(s=this.columnEditor.editorOptions)!=null&&s.hideClearButton||(m.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(m),this._bindEventService.bind(this._clearButtonElm,"click",()=>this._lastTriggeredByClearDate=!0)),this.args.container.appendChild(this._editorInputGroupElm),this.flatInstance=Pi(this._editorInputGroupElm,this._pickerMergedOptions),this._inputWithDataElm=(a=this._pickerMergedOptions)!=null&&a.altInput?document.querySelector(`${p}.flatpickr-alt-input`):this._inputElm,o||setTimeout(()=>{this.show(),this.focus()},50)}}destroy(){var e,t,r,n,s,a,o,c;this.hide(),this._bindEventService.unbindAll(),typeof((e=this.flatInstance)==null?void 0:e.destroy)=="function"&&(this.flatInstance.destroy(),(t=this.flatInstance)!=null&&t.element&&setTimeout(()=>Sl(this.flatInstance))),Rt(this._editorInputGroupElm),Rt(this._inputWithDataElm),Rt(this._inputElm),(n=(r=this._editorInputGroupElm)==null?void 0:r.remove)==null||n.call(r),(a=(s=this._inputWithDataElm)==null?void 0:s.remove)==null||a.call(s),(c=(o=this._inputElm)==null?void 0:o.remove)==null||c.call(o)}disable(e=!0){var r,n;const t=this.disabled;if(this.disabled=e,(r=this.flatInstance)!=null&&r._input)if(e){this.flatInstance._input.setAttribute("disabled","disabled"),this._clearButtonElm.disabled=!0;const s=this.getValue();t!==e&&((n=this.args)!=null&&n.compositeEditorOptions)&&s!==""&&this.reset("",!0,!0)}else this.flatInstance._input.removeAttribute("disabled"),this._clearButtonElm.disabled=!1}changeEditorOption(e,t){this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this._pickerMergedOptions={...this._pickerMergedOptions,[e]:t},this.flatInstance.set(e,t)}focus(){var e,t;this.grid.focus(),this.show(),(e=this._inputElm)==null||e.focus(),(t=this._inputWithDataElm)!=null&&t.focus&&(this._inputWithDataElm.focus(),this._inputWithDataElm.select())}hide(){this.flatInstance&&typeof this.flatInstance.close=="function"&&this.flatInstance.close()}show(){var t;const e=!!((t=this.args)!=null&&t.compositeEditorOptions);!e&&this.flatInstance&&typeof this.flatInstance.open=="function"&&this.flatInstance._input?this.flatInstance.open():e&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,r=!0){if(this.flatInstance.setDate(e),t){this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(n,"system")}}applyValue(e,t){var n;const r=this.columnDef&&this.columnDef.field;if(r!==void 0){const s=Lr(this.columnDef&&(this.columnDef.outputType||this.columnEditor.type||this.columnDef.type)||Y.dateUtc),a=Lr(this.columnDef&&(this.columnDef.saveOutputType||this.columnDef.outputType||this.columnEditor.type||this.columnDef.type)||Y.dateUtc),o=(r==null?void 0:r.indexOf("."))>0,c=this.validate(null,t),h=t&&c&&c.valid?cc(t,s).format(a):"";if(o){const l=((n=this.columnEditor)==null?void 0:n.complexObjectPath)??r??"";Hr(e,l,h)}else e[r]=h}}isValueChanged(){var o;const e=this._inputElm.value,t=Lr(this.columnEditor.type||((o=this.columnDef)==null?void 0:o.type)||Y.dateIso),r=Lr(this.columnDef&&(this.columnDef.outputType||this.columnEditor.type||this.columnDef.type)||Y.dateUtc),n=e?cc(e,t,!1).format(r):"",s=this._originalDate?cc(this._originalDate,t,!1).format(r):"";return n==="Invalid date"||s==="Invalid date"?!1:this._lastTriggeredByClearDate||!(n===""&&s==="")&&n!==s}isValueTouched(){return this._isValueTouched}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(e&&t!==void 0){const n=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._originalDate=n,this.flatInstance.setDate(n)}}reset(e,t=!0,r=!1){const n=e??this._originalDate??"";this.flatInstance&&(this._originalDate=n,this.flatInstance.setDate(n),n||this.flatInstance.clear()),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(s,"user",a)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){var s;const e=this._inputElm.value;if(!e)return"";const t=Lr(this.columnEditor.type||((s=this.columnDef)==null?void 0:s.type)||Y.dateIso),r=Lr(this.columnDef&&(this.columnDef.outputType||this.columnEditor.type||this.columnDef.type)||Y.dateIso);return cc(e,t,!1).format(r)}validate(e,t){var a,o;const r=(a=this.args)!=null&&a.compositeEditorOptions?!1:this.columnEditor.required,n=t!==void 0?t:(o=this._inputElm)==null?void 0:o.value,s=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(n,this.args):r&&n===""?{valid:!1,msg:s||ye.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleOnDateChange(){var t;this._isValueTouched=!0;const e=((t=this.flatInstance)==null?void 0:t.config)??this._pickerMergedOptions;if(this.args&&(e!=null&&e.closeOnSelect)){const r=this.args.compositeEditorOptions;r?this.handleChangeOnCompositeEditor(r):this.save()}setTimeout(()=>this._lastTriggeredByClearDate=!1)}handleChangeOnCompositeEditor(e,t="user",r=!1){var u,d,f;const n=this.grid.getActiveCell(),s=this.args.column,a=((u=this.columnDef)==null?void 0:u.id)??"",o=this.dataContext,c=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(e.formValues,h);const l=((f=(d=this.gridOptions)==null?void 0:d.compositeEditorOptions)==null?void 0:f.excludeDisabledFieldFormValues)??!1;(r||this.disabled&&l&&e.formValues.hasOwnProperty(a))&&delete e.formValues[a],c.onCompositeEditorChange.notify({...n,item:o,grid:c,column:s,formValues:e.formValues,editors:e.editors,triggeredBy:t},new Yt)}}function zg(i,e){const t=isNaN(i)?null:parseFloat(i),r=e.decimal||0,n=e.required,s=e.minValue,a=e.maxValue,o=e.operatorConditionalType||"inclusive",c=e.errorMessage,h={"{{minValue}}":s,"{{maxValue}}":a,"{{minDecimal}}":0,"{{maxDecimal}}":r};let l=!0,u="";if(typeof e.validator=="function")return e.validator(i,e.editorArgs);if(n&&i==="")l=!1,u=c||ye.VALIDATION_REQUIRED_FIELD;else if(i!==""&&(isNaN(i)||r===0&&!/^[-+]?(\d*(\.)?(\d)*)$/.test(i)))l=!1,u=c||ye.VALIDATION_EDITOR_VALID_NUMBER;else if(s!==void 0&&a!==void 0&&t!==null&&(o==="exclusive"&&(t<=+s||t>=+a)||o==="inclusive"&&(t<+s||t>+a)))l=!1,u=c||ye.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,d=>h[d]);else if(s!==void 0&&t!==null&&(o==="exclusive"&&t<=+s||o==="inclusive"&&t<+s)){l=!1;const d=o==="inclusive"?ye.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE:ye.VALIDATION_EDITOR_NUMBER_MIN;u=c||d.replace(/{{minValue}}/gi,f=>h[f])}else if(a!==void 0&&t!==null&&(o==="exclusive"&&t>=+a||o==="inclusive"&&t>+a)){l=!1;const d=o==="inclusive"?ye.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE:ye.VALIDATION_EDITOR_NUMBER_MAX;u=c||d.replace(/{{maxValue}}/gi,f=>h[f])}else r>0&&!new RegExp(`^[-+]?(\\d*(\\.)?(\\d){0,${r}})$`).test(i)&&(l=!1,u=c||ye.VALIDATION_EDITOR_DECIMAL_BETWEEN.replace(/{{minDecimal}}|{{maxDecimal}}/gi,d=>h[d]));return{valid:l,msg:u}}function Gg(i,e){let t=isNaN(i)?null:parseInt(i,10);t!==null&&isNaN(t)&&(t=null);const r=e.errorMessage,n=e.required,s=e.minValue,a=e.maxValue,o=e.operatorConditionalType||"inclusive",c={"{{minValue}}":s,"{{maxValue}}":a};let h=!0,l="";if(e.validator)return e.validator(i,e.editorArgs);if(n&&i==="")h=!1,l=r||ye.VALIDATION_REQUIRED_FIELD;else if(i!==""&&(isNaN(i)||!/^[+-]?\d+$/.test(i)))h=!1,l=r||ye.VALIDATION_EDITOR_VALID_INTEGER;else if(s!==void 0&&a!==void 0&&t!==null&&(o==="exclusive"&&(t<=+s||t>=+a)||o==="inclusive"&&(t<+s||t>+a)))h=!1,l=r||ye.VALIDATION_EDITOR_INTEGER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,u=>c[u]);else if(s!==void 0&&t!==null&&(o==="exclusive"&&t<=+s||o==="inclusive"&&t!==null&&t<+s)){h=!1;const u=o==="inclusive"?ye.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE:ye.VALIDATION_EDITOR_INTEGER_MIN;l=r||u.replace(/{{minValue}}/gi,d=>c[d])}else if(a!==void 0&&t!==null&&(o==="exclusive"&&t>=+a||o==="inclusive"&&t!==null&&t>+a)){h=!1;const u=o==="inclusive"?ye.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE:ye.VALIDATION_EDITOR_INTEGER_MAX;l=r||u.replace(/{{maxValue}}/gi,d=>c[d])}return{valid:h,msg:l}}function fC(i,e){const t=e.required,r=e.minValue,n=e.maxValue,s=e.errorMessage,a={"{{minValue}}":r,"{{maxValue}}":n};return e.validator?e.validator(i,e.editorArgs):t&&i===""?{valid:!1,msg:s||ye.VALIDATION_REQUIRED_FIELD}:r!==void 0&&n!==void 0&&i!==null&&(i<r||i>n)?{valid:!1,msg:s||ye.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,o=>a[o])}:{valid:!0,msg:null}}class pC{constructor(e){if(this.args=e,this._isValueSaveCalled=!1,this._isLeftValueTouched=!1,this._isRightValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._eventHandler=new di,this._bindEventService=new Xi,this.init(),this._eventHandler.subscribe(this.grid.onValidationError,()=>this._isValueSaveCalled=!0)}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)||{}}get dataContext(){return this.args.item}get editorDomElement(){return{leftInput:this._leftInput,rightInput:this._rightInput}}get editorParams(){return this.columnEditor.params||{}}get eventHandler(){return this._eventHandler}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get isValueSaveCalled(){return this._isValueSaveCalled}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var r,n,s,a;if(!this.editorParams||!this.editorParams.leftInput||!this.editorParams.leftInput.field||!this.editorParams.rightInput||!this.editorParams.rightInput.field)throw new Error(`[Slickgrid-Universal] Please make sure that your Combo Input Editor has params defined with "leftInput" and "rightInput" (example: { editor: { model: Editors.comboInput, params: { leftInput: { field: 'firstName' }, { rightSide: { field: 'lastName' } }}}`);this._leftFieldName=(r=this.editorParams.leftInput)==null?void 0:r.field,this._rightFieldName=(n=this.editorParams.rightInput)==null?void 0:n.field,this._leftInput=this.createInput("leftInput"),this._rightInput=this.createInput("rightInput");const e=(s=this.args)==null?void 0:s.container;e&&typeof e.appendChild=="function"&&(e.appendChild(this._leftInput),e.appendChild(this._rightInput)),this._bindEventService.bind(this._leftInput,"keydown",o=>this.handleKeyDown(o,"leftInput")),this._bindEventService.bind(this._rightInput,"keydown",o=>this.handleKeyDown(o,"rightInput")),this.hasAutoCommitEdit&&(this._bindEventService.bind(this._leftInput,"focusout",o=>this.handleFocusOut(o,"leftInput")),this._bindEventService.bind(this._rightInput,"focusout",o=>this.handleFocusOut(o,"rightInput"))),((a=this.args)==null?void 0:a.compositeEditorOptions)?(this._bindEventService.bind(this._leftInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this)),this._bindEventService.bind(this._rightInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this))):setTimeout(()=>this._leftInput.select(),50)}handleFocusOut(e,t){var a;const r=((a=e.relatedTarget)==null?void 0:a.className)||"";!this.args.compositeEditorOptions&&r.indexOf("dual-editor")===-1&&this._lastEventType!=="focusout-right"&&(t==="rightInput"||t==="leftInput"&&this._lastEventType!=="focusout-left")&&(t==="leftInput"?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this.save());const s=t==="leftInput"?"left":"right";this._lastEventType=`${e==null?void 0:e.type}-${s}`}handleKeyDown(e,t){t==="leftInput"?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this._lastInputKeyEvent=e,(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="Tab")&&e.stopImmediatePropagation()}destroy(){var e,t,r,n;this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),(t=(e=this._leftInput)==null?void 0:e.remove)==null||t.call(e),(n=(r=this._rightInput)==null?void 0:r.remove)==null||n.call(r)}createInput(e){var c,h,l,u;const t=this.editorParams[e],r=((c=this.columnDef)==null?void 0:c.id)??"",n=this.gridOptions.datasetIdPropertyName||"id",s=((l=(h=this.args)==null?void 0:h.item)==null?void 0:l[n])??"";let a=t.type||"text";(a==="float"||a==="integer")&&(a="number");const o=K("input",{type:a||"text",id:`item-${s}-${e}`,ariaLabel:((u=this.columnEditor)==null?void 0:u.ariaLabel)??`${rn(r+"")} Input Editor`,className:`dual-editor-text editor-${r} ${e.replace(/input/gi,"")}`,autocomplete:"off",ariaAutoComplete:"none",placeholder:t.placeholder||"",title:t.title||""});return a==="readonly"&&(o.readOnly=!0,a="text"),a==="number"&&(o.step=this.getInputDecimalSteps(e)),o}disable(e=!0){var r;const t=this.disabled;this.disabled=e,this._leftInput&&this._rightInput&&(e?(this._leftInput.setAttribute("disabled","disabled"),this._rightInput.setAttribute("disabled","disabled"),t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&this.reset("",!0,!0)):(this._leftInput.removeAttribute("disabled"),this._rightInput.removeAttribute("disabled")))}focus(){this.grid.focus()}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)&&this.applyInputUsabilityState()}getValues(){const e={},t=this._leftInput.value,r=this._rightInput.value,n=this.editorParams.leftInput&&(this.editorParams.leftInput.type==="float"||this.editorParams.leftInput.type==="integer"),s=this.editorParams.rightInput&&(this.editorParams.rightInput.type==="float"||this.editorParams.rightInput.type==="integer"),a=t!==""&&n?+this._leftInput.value:t||"",o=r!==""&&s?+this._rightInput.value:r||"";return Hr(e,this._leftFieldName,a),Hr(e,this._rightFieldName,o),e}setValues(e){Array.isArray(e)&&e.length===2&&(this._leftInput.value=`${e[0]}`,this._rightInput.value=`${e[1]}`)}applyValue(e,t){this.applyValueByPosition(e,t,"leftInput"),this.applyValueByPosition(e,t,"rightInput")}applyValueByPosition(e,t,r){var s;const n=r==="leftInput"?this._leftFieldName:this._rightFieldName;if(n!==void 0){const a=(n==null?void 0:n.indexOf("."))>0;let o=n;if(a){const l=n.split(/\.(.*)/);o=l.length>1?l[1]:l}const c=a?Ti(t,o):t[n],h=this.validate(null,{position:r,inputValue:c});if(a){const l=Ti(t,o),u=h&&h.valid?l:"",d=((s=this.columnEditor)==null?void 0:s.complexObjectPath)??n??"";Hr(e,d,u)}else n&&(e[n]=h&&h.valid?t[n]:"")}}isValueChanged(){var c,h,l;const e=this._leftInput.value,t=this._rightInput.value,r=(c=this.editorParams)==null?void 0:c.leftInput,n=(h=this.editorParams)==null?void 0:h.rightInput,s=(l=this._lastInputKeyEvent)==null?void 0:l.key;if((r&&r.alwaysSaveOnEnterKey||n&&n.alwaysSaveOnEnterKey)&&s==="Enter")return!0;const a=!(e===""&&(this._originalLeftValue===null||this._originalLeftValue===void 0))&&e!==this._originalLeftValue,o=!(t===""&&(this._originalRightValue===null||this._originalRightValue===void 0))&&t!==this._originalRightValue;return a||o}isValueTouched(){return this._isLeftValueTouched||this._isRightValueTouched}loadValue(e){this.loadValueByPosition(e,"leftInput"),this.loadValueByPosition(e,"rightInput"),this._leftInput.select()}loadValueByPosition(e,t){const r=t==="leftInput"?this._leftFieldName:this._rightFieldName,n=t==="leftInput"?"_originalLeftValue":"_originalRightValue",s=t==="leftInput"?"_leftInput":"_rightInput";if(e&&r!==void 0){const o=(r==null?void 0:r.indexOf("."))>0?Ti(e,r):e.hasOwnProperty(r)?e[r]:"";if(this[n]=o,this.editorParams[t].type==="float"){const c=this.getDecimalPlaces(t);c!==null&&(this[n]||this[n]===0)&&typeof this[n]!==void 0&&(this[n]=(+this[n]).toFixed(c))}this[s]&&(this[s].value=`${this[n]}`)}}reset(e,t=!0,r=!1){const n=e??this._originalLeftValue??"",s=e??this._originalRightValue??"";this._leftInput&&this._rightInput&&(this._originalLeftValue=n,this._originalRightValue=s,this._leftInput.value=`${n}`,this._rightInput.value=`${s}`),this._isLeftValueTouched=!1,this._isRightValueTouched=!1;const a=this.args.compositeEditorOptions;if(a&&t){const o=!r;this.handleChangeOnCompositeEditor(null,a,"user",o)}}save(){const e=this.validate(),t=e&&e.valid||!1;this._isValueSaveCalled||(this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges(),this._isValueSaveCalled=!0)}serializeValue(){const e={},t=this.serializeValueByPosition("leftInput"),r=this.serializeValueByPosition("rightInput");return Hr(e,this._leftFieldName,t),Hr(e,this._rightFieldName,r),e}serializeValueByPosition(e){const t=e==="leftInput"?this._leftInput.value:this._rightInput.value;if(t===""||isNaN(+t))return t;let r=parseFloat(t);const n=this.getDecimalPlaces(e);return n!==null&&(r||r===0)&&r.toFixed&&(r=parseFloat(r.toFixed(n))),r}getDecimalPlaces(e){const r=e==="leftInput"?"leftInput":"rightInput",n=this.editorParams[r],s=n==null?void 0:n.decimal;return s===void 0?0:s}getInputDecimalSteps(e){const t=this.getDecimalPlaces(e);let r="";for(let n=1;n<t;n++)r+="0";return t>0?`0.${r}1`:"1"}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(t){const r=this.validateByPosition(t.position,t.inputValue);if(!r.valid)return t.position==="leftInput"?this._leftInput.select():this._rightInput.select(),r}else{const r=this.validateByPosition("leftInput"),n=this.validateByPosition("rightInput");if(!r.valid)return this._leftInput.select(),r;if(!n.valid)return this._rightInput.select(),n}return{valid:!0,msg:""}}validateByPosition(e,t){var o;const r=this.editorParams[e];let n="";if(t)n=t;else{const c=e==="leftInput"?this._leftInput:this._rightInput;n=c&&c.value}const s=this.validator;n=typeof s=="function"?this.getValues():n;const a={editorArgs:this.args,errorMessage:r.errorMessage,required:(o=this.args)!=null&&o.compositeEditorOptions?!1:r.required,validator:typeof s=="function"?s:r.validator};switch(r.type){case"float":return zg(n,{...a,decimal:this.getDecimalPlaces(e),minValue:r.minValue,maxValue:r.maxValue,operatorConditionalType:r.operatorConditionalType});case"integer":return Gg(n,{...a,minValue:r.minValue,maxValue:r.maxValue,operatorConditionalType:r.operatorConditionalType});case"text":case"password":default:return xh(n,a)}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var f,p,m,v,_,x;const s=this.grid.getActiveCell(),a=this.args.column,o=((p=(f=this.columnEditor.params)==null?void 0:f.leftInput)==null?void 0:p.field)??"",c=((v=(m=this.columnEditor.params)==null?void 0:m.rightInput)==null?void 0:v.field)??"",h=this.dataContext,l=this.grid,u=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,u),this.applyValue(t.formValues,u);const d=((x=(_=this.gridOptions)==null?void 0:_.compositeEditorOptions)==null?void 0:x.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&d&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],(n||this.disabled&&d&&t.formValues.hasOwnProperty(c))&&delete t.formValues[c],l.onCompositeEditorChange.notify({...s,item:h,grid:l,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}handleChangeOnCompositeEditorDebounce(e){var r,n;const t=(r=this.args)==null?void 0:r.compositeEditorOptions;if(t){const s=((n=this.gridOptions)==null?void 0:n.editorTypingDebounce)??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),s)}}}class wh{constructor(e,t){if(this.args=e,this._inputType="text",this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid&&e.grid.getOptions(),this._bindEventService=new Xi,this.inputType=t||"text",this.init()}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var n,s,a,o;const e=((n=this.columnDef)==null?void 0:n.id)??"",t=this.args.compositeEditorOptions;this._input=K("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:((s=this.columnEditor)==null?void 0:s.ariaLabel)??`${rn(e+"")} Input Editor`,placeholder:((a=this.columnEditor)==null?void 0:a.placeholder)??"",title:((o=this.columnEditor)==null?void 0:o.title)??"",className:`editor-text editor-${e}`});const r=this.args.container;r&&typeof r.appendChild=="function"&&r.appendChild(this._input),this._bindEventService.bind(this._input,"focus",()=>{var c;return(c=this._input)==null?void 0:c.select()}),this._bindEventService.bind(this._input,"keydown",c=>{this._isValueTouched=!0,this._lastInputKeyEvent=c,(c.key==="ArrowLeft"||c.key==="ArrowRight")&&c.stopImmediatePropagation()}),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,"focusout",()=>{this._isValueTouched=!0,this.save()}),t&&this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this))}destroy(){var e,t;this._bindEventService.unbindAll(),(t=(e=this._input)==null?void 0:e.remove)==null||t.call(e)}disable(e=!0){var r;const t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled");const n=this.getValue();t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&n!==""&&this.reset("",!0,!0)}else this._input.removeAttribute("disabled")}focus(){var e;this.grid.focus(),(e=this._input)==null||e.focus()}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)&&this.applyInputUsabilityState()}getValue(){var e;return((e=this._input)==null?void 0:e.value)||""}setValue(e,t=!1,r=!0){if(this._input&&(this._input.value=`${e}`,t)){this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(null,n,"system")}}applyValue(e,t){var n;const r=this.columnDef&&this.columnDef.field;if(r!==void 0){const s=(r==null?void 0:r.indexOf("."))>0,a=this.validate(null,t),o=a!=null&&a.valid?t:"";if(s){const c=((n=this.columnEditor)==null?void 0:n.complexObjectPath)??r??"";Hr(e,c,o)}else r&&(e[r]=o)}}isValueChanged(){var r,n,s;const e=(r=this._input)==null?void 0:r.value,t=(n=this._lastInputKeyEvent)==null?void 0:n.key;return(s=this.columnEditor)!=null&&s.alwaysSaveOnEnterKey&&t==="Enter"?!0:!(e===""&&(this._originalValue===null||this._originalValue===void 0))&&e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){var r;const t=(r=this.columnDef)==null?void 0:r.field;if(e&&t!==void 0&&this._input){const s=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e.hasOwnProperty(t)&&e[t]||"";this._originalValue=s,this._input.value=this._originalValue,this._input.select()}}reset(e,t=!0,r=!1){const n=e??this._originalValue??"";this._input&&(this._originalValue=n,this._input.value=`${n}`),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(null,s,"user",a)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){var e;return((e=this._input)==null?void 0:e.value)??""}validate(e,t){var n;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:this._input&&this._input.value;return xh(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:(n=this.args)!=null&&n.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var d,f,p;const s=this.grid.getActiveCell(),a=this.args.column,o=((d=this.columnDef)==null?void 0:d.id)??"",c=this.dataContext,h=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(t.formValues,l);const u=((p=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:p.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&u&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],h.onCompositeEditorChange.notify({...s,item:c,grid:h,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}handleOnInputChange(e){var r;this._isValueTouched=!0;const t=this.args.compositeEditorOptions;if(t){const n=((r=this.gridOptions)==null?void 0:r.editorTypingDebounce)??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),n)}}}const mC=0;class gC extends wh{constructor(e){super(e,"number"),this.args=e}init(){var e,t,r,n;if(this.columnDef&&this.columnEditor&&this.args){const s=((e=this.columnDef)==null?void 0:e.id)??"",a=this.args.compositeEditorOptions;this._input=K("input",{type:"number",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:((t=this.columnEditor)==null?void 0:t.ariaLabel)??`${rn(s+"")} Number Editor`,className:`editor-text editor-${s}`,placeholder:((r=this.columnEditor)==null?void 0:r.placeholder)??"",title:((n=this.columnEditor)==null?void 0:n.title)??"",step:`${this.columnEditor.valueStep!==void 0?this.columnEditor.valueStep:this.getInputDecimalSteps()}`});const o=this.args.container;o&&typeof o.appendChild=="function"&&o.appendChild(this._input),this._bindEventService.bind(this._input,"focus",()=>{var c;return(c=this._input)==null?void 0:c.select()}),this._bindEventService.bind(this._input,"keydown",c=>{this._lastInputKeyEvent=c,(c.key==="ArrowLeft"||c.key==="ArrowRight")&&c.stopImmediatePropagation()}),this.hasAutoCommitEdit&&!a&&this._bindEventService.bind(this._input,"focusout",()=>{this._isValueTouched=!0,this.save()}),a&&(this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._input,"wheel",this.handleOnMouseWheel.bind(this),{passive:!0}))}}getDecimalPlaces(){var t,r,n;let e=((t=this.columnEditor)==null?void 0:t.decimal)??((n=(r=this.columnEditor)==null?void 0:r.params)==null?void 0:n.decimalPlaces)??void 0;return e===void 0&&(e=mC),!e&&e!==0?null:e}getInputDecimalSteps(){const e=this.getDecimalPlaces();let t="";for(let r=1;r<e;r++)t+="0";return e>0?`0.${t}1`:"1"}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(t!==void 0&&e&&t!==void 0&&this._input){const n=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._originalValue=n;const s=this.getDecimalPlaces();s!==null&&(this._originalValue||this._originalValue===0)&&typeof this._originalValue!==void 0&&(this._originalValue=(+this._originalValue).toFixed(s)),this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){var n;const e=(n=this._input)==null?void 0:n.value;if(e===void 0||e===""||isNaN(+e))return e;let t=parseFloat(e);const r=this.getDecimalPlaces();return r!==null&&(t||t===0)&&t.toFixed&&(t=parseFloat(t.toFixed(r))),t}validate(e,t){var n,s;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:(n=this._input)==null?void 0:n.value;return zg(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,decimal:this.getDecimalPlaces(),minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:(s=this.args)!=null&&s.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}}class vC extends wh{constructor(e){super(e,"password"),this.args=e}}class _C extends wh{constructor(e){super(e,"number"),this.args=e}init(){var e,t,r,n;if(this.columnDef&&this.columnEditor&&this.args){const s=((e=this.columnDef)==null?void 0:e.id)??"",a=this.args.compositeEditorOptions;this._input=K("input",{type:"number",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:((t=this.columnEditor)==null?void 0:t.ariaLabel)??`${rn(s+"")} Slider Editor`,placeholder:((r=this.columnEditor)==null?void 0:r.placeholder)??"",title:((n=this.columnEditor)==null?void 0:n.title)??"",step:`${this.columnEditor.valueStep!==void 0?this.columnEditor.valueStep:"1"}`,className:`editor-text editor-${s}`});const o=this.args.container;o&&typeof o.appendChild=="function"&&o.appendChild(this._input),this._bindEventService.bind(this._input,"focus",()=>{var c;return(c=this._input)==null?void 0:c.select()}),this._bindEventService.bind(this._input,"keydown",c=>{this._lastInputKeyEvent=c,(c.key==="ArrowLeft"||c.key==="ArrowRight")&&c.stopImmediatePropagation()}),this.hasAutoCommitEdit&&!a&&this._bindEventService.bind(this._input,"focusout",()=>{this._isValueTouched=!0,this.save()}),a&&(this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._input,"wheel",this.handleOnMouseWheel.bind(this),{passive:!0}))}}loadValue(e){const t=this.columnDef&&this.columnDef.field;if(t!==void 0&&e&&t!==void 0&&this._input){const n=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._originalValue=isNaN(n)||n===null||n===void 0?n:`${n}`,this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){var r;const e=(r=this._input)==null?void 0:r.value;if(e===void 0||e===""||isNaN(+e))return e;const t=isNaN(+e)?e:parseInt(e,10);return isNaN(+t)?e:t}validate(e,t){var n;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:this.getValue();return Gg(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:(n=this.args)!=null&&n.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}handleOnMouseWheel(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}}class EC{constructor(e){if(this.args=e,this._isValueTouched=!1,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=e.grid&&e.grid.getOptions();const t=this.gridOptions||this.args.column.params||{};t!=null&&t.translater&&(this._translater=t.translater),this._locales=this.gridOptions&&this.gridOptions.locales||ye.locales,this._bindEventService=new Xi,this.init()}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._textareaElm}get editorOptions(){var e;return((e=this.columnEditor)==null?void 0:e.editorOptions)??{}}get hasAutoCommitEdit(){var e;return((e=this.gridOptions)==null?void 0:e.autoCommitEdit)??!1}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var l,u,d,f,p,m,v,_,x,E,C,y,b,T;let e="",t="";if(this._translater&&this._translater.translate&&this.gridOptions.enableTranslate){const R=Kn(this.gridOptions),O=((l=this.editorOptions.buttonTexts)==null?void 0:l.cancelKey)??`${R}CANCEL`,W=((u=this.editorOptions.buttonTexts)==null?void 0:u.saveKey)??`${R}SAVE`;e=this._translater.translate(`${R}${O}`),t=this._translater.translate(`${R}${W}`)}else e=((d=this.editorOptions.buttonTexts)==null?void 0:d.cancel)??((f=this._locales)==null?void 0:f.TEXT_CANCEL)??"Cancel",t=((p=this.editorOptions.buttonTexts)==null?void 0:p.save)??((m=this._locales)==null?void 0:m.TEXT_SAVE)??"Save";const r=this.args.compositeEditorOptions,n=((v=this.columnDef)==null?void 0:v.id)??"",s=(_=this.columnEditor)==null?void 0:_.maxLength,a=((x=this.editorOptions)==null?void 0:x.rows)??4,o=r?this.args.container:document.body;this._wrapperElm=K("div",{className:`slick-large-editor-text editor-${n}`,style:{position:r?"relative":"absolute"}}),o.appendChild(this._wrapperElm),this._textareaElm=K("textarea",{ariaLabel:((E=this.columnEditor)==null?void 0:E.ariaLabel)??`${rn(n+"")} Text Editor`,cols:((C=this.editorOptions)==null?void 0:C.cols)??40,rows:r&&a>3?3:a,placeholder:((y=this.columnEditor)==null?void 0:y.placeholder)??"",title:((b=this.columnEditor)==null?void 0:b.title)??""},this._wrapperElm);const c=K("div",{className:"editor-footer"}),h=K("span",{className:"counter"});if(this._currentLengthElm=K("span",{className:"text-length",textContent:"0"}),h.appendChild(this._currentLengthElm),s!==void 0&&(h.appendChild(K("span",{className:"separator",textContent:"/"})),h.appendChild(K("span",{className:"max-length",textContent:`${s}`}))),c.appendChild(h),!r){const R=K("button",{className:"btn btn-cancel btn-default btn-xs",textContent:e},c),O=K("button",{className:"btn btn-save btn-primary btn-xs",textContent:t},c);this._bindEventService.bind(R,"click",this.cancel.bind(this)),this._bindEventService.bind(O,"click",this.save.bind(this)),this.position((T=this.args)==null?void 0:T.position),this._textareaElm.focus(),this._textareaElm.select()}this._wrapperElm.appendChild(c),this._bindEventService.bind(this._textareaElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._textareaElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._textareaElm,"paste",this.handleOnInputChange.bind(this))}cancel(){var t;const e=this._defaultTextValue||"";this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,(t=this.args)!=null&&t.cancelChanges&&this.args.cancelChanges()}hide(){this._wrapperElm.style.display="none"}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)?this.applyInputUsabilityState():this._wrapperElm.style.display="block"}destroy(){var e,t;this._bindEventService.unbindAll(),(t=(e=this._wrapperElm)==null?void 0:e.remove)==null||t.call(e)}disable(e=!0){var r;const t=this.disabled;if(this.disabled=e,this._textareaElm&&this._wrapperElm)if(e){this._textareaElm.disabled=!0,this._wrapperElm.classList.add("disabled");const n=this.getValue();t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&n!==""&&this.reset("",!0,!0)}else this._textareaElm.disabled=!1,this._wrapperElm.classList.remove("disabled")}focus(){this.grid.focus(),this._textareaElm&&(this._textareaElm.focus(),this._textareaElm.select())}getValue(){return this._textareaElm.value}setValue(e,t=!1,r=!0){if(this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,t){this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(null,n,"system")}}applyValue(e,t){var n,s;const r=(n=this.columnDef)==null?void 0:n.field;if(r!==void 0){const a=(r==null?void 0:r.indexOf("."))>0,o=this.validate(void 0,t),c=o&&o.valid?t:"";if(a){const h=((s=this.columnEditor)==null?void 0:s.complexObjectPath)??r??"";Hr(e,h,c)}else e[r]=c}}isValueChanged(){const e=this._textareaElm.value;return!(e===""&&(this._defaultTextValue===null||this._defaultTextValue===void 0))&&e!==this._defaultTextValue}isValueTouched(){return this._isValueTouched}loadValue(e){var r;const t=(r=this.columnDef)==null?void 0:r.field;if(e&&t!==void 0){const s=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e[t];this._defaultTextValue=s||"",this._textareaElm.value=this._defaultTextValue,this._currentLengthElm.textContent=this._defaultTextValue.length,this._textareaElm.defaultValue=this._defaultTextValue,this._textareaElm.select()}}position(e){var d,f;const t=xi(this.args.container),r=this.args.container.offsetHeight,n=this.args.container.offsetWidth,s=this._wrapperElm.getBoundingClientRect().height||this.args.position.height,a=this._wrapperElm.getBoundingClientRect().width||this.args.position.width,o=document.body.offsetHeight||window.innerHeight,c=document.body.offsetWidth||window.innerWidth;let h=(t==null?void 0:t.top)??e.top??0,l=(t==null?void 0:t.left)??e.left??0;const u=((d=this.editorOptions)==null?void 0:d.position)??"auto";if(u==="left"||u==="auto"&&l+a>c){const p=((f=this.editorOptions)==null?void 0:f.marginRight)??0;l-=a-n+p}(u==="top"||u==="auto"&&h+s>o)&&(h-=s-r),this._wrapperElm.style.top=`${h}px`,this._wrapperElm.style.left=`${l}px`}reset(e,t=!0,r=!1){const n=e??this._defaultTextValue??"";this._textareaElm&&(this._defaultTextValue=n,this._textareaElm.value=n,this._currentLengthElm.textContent=n.length),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(null,s,"user",a)}}save(){const e=this.validate(),t=(e==null?void 0:e.valid)??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._textareaElm.value}validate(e,t){var n,s;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:(n=this._textareaElm)==null?void 0:n.value;return xh(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:(s=this.args)!=null&&s.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleKeyDown(e){const t=e.key;this._isValueTouched=!0,this.args.compositeEditorOptions||(t==="Enter"&&e.ctrlKey||e.ctrlKey&&e.key.toUpperCase()==="S"?(e.preventDefault(),this.save()):t==="Escape"?(e.preventDefault(),this.cancel()):t==="Tab"&&e.shiftKey?(e.preventDefault(),this.args&&this.grid&&this.grid.navigatePrev()):t==="Tab"&&(e.preventDefault(),this.args&&this.grid&&this.grid.navigateNext()))}handleOnInputChange(e){var s,a;const t=this.args.compositeEditorOptions,r=(s=this.columnEditor)==null?void 0:s.maxLength;let n=!1;if(r&&(n=this.truncateText(this._textareaElm,r)),n)this._currentLengthElm.textContent=`${r}`;else{const o=e.type==="paste"?e.clipboardData.getData("text"):e.target.value;this._currentLengthElm.textContent=`${o.length}`}if(t){const o=((a=this.gridOptions)==null?void 0:a.editorTypingDebounce)??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),o)}}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var d,f,p;const s=this.grid.getActiveCell(),a=this.args.column,o=((d=this.columnDef)==null?void 0:d.id)??"",c=this.dataContext,h=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(t.formValues,l);const u=((p=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:p.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&u&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],h.onCompositeEditorChange.notify({...s,item:c,grid:h,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}truncateText(e,t){const r=e.value+"";return r.length>t?(e.value=r.substring(0,t),!0):!1}}class $g{constructor(e,t,r=-1){var o,c,h,l,u,d,f,p,m;if(this.args=e,this.isMultipleSelect=t,this.delayOpening=r,this._isValueTouched=!1,this._isDisposingOrCallingSave=!1,this.disabled=!1,this.enableTranslateLabel=!1,this.finalCollection=[],!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},(o=this.gridOptions)!=null&&o.translater&&(this._translaterService=this.gridOptions.translater),this._locales=this.gridOptions.locales||ye.locales;const n=((c=this.columnDef)==null?void 0:c.id)??"";this.elementName=`editor-${n}`;const s=this.args.compositeEditorOptions,a={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,container:"body",filter:!1,maxHeight:275,minHeight:25,name:this.elementName,single:!0,renderOptionLabelAsHtml:((h=this.columnEditor)==null?void 0:h.enableRenderHtml)??!1,sanitizer:v=>fa(this.gridOptions,v),onClick:()=>this._isValueTouched=!0,onCheckAll:()=>this._isValueTouched=!0,onUncheckAll:()=>this._isValueTouched=!0,onClose:()=>{s?this.handleChangeOnCompositeEditor(s):(this._isDisposingOrCallingSave=!0,this.save(this.hasAutoCommitEdit))}};if(t)if(a.single=!1,a.displayTitle=!0,a.showOkButton=!0,(l=this._translaterService)!=null&&l.getCurrentLanguage()){const v=Kn(this.gridOptions);a.countSelectedText=this._translaterService.translate(`${v}X_OF_Y_SELECTED`),a.allSelectedText=this._translaterService.translate(`${v}ALL_SELECTED`),a.selectAllText=this._translaterService.translate(`${v}SELECT_ALL`),a.okButtonText=this._translaterService.translate(`${v}OK`),a.noMatchesFoundText=this._translaterService.translate(`${v}NO_MATCHES_FOUND`)}else a.countSelectedText=(u=this._locales)==null?void 0:u.TEXT_X_OF_Y_SELECTED,a.allSelectedText=(d=this._locales)==null?void 0:d.TEXT_ALL_SELECTED,a.selectAllText=(f=this._locales)==null?void 0:f.TEXT_SELECT_ALL,a.okButtonText=(p=this._locales)==null?void 0:p.TEXT_OK,a.noMatchesFoundText=(m=this._locales)==null?void 0:m.TEXT_NO_MATCHES_FOUND;this.defaultOptions=a,this.init()}get collection(){var e;return((e=this.columnEditor)==null?void 0:e.collection)??[]}get collectionOptions(){var e;return(e=this.columnEditor)==null?void 0:e.collectionOptions}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)??{}}get dataContext(){return this.args.item}get editorDomElement(){return this.editorElm}get isCompositeEditor(){var e;return!!((e=this.args)!=null&&e.compositeEditorOptions)}get customStructure(){var e,t;return(t=(e=this.columnDef)==null?void 0:e.internalColumnEditor)==null?void 0:t.customStructure}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get currentValues(){var n,s,a;const e=((n=this._msInstance)==null?void 0:n.getSelects())??[];if(this.collection.every(o=>typeof o=="number"||typeof o=="string"))return this.collection.filter(o=>e==null?void 0:e.some(c=>`${c}`===(o==null?void 0:o.toString())));const t=((s=this.collectionOptions)==null?void 0:s.separatorBetweenTextLabels)??"",r=((a=this.collectionOptions)==null?void 0:a.includePrefixSuffixToSelectedValues)??!1;return this.collection.filter(o=>e.some(c=>{var h;return`${c}`===((h=o==null?void 0:o[this.valueName])==null?void 0:h.toString())})).map(o=>{var p,m;const c=o[this.valueName];let h=o[this.labelPrefixName]||"",l=o[this.labelSuffixName]||"";const u=((p=this.columnDef)==null?void 0:p.field)??"",d=(u==null?void 0:u.indexOf("."))>0,f=((m=this.columnEditor)==null?void 0:m.serializeComplexValueFormat)??"object";return d&&typeof o=="object"&&f==="object"?o:(h=this.enableTranslateLabel&&this._translaterService&&h&&typeof h=="string"?this._translaterService.translate(h||" "):h,l=this.enableTranslateLabel&&this._translaterService&&l&&typeof l=="string"?this._translaterService.translate(l||" "):l,r?[h,c,l].filter(_=>_).join(t):c)})}get currentValue(){var n,s,a,o,c;const e=((n=this._msInstance)==null?void 0:n.getSelects())??[],t=e.length?e[0]:"",r=(s=this.columnDef)==null?void 0:s.field;if(r!==void 0){if(this.collection.every(p=>typeof p=="number"||typeof p=="string"))return ss(this.collection,p=>{var m;return((m=p==null?void 0:p.toString)==null?void 0:m.call(p))===`${t}`});const h=((a=this.collectionOptions)==null?void 0:a.separatorBetweenTextLabels)??"",l=((o=this.collectionOptions)==null?void 0:o.includePrefixSuffixToSelectedValues)??!1,u=ss(this.collection,p=>{var m;return p.hasOwnProperty(this.valueName)&&((m=p[this.valueName])==null?void 0:m.toString())===`${t}`}),d=(r==null?void 0:r.indexOf("."))>0,f=((c=this.columnEditor)==null?void 0:c.serializeComplexValueFormat)??"object";if(d&&typeof u=="object"&&f==="object")return u;if(u&&u.hasOwnProperty(this.valueName)){const p=u[this.valueName];if(l){let m=u[this.labelPrefixName]||"",v=u[this.labelSuffixName]||"";return m=this.enableTranslateLabel&&this._translaterService&&m&&typeof m=="string"?this._translaterService.translate(m||" "):m,v=this.enableTranslateLabel&&this._translaterService&&v&&typeof v=="string"?this._translaterService.translate(v||" "):v,[m,p,v].filter(x=>x).join(h)}return p}}return""}get validator(){var e,t;return((e=this.columnEditor)==null?void 0:e.validator)??((t=this.columnDef)==null?void 0:t.validator)}init(){var e,t,r,n,s,a,o;if(!this.columnDef||!this.columnDef.internalColumnEditor||!this.columnDef.internalColumnEditor.collection&&!this.columnDef.internalColumnEditor.collectionAsync)throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") inside Column Definition Editor for the MultipleSelect/SingleSelect Editor to work correctly.
      Also each option should include a value/label pair (or value/labelKey when using Locale).
      For example: { editor: { collection: [{ value: true, label: 'True' },{ value: false, label: 'False'}] } }`);if(this._collectionService=new og(this._translaterService),this.enableTranslateLabel=((e=this.columnEditor)==null?void 0:e.enableTranslateLabel)??!1,this.labelName=((t=this.customStructure)==null?void 0:t.label)??"label",this.labelPrefixName=((r=this.customStructure)==null?void 0:r.labelPrefix)??"labelPrefix",this.labelSuffixName=((n=this.customStructure)==null?void 0:n.labelSuffix)??"labelSuffix",this.optionLabel=((s=this.customStructure)==null?void 0:s.optionLabel)??"value",this.valueName=((a=this.customStructure)==null?void 0:a.value)??"value",this.enableTranslateLabel&&(!this._translaterService||typeof this._translaterService.translate!="function"))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.renderDomElement(this.collection),(this.disabled||(o=this.columnEditor)!=null&&o.collectionAsync&&Array.isArray(this.collection)&&this.collection.length===0)&&this.disable(!0)}getValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}setValue(e,t=!1,r=!0){if(this.isMultipleSelect&&Array.isArray(e)?this.loadMultipleValues(e):this.loadSingleValue(e),t){this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(n,"system")}}hide(){this._msInstance&&this._msInstance.close()}show(e){!this.isCompositeEditor&&this._msInstance?this._msInstance.open(e):this.isCompositeEditor&&this.applyInputUsabilityState()}applyValue(e,t){var a,o,c;const r=(a=this.columnDef)==null?void 0:a.field,n=(o=this.columnDef)==null?void 0:o.type;let s=t;if(r!==void 0){(n===Y.number||n===Y.integer||n===Y.boolean)&&!isNaN(parseFloat(t))&&(s=parseFloat(t)),this.isMultipleSelect&&typeof t=="string"&&t.indexOf(",")>=0&&(s=t.split(","));const h=(r==null?void 0:r.indexOf("."))>0,l=this.validate(null,s);if(s=l!=null&&l.valid?s:"",h){const u=((c=this.columnEditor)==null?void 0:c.complexObjectPath)??r??"";Hr(e,u,s)}else e[r]=s}}destroy(){var e,t;this._msInstance&&this.hasAutoCommitEdit&&this.isValueChanged()&&!this._isDisposingOrCallingSave&&!this.isCompositeEditor&&(this._isDisposingOrCallingSave=!0,this.save(!0)),this._isDisposingOrCallingSave=!0,typeof((e=this._msInstance)==null?void 0:e.destroy)=="function"&&this._msInstance.destroy(),(t=this.editorElm)==null||t.remove(),this._msInstance=void 0}loadValue(e){var n,s;const t=(n=this.columnDef)==null?void 0:n.field,r=t!==void 0&&(t==null?void 0:t.indexOf("."))>0;if(e&&t!==void 0){const a=((s=this.columnEditor)==null?void 0:s.complexObjectPath)??t,o=r?Ti(e,a):e.hasOwnProperty(t)&&e[t],c=r&&(o!=null&&o.hasOwnProperty(this.valueName))?o[this.valueName]:o;this.isMultipleSelect&&Array.isArray(c)?this.loadMultipleValues(c):this.loadSingleValue(c)}}loadMultipleValues(e){var t;if(Array.isArray(e)){this.originalValue=e.map(n=>typeof n=="number"||typeof n=="boolean"?`${n}`:n),(t=this._msInstance)==null||t.setSelects(this.originalValue);const r=this.args.compositeEditorOptions;r&&this.handleChangeOnCompositeEditor(r)}}loadSingleValue(e){var t;this.originalValue=typeof e=="number"||typeof e=="boolean"?`${e}`:e,(t=this._msInstance)==null||t.setSelects([this.originalValue])}serializeValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}changeEditorOption(e,t){var r;this.columnEditor&&(this.columnEditor.editorOptions||(this.columnEditor.editorOptions={}),this.columnEditor.editorOptions[e]=t,this.editorElmOptions={...this.editorElmOptions,[e]:t},(r=this._msInstance)==null||r.refreshOptions(this.editorElmOptions))}disable(e=!0){const t=this.disabled;if(this.disabled=e,this._msInstance)if(e){this._msInstance.disable();const r=this.getValue(),n=Array.isArray(r)&&this.isMultipleSelect?(r==null?void 0:r[0])==="":r==="";t!==e&&this.isCompositeEditor&&!n&&this.reset("",!0,!0)}else this._msInstance.enable()}focus(){var e;this.grid.focus(),(e=this._msInstance)==null||e.focus()}isValueChanged(){var r;const e=(r=this._msInstance)==null?void 0:r.getSelects();if(this.isMultipleSelect)return!qn(e,this.originalValue);const t=Array.isArray(e)&&e.length>0?e[0]:void 0;return t!==void 0&&t!==this.originalValue}isValueTouched(){return this._isValueTouched}reset(e,t=!0,r=!1){const n=e??this.originalValue;if(this._msInstance){this.originalValue=this.isMultipleSelect?n!==void 0?[n]:[]:n;const a=this.originalValue===void 0?[]:[this.originalValue];this._msInstance.setSelects(a)}this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(s,"user",a)}}save(e=!1){const t=this.validate(),r=(t==null?void 0:t.valid)??!1;(!this._isDisposingOrCallingSave||e)&&this.hasAutoCommitEdit&&r?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}validate(e,t){var a,o;const r=this.isCompositeEditor?!1:(a=this.columnEditor)==null?void 0:a.required,n=t!==void 0?t:(o=this._msInstance)==null?void 0:o.getSelects(),s=this.columnEditor&&this.columnEditor.errorMessage;if(this.isCompositeEditor&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(this.validator){const c=t!==void 0?t:this.isMultipleSelect?this.currentValues:this.currentValue;return this.validator(c,this.args)}return r&&(n===""||Array.isArray(n)&&n.length===0)?{valid:!1,msg:s||ye.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}filterCollection(e){var r;let t=e;if(this.columnEditor&&this.columnEditor.collectionFilterBy){const n=this.columnEditor.collectionFilterBy,s=((r=this.columnEditor.collectionOptions)==null?void 0:r.filterResultAfterEachPass)??null;t=this._collectionService.filterCollection(t,n,s)}return t}sortCollection(e){let t=e;if(this.columnDef&&this.columnEditor&&this.columnEditor.collectionSortBy){const r=this.columnEditor.collectionSortBy;t=this._collectionService.sortCollection(this.columnDef,t,r,this.enableTranslateLabel)}return t}renderDomElement(e){var s,a,o,c,h;if(!Array.isArray(e)&&((s=this.collectionOptions)!=null&&s.collectionInsideObjectProperty)){const l=this.collectionOptions.collectionInsideObjectProperty;e=Ti(e,l)}if(!Array.isArray(e))throw new Error('The "collection" passed to the Select Editor is not a valid array.');let t=[];if(e.length>0&&(t=[...e]),(a=this.collectionOptions)!=null&&a.addBlankEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==""&&(t.unshift(this.createBlankEntry()),this.collection.unshift(this.createBlankEntry())),(o=this.collectionOptions)!=null&&o.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&(t.unshift(this.collectionOptions.addCustomFirstEntry),this.collection.unshift(this.collectionOptions.addCustomFirstEntry)),(c=this.collectionOptions)!=null&&c.addCustomLastEntry&&Array.isArray(t)&&t.length>0){const l=t.length-1;t[l][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry)}let r=t;if(r=this.filterCollection(r),r=this.sortCollection(r),(h=this.columnEditor)!=null&&h.collectionOverride){const l={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){const{formValues:u,modalType:d}=this.args.compositeEditorOptions;l.compositeEditorOptions={formValues:u,modalType:d}}r=this.columnEditor.collectionOverride(r,l)}this.finalCollection=r;const n=tg("editor",r,this.columnDef,this.grid,this.isMultipleSelect,this._translaterService);this.createDomElement(n.selectElement,n.dataCollection)}createBlankEntry(){const e={[this.labelName]:"",[this.valueName]:""};return this.labelPrefixName&&(e[this.labelPrefixName]=""),this.labelSuffixName&&(e[this.labelSuffixName]=""),e}createDomElement(e,t){var a,o,c;const r=this.args.container;e&&r&&typeof r.appendChild=="function"&&(Rt(r),r.appendChild(e));const n=((a=this.columnEditor)==null?void 0:a.placeholder)??"";this.defaultOptions.placeholder=n||"";const s=((c=(o=this.columnDef)==null?void 0:o.internalColumnEditor)==null?void 0:c.editorOptions)??{};this.editorElmOptions={...this.defaultOptions,...s,data:t},this._msInstance=uo(e,this.editorElmOptions),this.editorElm=this._msInstance.getParentElement(),this.isCompositeEditor||(this.delayOpening>=0?setTimeout(()=>this.show()):this.show())}handleChangeOnCompositeEditor(e,t="user",r=!1){var u,d,f;const n=this.grid.getActiveCell(),s=this.args.column,a=((u=this.columnDef)==null?void 0:u.id)??"",o=this.dataContext,c=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(e.formValues,h);const l=((f=(d=this.gridOptions)==null?void 0:d.compositeEditorOptions)==null?void 0:f.excludeDisabledFieldFormValues)??!1;(r||this.disabled&&l&&e.formValues.hasOwnProperty(a))&&delete e.formValues[a],c.onCompositeEditorChange.notify({...n,item:o,grid:c,column:s,formValues:e.formValues,editors:e.editors,triggeredBy:t},new Yt)}}class xC extends $g{constructor(e,t=0){super(e,!0,t),this.args=e,this.delayOpening=t}}class wC extends $g{constructor(e,t=0){super(e,!1,t),this.args=e,this.delayOpening=t}}class CC{constructor(e){if(this.args=e,this._defaultValue=0,this._isValueTouched=!1,this._sliderNumberElm=null,this.disabled=!1,!e)throw new Error("[Slickgrid-Universal] Something is wrong with this grid, an Editor must always have valid arguments.");this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new Xi,this.init()}get columnDef(){return this.args.column}get columnEditor(){var e;return((e=this.columnDef)==null?void 0:e.internalColumnEditor)??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._editorElm}get editorInputDomElement(){return this._inputElm}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get sliderOptions(){return this._sliderOptions}get validator(){var e;return this.columnEditor.validator??((e=this.columnDef)==null?void 0:e.validator)}init(){var e;if(this._cellContainerElm=(e=this.args)==null?void 0:e.container,this._cellContainerElm&&this.columnDef){const t=this.args.compositeEditorOptions;this._editorElm=this.buildDomElement(),t||this.focus(),this._cellContainerElm.appendChild(this._editorElm),this._bindEventService.bind(this._sliderTrackElm,["click","mouseup"],this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._inputElm,["change","mouseup","touchend"],this.handleChangeEvent.bind(this)),this._bindEventService.bind(this._inputElm,["input","change"],this.handleChangeSliderNumber.bind(this))}}cancel(){this._inputElm&&(this._inputElm.value=`${this._originalValue}`),this.args.cancelChanges()}destroy(){var e,t,r;this._bindEventService.unbindAll(),(e=this._inputElm)==null||e.remove(),(t=this._editorElm)==null||t.remove(),(r=this._sliderTrackElm)==null||r.remove()}disable(e=!0){var r;const t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;const n=this.getValue();t!==e&&((r=this.args)!=null&&r.compositeEditorOptions)&&n!==""&&this.reset(0,!0,!0)}else this._inputElm.disabled=!1}focus(){var e;this.grid.focus(),(e=this._inputElm)==null||e.focus()}show(){var t;!!((t=this.args)!=null&&t.compositeEditorOptions)&&this.applyInputUsabilityState()}getValue(){var e;return((e=this._inputElm)==null?void 0:e.value)??""}setValue(e,t=!1,r=!0){if(this._inputElm&&(this._inputElm.value=`${e}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${e}`),t){this.applyValue(this.args.item,this.serializeValue());const n=this.args.compositeEditorOptions;n&&r&&this.handleChangeOnCompositeEditor(null,n,"system")}}applyValue(e,t){var n;const r=((n=this.columnDef)==null?void 0:n.field)??"";if(r!==void 0){const s=(r==null?void 0:r.indexOf("."))>0,a=this.validate(void 0,t),o=a&&a.valid?t:"";if(s){const c=this.columnEditor.complexObjectPath??r??"";Hr(e,c,o)}else e&&(e[r]=o)}}isValueChanged(){var t;const e=((t=this._inputElm)==null?void 0:t.value)??"";return!(e===""&&this._originalValue===void 0)&&+e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){var r;const t=((r=this.columnDef)==null?void 0:r.field)??"";if(e&&t!==void 0){let s=(t==null?void 0:t.indexOf("."))>0?Ti(e,t):e.hasOwnProperty(t)?e[t]:this._defaultValue;(s===""||s===null||s===void 0)&&(s=this._defaultValue),this._originalValue=+s,this._inputElm&&(this._inputElm.value=`${s}`,this._inputElm.title=`${s}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${s}`)}this.updateTrackFilledColorWhenEnabled()}reset(e,t=!0,r=!1){const n=e??this._originalValue??0;this._inputElm&&(this._inputElm.value=`${n}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${n}`),this._isValueTouched=!1;const s=this.args.compositeEditorOptions;if(s&&t){const a=!r;this.handleChangeOnCompositeEditor(null,s,"user",a)}}save(){const e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){var t;const e=((t=this._inputElm)==null?void 0:t.value)??"";return e!==""?parseInt(e,10):this._originalValue}validate(e,t){var n,s;if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};const r=t!==void 0?t:(n=this._inputElm)==null?void 0:n.value;return fC(r,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,required:(s=this.args)!=null&&s.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}buildDomElement(){var h,l,u;const e=((h=this.columnDef)==null?void 0:h.id)??"",t=this.columnEditor.title??"",r=+(this.columnEditor.minValue??ye.SLIDER_DEFAULT_MIN_VALUE),n=+(this.columnEditor.maxValue??ye.SLIDER_DEFAULT_MAX_VALUE),s=+(this.columnEditor.valueStep??ye.SLIDER_DEFAULT_STEP),a=((l=this.columnEditor.editorOptions)==null?void 0:l.sliderStartValue)??r;this._defaultValue=+a,this._sliderTrackElm=K("div",{className:"slider-track"}),this._inputElm=K("input",{type:"range",title:t,defaultValue:`${a}`,value:`${a}`,min:`${r}`,max:`${n}`,step:`${this.columnEditor.valueStep??ye.SLIDER_DEFAULT_STEP}`,ariaLabel:this.columnEditor.ariaLabel??`${rn(e+"")} Slider Editor`,className:`slider-editor-input editor-${e}`});const o=K("div",{className:"slider-container slider-editor"}),c=K("div",{className:"slider-input-container slider-editor"});if(c.appendChild(this._sliderTrackElm),c.appendChild(this._inputElm),o.appendChild(c),!((u=this.columnEditor.editorOptions)!=null&&u.hideSliderNumber)){o.classList.add("input-group");const d=K("div",{className:"input-group-addon input-group-append slider-value"});this._sliderNumberElm=K("span",{className:"input-group-text",textContent:`${a}`}),d.appendChild(this._sliderNumberElm),o.appendChild(d)}return this._sliderOptions={minValue:r,maxValue:n,step:s},o}applyInputUsabilityState(){const e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeEvent(e){this._isValueTouched=!0;const t=this.args.compositeEditorOptions;t?this.handleChangeOnCompositeEditor(e,t):this.save()}handleChangeSliderNumber(e){var r,n,s;const t=((r=e.target)==null?void 0:r.value)??"";t!==""&&(!((n=this.columnEditor.editorOptions)!=null&&n.hideSliderNumber)&&this._sliderNumberElm&&(this._sliderNumberElm.textContent=t),this._inputElm.title=t,(s=this.args)!=null&&s.compositeEditorOptions||this.grid.onMouseEnter.notify({column:this.columnDef,grid:this.grid},new Yt(e))),this.updateTrackFilledColorWhenEnabled()}handleChangeOnCompositeEditor(e,t,r="user",n=!1){var d,f,p;const s=this.grid.getActiveCell(),a=this.args.column,o=((d=this.columnDef)==null?void 0:d.id)??"",c=this.dataContext,h=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(t.formValues,l);const u=((p=(f=this.gridOptions)==null?void 0:f.compositeEditorOptions)==null?void 0:p.excludeDisabledFieldFormValues)??!1;(n||this.disabled&&u&&t.formValues.hasOwnProperty(o))&&delete t.formValues[o],h.onCompositeEditorChange.notify({...s,item:c,grid:h,column:a,formValues:t.formValues,editors:t.editors,triggeredBy:r},new Yt(e))}sliderTrackClicked(e){e.preventDefault();const t=e.offsetX,r=this._sliderTrackElm.offsetWidth,n=(t+0)*100/r;this._inputElm&&(this._inputElm.value=`${n}`,this._inputElm.dispatchEvent(new Event("change")))}updateTrackFilledColorWhenEnabled(){var e,t,r;if((e=this.columnEditor.editorOptions)!=null&&e.enableSliderTrackColoring&&this._inputElm){const s=(+this.getValue()-+this._inputElm.min)/(((t=this.sliderOptions)==null?void 0:t.maxValue)??0-+this._inputElm.min)*100,a="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,((r=this.columnEditor.editorOptions)==null?void 0:r.sliderTrackFilledColor)??"var(--slick-slider-filter-thumb-color, #86bff8)").replace(/%p1/g,"0%").replace(/%p2/g,`${s}%`);this._sliderTrackElm.style.background=a,this._sliderOptions.sliderTrackBackground=a}}}const yC={autocompleter:hC,checkbox:uC,date:dC,dualInput:pC,float:gC,integer:_C,longText:EC,multipleSelect:xC,password:vC,singleSelect:wC,slider:CC,text:wh},SC=(i,e,t,r,n)=>{var h;const s=r&&r.params||{},a=s.propertyNames,o=(s==null?void 0:s.includeTitle)??!0;let c=s.dataContextProperty;if(c||(c=((h=r==null?void 0:r.field)==null?void 0:h.split(".")[0])||""),!a||!Array.isArray(a)||!c)throw new Error(`Formatters.arrayObjectToCsv requires you to pass an array of "propertyNames" (declared in "params") that you want to pull the data from.
      For example, if we have an array of user objects that have the property of firstName & lastName then we need to pass in your column definition:: { params: { propertyNames: ['firtName'] }}.
      Optionally, you can also pass the "dataContextProperty" if you wish to run this on another completely different field of the dataContext object.`);if(n[c]&&Array.isArray(n[c])&&Array.isArray(n[c])&&n[c].length>0){const l=[];n[c].forEach(f=>{const p=[];a.forEach(m=>{p.push(f[m])}),l.push(p.join(" "))});const u=l.join(", "),d=K("span",{textContent:u});return o&&(d.title=u),d}return t},$c=(i,e,t)=>{if(Array.isArray(t)&&t.length>0){const r=t.join(", ");return K("span",{title:r,textContent:r})}return t},bC=(i,e,t)=>{let r=!1;const n=ti(t);return n&&(t=+t),(t===!0||n&&+t>0||typeof t=="string"&&t.length>0&&t.toLowerCase()!=="false"&&t!=="0")&&(r=!0),r?K("i",{className:"mdi mdi-18px mdi-check checkmark-icon",ariaHidden:"true"}):""},TC=(i,e,t)=>{let r=!1;const n=ti(t);return n&&(t=+t),(t===!0||n&&+t>0||typeof t=="string"&&t.length>0&&t.toLowerCase()!=="false"&&t!=="0")&&(r=!0),r?K("i",{className:"fa fa-check checkmark-icon",ariaHidden:"true"}):""},AC=(i,e,t,r,n,s)=>{if(!t||!r||!r.internalColumnEditor||!r.internalColumnEditor.collection||!r.internalColumnEditor.collection.length)return t;const{internalColumnEditor:a,internalColumnEditor:{collection:o}}=r,c=a.customStructure?a.customStructure.label:"label",h=a.customStructure?a.customStructure.value:"value";return Array.isArray(t)?o.every(l=>typeof l=="string")?$c(i,e,t.map(l=>ss(o,u=>u===l))):$c(i,e,t.map(l=>ss(o,u=>u[h]===l)[c])):ss(o,l=>l[h]===t)[c]||""},kC=(i,e,t,r,n,s)=>{if(!t||!r||!r.params||!r.params.collection||!r.params.collection.length)return t;const{params:a,params:{collection:o}}=r,c=a.customStructure?a.customStructure.label:"label",h=a.customStructure?a.customStructure.value:"value";return Array.isArray(t)?$c(i,e,t.map(l=>ss(o,u=>u[h]===l)[c])):ss(o,l=>l[h]===t)[c]||""},gp=(i,e,t,r,n)=>{var o;if(!r)return"";const s=r.params||{},a=(s==null?void 0:s.complexField)??(s==null?void 0:s.complexFieldLabel)??r.field;if(!a)throw new Error(`For the Formatters.complexObject to work properly, you need to tell it which property of the complex object to use.
      There are 3 ways to provide it:
      1- via the generic "params" with a "complexField" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', params: { complexField: 'user.firstName' } }]
      2- via the generic "params" with a "complexField" and a "labelKey" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', labelKey: 'firstName', params: { complexField: 'user' } }]
      3- via the field name that includes a dot notation, example: this.columnDefs = [{ id: 'user', field: 'user.firstName'}] `);if(r.labelKey&&n.hasOwnProperty(a))return(o=n[a])==null?void 0:o[r.labelKey];if(typeof a=="string"&&a.indexOf(".")>0){let c=a.split(".").reduce((h,l)=>h!=null&&h.hasOwnProperty(l)?h[l]:"",n);return(c==null||typeof c=="object"&&Object.entries(c).length===0&&!(c instanceof Date))&&(c=""),c}return t},OC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,numberPrefix:c,numberSuffix:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(r,s,"decimal","cell");return ti(t)?Ii(t,a,o,d,c,h,l,u):t},IC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"currency","cell");return ti(t)?Ii(t,a,o,l,"$","",c,h):t},RC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"currency","cell");if(ti(t)){const u=t>=0?"green":"red",d=Ii(t,a,o,l,"$","",c,h),f=K("span",{ariaHidden:"true",textContent:d});return f.style.color=u,f}return t},DC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"currency","cell");if(ti(t)){const u=t>=0?"green":"red",d=Ii(t,a,o,l,"$","",c,h),f=K("span",{ariaHidden:"true",textContent:d});return f.style.color=u,f.style.fontWeight="bold",f}return t},FC=(i,e,t,r,n,s)=>{const{currencyPrefix:a,currencySuffix:o,minDecimal:c,maxDecimal:h,numberPrefix:l,numberSuffix:u,decimalSeparator:d,thousandSeparator:f,wrapNegativeNumber:p}=yi(r,s,"decimal","cell");if(ti(t)){const m=Ii(t,c,h,p,a,o,d,f);return`${l}${m}${u}`}return t},PC=(i,e,t,r,n,s)=>{const a=r&&r.params||{},o=(s==null?void 0:s.getOptions())??{};let c=a.hyperlinkText?a.hyperlinkText:t;c=fa(o,c);let h=a.hyperlinkUrl?a.hyperlinkUrl:t;h=fa(o,h);const l=h.match(/^(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/i);if(l&&Array.isArray(l)&&l.length>0){const u=l[0];return K("a",{href:u,textContent:c})}return t},NC=(i,e,t,r)=>{const s=((r==null?void 0:r.params)||{}).cssClass;if(!s)throw new Error('[Slickgrid-Universal] When using `Formatters.iconBoolean`, you must provide You must provide the "cssClass", e.g.: { formatter: Formatters.iconBoolean, params: { cssClass: "fa fa-check" }}');let a=!1;const o=!isNaN(t);return(t===!0||o&&parseFloat(t)>0||!o&&typeof t=="string"&&t.toLowerCase()!=="false"&&t!=="0")&&(a=!0),a?K("i",{className:s,ariaHidden:"true"}):""},MC=(i,e,t,r)=>{const n=(r==null?void 0:r.params)??{},s=n.iconCssClass||n.icon||n.formatterIcon;if((n.icon||n.formatterIcon)&&console.warn('[Slickgrid-Universal] deprecated params.icon or params.formatterIcon are deprecated when using `Formatters.icon` in favor of params.iconCssClass. (e.g.: `{ formatter: Formatters.icon, params: { iconCssClass: "fa fa-search" }}`'),!s)throw new Error('[Slickgrid-Universal] When using `Formatters.icon`, you must provide the "iconCssClass" via the generic "params". (e.g.: `{ formatter: Formatters.icon, params: { iconCssClass: "fa fa-search" }}`');return K("i",{className:s,ariaHidden:"true"})},LC=(i,e,t,r,n,s)=>{const o=(r.params||{}).mask;if(!o)throw new Error(`You must provide a "mask" via the generic "params" options (e.g.: { formatter: Formatters.mask, params: { mask: '000-000' }}`);if(t){let c=0;const h=t.toString(),l=s.getOptions()||{},u=l!=null&&l.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return u.textContent=o.replace(/[09A]/gi,()=>h[c++]||""),u}return t},BC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"percent","cell");if(ti(t)){const u=t*100;return Ii(u,a,o,l,"","%",c,h)}return t},HC=(i,e,t)=>{if(!ti(t))return"";let r="",n=parseFloat(t);return n>100&&(n=100),n<30?r="red":n<70?r="silver":r="green",K("span",{className:"percent-complete-bar",title:`${n}%`,style:{background:r,width:`${n}%`}})},VC=(i,e,t)=>{if(!ti(t))return"";let r="",n=parseFloat(t);return n>100&&(n=100),n<30?r="red":n<70?r="silver":r="green",K("div",{className:"percent-complete-bar-with-text",title:`${n}%`,textContent:`${n}%`,style:{background:r,width:`${n}%`}})},UC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"percent","cell");if(ti(t)){const u=t<50?"red":"green",d=Ii(t,a,o,l,"","%",c,h),f=t>100?"100%":d;return K("span",{textContent:f,style:{color:u}})}return t},WC=(i,e,t,r,n,s)=>{const{minDecimal:a,maxDecimal:o,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:l}=yi(r,s,"percent","cell");return ti(t)?Ii(t,a,o,l,"","%",c,h):t},zC=(i,e,t)=>{if(!ti(t))return"";let r="",n=parseFloat(t);n>100&&(n=100),n<30?r="danger":n<70?r="warning":r="success";const s=K("div",{className:"progress"});return s.appendChild(K("div",{className:`progress-bar progress-bar-${r} bg-${r}`,role:"progressbar",ariaValueNow:String(n),ariaValueMin:"0",ariaValueMax:"100",textContent:`${n}%`,style:{minWidth:"2em",width:`${n}%`}})),s},GC=(i,e,t,r,n,s)=>{const o=((s==null?void 0:s.getOptions())??{}).translater||r&&r.params&&r.params.translater;if(!o||typeof o.translate!="function")throw new Error(`"Formatters.translate" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).
    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }`);return t!=null&&typeof t!="string"&&(t=t+""),t?o.translate(t):""},$C=(i,e,t,r,n,s)=>{var T,R;const a=s.getOptions(),o=a==null?void 0:a.treeDataOptions,c=(o==null?void 0:o.collapsedPropName)??ye.treeDataProperties.COLLAPSED_PROP,h=(o==null?void 0:o.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP,l=(o==null?void 0:o.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP,u=(o==null?void 0:o.exportIndentMarginLeft)??5,d=(o==null?void 0:o.exportIndentationLeadingChar)??".",f=(o==null?void 0:o.exportIndentationLeadingSpaceCount)??3,p=((T=a==null?void 0:a.excelExportOptions)==null?void 0:T.groupCollapsedSymbol)??"",m=((R=a==null?void 0:a.excelExportOptions)==null?void 0:R.groupExpandedSymbol)??"";let v=t;if(v=tl(r,n,t),v==null||n===void 0)return"";if(!n.hasOwnProperty(l))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const _=(n==null?void 0:n[l])??0;let x="",E=0;n[h]?(x=n!=null&&n[c]?p:m,E=_===0?0:u*_):E=u*(_===0?0:_+1);const C=Ju(E);return o!=null&&o.titleFormatter&&(v=Eh(o.titleFormatter,i,e,r,n,s)),v=`${_===0&&x?"":_===0?`${d}${Ju(f)}`:d}${C}${x} ${v}`,Rn(v)},YC=(i,e,t,r,n,s)=>{const a=s.getOptions(),o=a==null?void 0:a.treeDataOptions,c=(o==null?void 0:o.indentMarginLeft)??15,h=(o==null?void 0:o.collapsedPropName)??ye.treeDataProperties.COLLAPSED_PROP,l=(o==null?void 0:o.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP,u=(o==null?void 0:o.levelPropName)??ye.treeDataProperties.TREE_LEVEL_PROP;let d=t;if(d=tl(r,n,t),d==null||n===void 0)return"";if(!n.hasOwnProperty(u))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');const f=(n==null?void 0:n[u])??0,p=document.createElement("span");p.style.display="inline-block",p.style.width=`${c*f}px`;const m=`slick-tree-level-${f}`;let v="";n[l]&&(v=n!=null&&n[h]?"collapsed":"expanded"),o!=null&&o.titleFormatter&&(d=Eh(o.titleFormatter,i,e,r,n,s));const _=`slick-group-toggle ${v}`.trim(),x=K("div",{className:_,ariaExpanded:String(v==="expanded")}),E=K("span",{className:"slick-tree-title"});s.applyHtmlCode(E,d),E.setAttribute("level",f);const C=a!=null&&a.preventDocumentFragmentUsage?document.createElement("span"):new DocumentFragment;return C.appendChild(p),C.appendChild(x),C.appendChild(E),{addClasses:m,html:C}},XC=(i,e,t,r,n,s)=>{var u;const a=s.getOptions(),o=((u=a==null?void 0:a.treeDataOptions)==null?void 0:u.hasChildrenPropName)??ye.treeDataProperties.HAS_CHILDREN_PROP,{groupTotalsFormatter:c,treeTotalsFormatter:h,params:l}=r;if(!c&&!h)throw new Error('[Slickgrid-Universal] When using Formatters.treeParseTotals, you must provide a total formatter via "groupTotalsFormatter" or "treeTotalsFormatter".');if(n[o]&&(n!=null&&n.__treeTotals)&&(c||h))return(h??c)(n==null?void 0:n.__treeTotals,r,s);if(l.formatters){let d=t;for(const f of l.formatters)!n[o]&&!(n!=null&&n.__treeTotals)&&typeof f=="function"&&(d=f(i,e,d,r,n,s)||t);return d}return t},qC=(i,e,t,r,n,s)=>{const o=((s==null?void 0:s.getOptions())??{}).translater||r&&r.params&&r.params.translater;if(!o||typeof o.translate!="function")throw new Error(`"Formatters.translateBoolean" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).
    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }`);return t!=null&&typeof t!="string"&&(t=t+""),t?o.translate(t.toUpperCase()):""},KC={arrayObjectToCsv:SC,arrayToCsv:$c,checkmark:TC,checkmarkMaterial:bC,complex:gp,complexObject:gp,collection:kC,collectionEditor:AC,currency:FC,dateIso:pi(Y.dateIso,"-"),dateTimeIso:pi(Y.dateTimeIso,"-"),dateTimeShortIso:pi(Y.dateTimeShortIso,"-"),dateTimeIsoAmPm:pi(Y.dateTimeIsoAmPm,"-"),dateTimeIsoAM_PM:pi(Y.dateTimeIsoAM_PM,"-"),dateEuro:pi(Y.dateEuro,"/"),dateEuroShort:pi(Y.dateEuroShort,"/"),dateTimeEuro:pi(Y.dateTimeEuro,"/"),dateTimeEuroShort:pi(Y.dateTimeEuroShort,"/"),dateTimeShortEuro:pi(Y.dateTimeShortEuro,"/"),dateTimeEuroAmPm:pi(Y.dateTimeEuroAmPm,"/"),dateTimeEuroAM_PM:pi(Y.dateTimeEuroAM_PM,"/"),dateTimeEuroShortAmPm:pi(Y.dateTimeEuroShortAmPm,"/"),dateTimeEuroShortAM_PM:pi(Y.dateTimeEuroShortAM_PM,"/"),dateUs:pi(Y.dateUs,"/"),dateTimeUs:pi(Y.dateTimeUs,"/"),dateTimeShortUs:pi(Y.dateTimeShortUs,"/"),dateTimeUsAmPm:pi(Y.dateTimeUsAmPm,"/"),dateTimeUsAM_PM:pi(Y.dateTimeUsAM_PM,"/"),dateTimeUsShort:pi(Y.dateTimeUsShort,"/"),dateTimeUsShortAmPm:pi(Y.dateTimeUsShortAmPm,"/"),dateTimeUsShortAM_PM:pi(Y.dateTimeUsShortAM_PM,"/"),dateUsShort:pi(Y.dateUsShort,"/"),dateUtc:pi(Y.dateUtc,"-"),decimal:OC,dollar:IC,dollarColored:RC,dollarColoredBold:DC,hyperlink:PC,icon:MC,iconBoolean:NC,mask:LC,multiple:Oc,percent:BC,percentComplete:UC,percentCompleteBar:HC,percentCompleteBarWithText:VC,percentSymbol:WC,progressBar:zC,translate:GC,translateBoolean:qC,tree:YC,treeParseTotals:XC,treeExport:$C},jC=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"","",l,u);return`${a}${p}${o}`}return""},QC=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"$","",l,u);return`${a}${p}${o}`}return""},ZC=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const p=n>=0?"green":"red",m=Ii(n,c,h,d,"$","",l,u);return K("span",{style:{color:p},textContent:`${a}${m}${o}`})}return""},JC=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const p=n>=0?"green":"red",m=Ii(n,c,h,d,"$","",l,u);return K("span",{style:{color:p,fontWeight:"bold"},textContent:`${a}${m}${o}`})}return""},ey=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"$","",l,u);return K("span",{style:{fontWeight:"bold"},textContent:`${a}${p}${o}`})}return""},ty=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){const p=n>=0?"green":"red",m=Ii(n,c,h,d,"","",l,u);return K("span",{style:{color:p},textContent:`${a}${m}${o}`})}return""},iy=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.sum)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"","",l,u);return K("span",{style:{fontWeight:"bold"},textContent:`${a}${p}${o}`})}return""},ry=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.min)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"","",l,u);return`${a}${p}${o}`}return""},ny=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.max)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"","",l,u);return`${a}${p}${o}`}return""},sy=(i,e,t)=>{var f;const r=e.field??"";let n=(f=i.avg)==null?void 0:f[r];const s=e==null?void 0:e.params;let a=(s==null?void 0:s.groupFormatterPrefix)||"";const o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"percent","group");if(n!==null&&!isNaN(+n)){if(n<0)if(n=Math.abs(n),!d)a+="-";else{if(isNaN(c)&&isNaN(h)){const p=ns(Math.round(n),u);return`${a}(${p}%)${o}`}return`${a}(${Ps(n,c,h,l,u)}%)${o}`}if(isNaN(c)&&isNaN(h)){const p=ns(Math.round(n),u);return`${a}${p}%${o}`}return`${a}${Ps(n,c,h,l,u)}%${o}`}return""},ay=(i,e,t)=>{var f;const r=e.field??"",n=(f=i.avg)==null?void 0:f[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const p=Ii(n,c,h,d,"$","",l,u);return`${a}${p}${o}`}return""},oy=(i,e,t)=>{var m;const r=e.field??"",n=(m=i.avg)==null?void 0:m[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",c=(s==null?void 0:s.groupFormatterCurrencyPrefix)||"",h=(s==null?void 0:s.groupFormatterCurrencySuffix)||"",{minDecimal:l,maxDecimal:u,decimalSeparator:d,thousandSeparator:f,wrapNegativeNumber:p}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const v=Ii(n,l,u,p,c,h,d,f);return`${a}${v}${o}`}return""},ly=(i,e,t)=>{var f;const r=e.field??"";let n=(f=i.avg)==null?void 0:f[r];const s=e==null?void 0:e.params;let a=(s==null?void 0:s.groupFormatterPrefix)||"";const o=(s==null?void 0:s.groupFormatterSuffix)||"",{minDecimal:c,maxDecimal:h,decimalSeparator:l,thousandSeparator:u,wrapNegativeNumber:d}=yi(e,t,"regular","group");if(n!==null&&!isNaN(+n)){if(n<0)if(n=Math.abs(n),!d)a+="-";else{if(isNaN(c)&&isNaN(h)){const p=ns(Math.round(n),u);return`${a}(${p})${o}`}return`${a}(${Ps(n,c,h,l,u)})${o}`}if(isNaN(c)&&isNaN(h)){const p=ns(Math.round(n),u);return`${a}${p}${o}`}return`${a}${Ps(n,c,h,l,u)}${o}`}return""},cy=(i,e,t)=>{var m;const r=e.field??"",n=(m=i.sum)==null?void 0:m[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",c=(s==null?void 0:s.groupFormatterCurrencyPrefix)||"",h=(s==null?void 0:s.groupFormatterCurrencySuffix)||"",{minDecimal:l,maxDecimal:u,decimalSeparator:d,thousandSeparator:f,wrapNegativeNumber:p}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const v=Ii(n,l,u,p,c,h,d,f);return`${a}${v}${o}`}return""},hy=(i,e,t)=>{var m;const r=e.field??"",n=(m=i.sum)==null?void 0:m[r],s=e==null?void 0:e.params,a=(s==null?void 0:s.groupFormatterPrefix)||"",o=(s==null?void 0:s.groupFormatterSuffix)||"",c=(s==null?void 0:s.groupFormatterCurrencyPrefix)||"",h=(s==null?void 0:s.groupFormatterCurrencySuffix)||"",{minDecimal:l,maxDecimal:u,decimalSeparator:d,thousandSeparator:f,wrapNegativeNumber:p}=yi(e,t,"currency","group");if(n!==null&&!isNaN(+n)){const v=n>=0?"green":"red",_=Ii(n,l,u,p,c,h,d,f);return K("span",{style:{color:v},textContent:`${a}${_}${o}`})}return""},uy={avgTotals:ly,avgTotalsCurrency:oy,avgTotalsDollar:ay,avgTotalsPercentage:sy,maxTotals:ny,minTotals:ry,sumTotals:jC,sumTotalsBold:iy,sumTotalsColored:ty,sumTotalsCurrency:cy,sumTotalsCurrencyColored:hy,sumTotalsDollar:QC,sumTotalsDollarBold:ey,sumTotalsDollarColored:ZC,sumTotalsDollarColoredBold:JC};class dy{constructor(){this.options=Wg}}const fy={...eE,...tE,...uE,...TE,...yE,deepAssign:so};class py{constructor(){this._isPreviouslyShown=!1,this._warningLeftElement=null,this._warningRightElement=null}get gridOptions(){var e;return((e=this._grid)==null?void 0:e.getOptions())??{}}init(e,t){this._grid=e,this._translaterService=t.get("TranslaterService")}dispose(){var e,t;(e=this._warningLeftElement)==null||e.remove(),(t=this._warningRightElement)==null||t.remove(),this._warningLeftElement=null,this._warningRightElement=null}showEmptyDataMessage(e=!0,t){var _,x,E,C;if(!this._grid||!this.gridOptions||this._isPreviouslyShown===e)return!1;this._isPreviouslyShown=e;const r=this._grid.getUID(),s={message:"No data to display.",...this.gridOptions.emptyDataWarning,...t},a=(s==null?void 0:s.className)??"slick-empty-data-warning";this._warningLeftElement=document.querySelector(`.${r} .${a}`);const o=document.querySelector(`.${r} .grid-canvas.grid-canvas-left`),c=document.querySelector(`.${r} .grid-canvas.grid-canvas-right`),h=s.leftViewportMarginLeft??0,l=s.rightViewportMarginLeft??0,u=s.frozenLeftViewportMarginLeft??0,d=s.frozenRightViewportMarginLeft??0,f=((_=this.gridOptions)==null?void 0:_.frozenColumn)!==void 0&&this.gridOptions.frozenColumn>=0,p=typeof h=="string"?h:`${h}px`,m=typeof l=="string"?l:`${l}px`;if(this.gridOptions.autoHeight){const y=document.querySelector(`.${r} .slick-pane.slick-pane-top.slick-pane-left`);if(y&&y.style&&o&&o.style){const b=parseInt(y.style.height,10)||0,T=((x=this.gridOptions)==null?void 0:x.rowHeight)??0,R=this.gridOptions.enableFiltering?((E=this.gridOptions)==null?void 0:E.headerRowHeight)??0:0,O=this.gridOptions.createPreHeaderPanel?((C=this.gridOptions)==null?void 0:C.preHeaderPanelHeight)??0:0;if(e){let W=b!==null&&b<100?b:100;W+=R+O,y.style.minHeight=`${W}px`,o.style.minHeight=`${T}px`}}}let v=s.message;if(this.gridOptions.enableTranslate&&this._translaterService&&(s!=null&&s.messageKey)&&(v=this._translaterService.translate(s.messageKey)),!this._warningLeftElement&&o&&c&&(this._warningLeftElement=document.createElement("div"),this._warningLeftElement.classList.add(...gi(a)),this._warningLeftElement.classList.add("left"),this._grid.applyHtmlCode(this._warningLeftElement,v),this._warningRightElement=this._warningLeftElement.cloneNode(!0),this._warningRightElement.classList.add("right"),c.appendChild(this._warningRightElement),o.appendChild(this._warningLeftElement)),this._warningLeftElement){let y=e?"block":"none";f&&e&&(y=s.hideFrozenLeftWarning?"none":"block"),this._warningLeftElement.style.display=y;const b=typeof u=="string"?u:`${u}px`;this._warningLeftElement.style.marginLeft=f?b:p}if(this._warningRightElement){let y=e?"block":"none";f&&e&&(y=s.hideFrozenRightWarning?"none":"block"),this._warningRightElement.style.display=y;const b=typeof d=="string"?d:`${d}px`;this._warningRightElement.style.marginLeft=f?b:m}return e}}class my{constructor(e,t,r,n){var s,a,o;if(this.paginationService=e,this.pubSubService=t,this.sharedService=r,this.translaterService=n,this._enableTranslate=!1,this._subscriptions=[],this.firstButtonClasses="",this.lastButtonClasses="",this.prevButtonClasses="",this.nextButtonClasses="",this.textItemsPerPage="items per page",this.textItems="items",this.textOf="of",this.textPage="Page",this._bindingHelper=new Km,this._bindingHelper.querySelectorPrefix=`.${this.gridUid} `,this.currentPagination=this.paginationService.getFullPagination(),this._enableTranslate=((s=this.gridOptions)==null?void 0:s.enableTranslate)??!1,this._enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translatePaginationTexts(),this._enableTranslate&&((a=this.pubSubService)!=null&&a.subscribe)){const c=((o=this.translaterService)==null?void 0:o.eventName)??"onLanguageChange";this._subscriptions.push(this.pubSubService.subscribe(c,()=>this.translatePaginationTexts()))}this._subscriptions.push(this.pubSubService.subscribe("onPaginationRefreshed",c=>{for(const l of Object.keys(c))this.currentPagination[l]=c[l];this.updatePageButtonsUsability();const h=document.querySelector(`.${this.gridUid} span.page-info-from-to`);h!=null&&h.style&&(h.style.display=this.currentPagination.totalItems===0?"none":"")}),this.pubSubService.subscribe("onPaginationSetCursorBased",()=>{this.dispose(),this.renderPagination(this._gridParentContainerElm)}))}get availablePageSizes(){return this.paginationService.availablePageSizes||[]}get dataFrom(){return this.paginationService.dataFrom}get dataTo(){return this.paginationService.dataTo}get itemsPerPage(){return this.paginationService.itemsPerPage}set itemsPerPage(e){this.paginationService.changeItemPerPage(e)}get pageCount(){return this.paginationService.pageCount}get pageNumber(){return this.paginationService.pageNumber}get grid(){return this.sharedService.slickGrid}get gridOptions(){return this.sharedService.gridOptions}get gridUid(){var e;return((e=this.grid)==null?void 0:e.getUID())??""}get locales(){var e;return((e=this.gridOptions)==null?void 0:e.locales)??ye.locales}get totalItems(){return this.paginationService.totalItems}get isLeftPaginationDisabled(){return this.pageNumber===1||this.totalItems===0}get isRightPaginationDisabled(){return this.pageNumber===this.pageCount||this.totalItems===0}dispose(){this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingHelper.dispose(),this._paginationElement.remove()}renderPagination(e){this._gridParentContainerElm=e;const t=this.createPaginationContainer(),r=K("div",{className:"slick-pagination-nav"}),n=this.createPageNavigation("Page navigation",[{liClass:"page-item seek-first",aClass:"page-link icon-seek-first",ariaLabel:"First Page"},{liClass:"page-item seek-prev",aClass:"page-link icon-seek-prev",ariaLabel:"Previous Page"}]),s=this.createPageNumberSection(),a=this.createPageNavigation("Page navigation",[{liClass:"page-item seek-next",aClass:"page-link icon-seek-next",ariaLabel:"Next Page"},{liClass:"page-item seek-end",aClass:"page-link icon-seek-end",ariaLabel:"Last Page"}]);t.appendChild(r),r.appendChild(n),r.appendChild(s),r.appendChild(a);const o=this.createPaginationSettingsSection();t.appendChild(r),t.appendChild(o),this._paginationElement.appendChild(t),e!=null&&e.appendChild&&this._paginationElement&&e.appendChild(this._paginationElement),this.renderPageSizes(),this.addBindings(),this.addEventListeners(),this.updatePageButtonsUsability()}renderPageSizes(){const e=document.querySelector(`.${this.gridUid} .items-per-page`);if(e&&Array.isArray(this.availablePageSizes))for(const t of this.availablePageSizes)e.appendChild(K("option",{value:`${t}`,text:`${t}`}))}addBindings(){this._bindingHelper.addElementBinding(this,"firstButtonClasses","li.page-item.seek-first","className"),this._bindingHelper.addElementBinding(this,"prevButtonClasses","li.page-item.seek-prev","className"),this._bindingHelper.addElementBinding(this,"lastButtonClasses","li.page-item.seek-end","className"),this._bindingHelper.addElementBinding(this,"nextButtonClasses","li.page-item.seek-next","className"),this._bindingHelper.addElementBinding(this.currentPagination,"dataFrom","span.item-from","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"dataTo","span.item-to","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"totalItems","span.total-items","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageCount","span.page-count","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageSize","select.items-per-page","value"),this.paginationService.isCursorBased?this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","span.page-number","textContent"):this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","input.page-number","value","change",this.changeToCurrentPage.bind(this)),this._bindingHelper.addElementBinding(this,"textItems","span.text-items","textContent"),this._bindingHelper.addElementBinding(this,"textItemsPerPage","span.text-item-per-page","textContent"),this._bindingHelper.addElementBinding(this,"textOf","span.text-of","textContent"),this._bindingHelper.addElementBinding(this,"textPage","span.text-page","textContent")}addEventListeners(){this._bindingHelper.bindEventHandler(".icon-seek-first","click",this.changeToFirstPage.bind(this)),this._bindingHelper.bindEventHandler(".icon-seek-end","click",this.changeToLastPage.bind(this)),this._bindingHelper.bindEventHandler(".icon-seek-next","click",this.changeToNextPage.bind(this)),this._bindingHelper.bindEventHandler(".icon-seek-prev","click",this.changeToPreviousPage.bind(this)),this._bindingHelper.bindEventHandler("select.items-per-page","change",e=>{var t;return this.itemsPerPage=+(((t=e==null?void 0:e.target)==null?void 0:t.value)??0)})}changeToFirstPage(e){this.isLeftPaginationDisabled||this.paginationService.goToFirstPage(e)}changeToLastPage(e){this.isRightPaginationDisabled||this.paginationService.goToLastPage(e)}changeToNextPage(e){this.isRightPaginationDisabled||this.paginationService.goToNextPage(e)}changeToPreviousPage(e){this.isLeftPaginationDisabled||this.paginationService.goToPreviousPage(e)}changeToCurrentPage(e){this.paginationService.goToPageNumber(+e)}translatePaginationTexts(){var e;if(this._enableTranslate&&((e=this.translaterService)!=null&&e.translate)){const t=Kn(this.gridOptions);this.textItemsPerPage=this.translaterService.translate(`${t}ITEMS_PER_PAGE`),this.textItems=this.translaterService.translate(`${t}ITEMS`),this.textOf=this.translaterService.translate(`${t}OF`),this.textPage=this.translaterService.translate(`${t}PAGE`)}else this.locales&&(this.textItemsPerPage=this.locales.TEXT_ITEMS_PER_PAGE||"TEXT_ITEMS_PER_PAGE",this.textItems=this.locales.TEXT_ITEMS||"TEXT_ITEMS",this.textOf=this.locales.TEXT_OF||"TEXT_OF",this.textPage=this.locales.TEXT_PAGE||"TEXT_PAGE")}createPaginationContainer(){const e=K("div",{id:"pager",className:`slick-pagination-container ${this.gridUid} pager`,style:{width:"100%"}}),t=K("div",{className:"slick-pagination"});return e.appendChild(t),this._paginationElement=e,t}createPageNavigation(e,t){const r=K("nav",{ariaLabel:e}),n=K("ul",{className:"pagination"});for(const s of t)K("li",{className:s.liClass},n).appendChild(K("a",{className:s.aClass,ariaLabel:s.ariaLabel,role:"button"}));return r.appendChild(n),r}createPageNumberSection(){const e=K("div",{className:"slick-page-number"});return K("span",{className:"text-page",textContent:"Page"},e),e.appendChild(document.createTextNode(" ")),this.paginationService.isCursorBased?K("span",{className:"page-number",ariaLabel:"Page Number",dataset:{test:"page-number-label"},textContent:"1"},e):K("input",{type:"text",className:"form-control page-number",ariaLabel:"Page Number",value:"1",size:1,dataset:{test:"page-number-input"}},e),e.appendChild(document.createTextNode(" ")),K("span",{className:"text-of",textContent:"of"},e),e.appendChild(document.createTextNode(" ")),K("span",{className:"page-count",dataset:{test:"page-count"}},e),e}createPaginationSettingsSection(){const e=K("span",{className:"slick-pagination-settings"});K("select",{id:"items-per-page-label",ariaLabel:"Items per Page",className:"items-per-page"},e),e.appendChild(document.createTextNode(" ")),K("span",{className:"text-item-per-page",textContent:"items per page"},e),e.appendChild(document.createTextNode(", "));const t=K("span",{className:"slick-pagination-count"},e),r=K("span",{className:"page-info-from-to"},t);K("span",{className:"item-from",ariaLabel:"Page Item From",dataset:{test:"item-from"}},r),r.appendChild(document.createTextNode("-")),K("span",{className:"item-to",ariaLabel:"Page Item To",dataset:{test:"item-to"}},r),r.appendChild(document.createTextNode(" ")),K("span",{className:"text-of",textContent:"of"},r),r.appendChild(document.createTextNode(" "));const n=K("span",{className:"page-info-total-items"},t);return K("span",{className:"total-items",ariaLabel:"Total Items",dataset:{test:"total-items"}},n),n.appendChild(document.createTextNode(" ")),K("span",{className:"text-items",textContent:"items"},n),n.appendChild(document.createTextNode(" ")),e}updatePageButtonsUsability(){this.firstButtonClasses=this.isLeftPaginationDisabled?"page-item seek-first disabled":"page-item seek-first",this.prevButtonClasses=this.isLeftPaginationDisabled?"page-item seek-prev disabled":"page-item seek-prev",this.lastButtonClasses=this.isRightPaginationDisabled?"page-item seek-end disabled":"page-item seek-end",this.nextButtonClasses=this.isRightPaginationDisabled?"page-item seek-next disabled":"page-item seek-next"}}var vp={exports:{}};(function(i,e){(function(t,r){r(e)})(Id,function(t){var r=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},n={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","fvr","mars","avr","mai","juin","juil","aot","sept","oct","nov","dc"],longhand:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},ordinal:function(a){return a>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Dfiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};r.l10ns.fr=n;var s=r.l10ns;t.French=n,t.default=s,Object.defineProperty(t,"__esModule",{value:!0})})})(vp,vp.exports);class gy{get eventHandler(){return this._eventHandler}get gridUid(){var e;return((e=this.grid)==null?void 0:e.getUID())??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get gridOptions(){var e;return((e=this.grid)==null?void 0:e.getOptions())??{}}get locales(){var e;return((e=this.gridOptions)==null?void 0:e.locales)??ye.locales}set metrics(e){this.renderMetrics(e)}get leftFooterText(){var e;return((e=document.querySelector(`.slick-custom-footer${this.gridUidSelector} .left-footer`))==null?void 0:e.textContent)??""}set leftFooterText(e){this.renderLeftFooterText(e)}get rightFooterText(){var e;return((e=document.querySelector(`.slick-custom-footer${this.gridUidSelector} .right-footer`))==null?void 0:e.textContent)??""}set rightFooterText(e){this.renderRightFooterText(e)}constructor(e,t,r,n){var s,a,o,c,h;if(this.grid=e,this.customFooterOptions=t,this.pubSubService=r,this.translaterService=n,this._enableTranslate=!1,this._isLeftFooterOriginallyEmpty=!0,this._isLeftFooterDisplayingSelectionRowCount=!1,this._isRightFooterOriginallyEmpty=!0,this._selectedRowCount=0,this._subscriptions=[],this._bindingHelper=new Km,this._bindingHelper.querySelectorPrefix=`.${this.gridUid} `,this._eventHandler=new di,this._enableTranslate=((s=this.gridOptions)==null?void 0:s.enableTranslate)??!1,this._isLeftFooterOriginallyEmpty=!((a=this.gridOptions.customFooterOptions)!=null&&a.leftFooterText),this._isRightFooterOriginallyEmpty=!((o=this.gridOptions.customFooterOptions)!=null&&o.rightFooterText),this.registerOnSelectedRowsChangedWhenEnabled(t),this._enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translateCustomFooterTexts(),this._enableTranslate&&((c=this.pubSubService)!=null&&c.subscribe)){const l=((h=this.translaterService)==null?void 0:h.eventName)??"onLanguageChange";this._subscriptions.push(this.pubSubService.subscribe(l,()=>this.translateCustomFooterTexts()))}}dispose(){var e;this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingHelper.dispose(),(e=this._footerElement)==null||e.remove()}renderFooter(e){this.translateCustomFooterTexts(),this.createFooterContainer(e)}renderMetrics(e){var r;const t=Wr(e.endTime).format(this.customFooterOptions.dateFormat);this._bindingHelper.setElementAttributeValue("span.last-update-timestamp","textContent",t),this._bindingHelper.setElementAttributeValue("span.item-count","textContent",e.itemCount),this._bindingHelper.setElementAttributeValue("span.total-count","textContent",e.totalItemCount),(r=this.customFooterOptions.metricTexts)!=null&&r.lastUpdate&&this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"lastUpdate","span.text-last-update","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"items","span.text-items","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"of","span.text-of","textContent")}renderLeftFooterText(e){this._bindingHelper.setElementAttributeValue("div.left-footer","textContent",e)}renderRightFooterText(e){this._bindingHelper.setElementAttributeValue("div.right-footer","textContent",e)}translateCustomFooterTexts(){var e,t,r,n,s;if(this.gridOptions.enableTranslate&&((e=this.translaterService)!=null&&e.translate)){this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{};for(const a of Object.keys(this.customFooterOptions.metricTexts))if(a.lastIndexOf("Key")>0){const o=a.substring(0,a.lastIndexOf("Key"));this.customFooterOptions.metricTexts[o]=this.translaterService.translate(this.customFooterOptions.metricTexts[a]||" ")}this._isLeftFooterDisplayingSelectionRowCount&&(this.leftFooterText=`${this._selectedRowCount} ${this.customFooterOptions.metricTexts.itemsSelected}`)}else this.locales&&(this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{},this.customFooterOptions.metricTexts.lastUpdate=this.customFooterOptions.metricTexts.lastUpdate||((t=this.locales)==null?void 0:t.TEXT_LAST_UPDATE)||"TEXT_LAST_UPDATE",this.customFooterOptions.metricTexts.items=this.customFooterOptions.metricTexts.items||((r=this.locales)==null?void 0:r.TEXT_ITEMS)||"TEXT_ITEMS",this.customFooterOptions.metricTexts.itemsSelected=this.customFooterOptions.metricTexts.itemsSelected||((n=this.locales)==null?void 0:n.TEXT_ITEMS_SELECTED)||"TEXT_ITEMS_SELECTED",this.customFooterOptions.metricTexts.of=this.customFooterOptions.metricTexts.of||((s=this.locales)==null?void 0:s.TEXT_OF)||"TEXT_OF")}createFooterContainer(e){const t=K("div",{className:`slick-custom-footer ${this.gridUid}`,style:{width:"100%",height:`${this.customFooterOptions.footerHeight||20}px`}}),r=K("div",{className:`left-footer ${this.customFooterOptions.leftContainerClass}`});this.grid.applyHtmlCode(r,this.customFooterOptions.leftFooterText),t.appendChild(r),t.appendChild(this.createFooterRightContainer()),this._footerElement=t,e!=null&&e.appendChild&&this._footerElement&&e.appendChild(this._footerElement)}createFooterRightContainer(){var t,r,n,s;const e=K("div",{className:`right-footer ${this.customFooterOptions.rightContainerClass||""}`});if(!this._isRightFooterOriginallyEmpty)this.grid.applyHtmlCode(e,this.customFooterOptions.rightFooterText);else if(!this.customFooterOptions.hideMetrics){e.classList.add("metrics");const a=K("span",{className:"timestamp"},e);if(!this.customFooterOptions.hideLastUpdateTimestamp){const o=this.createFooterLastUpdate();o&&a.appendChild(o)}e.appendChild(K("span",{className:"item-count",textContent:`${((t=this.metrics)==null?void 0:t.itemCount)??"0"}`})),this.customFooterOptions.hideTotalItemCount||(e.appendChild(document.createTextNode(`\r
`)),e.appendChild(K("span",{className:"text-of",textContent:` ${((r=this.customFooterOptions.metricTexts)==null?void 0:r.of)??"of"} `})),e.appendChild(document.createTextNode(`\r
`)),e.appendChild(K("span",{className:"total-count",textContent:`${((n=this.metrics)==null?void 0:n.totalItemCount)??"0"}`}))),e.appendChild(document.createTextNode(`\r
`)),e.appendChild(K("span",{className:"text-items",textContent:` ${((s=this.customFooterOptions.metricTexts)==null?void 0:s.items)??"items"} `}))}return e}createFooterLastUpdate(){var n,s,a;const e=((s=(n=this.customFooterOptions)==null?void 0:n.metricTexts)==null?void 0:s.lastUpdate)??"Last Update",t=Wr((a=this.metrics)==null?void 0:a.endTime).format(this.customFooterOptions.dateFormat),r=K("span");return r.appendChild(K("span",{className:"text-last-update",textContent:e})),r.appendChild(document.createTextNode(`\r
`)),r.appendChild(K("span",{className:"last-update-timestamp",textContent:t})),r.appendChild(K("span",{className:"separator",textContent:` ${this.customFooterOptions.metricSeparator||""} `})),r}registerOnSelectedRowsChangedWhenEnabled(e){var r,n;if((this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection)&&e&&!e.hideRowSelectionCount&&this._isLeftFooterOriginallyEmpty){this._isLeftFooterDisplayingSelectionRowCount=!0;const s=((r=e.metricTexts)==null?void 0:r.itemsSelected)??((n=this.locales)==null?void 0:n.TEXT_ITEMS_SELECTED)??"TEXT_ITEMS_SELECTED";e.leftFooterText=`0 ${s}`,this._eventHandler.subscribe(this.grid.onSelectedRowsChanged,(a,o)=>{var h,l;this._selectedRowCount=o.rows.length;const c=((h=e.metricTexts)==null?void 0:h.itemsSelected)??((l=this.locales)==null?void 0:l.TEXT_ITEMS_SELECTED)??"TEXT_ITEMS_SELECTED";this.leftFooterText=`${this._selectedRowCount} ${c}`})}}}class vy{constructor(){this.dependencies=[]}get(e){const t=this.dependencies.find(r=>r.key===e);return t!=null&&t.instance?t.instance:null}dispose(){this.dependencies=[]}registerInstance(e,t){this.dependencies.some(n=>n.key===e)||this.dependencies.push({key:e,instance:t})}}class _y{get eventHandler(){return this._eventHandler}get columnDefinitions(){return this._columnDefinitions||[]}set columnDefinitions(e){this._columnDefinitions=e,this._slickgridInitialized&&this.updateColumnDefinitionsList(this._columnDefinitions),e.length>0&&this.copyColumnWidthsReference(e)}get dataset(){var e;return((e=this.dataView)==null?void 0:e.getItems())||[]}set dataset(e){var a,o;const t=this._currentDatasetLength,r=qn(e,this.dataset||[]);let s=!!((a=this._gridOptions)!=null&&a.enableDeepCopyDatasetOnPageLoad)?da(e||[]):e;this.slickGrid&&((o=this.gridOptions)!=null&&o.enableTreeData)&&Array.isArray(e)&&(e.length>0||e.length!==t||!r)&&(this._isDatasetHierarchicalInitialized=!1,s=this.sortTreeDataset(e,!r)),this.refreshGridData(s||[]),this._currentDatasetLength=(e||[]).length,this.slickGrid&&this.gridOptions.autoFitColumnsOnFirstLoad&&t===0&&!this._isAutosizeColsCalled&&(this.slickGrid.autosizeColumns(),this._isAutosizeColsCalled=!0)}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}set datasetHierarchical(e){var n,s;const t=qn(e,this.sharedService.hierarchicalDataset||[]),r=this._currentDatasetLength;this.sharedService.hierarchicalDataset=e,e&&this.columnDefinitions&&((n=this.filterService)!=null&&n.clearFilters)&&this.filterService.clearFilters(),this.dataView&&e&&this.slickGrid&&((s=this.sortService)!=null&&s.processTreeDataInitialSort)&&(this.sortService.processTreeDataInitialSort(),setTimeout(()=>{var o;const a=((o=this.dataView)==null?void 0:o.getItemCount())??0;a>0&&(a!==r||!t)&&this.filterService.refreshTreeDataFilters()})),this._isDatasetHierarchicalInitialized=!0}set eventPubSubService(e){this._eventPubSubService=e}set isDatasetHierarchicalInitialized(e){this._isDatasetHierarchicalInitialized=e}get gridOptions(){return this._gridOptions||{}}set gridOptions(e){var r,n,s;let t;(r=this.slickGrid)!=null&&r.getOptions?t=Br(!0,{},this.slickGrid.getOptions(),e):t=this.mergeGridOptions(e),(n=this.sharedService)!=null&&n.gridOptions&&((s=this.slickGrid)!=null&&s.setOptions)&&(this.sharedService.gridOptions=t,this.slickGrid.setOptions(t,!1,!0),this.slickGrid.reRenderColumns(!0)),this._gridOptions=t}get paginationOptions(){return this._paginationOptions}set paginationOptions(e){e&&this._paginationOptions?this._paginationOptions={...this._paginationOptions,...e}:this._paginationOptions=e,this.gridOptions.pagination=this._paginationOptions,this.paginationService.updateTotalItems((e==null?void 0:e.totalItems)??0,!0)}get isDatasetInitialized(){return this._isDatasetInitialized}set isDatasetInitialized(e){this._isDatasetInitialized=e}get isGridInitialized(){return this._isGridInitialized}get instances(){return this._slickerGridInstances}get extensions(){return this._extensions}get registeredResources(){return this._registeredResources}constructor(e,t,r,n,s,a){var l,u,d;if(this._currentDatasetLength=0,this._hideHeaderRowAfterPageLoad=!1,this._isAutosizeColsCalled=!1,this._isDatasetInitialized=!1,this._isDatasetHierarchicalInitialized=!1,this._isGridInitialized=!1,this._isLocalGrid=!0,this._isPaginationInitialized=!1,this._registeredResources=[],this._slickgridInitialized=!1,this.customDataView=!1,this.totalItems=0,this.subscriptions=[],this.showPagination=!1,e.querySelectorAll(".slickgrid-container").length!==0)return;e.classList.add("grid-pane"),this._gridParentContainerElm=e,this._gridContainerElm=document.createElement("div"),this._gridContainerElm.classList.add("slickgrid-container"),e.appendChild(this._gridContainerElm),this._hideHeaderRowAfterPageLoad=(r==null?void 0:r.showHeaderRow)===!1,this._columnDefinitions=t||[],this._columnDefinitions.length>0&&this.copyColumnWidthsReference(this._columnDefinitions),this._registeredResources=(r==null?void 0:r.externalResources)||[],this._gridOptions=this.mergeGridOptions(r||{});const o=!!((l=this._gridOptions)!=null&&l.enableDeepCopyDatasetOnPageLoad);this.universalContainerService=(a==null?void 0:a.universalContainerService)??new vy,this.translaterService=(a==null?void 0:a.translaterService)??((u=this._gridOptions)==null?void 0:u.translater),this._eventPubSubService=(a==null?void 0:a.eventPubSubService)??new AE(e),this._eventPubSubService.eventNamingStyle=((d=this._gridOptions)==null?void 0:d.eventNamingStyle)??zn.camelCase;const c=new dy;this.backendUtilityService=(a==null?void 0:a.backendUtilityService)??new Dm,this.gridEventService=(a==null?void 0:a.gridEventService)??new hw,this.sharedService=(a==null?void 0:a.sharedService)??new ww,this.collectionService=(a==null?void 0:a.collectionService)??new og(this.translaterService),this.extensionUtility=(a==null?void 0:a.extensionUtility)??new ax(this.sharedService,this.backendUtilityService,this.translaterService),this.filterFactory=new eC(c,this.translaterService,this.collectionService),this.filterService=(a==null?void 0:a.filterService)??new lw(this.filterFactory,this._eventPubSubService,this.sharedService,this.backendUtilityService),this.resizerService=(a==null?void 0:a.resizerService)??new xw(this._eventPubSubService),this.sortService=(a==null?void 0:a.sortService)??new Cw(this.sharedService,this._eventPubSubService,this.backendUtilityService),this.treeDataService=(a==null?void 0:a.treeDataService)??new yw(this._eventPubSubService,this.sharedService,this.sortService),this.paginationService=(a==null?void 0:a.paginationService)??new fw(this._eventPubSubService,this.sharedService,this.backendUtilityService),this.extensionService=(a==null?void 0:a.extensionService)??new Zx(this.extensionUtility,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService,this.translaterService,()=>this.gridService),this.gridStateService=(a==null?void 0:a.gridStateService)??new uw(this.extensionService,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService),this.gridService=(a==null?void 0:a.gridService)??new cw(this.gridStateService,this.filterService,this._eventPubSubService,this.paginationService,this.sharedService,this.sortService,this.treeDataService),this.groupingService=(a==null?void 0:a.groupingAndColspanService)??new dw(this.extensionUtility,this._eventPubSubService),s&&(this.sharedService.hierarchicalDataset=(o?da(s||[]):s)||[]);const h=new di;this.universalContainerService.registerInstance("PubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("EventPubSubService",this._eventPubSubService),this.universalContainerService.registerInstance("ExtensionUtility",this.extensionUtility),this.universalContainerService.registerInstance("FilterService",this.filterService),this.universalContainerService.registerInstance("CollectionService",this.collectionService),this.universalContainerService.registerInstance("ExtensionService",this.extensionService),this.universalContainerService.registerInstance("GridEventService",this.gridEventService),this.universalContainerService.registerInstance("GridService",this.gridService),this.universalContainerService.registerInstance("GridStateService",this.gridStateService),this.universalContainerService.registerInstance("GroupingAndColspanService",this.groupingService),this.universalContainerService.registerInstance("PaginationService",this.paginationService),this.universalContainerService.registerInstance("ResizerService",this.resizerService),this.universalContainerService.registerInstance("SharedService",this.sharedService),this.universalContainerService.registerInstance("SortService",this.sortService),this.universalContainerService.registerInstance("TranslaterService",this.translaterService),this.universalContainerService.registerInstance("TreeDataService",this.treeDataService),this.initialization(this._gridContainerElm,h,n)}emptyGridContainerElm(){var r;const e=((r=this.gridOptions)==null?void 0:r.gridContainerId)??"grid1",t=document.querySelector(`#${e}`);Rt(t)}dispose(e=!1){var t,r,n,s,a,o,c,h,l,u,d,f,p,m,v,_,x,E,C,y,b,T,R,O,W;if((t=this._eventPubSubService)==null||t.publish("onBeforeGridDestroy",this.slickGrid),(r=this._eventHandler)==null||r.unsubscribeAll(),(n=this._eventPubSubService)==null||n.publish("onAfterGridDestroyed",!0),(s=this.extensionService)==null||s.dispose(),(a=this.filterService)==null||a.dispose(),(o=this.gridEventService)==null||o.dispose(),(c=this.gridService)==null||c.dispose(),(h=this.gridStateService)==null||h.dispose(),(l=this.groupingService)==null||l.dispose(),(u=this.paginationService)==null||u.dispose(),(d=this.resizerService)==null||d.dispose(),(f=this.sortService)==null||f.dispose(),(p=this.treeDataService)==null||p.dispose(),(m=this.universalContainerService)==null||m.dispose(),this.disposeExternalResources(),(v=this.slickFooter)==null||v.dispose(),(_=this.slickEmptyWarning)==null||_.dispose(),(x=this.slickPagination)==null||x.dispose(),ph(this.subscriptions),(E=this._eventPubSubService)==null||E.unsubscribeAll(),(C=this.dataView)==null||C.setItems([]),typeof((y=this.dataView)==null?void 0:y.destroy)=="function"&&((b=this.dataView)==null||b.destroy()),(T=this.slickGrid)==null||T.destroy(!0),this.slickGrid=null,Rt(this._gridContainerElm),Rt(this._gridParentContainerElm),(R=this._gridContainerElm)==null||R.remove(),(O=this._gridParentContainerElm)==null||O.remove(),this.backendServiceApi){for(const G of Object.keys(this.backendServiceApi))this.backendServiceApi[G]=null;this.backendServiceApi=void 0}for(const G of Object.keys(this.columnDefinitions))this.columnDefinitions[G]=null;for(const G of Object.keys(this.sharedService))this.sharedService[G]=null;this.datasetHierarchical=void 0,this._columnDefinitions=[],e&&this.emptyGridContainerElm(),(W=this._eventPubSubService)==null||W.dispose(),this._slickerGridInstances=null}disposeExternalResources(){if(Array.isArray(this._registeredResources))for(;this._registeredResources.length>0;){const e=this._registeredResources.pop();e!=null&&e.dispose&&e.dispose()}this._registeredResources=[]}initialization(e,t,r){var s,a,o,c,h,l,u,d,f,p,m,v,_,x,E,C,y,b,T,R,O;if(this.gridOptions&&(this.gridOptions.frozenRow!==void 0&&this.gridOptions.frozenRow>=0||this.gridOptions.frozenColumn!==void 0&&this.gridOptions.frozenColumn>=0)&&this.gridOptions.enableMouseWheelScrollHandler===void 0&&(this.gridOptions.enableMouseWheelScrollHandler=!0),this._gridContainerElm=e,this._eventPubSubService.publish("onBeforeGridCreate",!0),this._isAutosizeColsCalled=!1,this._eventHandler=t,this._gridOptions=this.mergeGridOptions(this._gridOptions||{}),this.backendServiceApi=(s=this._gridOptions)==null?void 0:s.backendServiceApi,this._isLocalGrid=!this.backendServiceApi,this._eventPubSubService.eventNamingStyle=((a=this._gridOptions)==null?void 0:a.eventNamingStyle)??zn.camelCase,this._paginationOptions=(o=this.gridOptions)==null?void 0:o.pagination,this.createBackendApiInternalPostProcessCallback(this._gridOptions),!this.customDataView){const W=((h=(c=this._gridOptions)==null?void 0:c.dataView)==null?void 0:h.inlineFilters)??!1;let G={...this._gridOptions.dataView,inlineFilters:W};(this.gridOptions.draggableGrouping||this.gridOptions.enableGrouping)&&(this.groupItemMetadataProvider=new cg,this.sharedService.groupItemMetadataProvider=this.groupItemMetadataProvider,G={...G,groupItemMetadataProvider:this.groupItemMetadataProvider}),this.dataView=new hx(G,this._eventPubSubService),this._eventPubSubService.publish("onDataviewCreated",this.dataView)}this.preRegisterResources(),this._columnDefinitions=this.swapInternalEditorToSlickGridFactoryEditor(this._columnDefinitions||[]),(l=this._gridOptions)!=null&&l.autoAddCustomEditorFormatter&&rp(this._columnDefinitions,this._gridOptions.autoAddCustomEditorFormatter),this.sharedService.allColumns=this._columnDefinitions,this.sharedService.visibleColumns=this._columnDefinitions,this.extensionService.createExtensionsBeforeGridCreation(this._columnDefinitions,this._gridOptions),(u=this.gridOptions.presets)!=null&&u.pinning&&(this.gridOptions={...this.gridOptions,...this.gridOptions.presets.pinning}),this.slickGrid=new Bx(e,this.dataView,this._columnDefinitions,this._gridOptions,this._eventPubSubService),this.sharedService.dataView=this.dataView,this.sharedService.slickGrid=this.slickGrid,this.sharedService.gridContainerElement=this._gridContainerElm,this.groupItemMetadataProvider&&this.slickGrid.registerPlugin(this.groupItemMetadataProvider),this.extensionService.bindDifferentExtensions(),this.bindDifferentHooks(this.slickGrid,this._gridOptions,this.dataView),this._slickgridInitialized=!0;const n=((d=this._gridOptions)==null?void 0:d.frozenColumn)??-1;if(n>=0&&n<=this._columnDefinitions.length&&this._columnDefinitions.length>0&&(this.sharedService.frozenVisibleColumnId=((f=this._columnDefinitions[n])==null?void 0:f.id)??""),this.registerResources(),this.slickGrid.init(),this.resizerService.init(this.slickGrid,this._gridParentContainerElm),!this.gridOptions.enablePagination&&this.gridOptions.showCustomFooter&&this.gridOptions.customFooterOptions&&(this.slickFooter=new gy(this.slickGrid,this.gridOptions.customFooterOptions,this._eventPubSubService,this.translaterService),this.slickFooter.renderFooter(this._gridParentContainerElm)),this.dataView){r=r||[];const W=(p=this.gridOptions)!=null&&p.enableTreeData?this.sortTreeDataset(r):r;this.dataView.beginUpdate(),this.dataView.setItems(W,this._gridOptions.datasetIdPropertyName),this._currentDatasetLength=r.length,this.dataView.endUpdate()}if((m=this.slickGrid)!=null&&m.getSelectionModel()&&((_=(v=this._gridOptions)==null?void 0:v.dataView)!=null&&_.hasOwnProperty("syncGridSelection"))){let W=!1;this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(W=this._gridOptions.dataView.syncGridSelectionWithBackendService);const G=this._gridOptions.dataView.syncGridSelection;if(typeof G=="boolean"){let Q=G;this._isLocalGrid||(Q=G&&W),(x=this.dataView)==null||x.syncGridSelection(this.slickGrid,Q)}else typeof G=="object"&&((E=this.dataView)==null||E.syncGridSelection(this.slickGrid,G.preserveHidden,G.preserveHiddenOnSelectionChange))}(((C=this.dataView)==null?void 0:C.getLength())??0)>0?(!this._isDatasetInitialized&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.loadRowSelectionPresetWhenExists(),this.loadFilterPresetsWhenDatasetInitialized(),this._isDatasetInitialized=!0):this.displayEmptyDataWarning(!0),this._hideHeaderRowAfterPageLoad&&(this.showHeaderRow(!1),this.sharedService.hideHeaderRowAfterPageLoad=this._hideHeaderRowAfterPageLoad),this.gridEventService.bindOnBeforeEditCell(this.slickGrid),this.gridEventService.bindOnCellChange(this.slickGrid),this.gridEventService.bindOnClick(this.slickGrid),(y=this.gridOptions)!=null&&y.backendServiceApi&&this.bindBackendCallbackFunctions(this.gridOptions),this._eventPubSubService.publish("onGridCreated",this.slickGrid),this.customDataView||this.executeAfterDataviewCreated(this.gridOptions),this.bindResizeHook(this.slickGrid,this.gridOptions),(b=this.gridOptions)!=null&&b.enablePagination&&this._isLocalGrid&&(this.showPagination=!0,this.loadLocalGridPagination(this.dataset)),this._slickerGridInstances={dataView:this.dataView,slickGrid:this.slickGrid,dispose:this.dispose.bind(this),backendService:(R=(T=this.gridOptions)==null?void 0:T.backendServiceApi)==null?void 0:R.service,eventPubSubService:this._eventPubSubService,filterService:this.filterService,gridEventService:this.gridEventService,gridStateService:this.gridStateService,gridService:this.gridService,groupingService:this.groupingService,extensionService:this.extensionService,extensionUtility:this.extensionUtility,paginationService:this.paginationService,resizerService:this.resizerService,sortService:this.sortService,treeDataService:this.treeDataService},this._extensions=(O=this.extensionService)==null?void 0:O.extensionList,this._eventPubSubService.publish("onSlickerGridCreated",this.instances),this._isGridInitialized=!0}mergeGridOptions(e){const t=Br(!0,{},Wg,e);return t.enableFiltering&&!t.showHeaderRow&&(t.showHeaderRow=t.enableFiltering),t!=null&&t.pagination&&(e.enablePagination||e.backendServiceApi)&&e.pagination&&Array.isArray(e.pagination.pageSizes)&&(t.pagination.pageSizes=e.pagination.pageSizes),this.sharedService&&!t.enableFiltering&&t.enablePagination&&this._isLocalGrid&&(t.enableFiltering=!0,t.showHeaderRow=!1,this._hideHeaderRowAfterPageLoad=!0,this.sharedService.hideHeaderRowAfterPageLoad=!0),t}createBackendApiInternalPostProcessCallback(e){const t=e==null?void 0:e.backendServiceApi;if(t!=null&&t.service){const r=t.service;typeof r.getDatasetName=="function"&&(t.internalPostProcess=n=>{const s=t&&r&&typeof r.getDatasetName=="function"?r.getDatasetName():"";if(n&&n.data&&n.data[s]){const a=n.data[s].hasOwnProperty("nodes")?n.data[s].nodes:n.data[s],o=n.data[s].hasOwnProperty("totalCount")?n.data[s].totalCount:n.data[s].length;this.refreshGridData(a,o||0)}})}}bindDifferentHooks(e,t,r){var n,s;if(t.enableTranslate&&((n=this.translaterService)!=null&&n.addPubSubMessaging)&&this.translaterService.addPubSubMessaging(this._eventPubSubService),t.enableTranslate&&this.extensionService.translateAllExtensions(),this.subscriptions.push(this._eventPubSubService.subscribe("onLanguageChange",a=>{t.enableTranslate&&(this.extensionService.translateAllExtensions(a.language),t.createPreHeaderPanel&&!t.enableDraggableGrouping&&this.groupingService.translateGroupingAndColSpan())})),t.backendServiceApi){const a=t.backendServiceApi;(s=a==null?void 0:a.service)!=null&&s.init&&a.service.init(a.options,t.pagination,this.slickGrid,this.sharedService)}r&&e&&(t.enableFiltering&&(this.filterService.init(e),t.backendServiceApi&&!t.backendServiceApi.useLocalFiltering?this.filterService.bindBackendOnFilter(e):this.filterService.bindLocalOnFilter(e)),t.enableSorting&&(t.backendServiceApi&&!t.backendServiceApi.useLocalSorting?this.sortService.bindBackendOnSort(e):this.sortService.bindLocalOnSort(e)),this._eventHandler.subscribe(r.onRowCountChanged,()=>{var a,o;e.invalidate(),this.handleOnItemCountChanged(((a=this.dataView)==null?void 0:a.getFilteredItemCount())||0,((o=this.dataView)==null?void 0:o.getItemCount())??0)}),this._eventHandler.subscribe(r.onSetItemsCalled,(a,o)=>{var c,h;this.handleOnItemCountChanged(((c=this.dataView)==null?void 0:c.getFilteredItemCount())||0,o.itemCount),o.itemCount>0&&(this.gridOptions.autosizeColumnsByCellContentOnFirstLoad||this.gridOptions.enableAutoResizeColumnsByCellContent)&&this.resizerService.resizeColumnsByCellContent(!((h=this.gridOptions)!=null&&h.resizeByContentOnlyOnFirstLoad))}),t!=null&&t.enableFiltering&&!t.enableRowDetailView&&this._eventHandler.subscribe(r.onRowsChanged,(a,o)=>{o!=null&&o.rows&&Array.isArray(o.rows)&&(o.rows.forEach(c=>e.updateRow(c)),e.render())}),this._eventHandler.subscribe(e.onColumnsReordered,(a,o)=>{this.sharedService.hasColumnsReordered=!0,this.sharedService.visibleColumns=o.impactedColumns}),this.loadColumnPresetsWhenDatasetInitialized(),this.loadFilterPresetsWhenDatasetInitialized()),t!=null&&t.colspanCallback&&(r!=null&&r.getItem)&&(r!=null&&r.getItemMetadata)&&(r.getItemMetadata=a=>{let o=null;return t.colspanCallback&&(o=t.colspanCallback(r.getItem(a))),o})}bindBackendCallbackFunctions(e){var a,o,c;const t=e.backendServiceApi,r=t==null?void 0:t.service,n=(r==null?void 0:r.options)??{},s=n?n!=null&&n.hasOwnProperty("executeProcessCommandOnInit")?n.executeProcessCommandOnInit:!0:!1;if(r){if(e!=null&&e.presets){if(r.updateFilters&&Array.isArray(e.presets.filters)&&e.presets.filters.length>0&&r.updateFilters(e.presets.filters,!0),r.updateSorters&&Array.isArray(e.presets.sorters)&&e.presets.sorters.length>0){const h=(a=this._gridOptions)!=null&&a.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);r.updateSorters(void 0,h)}if(r.updatePagination&&e.presets.pagination){const{pageNumber:h,pageSize:l}=e.presets.pagination;r.updatePagination(h,l)}}else{const h=this.filterService.getColumnFilters();h&&r.updateFilters&&r.updateFilters(h,!1)}if(t&&r&&(t.onInit||s)){const h=typeof r.buildQuery=="function"?r.buildQuery():"",l=s?((o=t.process)==null?void 0:o.call(t,h))??null:((c=t.onInit)==null?void 0:c.call(t,h))??null;setTimeout(()=>{var p,m,v;const u=this.backendUtilityService,d=new Date;t.preProcess&&t.preProcess();const f=((m=(p=this.gridOptions)==null?void 0:p.pagination)==null?void 0:m.totalItems)??0;l instanceof Promise?l.then(_=>u.executeBackendProcessesCallback(d,_,t,f)).catch(_=>u.onBackendError(_,t)):l&&((v=this.rxjs)!=null&&v.isObservable(l))&&this.subscriptions.push(l.subscribe(_=>u.executeBackendProcessesCallback(d,_,t,f),_=>u.onBackendError(_,t)))})}}}bindResizeHook(e,t){if(t.autoFitColumnsOnFirstLoad&&t.autosizeColumnsByCellContentOnFirstLoad||t.enableAutoSizeColumns&&t.enableAutoResizeColumnsByCellContent)throw new Error('[Slickgrid-Universal] You cannot enable both autosize/fit viewport & resize by content, you must choose which resize technique to use. You can enable these 2 options ("autoFitColumnsOnFirstLoad" and "enableAutoSizeColumns") OR these other 2 options ("autosizeColumnsByCellContentOnFirstLoad" and "enableAutoResizeColumnsByCellContent").');t.gridHeight||t.gridWidth?this.resizerService.resizeGrid(0,{height:t.gridHeight,width:t.gridWidth}):this.resizerService.resizeGrid(),e&&(t!=null&&t.enableAutoResize)&&t.autoFitColumnsOnFirstLoad&&t.enableAutoSizeColumns&&!this._isAutosizeColsCalled&&(e.autosizeColumns(),this._isAutosizeColsCalled=!0)}executeAfterDataviewCreated(e){var t;if(e.enableSorting&&e.presets&&Array.isArray(e.presets.sorters)){const r=(t=this._gridOptions)!=null&&t.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);this.sortService.loadGridSorters(r)}}paginationChanged(e){var s,a;const t=((s=this.gridStateService)==null?void 0:s.needToPreserveRowSelection())??!1;this.slickGrid&&!t&&((a=this._gridOptions)!=null&&a.backendServiceApi)&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector)&&this.slickGrid.setSelectedRows([]);const{pageNumber:r,pageSize:n}=e;this.sharedService&&n!==void 0&&r!==void 0&&(this.sharedService.currentPagination={pageNumber:r,pageSize:n}),this._eventPubSubService.publish("onGridStateChanged",{change:{newValues:{pageNumber:r,pageSize:n},type:ur.pagination},gridState:this.gridStateService.getCurrentGridState()})}refreshGridData(e,t){var r,n,s,a,o;if(this.slickGrid&&this._gridOptions){if(this._gridOptions.enableEmptyDataWarningMessage&&Array.isArray(e)){const c=t||e.length;this.displayEmptyDataWarning(c<1)}if(Array.isArray(e)&&this.slickGrid&&((r=this.dataView)!=null&&r.setItems)){if(this.dataView.setItems(e,this._gridOptions.datasetIdPropertyName),!this._gridOptions.backendServiceApi&&!this._gridOptions.enableTreeData&&this.dataView.reSort(),e.length>0&&(this._isDatasetInitialized||(this.loadFilterPresetsWhenDatasetInitialized(),this._gridOptions.enableCheckboxSelector&&this.loadRowSelectionPresetWhenExists()),this._isDatasetInitialized=!0),e&&this.slickGrid.invalidate(),this.showPagination=!!(this._gridOptions&&(this._gridOptions.enablePagination||this._gridOptions.backendServiceApi&&this._gridOptions.enablePagination===void 0)),this._paginationOptions&&((n=this._gridOptions)!=null&&n.pagination)&&((s=this._gridOptions)!=null&&s.backendServiceApi)){const c=this.setPaginationOptionsWhenPresetDefined(this._gridOptions,this._paginationOptions),h=t!==void 0?t:(o=(a=this._gridOptions)==null?void 0:a.pagination)==null?void 0:o.totalItems;h!==void 0&&h!==this.totalItems&&(this.totalItems=+h),this._isPaginationInitialized?this.paginationService.updateTotalItems(this.totalItems):this.initializePaginationService(c)}if(this.slickGrid&&this._gridOptions.enableAutoResize){const c=this._gridOptions.autoResize&&this._gridOptions.autoResize.delay;this.resizerService.resizeGrid(c||10)}}}}updateColumnDefinitionsList(e){var t,r,n;this.slickGrid&&this._gridOptions&&Array.isArray(e)&&(e=this.swapInternalEditorToSlickGridFactoryEditor(e),this._gridOptions.autoAddCustomEditorFormatter&&rp(e,this._gridOptions.autoAddCustomEditorFormatter),this._gridOptions.enableTranslate?this.extensionService.translateColumnHeaders(void 0,e):this.extensionService.renderColumnHeaders(e,!0),this.slickGrid&&((t=this._gridOptions)!=null&&t.enableAutoSizeColumns)?this.slickGrid.autosizeColumns():(r=this._gridOptions)!=null&&r.enableAutoResizeColumnsByCellContent&&((n=this.resizerService)!=null&&n.resizeColumnsByCellContent)&&this.resizerService.resizeColumnsByCellContent())}showHeaderRow(e=!0){var t;return(t=this.slickGrid)==null||t.setHeaderRowVisibility(e),this.slickGrid&&e===!0&&this._isGridInitialized&&this.slickGrid.setColumns(this.columnDefinitions),e}setData(e,t=!1){t&&(this._isAutosizeColsCalled=!1,this._currentDatasetLength=0),this.dataset=e||[]}setPaginationOptionsWhenPresetDefined(e,t){var r;return(r=e.presets)!=null&&r.pagination&&t&&!this._isPaginationInitialized&&(t.pageSize=e.presets.pagination.pageSize,t.pageNumber=e.presets.pagination.pageNumber),t}copyColumnWidthsReference(e){e.forEach(t=>t.originalWidth=t.width)}displayEmptyDataWarning(e=!0){var t;this.gridOptions.enableEmptyDataWarningMessage&&((t=this.slickEmptyWarning)==null||t.showEmptyDataMessage(e))}handleOnItemCountChanged(e,t){var r;this._currentDatasetLength=t,this.metrics={startTime:new Date,endTime:new Date,itemCount:e,totalItemCount:t},this.slickFooter&&(this.slickFooter.metrics=this.metrics),this._isLocalGrid&&((r=this._gridOptions)!=null&&r.enableEmptyDataWarningMessage)&&this.displayEmptyDataWarning(e===0)}initializePaginationService(e){this.slickGrid&&this.gridOptions&&(this.paginationData={gridOptions:this.gridOptions,paginationService:this.paginationService},this.paginationService.totalItems=this.totalItems,this.paginationService.init(this.slickGrid,e,this.backendServiceApi),this.subscriptions.push(this._eventPubSubService.subscribe("onPaginationChanged",t=>this.paginationChanged(t)),this._eventPubSubService.subscribe("onPaginationVisibilityChanged",t=>{var r,n;this.showPagination=(t==null?void 0:t.visible)??!1,(r=this.gridOptions)!=null&&r.backendServiceApi&&((n=this.backendUtilityService)==null||n.refreshBackendDataset(this.gridOptions)),this.renderPagination(this.showPagination)})),this.renderPagination(),this._isPaginationInitialized=!0)}renderPagination(e=!0){var t;(t=this._gridOptions)!=null&&t.enablePagination&&!this._isPaginationInitialized&&e?(this.slickPagination=new my(this.paginationService,this._eventPubSubService,this.sharedService,this.translaterService),this.slickPagination.renderPagination(this._gridParentContainerElm),this._isPaginationInitialized=!0):e||(this.slickPagination&&this.slickPagination.dispose(),this._isPaginationInitialized=!1)}loadEditorCollectionAsync(e){var r;const t=(e==null?void 0:e.editor).collectionAsync;(e==null?void 0:e.editor).disabled=!0,t instanceof Promise?t.then(n=>{Array.isArray(n)?this.updateEditorCollection(e,n):(n==null?void 0:n.status)>=200&&n.status<300&&typeof n.json=="function"?n.bodyUsed?console.warn("[SlickGrid-Universal] The response body passed to collectionAsync was already read.Either pass the dataset from the Response or clone the response first using response.clone()"):n.json().then(s=>this.updateEditorCollection(e,s)):n!=null&&n.content&&this.updateEditorCollection(e,n.content)}):(r=this.rxjs)!=null&&r.isObservable(t)&&setTimeout(()=>{this.subscriptions.push(t.subscribe(n=>this.updateEditorCollection(e,n)))})}insertDynamicPresetColumns(e,t){if(this._columnDefinitions){const r=this._columnDefinitions.findIndex(n=>n.id===e);if(r>=0){const n=this._columnDefinitions[r];(n==null?void 0:n.id)===e&&!t.some(s=>s.id===e)&&(r>0?t.splice(r,0,n):t.unshift(n))}}}loadColumnPresetsWhenDatasetInitialized(){var e,t,r,n,s,a;if(this.slickGrid&&this.gridOptions.presets&&Array.isArray(this.gridOptions.presets.columns)&&this.gridOptions.presets.columns.length>0){const o=this.gridStateService.getAssociatedGridColumns(this.slickGrid,this.gridOptions.presets.columns);if(o&&Array.isArray(o)&&o.length>0&&Array.isArray(this._columnDefinitions)){if(this.gridOptions.enableRowMoveManager){const c=((t=(e=this.gridOptions)==null?void 0:e.rowMoveManager)==null?void 0:t.columnId)??"_move";this.insertDynamicPresetColumns(c,o)}if(this.gridOptions.enableCheckboxSelector){const c=((n=(r=this.gridOptions)==null?void 0:r.checkboxSelector)==null?void 0:n.columnId)??"_checkbox_selector";this.insertDynamicPresetColumns(c,o)}if(this.gridOptions.enableRowDetailView){const c=((a=(s=this.gridOptions)==null?void 0:s.rowDetailView)==null?void 0:a.columnId)??"_detail_selector";this.insertDynamicPresetColumns(c,o)}o.forEach(c=>c.originalWidth=c.width),this.slickGrid.setColumns(o),this.sharedService.visibleColumns=o}}}loadFilterPresetsWhenDatasetInitialized(){var e,t,r;this.gridOptions&&!this.customDataView&&this.gridOptions.presets&&(Array.isArray(this.gridOptions.presets.filters)||Array.isArray((t=(e=this.gridOptions.presets)==null?void 0:e.treeData)==null?void 0:t.toggledItems))&&this.filterService.populateColumnFilterSearchTermPresets(((r=this.gridOptions.presets)==null?void 0:r.filters)||[])}loadLocalGridPagination(e){var t;if(this.gridOptions&&this._paginationOptions){if(this.totalItems=Array.isArray(e)?e.length:0,this._paginationOptions&&((t=this.dataView)!=null&&t.getPagingInfo)){const n=this.dataView.getPagingInfo();n!=null&&n.hasOwnProperty("totalRows")&&this._paginationOptions.totalItems!==n.totalRows&&(this.totalItems=(n==null?void 0:n.totalRows)||0)}this._paginationOptions.totalItems=this.totalItems;const r=this.setPaginationOptionsWhenPresetDefined(this.gridOptions,this._paginationOptions);this.initializePaginationService(r)}}loadRowSelectionPresetWhenExists(){var n,s;const e=(n=this.gridOptions)==null?void 0:n.presets,t=(s=this.slickGrid)==null?void 0:s.getSelectionModel(),r=this.gridOptions&&(this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection);if(this.slickGrid&&this.dataView&&r&&t&&(e!=null&&e.rowSelection)&&(Array.isArray(e.rowSelection.gridRowIndexes)||Array.isArray(e.rowSelection.dataContextIds))){let a=e.rowSelection.dataContextIds,o=e.rowSelection.gridRowIndexes;Array.isArray(a)&&a.length>0?o=this.dataView.mapIdsToRows(a)||[]:Array.isArray(o)&&o.length>0&&(a=this.dataView.mapRowsToIds(o)||[]),this.slickGrid&&Array.isArray(o)&&(this.slickGrid.setSelectedRows(o),this.dataView.setSelectedIds(a||[],{isRowBeingAdded:!0,shouldTriggerEvent:!1,applyRowSelectionToGrid:!0}))}}registerExternalResources(e,t=!1){t&&this.disposeExternalResources(),e.forEach(r=>this._registeredResources.push(r)),this.initializeExternalResources(e)}resetExternalResources(){this._registeredResources=[]}preRegisterResources(){if(Array.isArray(this._registeredResources))for(const e of this._registeredResources)(e==null?void 0:e.className)==="RxJsResource"&&this.registerRxJsResource(e)}initializeExternalResources(e){if(Array.isArray(e))for(const t of e)this.slickGrid&&typeof t.init=="function"&&t.init(this.slickGrid,this.universalContainerService)}registerResources(){Array.isArray(this._registeredResources)&&(this.sharedService.externalRegisteredResources=this._registeredResources),this._registeredResources.push(this.gridService,this.gridStateService),this.gridOptions.createPreHeaderPanel&&!this.gridOptions.enableDraggableGrouping&&this._registeredResources.push(this.groupingService),this.gridOptions.enableTreeData&&this._registeredResources.push(this.treeDataService),this.gridOptions.enableTranslate&&this.extensionService.translateColumnHeaders(),this.slickEmptyWarning=new py,this._registeredResources.push(this.slickEmptyWarning),this.initializeExternalResources(this._registeredResources)}registerRxJsResource(e){this.rxjs=e,this.backendUtilityService.addRxJsResource(this.rxjs),this.filterFactory.addRxJsResource(this.rxjs),this.filterService.addRxJsResource(this.rxjs),this.sortService.addRxJsResource(this.rxjs),this.paginationService.addRxJsResource(this.rxjs),this.universalContainerService.registerInstance("RxJsFacade",this.rxjs),this.universalContainerService.registerInstance("RxJsResource",this.rxjs)}sortTreeDataset(e,t=!1){var a,o;const r=this._currentDatasetLength;let n,s=[];return this._isDatasetHierarchicalInitialized&&this.datasetHierarchical?(n=this.treeDataService.sortHierarchicalDataset(this.datasetHierarchical),s=n.flat):Array.isArray(e)&&e.length>0&&((o=(a=this.gridOptions)==null?void 0:a.treeDataOptions)!=null&&o.initialSort?(n=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(e,this._columnDefinitions||[],this.gridOptions),this.sharedService.hierarchicalDataset=n.hierarchical,s=n.flat):(this.sharedService.hierarchicalDataset=this.treeDataService.convertFlatParentChildToTreeDataset(e,this.gridOptions),s=e||[])),e.length>0&&(t||e.length!==r)&&this.filterService.refreshTreeDataFilters(s),s}swapInternalEditorToSlickGridFactoryEditor(e){const t=Array.isArray(e)?e:[];return t.some(r=>`${r.id}`.includes("."))&&console.error('[Slickgrid-Universal] Make sure that none of your Column Definition "id" property includes a dot in its name because that will cause some problems with the Editors. For example if your column definition "field" property is "user.firstName" then use "firstName" as the column "id".'),t.map(r=>{var s;(s=r.editor)!=null&&s.collectionAsync&&this.loadEditorCollectionAsync(r);const n=r.internalColumnEditor||r.editor;return{...r,editor:n==null?void 0:n.model,internalColumnEditor:{...n}}})}updateEditorCollection(e,t){if(e.editor.collection=t,e.editor.disabled=!1,this.slickGrid){if(Array.isArray(this.columnDefinitions)){const n=this.columnDefinitions.find(s=>s.id===e.id);n&&(n.internalColumnEditor=e.editor)}const r=this.slickGrid.getCellEditor();r!=null&&r.disable&&(r!=null&&r.renderDomElement)&&(typeof r.destroy=="function"&&r.destroy(),r.disable(!1),r.renderDomElement(t))}}}const Yg={GridBundle:_y,Aggregators:lC,BindingService:qm,Editors:yC,Enums:sE,Filters:Ug,Formatters:KC,GroupTotalFormatters:uy,SortComparers:Do,Utilities:fy};typeof window<"u"&&(window.Slicker=Yg);class Xg{static createGrid(e,t,r={}){const n=t.map(o=>({...o,formatter:o.formatter||this.styleFormatter})),s={enableAutoResize:!0,enableCellNavigation:!0,enableFiltering:!0,autoEdit:!1,editable:!0,enableAutoTooltip:!0,enableCellSelection:!0,cellSelectionModel:{selectActiveCell:!0},enableExcelCopyBuffer:!0,enableHeaderMenu:!0,enableGridMenu:!0,gridHeight:600,gridWidth:"100%",...r};return new Yg.GridBundle(e,n,s,[])}}Ui(Xg,"styleFormatter",(e,t,r,n,s)=>{var c;const a=(c=s._styles)==null?void 0:c[n.id];if(!a)return r;const o=document.createElement("div");return o.innerText=r,a.bold&&(o.style.fontWeight="bold"),a.italic&&(o.style.fontStyle="italic"),a.underline&&(o.style.textDecoration="underline"),a.textColor&&(o.style.color=a.textColor),a.bgColor&&(o.style.backgroundColor=a.bgColor),a.align&&(o.style.textAlign=a.align),o.outerHTML});class Ey{constructor(){Ui(this,"rows",[])}setRows(e){this.rows=e}getRows(){return this.rows}getCellValue(e,t){var n;const r=this.rows.find(s=>s.id===e);return(n=r==null?void 0:r.cells[t])==null?void 0:n.value}setCellValue(e,t,r,n){let s=this.rows.find(a=>a.id===e);s||(s={id:e,order:this.rows.length,cells:{}},this.rows.push(s)),s.cells[t]={...s.cells[t],value:r,formula:n}}setCellStyle(e,t,r){let n=this.rows.find(s=>s.id===e);n||(n={id:e,order:this.rows.length,cells:{}},this.rows.push(n)),n.cells[t]||(n.cells[t]={value:""}),n.cells[t].styleKey=r}toSlickGridDataset(e){return this.rows.map(t=>{const r={id:t.id,_styles:{}};return Object.entries(t.cells).forEach(([n,s])=>{r[n]=s.value,s.styleKey&&(r._styles[n]=e.getStyle(s.styleKey))}),r})}}const _p={bold:!1,italic:!1,underline:!1,textColor:"#000000",bgColor:"#ffffff",align:"left",valign:"middle",fontSize:13};class xy{constructor(){Ui(this,"styles",{default:_p})}getStyleKey(e){const t=JSON.stringify(e);for(const[n,s]of Object.entries(this.styles))if(JSON.stringify(s)===t)return n;const r=`s-${Object.keys(this.styles).length}`;return this.styles[r]=e,r}getStyle(e){return this.styles[e]||_p}getAllStyles(){return this.styles}loadStyles(e){this.styles={...this.styles,...e}}}class wy{constructor(e,t){this.sheet=e,this.styleStore=t}applyStyle(e,t){const r=this.sheet.getDataModel(),n=this.sheet.getColumns();for(let s=e.fromRow;s<=e.toRow;s++){const a=`row-${s}`;for(let o=e.fromCell;o<=e.toCell;o++){const c=n[o].id,l=r.getRows().find(v=>v.id===a),d=((l==null?void 0:l.cells[c])||{}).styleKey||"default",p={...this.styleStore.getStyle(d),...t},m=this.styleStore.getStyleKey(p);r.setCellStyle(a,c,m)}}}}class Ep{constructor(e=[]){Ui(this,"merges",[]);this.merges=e}addMerge(e){if(this.isOverlapping(e))throw new Error("Merge range overlaps with an existing merge.");this.merges.push(e)}removeMerge(e,t){this.merges=this.merges.filter(r=>!(e>=r.x1&&e<=r.x2&&t>=r.y1&&t<=r.y2))}getMergeAt(e,t){return this.merges.find(r=>e>=r.x1&&e<=r.x2&&t>=r.y1&&t<=r.y2)}getAllMerges(){return this.merges}isOverlapping(e){return this.merges.some(t=>!(e.x2<t.x1||e.x1>t.x2||e.y2<t.y1||e.y1>t.y2))}}class Cy{constructor(){Ui(this,"adjs",new Map);Ui(this,"reverseAdjs",new Map)}addDependency(e,t){this.adjs.has(e)||this.adjs.set(e,new Set),this.adjs.get(e).add(t),this.reverseAdjs.has(t)||this.reverseAdjs.set(t,new Set),this.reverseAdjs.get(t).add(e)}clearDependencies(e){const t=this.reverseAdjs.get(e);t&&(t.forEach(r=>{var n;(n=this.adjs.get(r))==null||n.delete(e)}),this.reverseAdjs.delete(e))}getDependents(e){const t=new Set,r=[],n=s=>{if(t.has(s))return;t.add(s);const a=this.adjs.get(s);a&&a.forEach(o=>{r.push(o),n(o)})};return n(e),Array.from(new Set(r))}}var qg={exports:{}};(function(i,e){(function(t,r){i.exports=r()})(Id,function(){var t=function(r,n){var s=Array.prototype.concat,a=Array.prototype.slice,o=Object.prototype.toString;function c(x,E){var C=x>E?x:E;return r.pow(10,17-~~(r.log(C>0?C:-C)*r.LOG10E))}var h=Array.isArray||function(E){return o.call(E)==="[object Array]"};function l(x){return o.call(x)==="[object Function]"}function u(x){return typeof x=="number"?x-x===0:!1}function d(x){return s.apply([],x)}function f(){return new f._init(arguments)}f.fn=f.prototype,f._init=function(E){if(h(E[0]))if(h(E[0][0])){l(E[1])&&(E[0]=f.map(E[0],E[1]));for(var C=0;C<E[0].length;C++)this[C]=E[0][C];this.length=E[0].length}else this[0]=l(E[1])?f.map(E[0],E[1]):E[0],this.length=1;else if(u(E[0]))this[0]=f.seq.apply(null,E),this.length=1;else{if(E[0]instanceof f)return f(E[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:c,isArray:h,isFunction:l,isNumber:u,toVector:d},f._random_fn=r.random,f.setRandom=function(E){if(typeof E!="function")throw new TypeError("fn is not a function");f._random_fn=E},f.extend=function(E){var C,y;if(arguments.length===1){for(y in E)f[y]=E[y];return this}for(C=1;C<arguments.length;C++)for(y in arguments[C])E[y]=arguments[C][y];return E},f.rows=function(E){return E.length||1},f.cols=function(E){return E[0].length||1},f.dimensions=function(E){return{rows:f.rows(E),cols:f.cols(E)}},f.row=function(E,C){return h(C)?C.map(function(y){return f.row(E,y)}):E[C]},f.rowa=function(E,C){return f.row(E,C)},f.col=function(E,C){if(h(C)){var y=f.arange(E.length).map(function(){return new Array(C.length)});return C.forEach(function(R,O){f.arange(E.length).forEach(function(W){y[W][O]=E[W][R]})}),y}for(var b=new Array(E.length),T=0;T<E.length;T++)b[T]=[E[T][C]];return b},f.cola=function(E,C){return f.col(E,C).map(function(y){return y[0]})},f.diag=function(E){for(var C=f.rows(E),y=new Array(C),b=0;b<C;b++)y[b]=[E[b][b]];return y},f.antidiag=function(E){for(var C=f.rows(E)-1,y=new Array(C),b=0;C>=0;C--,b++)y[b]=[E[b][C]];return y},f.transpose=function(E){var C=[],y,b,T,R,O;for(h(E[0])||(E=[E]),b=E.length,T=E[0].length,O=0;O<T;O++){for(y=new Array(b),R=0;R<b;R++)y[R]=E[R][O];C.push(y)}return C.length===1?C[0]:C},f.map=function(E,C,y){var b,T,R,O,W;for(h(E[0])||(E=[E]),T=E.length,R=E[0].length,O=y?E:new Array(T),b=0;b<T;b++)for(O[b]||(O[b]=new Array(R)),W=0;W<R;W++)O[b][W]=C(E[b][W],b,W);return O.length===1?O[0]:O},f.cumreduce=function(E,C,y){var b,T,R,O,W;for(h(E[0])||(E=[E]),T=E.length,R=E[0].length,O=y?E:new Array(T),b=0;b<T;b++)for(O[b]||(O[b]=new Array(R)),R>0&&(O[b][0]=E[b][0]),W=1;W<R;W++)O[b][W]=C(O[b][W-1],E[b][W]);return O.length===1?O[0]:O},f.alter=function(E,C){return f.map(E,C,!0)},f.create=function(E,C,y){var b=new Array(E),T,R;for(l(C)&&(y=C,C=E),T=0;T<E;T++)for(b[T]=new Array(C),R=0;R<C;R++)b[T][R]=y(T,R);return b};function p(){return 0}f.zeros=function(E,C){return u(C)||(C=E),f.create(E,C,p)};function m(){return 1}f.ones=function(E,C){return u(C)||(C=E),f.create(E,C,m)},f.rand=function(E,C){return u(C)||(C=E),f.create(E,C,f._random_fn)};function v(x,E){return x===E?1:0}f.identity=function(E,C){return u(C)||(C=E),f.create(E,C,v)},f.symmetric=function(E){var C=E.length,y,b;if(E.length!==E[0].length)return!1;for(y=0;y<C;y++)for(b=0;b<C;b++)if(E[b][y]!==E[y][b])return!1;return!0},f.clear=function(E){return f.alter(E,p)},f.seq=function(E,C,y,b){l(b)||(b=!1);var T=[],R=c(E,C),O=(C*R-E*R)/((y-1)*R),W=E,G;for(G=0;W<=C&&G<y;G++,W=(E*R+O*R*G)/R)T.push(b?b(W,G):W);return T},f.arange=function(E,C,y){var b=[],T;if(y=y||1,C===n&&(C=E,E=0),E===C||y===0)return[];if(E<C&&y<0)return[];if(E>C&&y>0)return[];if(y>0)for(T=E;T<C;T+=y)b.push(T);else for(T=E;T>C;T+=y)b.push(T);return b},f.slice=function(){function x(C,y,b,T){var R,O=[],W=C.length;if(y===n&&b===n&&T===n)return f.copy(C);if(y=y||0,b=b||C.length,y=y>=0?y:W+y,b=b>=0?b:W+b,T=T||1,y===b||T===0)return[];if(y<b&&T<0)return[];if(y>b&&T>0)return[];if(T>0)for(R=y;R<b;R+=T)O.push(C[R]);else for(R=y;R>b;R+=T)O.push(C[R]);return O}function E(C,y){var b,T;if(y=y||{},u(y.row)){if(u(y.col))return C[y.row][y.col];var R=f.rowa(C,y.row);return b=y.col||{},x(R,b.start,b.end,b.step)}if(u(y.col)){var O=f.cola(C,y.col);return T=y.row||{},x(O,T.start,T.end,T.step)}T=y.row||{},b=y.col||{};var W=x(C,T.start,T.end,T.step);return W.map(function(G){return x(G,b.start,b.end,b.step)})}return E}(),f.sliceAssign=function(E,C,y){var b,T;if(u(C.row)){if(u(C.col))return E[C.row][C.col]=y;C.col=C.col||{},C.col.start=C.col.start||0,C.col.end=C.col.end||E[0].length,C.col.step=C.col.step||1,b=f.arange(C.col.start,r.min(E.length,C.col.end),C.col.step);var R=C.row;return b.forEach(function(W,G){E[R][W]=y[G]}),E}if(u(C.col)){C.row=C.row||{},C.row.start=C.row.start||0,C.row.end=C.row.end||E.length,C.row.step=C.row.step||1,T=f.arange(C.row.start,r.min(E[0].length,C.row.end),C.row.step);var O=C.col;return T.forEach(function(W,G){E[W][O]=y[G]}),E}return y[0].length===n&&(y=[y]),C.row.start=C.row.start||0,C.row.end=C.row.end||E.length,C.row.step=C.row.step||1,C.col.start=C.col.start||0,C.col.end=C.col.end||E[0].length,C.col.step=C.col.step||1,T=f.arange(C.row.start,r.min(E.length,C.row.end),C.row.step),b=f.arange(C.col.start,r.min(E[0].length,C.col.end),C.col.step),T.forEach(function(W,G){b.forEach(function(Q,ne){E[W][Q]=y[G][ne]})}),E},f.diagonal=function(E){var C=f.zeros(E.length,E.length);return E.forEach(function(y,b){C[b][b]=y}),C},f.copy=function(E){return E.map(function(C){return u(C)?C:C.map(function(y){return y})})};var _=f.prototype;return _.length=0,_.push=Array.prototype.push,_.sort=Array.prototype.sort,_.splice=Array.prototype.splice,_.slice=Array.prototype.slice,_.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},_.map=function(E,C){return f(f.map(this,E,C))},_.cumreduce=function(E,C){return f(f.cumreduce(this,E,C))},_.alter=function(E){return f.alter(this,E),this},function(x){for(var E=0;E<x.length;E++)(function(C){_[C]=function(y){var b=this,T;return y?(setTimeout(function(){y.call(b,_[C].call(b))}),this):(T=f[C](this),h(T)?f(T):T)}})(x[E])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(x){for(var E=0;E<x.length;E++)(function(C){_[C]=function(y,b){var T=this;return b?(setTimeout(function(){b.call(T,_[C].call(T,y))}),this):f(f[C](this,y))}})(x[E])}("row col".split(" ")),function(x){for(var E=0;E<x.length;E++)(function(C){_[C]=function(){return f(f[C].apply(null,arguments))}})(x[E])}("create zeros ones rand identity".split(" ")),f}(Math);return function(r,n){var s=r.utils.isFunction;function a(h,l){return h-l}function o(h,l,u){return n.max(l,n.min(h,u))}r.sum=function(l){for(var u=0,d=l.length;--d>=0;)u+=l[d];return u},r.sumsqrd=function(l){for(var u=0,d=l.length;--d>=0;)u+=l[d]*l[d];return u},r.sumsqerr=function(l){for(var u=r.mean(l),d=0,f=l.length,p;--f>=0;)p=l[f]-u,d+=p*p;return d},r.sumrow=function(l){for(var u=0,d=l.length;--d>=0;)u+=l[d];return u},r.product=function(l){for(var u=1,d=l.length;--d>=0;)u*=l[d];return u},r.min=function(l){for(var u=l[0],d=0;++d<l.length;)l[d]<u&&(u=l[d]);return u},r.max=function(l){for(var u=l[0],d=0;++d<l.length;)l[d]>u&&(u=l[d]);return u},r.unique=function(l){for(var u={},d=[],f=0;f<l.length;f++)u[l[f]]||(u[l[f]]=!0,d.push(l[f]));return d},r.mean=function(l){return r.sum(l)/l.length},r.meansqerr=function(l){return r.sumsqerr(l)/l.length},r.geomean=function(l){var u=l.map(n.log),d=r.mean(u);return n.exp(d)},r.median=function(l){var u=l.length,d=l.slice().sort(a);return u&1?d[u/2|0]:(d[u/2-1]+d[u/2])/2},r.cumsum=function(l){return r.cumreduce(l,function(u,d){return u+d})},r.cumprod=function(l){return r.cumreduce(l,function(u,d){return u*d})},r.diff=function(l){var u=[],d=l.length,f;for(f=1;f<d;f++)u.push(l[f]-l[f-1]);return u},r.rank=function(h){var l,u=[],d={};for(l=0;l<h.length;l++){var f=h[l];d[f]?d[f]++:(d[f]=1,u.push(f))}var p=u.sort(a),m={},v=1;for(l=0;l<p.length;l++){var f=p[l],_=d[f],x=v,E=v+_-1,C=(x+E)/2;m[f]=C,v+=_}return h.map(function(y){return m[y]})},r.mode=function(l){var u=l.length,d=l.slice().sort(a),f=1,p=0,m=0,v=[],_;for(_=0;_<u;_++)d[_]===d[_+1]?f++:(f>p?(v=[d[_]],p=f,m=0):f===p&&(v.push(d[_]),m++),f=1);return m===0?v[0]:v},r.range=function(l){return r.max(l)-r.min(l)},r.variance=function(l,u){return r.sumsqerr(l)/(l.length-(u?1:0))},r.pooledvariance=function(l){var u=l.reduce(function(f,p){return f+r.sumsqerr(p)},0),d=l.reduce(function(f,p){return f+p.length},0);return u/(d-l.length)},r.deviation=function(h){for(var l=r.mean(h),u=h.length,d=new Array(u),f=0;f<u;f++)d[f]=h[f]-l;return d},r.stdev=function(l,u){return n.sqrt(r.variance(l,u))},r.pooledstdev=function(l){return n.sqrt(r.pooledvariance(l))},r.meandev=function(l){for(var u=r.mean(l),d=[],f=l.length-1;f>=0;f--)d.push(n.abs(l[f]-u));return r.mean(d)},r.meddev=function(l){for(var u=r.median(l),d=[],f=l.length-1;f>=0;f--)d.push(n.abs(l[f]-u));return r.median(d)},r.coeffvar=function(l){return r.stdev(l)/r.mean(l)},r.quartiles=function(l){var u=l.length,d=l.slice().sort(a);return[d[n.round(u/4)-1],d[n.round(u/2)-1],d[n.round(u*3/4)-1]]},r.quantiles=function(l,u,d,f){var p=l.slice().sort(a),m=[u.length],v=l.length,_,x,E,C,y,b;for(typeof d>"u"&&(d=3/8),typeof f>"u"&&(f=3/8),_=0;_<u.length;_++)x=u[_],E=d+x*(1-d-f),C=v*x+E,y=n.floor(o(C,1,v-1)),b=o(C-y,0,1),m[_]=(1-b)*p[y-1]+b*p[y];return m},r.percentile=function(l,u,d){var f=l.slice().sort(a),p=u*(f.length+(d?1:-1))+(d?0:1),m=parseInt(p),v=p-m;return m+1<f.length?f[m-1]+v*(f[m]-f[m-1]):f[m-1]},r.percentileOfScore=function(l,u,d){var f=0,p=l.length,m=!1,v,_;for(d==="strict"&&(m=!0),_=0;_<p;_++)v=l[_],(m&&v<u||!m&&v<=u)&&f++;return f/p},r.histogram=function(l,u){u=u||4;var d=r.min(l),f=(r.max(l)-d)/u,p=l.length,m=[],v;for(v=0;v<u;v++)m[v]=0;for(v=0;v<p;v++)m[n.min(n.floor((l[v]-d)/f),u-1)]+=1;return m},r.covariance=function(l,u){var d=r.mean(l),f=r.mean(u),p=l.length,m=new Array(p),v;for(v=0;v<p;v++)m[v]=(l[v]-d)*(u[v]-f);return r.sum(m)/(p-1)},r.corrcoeff=function(l,u){return r.covariance(l,u)/r.stdev(l,1)/r.stdev(u,1)},r.spearmancoeff=function(h,l){return h=r.rank(h),l=r.rank(l),r.corrcoeff(h,l)},r.stanMoment=function(l,u){for(var d=r.mean(l),f=r.stdev(l),p=l.length,m=0,v=0;v<p;v++)m+=n.pow((l[v]-d)/f,u);return m/l.length},r.skewness=function(l){return r.stanMoment(l,3)},r.kurtosis=function(l){return r.stanMoment(l,4)-3};var c=r.prototype;(function(h){for(var l=0;l<h.length;l++)(function(u){c[u]=function(d,f){var p=[],m=0,v=this;if(s(d)&&(f=d,d=!1),f)return setTimeout(function(){f.call(v,c[u].call(v,d))}),this;if(this.length>1){for(v=d===!0?this:this.transpose();m<v.length;m++)p[m]=r[u](v[m]);return p}return r[u](this[0],d)}})(h[l])})("cumsum cumprod".split(" ")),function(h){for(var l=0;l<h.length;l++)(function(u){c[u]=function(d,f){var p=[],m=0,v=this;if(s(d)&&(f=d,d=!1),f)return setTimeout(function(){f.call(v,c[u].call(v,d))}),this;if(this.length>1){for(u!=="sumrow"&&(v=d===!0?this:this.transpose());m<v.length;m++)p[m]=r[u](v[m]);return d===!0?r[u](r.utils.toVector(p)):p}return r[u](this[0],d)}})(h[l])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(h){for(var l=0;l<h.length;l++)(function(u){c[u]=function(){var d=[],f=0,p=this,m=Array.prototype.slice.call(arguments),v;if(s(m[m.length-1])){v=m[m.length-1];var _=m.slice(0,m.length-1);return setTimeout(function(){v.call(p,c[u].apply(p,_))}),this}else{v=void 0;var x=function(C){return r[u].apply(p,[C].concat(m))}}if(this.length>1){for(p=p.transpose();f<p.length;f++)d[f]=x(p[f]);return d}return x(this[0])}})(h[l])}("quantiles percentileOfScore".split(" "))}(t,Math),function(r,n){r.gammaln=function(a){var o=0,c=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015,l,u,d;for(d=(u=l=a)+5.5,d-=(l+.5)*n.log(d);o<6;o++)h+=c[o]/++u;return n.log(2.5066282746310007*h/l)-d},r.loggam=function(a){var o,c,h,l,u,d,f,p=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(o=a,f=0,a==1||a==2)return 0;for(a<=7&&(f=n.floor(7-a),o=a+f),c=1/(o*o),h=2*n.PI,u=p[9],d=8;d>=0;d--)u*=c,u+=p[d];if(l=u/o+.5*n.log(h)+(o-.5)*n.log(o)-o,a<=7)for(d=1;d<=f;d++)l-=n.log(o-1),o-=1;return l},r.gammafn=function(a){var o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],h=!1,l=0,u=0,d=0,f=a,p,m,v,_;if(a>171.6243769536076)return 1/0;if(f<=0)if(_=f%1+36e-17,_)h=(f&1?-1:1)*n.PI/n.sin(n.PI*_),f=1-f;else return 1/0;for(v=f,f<1?m=f++:m=(f-=l=(f|0)-1)-1,p=0;p<8;++p)d=(d+o[p])*m,u=u*m+c[p];if(_=d/u+1,v<f)_/=v;else if(v>f)for(p=0;p<l;++p)_*=f,f++;return h&&(_=h/_),_},r.gammap=function(a,o){return r.lowRegGamma(a,o)*r.gammafn(a)},r.lowRegGamma=function(a,o){var c=r.gammaln(a),h=a,l=1/a,u=l,d=o+1-a,f=1/1e-30,p=1/d,m=p,v=1,_=-~(n.log(a>=1?a:1/a)*8.5+a*.4+17),x;if(o<0||a<=0)return NaN;if(o<a+1){for(;v<=_;v++)l+=u*=o/++h;return l*n.exp(-o+a*n.log(o)-c)}for(;v<=_;v++)x=-v*(v-a),d+=2,p=x*p+d,f=d+x/f,p=1/p,m*=p*f;return 1-m*n.exp(-o+a*n.log(o)-c)},r.factorialln=function(a){return a<0?NaN:r.gammaln(a+1)},r.factorial=function(a){return a<0?NaN:r.gammafn(a+1)},r.combination=function(a,o){return a>170||o>170?n.exp(r.combinationln(a,o)):r.factorial(a)/r.factorial(o)/r.factorial(a-o)},r.combinationln=function(a,o){return r.factorialln(a)-r.factorialln(o)-r.factorialln(a-o)},r.permutation=function(a,o){return r.factorial(a)/r.factorial(a-o)},r.betafn=function(a,o){if(!(a<=0||o<=0))return a+o>170?n.exp(r.betaln(a,o)):r.gammafn(a)*r.gammafn(o)/r.gammafn(a+o)},r.betaln=function(a,o){return r.gammaln(a)+r.gammaln(o)-r.gammaln(a+o)},r.betacf=function(a,o,c){var h=1e-30,l=1,u=o+c,d=o+1,f=o-1,p=1,m=1-u*a/d,v,_,x,E;for(n.abs(m)<h&&(m=h),m=1/m,E=m;l<=100&&(v=2*l,_=l*(c-l)*a/((f+v)*(o+v)),m=1+_*m,n.abs(m)<h&&(m=h),p=1+_/p,n.abs(p)<h&&(p=h),m=1/m,E*=m*p,_=-(o+l)*(u+l)*a/((o+v)*(d+v)),m=1+_*m,n.abs(m)<h&&(m=h),p=1+_/p,n.abs(p)<h&&(p=h),m=1/m,x=m*p,E*=x,!(n.abs(x-1)<3e-7));l++);return E},r.gammapinv=function(a,o){var c=0,h=o-1,l=1e-8,u=r.gammaln(o),d,f,p,m,v,_,x;if(a>=1)return n.max(100,o+100*n.sqrt(o));if(a<=0)return 0;for(o>1?(_=n.log(h),x=n.exp(h*(_-1)-u),v=a<.5?a:1-a,p=n.sqrt(-2*n.log(v)),d=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,a<.5&&(d=-d),d=n.max(.001,o*n.pow(1-1/(9*o)-d/(3*n.sqrt(o)),3))):(p=1-o*(.253+o*.12),a<p?d=n.pow(a/p,1/o):d=1-n.log(1-(a-p)/(1-p)));c<12;c++){if(d<=0)return 0;if(f=r.lowRegGamma(o,d)-a,o>1?p=x*n.exp(-(d-h)+h*(n.log(d)-_)):p=n.exp(-d+h*n.log(d)-u),m=f/p,d-=p=m/(1-.5*n.min(1,m*((o-1)/d-1))),d<=0&&(d=.5*(d+p)),n.abs(p)<l*d)break}return d},r.erf=function(a){var o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=o.length-1,h=!1,l=0,u=0,d,f,p,m;for(a<0&&(a=-a,h=!0),d=2/(2+a),f=4*d-2;c>0;c--)p=l,l=f*l-u+o[c],u=p;return m=d*n.exp(-a*a+.5*(o[0]+f*l)-u),h?m-1:1-m},r.erfc=function(a){return 1-r.erf(a)},r.erfcinv=function(a){var o=0,c,h,l,u;if(a>=2)return-100;if(a<=0)return 100;for(u=a<1?a:2-a,l=n.sqrt(-2*n.log(u/2)),c=-.70711*((2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l);o<2;o++)h=r.erfc(c)-u,c+=h/(1.1283791670955126*n.exp(-c*c)-c*h);return a<1?c:-c},r.ibetainv=function(a,o,c){var h=1e-8,l=o-1,u=c-1,d=0,f,p,m,v,_,x,E,C,y,b,T;if(a<=0)return 0;if(a>=1)return 1;for(o>=1&&c>=1?(m=a<.5?a:1-a,v=n.sqrt(-2*n.log(m)),E=(2.30753+v*.27061)/(1+v*(.99229+v*.04481))-v,a<.5&&(E=-E),C=(E*E-3)/6,y=2/(1/(2*o-1)+1/(2*c-1)),b=E*n.sqrt(C+y)/y-(1/(2*c-1)-1/(2*o-1))*(C+5/6-2/(3*y)),E=o/(o+c*n.exp(2*b))):(f=n.log(o/(o+c)),p=n.log(c/(o+c)),v=n.exp(o*f)/o,_=n.exp(c*p)/c,b=v+_,a<v/b?E=n.pow(o*b*a,1/o):E=1-n.pow(c*b*(1-a),1/c)),T=-r.gammaln(o)-r.gammaln(c)+r.gammaln(o+c);d<10;d++){if(E===0||E===1)return E;if(x=r.ibeta(E,o,c)-a,v=n.exp(l*n.log(E)+u*n.log(1-E)+T),_=x/v,E-=v=_/(1-.5*n.min(1,_*(l/E-u/(1-E)))),E<=0&&(E=.5*(E+v)),E>=1&&(E=.5*(E+v+1)),n.abs(v)<h*E&&d>0)break}return E},r.ibeta=function(a,o,c){var h=a===0||a===1?0:n.exp(r.gammaln(o+c)-r.gammaln(o)-r.gammaln(c)+o*n.log(a)+c*n.log(1-a));return a<0||a>1?!1:a<(o+1)/(o+c+2)?h*r.betacf(a,o,c)/o:1-h*r.betacf(1-a,c,o)/c},r.randn=function(a,o){var c,h,l,u,d;if(o||(o=a),a)return r.create(a,o,function(){return r.randn()});do c=r._random_fn(),h=1.7156*(r._random_fn()-.5),l=c-.449871,u=n.abs(h)+.386595,d=l*l+u*(.196*u-.25472*l);while(d>.27597&&(d>.27846||h*h>-4*n.log(c)*c*c));return h/c},r.randg=function(a,o,c){var h=a,l,u,d,f,p,m;if(c||(c=o),a||(a=1),o)return m=r.zeros(o,c),m.alter(function(){return r.randg(a)}),m;a<1&&(a+=1),l=a-1/3,u=1/n.sqrt(9*l);do{do p=r.randn(),f=1+u*p;while(f<=0);f=f*f*f,d=r._random_fn()}while(d>1-.331*n.pow(p,4)&&n.log(d)>.5*p*p+l*(1-f+n.log(f)));if(a==h)return l*f;do d=r._random_fn();while(d===0);return n.pow(d,1/h)*l*f},function(s){for(var a=0;a<s.length;a++)(function(o){r.fn[o]=function(){return r(r.map(this,function(c){return r[o](c)}))}})(s[a])}("gammaln gammafn factorial factorialln".split(" ")),function(s){for(var a=0;a<s.length;a++)(function(o){r.fn[o]=function(){return r(r[o].apply(null,arguments))}})(s[a])}("randn".split(" "))}(t,Math),function(r,n){(function(h){for(var l=0;l<h.length;l++)(function(u){r[u]=function d(f,p,m){return this instanceof d?(this._a=f,this._b=p,this._c=m,this):new d(f,p,m)},r.fn[u]=function(d,f,p){var m=r[u](d,f,p);return m.data=this,m},r[u].prototype.sample=function(d){var f=this._a,p=this._b,m=this._c;return d?r.alter(d,function(){return r[u].sample(f,p,m)}):r[u].sample(f,p,m)},function(d){for(var f=0;f<d.length;f++)(function(p){r[u].prototype[p]=function(m){var v=this._a,_=this._b,x=this._c;return!m&&m!==0&&(m=this.data),typeof m!="number"?r.fn.map.call(m,function(E){return r[u][p](E,v,_,x)}):r[u][p](m,v,_,x)}})(d[f])}("pdf cdf inv".split(" ")),function(d){for(var f=0;f<d.length;f++)(function(p){r[u].prototype[p]=function(){return r[u][p](this._a,this._b,this._c)}})(d[f])}("mean median mode variance".split(" "))})(h[l])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(l,u,d){return l>1||l<0?0:u==1&&d==1?1:u<512&&d<512?n.pow(l,u-1)*n.pow(1-l,d-1)/r.betafn(u,d):n.exp((u-1)*n.log(l)+(d-1)*n.log(1-l)-r.betaln(u,d))},cdf:function(l,u,d){return l>1||l<0?(l>1)*1:r.ibeta(l,u,d)},inv:function(l,u,d){return r.ibetainv(l,u,d)},mean:function(l,u){return l/(l+u)},median:function(l,u){return r.ibetainv(.5,l,u)},mode:function(l,u){return(l-1)/(l+u-2)},sample:function(l,u){var d=r.randg(l);return d/(d+r.randg(u))},variance:function(l,u){return l*u/(n.pow(l+u,2)*(l+u+1))}}),r.extend(r.centralF,{pdf:function(l,u,d){var f,p,m;return l<0?0:u<=2?l===0&&u<2?1/0:l===0&&u===2?1:1/r.betafn(u/2,d/2)*n.pow(u/d,u/2)*n.pow(l,u/2-1)*n.pow(1+u/d*l,-(u+d)/2):(f=u*l/(d+l*u),p=d/(d+l*u),m=u*p/2,m*r.binomial.pdf((u-2)/2,(u+d-2)/2,f))},cdf:function(l,u,d){return l<0?0:r.ibeta(u*l/(u*l+d),u/2,d/2)},inv:function(l,u,d){return d/(u*(1/r.ibetainv(l,u/2,d/2)-1))},mean:function(l,u){return u>2?u/(u-2):void 0},mode:function(l,u){return l>2?u*(l-2)/(l*(u+2)):void 0},sample:function(l,u){var d=r.randg(l/2)*2,f=r.randg(u/2)*2;return d/l/(f/u)},variance:function(l,u){if(!(u<=4))return 2*u*u*(l+u-2)/(l*(u-2)*(u-2)*(u-4))}}),r.extend(r.cauchy,{pdf:function(l,u,d){return d<0?0:d/(n.pow(l-u,2)+n.pow(d,2))/n.PI},cdf:function(l,u,d){return n.atan((l-u)/d)/n.PI+.5},inv:function(h,l,u){return l+u*n.tan(n.PI*(h-.5))},median:function(l){return l},mode:function(l){return l},sample:function(l,u){return r.randn()*n.sqrt(1/(2*r.randg(.5)))*u+l}}),r.extend(r.chisquare,{pdf:function(l,u){return l<0?0:l===0&&u===2?.5:n.exp((u/2-1)*n.log(l)-l/2-u/2*n.log(2)-r.gammaln(u/2))},cdf:function(l,u){return l<0?0:r.lowRegGamma(u/2,l/2)},inv:function(h,l){return 2*r.gammapinv(h,.5*l)},mean:function(h){return h},median:function(l){return l*n.pow(1-2/(9*l),3)},mode:function(l){return l-2>0?l-2:0},sample:function(l){return r.randg(l/2)*2},variance:function(l){return 2*l}}),r.extend(r.exponential,{pdf:function(l,u){return l<0?0:u*n.exp(-u*l)},cdf:function(l,u){return l<0?0:1-n.exp(-u*l)},inv:function(h,l){return-n.log(1-h)/l},mean:function(h){return 1/h},median:function(h){return 1/h*n.log(2)},mode:function(){return 0},sample:function(l){return-1/l*n.log(r._random_fn())},variance:function(h){return n.pow(h,-2)}}),r.extend(r.gamma,{pdf:function(l,u,d){return l<0?0:l===0&&u===1?1/d:n.exp((u-1)*n.log(l)-l/d-r.gammaln(u)-u*n.log(d))},cdf:function(l,u,d){return l<0?0:r.lowRegGamma(u,l/d)},inv:function(h,l,u){return r.gammapinv(h,l)*u},mean:function(h,l){return h*l},mode:function(l,u){if(l>1)return(l-1)*u},sample:function(l,u){return r.randg(l)*u},variance:function(l,u){return l*u*u}}),r.extend(r.invgamma,{pdf:function(l,u,d){return l<=0?0:n.exp(-(u+1)*n.log(l)-d/l-r.gammaln(u)+u*n.log(d))},cdf:function(l,u,d){return l<=0?0:1-r.lowRegGamma(u,d/l)},inv:function(h,l,u){return u/r.gammapinv(1-h,l)},mean:function(h,l){return h>1?l/(h-1):void 0},mode:function(l,u){return u/(l+1)},sample:function(l,u){return u/r.randg(l)},variance:function(l,u){if(!(l<=2))return u*u/((l-1)*(l-1)*(l-2))}}),r.extend(r.kumaraswamy,{pdf:function(l,u,d){return l===0&&u===1?d:l===1&&d===1?u:n.exp(n.log(u)+n.log(d)+(u-1)*n.log(l)+(d-1)*n.log(1-n.pow(l,u)))},cdf:function(l,u,d){return l<0?0:l>1?1:1-n.pow(1-n.pow(l,u),d)},inv:function(l,u,d){return n.pow(1-n.pow(1-l,1/d),1/u)},mean:function(h,l){return l*r.gammafn(1+1/h)*r.gammafn(l)/r.gammafn(1+1/h+l)},median:function(l,u){return n.pow(1-n.pow(2,-1/u),1/l)},mode:function(l,u){if(l>=1&&u>=1&&l!==1&&u!==1)return n.pow((l-1)/(l*u-1),1/l)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(l,u,d){return l<=0?0:n.exp(-n.log(l)-.5*n.log(2*n.PI)-n.log(d)-n.pow(n.log(l)-u,2)/(2*d*d))},cdf:function(l,u,d){return l<0?0:.5+.5*r.erf((n.log(l)-u)/n.sqrt(2*d*d))},inv:function(h,l,u){return n.exp(-1.4142135623730951*u*r.erfcinv(2*h)+l)},mean:function(l,u){return n.exp(l+u*u/2)},median:function(l){return n.exp(l)},mode:function(l,u){return n.exp(l-u*u)},sample:function(l,u){return n.exp(r.randn()*u+l)},variance:function(l,u){return(n.exp(u*u)-1)*n.exp(2*l+u*u)}}),r.extend(r.noncentralt,{pdf:function(l,u,d){var f=1e-14;return n.abs(d)<f?r.studentt.pdf(l,u):n.abs(l)<f?n.exp(r.gammaln((u+1)/2)-d*d/2-.5*n.log(n.PI*u)-r.gammaln(u/2)):u/l*(r.noncentralt.cdf(l*n.sqrt(1+2/u),u+2,d)-r.noncentralt.cdf(l,u,d))},cdf:function(l,u,d){var f=1e-14,p=200;if(n.abs(d)<f)return r.studentt.cdf(l,u);var m=!1;l<0&&(m=!0,d=-d);for(var v=r.normal.cdf(-d,0,1),_=f+1,x=_,E=l*l/(l*l+u),C=0,y=n.exp(-d*d/2),b=n.exp(-d*d/2-.5*n.log(2)-r.gammaln(3/2))*d;C<p||x>f||_>f;)x=_,C>0&&(y*=d*d/(2*C),b*=d*d/(2*(C+1/2))),_=y*r.beta.cdf(E,C+.5,u/2)+b*r.beta.cdf(E,C+1,u/2),v+=.5*_,C++;return m?1-v:v}}),r.extend(r.normal,{pdf:function(l,u,d){return n.exp(-.5*n.log(2*n.PI)-n.log(d)-n.pow(l-u,2)/(2*d*d))},cdf:function(l,u,d){return .5*(1+r.erf((l-u)/n.sqrt(2*d*d)))},inv:function(h,l,u){return-1.4142135623730951*u*r.erfcinv(2*h)+l},mean:function(h){return h},median:function(l){return l},mode:function(h){return h},sample:function(l,u){return r.randn()*u+l},variance:function(h,l){return l*l}}),r.extend(r.pareto,{pdf:function(l,u,d){return l<u?0:d*n.pow(u,d)/n.pow(l,d+1)},cdf:function(l,u,d){return l<u?0:1-n.pow(u/l,d)},inv:function(l,u,d){return u/n.pow(1-l,1/d)},mean:function(l,u){if(!(u<=1))return u*n.pow(l,u)/(u-1)},median:function(l,u){return l*(u*n.SQRT2)},mode:function(l){return l},variance:function(h,l){if(!(l<=2))return h*h*l/(n.pow(l-1,2)*(l-2))}}),r.extend(r.studentt,{pdf:function(l,u){return u=u>1e100?1e100:u,1/(n.sqrt(u)*r.betafn(.5,u/2))*n.pow(1+l*l/u,-((u+1)/2))},cdf:function(l,u){var d=u/2;return r.ibeta((l+n.sqrt(l*l+u))/(2*n.sqrt(l*l+u)),d,d)},inv:function(h,l){var u=r.ibetainv(2*n.min(h,1-h),.5*l,.5);return u=n.sqrt(l*(1-u)/u),h>.5?u:-u},mean:function(l){return l>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(l){return r.randn()*n.sqrt(l/(2*r.randg(l/2)))},variance:function(l){return l>2?l/(l-2):l>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(l,u,d){return l<0||u<0||d<0?0:d/u*n.pow(l/u,d-1)*n.exp(-n.pow(l/u,d))},cdf:function(l,u,d){return l<0?0:1-n.exp(-n.pow(l/u,d))},inv:function(h,l,u){return l*n.pow(-n.log(1-h),1/u)},mean:function(h,l){return h*r.gammafn(1+1/l)},median:function(l,u){return l*n.pow(n.log(2),1/u)},mode:function(l,u){return u<=1?0:l*n.pow((u-1)/u,1/u)},sample:function(l,u){return l*n.pow(-n.log(r._random_fn()),1/u)},variance:function(l,u){return l*l*r.gammafn(1+2/u)-n.pow(r.weibull.mean(l,u),2)}}),r.extend(r.uniform,{pdf:function(l,u,d){return l<u||l>d?0:1/(d-u)},cdf:function(l,u,d){return l<u?0:l<d?(l-u)/(d-u):1},inv:function(h,l,u){return l+h*(u-l)},mean:function(l,u){return .5*(l+u)},median:function(l,u){return r.mean(l,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,u){return l/2+u/2+(u/2-l/2)*(2*r._random_fn()-1)},variance:function(l,u){return n.pow(u-l,2)/12}});function s(h,l,u,d){for(var f=0,p=1,m=1,v=1,_=0,x=0,E;n.abs((m-x)/m)>d;)x=m,E=-(l+_)*(l+u+_)*h/(l+2*_)/(l+2*_+1),f=m+E*f,p=v+E*p,_=_+1,E=_*(u-_)*h/(l+2*_-1)/(l+2*_),m=f+E*m,v=p+E*v,f=f/v,p=p/v,m=m/v,v=1;return m/l}r.extend(r.binomial,{pdf:function(l,u,d){return d===0||d===1?u*d===l?1:0:r.combination(u,l)*n.pow(d,l)*n.pow(1-d,u-l)},cdf:function(l,u,d){var f,p=1e-10;if(l<0)return 0;if(l>=u)return 1;if(d<0||d>1||u<=0)return NaN;l=n.floor(l);var m=d,v=l+1,_=u-l,x=v+_,E=n.exp(r.gammaln(x)-r.gammaln(_)-r.gammaln(v)+v*n.log(m)+_*n.log(1-m));return m<(v+1)/(x+2)?f=E*s(m,v,_,p):f=1-E*s(1-m,_,v,p),n.round((1-f)*(1/p))/(1/p)}}),r.extend(r.negbin,{pdf:function(l,u,d){return l!==l>>>0?!1:l<0?0:r.combination(l+u-1,u-1)*n.pow(1-d,l)*n.pow(d,u)},cdf:function(l,u,d){var f=0,p=0;if(l<0)return 0;for(;p<=l;p++)f+=r.negbin.pdf(p,u,d);return f}}),r.extend(r.hypgeom,{pdf:function(l,u,d,f){if(l!==l|0)return!1;if(l<0||l<d-(u-f))return 0;if(l>f||l>d)return 0;if(d*2>u)return f*2>u?r.hypgeom.pdf(u-d-f+l,u,u-d,u-f):r.hypgeom.pdf(f-l,u,u-d,f);if(f*2>u)return r.hypgeom.pdf(d-l,u,d,u-f);if(d<f)return r.hypgeom.pdf(l,u,f,d);for(var p=1,m=0,v=0;v<l;v++){for(;p>1&&m<f;)p*=1-d/(u-m),m++;p*=(f-v)*(d-v)/((v+1)*(u-d-f+v+1))}for(;m<f;m++)p*=1-d/(u-m);return n.min(1,n.max(0,p))},cdf:function(l,u,d,f){if(l<0||l<d-(u-f))return 0;if(l>=f||l>=d)return 1;if(d*2>u)return f*2>u?r.hypgeom.cdf(u-d-f+l,u,u-d,u-f):1-r.hypgeom.cdf(f-l-1,u,u-d,f);if(f*2>u)return 1-r.hypgeom.cdf(d-l-1,u,d,u-f);if(d<f)return r.hypgeom.cdf(l,u,f,d);for(var p=1,m=1,v=0,_=0;_<l;_++){for(;p>1&&v<f;){var x=1-d/(u-v);m*=x,p*=x,v++}m*=(f-_)*(d-_)/((_+1)*(u-d-f+_+1)),p+=m}for(;v<f;v++)p*=1-d/(u-v);return n.min(1,n.max(0,p))}}),r.extend(r.poisson,{pdf:function(l,u){return u<0||l%1!==0||l<0?0:n.pow(u,l)*n.exp(-u)/r.factorial(l)},cdf:function(l,u){var d=[],f=0;if(l<0)return 0;for(;f<=l;f++)d.push(r.poisson.pdf(f,u));return r.sum(d)},mean:function(h){return h},variance:function(h){return h},sampleSmall:function(l){var u=1,d=0,f=n.exp(-l);do d++,u*=r._random_fn();while(u>f);return d-1},sampleLarge:function(l){var u=l,d,f,p,m,v,_,x,E,C,y;for(m=n.sqrt(u),v=n.log(u),x=.931+2.53*m,_=-.059+.02483*x,E=1.1239+1.1328/(x-3.4),C=.9277-3.6224/(x-2);;){if(f=n.random()-.5,p=n.random(),y=.5-n.abs(f),d=n.floor((2*_/y+x)*f+u+.43),y>=.07&&p<=C)return d;if(!(d<0||y<.013&&p>y)&&n.log(p)+n.log(E)-n.log(_/(y*y)+x)<=-u+d*v-r.loggam(d+1))return d}},sample:function(l){return l<10?this.sampleSmall(l):this.sampleLarge(l)}}),r.extend(r.triangular,{pdf:function(l,u,d,f){return d<=u||f<u||f>d?NaN:l<u||l>d?0:l<f?2*(l-u)/((d-u)*(f-u)):l===f?2/(d-u):2*(d-l)/((d-u)*(d-f))},cdf:function(l,u,d,f){return d<=u||f<u||f>d?NaN:l<=u?0:l>=d?1:l<=f?n.pow(l-u,2)/((d-u)*(f-u)):1-n.pow(d-l,2)/((d-u)*(d-f))},inv:function(l,u,d,f){return d<=u||f<u||f>d?NaN:l<=(f-u)/(d-u)?u+(d-u)*n.sqrt(l*((f-u)/(d-u))):u+(d-u)*(1-n.sqrt((1-l)*(1-(f-u)/(d-u))))},mean:function(l,u,d){return(l+u+d)/3},median:function(l,u,d){if(d<=(l+u)/2)return u-n.sqrt((u-l)*(u-d))/n.sqrt(2);if(d>(l+u)/2)return l+n.sqrt((u-l)*(d-l))/n.sqrt(2)},mode:function(l,u,d){return d},sample:function(l,u,d){var f=r._random_fn();return f<(d-l)/(u-l)?l+n.sqrt(f*(u-l)*(d-l)):u-n.sqrt((1-f)*(u-l)*(u-d))},variance:function(l,u,d){return(l*l+u*u+d*d-l*u-l*d-u*d)/18}}),r.extend(r.arcsine,{pdf:function(l,u,d){return d<=u?NaN:l<=u||l>=d?0:2/n.PI*n.pow(n.pow(d-u,2)-n.pow(2*l-u-d,2),-.5)},cdf:function(l,u,d){return l<u?0:l<d?2/n.PI*n.asin(n.sqrt((l-u)/(d-u))):1},inv:function(h,l,u){return l+(.5-.5*n.cos(n.PI*h))*(u-l)},mean:function(l,u){return u<=l?NaN:(l+u)/2},median:function(l,u){return u<=l?NaN:(l+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(l,u){return(l+u)/2+(u-l)/2*n.sin(2*n.PI*r.uniform.sample(0,1))},variance:function(l,u){return u<=l?NaN:n.pow(u-l,2)/8}});function a(h){return h/n.abs(h)}r.extend(r.laplace,{pdf:function(l,u,d){return d<=0?0:n.exp(-n.abs(l-u)/d)/(2*d)},cdf:function(l,u,d){return d<=0?0:l<u?.5*n.exp((l-u)/d):1-.5*n.exp(-(l-u)/d)},mean:function(h){return h},median:function(h){return h},mode:function(h){return h},variance:function(h,l){return 2*l*l},sample:function(l,u){var d=r._random_fn()-.5;return l-u*a(d)*n.log(1-2*n.abs(d))}});function o(h,l,u){var d=12,f=6,p=-30,m=-50,v=60,_=8,x=3,E=2,C=3,y=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],b=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],T=h*.5;if(T>=_)return 1;var R=2*r.normal.cdf(T,0,1,1,0)-1;R>=n.exp(m/u)?R=n.pow(R,u):R=0;var O;h>x?O=E:O=C;for(var W=T,G=(_-T)/O,Q=W+G,ne=0,xe=u-1,Ce=1;Ce<=O;Ce++){for(var Fe=0,ke=.5*(Q+W),Ze=.5*(Q-W),ie=1;ie<=d;ie++){var Ee,Pe;f<ie?(Ee=d-ie+1,Pe=y[Ee-1]):(Ee=ie,Pe=-y[Ee-1]);var U=Ze*Pe,Z=ke+U,q=Z*Z;if(q>v)break;var X=2*r.normal.cdf(Z,0,1,1,0),de=2*r.normal.cdf(Z,h,1,1,0),Ie=X*.5-de*.5;Ie>=n.exp(p/xe)&&(Ie=b[Ee-1]*n.exp(-(.5*q))*n.pow(Ie,xe),Fe+=Ie)}Fe*=2*Ze*u/n.sqrt(2*n.PI),ne+=Fe,W=Q,Q+=G}return R+=ne,R<=n.exp(p/l)?0:(R=n.pow(R,l),R>=1?1:R)}function c(h,l,u){var d=.322232421088,f=.099348462606,p=-1,m=.588581570495,v=-.342242088547,_=.531103462366,x=-.204231210125,E=.10353775285,C=-453642210148e-16,y=.0038560700634,b=.8832,T=.2368,R=1.208,O=1.4142,W=120,G=.5-.5*h,Q=n.sqrt(n.log(1/(G*G))),ne=Q+((((Q*C+x)*Q+v)*Q+p)*Q+d)/((((Q*y+E)*Q+_)*Q+m)*Q+f);u<W&&(ne+=(ne*ne*ne+ne)/u/4);var xe=b-T*ne;return u<W&&(xe+=-1.214/u+R*ne/u),ne*(xe*n.log(l-1)+O)}r.extend(r.tukey,{cdf:function(l,u,d){var f=1,p=u,m=16,v=8,_=-30,x=1e-14,E=100,C=800,y=5e3,b=25e3,T=1,R=.5,O=.25,W=.125,G=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],Q=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(l<=0)return 0;if(d<2||f<1||p<2)return NaN;if(!Number.isFinite(l))return 1;if(d>b)return o(l,f,p);var ne=d*.5,xe=ne*n.log(d)-d*n.log(2)-r.gammaln(ne),Ce=ne-1,Fe=d*.25,ke;d<=E?ke=T:d<=C?ke=R:d<=y?ke=O:ke=W,xe+=n.log(ke);for(var Ze=0,ie=1;ie<=50;ie++){for(var Ee=0,Pe=(2*ie-1)*ke,U=1;U<=m;U++){var Z,q;v<U?(Z=U-v-1,q=xe+Ce*n.log(Pe+G[Z]*ke)-(G[Z]*ke+Pe)*Fe):(Z=U-1,q=xe+Ce*n.log(Pe-G[Z]*ke)+(G[Z]*ke-Pe)*Fe);var X;if(q>=_){v<U?X=l*n.sqrt((G[Z]*ke+Pe)*.5):X=l*n.sqrt((-(G[Z]*ke)+Pe)*.5);var de=o(X,f,p),Ie=de*Q[Z]*n.exp(q);Ee+=Ie}}if(ie*ke>=1&&Ee<=x)break;Ze+=Ee}if(Ee>x)throw new Error("tukey.cdf failed to converge");return Ze>1&&(Ze=1),Ze},inv:function(h,l,u){var d=1,f=l,p=1e-4,m=50;if(u<2||d<1||f<2)return NaN;if(h<0||h>1)return NaN;if(h===0)return 0;if(h===1)return 1/0;var v=c(h,f,u),_=r.tukey.cdf(v,l,u)-h,x;_>0?x=n.max(0,v-1):x=v+1;for(var E=r.tukey.cdf(x,l,u)-h,C,y=1;y<m;y++){C=x-E*(x-v)/(E-_),_=E,v=x,C<0&&(C=0,E=-h),E=r.tukey.cdf(C,l,u)-h,x=C;var b=n.abs(x-v);if(b<p)return C}throw new Error("tukey.inv failed to converge")}})}(t,Math),function(r,n){var s=Array.prototype.push,a=r.utils.isArray;function o(c){return a(c)||c instanceof r}r.extend({add:function(h,l){return o(l)?(o(l[0])||(l=[l]),r.map(h,function(u,d,f){return u+l[d][f]})):r.map(h,function(u){return u+l})},subtract:function(h,l){return o(l)?(o(l[0])||(l=[l]),r.map(h,function(u,d,f){return u-l[d][f]||0})):r.map(h,function(u){return u-l})},divide:function(h,l){return o(l)?(o(l[0])||(l=[l]),r.multiply(h,r.inv(l))):r.map(h,function(u){return u/l})},multiply:function(h,l){var u,d,f,p,m,v,_,x;if(h.length===void 0&&l.length===void 0)return h*l;if(m=h.length,v=h[0].length,_=r.zeros(m,f=o(l)?l[0].length:v),x=0,o(l)){for(;x<f;x++)for(u=0;u<m;u++){for(p=0,d=0;d<v;d++)p+=h[u][d]*l[d][x];_[u][x]=p}return m===1&&x===1?_[0][0]:_}return r.map(h,function(E){return E*l})},outer:function(h,l){return r.multiply(h.map(function(u){return[u]}),[l])},dot:function(h,l){o(h[0])||(h=[h]),o(l[0])||(l=[l]);for(var u=h[0].length===1&&h.length!==1?r.transpose(h):h,d=l[0].length===1&&l.length!==1?r.transpose(l):l,f=[],p=0,m=u.length,v=u[0].length,_,x;p<m;p++){for(f[p]=[],_=0,x=0;x<v;x++)_+=u[p][x]*d[p][x];f[p]=_}return f.length===1?f[0]:f},pow:function(h,l){return r.map(h,function(u){return n.pow(u,l)})},exp:function(h){return r.map(h,function(l){return n.exp(l)})},log:function(h){return r.map(h,function(l){return n.log(l)})},abs:function(h){return r.map(h,function(l){return n.abs(l)})},norm:function(h,l){var u=0,d=0;for(isNaN(l)&&(l=2),o(h[0])&&(h=h[0]);d<h.length;d++)u+=n.pow(n.abs(h[d]),l);return n.pow(u,1/l)},angle:function(h,l){return n.acos(r.dot(h,l)/(r.norm(h)*r.norm(l)))},aug:function(h,l){var u=[],d;for(d=0;d<h.length;d++)u.push(h[d].slice());for(d=0;d<u.length;d++)s.apply(u[d],l[d]);return u},inv:function(h){for(var l=h.length,u=h[0].length,d=r.identity(l,u),f=r.gauss_jordan(h,d),p=[],m=0,v;m<l;m++)for(p[m]=[],v=u;v<f[0].length;v++)p[m][v-u]=f[m][v];return p},det:function c(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var l=0,u=0;u<h.length;u++){for(var d=[],f=1;f<h.length;f++){d[f-1]=[];for(var p=0;p<h.length;p++)p<u?d[f-1][p]=h[f][p]:p>u&&(d[f-1][p-1]=h[f][p])}var m=u%2?-1:1;l+=c(d)*h[0][u]*m}return l},gauss_elimination:function(h,l){var u=0,d=0,f=h.length,p=h[0].length,m=1,v=0,_=[],x,E,C,y;for(h=r.aug(h,l),x=h[0].length,u=0;u<f;u++){for(E=h[u][u],d=u,y=u+1;y<p;y++)E<n.abs(h[y][u])&&(E=h[y][u],d=y);if(d!=u)for(y=0;y<x;y++)C=h[u][y],h[u][y]=h[d][y],h[d][y]=C;for(d=u+1;d<f;d++)for(m=h[d][u]/h[u][u],y=u;y<x;y++)h[d][y]=h[d][y]-m*h[u][y]}for(u=f-1;u>=0;u--){for(v=0,d=u+1;d<=f-1;d++)v=v+_[d]*h[u][d];_[u]=(h[u][x-1]-v)/h[u][u]}return _},gauss_jordan:function(h,l){var u=r.aug(h,l),d=u.length,f=u[0].length,p=0,m,v,_;for(v=0;v<d;v++){var x=v;for(_=v+1;_<d;_++)n.abs(u[_][v])>n.abs(u[x][v])&&(x=_);var E=u[v];for(u[v]=u[x],u[x]=E,_=v+1;_<d;_++)for(p=u[_][v]/u[v][v],m=v;m<f;m++)u[_][m]-=u[v][m]*p}for(v=d-1;v>=0;v--){for(p=u[v][v],_=0;_<v;_++)for(m=f-1;m>v-1;m--)u[_][m]-=u[v][m]*u[_][v]/p;for(u[v][v]/=p,m=d;m<f;m++)u[v][m]/=p}return u},triaUpSolve:function(h,l){var u=h[0].length,d=r.zeros(1,u)[0],f,p=!1;return l[0].length!=null&&(l=l.map(function(m){return m[0]}),p=!0),r.arange(u-1,-1,-1).forEach(function(m){f=r.arange(m+1,u).map(function(v){return d[v]*h[m][v]}),d[m]=(l[m]-r.sum(f))/h[m][m]}),p?d.map(function(m){return[m]}):d},triaLowSolve:function(h,l){var u=h[0].length,d=r.zeros(1,u)[0],f,p=!1;return l[0].length!=null&&(l=l.map(function(m){return m[0]}),p=!0),r.arange(u).forEach(function(m){f=r.arange(m).map(function(v){return h[m][v]*d[v]}),d[m]=(l[m]-r.sum(f))/h[m][m]}),p?d.map(function(m){return[m]}):d},lu:function(h){var l=h.length,u=r.identity(l),d=r.zeros(h.length,h[0].length),f;return r.arange(l).forEach(function(p){d[0][p]=h[0][p]}),r.arange(1,l).forEach(function(p){r.arange(p).forEach(function(m){f=r.arange(m).map(function(v){return u[p][v]*d[v][m]}),u[p][m]=(h[p][m]-r.sum(f))/d[m][m]}),r.arange(p,l).forEach(function(m){f=r.arange(p).map(function(v){return u[p][v]*d[v][m]}),d[p][m]=h[f.length][m]-r.sum(f)})}),[u,d]},cholesky:function(h){var l=h.length,u=r.zeros(h.length,h[0].length),d;return r.arange(l).forEach(function(f){d=r.arange(f).map(function(p){return n.pow(u[f][p],2)}),u[f][f]=n.sqrt(h[f][f]-r.sum(d)),r.arange(f+1,l).forEach(function(p){d=r.arange(f).map(function(m){return u[f][m]*u[p][m]}),u[p][f]=(h[f][p]-r.sum(d))/u[f][f]})}),u},gauss_jacobi:function(h,l,u,d){for(var f=0,p=0,m=h.length,v=[],_=[],x=[],E,C,y,b;f<m;f++)for(v[f]=[],_[f]=[],x[f]=[],p=0;p<m;p++)f>p?(v[f][p]=h[f][p],_[f][p]=x[f][p]=0):f<p?(_[f][p]=h[f][p],v[f][p]=x[f][p]=0):(x[f][p]=h[f][p],v[f][p]=_[f][p]=0);for(y=r.multiply(r.multiply(r.inv(x),r.add(v,_)),-1),C=r.multiply(r.inv(x),l),E=u,b=r.add(r.multiply(y,u),C),f=2;n.abs(r.norm(r.subtract(b,E)))>d;)E=b,b=r.add(r.multiply(y,E),C),f++;return b},gauss_seidel:function(h,l,u,d){for(var f=0,p=h.length,m=[],v=[],_=[],x,E,C,y,b;f<p;f++)for(m[f]=[],v[f]=[],_[f]=[],x=0;x<p;x++)f>x?(m[f][x]=h[f][x],v[f][x]=_[f][x]=0):f<x?(v[f][x]=h[f][x],m[f][x]=_[f][x]=0):(_[f][x]=h[f][x],m[f][x]=v[f][x]=0);for(y=r.multiply(r.multiply(r.inv(r.add(_,m)),v),-1),C=r.multiply(r.inv(r.add(_,m)),l),E=u,b=r.add(r.multiply(y,u),C),f=2;n.abs(r.norm(r.subtract(b,E)))>d;)E=b,b=r.add(r.multiply(y,E),C),f=f+1;return b},SOR:function(h,l,u,d,f){for(var p=0,m=h.length,v=[],_=[],x=[],E,C,y,b,T;p<m;p++)for(v[p]=[],_[p]=[],x[p]=[],E=0;E<m;E++)p>E?(v[p][E]=h[p][E],_[p][E]=x[p][E]=0):p<E?(_[p][E]=h[p][E],v[p][E]=x[p][E]=0):(x[p][E]=h[p][E],v[p][E]=_[p][E]=0);for(b=r.multiply(r.inv(r.add(x,r.multiply(v,f))),r.subtract(r.multiply(x,1-f),r.multiply(_,f))),y=r.multiply(r.multiply(r.inv(r.add(x,r.multiply(v,f))),l),f),C=u,T=r.add(r.multiply(b,u),y),p=2;n.abs(r.norm(r.subtract(T,C)))>d;)C=T,T=r.add(r.multiply(b,C),y),p++;return T},householder:function(h){for(var l=h.length,u=h[0].length,d=0,f=[],p=[],m,v,_,x,E;d<l-1;d++){for(m=0,x=d+1;x<u;x++)m+=h[x][d]*h[x][d];for(E=h[d+1][d]>0?-1:1,m=E*n.sqrt(m),v=n.sqrt((m*m-h[d+1][d]*m)/2),f=r.zeros(l,1),f[d+1][0]=(h[d+1][d]-m)/(2*v),_=d+2;_<l;_++)f[_][0]=h[_][d]/(2*v);p=r.subtract(r.identity(l,u),r.multiply(r.multiply(f,r.transpose(f)),2)),h=r.multiply(p,r.multiply(h,p))}return h},QR:function(){var c=r.sum,h=r.arange;function l(u){var d=u.length,f=u[0].length,p=r.zeros(f,f);u=r.copy(u);var m,v,_;for(v=0;v<f;v++){for(p[v][v]=n.sqrt(c(h(d).map(function(x){return u[x][v]*u[x][v]}))),m=0;m<d;m++)u[m][v]=u[m][v]/p[v][v];for(_=v+1;_<f;_++)for(p[v][_]=c(h(d).map(function(x){return u[x][v]*u[x][_]})),m=0;m<d;m++)u[m][_]=u[m][_]-u[m][v]*p[v][_]}return[u,p]}return l}(),lstsq:function(){function c(l){l=r.copy(l);var u=l.length,d=r.identity(u);return r.arange(u-1,-1,-1).forEach(function(f){r.sliceAssign(d,{row:f},r.divide(r.slice(d,{row:f}),l[f][f])),r.sliceAssign(l,{row:f},r.divide(r.slice(l,{row:f}),l[f][f])),r.arange(f).forEach(function(p){var m=r.multiply(l[p][f],-1),v=r.slice(l,{row:p}),_=r.multiply(r.slice(l,{row:f}),m);r.sliceAssign(l,{row:p},r.add(v,_));var x=r.slice(d,{row:p}),E=r.multiply(r.slice(d,{row:f}),m);r.sliceAssign(d,{row:p},r.add(x,E))})}),d}function h(l,u){var d=!1;u[0].length===void 0&&(u=u.map(function(b){return[b]}),d=!0);var f=r.QR(l),p=f[0],m=f[1],v=l[0].length,_=r.slice(p,{col:{end:v}}),x=r.slice(m,{row:{end:v}}),E=c(x),C=r.transpose(_);C[0].length===void 0&&(C=[C]);var y=r.multiply(r.multiply(E,C),u);return y.length===void 0&&(y=[[y]]),d?y.map(function(b){return b[0]}):y}return h}(),jacobi:function(h){for(var l=1,u=h.length,d=r.identity(u,u),f=[],p,m,v,_,x,E,C,y;l===1;){for(E=h[0][1],_=0,x=1,m=0;m<u;m++)for(v=0;v<u;v++)m!=v&&E<n.abs(h[m][v])&&(E=n.abs(h[m][v]),_=m,x=v);for(h[_][_]===h[x][x]?C=h[_][x]>0?n.PI/4:-n.PI/4:C=n.atan(2*h[_][x]/(h[_][_]-h[x][x]))/2,y=r.identity(u,u),y[_][_]=n.cos(C),y[_][x]=-n.sin(C),y[x][_]=n.sin(C),y[x][x]=n.cos(C),d=r.multiply(d,y),p=r.multiply(r.multiply(r.inv(y),h),y),h=p,l=0,m=1;m<u;m++)for(v=1;v<u;v++)m!=v&&n.abs(h[m][v])>.001&&(l=1)}for(m=0;m<u;m++)f.push(h[m][m]);return[d,f]},rungekutta:function(h,l,u,d,f,p){var m,v,_,x,E;if(p===2)for(;d<=u;)m=l*h(d,f),v=l*h(d+l,f+m),_=f+(m+v)/2,f=_,d=d+l;if(p===4)for(;d<=u;)m=l*h(d,f),v=l*h(d+l/2,f+m/2),x=l*h(d+l/2,f+v/2),E=l*h(d+l,f+x),_=f+(m+2*v+2*x+E)/6,f=_,d=d+l;return f},romberg:function(h,l,u,d){for(var f=0,p=(u-l)/2,m=[],v=[],_=[],x,E,C,y,b;f<d/2;){for(b=h(l),C=l,y=0;C<=u;C=C+p,y++)m[y]=C;for(x=m.length,C=1;C<x-1;C++)b+=(C%2!==0?4:2)*h(m[C]);b=p/3*(b+h(u)),_[f]=b,p/=2,f++}for(E=_.length,x=1;E!==1;){for(C=0;C<E-1;C++)v[C]=(n.pow(4,x)*_[C+1]-_[C])/(n.pow(4,x)-1);E=v.length,_=v,v=[],x++}return _},richardson:function(h,l,u,d){function f(T,R){for(var O=0,W=T.length,G;O<W;O++)T[O]===R&&(G=O);return G}for(var p=n.abs(u-h[f(h,u)+1]),m=0,v=[],_=[],x,E,C,y,b;d>=p;)x=f(h,u+d),E=f(h,u),v[m]=(l[x]-2*l[E]+l[2*E-x])/(d*d),d/=2,m++;for(y=v.length,C=1;y!=1;){for(b=0;b<y-1;b++)_[b]=(n.pow(4,C)*v[b+1]-v[b])/(n.pow(4,C)-1);y=_.length,v=_,_=[],C++}return v},simpson:function(h,l,u,d){for(var f=(u-l)/d,p=h(l),m=[],v=l,_=0,x=1,E;v<=u;v=v+f,_++)m[_]=v;for(E=m.length;x<E-1;x++)p+=(x%2!==0?4:2)*h(m[x]);return f/3*(p+h(u))},hermite:function(h,l,u,d){for(var f=h.length,p=0,m=0,v=[],_=[],x=[],E=[],C;m<f;m++){for(v[m]=1,C=0;C<f;C++)m!=C&&(v[m]*=(d-h[C])/(h[m]-h[C]));for(_[m]=0,C=0;C<f;C++)m!=C&&(_[m]+=1/(h[m]-h[C]));x[m]=(1-2*(d-h[m])*_[m])*(v[m]*v[m]),E[m]=(d-h[m])*(v[m]*v[m]),p+=x[m]*l[m]+E[m]*u[m]}return p},lagrange:function(h,l,u){for(var d=0,f=0,p,m,v=h.length;f<v;f++){for(m=l[f],p=0;p<v;p++)f!=p&&(m*=(u-h[p])/(h[f]-h[p]));d+=m}return d},cubic_spline:function(h,l,u){for(var d=h.length,f=0,p,m=[],v=[],_=[],x=[],E=[],C=[],y=[];f<d-1;f++)E[f]=h[f+1]-h[f];for(_[0]=0,f=1;f<d-1;f++)_[f]=3/E[f]*(l[f+1]-l[f])-3/E[f-1]*(l[f]-l[f-1]);for(f=1;f<d-1;f++)m[f]=[],v[f]=[],m[f][f-1]=E[f-1],m[f][f]=2*(E[f-1]+E[f]),m[f][f+1]=E[f],v[f][0]=_[f];for(x=r.multiply(r.inv(m),v),p=0;p<d-1;p++)C[p]=(l[p+1]-l[p])/E[p]-E[p]*(x[p+1][0]+2*x[p][0])/3,y[p]=(x[p+1][0]-x[p][0])/(3*E[p]);for(p=0;p<d&&!(h[p]>u);p++);return p-=1,l[p]+(u-h[p])*C[p]+r.sq(u-h[p])*x[p]+(u-h[p])*r.sq(u-h[p])*y[p]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(h){var l=h.length,u=h[0].length,d=0,f,p,m=[],v=[],_=[],x=[],E=[],C=[],y=[],b=[],T=[],R=[];for(d=0;d<l;d++)m[d]=r.sum(h[d])/u;for(d=0;d<u;d++)for(y[d]=[],f=0;f<l;f++)y[d][f]=h[f][d]-m[f];for(y=r.transpose(y),d=0;d<l;d++)for(b[d]=[],f=0;f<l;f++)b[d][f]=r.dot([y[d]],[y[f]])/(u-1);for(_=r.jacobi(b),T=_[0],v=_[1],R=r.transpose(T),d=0;d<v.length;d++)for(f=d;f<v.length;f++)v[d]<v[f]&&(p=v[d],v[d]=v[f],v[f]=p,x=R[d],R[d]=R[f],R[f]=x);for(C=r.transpose(y),d=0;d<l;d++)for(E[d]=[],f=0;f<C.length;f++)E[d][f]=r.dot([R[d]],[C[f]]);return[h,v,R,E]}}),function(c){for(var h=0;h<c.length;h++)(function(l){r.fn[l]=function(u,d){var f=this;return d?(setTimeout(function(){d.call(f,r.fn[l].call(f,u))},15),this):typeof r[l](this,u)=="number"?r[l](this,u):r(r[l](this,u))}})(c[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(r,n){var s=[].slice,a=r.utils.isNumber,o=r.utils.isArray;r.extend({zscore:function(){var l=s.call(arguments);return a(l[1])?(l[0]-l[1])/l[2]:(l[0]-r.mean(l[1]))/r.stdev(l[1],l[2])},ztest:function(){var l=s.call(arguments),u;return o(l[1])?(u=r.zscore(l[0],l[1],l[3]),l[2]===1?r.normal.cdf(-n.abs(u),0,1):r.normal.cdf(-n.abs(u),0,1)*2):l.length>2?(u=r.zscore(l[0],l[1],l[2]),l[3]===1?r.normal.cdf(-n.abs(u),0,1):r.normal.cdf(-n.abs(u),0,1)*2):(u=l[0],l[1]===1?r.normal.cdf(-n.abs(u),0,1):r.normal.cdf(-n.abs(u),0,1)*2)}}),r.extend(r.fn,{zscore:function(l,u){return(l-this.mean())/this.stdev(u)},ztest:function(l,u,d){var f=n.abs(this.zscore(l,d));return u===1?r.normal.cdf(-f,0,1):r.normal.cdf(-f,0,1)*2}}),r.extend({tscore:function(){var l=s.call(arguments);return l.length===4?(l[0]-l[1])/(l[2]/n.sqrt(l[3])):(l[0]-r.mean(l[1]))/(r.stdev(l[1],!0)/n.sqrt(l[1].length))},ttest:function(){var l=s.call(arguments),u;return l.length===5?(u=n.abs(r.tscore(l[0],l[1],l[2],l[3])),l[4]===1?r.studentt.cdf(-u,l[3]-1):r.studentt.cdf(-u,l[3]-1)*2):a(l[1])?(u=n.abs(l[0]),l[2]==1?r.studentt.cdf(-u,l[1]-1):r.studentt.cdf(-u,l[1]-1)*2):(u=n.abs(r.tscore(l[0],l[1])),l[2]==1?r.studentt.cdf(-u,l[1].length-1):r.studentt.cdf(-u,l[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(l){return(l-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(l,u){return u===1?1-r.studentt.cdf(n.abs(this.tscore(l)),this.cols()-1):r.studentt.cdf(-n.abs(this.tscore(l)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var l=s.call(arguments),u,d,f,p,m,v,_,x;if(l.length===1){for(m=new Array(l[0].length),_=0;_<l[0].length;_++)m[_]=l[0][_];l=m}for(d=new Array,_=0;_<l.length;_++)d=d.concat(l[_]);for(f=r.mean(d),u=0,_=0;_<l.length;_++)u=u+l[_].length*n.pow(r.mean(l[_])-f,2);for(u/=l.length-1,v=0,_=0;_<l.length;_++)for(p=r.mean(l[_]),x=0;x<l[_].length;x++)v+=n.pow(l[_][x]-p,2);return v/=d.length-l.length,u/v},anovaftest:function(){var l=s.call(arguments),u,d,f,p;if(a(l[0]))return 1-r.centralF.cdf(l[0],l[1],l[2]);var m=r.anovafscore(l);for(u=l.length-1,f=0,p=0;p<l.length;p++)f=f+l[p].length;return d=f-u-1,1-r.centralF.cdf(m,u,d)},ftest:function(l,u,d){return 1-r.centralF.cdf(l,u,d)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var l=0,u;for(u=0;u<this.length;u++)l=l+this[u].length;return r.ftest(this.anovafscore(),this.length-1,l-this.length)}}),r.extend({qscore:function(){var l=s.call(arguments),u,d,f,p,m;return a(l[0])?(u=l[0],d=l[1],f=l[2],p=l[3],m=l[4]):(u=r.mean(l[0]),d=r.mean(l[1]),f=l[0].length,p=l[1].length,m=l[2]),n.abs(u-d)/(m*n.sqrt((1/f+1/p)/2))},qtest:function(){var l=s.call(arguments),u;l.length===3?(u=l[0],l=l.slice(1)):l.length===7?(u=r.qscore(l[0],l[1],l[2],l[3],l[4]),l=l.slice(5)):(u=r.qscore(l[0],l[1],l[2]),l=l.slice(3));var d=l[0],f=l[1];return 1-r.tukey.cdf(u,f,d-f)},tukeyhsd:function(l){for(var u=r.pooledstdev(l),d=l.map(function(x){return r.mean(x)}),f=l.reduce(function(x,E){return x+E.length},0),p=[],m=0;m<l.length;++m)for(var v=m+1;v<l.length;++v){var _=r.qtest(d[m],d[v],l[m].length,l[v].length,u,f,l.length);p.push([[m,v],_])}return p}}),r.extend({normalci:function(){var l=s.call(arguments),u=new Array(2),d;return l.length===4?d=n.abs(r.normal.inv(l[1]/2,0,1)*l[2]/n.sqrt(l[3])):d=n.abs(r.normal.inv(l[1]/2,0,1)*r.stdev(l[2])/n.sqrt(l[2].length)),u[0]=l[0]-d,u[1]=l[0]+d,u},tci:function(){var l=s.call(arguments),u=new Array(2),d;return l.length===4?d=n.abs(r.studentt.inv(l[1]/2,l[3]-1)*l[2]/n.sqrt(l[3])):d=n.abs(r.studentt.inv(l[1]/2,l[2].length-1)*r.stdev(l[2],!0)/n.sqrt(l[2].length)),u[0]=l[0]-d,u[1]=l[0]+d,u},significant:function(l,u){return l<u}}),r.extend(r.fn,{normalci:function(l,u){return r.normalci(l,u,this.toArray())},tci:function(l,u){return r.tci(l,u,this.toArray())}});function c(h,l,u,d){if(h>1||u>1||h<=0||u<=0)throw new Error("Proportions should be greater than 0 and less than 1");var f=(h*l+u*d)/(l+d),p=n.sqrt(f*(1-f)*(1/l+1/d));return(h-u)/p}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(l,u,d,f){var p=c(l,u,d,f);return r.ztest(p,1)},twoSidedDifferenceOfProportions:function(l,u,d,f){var p=c(l,u,d,f);return r.ztest(p,2)}})}(t,Math),t.models=function(){function r(c){var h=c[0].length,l=t.arange(h).map(function(u){var d=t.arange(h).filter(function(f){return f!==u});return n(t.col(c,u).map(function(f){return f[0]}),t.col(c,d))});return l}function n(c,h){var l=c.length,u=h[0].length-1,d=l-u-1,f=t.lstsq(h,c),p=t.multiply(h,f.map(function(y){return[y]})).map(function(y){return y[0]}),m=t.subtract(c,p),v=t.mean(c),_=t.sum(p.map(function(y){return Math.pow(y-v,2)})),x=t.sum(c.map(function(y,b){return Math.pow(y-p[b],2)})),E=_+x,C=_/E;return{exog:h,endog:c,nobs:l,df_model:u,df_resid:d,coef:f,predict:p,resid:m,ybar:v,SST:E,SSE:_,SSR:x,R2:C}}function s(c){var h=r(c.exog),l=Math.sqrt(c.SSR/c.df_resid),u=h.map(function(v){var _=v.SST,x=v.R2;return l/Math.sqrt(_*(1-x))}),d=c.coef.map(function(v,_){return(v-0)/u[_]}),f=d.map(function(v){var _=t.studentt.cdf(v,c.df_resid);return(_>.5?1-_:_)*2}),p=t.studentt.inv(.975,c.df_resid),m=c.coef.map(function(v,_){var x=p*u[_];return[v-x,v+x]});return{se:u,t:d,p:f,sigmaHat:l,interval95:m}}function a(c){var h=c.R2/c.df_model/((1-c.R2)/c.df_resid),l=function(d,f,p){return t.beta.cdf(d/(p/f+d),f/2,p/2)},u=1-l(h,c.df_model,c.df_resid);return{F_statistic:h,pvalue:u}}function o(c,h){var l=n(c,h),u=s(l),d=a(l),f=1-(1-l.R2)*((l.nobs-1)/l.df_resid);return l.t=u,l.f=d,l.adjust_R2=f,l}return{ols:o}}(),t.extend({buildxmatrix:function(){for(var n=new Array(arguments.length),s=0;s<arguments.length;s++){var a=[1];n[s]=a.concat(arguments[s])}return t(n)},builddxmatrix:function(){for(var n=new Array(arguments[0].length),s=0;s<arguments[0].length;s++){var a=[1];n[s]=a.concat(arguments[0][s])}return t(n)},buildjxmatrix:function(n){for(var s=new Array(n.length),a=0;a<n.length;a++)s[a]=n[a];return t.builddxmatrix(s)},buildymatrix:function(n){return t(n).transpose()},buildjymatrix:function(n){return n.transpose()},matrixmult:function(n,s){var a,o,c,h,l;if(n.cols()==s.rows()){if(s.rows()>1){for(h=[],a=0;a<n.rows();a++)for(h[a]=[],o=0;o<s.cols();o++){for(l=0,c=0;c<n.cols();c++)l+=n.toArray()[a][c]*s.toArray()[c][o];h[a][o]=l}return t(h)}for(h=[],a=0;a<n.rows();a++)for(h[a]=[],o=0;o<s.cols();o++){for(l=0,c=0;c<n.cols();c++)l+=n.toArray()[a][c]*s.toArray()[o];h[a][o]=l}return t(h)}},regress:function(n,s){var a=t.xtranspxinv(n),o=n.transpose(),c=t.matrixmult(t(a),o);return t.matrixmult(c,s)},regresst:function(n,s,a){var o=t.regress(n,s),c={};c.anova={};var h=t.jMatYBar(n,o);c.yBar=h;var l=s.mean();c.anova.residuals=t.residuals(s,h),c.anova.ssr=t.ssr(h,l),c.anova.msr=c.anova.ssr/(n[0].length-1),c.anova.sse=t.sse(s,h),c.anova.mse=c.anova.sse/(s.length-(n[0].length-1)-1),c.anova.sst=t.sst(s,l),c.anova.mst=c.anova.sst/(s.length-1),c.anova.r2=1-c.anova.sse/c.anova.sst,c.anova.r2<0&&(c.anova.r2=0),c.anova.fratio=c.anova.msr/c.anova.mse,c.anova.pvalue=t.anovaftest(c.anova.fratio,n[0].length-1,s.length-(n[0].length-1)-1),c.anova.rmse=Math.sqrt(c.anova.mse),c.anova.r2adj=1-c.anova.mse/c.anova.mst,c.anova.r2adj<0&&(c.anova.r2adj=0),c.stats=new Array(n[0].length);for(var u=t.xtranspxinv(n),d,f,p,m=0;m<o.length;m++)d=Math.sqrt(c.anova.mse*Math.abs(u[m][m])),f=Math.abs(o[m]/d),p=t.ttest(f,s.length-n[0].length-1,a),c.stats[m]=[o[m],d,f,p];return c.regress=o,c},xtranspx:function(n){return t.matrixmult(n.transpose(),n)},xtranspxinv:function(n){var s=t.matrixmult(n.transpose(),n),a=t.inv(s);return a},jMatYBar:function(n,s){var a=t.matrixmult(n,s);return new t(a)},residuals:function(n,s){return t.matrixsubtract(n,s)},ssr:function(n,s){for(var a=0,o=0;o<n.length;o++)a+=Math.pow(n[o]-s,2);return a},sse:function(n,s){for(var a=0,o=0;o<n.length;o++)a+=Math.pow(n[o]-s[o],2);return a},sst:function(n,s){for(var a=0,o=0;o<n.length;o++)a+=Math.pow(n[o]-s,2);return a},matrixsubtract:function(n,s){for(var a=new Array(n.length),o=0;o<n.length;o++){a[o]=new Array(n[o].length);for(var c=0;c<n[o].length;c++)a[o][c]=n[o][c]-s[o][c]}return t(a)}}),t.jStat=t,t})})(qg);var yy=qg.exports;const $e=Rd(yy);var Kg={};(function(i){(function(e){e(typeof DO_NOT_EXPORT_BESSEL>"u"?i:{})})(function(e){e.version="1.0.2";var t=Math;function r(l,u){for(var d=0,f=0;d<l.length;++d)f=u*f+l[d];return f}function n(l,u,d,f,p){if(u===0)return d;if(u===1)return f;for(var m=2/l,v=f,_=1;_<u;++_)v=f*_*m+p*d,d=f,f=v;return v}function s(l,u,d,f,p){return function(v,_){if(f){if(v===0)return f==1?-1/0:1/0;if(v<0)return NaN}if(_===0)return l(v);if(_===1)return u(v);if(_<0)return NaN;_|=0;var x=l(v),E=u(v);return n(v,_,x,E,p)}}var a=function(){var l=.636619772,u=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),d=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),p=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function m(y){var b=0,T=0,R=0,O=y*y;if(y<8)T=r(u,O),R=r(d,O),b=T/R;else{var W=y-.785398164;O=64/O,T=r(f,O),R=r(p,O),b=t.sqrt(l/y)*(t.cos(W)*T-t.sin(W)*R*8/y)}return b}var v=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),_=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),x=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function C(y){var b=0,T=0,R=0,O=y*y,W=t.abs(y)-2.356194491;return Math.abs(y)<8?(T=y*r(v,O),R=r(_,O),b=T/R):(O=64/O,T=r(x,O),R=r(E,O),b=t.sqrt(l/t.abs(y))*(t.cos(W)*T-t.sin(W)*R*8/t.abs(y)),y<0&&(b=-b)),b}return function y(b,T){if(T=Math.round(T),!isFinite(b))return isNaN(b)?b:0;if(T<0)return(T%2?-1:1)*y(b,-T);if(b<0)return(T%2?-1:1)*y(-b,T);if(T===0)return m(b);if(T===1)return C(b);if(b===0)return 0;var R=0;if(b>T)R=n(b,T,m(b),C(b),-1);else{for(var O=2*t.floor((T+t.floor(t.sqrt(40*T)))/2),W=!1,G=0,Q=0,ne=1,xe=0,Ce=2/b,Fe=O;Fe>0;Fe--)xe=Fe*Ce*ne-G,G=ne,ne=xe,t.abs(ne)>1e10&&(ne*=1e-10,G*=1e-10,R*=1e-10,Q*=1e-10),W&&(Q+=ne),W=!W,Fe==T&&(R=G);Q=2*Q-ne,R/=Q}return R}}(),o=function(){var l=.636619772,u=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),d=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),f=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),p=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function m(y){var b=0,T=0,R=0,O=y*y,W=y-.785398164;return y<8?(T=r(u,O),R=r(d,O),b=T/R+l*a(y,0)*t.log(y)):(O=64/O,T=r(f,O),R=r(p,O),b=t.sqrt(l/y)*(t.sin(W)*T+t.cos(W)*R*8/y)),b}var v=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),_=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),x=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function C(y){var b=0,T=0,R=0,O=y*y,W=y-2.356194491;return y<8?(T=y*r(v,O),R=r(_,O),b=T/R+l*(a(y,1)*t.log(y)-1/y)):(O=64/O,T=r(x,O),R=r(E,O),b=t.sqrt(l/y)*(t.sin(W)*T+t.cos(W)*R*8/y)),b}return s(m,C,"BESSELY",1,-1)}(),c=function(){var l=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),u=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function d(v){return v<=3.75?r(l,v*v/(3.75*3.75)):t.exp(t.abs(v))/t.sqrt(t.abs(v))*r(u,3.75/t.abs(v))}var f=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),p=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function m(v){return v<3.75?v*r(f,v*v/(3.75*3.75)):(v<0?-1:1)*t.exp(t.abs(v))/t.sqrt(t.abs(v))*r(p,3.75/t.abs(v))}return function v(_,x){if(x=Math.round(x),x===0)return d(_);if(x===1)return m(_);if(x<0)return NaN;if(t.abs(_)===0)return 0;if(_==1/0)return 1/0;var E=0,C,y=2/t.abs(_),b=0,T=1,R=0,O=2*t.round((x+t.round(t.sqrt(40*x)))/2);for(C=O;C>0;C--)R=C*y*T+b,b=T,T=R,t.abs(T)>1e10&&(T*=1e-10,b*=1e-10,E*=1e-10),C==x&&(E=b);return E*=v(_,0)/T,_<0&&x%2?-E:E}}(),h=function(){var l=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),u=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function d(v){return v<=2?-t.log(v/2)*c(v,0)+r(l,v*v/4):t.exp(-v)/t.sqrt(v)*r(u,2/v)}var f=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),p=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function m(v){return v<=2?t.log(v/2)*c(v,1)+1/v*r(f,v*v/4):t.exp(-v)/t.sqrt(v)*r(p,2/v)}return s(d,m,"BESSELK",2,1)}();e.besselj=a,e.bessely=o,e.besseli=c,e.besselk=h})})(Kg);const Ch=Rd(Kg),Gd=new Error("#NULL!"),xr=new Error("#DIV/0!"),j=new Error("#VALUE!"),oo=new Error("#REF!"),yh=new Error("#NAME?"),le=new Error("#NUM!"),Je=new Error("#N/A"),$d=new Error("#ERROR!"),jg=new Error("#GETTING_DATA");var Sy=Object.freeze({__proto__:null,data:jg,div0:xr,error:$d,na:Je,name:yh,nil:Gd,num:le,ref:oo,value:j});const by="=",Ty=[">",">=","<","<=","=","<>"],Qg="operator",Zg="literal",Ay=[Qg,Zg],Ic=Qg,Gs=Zg;function cs(i,e){if(Ay.indexOf(e)===-1)throw new Error("Unsupported token type: "+e);return{value:i,type:e}}function ky(i){return typeof i!="string"||/^\d+(\.\d+)?$/.test(i)&&(i=i.indexOf(".")===-1?parseInt(i,10):parseFloat(i)),i}function Oy(i){const e=i.length,t=[];let r=0,n="",s="";for(;r<e;){const a=i.charAt(r);switch(a){case">":case"<":case"=":s=s+a,n.length>0&&(t.push(n),n="");break;default:s.length>0&&(t.push(s),s=""),n=n+a;break}r++}return n.length>0&&t.push(n),s.length>0&&t.push(s),t}function Iy(i){let e="";const t=[];for(let r=0;r<i.length;r++){const n=i[r];r===0&&Ty.indexOf(n)>=0?t.push(cs(n,Ic)):e+=n}return e.length>0&&t.push(cs(ky(e),Gs)),t.length>0&&t[0].type!==Ic&&t.unshift(cs(by,Ic)),t}function Ry(i){const e=[];let t;for(let r=0;r<i.length;r++){const n=i[r];switch(n.type){case Ic:t=n.value;break;case Gs:e.push(n.value);break}}return Dy(e,t)}function Dy(i,e){let t=!1;switch(e){case">":t=i[0]>i[1];break;case">=":t=i[0]>=i[1];break;case"<":t=i[0]<i[1];break;case"<=":t=i[0]<=i[1];break;case"=":t=i[0]==i[1];break;case"<>":t=i[0]!=i[1];break}return t}function fo(i){return Iy(Oy(i))}const po=Ry;function Sh(i){const e=[];return _r(i,t=>{e.push(t)}),e}function _r(i,e){let t=-1;const r=i.length;for(;++t<r&&e(i[t],t,i)!==!1;);return i}function Yd(i){let e=i.length,t;for(;e--;)if(t=i[e],typeof t!="number"){if(t===!0){i[e]=1;continue}if(t===!1){i[e]=0;continue}if(typeof t=="string"){const r=I(t);i[e]=r instanceof Error?0:r}}return i}function Jg(i,e){if(!i)return j;(!i.every(n=>Array.isArray(n))||i.length===0)&&(i=[[...i]]),i.map((n,s)=>{n.map((a,o)=>{a||(i[s][o]=0)})});const t=i.reduce((n,s,a)=>s.length>i[n].length?a:n,0),r=i[t].length;return i.map(n=>[...n,...Array(r-n.length).fill(0)])}function Ae(){let i;if(arguments.length===1){const e=arguments[0];i=Py(e)?Sh.apply(null,arguments):[e]}else i=Array.from(arguments);for(;!Ny(i);)i=md(i);return i}function md(i){return!i||!i.reduce?[i]:i.reduce((e,t)=>{const r=Array.isArray(e),n=Array.isArray(t);return r&&n?e.concat(t):r?(e.push(t),e):n?[e].concat(t):[e,t]})}function Fy(i,e){return e=e||1,!i||typeof i.slice!="function"?i:i.slice(0,i.length-e)}function Py(i){return i!=null&&typeof i.length=="number"&&typeof i!="string"}function Ny(i){if(!i)return!1;for(let e=0;e<i.length;++e)if(Array.isArray(i[e]))return!1;return!0}function ui(i,e){return e=e||1,!i||typeof i.slice!="function"?i:i.slice(e)}function Yc(i){return i?i[0].map((e,t)=>i.map(r=>r[t])):j}function En(i,e){let t=null;return _r(i,(r,n)=>{if(r[0]===e)return t=n,!1}),t??j}function St(){for(let i=0;i<arguments.length;i++)if(arguments[i]instanceof Error)return arguments[i]}function me(){let i=arguments.length;for(;i--;)if(arguments[i]instanceof Error)return!0;return!1}function ev(i){return Math.round(i*1e14)/1e14}function ba(){return Ae.apply(null,arguments).filter(e=>typeof e=="number")}function My(i){i<60&&(i+=1);const t=Math.floor(i-25569)*86400,r=new Date(t*1e3),n=i-Math.floor(i)+1e-7;let s=Math.floor(86400*n);const a=s%60;s-=a;const o=Math.floor(s/(60*60)),c=Math.floor(s/60)%60;let h=r.getUTCDate(),l=r.getUTCMonth();return i>=60&&i<61&&(h=29,l=1),new Date(r.getUTCFullYear(),l,h,o,c,a)}function Xd(i){if(typeof i=="boolean"||i instanceof Error)return i;if(typeof i=="number")return i!==0;if(typeof i=="string"){const e=i.toUpperCase();if(e==="TRUE")return!0;if(e==="FALSE")return!1}return i instanceof Date&&!isNaN(i)?!0:j}function kt(i){if(!isNaN(i)){if(i instanceof Date)return new Date(i);const e=parseFloat(i);return e<0||e>=2958466?le:My(e)}return typeof i=="string"&&(i=/(\d{4})-(\d\d?)-(\d\d?)$/.test(i)?new Date(i+"T00:00:00.000"):new Date(i),!isNaN(i))?i:j}function tv(i){let e=i.length,t;for(;e--;){if(t=kt(i[e]),t===j)return t;i[e]=t}return i}function I(i){return i instanceof Error?i:i==null?0:(typeof i=="boolean"&&(i=+i),!isNaN(i)&&i!==""?parseFloat(i):j)}function Ye(i){let e;if(!i||(e=i.length)===0)return j;let t;for(;e--;){if(i[e]instanceof Error)return i[e];if(t=I(i[e]),t instanceof Error)return t;i[e]=t}return i}function ki(i){return i instanceof Error?i:i==null?"":i.toString()}function bh(){let i=arguments.length;for(;i--;)if(typeof arguments[i]=="string")return!0;return!1}function Th(){const i=Sh(arguments),e=Ye(Ae(i.shift()));if(e instanceof Error)return e;const t=i,r=t.length/2;for(let s=0;s<r;s++)t[s*2]=Ae(t[s*2]);let n=[];for(let s=0;s<e.length;s++){let a=!1;for(let o=0;o<r;o++){const c=t[o*2][s],h=t[o*2+1],l=h===void 0||h==="*";let u=!1;if(l)u=!0;else{const d=fo(h+""),f=[cs(c,Gs)].concat(d);u=po(f)}if(!u){a=!1;break}a=!0}a&&n.push(e[s])}return n}function mo(i){return i!=null}function Ly(){throw new Error("CELL is not implemented")}const iv={};iv.TYPE=i=>{switch(i){case Gd:return 1;case xr:return 2;case j:return 3;case oo:return 4;case yh:return 5;case le:return 6;case Je:return 7;case jg:return 8}return Je};function By(){throw new Error("INFO is not implemented")}function Hy(i){return i===null}function rv(i){return[j,oo,xr,le,yh,Gd].indexOf(i)>=0||typeof i=="number"&&(isNaN(i)||!isFinite(i))}function Ah(i){return rv(i)||i===Je}function Vy(i){return!(Math.floor(Math.abs(i))&1)}function Uy(){throw new Error("ISFORMULA is not implemented")}function nv(i){return i===!0||i===!1}function Wy(i){return i===Je}function zy(i){return typeof i!="string"}function kh(i){return typeof i=="number"&&!isNaN(i)&&isFinite(i)}function Gy(i){return!!(Math.floor(Math.abs(i))&1)}function $y(){throw new Error("ISREF is not implemented")}function sv(i){return typeof i=="string"}function Yy(i){return kh(i)?i:i instanceof Date?i.getTime():i===!0?1:i===!1?0:Ah(i)?i:0}function Xy(){return Je}function qy(){throw new Error("SHEET is not implemented")}function Ky(){throw new Error("SHEETS is not implemented")}function jy(i){if(kh(i))return 1;if(sv(i))return 2;if(nv(i))return 4;if(Ah(i))return 16;if(Array.isArray(i))return 64}function Qy(){if(arguments.length<2)return Je;const i=arguments[0];return i<1||i>254||arguments.length<i+1?j:arguments[i]}function Zy(i,e){if(arguments.length!==2)return Je;if(e<0)return le;if(!(i instanceof Array)||typeof e!="number")return j;if(i.length!==0)return $e.col(i,e)}function Jy(i){return arguments.length!==1?Je:i instanceof Array?i.length===0?0:$e.cols(i):j}function eS(i,e,t,r){return av(i,Yc(e),t,r)}function tS(i,e,t){const r=St(i,e,t);if(r)return r;if(!Array.isArray(i))return j;const n=i.length>0&&!Array.isArray(i[0]);return n&&!t?(t=e,e=1):(t=t||1,e=e||1),t<0||e<0?j:n&&e===1&&t<=i.length?i[t-1]:e<=i.length&&t<=i[e-1].length?i[e-1][t-1]:oo}function iS(i,e,t){e=Ae(e),t=t?Ae(t):e;const r=typeof i=="number";let n=Je;for(let s=0;s<e.length;s++){if(e[s]===i)return t[s];if(r&&e[s]<=i||typeof e[s]=="string"&&e[s].localeCompare(i)<0)n=t[s];else if(r&&e[s]>i)return n}return n}function rS(i,e,t){if(!i&&i!==0||!e||(arguments.length===2&&(t=1),e=Ae(e),!(e instanceof Array))||t!==-1&&t!==0&&t!==1)return Je;let r,n;for(let s=0;s<e.length;s++)if(t===1){if(e[s]===i)return s+1;e[s]<i&&(n?e[s]>n&&(r=s+1,n=e[s]):(r=s+1,n=e[s]))}else if(t===0){if(typeof i=="string"&&typeof e[s]=="string"){const a=i.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]");if(new RegExp("^"+a+"$").test(e[s].toLowerCase()))return s+1}else if(e[s]===i)return s+1}else if(t===-1){if(e[s]===i)return s+1;e[s]>i&&(n?e[s]<n&&(r=s+1,n=e[s]):(r=s+1,n=e[s]))}return r||Je}function nS(i){return arguments.length!==1?Je:i instanceof Array?i.length===0?0:$e.rows(i):j}function sS(i,e=1,t=1,r=!1){if(!i||!Array.isArray(i))return Je;if(i.length===0)return 0;if(e=I(e),!e||e<1||(t=I(t),t!==1&&t!==-1))return j;if(r=Xd(r),typeof r!="boolean")return yh;const n=o=>o.sort((c,h)=>(c=ki(c[e-1]),h=ki(h[e-1]),t===1?c<h?t*-1:t:c>h?t:t*-1)),s=Jg(i),a=r?Yc(s):s;return e>=1&&e<=a[0].length?r?Yc(n(a)):n(a):j}function aS(i){if(!i)return Je;const e=Jg(i);return Yc(e)}function qd(){const i=[];for(let e=0;e<arguments.length;++e){let t=!1;const r=arguments[e];for(let n=0;n<i.length&&(t=i[n]===r,!t);++n);t||i.push(r)}return i}function av(i,e,t,r){if(!e||!t)return Je;r=!(r===0||r===!1);let n=Je,s=!1;const a=typeof i=="number",o=typeof i=="string"?i.toLowerCase():i;for(let c=0;c<e.length;c++){const h=e[c],l=typeof h[0]=="string"?h[0].toLowerCase():h[0];if(l===o){n=t<h.length+1?h[t-1]:oo;break}else!s&&(a&&r&&l<=i||r&&typeof l=="string"&&l.localeCompare(i)<0)&&(n=t<h.length+1?h[t-1]:oo);a&&l>i&&(s=!0)}return n}const oS=2.5066282746310002;function lS(){const e=Ae(arguments).filter(mo);if(e.length===0)return le;const t=Ye(e);return t instanceof Error?t:$e.sum($e(t).subtract($e.mean(t)).abs()[0])/t.length}function pa(){const e=Ae(arguments).filter(mo);if(e.length===0)return xr;const t=St.apply(void 0,e);if(t)return t;const r=ba(e),n=r.length;let s=0,a=0,o;for(let c=0;c<n;c++)s+=r[c],a+=1;return o=s/a,isNaN(o)&&(o=le),o}function Kd(){const e=Ae(arguments).filter(mo);if(e.length===0)return xr;const t=St.apply(void 0,e);if(t)return t;const r=e,n=r.length;let s=0,a=0,o;for(let c=0;c<n;c++){const h=r[c];typeof h=="number"&&(s+=h),h===!0&&s++,h!==null&&a++}return o=s/a,isNaN(o)&&(o=le),o}function cS(i,e,t){if(arguments.length<=1)return Je;t=t||i;const n=Ae(t).filter(mo);if(t=Ye(n),i=Ae(i),t instanceof Error)return t;let s=0,a=0;const o=e===void 0||e==="*",c=o?null:fo(e+"");for(let h=0;h<i.length;h++){const l=i[h];if(o)a+=t[h],s++;else{const u=[cs(l,Gs)].concat(c);po(u)&&(a+=t[h],s++)}}return a/s}function hS(){const i=Th(...arguments),t=i.reduce((r,n)=>r+n,0)/i.length;return isNaN(t)?0:t}const kl={};kl.DIST=function(i,e,t,r,n,s){return arguments.length<4||(n=n===void 0?0:n,s=s===void 0?1:s,i=I(i),e=I(e),t=I(t),n=I(n),s=I(s),me(i,e,t,n,s))?j:(i=(i-n)/(s-n),r?$e.beta.cdf(i,e,t):$e.beta.pdf(i,e,t))};kl.INV=(i,e,t,r,n)=>(r=r===void 0?0:r,n=n===void 0?1:n,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n)?j:$e.beta.inv(i,e,t)*(n-r)+r);const go={};go.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),r=I(r),me(i,e,t,r)?j:r?$e.binomial.cdf(i,e,t):$e.binomial.pdf(i,e,t));go.DIST.RANGE=(i,e,t,r)=>{if(r=r===void 0?t:r,i=I(i),e=I(e),t=I(t),r=I(r),me(i,e,t,r))return j;let n=0;for(let s=t;s<=r;s++)n+=Ja(i,s)*Math.pow(e,s)*Math.pow(1-e,i-s);return n};go.INV=(i,e,t)=>{if(i=I(i),e=I(e),t=I(t),me(i,e,t))return j;let r=0;for(;r<=i;){if($e.binomial.cdf(r,i,e)>=t)return r;r++}};const Mn={};Mn.DIST=(i,e,t)=>(i=I(i),e=I(e),me(i,e)?j:t?$e.chisquare.cdf(i,e):$e.chisquare.pdf(i,e));Mn.DIST.RT=(i,e)=>!i|!e?Je:i<1||e>Math.pow(10,10)?le:typeof i!="number"||typeof e!="number"?j:1-$e.chisquare.cdf(i,e);Mn.INV=(i,e)=>(i=I(i),e=I(e),me(i,e)?j:$e.chisquare.inv(i,e));Mn.INV.RT=(i,e)=>!i|!e?Je:i<0||i>1||e<1||e>Math.pow(10,10)?le:typeof i!="number"||typeof e!="number"?j:$e.chisquare.inv(1-i,e);Mn.TEST=function(i,e){if(arguments.length!==2)return Je;if(!(i instanceof Array)||!(e instanceof Array)||i.length!==e.length||i[0]&&e[0]&&i[0].length!==e[0].length)return j;const t=i.length;let r,n,s;for(n=0;n<t;n++)i[n]instanceof Array||(r=i[n],i[n]=[],i[n].push(r)),e[n]instanceof Array||(r=e[n],e[n]=[],e[n].push(r));const a=i[0].length,o=a===1?t-1:(t-1)*(a-1);let c=0;const h=Math.PI;for(n=0;n<t;n++)for(s=0;s<a;s++)c+=Math.pow(i[n][s]-e[n][s],2)/e[n][s];function l(u,d){let f=Math.exp(-.5*u);d%2===1&&(f=f*Math.sqrt(2*u/h));let p=d;for(;p>=2;)f=f*u/p,p=p-2;let m=f,v=d;for(;m>1e-10*f;)v=v+2,m=m*u/v,f=f+m;return 1-f}return Math.round(l(c,o)*1e6)/1e6};const jd={};jd.NORM=(i,e,t)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:$e.normalci(1,i,e,t)[1]-1);jd.T=(i,e,t)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:$e.tci(1,i,e,t)[1]-1);function uS(i,e){return i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e)?j:$e.corrcoeff(i,e)}function ol(){const i=Ae(arguments);return ba(i).length}function ll(){const i=Ae(arguments);return i.length-ov(i)}function ov(){const i=Ae(arguments);let e=0,t;for(let r=0;r<i.length;r++)t=i[r],(t==null||t==="")&&e++;return e}function dS(i,e){if(i=Ae(i),e===void 0||e==="*")return i.length;let r=0;const n=fo(e+"");for(let s=0;s<i.length;s++){const a=i[s],o=[cs(a,Gs)].concat(n);po(o)&&r++}return r}function fS(){const i=Sh(arguments),e=new Array(Ae(i[0]).length);for(let r=0;r<e.length;r++)e[r]=!0;for(let r=0;r<i.length;r+=2){const n=Ae(i[r]),s=i[r+1];if(!(s===void 0||s==="*")){const o=fo(s+"");for(let c=0;c<n.length;c++){const h=n[c],l=[cs(h,Gs)].concat(o);e[c]=e[c]&&po(l)}}}let t=0;for(let r=0;r<e.length;r++)e[r]&&t++;return t}const vo={};vo.P=(i,e)=>{if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=$e.mean(i),r=$e.mean(e);let n=0;const s=i.length;for(let a=0;a<s;a++)n+=(i[a]-t)*(e[a]-r);return n/s};vo.S=(i,e)=>(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e)?j:$e.covariance(i,e));function pS(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=$e.mean(i);let t=0;for(let r=0;r<i.length;r++)t+=Math.pow(i[r]-e,2);return t}const Qd={};Qd.DIST=(i,e,t)=>(i=I(i),e=I(e),me(i,e)?j:t?$e.exponential.cdf(i,e):$e.exponential.pdf(i,e));const Ln={};Ln.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:r?$e.centralF.cdf(i,e,t):$e.centralF.pdf(i,e,t));Ln.DIST.RT=function(i,e,t){return arguments.length!==3?Je:i<0||e<1||t<1?le:typeof i!="number"||typeof e!="number"||typeof t!="number"?j:1-$e.centralF.cdf(i,e,t)};Ln.INV=(i,e,t)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:i<=0||i>1?le:$e.centralF.inv(i,e,t));Ln.INV.RT=function(i,e,t){return arguments.length!==3?Je:i<0||i>1||e<1||e>Math.pow(10,10)||t<1||t>Math.pow(10,10)?le:typeof i!="number"||typeof e!="number"||typeof t!="number"?j:$e.centralF.inv(1-i,e,t)};Ln.TEST=(i,e)=>{if(!i||!e||!(i instanceof Array)||!(e instanceof Array))return Je;if(i.length<2||e.length<2)return xr;const t=(o,c)=>{let h=0;for(let l=0;l<o.length;l++)h+=Math.pow(o[l]-c,2);return h},r=vs(i)/i.length,n=vs(e)/e.length,s=t(i,r)/(i.length-1),a=t(e,n)/(e.length-1);return s/a};function mS(i){return i=I(i),i instanceof Error?i:Math.log((1+i)/(1-i))/2}function gS(i){if(i=I(i),i instanceof Error)return i;const e=Math.exp(2*i);return(e-1)/(e+1)}function lv(i,e,t){if(i=I(i),e=Ye(Ae(e)),t=Ye(Ae(t)),me(i,e,t))return j;const r=$e.mean(t),n=$e.mean(e),s=t.length;let a=0,o=0;for(let l=0;l<s;l++)a+=(t[l]-r)*(e[l]-n),o+=Math.pow(t[l]-r,2);const c=a/o;return n-c*r+c*i}function vS(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=i.length,r=e.length,n=[];for(let s=0;s<=r;s++){n[s]=0;for(let a=0;a<t;a++)s===0?i[a]<=e[0]&&(n[0]+=1):s<r?i[a]>e[s-1]&&i[a]<=e[s]&&(n[s]+=1):s===r&&i[a]>e[r-1]&&(n[r]+=1)}return n}function Ol(i){return i=I(i),i instanceof Error?i:i===0||parseInt(i,10)===i&&i<0?le:$e.gammafn(i)}Ol.DIST=function(i,e,t,r){return arguments.length!==4?Je:i<0||e<=0||t<=0||typeof i!="number"||typeof e!="number"||typeof t!="number"?j:r?$e.gamma.cdf(i,e,t,!0):$e.gamma.pdf(i,e,t,!1)};Ol.INV=function(i,e,t){return arguments.length!==3?Je:i<0||i>1||e<=0||t<=0?le:typeof i!="number"||typeof e!="number"||typeof t!="number"?j:$e.gamma.inv(i,e,t)};function Zd(i){return i=I(i),i instanceof Error?i:$e.gammaln(i)}Zd.PRECISE=function(i){return arguments.length!==1?Je:i<=0?le:typeof i!="number"?j:$e.gammaln(i)};function _S(i){return i=I(i),i instanceof Error?i:$e.normal.cdf(i,0,1)-.5}function ES(){const i=Ye(Ae(arguments));return i instanceof Error?i:$e.geomean(i)}function xS(i,e,t,r){if(i=Ye(Ae(i)),i instanceof Error)return i;let n;if(e===void 0)for(e=[],n=1;n<=i.length;n++)e.push(n);if(t===void 0&&(t=e),e=Ye(Ae(e)),t=Ye(Ae(t)),me(e,t))return j;r===void 0&&(r=!0);const s=i.length;let a=0,o=0,c=0,h=0;for(n=0;n<s;n++){const f=e[n],p=Math.log(i[n]);a+=f,o+=p,c+=f*p,h+=f*f}a/=s,o/=s,c/=s,h/=s;let l,u;r?(l=(c-a*o)/(h-a*a),u=o-l*a):(l=c/h,u=0);const d=[];for(n=0;n<t.length;n++)d.push(Math.exp(u+l*t[n]));return d}function wS(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=i.length;let t=0;for(let r=0;r<e;r++)t+=1/i[r];return e/t}const Jd={};Jd.DIST=(i,e,t,r,n)=>{if(i=I(i),e=I(e),t=I(t),r=I(r),me(i,e,t,r))return j;function s(o,c,h,l){return Ja(h,o)*Ja(l-h,c-o)/Ja(l,c)}function a(o,c,h,l){let u=0;for(let d=0;d<=o;d++)u+=s(d,c,h,l);return u}return n?a(i,e,t,r):s(i,e,t,r)};function CS(i,e){return i=Ye(i),e=Ye(e),me(i,e)?j:i.length!==e.length?Je:lv(0,i,e)}function yS(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=$e.mean(i),t=i.length;let r=0;for(let n=0;n<t;n++)r+=Math.pow(i[n]-e,4);return r=r/Math.pow($e.stdev(i,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*r-3*(t-1)*(t-1)/((t-2)*(t-3))}function cv(i,e){const t=St.apply(void 0,i);return t||(me(e)?e:(i=ba(Ae(i)),e=I(e),e<0||i.length<e?j:i.sort((r,n)=>n-r)[e-1]))}function ef(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=$e.mean(i),r=$e.mean(e),n=e.length;let s=0,a=0;for(let h=0;h<n;h++)s+=(e[h]-r)*(i[h]-t),a+=Math.pow(e[h]-r,2);const o=s/a,c=t-o*r;return[o,c]}function SS(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e)||i.length!==e.length)return j;for(let r=0;r<i.length;r++)i[r]=Math.log(i[r]);const t=ef(i,e);return t[0]=Math.round(Math.exp(t[0])*1e6)/1e6,t[1]=Math.round(Math.exp(t[1])*1e6)/1e6,t}const _o={};_o.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:r?$e.lognormal.cdf(i,e,t):$e.lognormal.pdf(i,e,t));_o.INV=(i,e,t)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:$e.lognormal.inv(i,e,t));function Xc(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;const t=ba(i);return t.length===0?0:Math.max.apply(Math,t)}function bS(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;let t=Yd(i);return t=t.map(r=>r??0),t.length===0?0:Math.max.apply(Math,t)}function TS(){const i=Th(...arguments);return i.length===0?0:Math.max.apply(Math,i)}function hv(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;const t=Yd(i);let r=$e.median(t);return isNaN(r)&&(r=le),r}function qc(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;const t=ba(i);return t.length===0?0:Math.min.apply(Math,t)}function AS(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;let t=Yd(i);return t=t.map(r=>r??0),t.length===0?0:Math.min.apply(Math,t)}function kS(){const i=Th(...arguments);return i.length===0?0:Math.min.apply(Math,i)}const ma={};ma.MULT=function(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=i.length,t={};let r=[],n=0,s;for(let a=0;a<e;a++)s=i[a],t[s]=t[s]?t[s]+1:1,t[s]>n&&(n=t[s],r=[]),t[s]===n&&(r[r.length]=s);return r};ma.SNGL=function(){const i=Ye(Ae(arguments));return i instanceof Error?i:ma.MULT(i).sort((e,t)=>e-t)[0]};const tf={};tf.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:r?$e.negbin.cdf(i,e,t):$e.negbin.pdf(i,e,t));const Bn={};Bn.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:t<=0?le:r?$e.normal.cdf(i,e,t):$e.normal.pdf(i,e,t));Bn.INV=(i,e,t)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:$e.normal.inv(i,e,t));Bn.S={};Bn.S.DIST=(i,e)=>(i=I(i),i instanceof Error?j:e?$e.normal.cdf(i,0,1):$e.normal.pdf(i,0,1));Bn.S.INV=i=>(i=I(i),i instanceof Error?j:$e.normal.inv(i,0,1));function uv(i,e){if(e=Ye(Ae(e)),i=Ye(Ae(i)),me(e,i))return j;const t=$e.mean(i),r=$e.mean(e),n=i.length;let s=0,a=0,o=0;for(let c=0;c<n;c++)s+=(i[c]-t)*(e[c]-r),a+=Math.pow(i[c]-t,2),o+=Math.pow(e[c]-r,2);return s/Math.sqrt(a*o)}const en={};en.EXC=(i,e)=>{if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;i=i.sort((s,a)=>s-a);const t=i.length;if(e<1/(t+1)||e>1-1/(t+1))return le;const r=e*(t+1)-1,n=Math.floor(r);return ev(r===n?i[r]:i[n]+(r-n)*(i[n+1]-i[n]))};en.INC=(i,e)=>{if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;i=i.sort((s,a)=>s-a);const t=i.length,r=e*(t-1),n=Math.floor(r);return ev(r===n?i[r]:i[n]+(r-n)*(i[n+1]-i[n]))};const Il={};Il.EXC=(i,e,t)=>{if(t=t===void 0?3:t,i=Ye(Ae(i)),e=I(e),t=I(t),me(i,e,t))return j;i=i.sort((l,u)=>l-u);const r=qd.apply(null,i),n=i.length,s=r.length,a=Math.pow(10,t);let o=0,c=!1,h=0;for(;!c&&h<s;)e===r[h]?(o=(i.indexOf(r[h])+1)/(n+1),c=!0):e>=r[h]&&(e<r[h+1]||h===s-1)&&(o=(i.indexOf(r[h])+1+(e-r[h])/(r[h+1]-r[h]))/(n+1),c=!0),h++;return Math.floor(o*a)/a};Il.INC=(i,e,t)=>{if(t=t===void 0?3:t,i=Ye(Ae(i)),e=I(e),t=I(t),me(i,e,t))return j;i=i.sort((l,u)=>l-u);const r=qd.apply(null,i),n=i.length,s=r.length,a=Math.pow(10,t);let o=0,c=!1,h=0;for(;!c&&h<s;)e===r[h]?(o=i.indexOf(r[h])/(n-1),c=!0):e>=r[h]&&(e<r[h+1]||h===s-1)&&(o=(i.indexOf(r[h])+(e-r[h])/(r[h+1]-r[h]))/(n-1),c=!0),h++;return Math.floor(o*a)/a};function OS(i,e){return i=I(i),e=I(e),me(i,e)?j:hs(i)/hs(i-e)}function IS(i,e){return i=I(i),e=I(e),me(i,e)?j:Math.pow(i,e)}function RS(i){return i=I(i),i instanceof Error?j:Math.exp(-.5*i*i)/oS}const rf={};rf.DIST=(i,e,t)=>(i=I(i),e=I(e),me(i,e)?j:t?$e.poisson.cdf(i,e):$e.poisson.pdf(i,e));function DS(i,e,t,r){if(t===void 0)return 0;if(r=r===void 0?t:r,i=Ye(Ae(i)),e=Ye(Ae(e)),t=I(t),r=I(r),me(i,e,t,r))return j;if(t===r)return i.indexOf(t)>=0?e[i.indexOf(t)]:0;const n=i.sort((o,c)=>o-c),s=n.length;let a=0;for(let o=0;o<s;o++)n[o]>=t&&n[o]<=r&&(a+=e[i.indexOf(n[o])]);return a}const ga={};ga.EXC=(i,e)=>{if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;switch(e){case 1:return en.EXC(i,.25);case 2:return en.EXC(i,.5);case 3:return en.EXC(i,.75);default:return le}};ga.INC=(i,e)=>{if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;switch(e){case 1:return en.INC(i,.25);case 2:return en.INC(i,.5);case 3:return en.INC(i,.75);default:return le}};const Rl={};Rl.AVG=(i,e,t)=>{if(i=I(i),e=Ye(Ae(e)),me(i,e))return j;e=Ae(e),t=t||!1;const r=t?(a,o)=>a-o:(a,o)=>o-a;e=e.sort(r);const n=e.length;let s=0;for(let a=0;a<n;a++)e[a]===i&&s++;return s>1?(2*e.indexOf(i)+s+1)/2:e.indexOf(i)+1};Rl.EQ=(i,e,t)=>{if(i=I(i),e=Ye(Ae(e)),me(i,e))return j;t=t||!1;const r=t?(n,s)=>n-s:(n,s)=>s-n;return e=e.sort(r),e.indexOf(i)+1};function FS(i,e){if(arguments.length!==2)return Je;if(e<0)return le;if(!(i instanceof Array)||typeof e!="number")return j;if(i.length!==0)return $e.row(i,e)}function PS(i,e){return i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e)?j:Math.pow(uv(i,e),2)}function nf(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=$e.mean(i),t=i.length;let r=0;for(let n=0;n<t;n++)r+=Math.pow(i[n]-e,3);return t*r/((t-1)*(t-2)*Math.pow($e.stdev(i,!0),3))}nf.P=function(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=$e.mean(i),t=i.length;let r=0,n=0;for(let s=0;s<t;s++)n+=Math.pow(i[s]-e,3),r+=Math.pow(i[s]-e,2);return n=n/t,r=r/t,n/Math.pow(r,3/2)};function NS(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=$e.mean(e),r=$e.mean(i),n=e.length;let s=0,a=0;for(let o=0;o<n;o++)s+=(e[o]-t)*(i[o]-r),a+=Math.pow(e[o]-t,2);return s/a}function dv(i,e){return i=Ye(Ae(i)),e=I(e),me(i,e)?i:i.sort((t,r)=>t-r)[e-1]}function MS(i,e,t){return i=I(i),e=I(e),t=I(t),me(i,e,t)?j:(i-e)/t}const Ur={};Ur.P=function(){const i=kr.P.apply(this,arguments);let e=Math.sqrt(i);return isNaN(e)&&(e=le),e};Ur.S=function(){const i=kr.S.apply(this,arguments);return Math.sqrt(i)};function LS(){const i=fv.apply(this,arguments);return Math.sqrt(i)}function BS(){const i=pv.apply(this,arguments);let e=Math.sqrt(i);return isNaN(e)&&(e=le),e}function HS(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=$e.mean(e),r=$e.mean(i),n=e.length;let s=0,a=0,o=0;for(let c=0;c<n;c++)s+=Math.pow(i[c]-r,2),a+=(e[c]-t)*(i[c]-r),o+=Math.pow(e[c]-t,2);return Math.sqrt((s-a*a/o)/(n-2))}const tn={};tn.DIST=(i,e,t)=>t!==1&&t!==2?le:t===1?tn.DIST.RT(i,e):tn.DIST["2T"](i,e);tn.DIST["2T"]=function(i,e){return arguments.length!==2?Je:i<0||e<1?le:typeof i!="number"||typeof e!="number"?j:(1-$e.studentt.cdf(i,e))*2};tn.DIST.RT=function(i,e){return arguments.length!==2?Je:i<0||e<1?le:typeof i!="number"||typeof e!="number"?j:1-$e.studentt.cdf(i,e)};tn.INV=(i,e)=>(i=I(i),e=I(e),me(i,e)?j:$e.studentt.inv(i,e));tn.INV["2T"]=(i,e)=>(i=I(i),e=I(e),i<=0||i>1||e<1?le:me(i,e)?j:Math.abs($e.studentt.inv(i/2,e)));tn.TEST=(i,e)=>{if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;const t=$e.mean(i),r=$e.mean(e);let n=0,s=0,a;for(a=0;a<i.length;a++)n+=Math.pow(i[a]-t,2);for(a=0;a<e.length;a++)s+=Math.pow(e[a]-r,2);n=n/(i.length-1),s=s/(e.length-1);const o=Math.abs(t-r)/Math.sqrt(n/i.length+s/e.length);return tn.DIST["2T"](o,i.length+e.length-2)};function VS(i,e,t){if(i=Ye(Ae(i)),e=Ye(Ae(e)),t=Ye(Ae(t)),me(i,e,t))return j;const r=ef(i,e),n=r[0],s=r[1],a=[];return t.forEach(o=>{a.push(n*o+s)}),a}function US(i,e){if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;const t=va(i.length*e,2)/2;return $e.mean(Fy(ui(i.sort((r,n)=>r-n),t),t))}const kr={};kr.P=function(){const i=ba(Ae(arguments)),e=i.length;let t=0;const r=pa(i);let n;for(let s=0;s<e;s++)t+=Math.pow(i[s]-r,2);return n=t/e,isNaN(n)&&(n=le),n};kr.S=function(){const i=ba(Ae(arguments)),e=i.length;let t=0;const r=pa(i);for(let n=0;n<e;n++)t+=Math.pow(i[n]-r,2);return t/(e-1)};function fv(){const i=Ae(arguments),e=i.length;let t=0,r=0;const n=Kd(i);for(let s=0;s<e;s++){const a=i[s];typeof a=="number"?t+=Math.pow(a-n,2):a===!0?t+=Math.pow(1-n,2):t+=Math.pow(0-n,2),a!==null&&r++}return t/(r-1)}function pv(){const i=Ae(arguments),e=i.length;let t=0,r=0;const n=Kd(i);let s;for(let a=0;a<e;a++){const o=i[a];typeof o=="number"?t+=Math.pow(o-n,2):o===!0?t+=Math.pow(1-n,2):t+=Math.pow(0-n,2),o!==null&&r++}return s=t/r,isNaN(s)&&(s=le),s}const sf={};sf.DIST=(i,e,t,r)=>(i=I(i),e=I(e),t=I(t),me(i,e,t)?j:r?1-Math.exp(-Math.pow(i/t,e)):Math.pow(i,e-1)*Math.exp(-Math.pow(i/t,e))*e/Math.pow(t,e));const af={};af.TEST=(i,e,t)=>{if(i=Ye(Ae(i)),e=I(e),me(i,e))return j;t=t||Ur.S(i);const r=i.length;return 1-Bn.S.DIST((pa(i)-e)/(t/Math.sqrt(r)),!0)};function WS(i){return i=I(i),i instanceof Error?i:Math.abs(i)}function zS(i){if(i=I(i),i instanceof Error)return i;let e=Math.acos(i);return isNaN(e)&&(e=le),e}function GS(i){if(i=I(i),i instanceof Error)return i;let e=Math.log(i+Math.sqrt(i*i-1));return isNaN(e)&&(e=le),e}function $S(i){return i=I(i),i instanceof Error?i:Math.atan(1/i)}function YS(i){if(i=I(i),i instanceof Error)return i;let e=.5*Math.log((i+1)/(i-1));return isNaN(e)&&(e=le),e}function XS(i,e,t,r){if(i=I(i),e=I(i),me(i,e))return j;switch(i){case 1:return pa(t);case 2:return ol(t);case 3:return ll(t);case 4:return Xc(t);case 5:return qc(t);case 6:return Kc(t);case 7:return Ur.S(t);case 8:return Ur.P(t);case 9:return vs(t);case 10:return kr.S(t);case 11:return kr.P(t);case 12:return hv(t);case 13:return ma.SNGL(t);case 14:return cv(t,r);case 15:return dv(t,r);case 16:return en.INC(t,r);case 17:return ga.INC(t,r);case 18:return en.EXC(t,r);case 19:return ga.EXC(t,r)}}function qS(i){if(i==null)return 0;if(i instanceof Error)return i;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(i))return j;let e=0;return i.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,t=>{e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),e}function KS(i){if(i=I(i),i instanceof Error)return i;let e=Math.asin(i);return isNaN(e)&&(e=le),e}function jS(i){return i=I(i),i instanceof Error?i:Math.log(i+Math.sqrt(i*i+1))}function QS(i){return i=I(i),i instanceof Error?i:Math.atan(i)}function ZS(i,e){i=I(i),e=I(e);const t=St(i,e);return t||Math.atan2(i,e)}function JS(i){if(i=I(i),i instanceof Error)return i;let e=Math.log((1+i)/(1-i))/2;return isNaN(e)&&(e=le),e}function eb(i,e,t){i=I(i),e=I(e),t=I(t);const r=St(i,e,t);if(r)return r;if(e===0)return le;const n=i.toString(e);return new Array(Math.max(t+1-n.length,0)).join("0")+n}function gs(i,e,t){i=I(i),e=I(e),t=I(t);const r=St(i,e,t);if(r)return r;if(e===0)return 0;e=Math.abs(e);const n=-Math.floor(Math.log(e)/Math.log(10));return i>=0?Yn(Math.ceil(i/e)*e,n):t===0?-Yn(Math.floor(Math.abs(i)/e)*e,n):-Yn(Math.ceil(Math.abs(i)/e)*e,n)}gs.MATH=gs;gs.PRECISE=gs;function Ja(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i<e?le:hs(i)/(hs(e)*hs(i-e)))}function tb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i<e?le:i===0&&e===0?1:Ja(i+e-1,i-1))}function ib(i){return i=I(i),i instanceof Error?i:Math.cos(i)}function rb(i){return i=I(i),i instanceof Error?i:(Math.exp(i)+Math.exp(-i))/2}function nb(i){return i=I(i),i instanceof Error?i:i===0?xr:1/Math.tan(i)}function sb(i){if(i=I(i),i instanceof Error)return i;if(i===0)return xr;const e=Math.exp(2*i);return(e+1)/(e-1)}function ab(i){return i=I(i),i instanceof Error?i:i===0?xr:1/Math.sin(i)}function ob(i){return i=I(i),i instanceof Error?i:i===0?xr:2/(Math.exp(i)-Math.exp(-i))}function lb(i,e){if(arguments.length<2)return Je;i=i||"0",e=I(e);const t=St(i,e);if(t)return t;if(e===0)return le;const r=parseInt(i,e);return isNaN(r)?le:r}function cb(i){return i=I(i),i instanceof Error?i:i*180/Math.PI}function hb(i){return i=I(i),i instanceof Error?i:gs(i,-2,-1)}function ub(i){return arguments.length<1?Je:arguments.length>1?$d:(i=I(i),i instanceof Error||(i=Math.exp(i)),i)}const hc=[];function hs(i){if(i=I(i),i instanceof Error)return i;const e=Math.floor(i);return e===0||e===1?1:(hc[e]>0||(hc[e]=hs(e-1)*e),hc[e])}function mv(i){if(i=I(i),i instanceof Error)return i;const e=Math.floor(i);return e<=0?1:e*mv(e-2)}function va(i,e){i=I(i),e=I(e);const t=St(i,e);if(t)return t;if(e===0)return 0;if(!(i>=0&&e>0)&&!(i<=0&&e<0))return le;e=Math.abs(e);const r=-Math.floor(Math.log(e)/Math.log(10));return i>=0?Yn(Math.floor(i/e)*e,r):-Yn(Math.ceil(Math.abs(i)/e),r)}va.MATH=(i,e,t)=>{if(e instanceof Error)return e;e=e===void 0?0:e,i=I(i),e=I(e),t=I(t);const r=St(i,e,t);if(r)return r;if(e===0)return 0;e=e?Math.abs(e):1;const n=-Math.floor(Math.log(e)/Math.log(10));return i>=0?Yn(Math.floor(i/e)*e,n):t===0||t===void 0?-Yn(Math.ceil(Math.abs(i)/e)*e,n):-Yn(Math.floor(Math.abs(i)/e)*e,n)};va.PRECISE=va.MATH;function db(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=i.length,t=i[0];let r=t<0?-t:t;for(let n=1;n<e;n++){const s=i[n];let a=s<0?-s:s;for(;r&&a;)r>a?r%=a:a%=r;r+=a}return r}function fb(i){return i=I(i),i instanceof Error?i:Math.floor(i)}const pb={CEILING:gs};function mb(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;for(var e,t,r,n,s=1;(r=i.pop())!==void 0;){if(r===0)return 0;for(;r>1;){if(r%2){for(e=3,t=Math.floor(Math.sqrt(r));e<=t&&r%e;e+=2);n=e<=t?e:r}else n=2;for(r/=n,s*=n,e=i.length;e;i[--e]%n===0&&(i[e]/=n)===1&&i.splice(e,1));}}return s}function gb(i){return i=I(i),i instanceof Error?i:i===0?le:Math.log(i)}function vb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i===0||e===0?le:Math.log(i)/Math.log(e))}function _b(i){return i=I(i),i instanceof Error?i:i===0?le:Math.log(i)/Math.log(10)}function Eb(i,e){return!Array.isArray(i)||!Array.isArray(e)||i.some(r=>!r.length)||e.some(r=>!r.length)||md(i).some(r=>typeof r!="number")||md(e).some(r=>typeof r!="number")||i[0].length!==e.length?j:Array(i.length).fill(0).map(()=>Array(e[0].length).fill(0)).map((r,n)=>r.map((s,a)=>i[n].reduce((o,c,h)=>o+c*e[h][a],0)))}function xb(i,e){i=I(i),e=I(e);const t=St(i,e);if(t)return t;if(e===0)return xr;let r=Math.abs(i%e);return r=i<0?e-r:r,e>0?r:-r}function wb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i*e===0?0:i*e<0?le:Math.round(i/e)*e)}function Cb(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;let e=0,t=1;for(let r=0;r<i.length;r++)e+=i[r],t*=hs(i[r]);return hs(e)/t}function yb(i){return arguments.length>1?Je:(i=parseInt(i),!i||i<=0?j:Array(i).fill(0).map(()=>Array(i).fill(0)).map((e,t)=>(e[t]=1,e)))}function Sb(i){if(i=I(i),i instanceof Error)return i;let e=Math.ceil(Math.abs(i));return e=e&1?e:e+1,i>=0?e:-e}function bb(){return Math.PI}function gv(i,e){i=I(i),e=I(e);const t=St(i,e);if(t)return t;if(i===0&&e===0)return le;const r=Math.pow(i,e);return isNaN(r)?le:r}function Kc(){const e=Ae(arguments).filter(n=>n!=null);if(e.length===0)return 0;const t=Ye(e);if(t instanceof Error)return t;let r=1;for(let n=0;n<t.length;n++)r*=t[n];return r}function Tb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||parseInt(i/e,10)}function Ab(i){return i=I(i),i instanceof Error?i:i*Math.PI/180}function kb(){return Math.random()}function Ob(i,e){i=I(i),e=I(e);const t=St(i,e);return t||i+Math.ceil((e-i+1)*Math.random())-1}function Ib(i){if(i=I(i),i instanceof Error)return i;const e=String(i).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",n=3;for(;n--;)r=(t[+e.pop()+n*10]||"")+r;return new Array(+e.join("")+1).join("M")+r}function Yn(i,e){i=I(i),e=I(e);const t=St(i,e);return t||+(Math.round(+(i+"e"+e))+"e"+e*-1)}function Rb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i>0?1:-1)*Math.floor(Math.abs(i)*Math.pow(10,e))/Math.pow(10,e)}function Db(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i>0?1:-1)*Math.ceil(Math.abs(i)*Math.pow(10,e))/Math.pow(10,e)}function Fb(i){return i=I(i),i instanceof Error?i:1/Math.cos(i)}function Pb(i){return i=I(i),i instanceof Error?i:2/(Math.exp(i)+Math.exp(-i))}function Nb(i,e,t,r){if(i=I(i),e=I(e),t=I(t),r=Ye(r),me(i,e,t,r))return j;let n=r[0]*Math.pow(i,e);for(let s=1;s<r.length;s++)n+=r[s]*Math.pow(i,e+s*t);return n}function Mb(i){return i=I(i),i instanceof Error?i:i<0?-1:i===0?0:1}function Lb(i){return i=I(i),i instanceof Error?i:Math.sin(i)}function Bb(i){return i=I(i),i instanceof Error?i:(Math.exp(i)-Math.exp(-i))/2}function Hb(i){return i=I(i),i instanceof Error?i:i<0?le:Math.sqrt(i)}function Vb(i){return i=I(i),i instanceof Error?i:Math.sqrt(i*Math.PI)}function Ub(i,e){if(i=I(i),i instanceof Error)return i;switch(i){case 1:return pa(e);case 2:return ol(e);case 3:return ll(e);case 4:return Xc(e);case 5:return qc(e);case 6:return Kc(e);case 7:return Ur.S(e);case 8:return Ur.P(e);case 9:return vs(e);case 10:return kr.S(e);case 11:return kr.P(e);case 101:return pa(e);case 102:return ol(e);case 103:return ll(e);case 104:return Xc(e);case 105:return qc(e);case 106:return Kc(e);case 107:return Ur.S(e);case 108:return Ur.P(e);case 109:return vs(e);case 110:return kr.S(e);case 111:return kr.P(e)}}function vs(){let i=0;return _r(Sh(arguments),e=>{if(i instanceof Error)return!1;if(e instanceof Error)i=e;else if(typeof e=="number")i+=e;else if(typeof e=="string"){const t=parseFloat(e);!isNaN(t)&&(i+=t)}else if(Array.isArray(e)){const t=vs.apply(null,e);t instanceof Error?i=t:i+=t}}),i}function Wb(i,e,t){if(i=Ae(i),t=t?Ae(t):i,i instanceof Error)return i;if(e==null||e instanceof Error)return 0;let r=0;const n=e==="*",s=n?null:fo(e+"");for(let a=0;a<i.length;a++){const o=i[a],c=t[a];if(n)r+=o;else{const h=[cs(o,Gs)].concat(s);r+=po(h)?c:0}}return r}function zb(){const i=Th(...arguments);return vs(i)}function Gb(){if(!arguments||arguments.length===0)return j;const i=arguments.length+1;let e=0,t,r,n,s;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let o=0;o<arguments[0][a].length;o++){for(t=1,r=1;r<i;r++){const c=arguments[r-1][a][o];if(c instanceof Error)return c;if(s=I(c),s instanceof Error)return s;t*=s}e+=t}else{for(t=1,r=1;r<i;r++){const o=arguments[r-1][a];if(o instanceof Error)return o;if(n=I(o),n instanceof Error)return n;t*=n}e+=t}return e}function $b(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;let e=0;const t=i.length;for(let r=0;r<t;r++)e+=kh(i[r])?i[r]*i[r]:0;return e}function Yb(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;let t=0;for(let r=0;r<i.length;r++)t+=i[r]*i[r]-e[r]*e[r];return t}function Xb(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;let t=0;i=Ye(Ae(i)),e=Ye(Ae(e));for(let r=0;r<i.length;r++)t+=i[r]*i[r]+e[r]*e[r];return t}function qb(i,e){if(i=Ye(Ae(i)),e=Ye(Ae(e)),me(i,e))return j;let t=0;i=Ae(i),e=Ae(e);for(let r=0;r<i.length;r++)t+=Math.pow(i[r]-e[r],2);return t}function Kb(i){return i=I(i),i instanceof Error?i:Math.tan(i)}function jb(i){if(i=I(i),i instanceof Error)return i;const e=Math.exp(2*i);return(e-1)/(e+1)}function Qb(i,e){i=I(i),e=I(e);const t=St(i,e);return t||(i>0?1:-1)*Math.floor(Math.abs(i)*Math.pow(10,e))/Math.pow(10,e)}function Zb(i,e){if(arguments.length!==2)return Je;i=I(i),e=I(e);const t=St(i,e);return t||i+e}function Jb(i,e){if(arguments.length!==2)return Je;i=I(i),e=I(e);const t=St(i,e);return t||(e===0?xr:i/e)}function eT(i,e){return arguments.length!==2?Je:i instanceof Error?i:e instanceof Error?e:(i===null&&(i=void 0),e===null&&(e=void 0),i===e)}function tT(i,e){if(arguments.length!==2)return Je;if(i instanceof Error)return i;if(e instanceof Error)return e;bh(i,e)?(i=ki(i),e=ki(e)):(i=I(i),e=I(e));const t=St(i,e);return t||i>e}function iT(i,e){if(arguments.length!==2)return Je;bh(i,e)?(i=ki(i),e=ki(e)):(i=I(i),e=I(e));const t=St(i,e);return t||i>=e}function rT(i,e){if(arguments.length!==2)return Je;bh(i,e)?(i=ki(i),e=ki(e)):(i=I(i),e=I(e));const t=St(i,e);return t||i<e}function nT(i,e){if(arguments.length!==2)return Je;bh(i,e)?(i=ki(i),e=ki(e)):(i=I(i),e=I(e));const t=St(i,e);return t||i<=e}function sT(i,e){if(arguments.length!==2)return Je;i=I(i),e=I(e);const t=St(i,e);return t||i-e}function aT(i,e){if(arguments.length!==2)return Je;i=I(i),e=I(e);const t=St(i,e);return t||i*e}function oT(i,e){return arguments.length!==2?Je:i instanceof Error?i:e instanceof Error?e:(i===null&&(i=void 0),e===null&&(e=void 0),i!==e)}function lT(i,e){return arguments.length!==2?Je:gv(i,e)}var cT=Object.freeze({__proto__:null,ADD:Zb,DIVIDE:Jb,EQ:eT,GT:tT,GTE:iT,LT:rT,LTE:nT,MINUS:sT,MULTIPLY:aT,NE:oT,POW:lT});const hT=new Date(Date.UTC(1900,0,1)),uT=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],dT=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],jc=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function fT(i,e,t){let r;return i=I(i),e=I(e),t=I(t),me(i,e,t)?r=j:(r=new Date(i,e-1,t),r.getFullYear()<0&&(r=le)),r}function Ns(i,e,t){t=t.toUpperCase(),i=kt(i),e=kt(e);const r=i.getFullYear(),n=i.getMonth(),s=i.getDate(),a=e.getFullYear(),o=e.getMonth(),c=e.getDate();let h;switch(t){case"Y":h=Math.floor(of(i,e));break;case"D":h=oa(e,i);break;case"M":h=o-n+12*(a-r),c<s&&h--;break;case"MD":s<=c?h=c-s:(o===0?(i.setFullYear(a-1),i.setMonth(12)):(i.setFullYear(a),i.setMonth(o-1)),h=oa(e,i));break;case"YM":h=o-n+12*(a-r),c<s&&h--,h=h%12;break;case"YD":o>n||o===n&&c<s?i.setFullYear(a):i.setFullYear(a-1),h=oa(e,i);break}return h}function pT(i){if(typeof i!="string")return j;const e=Date.parse(i);return isNaN(e)?j:new Date(i)}function mT(i){const e=kt(i);return e instanceof Error?e:e.getDate()}function Qc(i){const e=new Date(i);return e.setHours(0,0,0,0),e}function oa(i,e){return i=kt(i),e=kt(e),i instanceof Error?i:e instanceof Error?e:xp(Qc(i))-xp(Qc(e))}function Hs(i,e,t){if(t=Xd(t||"false"),i=kt(i),e=kt(e),i instanceof Error)return i;if(e instanceof Error)return e;if(t instanceof Error)return t;const r=i.getMonth();let n=e.getMonth(),s,a;if(t)s=i.getDate()===31?30:i.getDate(),a=e.getDate()===31?30:e.getDate();else{const o=new Date(i.getFullYear(),r+1,0).getDate(),c=new Date(e.getFullYear(),n+1,0).getDate();s=i.getDate()===o?30:i.getDate(),e.getDate()===c?s<30?(n++,a=1):a=30:a=e.getDate()}return 360*(e.getFullYear()-i.getFullYear())+30*(n-r)+(a-s)}function gT(i,e){if(i=kt(i),i instanceof Error)return i;if(isNaN(e))return j;let t=i.getDate();i.setDate(1),e=parseInt(e,10),i.setMonth(i.getMonth()+e);let r=i.getMonth();if(t>28){let n=[31,28,31,30,31,30,31,31,30,31,30,31][r],s=i.getFullYear();r===1&&(s%4===0&&s%100!==0||s%400===0)&&(n=29),t=Math.min(t,n)}return i.setDate(t),i}function vT(i,e){return i=kt(i),i instanceof Error?i:isNaN(e)?j:(e=parseInt(e,10),new Date(i.getFullYear(),i.getMonth()+e+1,0))}function _T(i){return i=kt(i),i instanceof Error?i:i.getHours()}function vv(i){if(i=kt(i),i instanceof Error)return i;i=Qc(i),i.setDate(i.getDate()+4-(i.getDay()||7));const e=new Date(i.getFullYear(),0,1);return Math.ceil(((i-e)/864e5+1)/7)}function ET(i){return i=kt(i),i instanceof Error?i:i.getMinutes()}function xT(i){return i=kt(i),i instanceof Error?i:i.getMonth()+1}function Oh(i,e,t){return Oh.INTL(i,e,1,t)}Oh.INTL=(i,e,t,r)=>{if(i=kt(i),i instanceof Error)return i;if(e=kt(e),e instanceof Error)return e;let n=!1;const s=[],a=[1,2,3,4,5,6,0],o=new RegExp("^[0|1]{7}$");if(t===void 0)t=jc[1];else if(typeof t=="string"&&o.test(t)){n=!0,t=t.split("");for(let u=0;u<t.length;u++)t[u]==="1"&&s.push(a[u])}else t=jc[t];if(!(t instanceof Array))return j;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let u=0;u<r.length;u++){const d=kt(r[u]);if(d instanceof Error)return d;r[u]=d}const c=Math.round((e-i)/(1e3*60*60*24))+1;let h=c;const l=i;for(let u=0;u<c;u++){const d=new Date().getTimezoneOffset()>0?l.getUTCDay():l.getDay();let f=n?s.includes(d):d===t[0]||d===t[1];for(let p=0;p<r.length;p++){const m=r[p];if(m.getDate()===l.getDate()&&m.getMonth()===l.getMonth()&&m.getFullYear()===l.getFullYear()){f=!0;break}}f&&h--,l.setDate(l.getDate()+1)}return h};function wT(){return new Date}function CT(i){return i=kt(i),i instanceof Error?i:i.getSeconds()}function yT(i,e,t){return i=I(i),e=I(e),t=I(t),me(i,e,t)?j:i<0||e<0||t<0?le:(3600*i+60*e+t)/86400}function ST(i){return i=kt(i),i instanceof Error?i:(3600*i.getHours()+60*i.getMinutes()+i.getSeconds())/86400}function bT(){return Qc(new Date)}function TT(i,e){if(i=kt(i),i instanceof Error)return i;e===void 0&&(e=1);const t=i.getDay();return dT[e][t]}function AT(i,e){if(i=kt(i),i instanceof Error)return i;if(e===void 0&&(e=1),e===21)return vv(i);const t=uT[e];let r=new Date(i.getFullYear(),0,1);const n=r.getDay()<t?1:0;return r-=Math.abs(r.getDay()-t)*24*60*60*1e3,Math.floor((i-r)/(1e3*60*60*24)/7+1)+n}function Ih(i,e,t){return Ih.INTL(i,e,1,t)}Ih.INTL=(i,e,t,r)=>{if(i=kt(i),i instanceof Error)return i;if(e=I(e),e instanceof Error)return e;if(t===void 0?t=jc[1]:t=jc[t],!(t instanceof Array))return j;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let a=0;a<r.length;a++){const o=kt(r[a]);if(o instanceof Error)return o;r[a]=o}let n=0;const s=Math.sign(e);for(;n<e*s;){i.setDate(i.getDate()+s);const a=i.getDay();if(!(a===t[0]||a===t[1])){for(let o=0;o<r.length;o++){const c=r[o];if(c.getDate()===i.getDate()&&c.getMonth()===i.getMonth()&&c.getFullYear()===i.getFullYear()){n--;break}}n++}}return i.getFullYear()<1900?j:i};function kT(i){return i=kt(i),i instanceof Error?i:i.getFullYear()}function Du(i){return new Date(i,1,29).getMonth()===1}function uc(i,e){return Math.ceil((e-i)/1e3/60/60/24)}function of(i,e,t){if(i=kt(i),i instanceof Error)return i;if(e=kt(e),e instanceof Error)return e;t=t||0;let r=i.getDate();const n=i.getMonth()+1,s=i.getFullYear();let a=e.getDate();const o=e.getMonth()+1,c=e.getFullYear();switch(t){case 0:return r===31&&a===31?(r=30,a=30):r===31?r=30:r===30&&a===31&&(a=30),(a+o*30+c*360-(r+n*30+s*360))/360;case 1:{const h=(p,m)=>{const v=p.getFullYear(),_=new Date(v,2,1);if(Du(v)&&p<_&&m>=_)return!0;const x=m.getFullYear(),E=new Date(x,2,1);return Du(x)&&m>=E&&p<E};let l=365;if(s===c||s+1===c&&(n>o||n===o&&r>=a))return(s===c&&Du(s)||h(i,e)||o===1&&a===29)&&(l=366),uc(i,e)/l;const u=c-s+1,f=(new Date(c+1,0,1)-new Date(s,0,1))/1e3/60/60/24/u;return uc(i,e)/f}case 2:return uc(i,e)/360;case 3:return uc(i,e)/365;case 4:return(a+o*30+c*360-(r+n*30+s*360))/360}}function xp(i){const e=i>-22038912e5?2:1;return Math.ceil((i-hT)/864e5)+e}function OT(){throw new Error("ASC is not implemented")}function IT(){throw new Error("BAHTTEXT is not implemented")}function _v(i){return i=I(i),i===0?j:i instanceof Error?i:String.fromCharCode(i)}function RT(i){if(me(i))return i;i=i||"";const e=/[\0-\x1F]/g;return i.replace(e,"")}function Ev(i){if(me(i))return i;i=i||"";let e=i.charCodeAt(0);return isNaN(e)&&(e=j),e}function xv(){const i=Ae(arguments),e=St.apply(void 0,i);if(e)return e;let t=0;for(;(t=i.indexOf(!0))>-1;)i[t]="TRUE";let r=0;for(;(r=i.indexOf(!1))>-1;)i[r]="FALSE";return i.join("")}const DT=xv;function FT(){throw new Error("DBCS is not implemented")}function PT(i,e=2){if(i=I(i),isNaN(i))return j;i=Yn(i,e);const t={style:"currency",currency:"USD",minimumFractionDigits:e>=0?e:0,maximumFractionDigits:e>=0?e:0},r=i.toLocaleString("en-US",t);return i<0?"$("+r.slice(2)+")":r}function NT(i,e){if(arguments.length!==2)return Je;const t=St(i,e);return t||(i=ki(i),e=ki(e),i===e)}function MT(i,e,t){if(arguments.length<2)return Je;i=ki(i),e=ki(e),t=t===void 0?0:t;const r=e.indexOf(i,t-1);return r===-1?j:r+1}function wv(i,e=2,t=!1){if(i=I(i),isNaN(i)||(e=I(e),isNaN(e)))return j;if(e<0){const r=Math.pow(10,-e);i=Math.round(i/r)*r}else i=i.toFixed(e);if(t)i=i.toString().replace(/,/g,"");else{const r=i.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+$)/g,","),i=r.join(".")}return i}function LT(i,e){const t=St(i,e);return t||(i=ki(i),e=e===void 0?1:e,e=I(e),e instanceof Error||typeof i!="string"?j:i.substring(0,e))}function BT(i){return arguments.length===0?$d:i instanceof Error?i:Array.isArray(i)?j:ki(i).length}function HT(i){return arguments.length!==1?j:(i=ki(i),me(i)?i:i.toLowerCase())}function VT(i,e,t){if(e==null)return j;if(e=I(e),t=I(t),me(e,t)||typeof i!="string")return t;const r=e-1,n=r+t;return i.substring(r,n)}function UT(i,e,t){return i=mo(i)?i:"",typeof i=="number"?i:typeof i!="string"?Je:(e=typeof e>"u"?".":e,t=typeof t>"u"?",":t,Number(i.replace(e,".").replace(t,"")))}function WT(){throw new Error("PRONETIC is not implemented")}function zT(i){return me(i)?i:isNaN(i)&&typeof i=="number"?j:(i=ki(i),i.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}function GT(i,e,t,r){return e=I(e),t=I(t),me(e,t)||typeof i!="string"||typeof r!="string"?j:i.substr(0,e-1)+r+i.substr(e-1+t)}function nn(i,e){const t=St(i,e);return t||(i=ki(i),e=I(e),e instanceof Error?e:new Array(e+1).join(i))}function $T(i,e){const t=St(i,e);return t||(i=ki(i),e=e===void 0?1:e,e=I(e),e instanceof Error?e:i.substring(i.length-e))}function YT(i,e,t){let r;return typeof i!="string"||typeof e!="string"?j:(t=t===void 0?0:t,r=e.toLowerCase().indexOf(i.toLowerCase(),t-1)+1,r===0?j:r)}function XT(i,e,t,r){if(arguments.length<3)return Je;if(!i||!e)return i;if(r===void 0)return i.split(e).join(t);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return j;let n=0,s=0;for(;n>-1&&i.indexOf(e,n)>-1;)if(n=i.indexOf(e,n+1),s++,n>-1&&s===r)return i.substring(0,n)+t+i.substring(n+e.length);return i}}function qT(i){return i instanceof Error||typeof i=="string"?i:""}function KT(i,e){if(i===void 0||i instanceof Error||e instanceof Error)return Je;if(i instanceof Date)return i.toISOString().slice(0,10);if(e==null)return"";if(typeof e=="number")return String(e);if(typeof e!="string")return j;const t=e.startsWith("$")?"$":"",r=e.endsWith("%");e=e.replace(/%/g,"").replace(/\$/g,"");const n=e.includes(".")?e.split(".")[1].match(/0/g).length:0,s=!e.includes(",");return r&&(i=i*100),i=wv(i,n,s),i.startsWith("-")?(i=i.replace("-",""),i="-"+t+i):i=t+i,r&&(i=i+"%"),i}function jT(i,e,...t){if(typeof e!="boolean"&&(e=Xd(e)),arguments.length<3)return Je;i=i??"";let r=Ae(t),n=e?r.filter(s=>s):r;if(Array.isArray(i)){i=Ae(i);let s=n.map(o=>[o]),a=0;for(let o=0;o<s.length-1;o++)s[o].push(i[a]),a++,a===i.length&&(a=0);return n=Ae(s),n.join("")}return n.join(i)}function QT(i){return i=ki(i),i instanceof Error?i:i.replace(/\s+/g," ").trim()}const ZT=_v,JT=Ev;function eA(i){return i=ki(i),i instanceof Error?i:i.toUpperCase()}function tA(i){const e=St(i);if(e)return e;if(typeof i=="number")return i;if(mo(i)||(i=""),typeof i!="string")return j;const t=/(%)$/.test(i)||/^(%)/.test(i);if(i=i.replace(/^[^0-9-]{0,3}/,""),i=i.replace(/[^0-9]{0,3}$/,""),i=i.replace(/[ ,]/g,""),i==="")return 0;let r=Number(i);return isNaN(r)?j:(r=r||0,t&&(r=r*.01),r)}function lf(i){return/^[01]{1,10}$/.test(i)}function iA(i,e){return i=I(i),e=I(e),me(i,e)?j:Ch.besseli(i,e)}function rA(i,e){return i=I(i),e=I(e),me(i,e)?j:Ch.besselj(i,e)}function nA(i,e){return i=I(i),e=I(e),me(i,e)?j:Ch.besselk(i,e)}function sA(i,e){return i=I(i),e=I(e),me(i,e)?j:Ch.bessely(i,e)}function aA(i){if(!lf(i))return le;const e=parseInt(i,2),t=i.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:e}function oA(i,e){if(!lf(i))return le;const t=i.toString();if(t.length===10&&t.substring(0,1)==="1")return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);const r=parseInt(i,2).toString(16);return e===void 0?r:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=r.length?nn("0",e-r.length)+r:le)}function lA(i,e){if(!lf(i))return le;const t=i.toString();if(t.length===10&&t.substring(0,1)==="1")return(1073741312+parseInt(t.substring(1),2)).toString(8);const r=parseInt(i,2).toString(8);return e===void 0?r:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=r.length?nn("0",e-r.length)+r:le)}function cA(i,e){return i=I(i),e=I(e),me(i,e)?j:i<0||e<0||Math.floor(i)!==i||Math.floor(e)!==e||i>0xffffffffffff||e>0xffffffffffff?le:i&e}function hA(i,e){return i=I(i),e=I(e),me(i,e)?j:i<0||Math.floor(i)!==i||i>0xffffffffffff||Math.abs(e)>53?le:e>=0?i<<e:i>>-e}function uA(i,e){return i=I(i),e=I(e),me(i,e)?j:i<0||e<0||Math.floor(i)!==i||Math.floor(e)!==e||i>0xffffffffffff||e>0xffffffffffff?le:i|e}function dA(i,e){return i=I(i),e=I(e),me(i,e)?j:i<0||Math.floor(i)!==i||i>0xffffffffffff||Math.abs(e)>53?le:e>=0?i>>e:i<<-e}function fA(i,e){return i=I(i),e=I(e),me(i,e)?j:i<0||e<0||Math.floor(i)!==i||Math.floor(e)!==e||i>0xffffffffffff||e>0xffffffffffff?le:i^e}function wr(i,e,t){if(i=I(i),e=I(e),me(i,e))return i;if(t=t===void 0?"i":t,t!=="i"&&t!=="j")return j;if(i===0&&e===0)return 0;if(i===0)return e===1?t:e.toString()+t;if(e===0)return i.toString();{const r=e>0?"+":"";return i.toString()+r+(e===1?t:e.toString()+t)}}function pA(i,e,t){if(i=I(i),i instanceof Error)return i;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m3",["m^3"],"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],n={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,o=null,c=e,h=t,l=1,u=1,d;for(let f=0;f<r.length;f++)d=r[f][2]===null?[]:r[f][2],(r[f][1]===c||d.indexOf(c)>=0)&&(a=r[f]),(r[f][1]===h||d.indexOf(h)>=0)&&(o=r[f]);if(a===null){const f=n[e.substring(0,2)];let p=s[e.substring(0,1)];e.substring(0,2)==="da"&&(p=["dekao",10,"da"]),f?(l=f[2],c=e.substring(2)):p&&(l=p[1],c=e.substring(p[2].length));for(let m=0;m<r.length;m++)d=r[m][2]===null?[]:r[m][2],(r[m][1]===c||d.indexOf(c)>=0)&&(a=r[m])}if(o===null){const f=n[t.substring(0,2)];let p=s[t.substring(0,1)];t.substring(0,2)==="da"&&(p=["dekao",10,"da"]),f?(u=f[2],h=t.substring(2)):p&&(u=p[1],h=t.substring(p[2].length));for(let m=0;m<r.length;m++)d=r[m][2]===null?[]:r[m][2],(r[m][1]===h||d.indexOf(h)>=0)&&(o=r[m])}return a===null||o===null||a[3]!==o[3]?Je:i*a[6]*l/(o[6]*u)}function mA(i,e){if(i=I(i),i instanceof Error)return i;if(!/^-?[0-9]{1,3}$/.test(i)||i<-512||i>511)return le;if(i<0)return"1"+nn("0",9-(512+i).toString(2).length)+(512+i).toString(2);const t=parseInt(i,10).toString(2);return typeof e>"u"?t:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=t.length?nn("0",e-t.length)+t:le)}function gA(i,e){if(i=I(i),i instanceof Error)return i;if(!/^-?[0-9]{1,12}$/.test(i)||i<-549755813888||i>549755813887)return le;if(i<0)return(1099511627776+i).toString(16);const t=parseInt(i,10).toString(16);return typeof e>"u"?t:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=t.length?nn("0",e-t.length)+t:le)}function vA(i,e){if(i=I(i),i instanceof Error)return i;if(!/^-?[0-9]{1,9}$/.test(i)||i<-536870912||i>536870911)return le;if(i<0)return(1073741824+i).toString(8);const t=parseInt(i,10).toString(8);return typeof e>"u"?t:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=t.length?nn("0",e-t.length)+t:le)}function _A(i,e){return e=e===void 0?0:e,i=I(i),e=I(e),me(i,e)?j:i===e?1:0}function cf(i,e){return e=e===void 0?0:e,i=I(i),e=I(e),me(i,e)?j:$e.erf(i)}cf.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")};function hf(i){return isNaN(i)?j:$e.erfc(i)}hf.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};function EA(i,e){return e=e||0,i=I(i),me(e,i)?i:i>=e?1:0}function xA(i,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(i))return le;const t=i.length===10&&i.substring(0,1).toLowerCase()==="f",r=t?parseInt(i,16)-1099511627776:parseInt(i,16);if(r<-512||r>511)return le;if(t)return"1"+nn("0",9-(512+r).toString(2).length)+(512+r).toString(2);const n=r.toString(2);return e===void 0?n:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=n.length?nn("0",e-n.length)+n:le)}function wA(i){if(!/^[0-9A-Fa-f]{1,10}$/.test(i))return le;const e=parseInt(i,16);return e>=549755813888?e-1099511627776:e}function CA(i,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(i))return le;const t=parseInt(i,16);if(t>536870911&&t<0xffe0000000)return le;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);const r=t.toString(8);return e===void 0?r:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=r.length?nn("0",e-r.length)+r:le)}function uf(i){const e=Jt(i),t=Zt(i);return me(e,t)?j:Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function Zt(i){if(i===void 0||i===!0||i===!1)return j;if(i===0||i==="0")return 0;if(["i","j"].indexOf(i)>=0)return 1;i=i+"",i=i.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let e=i.indexOf("+"),t=i.indexOf("-");e===0&&(e=i.indexOf("+",1)),t===0&&(t=i.indexOf("-",1));const r=i.substring(i.length-1,i.length),n=r==="i"||r==="j";return e>=0||t>=0?n?e>=0?isNaN(i.substring(0,e))||isNaN(i.substring(e+1,i.length-1))?le:Number(i.substring(e+1,i.length-1)):isNaN(i.substring(0,t))||isNaN(i.substring(t+1,i.length-1))?le:-Number(i.substring(t+1,i.length-1)):le:n?isNaN(i.substring(0,i.length-1))?le:i.substring(0,i.length-1):isNaN(i)?le:0}function df(i){const e=Jt(i),t=Zt(i);return me(e,t)?j:e===0&&t===0?xr:e===0&&t>0?Math.PI/2:e===0&&t<0?-Math.PI/2:t===0&&e>0?0:t===0&&e<0?-Math.PI:e>0?Math.atan(t/e):e<0&&t>=0?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI}function yA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",t!==0?wr(e,-t,r):i}function Rh(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.cos(e)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(e)*(Math.exp(t)-Math.exp(-t))/2,r)}function Cv(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.cos(t)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)-Math.exp(-e))/2,r)}function SA(i){const e=Jt(i),t=Zt(i);return me(e,t)?j:Ta(Rh(i),Dh(i))}function Ta(i,e){const t=Jt(i),r=Zt(i),n=Jt(e),s=Zt(e);if(me(t,r,n,s))return j;const a=i.substring(i.length-1),o=e.substring(e.length-1);let c="i";if((a==="j"||o==="j")&&(c="j"),n===0&&s===0)return le;const h=n*n+s*s;return wr((t*n+r*s)/h,(r*n-t*s)/h,c)}function bA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);r=r==="i"||r==="j"?r:"i";const n=Math.exp(e);return wr(n*Math.cos(t),n*Math.sin(t),r)}function TA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.log(Math.sqrt(e*e+t*t)),Math.atan(t/e),r)}function AA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.log(Math.sqrt(e*e+t*t))/Math.log(10),Math.atan(t/e)/Math.log(10),r)}function kA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.log(Math.sqrt(e*e+t*t))/Math.log(2),Math.atan(t/e)/Math.log(2),r)}function OA(i,e){e=I(e);const t=Jt(i),r=Zt(i);if(me(e,t,r))return j;let n=i.substring(i.length-1);n=n==="i"||n==="j"?n:"i";const s=Math.pow(uf(i),e),a=df(i);return wr(s*Math.cos(e*a),s*Math.sin(e*a),n)}function IA(){let i=arguments[0];if(!arguments.length)return j;for(let e=1;e<arguments.length;e++){const t=Jt(i),r=Zt(i),n=Jt(arguments[e]),s=Zt(arguments[e]);if(me(t,r,n,s))return j;i=wr(t*n-r*s,t*s+r*n)}return i}function Jt(i){if(i===void 0||i===!0||i===!1)return j;if(i===0||i==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(i)>=0)return 0;i=i+"";let e=i.indexOf("+"),t=i.indexOf("-");e===0&&(e=i.indexOf("+",1)),t===0&&(t=i.indexOf("-",1));const r=i.substring(i.length-1,i.length),n=r==="i"||r==="j";return e>=0||t>=0?n?e>=0?isNaN(i.substring(0,e))||isNaN(i.substring(e+1,i.length-1))?le:Number(i.substring(0,e)):isNaN(i.substring(0,t))||isNaN(i.substring(t+1,i.length-1))?le:Number(i.substring(0,t)):le:n?isNaN(i.substring(0,i.length-1))?le:0:isNaN(i)?le:i}function RA(i){if(i===!0||i===!1)return j;const e=Jt(i),t=Zt(i);return me(e,t)?j:Ta("1",Rh(i))}function DA(i){const e=Jt(i),t=Zt(i);return me(e,t)?j:Ta("1",Cv(i))}function Dh(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.sin(e)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(e)*(Math.exp(t)-Math.exp(-t))/2,r)}function yv(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);return r=r==="i"||r==="j"?r:"i",wr(Math.cos(t)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(t)*(Math.exp(e)+Math.exp(-e))/2,r)}function FA(i){const e=Jt(i),t=Zt(i);if(me(e,t))return j;let r=i.substring(i.length-1);r=r==="i"||r==="j"?r:"i";const n=Math.sqrt(uf(i)),s=df(i);return wr(n*Math.cos(s/2),n*Math.sin(s/2),r)}function PA(i){if(i===!0||i===!1)return j;const e=Jt(i),t=Zt(i);return me(e,t)?le:Ta("1",Dh(i))}function NA(i){if(i===!0||i===!1)return j;const e=Jt(i),t=Zt(i);return me(e,t)?le:Ta("1",yv(i))}function MA(i,e){const t=Jt(i),r=Zt(i),n=Jt(e),s=Zt(e);if(me(t,r,n,s))return j;const a=i.substring(i.length-1),o=e.substring(e.length-1);let c="i";return(a==="j"||o==="j")&&(c="j"),wr(t-n,r-s,c)}function LA(){if(!arguments.length)return j;const i=Ae(arguments);let e=i[0];for(let t=1;t<i.length;t++){const r=Jt(e),n=Zt(e),s=Jt(i[t]),a=Zt(i[t]);if(me(r,n,s,a))return j;e=wr(r+s,n+a)}return e}function BA(i){if(i===!0||i===!1)return j;const e=Jt(i),t=Zt(i);return me(e,t)?j:Ta(Dh(i),Rh(i))}function HA(i,e){if(!/^[0-7]{1,10}$/.test(i))return le;const t=i.length===10&&i.substring(0,1)==="7",r=t?parseInt(i,8)-1073741824:parseInt(i,8);if(r<-512||r>511)return le;if(t)return"1"+nn("0",9-(512+r).toString(2).length)+(512+r).toString(2);const n=r.toString(2);return typeof e>"u"?n:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=n.length?nn("0",e-n.length)+n:le)}function VA(i){if(!/^[0-7]{1,10}$/.test(i))return le;const e=parseInt(i,8);return e>=536870912?e-1073741824:e}function UA(i,e){if(!/^[0-7]{1,10}$/.test(i))return le;const t=parseInt(i,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);const r=t.toString(16);return e===void 0?r:isNaN(e)?j:e<0?le:(e=Math.floor(e),e>=r.length?nn("0",e-r.length)+r:le)}const WA=kl.DIST,zA=kl.INV,GA=go.DIST,$A=gs.MATH,YA=gs.PRECISE,XA=Mn.DIST,qA=Mn.DIST.RT,KA=Mn.INV,jA=Mn.INV.RT,QA=Mn.TEST,ZA=vo.P,JA=vo.P,e2=vo.S,t2=go.INV,i2=hf.PRECISE,r2=cf.PRECISE,n2=Qd.DIST,s2=Ln.DIST,a2=Ln.DIST.RT,o2=Ln.INV,l2=Ln.INV.RT,c2=va.MATH,h2=va.PRECISE,u2=Ln.TEST,d2=Ol.DIST,f2=Ol.INV,p2=Zd.PRECISE,m2=Jd.DIST,g2=_o.INV,v2=_o.DIST,_2=_o.INV,E2=ma.MULT,x2=ma.SNGL,w2=tf.DIST,C2=Oh.INTL,y2=Bn.DIST,S2=Bn.INV,b2=Bn.S.DIST,T2=Bn.S.INV,A2=en.EXC,k2=en.INC,O2=Il.EXC,I2=Il.INC,R2=rf.DIST,D2=ga.EXC,F2=ga.INC,P2=Rl.AVG,N2=Rl.EQ,M2=nf.P,L2=Ur.P,B2=Ur.S,H2=tn.DIST,V2=tn.DIST.RT,U2=tn.INV,W2=tn.TEST,z2=kr.P,G2=kr.S,$2=sf.DIST,Y2=Ih.INTL,X2=af.TEST;function ff(i){const e=[];return _r(i,t=>{t&&e.push(t)}),e}function xn(i,e){const t={};for(let s=1;s<i[0].length;++s)t[s]=!0;let r=e[0].length;for(let s=1;s<e.length;++s)e[s].length>r&&(r=e[s].length);for(let s=1;s<i.length;++s)for(let a=1;a<i[s].length;++a){let o=!1,c=!1;for(let h=0;h<e.length;++h){const l=e[h];if(l.length<r)continue;const u=l[0];if(i[s][0]===u){c=!0;for(let d=1;d<l.length;++d)if(!o)if(l[d]===void 0||l[d]==="*")o=!0;else{const p=fo(l[d]+""),m=[cs(i[s][a],Gs)].concat(p);o=po(m)}}}c&&(t[a]=t[a]&&o)}const n=[];for(let s=0;s<i[0].length;++s)t[s]&&n.push(s-1);return n}function q2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);let s=0;return _r(r,a=>{s+=n[a]}),r.length===0?xr:s/r.length}function K2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);const s=[];return _r(r,a=>{s.push(n[a])}),ol(s)}function j2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);const s=[];return _r(r,a=>{s.push(n[a])}),ll(s)}function Q2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const s=En(i,e);n=ui(i[s])}else n=ui(i[e]);return r.length===0?j:r.length>1?le:n[r[0]]}function Z2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);let s=n[r[0]];return _r(r,a=>{s<n[a]&&(s=n[a])}),s}function J2(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);let s=n[r[0]];return _r(r,a=>{s>n[a]&&(s=n[a])}),s}function ek(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const o=En(i,e);n=ui(i[o])}else n=ui(i[e]);let s=[];_r(r,o=>{s.push(n[o])}),s=ff(s);let a=1;return _r(s,o=>{a*=o}),a}function tk(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);let s=[];return _r(r,a=>{s.push(n[a])}),s=ff(s),Ur.S(s)}function ik(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);let s=[];return _r(r,a=>{s.push(n[a])}),s=ff(s),Ur.P(s)}function rk(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);const s=[];return _r(r,a=>{s.push(n[a])}),vs(s)}function nk(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);const s=[];return _r(r,a=>{s.push(n[a])}),kr.S(s)}function sk(i,e,t){if(isNaN(e)&&typeof e!="string")return j;const r=xn(i,t);let n=[];if(typeof e=="string"){const a=En(i,e);n=ui(i[a])}else n=ui(i[e]);const s=[];return _r(r,a=>{s.push(n[a])}),kr.P(s)}function Fu(i){return i&&i.getTime&&!isNaN(i.getTime())}function Pu(i){return i instanceof Date?i:new Date(i)}function ak(i,e,t){let r=kt(e);for(r.setFullYear(i.getFullYear()),r<i&&r.setFullYear(r.getFullYear()+1);r>i;)r.setMonth(r.getMonth()+-12/t);return r}function Sv(i){return i=I(i),[1,2,4].indexOf(i)===-1?le:i}function bv(i){return i=I(i),[0,1,2,3,4].indexOf(i)===-1?le:i}function ok(i,e,t,r,n,s,a){return i=Pu(i),e=Pu(e),t=Pu(t),s=Sv(s),a=bv(a),St(s,a)?le:!Fu(i)||!Fu(e)||!Fu(t)?j:r<=0||n<=0||t<=i?le:(n=n||0,a=a||0,n*r*of(i,t,a))}function lk(){throw new Error("ACCRINTM is not implemented")}function ck(){throw new Error("AMORDEGRC is not implemented")}function hk(){throw new Error("AMORLINC is not implemented")}function uk(){throw new Error("COUPDAYBS is not implemented")}function dk(i,e,t,r){if(r=bv(r),t=Sv(t),i=kt(i),e=kt(e),St(i,e))return j;if(St(t,r)||i>=e)return le;if(r===1){let s=ak(i,e,t),a=kt(s);return a.setMonth(a.getMonth()+12/t),Ns(s,a,"D")}let n;switch(r){case 0:case 2:case 4:n=360;break;case 3:n=365;break;default:return le}return n/t}function fk(){throw new Error("COUPDAYSNC is not implemented")}function pk(){throw new Error("COUPNCD is not implemented")}function mk(){throw new Error("COUPNUM is not implemented")}function gk(){throw new Error("COUPPCD is not implemented")}function vk(i,e,t,r,n,s){if(i=I(i),e=I(e),t=I(t),me(i,e,t))return j;if(i<=0||e<=0||t<=0||r<1||n<1||r>n||s!==0&&s!==1)return le;const a=Dl(i,e,t,0,s);let o=0;r===1&&(s===0&&(o=-t),r++);for(let c=r;c<=n;c++)o+=s===1?_a(i,c-2,a,t,1)-a:_a(i,c-1,a,t,0);return o*=i,o}function _k(i,e,t,r,n,s){if(i=I(i),e=I(e),t=I(t),me(i,e,t))return j;if(i<=0||e<=0||t<=0||r<1||n<1||r>n||s!==0&&s!==1)return le;const a=Dl(i,e,t,0,s);let o=0;r===1&&(o=s===0?a+t*i:a,r++);for(let c=r;c<=n;c++)o+=s>0?a-(_a(i,c-2,a,t,1)-a)*i:a-_a(i,c-1,a,t,0)*i;return o}function Ek(i,e,t,r,n){if(n=n===void 0?12:n,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n))return j;if(i<0||e<0||t<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(n)===-1||r>t)return le;if(e>=i)return 0;const s=(1-Math.pow(e/i,1/t)).toFixed(3),a=i*s*n/12;let o=a,c=0;const h=r===t?t-1:r;for(let l=2;l<=h;l++)c=(i-o)*s,o+=c;return r===1?a:r===t?(i-o)*s:c}function xk(i,e,t,r,n){if(n=n===void 0?2:n,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n))return j;if(i<0||e<0||t<0||r<0||n<=0||r>t)return le;if(e>=i)return 0;let s=0,a=0;for(let o=1;o<=r;o++)a=Math.min((i-s)*(n/t),i-e-s),s+=a;return a}function wk(i,e,t,r,n){if(i=kt(i),e=kt(e),t=I(t),r=I(r),n=I(n),n=n||0,me(i,e,t,r,n))return j;if(t<=0||r<=0)return le;if(i>=e)return j;let s,a;switch(n){case 0:s=360,a=Hs(i,e,!1);break;case 1:s=365,a=Ns(i,e,"D");break;case 2:s=360,a=Ns(i,e,"D");break;case 3:s=365,a=Ns(i,e,"D");break;case 4:s=360,a=Hs(i,e,!0);break;default:return le}return(r-t)/r*s/a}function Ck(i,e){if(i=I(i),e=I(e),me(i,e))return j;if(e<0)return le;if(e>=0&&e<1)return xr;e=parseInt(e,10);let t=parseInt(i,10);t+=i%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;const r=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return t=Math.round(t*r)/r,t}function yk(i,e){if(i=I(i),e=I(e),me(i,e))return j;if(e<0)return le;if(e>=0&&e<1)return xr;e=parseInt(e,10);let t=parseInt(i,10);return t+=i%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e,t}function Sk(){throw new Error("DURATION is not implemented")}function bk(i,e){return i=I(i),e=I(e),me(i,e)?j:i<=0||e<1?le:(e=parseInt(e,10),Math.pow(1+i/e,e)-1)}function _a(i,e,t,r,n){if(r=r||0,n=n||0,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n))return j;let s;if(i===0)s=r+t*e;else{const a=Math.pow(1+i,e);s=n===1?r*a+t*(1+i)*(a-1)/i:r*a+t*(a-1)/i}return-s}function Tk(i,e){if(i=I(i),e=Ye(Ae(e)),me(i,e))return j;const t=e.length;let r=i;for(let n=0;n<t;n++)r*=1+e[n];return r}function Ak(){throw new Error("INTRATE is not implemented")}function Tv(i,e,t,r,n,s){if(n=n||0,s=s||0,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),s=I(s),me(i,e,t,r,n,s))return j;const a=Dl(i,t,r,n,s);return(e===1?s===1?0:-r:s===1?_a(i,e-2,a,r,1)-a:_a(i,e-1,a,r,0))*i}function kk(i,e){if(e=e||0,i=Ye(Ae(i)),e=I(e),me(i,e))return j;const t=(f,p,m)=>{const v=m+1;let _=f[0];for(let x=1;x<f.length;x++)_+=f[x]/Math.pow(v,(p[x]-p[0])/365);return _},r=(f,p,m)=>{const v=m+1;let _=0;for(let x=1;x<f.length;x++){const E=(p[x]-p[0])/365;_-=E*f[x]/Math.pow(v,E+1)}return _},n=[];let s=!1,a=!1;for(let f=0;f<i.length;f++)n[f]=f===0?0:n[f-1]+365,i[f]>0&&(s=!0),i[f]<0&&(a=!0);if(!s||!a)return le;e=e===void 0?.1:e;let o=e;const c=1e-10;let h,l,u,d=!0;do u=t(i,n,o),h=o-u/r(i,n,o),l=Math.abs(h-o),o=h,d=l>c&&Math.abs(u)>c;while(d);return o}function Ok(i,e,t,r){return i=I(i),e=I(e),t=I(t),r=I(r),me(i,e,t,r)?j:r*i*(e/t-1)}function Ik(){throw new Error("MDURATION is not implemented")}function Rk(i,e,t){if(i=Ye(Ae(i)),e=I(e),t=I(t),me(i,e,t))return j;const r=i.length,n=[],s=[];for(let c=0;c<r;c++)i[c]<0?n.push(i[c]):s.push(i[c]);const a=-gd(t,s)*Math.pow(1+t,r-1),o=gd(e,n)*(1+e);return Math.pow(a/o,1/(r-1))-1}function Dk(i,e){return i=I(i),e=I(e),me(i,e)?j:i<=0||e<1?le:(e=parseInt(e,10),(Math.pow(i+1,1/e)-1)*e)}function Fk(i,e,t,r,n){if(n=n===void 0?0:n,r=r===void 0?0:r,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n))return j;if(i===0)return-(t+r)/e;{const s=e*(1+i*n)-r*i,a=t*i+e*(1+i*n);return Math.log(s/a)/Math.log(1+i)}}function gd(){const i=Ye(Ae(arguments));if(i instanceof Error)return i;const e=i[0];let t=0;for(let r=1;r<i.length;r++)t+=i[r]/Math.pow(1+e,r);return t}function Pk(){throw new Error("ODDFPRICE is not implemented")}function Nk(){throw new Error("ODDFYIELD is not implemented")}function Mk(){throw new Error("ODDLPRICE is not implemented")}function Lk(){throw new Error("ODDLYIELD is not implemented")}function Bk(i,e,t){return i=I(i),e=I(e),t=I(t),me(i,e,t)?j:i<=0?le:(Math.log(t)-Math.log(e))/Math.log(1+i)}function Dl(i,e,t,r,n){if(r=r||0,n=n||0,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n))return j;let s;if(i===0)s=(t+r)/e;else{const a=Math.pow(1+i,e);s=n===1?(r*i/(a-1)+t*i/(1-1/a))/(1+i):r*i/(a-1)+t*i/(1-1/a)}return-s}function Hk(i,e,t,r,n,s){return n=n||0,s=s||0,i=I(i),t=I(t),r=I(r),n=I(n),s=I(s),me(i,t,r,n,s)?j:Dl(i,t,r,n,s)-Tv(i,e,t,r,n,s)}function Vk(){throw new Error("PRICE is not implemented")}function Uk(i,e,t,r,n){if(i=kt(i),e=kt(e),t=I(t),r=I(r),n=I(n),n=n||0,me(i,e,t,r,n))return j;if(t<=0||r<=0)return le;if(i>=e)return j;let s,a;switch(n){case 0:s=360,a=Hs(i,e,!1);break;case 1:s=365,a=Ns(i,e,"D");break;case 2:s=360,a=Ns(i,e,"D");break;case 3:s=365,a=Ns(i,e,"D");break;case 4:s=360,a=Hs(i,e,!0);break;default:return le}return r-t*r*a/s}function Wk(){throw new Error("PRICEMAT is not implemented")}function zk(i,e,t,r,n){return r=r||0,n=n||0,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),me(i,e,t,r,n)?j:i===0?-t*e-r:((1-Math.pow(1+i,e))/i*t*(1+i*n)-r)/Math.pow(1+i,e)}function Gk(i,e,t,r,n,s){if(s=s===void 0?.01:s,r=r===void 0?0:r,n=n===void 0?0:n,i=I(i),e=I(e),t=I(t),r=I(r),n=I(n),s=I(s),me(i,e,t,r,n,s))return j;const a=1e-10,o=20;let c=s;n=n?1:0;for(let h=0;h<o;h++){if(c<=-1)return le;let l,u;if(Math.abs(c)<a?l=t*(1+i*c)+e*(1+c*n)*i+r:(u=Math.pow(1+c,i),l=t*u+e*(1/c+n)*(u-1)+r),Math.abs(l)<a)return c;let d;if(Math.abs(c)<a)d=t*i+e*n*i;else{u=Math.pow(1+c,i);const f=i*Math.pow(1+c,i-1);d=t*f+e*(1/c+n)*f+e*(-1/(c*c))*(u-1)}c-=l/d}return c}function $k(){throw new Error("RECEIVED is not implemented")}function Yk(i,e,t){return i=I(i),e=I(e),t=I(t),me(i,e,t)?j:i===0||e===0?le:Math.pow(t/e,1/i)-1}function Xk(i,e,t){return i=I(i),e=I(e),t=I(t),me(i,e,t)?j:t===0?le:(i-e)/t}function qk(i,e,t,r){return i=I(i),e=I(e),t=I(t),r=I(r),me(i,e,t,r)?j:t===0||r<1||r>t?le:(r=parseInt(r,10),(i-e)*(t-r+1)*2/(t*(t+1)))}function Kk(i,e,t){return i=kt(i),e=kt(e),t=I(t),me(i,e,t)?j:t<=0||i>e||e-i>365*24*60*60*1e3?le:365*t/(360-t*Hs(i,e,!1))}function jk(i,e,t){return i=kt(i),e=kt(e),t=I(t),me(i,e,t)?j:t<=0||i>e||e-i>365*24*60*60*1e3?le:100*(1-t*Hs(i,e,!1)/360)}function Qk(i,e,t){return i=kt(i),e=kt(e),t=I(t),me(i,e,t)?j:t<=0||i>e||e-i>365*24*60*60*1e3?le:(100-t)*360/(t*Hs(i,e,!1))}function Zk(){throw new Error("VDB is not implemented")}function Jk(i,e,t){if(i=Ye(Ae(i)),e=tv(Ae(e)),t=I(t),me(i,e,t))return j;const r=(f,p,m)=>{const v=m+1;let _=f[0];for(let x=1;x<f.length;x++)_+=f[x]/Math.pow(v,oa(p[x],p[0])/365);return _},n=(f,p,m)=>{const v=m+1;let _=0;for(let x=1;x<f.length;x++){const E=oa(p[x],p[0])/365;_-=E*f[x]/Math.pow(v,E+1)}return _};let s=!1,a=!1;for(let f=0;f<i.length;f++)i[f]>0&&(s=!0),i[f]<0&&(a=!0);if(!s||!a)return le;t=t||.1;let o=t;const c=1e-10;let h,l,u,d=!0;do u=r(i,e,o),h=o-u/n(i,e,o),l=Math.abs(h-o),o=h,d=l>c&&Math.abs(u)>c;while(d);return o}function eO(i,e,t){if(i=I(i),e=Ye(Ae(e)),t=tv(Ae(t)),me(i,e,t))return j;let r=0;for(let n=0;n<e.length;n++)r+=e[n]/Math.pow(1+i,oa(t[n],t[0])/365);return r}function tO(){throw new Error("YIELD is not implemented")}function iO(){throw new Error("YIELDDISC is not implemented")}function rO(){throw new Error("YIELDMAT is not implemented")}function nO(){const i=Ae(arguments);let e=j;for(let t=0;t<i.length;t++){if(i[t]instanceof Error)return i[t];i[t]===void 0||i[t]===null||typeof i[t]=="string"||(e===j&&(e=!0),i[t]||(e=!1))}return e}function sO(){return!1}function aO(i,e,t){return i instanceof Error?i:(e=arguments.length>=2?e:!0,e==null&&(e=0),t=arguments.length===3?t:!1,t==null&&(t=0),i?e:t)}function oO(){for(let i=0;i<arguments.length/2;i++)if(arguments[i*2])return arguments[i*2+1];return Je}function lO(i,e){return Ah(i)?e:i}function cO(i,e){return i===Je?e:i}function hO(i){return typeof i=="string"?j:i instanceof Error?i:!i}function uO(){const i=Ae(arguments);let e=j;for(let t=0;t<i.length;t++){if(i[t]instanceof Error)return i[t];i[t]===void 0||i[t]===null||typeof i[t]=="string"||(e===j&&(e=!1),i[t]&&(e=!0))}return e}function dO(){return!0}function fO(){const i=Ae(arguments);let e=j;for(let t=0;t<i.length;t++){if(i[t]instanceof Error)return i[t];i[t]===void 0||i[t]===null||typeof i[t]=="string"||(e===j&&(e=0),i[t]&&e++)}return e===j?e:!!(Math.floor(Math.abs(e))&1)}function pO(){let i;if(arguments.length>0){const e=arguments[0],t=arguments.length-1,r=Math.floor(t/2);let n=!1;const s=t%2!==0,a=t%2===0?null:arguments[arguments.length-1];if(r){for(let o=0;o<r;o++)if(e===arguments[o*2+1]){i=arguments[o*2+2],n=!0;break}}n||(i=s?a:Je)}else i=j;return i}const mO={errors:Sy,symbols:cT},gO=Object.freeze(Object.defineProperty({__proto__:null,ABS:WS,ACCRINT:ok,ACCRINTM:lk,ACOS:zS,ACOSH:GS,ACOT:$S,ACOTH:YS,AGGREGATE:XS,AMORDEGRC:ck,AMORLINC:hk,AND:nO,ARABIC:qS,ASC:OT,ASIN:KS,ASINH:jS,ATAN:QS,ATAN2:ZS,ATANH:JS,AVEDEV:lS,AVERAGE:pa,AVERAGEA:Kd,AVERAGEIF:cS,AVERAGEIFS:hS,BAHTTEXT:IT,BASE:eb,BESSELI:iA,BESSELJ:rA,BESSELK:nA,BESSELY:sA,BETA:kl,BETADIST:WA,BETAINV:zA,BIN2DEC:aA,BIN2HEX:oA,BIN2OCT:lA,BINOM:go,BINOMDIST:GA,BITAND:cA,BITLSHIFT:hA,BITOR:uA,BITRSHIFT:dA,BITXOR:fA,CEILING:gs,CEILINGMATH:$A,CEILINGPRECISE:YA,CELL:Ly,CHAR:_v,CHIDIST:XA,CHIDISTRT:qA,CHIINV:KA,CHIINVRT:jA,CHISQ:Mn,CHITEST:QA,CHOOSE:Qy,CLEAN:RT,CODE:Ev,COLUMN:Zy,COLUMNS:Jy,COMBIN:Ja,COMBINA:tb,COMPLEX:wr,CONCAT:DT,CONCATENATE:xv,CONFIDENCE:jd,CONVERT:pA,CORREL:uS,COS:ib,COSH:rb,COT:nb,COTH:sb,COUNT:ol,COUNTA:ll,COUNTBLANK:ov,COUNTIF:dS,COUNTIFS:fS,COUPDAYBS:uk,COUPDAYS:dk,COUPDAYSNC:fk,COUPNCD:pk,COUPNUM:mk,COUPPCD:gk,COVAR:ZA,COVARIANCE:vo,COVARIANCEP:JA,COVARIANCES:e2,CRITBINOM:t2,CSC:ab,CSCH:ob,CUMIPMT:vk,CUMPRINC:_k,DATE:fT,DATEDIF:Ns,DATEVALUE:pT,DAVERAGE:q2,DAY:mT,DAYS:oa,DAYS360:Hs,DB:Ek,DBCS:FT,DCOUNT:K2,DCOUNTA:j2,DDB:xk,DEC2BIN:mA,DEC2HEX:gA,DEC2OCT:vA,DECIMAL:lb,DEGREES:cb,DELTA:_A,DEVSQ:pS,DGET:Q2,DISC:wk,DMAX:Z2,DMIN:J2,DOLLAR:PT,DOLLARDE:Ck,DOLLARFR:yk,DPRODUCT:ek,DSTDEV:tk,DSTDEVP:ik,DSUM:rk,DURATION:Sk,DVAR:nk,DVARP:sk,EDATE:gT,EFFECT:bk,EOMONTH:vT,ERF:cf,ERFC:hf,ERFCPRECISE:i2,ERFPRECISE:r2,ERROR:iv,EVEN:hb,EXACT:NT,EXP:ub,EXPON:Qd,EXPONDIST:n2,F:Ln,FACT:hs,FACTDOUBLE:mv,FALSE:sO,FDIST:s2,FDISTRT:a2,FIND:MT,FINV:o2,FINVRT:l2,FISHER:mS,FISHERINV:gS,FIXED:wv,FLOOR:va,FLOORMATH:c2,FLOORPRECISE:h2,FORECAST:lv,FREQUENCY:vS,FTEST:u2,FV:_a,FVSCHEDULE:Tk,GAMMA:Ol,GAMMADIST:d2,GAMMAINV:f2,GAMMALN:Zd,GAMMALNPRECISE:p2,GAUSS:_S,GCD:db,GEOMEAN:ES,GESTEP:EA,GROWTH:xS,HARMEAN:wS,HEX2BIN:xA,HEX2DEC:wA,HEX2OCT:CA,HLOOKUP:eS,HOUR:_T,HYPGEOM:Jd,HYPGEOMDIST:m2,IF:aO,IFERROR:lO,IFNA:cO,IFS:oO,IMABS:uf,IMAGINARY:Zt,IMARGUMENT:df,IMCONJUGATE:yA,IMCOS:Rh,IMCOSH:Cv,IMCOT:SA,IMCSC:PA,IMCSCH:NA,IMDIV:Ta,IMEXP:bA,IMLN:TA,IMLOG10:AA,IMLOG2:kA,IMPOWER:OA,IMPRODUCT:IA,IMREAL:Jt,IMSEC:RA,IMSECH:DA,IMSIN:Dh,IMSINH:yv,IMSQRT:FA,IMSUB:MA,IMSUM:LA,IMTAN:BA,INDEX:tS,INFO:By,INT:fb,INTERCEPT:CS,INTRATE:Ak,IPMT:Tv,IRR:kk,ISBLANK:Hy,ISERR:rv,ISERROR:Ah,ISEVEN:Vy,ISFORMULA:Uy,ISLOGICAL:nv,ISNA:Wy,ISNONTEXT:zy,ISNUMBER:kh,ISO:pb,ISODD:Gy,ISOWEEKNUM:vv,ISPMT:Ok,ISREF:$y,ISTEXT:sv,KURT:yS,LARGE:cv,LCM:mb,LEFT:LT,LEN:BT,LINEST:ef,LN:gb,LOG:vb,LOG10:_b,LOGEST:SS,LOGINV:g2,LOGNORM:_o,LOGNORMDIST:v2,LOGNORMINV:_2,LOOKUP:iS,LOWER:HT,MATCH:rS,MAX:Xc,MAXA:bS,MAXIFS:TS,MDURATION:Ik,MEDIAN:hv,MID:VT,MIN:qc,MINA:AS,MINIFS:kS,MINUTE:ET,MIRR:Rk,MMULT:Eb,MOD:xb,MODE:ma,MODEMULT:E2,MODESNGL:x2,MONTH:xT,MROUND:wb,MULTINOMIAL:Cb,MUNIT:yb,N:Yy,NA:Xy,NEGBINOM:tf,NEGBINOMDIST:w2,NETWORKDAYS:Oh,NETWORKDAYSINTL:C2,NOMINAL:Dk,NORM:Bn,NORMDIST:y2,NORMINV:S2,NORMSDIST:b2,NORMSINV:T2,NOT:hO,NOW:wT,NPER:Fk,NPV:gd,NUMBERVALUE:UT,OCT2BIN:HA,OCT2DEC:VA,OCT2HEX:UA,ODD:Sb,ODDFPRICE:Pk,ODDFYIELD:Nk,ODDLPRICE:Mk,ODDLYIELD:Lk,OR:uO,PDURATION:Bk,PEARSON:uv,PERCENTILE:en,PERCENTILEEXC:A2,PERCENTILEINC:k2,PERCENTRANK:Il,PERCENTRANKEXC:O2,PERCENTRANKINC:I2,PERMUT:OS,PERMUTATIONA:IS,PHI:RS,PI:bb,PMT:Dl,POISSON:rf,POISSONDIST:R2,POWER:gv,PPMT:Hk,PRICE:Vk,PRICEDISC:Uk,PRICEMAT:Wk,PROB:DS,PRODUCT:Kc,PRONETIC:WT,PROPER:zT,PV:zk,QUARTILE:ga,QUARTILEEXC:D2,QUARTILEINC:F2,QUOTIENT:Tb,RADIANS:Ab,RAND:kb,RANDBETWEEN:Ob,RANK:Rl,RANKAVG:P2,RANKEQ:N2,RATE:Gk,RECEIVED:$k,REPLACE:GT,REPT:nn,RIGHT:$T,ROMAN:Ib,ROUND:Yn,ROUNDDOWN:Rb,ROUNDUP:Db,ROW:FS,ROWS:nS,RRI:Yk,RSQ:PS,SEARCH:YT,SEC:Fb,SECH:Pb,SECOND:CT,SERIESSUM:Nb,SHEET:qy,SHEETS:Ky,SIGN:Mb,SIN:Lb,SINH:Bb,SKEW:nf,SKEWP:M2,SLN:Xk,SLOPE:NS,SMALL:dv,SORT:sS,SQRT:Hb,SQRTPI:Vb,STANDARDIZE:MS,STDEV:Ur,STDEVA:LS,STDEVP:L2,STDEVPA:BS,STDEVS:B2,STEYX:HS,SUBSTITUTE:XT,SUBTOTAL:Ub,SUM:vs,SUMIF:Wb,SUMIFS:zb,SUMPRODUCT:Gb,SUMSQ:$b,SUMX2MY2:Yb,SUMX2PY2:Xb,SUMXMY2:qb,SWITCH:pO,SYD:qk,T:qT,TAN:Kb,TANH:jb,TBILLEQ:Kk,TBILLPRICE:jk,TBILLYIELD:Qk,TDIST:H2,TDISTRT:V2,TEXT:KT,TEXTJOIN:jT,TIME:yT,TIMEVALUE:ST,TINV:U2,TODAY:bT,TRANSPOSE:aS,TREND:VS,TRIM:QT,TRIMMEAN:US,TRUE:dO,TRUNC:Qb,TTEST:W2,TYPE:jy,UNICHAR:ZT,UNICODE:JT,UNIQUE:qd,UPPER:eA,VALUE:tA,VAR:kr,VARA:fv,VARP:z2,VARPA:pv,VARS:G2,VDB:Zk,VLOOKUP:av,WEEKDAY:TT,WEEKNUM:AT,WEIBULL:sf,WEIBULLDIST:$2,WORKDAY:Ih,WORKDAYINTL:Y2,XIRR:Jk,XNPV:eO,XOR:fO,YEAR:kT,YEARFRAC:of,YIELD:tO,YIELDDISC:iO,YIELDMAT:rO,Z:af,ZTEST:X2,utils:mO},Symbol.toStringTag,{value:"Module"}));class Nu{static evaluate(e,t){if(!e.startsWith("="))return e;let r=e.substring(1).toUpperCase();const n=/\b([A-Z]+[0-9]+)\b/g,s=r.replace(n,a=>{const o=t(a);return typeof o=="number"?o.toString():`"${o}"`});try{const a={...gO},o=Object.keys(a),c=Object.values(a);return new Function(...o,`return ${s}`)(...c)}catch(a){return console.error("Formula Error:",a,"Expression:",s),"#ERROR!"}}static extractRefs(e){const t=/\b([A-Z]+[0-9]+)\b/g,r=e.match(t);return r?Array.from(new Set(r)):[]}}class Mu{static parseA1(e){const t=e.match(/^([A-Z]+)([0-9]+)$/);if(!t)return null;const r=t[1],n=t[2];let s=0;for(let a=0;a<r.length;a++)s=s*26+(r.charCodeAt(a)-64);return{col:s-1,rowIndex:parseInt(n)-1}}static parseRange(e){const t=e.split(":");if(t.length===1){const s=this.parseA1(t[0]);return s?{x1:s.col,y1:s.rowIndex,x2:s.col,y2:s.rowIndex}:null}const r=this.parseA1(t[0]),n=this.parseA1(t[1]);return!r||!n?null:{x1:Math.min(r.col,n.col),y1:Math.min(r.rowIndex,n.rowIndex),x2:Math.max(r.col,n.col),y2:Math.max(r.rowIndex,n.rowIndex)}}}class wp{constructor(e,t){Ui(this,"id");Ui(this,"name");Ui(this,"order",0);Ui(this,"columns",[]);Ui(this,"gridState",{});Ui(this,"dataModel");Ui(this,"styleStore");Ui(this,"styleApplier");Ui(this,"mergeStore");Ui(this,"dependencyGraph");this.id=e,this.name=t,this.dataModel=new Ey,this.styleStore=new xy,this.styleApplier=new wy(this,this.styleStore),this.mergeStore=new Ep,this.dependencyGraph=new Cy}getId(){return this.id}getName(){return this.name}loadSnapshot(e){this.name=e.name,this.order=e.order,this.columns=e.columns,this.dataModel.setRows(e.rows),this.gridState=e.gridState,this.mergeStore=new Ep(e.merges),this.styleStore.loadStyles(e.styles),this.rebuildGraph(),this.recalculateAll()}getSnapshot(){return{id:this.id,name:this.name,order:this.order,columns:this.columns,rows:this.dataModel.getRows(),gridState:this.gridState,merges:this.mergeStore.getAllMerges(),styles:this.styleStore.getAllStyles()}}setColumns(e){this.columns=e}getColumns(){return this.columns}getDataModel(){return this.dataModel}getStyleStore(){return this.styleStore}getStyleApplier(){return this.styleApplier}getMergeStore(){return this.mergeStore}setCellFormula(e,t,r){const n=this.getCellId(e,t);this.dependencyGraph.clearDependencies(n),Nu.extractRefs(r).forEach(a=>{this.dependencyGraph.addDependency(a,n)}),this.dataModel.setCellValue(e,t,"",r),this.recalculateCell(e,t)}notifyValueChange(e,t){const r=this.getCellId(e,t);this.dependencyGraph.getDependents(r).forEach(s=>{var o;const a=Mu.parseA1(s);if(a){const c=`row-${a.rowIndex}`,h=(o=this.columns[a.col])==null?void 0:o.id;h&&this.recalculateCell(c,h)}})}getCellId(e,t){const r=parseInt(e.replace("row-","")),n=this.columns.findIndex(s=>s.id===t);return this.toA1(n,r)}toA1(e,t){let r="",n=e+1;for(;n>0;){let s=(n-1)%26;r=String.fromCharCode(65+s)+r,n=Math.floor((n-s)/26)}return r+(t+1)}recalculateCell(e,t){const r=this.dataModel.getRows().find(c=>c.id===e),n=r==null?void 0:r.cells[t];if(!n||!n.formula)return;const s=Nu.evaluate(n.formula,c=>{var f;const h=Mu.parseA1(c);if(!h)return 0;const l=`row-${h.rowIndex}`,u=(f=this.columns[h.col])==null?void 0:f.id;if(!u)return 0;const d=this.dataModel.getCellValue(l,u);return isNaN(Number(d))?d:Number(d)});this.dataModel.setCellValue(e,t,s,n.formula);const a=this.getCellId(e,t);this.dependencyGraph.getDependents(a).forEach(c=>{var l;const h=Mu.parseA1(c);if(h){const u=`row-${h.rowIndex}`,d=(l=this.columns[h.col])==null?void 0:l.id;d&&this.recalculateCell(u,d)}})}rebuildGraph(){this.dataModel.getRows().forEach(e=>{Object.entries(e.cells).forEach(([t,r])=>{if(r.formula){const n=this.getCellId(e.id,t);Nu.extractRefs(r.formula).forEach(a=>this.dependencyGraph.addDependency(a,n))}})})}recalculateAll(){this.dataModel.getRows().forEach(e=>{Object.entries(e.cells).forEach(([t,r])=>{r.formula&&this.recalculateCell(e.id,t)})})}}class Cp{constructor(e){Ui(this,"sheets",[]);Ui(this,"activeSheetId",null);Ui(this,"name","Untitled Workbook");e&&this.loadSnapshot(e)}addSheet(e){const t=`sheet-${Date.now()}`,r=new wp(t,e);return this.sheets.push(r),this.activeSheetId||(this.activeSheetId=t),r}getActiveSheet(){return this.sheets.find(e=>e.getId()===this.activeSheetId)||null}setActiveSheet(e){this.activeSheetId=e}getSnapshot(){return{version:1,workbook:{name:this.name,activeSheetId:this.activeSheetId||""},sheets:this.sheets.map(e=>e.getSnapshot())}}loadSnapshot(e){this.name=e.workbook.name,this.activeSheetId=e.workbook.activeSheetId,this.sheets=e.sheets.map(t=>{const r=new wp(t.id,t.name);return r.loadSnapshot(t),r})}getSheets(){return this.sheets}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zc={};Zc.version="0.18.5";var Av=1252,vO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],pf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},mf=function(i){vO.indexOf(i)!=-1&&(Av=pf[0]=i)};function _O(){mf(1252)}var Dn=function(i){mf(i)};function gf(){Dn(1200),_O()}function yp(i){for(var e=[],t=0,r=i.length;t<r;++t)e[t]=i.charCodeAt(t);return e}function EO(i){for(var e=[],t=0;t<i.length>>1;++t)e[t]=String.fromCharCode(i.charCodeAt(2*t)+(i.charCodeAt(2*t+1)<<8));return e.join("")}function kv(i){for(var e=[],t=0;t<i.length>>1;++t)e[t]=String.fromCharCode(i.charCodeAt(2*t+1)+(i.charCodeAt(2*t)<<8));return e.join("")}var Mo=function(i){var e=i.charCodeAt(0),t=i.charCodeAt(1);return e==255&&t==254?EO(i.slice(2)):e==254&&t==255?kv(i.slice(2)):e==65279?i.slice(1):i},dc=function(e){return String.fromCharCode(e)},Sp=function(e){return String.fromCharCode(e)},cl,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function hl(i){for(var e="",t=0,r=0,n=0,s=0,a=0,o=0,c=0,h=0;h<i.length;)t=i.charCodeAt(h++),s=t>>2,r=i.charCodeAt(h++),a=(t&3)<<4|r>>4,n=i.charCodeAt(h++),o=(r&15)<<2|n>>6,c=n&63,isNaN(r)?o=c=64:isNaN(n)&&(c=64),e+=Ds.charAt(s)+Ds.charAt(a)+Ds.charAt(o)+Ds.charAt(c);return e}function sn(i){var e="",t=0,r=0,n=0,s=0,a=0,o=0,c=0;i=i.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<i.length;)s=Ds.indexOf(i.charAt(h++)),a=Ds.indexOf(i.charAt(h++)),t=s<<2|a>>4,e+=String.fromCharCode(t),o=Ds.indexOf(i.charAt(h++)),r=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(r)),c=Ds.indexOf(i.charAt(h++)),n=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(n));return e}var Ot=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xs=function(){if(typeof Buffer<"u"){var i=!Buffer.from;if(!i)try{Buffer.from("foo","utf8")}catch{i=!0}return i?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Vs(i){return Ot?Buffer.alloc?Buffer.alloc(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}function bp(i){return Ot?Buffer.allocUnsafe?Buffer.allocUnsafe(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}var Qr=function(e){return Ot?xs(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Fh(i){if(typeof ArrayBuffer>"u")return Qr(i);for(var e=new ArrayBuffer(i.length),t=new Uint8Array(e),r=0;r!=i.length;++r)t[r]=i.charCodeAt(r)&255;return e}function $s(i){if(Array.isArray(i))return i.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<i.length;++t)e[t]=String.fromCharCode(i[t]);return e.join("")}function xO(i){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(i)}function vf(i){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(i instanceof ArrayBuffer)return vf(new Uint8Array(i));for(var e=new Array(i.length),t=0;t<i.length;++t)e[t]=i[t];return e}var er=Ot?function(i){return Buffer.concat(i.map(function(e){return Buffer.isBuffer(e)?e:xs(e)}))}:function(i){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<i.length;++e)t+=i[e].length;var r=new Uint8Array(t),n=0;for(e=0,t=0;e<i.length;t+=n,++e)if(n=i[e].length,i[e]instanceof Uint8Array)r.set(i[e],t);else{if(typeof i[e]=="string")throw"wtf";r.set(new Uint8Array(i[e]),t)}return r}return[].concat.apply([],i.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function wO(i){for(var e=[],t=0,r=i.length+250,n=Vs(i.length+255),s=0;s<i.length;++s){var a=i.charCodeAt(s);if(a<128)n[t++]=a;else if(a<2048)n[t++]=192|a>>6&31,n[t++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=i.charCodeAt(++s)&1023;n[t++]=240|a>>8&7,n[t++]=128|a>>2&63,n[t++]=128|o>>6&15|(a&3)<<4,n[t++]=128|o&63}else n[t++]=224|a>>12&15,n[t++]=128|a>>6&63,n[t++]=128|a&63;t>r&&(e.push(n.slice(0,t)),t=0,n=Vs(65535),r=65530)}return e.push(n.slice(0,t)),er(e)}var Or=/\u0000/g,Lo=/[\u0001-\u0006]/g;function eo(i){for(var e="",t=i.length-1;t>=0;)e+=i.charAt(t--);return e}function Fn(i,e){var t=""+i;return t.length>=e?t:bi("0",e-t.length)+t}function _f(i,e){var t=""+i;return t.length>=e?t:bi(" ",e-t.length)+t}function Jc(i,e){var t=""+i;return t.length>=e?t:t+bi(" ",e-t.length)}function CO(i,e){var t=""+Math.round(i);return t.length>=e?t:bi("0",e-t.length)+t}function yO(i,e){var t=""+i;return t.length>=e?t:bi("0",e-t.length)+t}var Tp=Math.pow(2,32);function Va(i,e){if(i>Tp||i<-Tp)return CO(i,e);var t=Math.round(i);return yO(t,e)}function eh(i,e){return e=e||0,i.length>=7+e&&(i.charCodeAt(e)|32)===103&&(i.charCodeAt(e+1)|32)===101&&(i.charCodeAt(e+2)|32)===110&&(i.charCodeAt(e+3)|32)===101&&(i.charCodeAt(e+4)|32)===114&&(i.charCodeAt(e+5)|32)===97&&(i.charCodeAt(e+6)|32)===108}var Ap=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SO(i){return i||(i={}),i[0]="General",i[1]="0",i[2]="0.00",i[3]="#,##0",i[4]="#,##0.00",i[9]="0%",i[10]="0.00%",i[11]="0.00E+00",i[12]="# ?/?",i[13]="# ??/??",i[14]="m/d/yy",i[15]="d-mmm-yy",i[16]="d-mmm",i[17]="mmm-yy",i[18]="h:mm AM/PM",i[19]="h:mm:ss AM/PM",i[20]="h:mm",i[21]="h:mm:ss",i[22]="m/d/yy h:mm",i[37]="#,##0 ;(#,##0)",i[38]="#,##0 ;[Red](#,##0)",i[39]="#,##0.00;(#,##0.00)",i[40]="#,##0.00;[Red](#,##0.00)",i[45]="mm:ss",i[46]="[h]:mm:ss",i[47]="mmss.0",i[48]="##0.0E+0",i[49]="@",i[56]='"/ "hh""mm""ss" "',i}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function th(i,e,t){for(var r=i<0?-1:1,n=i*r,s=0,a=1,o=0,c=1,h=0,l=0,u=Math.floor(n);h<e&&(u=Math.floor(n),o=u*a+s,l=u*h+c,!(n-u<5e-8));)n=1/(n-u),s=a,a=o,c=h,h=l;if(l>e&&(h>e?(l=c,o=s):(l=h,o=a)),!t)return[0,r*o,l];var d=Math.floor(r*o/l);return[d,r*o-d*l,l]}function aa(i,e,t){if(i>2958465||i<0)return null;var r=i|0,n=Math.floor(86400*(i-r)),s=0,a=[],o={D:r,T:n,u:86400*(i-r)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++r,++o.D)),r===60)a=t?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=t?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),r<60&&(s=(s+6)%7),t&&(s=RO(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var Ov=new Date(1899,11,31,0,0,0),TO=Ov.getTime(),AO=new Date(1900,2,1,0,0,0);function Iv(i,e){var t=i.getTime();return e?t-=1461*24*60*60*1e3:i>=AO&&(t+=24*60*60*1e3),(t-(TO+(i.getTimezoneOffset()-Ov.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ef(i){return i.indexOf(".")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kO(i){return i.indexOf("E")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function OO(i){var e=i<0?12:11,t=Ef(i.toFixed(12));return t.length<=e||(t=i.toPrecision(10),t.length<=e)?t:i.toExponential(5)}function IO(i){var e=Ef(i.toFixed(11));return e.length>(i<0?12:11)||e==="0"||e==="-0"?i.toPrecision(6):e}function ul(i){var e=Math.floor(Math.log(Math.abs(i))*Math.LOG10E),t;return e>=-4&&e<=-1?t=i.toPrecision(10+e):Math.abs(e)<=9?t=OO(i):e===10?t=i.toFixed(10).substr(0,12):t=IO(i),Ef(kO(t.toUpperCase()))}function Ea(i,e){switch(typeof i){case"string":return i;case"boolean":return i?"TRUE":"FALSE";case"number":return(i|0)===i?i.toString(10):ul(i);case"undefined":return"";case"object":if(i==null)return"";if(i instanceof Date)return _n(14,Iv(i,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+i)}function RO(i,e){e[0]-=581;var t=i.getDay();return i<60&&(t=(t+6)%7),t}function DO(i,e,t,r){var n="",s=0,a=0,o=t.y,c,h=0;switch(i){case 98:o=t.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,h=2;break;default:c=o%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:c=t.m,h=e.length;break;case 3:return Lu[t.m-1][1];case 5:return Lu[t.m-1][0];default:return Lu[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=t.d,h=e.length;break;case 3:return Ap[t.q][0];default:return Ap[t.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(t.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=t.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=t.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Fn(t.S,e.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(t.S+t.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(n=Fn(s,2+r),e==="ss"?n.substr(0,2):"."+n.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:c=o,h=1;break}var l=h>0?Fn(c,h):"";return l}function Fs(i){var e=3;if(i.length<=e)return i;for(var t=i.length%e,r=i.substr(0,t);t!=i.length;t+=e)r+=(r.length>0?",":"")+i.substr(t,e);return r}var Rv=/%/g;function FO(i,e,t){var r=e.replace(Rv,""),n=e.length-r.length;return us(i,r,t*Math.pow(10,2*n))+bi("%",n)}function PO(i,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return us(i,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function Dv(i,e){var t,r=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Dv(i,-e);var n=i.indexOf(".");n===-1&&(n=i.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(r+1+(n+s)%n),t.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,h,l){return c+h+l.substr(0,(n+s)%n)+"."+l.substr(s)+"E"})}else t=e.toExponential(r);return i.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),i.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Fv=/# (\?+)( ?)\/( ?)(\d+)/;function NO(i,e,t){var r=parseInt(i[4],10),n=Math.round(e*r),s=Math.floor(n/r),a=n-s*r,o=r;return t+(s===0?"":""+s)+" "+(a===0?bi(" ",i[1].length+1+i[4].length):_f(a,i[1].length)+i[2]+"/"+i[3]+Fn(o,i[4].length))}function MO(i,e,t){return t+(e===0?"":""+e)+bi(" ",i[1].length+2+i[4].length)}var Pv=/^#*0*\.([0#]+)/,Nv=/\).*[0#]/,Mv=/\(###\) ###\\?-####/;function Tr(i){for(var e="",t,r=0;r!=i.length;++r)switch(t=i.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function Op(i,e){var t=Math.pow(10,e);return""+Math.round(i*t)/t}function Ip(i,e){var t=i-Math.floor(i),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function LO(i,e){return e<(""+Math.round((i-Math.floor(i))*Math.pow(10,e))).length?1:0}function BO(i){return i<2147483647&&i>-2147483648?""+(i>=0?i|0:i-1|0):""+Math.floor(i)}function ln(i,e,t){if(i.charCodeAt(0)===40&&!e.match(Nv)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ln("n",r,t):"("+ln("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return PO(i,e,t);if(e.indexOf("%")!==-1)return FO(i,e,t);if(e.indexOf("E")!==-1)return Dv(e,t);if(e.charCodeAt(0)===36)return"$"+ln(i,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,c=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Va(c,e.length);if(e.match(/^[#?]+$/))return n=Va(t,0),n==="0"&&(n=""),n.length>e.length?n:Tr(e.substr(0,e.length-n.length))+n;if(s=e.match(Fv))return NO(s,c,h);if(e.match(/^#+0+$/))return h+Va(c,e.length-e.indexOf("0"));if(s=e.match(Pv))return n=Op(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])).replace(/\.(\d*)$/,function(p,m){return"."+m+bi("0",Tr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+Op(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+Fs(Va(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ln(i,e,-t):Fs(""+(Math.floor(t)+LO(t,s[1].length)))+"."+Fn(Ip(t,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return ln(i,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=eo(ln(i,e.replace(/[\\-]/g,""),t)),a=0,eo(eo(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<n.length?n.charAt(a++):p==="0"?"0":""}));if(e.match(Mv))return n=ln(i,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var l="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=th(c,Math.pow(10,a)-1,!1),n=""+h,l=us("n",s[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),n+=l+s[2]+"/"+s[3],l=Jc(o[2],a),l.length<s[4].length&&(l=Tr(s[4].substr(s[4].length-l.length))+l),n+=l,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=th(c,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_f(o[1],a)+s[2]+"/"+s[3]+Jc(o[2],a):bi(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=Va(t,0),e.length<=n.length?n:Tr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=e.indexOf(".")-a,d=e.length-n.length-u;return Tr(e.substr(0,u)+n+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Ip(t,s[1].length),t<0?"-"+ln(i,e,-t):Fs(BO(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fn(0,3-p.length):"")+p})+"."+Fn(a,s[1].length);switch(e){case"###,##0.00":return ln(i,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var f=Fs(Va(c,0));return f!=="0"?h+f:"";case"###,###.00":return ln(i,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ln(i,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function HO(i,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return us(i,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function VO(i,e,t){var r=e.replace(Rv,""),n=e.length-r.length;return us(i,r,t*Math.pow(10,2*n))+bi("%",n)}function Lv(i,e){var t,r=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Lv(i,-e);var n=i.indexOf(".");n===-1&&(n=i.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(e/Math.pow(10,s)).toPrecision(r+1+(n+s)%n),!t.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(a-t.length+s):t+="E+"+(a-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,h,l){return c+h+l.substr(0,(n+s)%n)+"."+l.substr(s)+"E"})}else t=e.toExponential(r);return i.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),i.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Un(i,e,t){if(i.charCodeAt(0)===40&&!e.match(Nv)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Un("n",r,t):"("+Un("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return HO(i,e,t);if(e.indexOf("%")!==-1)return VO(i,e,t);if(e.indexOf("E")!==-1)return Lv(e,t);if(e.charCodeAt(0)===36)return"$"+Un(i,e.substr(e.charAt(1)==" "?2:1),t);var n,s,a,o,c=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Fn(c,e.length);if(e.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>e.length?n:Tr(e.substr(0,e.length-n.length))+n;if(s=e.match(Fv))return MO(s,c,h);if(e.match(/^#+0+$/))return h+Fn(c,e.length-e.indexOf("0"));if(s=e.match(Pv))return n=(""+t).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])),n=n.replace(/\.(\d*)$/,function(p,m){return"."+m+bi("0",Tr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return h+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return h+Fs(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Un(i,e,-t):Fs(""+t)+"."+bi("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Un(i,e.replace(/^#,#*,/,""),t);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return n=eo(Un(i,e.replace(/[\\-]/g,""),t)),a=0,eo(eo(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return a<n.length?n.charAt(a++):p==="0"?"0":""}));if(e.match(Mv))return n=Un(i,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var l="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=th(c,Math.pow(10,a)-1,!1),n=""+h,l=us("n",s[1],o[1]),l.charAt(l.length-1)==" "&&(l=l.substr(0,l.length-1)+"0"),n+=l+s[2]+"/"+s[3],l=Jc(o[2],a),l.length<s[4].length&&(l=Tr(s[4].substr(s[4].length-l.length))+l),n+=l,n;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=th(c,Math.pow(10,a)-1,!0),h+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_f(o[1],a)+s[2]+"/"+s[3]+Jc(o[2],a):bi(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return n=""+t,e.length<=n.length?n:Tr(e.substr(0,e.length-n.length))+n;if(s=e.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=n.indexOf(".");var u=e.indexOf(".")-a,d=e.length-n.length-u;return Tr(e.substr(0,u)+n+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Un(i,e,-t):Fs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fn(0,3-p.length):"")+p})+"."+Fn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=Fs(""+c);return f!=="0"?h+f:"";default:if(e.match(/\.[0#?]*$/))return Un(i,e.slice(0,e.lastIndexOf(".")),t)+Tr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function us(i,e,t){return(t|0)===t?Un(i,e,t):ln(i,e,t)}function UO(i){for(var e=[],t=!1,r=0,n=0;r<i.length;++r)switch(i.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=i.substr(n,r-n),n=r+1}if(e[e.length]=i.substr(n),t===!0)throw new Error("Format |"+i+"| unterminated string ");return e}var Bv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Eo(i){for(var e=0,t="",r="";e<i.length;)switch(t=i.charAt(e)){case"G":eh(i,e)&&(e+=6),e++;break;case'"':for(;i.charCodeAt(++e)!==34&&e<i.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(i.charAt(e+1)==="1"||i.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(i.substr(e,3).toUpperCase()==="A/P"||i.substr(e,5).toUpperCase()==="AM/PM"||i.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;i.charAt(e++)!=="]"&&e<i.length;)r+=i.charAt(e);if(r.match(Bv))return!0;break;case".":case"0":case"#":for(;e<i.length&&("0#?.,E+-%".indexOf(t=i.charAt(++e))>-1||t=="\\"&&i.charAt(e+1)=="-"&&"0#".indexOf(i.charAt(e+2))>-1););break;case"?":for(;i.charAt(++e)===t;);break;case"*":++e,(i.charAt(e)==" "||i.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<i.length&&"0123456789".indexOf(i.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function WO(i,e,t,r){for(var n=[],s="",a=0,o="",c="t",h,l,u,d="H";a<i.length;)switch(o=i.charAt(a)){case"G":if(!eh(i,a))throw new Error("unrecognized character "+o+" in "+i);n[n.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(u=i.charCodeAt(++a))!==34&&a<i.length;)s+=String.fromCharCode(u);n[n.length]={t:"t",v:s},++a;break;case"\\":var f=i.charAt(++a),p=f==="("||f===")"?f:"t";n[n.length]={t:p,v:f},++a;break;case"_":n[n.length]={t:"t",v:" "},a+=2;break;case"@":n[n.length]={t:"T",v:e},++a;break;case"B":case"b":if(i.charAt(a+1)==="1"||i.charAt(a+1)==="2"){if(h==null&&(h=aa(e,t,i.charAt(a+1)==="2"),h==null))return"";n[n.length]={t:"X",v:i.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=aa(e,t),h==null))return"";for(s=o;++a<i.length&&i.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var m={t:o,v:o};if(h==null&&(h=aa(e,t)),i.substr(a,3).toUpperCase()==="A/P"?(h!=null&&(m.v=h.H>=12?"P":"A"),m.t="T",d="h",a+=3):i.substr(a,5).toUpperCase()==="AM/PM"?(h!=null&&(m.v=h.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):i.substr(a,5).toUpperCase()==="/"?(h!=null&&(m.v=h.H>=12?"":""),m.t="T",a+=5,d="h"):(m.t="t",++a),h==null&&m.t==="T")return"";n[n.length]=m,c=o;break;case"[":for(s=o;i.charAt(a++)!=="]"&&a<i.length;)s+=i.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Bv)){if(h==null&&(h=aa(e,t),h==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Eo(i)||(n[n.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=o;++a<i.length&&(o=i.charAt(a))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<i.length&&"0#?.,E+-%".indexOf(o=i.charAt(a))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;i.charAt(++a)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++a,(i.charAt(a)==" "||i.charAt(a)=="*")&&++a;break;case"(":case")":n[n.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<i.length&&"0123456789".indexOf(i.charAt(++a))>-1;)s+=i.charAt(a);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++a;break;case"$":n[n.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+i);n[n.length]={t:"t",v:o},++a;break}var v=0,_=0,x;for(a=n.length-1,c="t";a>=0;--a)switch(n[a].t){case"h":case"H":n[a].t=d,c="h",v<1&&(v=1);break;case"s":(x=n[a].v.match(/\.0+$/))&&(_=Math.max(_,x[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=n[a].t;break;case"m":c==="s"&&(n[a].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&n[a].v.match(/[Hh]/)&&(v=1),v<2&&n[a].v.match(/[Mm]/)&&(v=2),v<3&&n[a].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var E="",C;for(a=0;a<n.length;++a)switch(n[a].t){case"t":case"T":case" ":case"D":break;case"X":n[a].v="",n[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[a].v=DO(n[a].t.charCodeAt(0),n[a].v,h,_),n[a].t="t";break;case"n":case"?":for(C=a+1;n[C]!=null&&((o=n[C].t)==="?"||o==="D"||(o===" "||o==="t")&&n[C+1]!=null&&(n[C+1].t==="?"||n[C+1].t==="t"&&n[C+1].v==="/")||n[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[C].v==="/"||n[C].v===" "&&n[C+1]!=null&&n[C+1].t=="?"));)n[a].v+=n[C].v,n[C]={v:"",t:";"},++C;E+=n[a].v,a=C-1;break;case"G":n[a].t="t",n[a].v=Ea(e,t);break}var y="",b,T;if(E.length>0){E.charCodeAt(0)==40?(b=e<0&&E.charCodeAt(0)===45?-e:e,T=us("n",E,b)):(b=e<0&&r>1?-e:e,T=us("n",E,b),b<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),C=T.length-1;var R=n.length;for(a=0;a<n.length;++a)if(n[a]!=null&&n[a].t!="t"&&n[a].v.indexOf(".")>-1){R=a;break}var O=n.length;if(R===n.length&&T.indexOf("E")===-1){for(a=n.length-1;a>=0;--a)n[a]==null||"n?".indexOf(n[a].t)===-1||(C>=n[a].v.length-1?(C-=n[a].v.length,n[a].v=T.substr(C+1,n[a].v.length)):C<0?n[a].v="":(n[a].v=T.substr(0,C+1),C=-1),n[a].t="t",O=a);C>=0&&O<n.length&&(n[O].v=T.substr(0,C+1)+n[O].v)}else if(R!==n.length&&T.indexOf("E")===-1){for(C=T.indexOf(".")-1,a=R;a>=0;--a)if(!(n[a]==null||"n?".indexOf(n[a].t)===-1)){for(l=n[a].v.indexOf(".")>-1&&a===R?n[a].v.indexOf(".")-1:n[a].v.length-1,y=n[a].v.substr(l+1);l>=0;--l)C>=0&&(n[a].v.charAt(l)==="0"||n[a].v.charAt(l)==="#")&&(y=T.charAt(C--)+y);n[a].v=y,n[a].t="t",O=a}for(C>=0&&O<n.length&&(n[O].v=T.substr(0,C+1)+n[O].v),C=T.indexOf(".")+1,a=R;a<n.length;++a)if(!(n[a]==null||"n?(".indexOf(n[a].t)===-1&&a!==R)){for(l=n[a].v.indexOf(".")>-1&&a===R?n[a].v.indexOf(".")+1:0,y=n[a].v.substr(0,l);l<n[a].v.length;++l)C<T.length&&(y+=T.charAt(C++));n[a].v=y,n[a].t="t",O=a}}}for(a=0;a<n.length;++a)n[a]!=null&&"n?".indexOf(n[a].t)>-1&&(b=r>1&&e<0&&a>0&&n[a-1].v==="-"?-e:e,n[a].v=us(n[a].t,n[a].v,b),n[a].t="t");var W="";for(a=0;a!==n.length;++a)n[a]!=null&&(W+=n[a].v);return W}var Rp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dp(i,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(i==t)return!0;break;case">":if(i>t)return!0;break;case"<":if(i<t)return!0;break;case"<>":if(i!=t)return!0;break;case">=":if(i>=t)return!0;break;case"<=":if(i<=t)return!0;break}return!1}function zO(i,e){var t=UO(i),r=t.length,n=t[r-1].indexOf("@");if(r<4&&n>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var a=t[0].match(Rp),o=t[1].match(Rp);return Dp(e,a)?[r,t[0]]:Dp(e,o)?[r,t[1]]:[r,t[a!=null&&o!=null?2:1]]}return[r,s]}function _n(i,e,t){t==null&&(t={});var r="";switch(typeof i){case"string":i=="m/d/yy"&&t.dateNF?r=t.dateNF:r=i;break;case"number":i==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:ht)[i],r==null&&(r=t.table&&t.table[kp[i]]||ht[kp[i]]),r==null&&(r=bO[i]||"General");break}if(eh(r,0))return Ea(e,t);e instanceof Date&&(e=Iv(e,t.date1904));var n=zO(r,e);if(eh(n[1]))return Ea(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return WO(n[1],e,t,n[0])}function ds(i,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(ht[t]==null){e<0&&(e=t);continue}if(ht[t]==i){e=t;break}}e<0&&(e=391)}return ht[e]=i,e}function Ph(i){for(var e=0;e!=392;++e)i[e]!==void 0&&ds(i[e],e)}function xo(){ht=SO()}var GO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Hv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $O(i){var e=typeof i=="number"?ht[i]:i;return e=e.replace(Hv,"(\\d+)"),new RegExp("^"+e+"$")}function YO(i,e,t){var r=-1,n=-1,s=-1,a=-1,o=-1,c=-1;(e.match(Hv)||[]).forEach(function(u,d){var f=parseInt(t[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":r=f;break;case"d":s=f;break;case"h":a=f;break;case"s":c=f;break;case"m":a>=0?o=f:n=f;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var l=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?h:r==-1&&n==-1&&s==-1?l:h+"T"+l}var XO=function(){var i={};i.version="1.2.0";function e(){for(var T=0,R=new Array(256),O=0;O!=256;++O)T=O,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,R[O]=T;return typeof Int32Array<"u"?new Int32Array(R):R}var t=e();function r(T){var R=0,O=0,W=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)G[W]=T[W];for(W=0;W!=256;++W)for(O=T[W],R=256+W;R<4096;R+=256)O=G[R]=O>>>8^T[O&255];var Q=[];for(W=1;W!=16;++W)Q[W-1]=typeof Int32Array<"u"?G.subarray(W*256,W*256+256):G.slice(W*256,W*256+256);return Q}var n=r(t),s=n[0],a=n[1],o=n[2],c=n[3],h=n[4],l=n[5],u=n[6],d=n[7],f=n[8],p=n[9],m=n[10],v=n[11],_=n[12],x=n[13],E=n[14];function C(T,R){for(var O=R^-1,W=0,G=T.length;W<G;)O=O>>>8^t[(O^T.charCodeAt(W++))&255];return~O}function y(T,R){for(var O=R^-1,W=T.length-15,G=0;G<W;)O=E[T[G++]^O&255]^x[T[G++]^O>>8&255]^_[T[G++]^O>>16&255]^v[T[G++]^O>>>24]^m[T[G++]]^p[T[G++]]^f[T[G++]]^d[T[G++]]^u[T[G++]]^l[T[G++]]^h[T[G++]]^c[T[G++]]^o[T[G++]]^a[T[G++]]^s[T[G++]]^t[T[G++]];for(W+=15;G<W;)O=O>>>8^t[(O^T[G++])&255];return~O}function b(T,R){for(var O=R^-1,W=0,G=T.length,Q=0,ne=0;W<G;)Q=T.charCodeAt(W++),Q<128?O=O>>>8^t[(O^Q)&255]:Q<2048?(O=O>>>8^t[(O^(192|Q>>6&31))&255],O=O>>>8^t[(O^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,ne=T.charCodeAt(W++)&1023,O=O>>>8^t[(O^(240|Q>>8&7))&255],O=O>>>8^t[(O^(128|Q>>2&63))&255],O=O>>>8^t[(O^(128|ne>>6&15|(Q&3)<<4))&255],O=O>>>8^t[(O^(128|ne&63))&255]):(O=O>>>8^t[(O^(224|Q>>12&15))&255],O=O>>>8^t[(O^(128|Q>>6&63))&255],O=O>>>8^t[(O^(128|Q&63))&255]);return~O}return i.table=t,i.bstr=C,i.buf=y,i.str=b,i}(),st=function(){var e={};e.version="1.2.1";function t(k,L){for(var D=k.split("/"),N=L.split("/"),H=0,z=0,se=Math.min(D.length,N.length);H<se;++H){if(z=D[H].length-N[H].length)return z;if(D[H]!=N[H])return D[H]<N[H]?-1:1}return D.length-N.length}function r(k){if(k.charAt(k.length-1)=="/")return k.slice(0,-1).indexOf("/")===-1?k:r(k.slice(0,-1));var L=k.lastIndexOf("/");return L===-1?k:k.slice(0,L+1)}function n(k){if(k.charAt(k.length-1)=="/")return n(k.slice(0,-1));var L=k.lastIndexOf("/");return L===-1?k:k.slice(L+1)}function s(k,L){typeof L=="string"&&(L=new Date(L));var D=L.getHours();D=D<<6|L.getMinutes(),D=D<<5|L.getSeconds()>>>1,k.write_shift(2,D);var N=L.getFullYear()-1980;N=N<<4|L.getMonth()+1,N=N<<5|L.getDate(),k.write_shift(2,N)}function a(k){var L=k.read_shift(2)&65535,D=k.read_shift(2)&65535,N=new Date,H=D&31;D>>>=5;var z=D&15;D>>>=4,N.setMilliseconds(0),N.setFullYear(D+1980),N.setMonth(z-1),N.setDate(H);var se=L&31;L>>>=5;var ge=L&63;return L>>>=6,N.setHours(L),N.setMinutes(ge),N.setSeconds(se<<1),N}function o(k){sr(k,0);for(var L={},D=0;k.l<=k.length-4;){var N=k.read_shift(2),H=k.read_shift(2),z=k.l+H,se={};switch(N){case 21589:D=k.read_shift(1),D&1&&(se.mtime=k.read_shift(4)),H>5&&(D&2&&(se.atime=k.read_shift(4)),D&4&&(se.ctime=k.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}k.l=z,L[N]=se}return L}var c;function h(){return c||(c={})}function l(k,L){if(k[0]==80&&k[1]==75)return Ki(k,L);if((k[0]|32)==109&&(k[1]|32)==105)return Ge(k,L);if(k.length<512)throw new Error("CFB file size "+k.length+" < 512");var D=3,N=512,H=0,z=0,se=0,ge=0,ae=0,ce=[],J=k.slice(0,512);sr(J,0);var P=u(J);switch(D=P[0],D){case 3:N=512;break;case 4:N=4096;break;case 0:if(P[1]==0)return Ki(k,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}N!==512&&(J=k.slice(0,N),sr(J,28));var re=k.slice(0,N);d(J,D);var pe=J.read_shift(4,"i");if(D===3&&pe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pe);J.l+=4,se=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ge=J.read_shift(4,"i"),H=J.read_shift(4,"i"),ae=J.read_shift(4,"i"),z=J.read_shift(4,"i");for(var Se=-1,Ne=0;Ne<109&&(Se=J.read_shift(4,"i"),!(Se<0));++Ne)ce[Ne]=Se;var Le=f(k,N);v(ae,z,Le,N,ce);var Ct=x(Le,se,ce,N);Ct[se].name="!Directory",H>0&&ge!==ne&&(Ct[ge].name="!MiniFAT"),Ct[ce[0]].name="!FAT",Ct.fat_addrs=ce,Ct.ssz=N;var Ft={},si=[],Dr=[],Vt=[];E(se,Ct,Le,si,H,Ft,Dr,ge),p(Dr,Vt,si),si.shift();var an={FileIndex:Dr,FullPaths:Vt};return L&&L.raw&&(an.raw={header:re,sectors:Le}),an}function u(k){if(k[k.l]==80&&k[k.l+1]==75)return[0,0];k.chk(xe,"Header Signature: "),k.l+=16;var L=k.read_shift(2,"u");return[k.read_shift(2,"u"),L]}function d(k,L){var D=9;switch(k.l+=2,D=k.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}k.chk("0600","Mini Sector Shift: "),k.chk("000000000000","Reserved: ")}function f(k,L){for(var D=Math.ceil(k.length/L)-1,N=[],H=1;H<D;++H)N[H-1]=k.slice(H*L,(H+1)*L);return N[D-1]=k.slice(D*L),N}function p(k,L,D){for(var N=0,H=0,z=0,se=0,ge=0,ae=D.length,ce=[],J=[];N<ae;++N)ce[N]=J[N]=N,L[N]=D[N];for(;ge<J.length;++ge)N=J[ge],H=k[N].L,z=k[N].R,se=k[N].C,ce[N]===N&&(H!==-1&&ce[H]!==H&&(ce[N]=ce[H]),z!==-1&&ce[z]!==z&&(ce[N]=ce[z])),se!==-1&&(ce[se]=N),H!==-1&&N!=ce[N]&&(ce[H]=ce[N],J.lastIndexOf(H)<ge&&J.push(H)),z!==-1&&N!=ce[N]&&(ce[z]=ce[N],J.lastIndexOf(z)<ge&&J.push(z));for(N=1;N<ae;++N)ce[N]===N&&(z!==-1&&ce[z]!==z?ce[N]=ce[z]:H!==-1&&ce[H]!==H&&(ce[N]=ce[H]));for(N=1;N<ae;++N)if(k[N].type!==0){if(ge=N,ge!=ce[ge])do ge=ce[ge],L[N]=L[ge]+"/"+L[N];while(ge!==0&&ce[ge]!==-1&&ge!=ce[ge]);ce[N]=-1}for(L[0]+="/",N=1;N<ae;++N)k[N].type!==2&&(L[N]+="/")}function m(k,L,D){for(var N=k.start,H=k.size,z=[],se=N;D&&H>0&&se>=0;)z.push(L.slice(se*Q,se*Q+Q)),H-=Q,se=na(D,se*4);return z.length===0?_e(0):er(z).slice(0,k.size)}function v(k,L,D,N,H){var z=ne;if(k===ne){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(k!==-1){var se=D[k],ge=(N>>>2)-1;if(!se)return;for(var ae=0;ae<ge&&(z=na(se,ae*4))!==ne;++ae)H.push(z);v(na(se,N-4),L-1,D,N,H)}}function _(k,L,D,N,H){var z=[],se=[];H||(H=[]);var ge=N-1,ae=0,ce=0;for(ae=L;ae>=0;){H[ae]=!0,z[z.length]=ae,se.push(k[ae]);var J=D[Math.floor(ae*4/N)];if(ce=ae*4&ge,N<4+ce)throw new Error("FAT boundary crossed: "+ae+" 4 "+N);if(!k[J])break;ae=na(k[J],ce)}return{nodes:z,data:Gp([se])}}function x(k,L,D,N){var H=k.length,z=[],se=[],ge=[],ae=[],ce=N-1,J=0,P=0,re=0,pe=0;for(J=0;J<H;++J)if(ge=[],re=J+L,re>=H&&(re-=H),!se[re]){ae=[];var Se=[];for(P=re;P>=0;){Se[P]=!0,se[P]=!0,ge[ge.length]=P,ae.push(k[P]);var Ne=D[Math.floor(P*4/N)];if(pe=P*4&ce,N<4+pe)throw new Error("FAT boundary crossed: "+P+" 4 "+N);if(!k[Ne]||(P=na(k[Ne],pe),Se[P]))break}z[re]={nodes:ge,data:Gp([ae])}}return z}function E(k,L,D,N,H,z,se,ge){for(var ae=0,ce=N.length?2:0,J=L[k].data,P=0,re=0,pe;P<J.length;P+=128){var Se=J.slice(P,P+128);sr(Se,64),re=Se.read_shift(2),pe=Tf(Se,0,re-ce),N.push(pe);var Ne={name:pe,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0},Le=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Le!==0&&(Ne.ct=C(Se,Se.l-8));var Ct=Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2);Ct!==0&&(Ne.mt=C(Se,Se.l-8)),Ne.start=Se.read_shift(4,"i"),Ne.size=Se.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=ne,Ne.name=""),Ne.type===5?(ae=Ne.start,H>0&&ae!==ne&&(L[ae].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",L[Ne.start]===void 0&&(L[Ne.start]=_(D,Ne.start,L.fat_addrs,L.ssz)),L[Ne.start].name=Ne.name,Ne.content=L[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:ae!==ne&&Ne.start!==ne&&L[ae]&&(Ne.content=m(Ne,L[ae].data,(L[ge]||{}).data))),Ne.content&&sr(Ne.content,0),z[pe]=Ne,se.push(Ne)}}function C(k,L){return new Date((jr(k,L+4)/1e7*Math.pow(2,32)+jr(k,L)/1e7-11644473600)*1e3)}function y(k,L){return h(),l(c.readFileSync(k),L)}function b(k,L){var D=L&&L.type;switch(D||Ot&&Buffer.isBuffer(k)&&(D="buffer"),D||"base64"){case"file":return y(k,L);case"base64":return l(Qr(sn(k)),L);case"binary":return l(Qr(k),L)}return l(k,L)}function T(k,L){var D=L||{},N=D.root||"Root Entry";if(k.FullPaths||(k.FullPaths=[]),k.FileIndex||(k.FileIndex=[]),k.FullPaths.length!==k.FileIndex.length)throw new Error("inconsistent CFB structure");k.FullPaths.length===0&&(k.FullPaths[0]=N+"/",k.FileIndex[0]={name:N,type:5}),D.CLSID&&(k.FileIndex[0].clsid=D.CLSID),R(k)}function R(k){var L="Sh33tJ5";if(!st.find(k,"/"+L)){var D=_e(4);D[0]=55,D[1]=D[3]=50,D[2]=54,k.FileIndex.push({name:L,type:2,content:D,size:4,L:69,R:69,C:69}),k.FullPaths.push(k.FullPaths[0]+L),O(k)}}function O(k,L){T(k);for(var D=!1,N=!1,H=k.FullPaths.length-1;H>=0;--H){var z=k.FileIndex[H];switch(z.type){case 0:N?D=!0:(k.FileIndex.pop(),k.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(z.R*z.L*z.C)&&(D=!0),z.R>-1&&z.L>-1&&z.R==z.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!L)){var se=new Date(1987,1,19),ge=0,ae=Object.create?Object.create(null):{},ce=[];for(H=0;H<k.FullPaths.length;++H)ae[k.FullPaths[H]]=!0,k.FileIndex[H].type!==0&&ce.push([k.FullPaths[H],k.FileIndex[H]]);for(H=0;H<ce.length;++H){var J=r(ce[H][0]);N=ae[J],N||(ce.push([J,{name:n(J).replace("/",""),type:1,clsid:Fe,ct:se,mt:se,content:null}]),ae[J]=!0)}for(ce.sort(function(pe,Se){return t(pe[0],Se[0])}),k.FullPaths=[],k.FileIndex=[],H=0;H<ce.length;++H)k.FullPaths[H]=ce[H][0],k.FileIndex[H]=ce[H][1];for(H=0;H<ce.length;++H){var P=k.FileIndex[H],re=k.FullPaths[H];if(P.name=n(re).replace("/",""),P.L=P.R=P.C=-(P.color=1),P.size=P.content?P.content.length:0,P.start=0,P.clsid=P.clsid||Fe,H===0)P.C=ce.length>1?1:-1,P.size=0,P.type=5;else if(re.slice(-1)=="/"){for(ge=H+1;ge<ce.length&&r(k.FullPaths[ge])!=re;++ge);for(P.C=ge>=ce.length?-1:ge,ge=H+1;ge<ce.length&&r(k.FullPaths[ge])!=r(re);++ge);P.R=ge>=ce.length?-1:ge,P.type=1}else r(k.FullPaths[H+1]||"")==r(re)&&(P.R=H+1),P.type=2}}}function W(k,L){var D=L||{};if(D.fileType=="mad")return lt(k,D);switch(O(k),D.fileType){case"zip":return qs(k,D)}var N=function(pe){for(var Se=0,Ne=0,Le=0;Le<pe.FileIndex.length;++Le){var Ct=pe.FileIndex[Le];if(Ct.content){var Ft=Ct.content.length;Ft>0&&(Ft<4096?Se+=Ft+63>>6:Ne+=Ft+511>>9)}}for(var si=pe.FullPaths.length+3>>2,Dr=Se+7>>3,Vt=Se+127>>7,an=Dr+Ne+si+Vt,Hi=an+127>>7,Ks=Hi<=109?0:Math.ceil((Hi-109)/127);an+Hi+Ks+127>>7>Hi;)Ks=++Hi<=109?0:Math.ceil((Hi-109)/127);var Cn=[1,Ks,Hi,Vt,si,Ne,Se,0];return pe.FileIndex[0].size=Se<<6,Cn[7]=(pe.FileIndex[0].start=Cn[0]+Cn[1]+Cn[2]+Cn[3]+Cn[4]+Cn[5])+(Cn[6]+7>>3),Cn}(k),H=_e(N[7]<<9),z=0,se=0;{for(z=0;z<8;++z)H.write_shift(1,Ce[z]);for(z=0;z<8;++z)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),z=0;z<3;++z)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,N[2]),H.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:ne),H.write_shift(4,N[3]),H.write_shift(-4,N[1]?N[0]-1:ne),H.write_shift(4,N[1]),z=0;z<109;++z)H.write_shift(-4,z<N[2]?N[1]+z:-1)}if(N[1])for(se=0;se<N[1];++se){for(;z<236+se*127;++z)H.write_shift(-4,z<N[2]?N[1]+z:-1);H.write_shift(-4,se===N[1]-1?ne:se+1)}var ge=function(pe){for(se+=pe;z<se-1;++z)H.write_shift(-4,z+1);pe&&(++z,H.write_shift(-4,ne))};for(se=z=0,se+=N[1];z<se;++z)H.write_shift(-4,ke.DIFSECT);for(se+=N[2];z<se;++z)H.write_shift(-4,ke.FATSECT);ge(N[3]),ge(N[4]);for(var ae=0,ce=0,J=k.FileIndex[0];ae<k.FileIndex.length;++ae)J=k.FileIndex[ae],J.content&&(ce=J.content.length,!(ce<4096)&&(J.start=se,ge(ce+511>>9)));for(ge(N[6]+7>>3);H.l&511;)H.write_shift(-4,ke.ENDOFCHAIN);for(se=z=0,ae=0;ae<k.FileIndex.length;++ae)J=k.FileIndex[ae],J.content&&(ce=J.content.length,!(!ce||ce>=4096)&&(J.start=se,ge(ce+63>>6)));for(;H.l&511;)H.write_shift(-4,ke.ENDOFCHAIN);for(z=0;z<N[4]<<2;++z){var P=k.FullPaths[z];if(!P||P.length===0){for(ae=0;ae<17;++ae)H.write_shift(4,0);for(ae=0;ae<3;++ae)H.write_shift(4,-1);for(ae=0;ae<12;++ae)H.write_shift(4,0);continue}J=k.FileIndex[z],z===0&&(J.start=J.size?J.start-1:ne);var re=z===0&&D.root||J.name;if(ce=2*(re.length+1),H.write_shift(64,re,"utf16le"),H.write_shift(2,ce),H.write_shift(1,J.type),H.write_shift(1,J.color),H.write_shift(-4,J.L),H.write_shift(-4,J.R),H.write_shift(-4,J.C),J.clsid)H.write_shift(16,J.clsid,"hex");else for(ae=0;ae<4;++ae)H.write_shift(4,0);H.write_shift(4,J.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,J.start),H.write_shift(4,J.size),H.write_shift(4,0)}for(z=1;z<k.FileIndex.length;++z)if(J=k.FileIndex[z],J.size>=4096)if(H.l=J.start+1<<9,Ot&&Buffer.isBuffer(J.content))J.content.copy(H,H.l,0,J.size),H.l+=J.size+511&-512;else{for(ae=0;ae<J.size;++ae)H.write_shift(1,J.content[ae]);for(;ae&511;++ae)H.write_shift(1,0)}for(z=1;z<k.FileIndex.length;++z)if(J=k.FileIndex[z],J.size>0&&J.size<4096)if(Ot&&Buffer.isBuffer(J.content))J.content.copy(H,H.l,0,J.size),H.l+=J.size+63&-64;else{for(ae=0;ae<J.size;++ae)H.write_shift(1,J.content[ae]);for(;ae&63;++ae)H.write_shift(1,0)}if(Ot)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function G(k,L){var D=k.FullPaths.map(function(ae){return ae.toUpperCase()}),N=D.map(function(ae){var ce=ae.split("/");return ce[ce.length-(ae.slice(-1)=="/"?2:1)]}),H=!1;L.charCodeAt(0)===47?(H=!0,L=D[0].slice(0,-1)+L):H=L.indexOf("/")!==-1;var z=L.toUpperCase(),se=H===!0?D.indexOf(z):N.indexOf(z);if(se!==-1)return k.FileIndex[se];var ge=!z.match(Lo);for(z=z.replace(Or,""),ge&&(z=z.replace(Lo,"!")),se=0;se<D.length;++se)if((ge?D[se].replace(Lo,"!"):D[se]).replace(Or,"")==z||(ge?N[se].replace(Lo,"!"):N[se]).replace(Or,"")==z)return k.FileIndex[se];return null}var Q=64,ne=-2,xe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],Fe="00000000000000000000000000000000",ke={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ze(k,L,D){h();var N=W(k,D);c.writeFileSync(L,N)}function ie(k){for(var L=new Array(k.length),D=0;D<k.length;++D)L[D]=String.fromCharCode(k[D]);return L.join("")}function Ee(k,L){var D=W(k,L);switch(L&&L.type||"buffer"){case"file":return h(),c.writeFileSync(L.filename,D),D;case"binary":return typeof D=="string"?D:ie(D);case"base64":return hl(typeof D=="string"?D:ie(D));case"buffer":if(Ot)return Buffer.isBuffer(D)?D:xs(D);case"array":return typeof D=="string"?Qr(D):D}return D}var Pe;function U(k){try{var L=k.InflateRaw,D=new L;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)Pe=k;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function Z(k,L){if(!Pe)return Bi(k,L);var D=Pe.InflateRaw,N=new D,H=N._processChunk(k.slice(k.l),N._finishFlushFlag);return k.l+=N.bytesRead,H}function q(k){return Pe?Pe.deflateRawSync(k):vt(k)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(k){var L=(k<<1|k<<11)&139536|(k<<5|k<<15)&558144;return(L>>16|L>>8|L)&255}for(var Re=typeof Uint8Array<"u",be=Re?new Uint8Array(256):[],ue=0;ue<256;++ue)be[ue]=we(ue);function M(k,L){var D=be[k&255];return L<=8?D>>>8-L:(D=D<<8|be[k>>8&255],L<=16?D>>>16-L:(D=D<<8|be[k>>16&255],D>>>24-L))}function it(k,L){var D=L&7,N=L>>>3;return(k[N]|(D<=6?0:k[N+1]<<8))>>>D&3}function et(k,L){var D=L&7,N=L>>>3;return(k[N]|(D<=5?0:k[N+1]<<8))>>>D&7}function he(k,L){var D=L&7,N=L>>>3;return(k[N]|(D<=4?0:k[N+1]<<8))>>>D&15}function Qe(k,L){var D=L&7,N=L>>>3;return(k[N]|(D<=3?0:k[N+1]<<8))>>>D&31}function Te(k,L){var D=L&7,N=L>>>3;return(k[N]|(D<=1?0:k[N+1]<<8))>>>D&127}function dt(k,L,D){var N=L&7,H=L>>>3,z=(1<<D)-1,se=k[H]>>>N;return D<8-N||(se|=k[H+1]<<8-N,D<16-N)||(se|=k[H+2]<<16-N,D<24-N)||(se|=k[H+3]<<24-N),se&z}function wt(k,L,D){var N=L&7,H=L>>>3;return N<=5?k[H]|=(D&7)<<N:(k[H]|=D<<N&255,k[H+1]=(D&7)>>8-N),L+3}function Gt(k,L,D){var N=L&7,H=L>>>3;return D=(D&1)<<N,k[H]|=D,L+1}function Ri(k,L,D){var N=L&7,H=L>>>3;return D<<=N,k[H]|=D&255,D>>>=8,k[H+1]=D,L+8}function or(k,L,D){var N=L&7,H=L>>>3;return D<<=N,k[H]|=D&255,D>>>=8,k[H+1]=D&255,k[H+2]=D>>>8,L+16}function lr(k,L){var D=k.length,N=2*D>L?2*D:L+5,H=0;if(D>=L)return k;if(Ot){var z=bp(N);if(k.copy)k.copy(z);else for(;H<k.length;++H)z[H]=k[H];return z}else if(Re){var se=new Uint8Array(N);if(se.set)se.set(k);else for(;H<D;++H)se[H]=k[H];return se}return k.length=N,k}function ni(k){for(var L=new Array(k),D=0;D<k;++D)L[D]=0;return L}function $t(k,L,D){var N=1,H=0,z=0,se=0,ge=0,ae=k.length,ce=Re?new Uint16Array(32):ni(32);for(z=0;z<32;++z)ce[z]=0;for(z=ae;z<D;++z)k[z]=0;ae=k.length;var J=Re?new Uint16Array(ae):ni(ae);for(z=0;z<ae;++z)ce[H=k[z]]++,N<H&&(N=H),J[z]=0;for(ce[0]=0,z=1;z<=N;++z)ce[z+16]=ge=ge+ce[z-1]<<1;for(z=0;z<ae;++z)ge=k[z],ge!=0&&(J[z]=ce[ge+16]++);var P=0;for(z=0;z<ae;++z)if(P=k[z],P!=0)for(ge=M(J[z],N)>>N-P,se=(1<<N+4-P)-1;se>=0;--se)L[ge|se<<P]=P&15|z<<4;return N}var He=Re?new Uint16Array(512):ni(512),Di=Re?new Uint16Array(32):ni(32);if(!Re){for(var Nt=0;Nt<512;++Nt)He[Nt]=0;for(Nt=0;Nt<32;++Nt)Di[Nt]=0}(function(){for(var k=[],L=0;L<32;L++)k.push(5);$t(k,Di,32);var D=[];for(L=0;L<=143;L++)D.push(8);for(;L<=255;L++)D.push(9);for(;L<=279;L++)D.push(7);for(;L<=287;L++)D.push(8);$t(D,He,288)})();var Li=function(){for(var L=Re?new Uint8Array(32768):[],D=0,N=0;D<Ie.length-1;++D)for(;N<Ie[D+1];++N)L[N]=D;for(;N<32768;++N)L[N]=29;var H=Re?new Uint8Array(259):[];for(D=0,N=0;D<de.length-1;++D)for(;N<de[D+1];++N)H[N]=D;function z(ge,ae){for(var ce=0;ce<ge.length;){var J=Math.min(65535,ge.length-ce),P=ce+J==ge.length;for(ae.write_shift(1,+P),ae.write_shift(2,J),ae.write_shift(2,~J&65535);J-- >0;)ae[ae.l++]=ge[ce++]}return ae.l}function se(ge,ae){for(var ce=0,J=0,P=Re?new Uint16Array(32768):[];J<ge.length;){var re=Math.min(65535,ge.length-J);if(re<10){for(ce=wt(ae,ce,+(J+re==ge.length)),ce&7&&(ce+=8-(ce&7)),ae.l=ce/8|0,ae.write_shift(2,re),ae.write_shift(2,~re&65535);re-- >0;)ae[ae.l++]=ge[J++];ce=ae.l*8;continue}ce=wt(ae,ce,+(J+re==ge.length)+2);for(var pe=0;re-- >0;){var Se=ge[J];pe=(pe<<5^Se)&32767;var Ne=-1,Le=0;if((Ne=P[pe])&&(Ne|=J&-32768,Ne>J&&(Ne-=32768),Ne<J))for(;ge[Ne+Le]==ge[J+Le]&&Le<250;)++Le;if(Le>2){Se=H[Le],Se<=22?ce=Ri(ae,ce,be[Se+1]>>1)-1:(Ri(ae,ce,3),ce+=5,Ri(ae,ce,be[Se-23]>>5),ce+=3);var Ct=Se<8?0:Se-4>>2;Ct>0&&(or(ae,ce,Le-de[Se]),ce+=Ct),Se=L[J-Ne],ce=Ri(ae,ce,be[Se]>>3),ce-=3;var Ft=Se<4?0:Se-2>>1;Ft>0&&(or(ae,ce,J-Ne-Ie[Se]),ce+=Ft);for(var si=0;si<Le;++si)P[pe]=J&32767,pe=(pe<<5^ge[J])&32767,++J;re-=Le-1}else Se<=143?Se=Se+48:ce=Gt(ae,ce,1),ce=Ri(ae,ce,be[Se]),P[pe]=J&32767,++J}ce=Ri(ae,ce,0)-1}return ae.l=(ce+7)/8|0,ae.l}return function(ae,ce){return ae.length<8?z(ae,ce):se(ae,ce)}}();function vt(k){var L=_e(50+Math.floor(k.length*1.1)),D=Li(k,L);return L.slice(0,D)}var rt=Re?new Uint16Array(32768):ni(32768),fi=Re?new Uint16Array(32768):ni(32768),_t=Re?new Uint16Array(128):ni(128),Wt=1,Et=1;function vi(k,L){var D=Qe(k,L)+257;L+=5;var N=Qe(k,L)+1;L+=5;var H=he(k,L)+4;L+=4;for(var z=0,se=Re?new Uint8Array(19):ni(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,ce=Re?new Uint8Array(8):ni(8),J=Re?new Uint8Array(8):ni(8),P=se.length,re=0;re<H;++re)se[X[re]]=z=et(k,L),ae<z&&(ae=z),ce[z]++,L+=3;var pe=0;for(ce[0]=0,re=1;re<=ae;++re)J[re]=pe=pe+ce[re-1]<<1;for(re=0;re<P;++re)(pe=se[re])!=0&&(ge[re]=J[pe]++);var Se=0;for(re=0;re<P;++re)if(Se=se[re],Se!=0){pe=be[ge[re]]>>8-Se;for(var Ne=(1<<7-Se)-1;Ne>=0;--Ne)_t[pe|Ne<<Se]=Se&7|re<<3}var Le=[];for(ae=1;Le.length<D+N;)switch(pe=_t[Te(k,L)],L+=pe&7,pe>>>=3){case 16:for(z=3+it(k,L),L+=2,pe=Le[Le.length-1];z-- >0;)Le.push(pe);break;case 17:for(z=3+et(k,L),L+=3;z-- >0;)Le.push(0);break;case 18:for(z=11+Te(k,L),L+=7;z-- >0;)Le.push(0);break;default:Le.push(pe),ae<pe&&(ae=pe);break}var Ct=Le.slice(0,D),Ft=Le.slice(D);for(re=D;re<286;++re)Ct[re]=0;for(re=N;re<30;++re)Ft[re]=0;return Wt=$t(Ct,rt,286),Et=$t(Ft,fi,30),L}function Xt(k,L){if(k[0]==3&&!(k[1]&3))return[Vs(L),2];for(var D=0,N=0,H=bp(L||1<<18),z=0,se=H.length>>>0,ge=0,ae=0;!(N&1);){if(N=et(k,D),D+=3,N>>>1)N>>1==1?(ge=9,ae=5):(D=vi(k,D),ge=Wt,ae=Et);else{D&7&&(D+=8-(D&7));var ce=k[D>>>3]|k[(D>>>3)+1]<<8;if(D+=32,ce>0)for(!L&&se<z+ce&&(H=lr(H,z+ce),se=H.length);ce-- >0;)H[z++]=k[D>>>3],D+=8;continue}for(;;){!L&&se<z+32767&&(H=lr(H,z+32767),se=H.length);var J=dt(k,D,ge),P=N>>>1==1?He[J]:rt[J];if(D+=P&15,P>>>=4,!(P>>>8&255))H[z++]=P;else{if(P==256)break;P-=257;var re=P<8?0:P-4>>2;re>5&&(re=0);var pe=z+de[P];re>0&&(pe+=dt(k,D,re),D+=re),J=dt(k,D,ae),P=N>>>1==1?Di[J]:fi[J],D+=P&15,P>>>=4;var Se=P<4?0:P-2>>1,Ne=Ie[P];for(Se>0&&(Ne+=dt(k,D,Se),D+=Se),!L&&se<pe&&(H=lr(H,pe+100),se=H.length);z<pe;)H[z]=H[z-Ne],++z}}}return L?[H,D+7>>>3]:[H.slice(0,z),D+7>>>3]}function Bi(k,L){var D=k.slice(k.l||0),N=Xt(D,L);return k.l+=N[1],N[0]}function qi(k,L){if(k)typeof console<"u"&&console.error(L);else throw new Error(L)}function Ki(k,L){var D=k;sr(D,0);var N=[],H=[],z={FileIndex:N,FullPaths:H};T(z,{root:L.root});for(var se=D.length-4;(D[se]!=80||D[se+1]!=75||D[se+2]!=5||D[se+3]!=6)&&se>=0;)--se;D.l=se+4,D.l+=4;var ge=D.read_shift(2);D.l+=6;var ae=D.read_shift(4);for(D.l=ae,se=0;se<ge;++se){D.l+=20;var ce=D.read_shift(4),J=D.read_shift(4),P=D.read_shift(2),re=D.read_shift(2),pe=D.read_shift(2);D.l+=8;var Se=D.read_shift(4),Ne=o(D.slice(D.l+P,D.l+P+re));D.l+=P+re+pe;var Le=D.l;D.l=Se+4,Zi(D,ce,J,z,Ne),D.l=Le}return z}function Zi(k,L,D,N,H){k.l+=2;var z=k.read_shift(2),se=k.read_shift(2),ge=a(k);if(z&8257)throw new Error("Unsupported ZIP encryption");for(var ae=k.read_shift(4),ce=k.read_shift(4),J=k.read_shift(4),P=k.read_shift(2),re=k.read_shift(2),pe="",Se=0;Se<P;++Se)pe+=String.fromCharCode(k[k.l++]);if(re){var Ne=o(k.slice(k.l,k.l+re));(Ne[21589]||{}).mt&&(ge=Ne[21589].mt),((H||{})[21589]||{}).mt&&(ge=H[21589].mt)}k.l+=re;var Le=k.slice(k.l,k.l+ce);switch(se){case 8:Le=Z(k,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var Ct=!1;z&8&&(ae=k.read_shift(4),ae==134695760&&(ae=k.read_shift(4),Ct=!0),ce=k.read_shift(4),J=k.read_shift(4)),ce!=L&&qi(Ct,"Bad compressed size: "+L+" != "+ce),J!=D&&qi(Ct,"Bad uncompressed size: "+D+" != "+J),ot(N,pe,Le,{unsafe:!0,mt:ge})}function qs(k,L){var D=L||{},N=[],H=[],z=_e(1),se=D.compression?8:0,ge=0,ae=0,ce=0,J=0,P=0,re=k.FullPaths[0],pe=re,Se=k.FileIndex[0],Ne=[],Le=0;for(ae=1;ae<k.FullPaths.length;++ae)if(pe=k.FullPaths[ae].slice(re.length),Se=k.FileIndex[ae],!(!Se.size||!Se.content||pe=="Sh33tJ5")){var Ct=J,Ft=_e(pe.length);for(ce=0;ce<pe.length;++ce)Ft.write_shift(1,pe.charCodeAt(ce)&127);Ft=Ft.slice(0,Ft.l),Ne[P]=XO.buf(Se.content,0);var si=Se.content;se==8&&(si=q(si)),z=_e(30),z.write_shift(4,67324752),z.write_shift(2,20),z.write_shift(2,ge),z.write_shift(2,se),Se.mt?s(z,Se.mt):z.write_shift(4,0),z.write_shift(-4,Ne[P]),z.write_shift(4,si.length),z.write_shift(4,Se.content.length),z.write_shift(2,Ft.length),z.write_shift(2,0),J+=z.length,N.push(z),J+=Ft.length,N.push(Ft),J+=si.length,N.push(si),z=_e(46),z.write_shift(4,33639248),z.write_shift(2,0),z.write_shift(2,20),z.write_shift(2,ge),z.write_shift(2,se),z.write_shift(4,0),z.write_shift(-4,Ne[P]),z.write_shift(4,si.length),z.write_shift(4,Se.content.length),z.write_shift(2,Ft.length),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(4,0),z.write_shift(4,Ct),Le+=z.l,H.push(z),Le+=Ft.length,H.push(Ft),++P}return z=_e(22),z.write_shift(4,101010256),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(2,P),z.write_shift(2,P),z.write_shift(4,Le),z.write_shift(4,J),z.write_shift(2,0),er([er(N),er(H),z])}var ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function F(k,L){if(k.ctype)return k.ctype;var D=k.name||"",N=D.match(/\.([^\.]+)$/);return N&&ir[N[1]]||L&&(N=(D=L).match(/[\.\\]([^\.\\])+$/),N&&ir[N[1]])?ir[N[1]]:"application/octet-stream"}function V(k){for(var L=hl(k),D=[],N=0;N<L.length;N+=76)D.push(L.slice(N,N+76));return D.join(`\r
`)+`\r
`}function ee(k){var L=k.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var J=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],N=L.split(`\r
`),H=0;H<N.length;++H){var z=N[H];if(z.length==0){D.push("");continue}for(var se=0;se<z.length;){var ge=76,ae=z.slice(se,se+ge);ae.charAt(ge-1)=="="?ge--:ae.charAt(ge-2)=="="?ge-=2:ae.charAt(ge-3)=="="&&(ge-=3),ae=z.slice(se,se+ge),se+=ge,se<z.length&&(ae+="="),D.push(ae)}}return D.join(`\r
`)}function fe(k){for(var L=[],D=0;D<k.length;++D){for(var N=k[D];D<=k.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+k[++D];L.push(N)}for(var H=0;H<L.length;++H)L[H]=L[H].replace(/[=][0-9A-Fa-f]{2}/g,function(z){return String.fromCharCode(parseInt(z.slice(1),16))});return Qr(L.join(`\r
`))}function Me(k,L,D){for(var N="",H="",z="",se,ge=0;ge<10;++ge){var ae=L[ge];if(!ae||ae.match(/^\s*$/))break;var ce=ae.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":N=ce[2].trim();break;case"content-type":z=ce[2].trim();break;case"content-transfer-encoding":H=ce[2].trim();break}}switch(++ge,H.toLowerCase()){case"base64":se=Qr(sn(L.slice(ge).join("")));break;case"quoted-printable":se=fe(L.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var J=ot(k,N.slice(D.length),se,{unsafe:!0});z&&(J.ctype=z)}function Ge(k,L){if(ie(k.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=L&&L.root||"",N=(Ot&&Buffer.isBuffer(k)?k.toString("binary"):ie(k)).split(`\r
`),H=0,z="";for(H=0;H<N.length;++H)if(z=N[H],!!/^Content-Location:/i.test(z)&&(z=z.slice(z.indexOf("file")),D||(D=z.slice(0,z.lastIndexOf("/")+1)),z.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),z.slice(0,D.length)!=D););var se=(N[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var ge="--"+(se[1]||""),ae=[],ce=[],J={FileIndex:ae,FullPaths:ce};T(J);var P,re=0;for(H=0;H<N.length;++H){var pe=N[H];pe!==ge&&pe!==ge+"--"||(re++&&Me(J,N.slice(P,H),D),P=H)}return J}function lt(k,L){var D=L||{},N=D.boundary||"SheetJS";N="------="+N;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],z=k.FullPaths[0],se=z,ge=k.FileIndex[0],ae=1;ae<k.FullPaths.length;++ae)if(se=k.FullPaths[ae].slice(z.length),ge=k.FileIndex[ae],!(!ge.size||!ge.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var ce=ge.content,J=Ot&&Buffer.isBuffer(ce)?ce.toString("binary"):ie(ce),P=0,re=Math.min(1024,J.length),pe=0,Se=0;Se<=re;++Se)(pe=J.charCodeAt(Se))>=32&&pe<128&&++P;var Ne=P>=re*4/5;H.push(N),H.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+se),H.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),H.push("Content-Type: "+F(ge,se)),H.push(""),H.push(Ne?ee(J):V(J))}return H.push(N+`--\r
`),H.join(`\r
`)}function qe(k){var L={};return T(L,k),L}function ot(k,L,D,N){var H=N&&N.unsafe;H||T(k);var z=!H&&st.find(k,L);if(!z){var se=k.FullPaths[0];L.slice(0,se.length)==se?se=L:(se.slice(-1)!="/"&&(se+="/"),se=(se+L).replace("//","/")),z={name:n(L),type:2},k.FileIndex.push(z),k.FullPaths.push(se),H||st.utils.cfb_gc(k)}return z.content=D,z.size=D?D.length:0,N&&(N.CLSID&&(z.clsid=N.CLSID),N.mt&&(z.mt=N.mt),N.ct&&(z.ct=N.ct)),z}function Ke(k,L){T(k);var D=st.find(k,L);if(D){for(var N=0;N<k.FileIndex.length;++N)if(k.FileIndex[N]==D)return k.FileIndex.splice(N,1),k.FullPaths.splice(N,1),!0}return!1}function je(k,L,D){T(k);var N=st.find(k,L);if(N){for(var H=0;H<k.FileIndex.length;++H)if(k.FileIndex[H]==N)return k.FileIndex[H].name=n(D),k.FullPaths[H]=D,!0}return!1}function bt(k){O(k,!0)}return e.find=G,e.read=b,e.parse=l,e.write=Ee,e.writeFile=Ze,e.utils={cfb_new:qe,cfb_add:ot,cfb_del:Ke,cfb_mov:je,cfb_gc:bt,ReadShift:$o,CheckField:o_,prep_blob:sr,bconcat:er,use_zlib:U,_deflateRaw:vt,_inflateRaw:Bi,consts:ke},e}();function qO(i){return typeof i=="string"?Fh(i):Array.isArray(i)?xO(i):i}function Fl(i,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Fh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(i,e)}var r=t=="utf8"?Gn(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,i);if(typeof Blob<"u"){var n=new Blob([qO(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,i);if(typeof saveAs<"u")return saveAs(n,i);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:i,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=i,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(i);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=$s(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+i)}function KO(i){if(typeof Deno<"u")return Deno.readFileSync(i);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(i);e.open("r"),e.encoding="binary";var t=e.read();return e.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+i)}function Oi(i){for(var e=Object.keys(i),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(i,e[r])&&t.push(e[r]);return t}function Fp(i,e){for(var t=[],r=Oi(i),n=0;n!==r.length;++n)t[i[r[n]][e]]==null&&(t[i[r[n]][e]]=r[n]);return t}function Nh(i){for(var e=[],t=Oi(i),r=0;r!==t.length;++r)e[i[t[r]]]=t[r];return e}function Mh(i){for(var e=[],t=Oi(i),r=0;r!==t.length;++r)e[i[t[r]]]=parseInt(t[r],10);return e}function jO(i){for(var e=[],t=Oi(i),r=0;r!==t.length;++r)e[i[t[r]]]==null&&(e[i[t[r]]]=[]),e[i[t[r]]].push(t[r]);return e}var ih=new Date(1899,11,30,0,0,0);function Qi(i,e){var t=i.getTime(),r=ih.getTime()+(i.getTimezoneOffset()-ih.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var Vv=new Date,QO=ih.getTime()+(Vv.getTimezoneOffset()-ih.getTimezoneOffset())*6e4,Pp=Vv.getTimezoneOffset();function Lh(i){var e=new Date;return e.setTime(i*24*60*60*1e3+QO),e.getTimezoneOffset()!==Pp&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Pp)*6e4),e}function ZO(i){var e=0,t=0,r=!1,n=i.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+i+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(r=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=t*parseInt(n[s],10)}return e}var Np=new Date("2017-02-19T19:06:09.000Z"),Uv=isNaN(Np.getFullYear())?new Date("2/19/17"):Np,JO=Uv.getFullYear()==2017;function ci(i,e){var t=new Date(i);if(JO)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(i instanceof Date)return i;if(Uv.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return i.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var n=i.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return i.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xa(i,e){if(Ot&&Buffer.isBuffer(i)){if(e){if(i[0]==255&&i[1]==254)return Gn(i.slice(2).toString("utf16le"));if(i[1]==254&&i[2]==255)return Gn(kv(i.slice(2).toString("binary")))}return i.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(i[0]==255&&i[1]==254)return Gn(new TextDecoder("utf-16le").decode(i.slice(2)));if(i[0]==254&&i[1]==255)return Gn(new TextDecoder("utf-16be").decode(i.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(i)&&(i=new Uint8Array(i)),new TextDecoder("latin1").decode(i).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var r=[],n=0;n!=i.length;++n)r.push(String.fromCharCode(i[n]));return r.join("")}function hi(i){if(typeof JSON<"u"&&!Array.isArray(i))return JSON.parse(JSON.stringify(i));if(typeof i!="object"||i==null)return i;if(i instanceof Date)return new Date(i.getTime());var e={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=hi(i[t]));return e}function bi(i,e){for(var t="";t.length<e;)t+=i;return t}function Pn(i){var e=Number(i);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(i))return e;var t=1,r=i.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(e=Number(r)))?e/t:e}var eI=["january","february","march","april","may","june","july","august","september","october","november","december"];function lo(i){var e=new Date(i),t=new Date(NaN),r=e.getYear(),n=e.getMonth(),s=e.getDate();if(isNaN(s))return t;var a=i.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&eI.indexOf(a)==-1)return t}else if(a.match(/[a-z]/))return t;return r<0||r>8099?t:(n>0||s>1)&&r!=101?e:i.match(/[^-0-9:,\/\\]/)?t:e}var tI=function(){var i="abacaba".split(/(:?b)/i).length==5;return function(t,r,n){if(i||typeof r=="string")return t.split(r);for(var s=t.split(r),a=[s[0]],o=1;o<s.length;++o)a.push(n),a.push(s[o]);return a}}();function Wv(i){return i?i.content&&i.type?xa(i.content,!0):i.data?Mo(i.data):i.asNodeBuffer&&Ot?Mo(i.asNodeBuffer().toString("binary")):i.asBinary?Mo(i.asBinary()):i._data&&i._data.getContent?Mo(xa(Array.prototype.slice.call(i._data.getContent(),0))):null:null}function zv(i){if(!i)return null;if(i.data)return yp(i.data);if(i.asNodeBuffer&&Ot)return i.asNodeBuffer();if(i._data&&i._data.getContent){var e=i._data.getContent();return typeof e=="string"?yp(e):Array.prototype.slice.call(e)}return i.content&&i.type?i.content:null}function iI(i){return i&&i.name.slice(-4)===".bin"?zv(i):Wv(i)}function fn(i,e){for(var t=i.FullPaths||Oi(i.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),n=r.replace(/\\/g,"/"),s=0;s<t.length;++s){var a=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==a||n==a)return i.files?i.files[t[s]]:i.FileIndex[s]}return null}function xf(i,e){var t=fn(i,e);if(t==null)throw new Error("Cannot find file "+e+" in zip");return t}function Gi(i,e,t){if(!t)return iI(xf(i,e));if(!e)return null;try{return Gi(i,e)}catch{return null}}function Zr(i,e,t){if(!t)return Wv(xf(i,e));if(!e)return null;try{return Zr(i,e)}catch{return null}}function rI(i,e,t){return zv(xf(i,e))}function Mp(i){for(var e=i.FullPaths||Oi(i.files),t=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&t.push(e[r].replace(/^Root Entry[\/]/,""));return t.sort()}function At(i,e,t){if(i.FullPaths){if(typeof t=="string"){var r;return Ot?r=xs(t):r=wO(t),st.utils.cfb_add(i,e,r)}st.utils.cfb_add(i,e,t)}else i.file(e,t)}function wf(){return st.utils.cfb_new()}function Gv(i,e){switch(e.type){case"base64":return st.read(i,{type:"base64"});case"binary":return st.read(i,{type:"binary"});case"buffer":case"array":return st.read(i,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Bo(i,e){if(i.charAt(0)=="/")return i.slice(1);var t=e.split("/");e.slice(-1)!="/"&&t.pop();for(var r=i.split("/");r.length!==0;){var n=r.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var Mi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,nI=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Lp=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,sI=/<[^>]*>/g,Cr=Mi.match(Lp)?Lp:sI,aI=/<\w*:/,oI=/<(\/?)\w+:/;function gt(i,e,t){for(var r={},n=0,s=0;n!==i.length&&!((s=i.charCodeAt(n))===32||s===10||s===13);++n);if(e||(r[0]=i.slice(0,n)),n===i.length)return r;var a=i.match(nI),o=0,c="",h=0,l="",u="",d=1;if(a)for(h=0;h!=a.length;++h){for(u=a[h],s=0;s!=u.length&&u.charCodeAt(s)!==61;++s);for(l=u.slice(0,s).trim();u.charCodeAt(s+1)==32;)++s;for(d=(n=u.charCodeAt(s+1))==34||n==39?1:0,c=u.slice(s+1+d,u.length-d),o=0;o!=l.length&&l.charCodeAt(o)!==58;++o);if(o===l.length)l.indexOf("_")>0&&(l=l.slice(0,l.indexOf("_"))),r[l]=c,r[l.toLowerCase()]=c;else{var f=(o===5&&l.slice(0,5)==="xmlns"?"xmlns":"")+l.slice(o+1);if(r[f]&&l.slice(o-3,o)=="ext")continue;r[f]=c,r[f.toLowerCase()]=c}}return r}function jn(i){return i.replace(oI,"<$1")}var $v={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cf=Nh($v),Bt=function(){var i=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function t(r){var n=r+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(i,function(o,c){return $v[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,a)+t(n.slice(a+3))}}(),yf=/[&<>'"]/g,lI=/[\u0000-\u0008\u000b-\u001f]/g;function jt(i){var e=i+"";return e.replace(yf,function(t){return Cf[t]}).replace(lI,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bp(i){return jt(i).replace(/ /g,"_x0020_")}var Yv=/[\u0000-\u001f]/g;function Sf(i){var e=i+"";return e.replace(yf,function(t){return Cf[t]}).replace(/\n/g,"<br/>").replace(Yv,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function cI(i){var e=i+"";return e.replace(yf,function(t){return Cf[t]}).replace(Yv,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}var Hp=function(){var i=/&#(\d+);/g;function e(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(i,e)}}();function hI(i){return i.replace(/(\r\n|[\r\n])/g,"&#10;")}function li(i){switch(i){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bu(i){for(var e="",t=0,r=0,n=0,s=0,a=0,o=0;t<i.length;){if(r=i.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(n=i.charCodeAt(t++),r>191&&r<224){a=(r&31)<<6,a|=n&63,e+=String.fromCharCode(a);continue}if(s=i.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(n&63)<<6|s&63);continue}a=i.charCodeAt(t++),o=((r&7)<<18|(n&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Vp(i){var e=Vs(2*i.length),t,r,n=1,s=0,a=0,o;for(r=0;r<i.length;r+=n)n=1,(o=i.charCodeAt(r))<128?t=o:o<224?(t=(o&31)*64+(i.charCodeAt(r+1)&63),n=2):o<240?(t=(o&15)*4096+(i.charCodeAt(r+1)&63)*64+(i.charCodeAt(r+2)&63),n=3):(n=4,t=(o&7)*262144+(i.charCodeAt(r+1)&63)*4096+(i.charCodeAt(r+2)&63)*64+(i.charCodeAt(r+3)&63),t-=65536,a=55296+(t>>>10&1023),t=56320+(t&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=t%256,e[s++]=t>>>8;return e.slice(0,s).toString("ucs2")}function Up(i){return xs(i,"binary").toString("utf8")}var fc="foo bar baz",Qt=Ot&&(Up(fc)==Bu(fc)&&Up||Vp(fc)==Bu(fc)&&Vp)||Bu,Gn=Ot?function(i){return xs(i,"utf8").toString("binary")}:function(i){for(var e=[],t=0,r=0,n=0;t<i.length;)switch(r=i.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,n=i.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(n>>18&7))),e.push(String.fromCharCode(144+(n>>12&63))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},dl=function(){var i={};return function(t,r){var n=t+"|"+(r||"");return i[n]?i[n]:i[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Xv=function(){var i=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<i.length;++n)r=r.replace(i[n][0],i[n][1]);return r}}(),uI=function(){var i={};return function(t){return i[t]!==void 0?i[t]:i[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),dI=/<\/?(?:vt:)?variant>/g,fI=/<(?:vt:)([^>]*)>([\s\S]*)</;function Wp(i,e){var t=gt(i),r=i.match(uI(t.baseType))||[],n=[];if(r.length!=t.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return n}return r.forEach(function(s){var a=s.replace(dI,"").match(fI);a&&n.push({v:Qt(a[2]),t:a[1]})}),n}var qv=/(^\s|\s$|\n)/;function ar(i,e){return"<"+i+(e.match(qv)?' xml:space="preserve"':"")+">"+e+"</"+i+">"}function fl(i){return Oi(i).map(function(e){return" "+e+'="'+i[e]+'"'}).join("")}function Ve(i,e,t){return"<"+i+(t!=null?fl(t):"")+(e!=null?(e.match(qv)?' xml:space="preserve"':"")+">"+e+"</"+i:"/")+">"}function vd(i,e){try{return i.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function pI(i,e){switch(typeof i){case"string":var t=Ve("vt:lpwstr",jt(i));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ve((i|0)==i?"vt:i4":"vt:r8",jt(String(i)));case"boolean":return Ve("vt:bool",i?"true":"false")}if(i instanceof Date)return Ve("vt:filetime",vd(i));throw new Error("Unable to serialize "+i)}function bf(i){if(Ot&&Buffer.isBuffer(i))return i.toString("utf8");if(typeof i=="string")return i;if(typeof Uint8Array<"u"&&i instanceof Uint8Array)return Qt($s(vf(i)));throw new Error("Bad input format: expected Buffer or string")}var pl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ji={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Aa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function mI(i,e){for(var t=1-2*(i[e+7]>>>7),r=((i[e+7]&127)<<4)+(i[e+6]>>>4&15),n=i[e+6]&15,s=5;s>=0;--s)n=n*256+i[e+s];return r==2047?n==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,n+=Math.pow(2,52)),t*Math.pow(2,r-52)*n)}function gI(i,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,n=0,s=0,a=r?-e:e;isFinite(a)?a==0?n=s=0:(n=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)i[t+o]=s&255;i[t+6]=(n&15)<<4|s&15,i[t+7]=n>>4|r}var zp=function(i){for(var e=[],t=10240,r=0;r<i[0].length;++r)if(i[0][r])for(var n=0,s=i[0][r].length;n<s;n+=t)e.push.apply(e,i[0][r].slice(n,n+t));return e},Gp=Ot?function(i){return i[0].length>0&&Buffer.isBuffer(i[0][0])?Buffer.concat(i[0].map(function(e){return Buffer.isBuffer(e)?e:xs(e)})):zp(i)}:zp,$p=function(i,e,t){for(var r=[],n=e;n<t;n+=2)r.push(String.fromCharCode(rs(i,n)));return r.join("").replace(Or,"")},Tf=Ot?function(i,e,t){return Buffer.isBuffer(i)?i.toString("utf16le",e,t).replace(Or,""):$p(i,e,t)}:$p,Yp=function(i,e,t){for(var r=[],n=e;n<e+t;++n)r.push(("0"+i[n].toString(16)).slice(-2));return r.join("")},Kv=Ot?function(i,e,t){return Buffer.isBuffer(i)?i.toString("hex",e,e+t):Yp(i,e,t)}:Yp,Xp=function(i,e,t){for(var r=[],n=e;n<t;n++)r.push(String.fromCharCode(Ga(i,n)));return r.join("")},Pl=Ot?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Xp(e,t,r)}:Xp,jv=function(i,e){var t=jr(i,e);return t>0?Pl(i,e+4,e+4+t-1):""},Qv=jv,Zv=function(i,e){var t=jr(i,e);return t>0?Pl(i,e+4,e+4+t-1):""},Jv=Zv,e_=function(i,e){var t=2*jr(i,e);return t>0?Pl(i,e+4,e+4+t-1):""},t_=e_,i_=function(e,t){var r=jr(e,t);return r>0?Tf(e,t+4,t+4+r):""},r_=i_,n_=function(i,e){var t=jr(i,e);return t>0?Pl(i,e+4,e+4+t):""},s_=n_,a_=function(i,e){return mI(i,e)},rh=a_,Af=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ot&&(Qv=function(e,t){if(!Buffer.isBuffer(e))return jv(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Jv=function(e,t){if(!Buffer.isBuffer(e))return Zv(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},t_=function(e,t){if(!Buffer.isBuffer(e))return e_(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},r_=function(e,t){if(!Buffer.isBuffer(e))return i_(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},s_=function(e,t){if(!Buffer.isBuffer(e))return n_(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},rh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):a_(e,t)},Af=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Ga=function(i,e){return i[e]},rs=function(i,e){return i[e+1]*256+i[e]},vI=function(i,e){var t=i[e+1]*256+i[e];return t<32768?t:(65535-t+1)*-1},jr=function(i,e){return i[e+3]*(1<<24)+(i[e+2]<<16)+(i[e+1]<<8)+i[e]},na=function(i,e){return i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]},_I=function(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]};function $o(i,e){var t="",r,n,s=[],a,o,c,h;switch(e){case"dbcs":if(h=this.l,Ot&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*i).toString("utf16le");else for(c=0;c<i;++c)t+=String.fromCharCode(rs(this,h)),h+=2;i*=2;break;case"utf8":t=Pl(this,this.l,this.l+i);break;case"utf16le":i*=2,t=Tf(this,this.l,this.l+i);break;case"wstr":return $o.call(this,i,"dbcs");case"lpstr-ansi":t=Qv(this,this.l),i=4+jr(this,this.l);break;case"lpstr-cp":t=Jv(this,this.l),i=4+jr(this,this.l);break;case"lpwstr":t=t_(this,this.l),i=4+2*jr(this,this.l);break;case"lpp4":i=4+jr(this,this.l),t=r_(this,this.l),i&2&&(i+=2);break;case"8lpp4":i=4+jr(this,this.l),t=s_(this,this.l),i&3&&(i+=4-(i&3));break;case"cstr":for(i=0,t="";(a=Ga(this,this.l+i++))!==0;)s.push(dc(a));t=s.join("");break;case"_wstr":for(i=0,t="";(a=rs(this,this.l+i))!==0;)s.push(dc(a)),i+=2;i+=2,t=s.join("");break;case"dbcs-cont":for(t="",h=this.l,c=0;c<i;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return a=Ga(this,h),this.l=h+1,o=$o.call(this,i-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(rs(this,h))),h+=2}t=s.join(""),i*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,c=0;c!=i;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return a=Ga(this,h),this.l=h+1,o=$o.call(this,i-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(dc(Ga(this,h))),h+=1}t=s.join("");break;default:switch(i){case 1:return r=Ga(this,this.l),this.l++,r;case 2:return r=(e==="i"?vI:rs)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(i>0?na:_I)(this,this.l),this.l+=4,r):(n=jr(this,this.l),this.l+=4,n);case 8:case-8:if(e==="f")return i==8?n=rh(this,this.l):n=rh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;i=8;case 16:t=Kv(this,this.l,i);break}}return this.l+=i,t}var EI=function(i,e,t){i[t]=e&255,i[t+1]=e>>>8&255,i[t+2]=e>>>16&255,i[t+3]=e>>>24&255},xI=function(i,e,t){i[t]=e&255,i[t+1]=e>>8&255,i[t+2]=e>>16&255,i[t+3]=e>>24&255},wI=function(i,e,t){i[t]=e&255,i[t+1]=e>>>8&255};function CI(i,e,t){var r=0,n=0;if(t==="dbcs"){for(n=0;n!=e.length;++n)wI(this,e.charCodeAt(n),this.l+2*n);r=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=e.length;++n)this[this.l+n]=e.charCodeAt(n)&255;r=e.length}else if(t==="hex"){for(;n<i;++n)this[this.l++]=parseInt(e.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+i,this.length);for(n=0;n<Math.min(e.length,i);++n){var a=e.charCodeAt(n);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(i){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,EI(this,e,this.l);break;case 8:if(r=8,t==="f"){gI(this,e,this.l);break}case 16:break;case-4:r=4,xI(this,e,this.l);break}return this.l+=r,this}function o_(i,e){var t=Kv(this,this.l,i.length>>1);if(t!==i)throw new Error(e+"Expected "+i+" saw "+t);this.l+=i.length>>1}function sr(i,e){i.l=e,i.read_shift=$o,i.chk=o_,i.write_shift=CI}function Er(i,e){i.l+=e}function _e(i){var e=Vs(i);return sr(e,0),e}function ws(i,e,t){if(i){var r,n,s;sr(i,i.l||0);for(var a=i.length,o=0,c=0;i.l<a;){o=i.read_shift(1),o&128&&(o=(o&127)+((i.read_shift(1)&127)<<7));var h=xl[o]||xl[65535];for(r=i.read_shift(1),s=r&127,n=1;n<4&&r&128;++n)s+=((r=i.read_shift(1))&127)<<7*n;c=i.l+s;var l=h.f&&h.f(i,s,t);if(i.l=c,e(l,h,o))return}}}function zr(){var i=[],e=Ot?256:2048,t=function(h){var l=_e(h);return sr(l,0),l},r=t(e),n=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&i.push(r),r=null)},s=function(h){return r&&h<r.length-r.l?r:(n(),r=t(Math.max(h+1,e)))},a=function(){return n(),er(i)},o=function(h){n(),r=h,r.l==null&&(r.l=r.length),s(e)};return{next:s,push:o,end:a,_bufs:i}}function De(i,e,t,r){var n=+e,s;if(!isNaN(n)){r||(r=xl[n].p||(t||[]).length||0),s=1+(n>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=i.next(s);n<=127?a.write_shift(1,n):(a.write_shift(1,(n&127)+128),a.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&Af(t)&&i.push(t)}}function Yo(i,e,t){var r=hi(i);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function qp(i,e,t){var r=hi(i);return r.s=Yo(r.s,e.s,t),r.e=Yo(r.e,e.s,t),r}function Xo(i,e){if(i.cRel&&i.c<0)for(i=hi(i);i.c<0;)i.c+=e>8?16384:256;if(i.rRel&&i.r<0)for(i=hi(i);i.r<0;)i.r+=e>8?1048576:e>5?65536:16384;var t=ut(i);return!i.cRel&&i.cRel!=null&&(t=bI(t)),!i.rRel&&i.rRel!=null&&(t=yI(t)),t}function Hu(i,e){return i.s.r==0&&!i.s.rRel&&i.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!i.e.rRel?(i.s.cRel?"":"$")+wi(i.s.c)+":"+(i.e.cRel?"":"$")+wi(i.e.c):i.s.c==0&&!i.s.cRel&&i.e.c==(e.biff>=12?16383:255)&&!i.e.cRel?(i.s.rRel?"":"$")+Ni(i.s.r)+":"+(i.e.rRel?"":"$")+Ni(i.e.r):Xo(i.s,e.biff)+":"+Xo(i.e,e.biff)}function kf(i){return parseInt(SI(i),10)-1}function Ni(i){return""+(i+1)}function yI(i){return i.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function SI(i){return i.replace(/\$(\d+)$/,"$1")}function Of(i){for(var e=TI(i),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function wi(i){if(i<0)throw new Error("invalid column "+i);var e="";for(++i;i;i=Math.floor((i-1)/26))e=String.fromCharCode((i-1)%26+65)+e;return e}function bI(i){return i.replace(/^([A-Z])/,"$$$1")}function TI(i){return i.replace(/^\$([A-Z])/,"$1")}function AI(i){return i.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ci(i){for(var e=0,t=0,r=0;r<i.length;++r){var n=i.charCodeAt(r);n>=48&&n<=57?e=10*e+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:e-1}}function ut(i){for(var e=i.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(i.r+1)}function Gr(i){var e=i.indexOf(":");return e==-1?{s:Ci(i),e:Ci(i)}:{s:Ci(i.slice(0,e)),e:Ci(i.slice(e+1))}}function Tt(i,e){return typeof e>"u"||typeof e=="number"?Tt(i.s,i.e):(typeof i!="string"&&(i=ut(i)),typeof e!="string"&&(e=ut(e)),i==e?i:i+":"+e)}function Ht(i){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,n=0,s=i.length;for(t=0;r<s&&!((n=i.charCodeAt(r)-64)<1||n>26);++r)t=26*t+n;for(e.s.c=--t,t=0;r<s&&!((n=i.charCodeAt(r)-48)<0||n>9);++r)t=10*t+n;if(e.s.r=--t,r===s||n!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=s&&!((n=i.charCodeAt(r)-64)<1||n>26);++r)t=26*t+n;for(e.e.c=--t,t=0;r!=s&&!((n=i.charCodeAt(r)-48)<0||n>9);++r)t=10*t+n;return e.e.r=--t,e}function Kp(i,e){var t=i.t=="d"&&e instanceof Date;if(i.z!=null)try{return i.w=_n(i.z,t?Qi(e):e)}catch{}try{return i.w=_n((i.XF||{}).numFmtId||(t?14:0),t?Qi(e):e)}catch{return""+e}}function _s(i,e,t){return i==null||i.t==null||i.t=="z"?"":i.w!==void 0?i.w:(i.t=="d"&&!i.z&&t&&t.dateNF&&(i.z=t.dateNF),i.t=="e"?Cs[i.v]||i.v:e==null?Kp(i,i.v):Kp(i,e))}function Ys(i,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=i,{SheetNames:[t],Sheets:r}}function l_(i,e,t){var r=t||{},n=i?Array.isArray(i):r.dense,s=i||(n?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var c=typeof r.origin=="string"?Ci(r.origin):r.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var l=Ht(s["!ref"]);h.s.c=l.s.c,h.s.r=l.s.r,h.e.c=Math.max(h.e.c,l.e.c),h.e.r=Math.max(h.e.r,l.e.r),a==-1&&(h.e.r=a=l.e.r+1)}for(var u=0;u!=e.length;++u)if(e[u]){if(!Array.isArray(e[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[u].length;++d)if(!(typeof e[u][d]>"u")){var f={v:e[u][d]},p=a+u,m=o+d;if(h.s.r>p&&(h.s.r=p),h.s.c>m&&(h.s.c=m),h.e.r<p&&(h.e.r=p),h.e.c<m&&(h.e.c=m),e[u][d]&&typeof e[u][d]=="object"&&!Array.isArray(e[u][d])&&!(e[u][d]instanceof Date))f=e[u][d];else if(Array.isArray(f.v)&&(f.f=e[u][d][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else if(r.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=r.dateNF||ht[14],r.cellDates?(f.t="d",f.w=_n(f.z,Qi(f.v))):(f.t="n",f.v=Qi(f.v),f.w=_n(f.z,f.v))):f.t="s";if(n)s[p]||(s[p]=[]),s[p][m]&&s[p][m].z&&(f.z=s[p][m].z),s[p][m]=f;else{var v=ut({c:m,r:p});s[v]&&s[v].z&&(f.z=s[v].z),s[v]=f}}}return h.s.c<1e7&&(s["!ref"]=Tt(h)),s}function wo(i,e){return l_(null,i,e)}function kI(i){return i.read_shift(4,"i")}function Nn(i,e){return e||(e=_e(4)),e.write_shift(4,i),e}function vr(i){var e=i.read_shift(4);return e===0?"":i.read_shift(e,"dbcs")}function tr(i,e){var t=!1;return e==null&&(t=!0,e=_e(4+2*i.length)),e.write_shift(4,i.length),i.length>0&&e.write_shift(0,i,"dbcs"),t?e.slice(0,e.l):e}function OI(i){return{ich:i.read_shift(2),ifnt:i.read_shift(2)}}function II(i,e){return e||(e=_e(4)),e.write_shift(2,0),e.write_shift(2,0),e}function If(i,e){var t=i.l,r=i.read_shift(1),n=vr(i),s=[],a={t:n,h:n};if(r&1){for(var o=i.read_shift(4),c=0;c!=o;++c)s.push(OI(i));a.r=s}else a.r=[{ich:0,ifnt:0}];return i.l=t+e,a}function RI(i,e){var t=!1;return e==null&&(t=!0,e=_e(15+4*i.t.length)),e.write_shift(1,0),tr(i.t,e),t?e.slice(0,e.l):e}var DI=If;function FI(i,e){var t=!1;return e==null&&(t=!0,e=_e(23+4*i.t.length)),e.write_shift(1,1),tr(i.t,e),e.write_shift(4,1),II({},e),t?e.slice(0,e.l):e}function wn(i){var e=i.read_shift(4),t=i.read_shift(2);return t+=i.read_shift(1)<<16,i.l++,{c:e,iStyleRef:t}}function ka(i,e){return e==null&&(e=_e(8)),e.write_shift(-4,i.c),e.write_shift(3,i.iStyleRef||i.s),e.write_shift(1,0),e}function Oa(i){var e=i.read_shift(2);return e+=i.read_shift(1)<<16,i.l++,{c:-1,iStyleRef:e}}function Ia(i,e){return e==null&&(e=_e(4)),e.write_shift(3,i.iStyleRef||i.s),e.write_shift(1,0),e}var PI=vr,c_=tr;function Rf(i){var e=i.read_shift(4);return e===0||e===4294967295?"":i.read_shift(e,"dbcs")}function nh(i,e){var t=!1;return e==null&&(t=!0,e=_e(127)),e.write_shift(4,i.length>0?i.length:4294967295),i.length>0&&e.write_shift(0,i,"dbcs"),t?e.slice(0,e.l):e}var NI=vr,_d=Rf,Df=nh;function Ff(i){var e=i.slice(i.l,i.l+4),t=e[0]&1,r=e[0]&2;i.l+=4;var n=r===0?rh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):na(e,0)>>2;return t?n/100:n}function h_(i,e){e==null&&(e=_e(4));var t=0,r=0,n=i*100;if(i==(i|0)&&i>=-536870912&&i<1<<29?r=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?n:i)<<2)+(t+2));else throw new Error("unsupported RkNumber "+i)}function u_(i){var e={s:{},e:{}};return e.s.r=i.read_shift(4),e.e.r=i.read_shift(4),e.s.c=i.read_shift(4),e.e.c=i.read_shift(4),e}function MI(i,e){return e||(e=_e(16)),e.write_shift(4,i.s.r),e.write_shift(4,i.e.r),e.write_shift(4,i.s.c),e.write_shift(4,i.e.c),e}var Ra=u_,Co=MI;function gr(i){if(i.length-i.l<8)throw"XLS Xnum Buffer underflow";return i.read_shift(8,"f")}function wa(i,e){return(e||_e(8)).write_shift(8,i,"f")}function LI(i){var e={},t=i.read_shift(1),r=t>>>1,n=i.read_shift(1),s=i.read_shift(2,"i"),a=i.read_shift(1),o=i.read_shift(1),c=i.read_shift(1);switch(i.l++,r){case 0:e.auto=1;break;case 1:e.index=n;var h=la[n];h&&(e.rgb=gl(h));break;case 2:e.rgb=gl([a,o,c]);break;case 3:e.theme=n;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function sh(i,e){if(e||(e=_e(8)),!i||i.auto)return e.write_shift(4,0),e.write_shift(4,0),e;i.index!=null?(e.write_shift(1,2),e.write_shift(1,i.index)):i.theme!=null?(e.write_shift(1,6),e.write_shift(1,i.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=i.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!i.rgb||i.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=i.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function BI(i){var e=i.read_shift(1);i.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function HI(i,e){e||(e=_e(2));var t=(i.italic?2:0)|(i.strike?8:0)|(i.outline?16:0)|(i.shadow?32:0)|(i.condense?64:0)|(i.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}function d_(i,e){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=i.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[i.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return i.l-=4,i.read_shift(0,e==1?"lpstr":"lpwstr")}function VI(i){return d_(i,1)}function UI(i){return d_(i,2)}var Pf=2,Nr=3,pc=11,jp=12,ah=19,mc=64,WI=65,zI=71,GI=4108,$I=4126,Ji=80,f_=81,YI=[Ji,f_],Ed={1:{n:"CodePage",t:Pf},2:{n:"Category",t:Ji},3:{n:"PresentationFormat",t:Ji},4:{n:"ByteCount",t:Nr},5:{n:"LineCount",t:Nr},6:{n:"ParagraphCount",t:Nr},7:{n:"SlideCount",t:Nr},8:{n:"NoteCount",t:Nr},9:{n:"HiddenCount",t:Nr},10:{n:"MultimediaClipCount",t:Nr},11:{n:"ScaleCrop",t:pc},12:{n:"HeadingPairs",t:GI},13:{n:"TitlesOfParts",t:$I},14:{n:"Manager",t:Ji},15:{n:"Company",t:Ji},16:{n:"LinksUpToDate",t:pc},17:{n:"CharacterCount",t:Nr},19:{n:"SharedDoc",t:pc},22:{n:"HyperlinksChanged",t:pc},23:{n:"AppVersion",t:Nr,p:"version"},24:{n:"DigSig",t:WI},26:{n:"ContentType",t:Ji},27:{n:"ContentStatus",t:Ji},28:{n:"Language",t:Ji},29:{n:"Version",t:Ji},255:{},2147483648:{n:"Locale",t:ah},2147483651:{n:"Behavior",t:ah},1919054434:{}},xd={1:{n:"CodePage",t:Pf},2:{n:"Title",t:Ji},3:{n:"Subject",t:Ji},4:{n:"Author",t:Ji},5:{n:"Keywords",t:Ji},6:{n:"Comments",t:Ji},7:{n:"Template",t:Ji},8:{n:"LastAuthor",t:Ji},9:{n:"RevNumber",t:Ji},10:{n:"EditTime",t:mc},11:{n:"LastPrinted",t:mc},12:{n:"CreatedDate",t:mc},13:{n:"ModifiedDate",t:mc},14:{n:"PageCount",t:Nr},15:{n:"WordCount",t:Nr},16:{n:"CharCount",t:Nr},17:{n:"Thumbnail",t:zI},18:{n:"Application",t:Ji},19:{n:"DocSecurity",t:Nr},255:{},2147483648:{n:"Locale",t:ah},2147483651:{n:"Behavior",t:ah},1919054434:{}},Qp={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XI=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function qI(i){return i.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var KI=qI([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),la=hi(KI),Cs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},p_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wd={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},gc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Nf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function jI(i){var e=Nf();if(!i||!i.match)return e;var t={};if((i.match(Cr)||[]).forEach(function(r){var n=gt(r);switch(n[0].replace(aI,"<")){case"<?xml":break;case"<Types":e.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":e[wd[n.ContentType]]!==void 0&&e[wd[n.ContentType]].push(n.PartName);break}}),e.xmlns!==ji.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=t,delete e.calcchains,e}function m_(i,e){var t=jO(wd),r=[],n;r[r.length]=Mi,r[r.length]=Ve("Types",null,{xmlns:ji.CT,"xmlns:xsd":ji.xsd,"xmlns:xsi":ji.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ve("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){i[c]&&i[c].length>0&&(n=i[c][0],r[r.length]=Ve("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:gc[c][e.bookType]||gc[c].xlsx}))},a=function(c){(i[c]||[]).forEach(function(h){r[r.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:gc[c][e.bookType]||gc[c].xlsx})})},o=function(c){(i[c]||[]).forEach(function(h){r[r.length]=Ve("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Dt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ml(i){var e=i.lastIndexOf("/");return i.slice(0,e+1)+"_rels/"+i.slice(e+1)+".rels"}function qo(i,e){var t={"!id":{}};if(!i)return t;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(i.match(Cr)||[]).forEach(function(n){var s=gt(n);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Bo(s.Target,e);t[o]=a,r[s.Id]=a}}),t["!id"]=r,t}function to(i){var e=[Mi,Ve("Relationships",null,{xmlns:ji.RELS})];return Oi(i["!id"]).forEach(function(t){e[e.length]=Ve("Relationship",null,i["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Kt(i,e,t,r,n,s){if(n||(n={}),i["!id"]||(i["!id"]={}),i["!idx"]||(i["!idx"]=1),e<0)for(e=i["!idx"];i["!id"]["rId"+e];++e);if(i["!idx"]=e+1,n.Id="rId"+e,n.Type=r,n.Target=t,[Dt.HLINK,Dt.XPATH,Dt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),i["!id"][n.Id])throw new Error("Cannot rewrite rId "+e);return i["!id"][n.Id]=n,i[("/"+n.Target).replace("//","/")]=n,e}var QI="application/vnd.oasis.opendocument.spreadsheet";function ZI(i,e){for(var t=bf(i),r,n;r=pl.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(n=gt(r[0],!1),n.path=="/"&&n.type!==QI)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}function JI(i){var e=[Mi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<i.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+i[t][0]+'" manifest:media-type="'+i[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Zp(i,e,t){return['  <rdf:Description rdf:about="'+i+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function eR(i,e){return['  <rdf:Description rdf:about="'+i+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function tR(i){var e=[Mi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=i.length;++t)e.push(Zp(i[t][0],i[t][1])),e.push(eR("",i[t][0]));return e.push(Zp("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function g_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zc.version+"</meta:generator></office:meta></office:document-meta>"}var gn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],iR=function(){for(var i=new Array(gn.length),e=0;e<gn.length;++e){var t=gn[e],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);i[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return i}();function v_(i){var e={};i=Qt(i);for(var t=0;t<gn.length;++t){var r=gn[t],n=i.match(iR[t]);n!=null&&n.length>0&&(e[r[1]]=Bt(n[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=ci(e[r[1]]))}return e}function Vu(i,e,t,r,n){n[i]!=null||e==null||e===""||(n[i]=e,e=jt(e),r[r.length]=t?Ve(i,e,t):ar(i,e))}function __(i,e){var t=e||{},r=[Mi,Ve("cp:coreProperties",null,{"xmlns:cp":ji.CORE_PROPS,"xmlns:dc":ji.dc,"xmlns:dcterms":ji.dcterms,"xmlns:dcmitype":ji.dcmitype,"xmlns:xsi":ji.xsi})],n={};if(!i&&!t.Props)return r.join("");i&&(i.CreatedDate!=null&&Vu("dcterms:created",typeof i.CreatedDate=="string"?i.CreatedDate:vd(i.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n),i.ModifiedDate!=null&&Vu("dcterms:modified",typeof i.ModifiedDate=="string"?i.ModifiedDate:vd(i.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n));for(var s=0;s!=gn.length;++s){var a=gn[s],o=t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:i?i[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Vu(a[0],o,null,r,n)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var ca=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],E_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function x_(i,e,t,r){var n=[];if(typeof i=="string")n=Wp(i,r);else for(var s=0;s<i.length;++s)n=n.concat(i[s].map(function(l){return{v:l}}));var a=typeof e=="string"?Wp(e,r).map(function(l){return l.v}):e,o=0,c=0;if(a.length>0)for(var h=0;h!==n.length;h+=2){switch(c=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=a.slice(o,o+c);break}o+=c}}function rR(i,e,t){var r={};return e||(e={}),i=Qt(i),ca.forEach(function(n){var s=(i.match(dl(n[0]))||[])[1];switch(n[2]){case"string":s&&(e[n[1]]=Bt(s));break;case"bool":e[n[1]]=s==="true";break;case"raw":var a=i.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));a&&a.length>0&&(r[n[1]]=a[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&x_(r.HeadingPairs,r.TitlesOfParts,e,t),e}function w_(i){var e=[],t=Ve;return i||(i={}),i.Application="SheetJS",e[e.length]=Mi,e[e.length]=Ve("Properties",null,{xmlns:ji.EXT_PROPS,"xmlns:vt":ji.vt}),ca.forEach(function(r){if(i[r[1]]!==void 0){var n;switch(r[2]){case"string":n=jt(String(i[r[1]]));break;case"bool":n=i[r[1]]?"true":"false";break}n!==void 0&&(e[e.length]=t(r[0],n))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(i.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",i.SheetNames.map(function(r){return"<vt:lpstr>"+jt(r)+"</vt:lpstr>"}).join(""),{size:i.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var nR=/<[^>]+>[^<]*/g;function sR(i,e){var t={},r="",n=i.match(nR);if(n)for(var s=0;s!=n.length;++s){var a=n[s],o=gt(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Bt(o.name);break;case"</property>":r=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),h=c[0].slice(4),l=c[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[r]=Bt(l);break;case"bool":t[r]=li(l);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(l,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(l);break;case"filetime":case"date":t[r]=ci(l);break;case"cy":case"error":t[r]=Bt(l);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,h,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return t}function C_(i){var e=[Mi,Ve("Properties",null,{xmlns:ji.CUST_PROPS,"xmlns:vt":ji.vt})];if(!i)return e.join("");var t=1;return Oi(i).forEach(function(n){++t,e[e.length]=Ve("property",pI(i[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:jt(n)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Cd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Uu;function aR(i,e,t){Uu||(Uu=Nh(Cd)),e=Uu[e]||e,i[e]=t}function oR(i,e){var t=[];return Oi(Cd).map(function(r){for(var n=0;n<gn.length;++n)if(gn[n][1]==r)return gn[n];for(n=0;n<ca.length;++n)if(ca[n][1]==r)return ca[n];throw r}).forEach(function(r){if(i[r[1]]!=null){var n=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:i[r[1]];switch(r[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),t.push(ar(Cd[r[1]]||r[1],n))}}),Ve("DocumentProperties",t.join(""),{xmlns:Kr.o})}function lR(i,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",n=[];return i&&Oi(i).forEach(function(s){if(Object.prototype.hasOwnProperty.call(i,s)){for(var a=0;a<gn.length;++a)if(s==gn[a][1])return;for(a=0;a<ca.length;++a)if(s==ca[a][1])return;for(a=0;a<t.length;++a)if(s==t[a])return;var o=i[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),n.push(Ve(Bp(s),o,{"dt:dt":c}))}}),e&&Oi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(i&&Object.prototype.hasOwnProperty.call(i,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),n.push(Ve(Bp(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Kr.o+'">'+n.join("")+"</"+r+">"}function Mf(i){var e=i.read_shift(4),t=i.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function cR(i){var e=typeof i=="string"?new Date(Date.parse(i)):i,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);r*=1e7,n*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),n+=s);var a=_e(8);return a.write_shift(4,r),a.write_shift(4,n),a}function y_(i,e,t){var r=i.l,n=i.read_shift(0,"lpstr-cp");if(t)for(;i.l-r&3;)++i.l;return n}function S_(i,e,t){var r=i.read_shift(0,"lpwstr");return r}function b_(i,e,t){return e===31?S_(i):y_(i,e,t)}function yd(i,e,t){return b_(i,e,t===!1?0:4)}function hR(i,e){if(!e)throw new Error("VtUnalignedString must have positive length");return b_(i,e,0)}function uR(i){for(var e=i.read_shift(4),t=[],r=0;r!=e;++r){var n=i.l;t[r]=i.read_shift(0,"lpwstr").replace(Or,""),i.l-n&2&&(i.l+=2)}return t}function dR(i){for(var e=i.read_shift(4),t=[],r=0;r!=e;++r)t[r]=i.read_shift(0,"lpstr-cp").replace(Or,"");return t}function fR(i){var e=i.l,t=oh(i,f_);i[i.l]==0&&i[i.l+1]==0&&i.l-e&2&&(i.l+=2);var r=oh(i,Nr);return[t,r]}function pR(i){for(var e=i.read_shift(4),t=[],r=0;r<e/2;++r)t.push(fR(i));return t}function Jp(i,e){for(var t=i.read_shift(4),r={},n=0;n!=t;++n){var s=i.read_shift(4),a=i.read_shift(4);r[s]=i.read_shift(a,e===1200?"utf16le":"utf8").replace(Or,"").replace(Lo,"!"),e===1200&&a%2&&(i.l+=2)}return i.l&3&&(i.l=i.l>>3<<2),r}function T_(i){var e=i.read_shift(4),t=i.slice(i.l,i.l+e);return i.l+=e,(e&3)>0&&(i.l+=4-(e&3)&3),t}function mR(i){var e={};return e.Size=i.read_shift(4),i.l+=e.Size+3-(e.Size-1)%4,e}function oh(i,e,t){var r=i.read_shift(2),n,s=t||{};if(i.l+=2,e!==jp&&r!==e&&YI.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===jp?r:e){case 2:return n=i.read_shift(2,"i"),s.raw||(i.l+=2),n;case 3:return n=i.read_shift(4,"i"),n;case 11:return i.read_shift(4)!==0;case 19:return n=i.read_shift(4),n;case 30:return y_(i,r,4).replace(Or,"");case 31:return S_(i);case 64:return Mf(i);case 65:return T_(i);case 71:return mR(i);case 80:return yd(i,r,!s.raw).replace(Or,"");case 81:return hR(i,r).replace(Or,"");case 4108:return pR(i);case 4126:case 4127:return r==4127?uR(i):dR(i);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function em(i,e){var t=_e(4),r=_e(4);switch(t.write_shift(4,i==80?31:i),i){case 3:r.write_shift(-4,e);break;case 5:r=_e(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=cR(e);break;case 31:case 80:for(r=_e(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+i+" "+e)}return er([t,r])}function tm(i,e){var t=i.l,r=i.read_shift(4),n=i.read_shift(4),s=[],a=0,o=0,c=-1,h={};for(a=0;a!=n;++a){var l=i.read_shift(4),u=i.read_shift(4);s[a]=[l,u+t]}s.sort(function(x,E){return x[1]-E[1]});var d={};for(a=0;a!=n;++a){if(i.l!==s[a][1]){var f=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:i.l+2===s[a][1]&&(i.l+=2,f=!1);break;case 80:i.l<=s[a][1]&&(i.l=s[a][1],f=!1);break;case 4108:i.l<=s[a][1]&&(i.l=s[a][1],f=!1);break}if((!e||a==0)&&i.l<=s[a][1]&&(f=!1,i.l=s[a][1]),f)throw new Error("Read Error: Expected address "+s[a][1]+" at "+i.l+" :"+a)}if(e){var p=e[s[a][0]];if(d[p.n]=oh(i,p.t,{raw:!0}),p.p==="version"&&(d[p.n]=String(d[p.n]>>16)+"."+("0000"+String(d[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(d[p.n]){case 0:d[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Dn(o=d[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[p.n])}}else if(s[a][0]===1){if(o=d.CodePage=oh(i,Pf),Dn(o),c!==-1){var m=i.l;i.l=s[c][1],h=Jp(i,o),i.l=m}}else if(s[a][0]===0){if(o===0){c=a,i.l=s[a+1][1];continue}h=Jp(i,o)}else{var v=h[s[a][0]],_;switch(i[i.l]){case 65:i.l+=4,_=T_(i);break;case 30:i.l+=4,_=yd(i,i[i.l-4]).replace(/\u0000+$/,"");break;case 31:i.l+=4,_=yd(i,i[i.l-4]).replace(/\u0000+$/,"");break;case 3:i.l+=4,_=i.read_shift(4,"i");break;case 19:i.l+=4,_=i.read_shift(4);break;case 5:i.l+=4,_=i.read_shift(8,"f");break;case 11:i.l+=4,_=Fi(i,4);break;case 64:i.l+=4,_=ci(Mf(i));break;default:throw new Error("unparsed value: "+i[i.l])}d[v]=_}}return i.l=t+r,d}var A_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gR(i){switch(typeof i){case"boolean":return 11;case"number":return(i|0)==i?3:5;case"string":return 31;case"object":if(i instanceof Date)return 64;break}return-1}function im(i,e,t){var r=_e(8),n=[],s=[],a=8,o=0,c=_e(8),h=_e(8);if(c.write_shift(4,2),c.write_shift(4,1200),h.write_shift(4,1),s.push(c),n.push(h),a+=8+c.length,!e){h=_e(8),h.write_shift(4,0),n.unshift(h);var l=[_e(4)];for(l[0].write_shift(4,i.length),o=0;o<i.length;++o){var u=i[o][0];for(c=_e(8+2*(u.length+1)+(u.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,u.length+1),c.write_shift(0,u,"dbcs");c.l!=c.length;)c.write_shift(1,0);l.push(c)}c=er(l),s.unshift(c),a+=8+c.length}for(o=0;o<i.length;++o)if(!(e&&!e[i[o][0]])&&!(A_.indexOf(i[o][0])>-1||E_.indexOf(i[o][0])>-1)&&i[o][1]!=null){var d=i[o][1],f=0;if(e){f=+e[i[o][0]];var p=t[f];if(p.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}c=em(p.t,d)}else{var v=gR(d);v==-1&&(v=31,d=String(d)),c=em(v,d)}s.push(c),h=_e(8),h.write_shift(4,e?f:2+o),n.push(h),a+=8+c.length}var _=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,_),_+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),er([r].concat(n).concat(s))}function rm(i,e,t){var r=i.content;if(!r)return{};sr(r,0);var n,s,a,o,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),l=r.read_shift(16);if(l!==st.utils.consts.HEADER_CLSID&&l!==t)throw new Error("Bad PropertySet CLSID "+l);if(n=r.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=r.read_shift(16),o=r.read_shift(4),n===1&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);n===2&&(a=r.read_shift(16),c=r.read_shift(4));var u=tm(r,e),d={SystemIdentifier:h};for(var f in u)d[f]=u[f];if(d.FMTID=s,n===1)return d;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);var p;try{p=tm(r,null)}catch{}for(f in p)d[f]=p[f];return d.FMTID=[s,a],d}function nm(i,e,t,r,n,s){var a=_e(n?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,n?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,n?68:48);var c=im(i,t,r);if(o.push(c),n){var h=im(n,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(h)}return er(o)}function As(i,e){return i.read_shift(e),null}function vR(i,e){e||(e=_e(i));for(var t=0;t<i;++t)e.write_shift(1,0);return e}function _R(i,e,t){for(var r=[],n=i.l+e;i.l<n;)r.push(t(i,n-i.l));if(n!==i.l)throw new Error("Slurp error");return r}function Fi(i,e){return i.read_shift(e)===1}function Ar(i,e){return e||(e=_e(2)),e.write_shift(2,+!!i),e}function $i(i){return i.read_shift(2,"u")}function pn(i,e){return e||(e=_e(2)),e.write_shift(2,i),e}function k_(i,e){return _R(i,e,$i)}function ER(i){var e=i.read_shift(1),t=i.read_shift(1);return t===1?e:e===1}function O_(i,e,t){return t||(t=_e(2)),t.write_shift(1,e=="e"?+i:+!!i),t.write_shift(1,e=="e"?1:0),t}function Nl(i,e,t){var r=i.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=i.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var a=r?i.read_shift(r,n):"";return a}function xR(i){var e=i.read_shift(2),t=i.read_shift(1),r=t&4,n=t&8,s=1+(t&1),a=0,o,c={};n&&(a=i.read_shift(2)),r&&(o=i.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",l=e===0?"":i.read_shift(e,h);return n&&(i.l+=4*a),r&&(i.l+=o),c.t=l,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function wR(i){var e=i.t||"",t=_e(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=_e(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=[t,r];return er(n)}function Ca(i,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return i.read_shift(e,"cpstr");if(t.biff>=12)return i.read_shift(e,"dbcs-cont")}var n=i.read_shift(1);return n===0?r=i.read_shift(e,"sbcs-cont"):r=i.read_shift(e,"dbcs-cont"),r}function Ml(i,e,t){var r=i.read_shift(t&&t.biff==2?1:2);return r===0?(i.l++,""):Ca(i,r,t)}function Da(i,e,t){if(t.biff>5)return Ml(i,e,t);var r=i.read_shift(1);return r===0?(i.l++,""):i.read_shift(r,t.biff<=4||!i.lens?"cpstr":"sbcs-cont")}function I_(i,e,t){return t||(t=_e(3+2*i.length)),t.write_shift(2,i.length),t.write_shift(1,1),t.write_shift(31,i,"utf16le"),t}function CR(i){var e=i.read_shift(1);i.l++;var t=i.read_shift(2);return i.l+=2,[e,t]}function yR(i){var e=i.read_shift(4),t=i.l,r=!1;e>24&&(i.l+=e-24,i.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),i.l=t);var n=i.read_shift((r?e-24:e)>>1,"utf16le").replace(Or,"");return r&&(i.l+=24),n}function SR(i){for(var e=i.read_shift(2),t="";e-- >0;)t+="../";var r=i.read_shift(0,"lpstr-ansi");if(i.l+=2,i.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=i.read_shift(4);if(n===0)return t+r.replace(/\\/g,"/");var s=i.read_shift(4);if(i.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=i.read_shift(s>>1,"utf16le").replace(Or,"");return t+a}function bR(i,e){var t=i.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return yR(i);case"0303000000000000c000000000000046":return SR(i);default:throw new Error("Unsupported Moniker "+t)}}function vc(i){var e=i.read_shift(4),t=e>0?i.read_shift(e,"utf16le").replace(Or,""):"";return t}function sm(i,e){e||(e=_e(6+i.length*2)),e.write_shift(4,1+i.length);for(var t=0;t<i.length;++t)e.write_shift(2,i.charCodeAt(t));return e.write_shift(2,0),e}function TR(i,e){var t=i.l+e,r=i.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var n=i.read_shift(2);i.l+=2;var s,a,o,c,h="",l,u;n&16&&(s=vc(i,t-i.l)),n&128&&(a=vc(i,t-i.l)),(n&257)===257&&(o=vc(i,t-i.l)),(n&257)===1&&(c=bR(i,t-i.l)),n&8&&(h=vc(i,t-i.l)),n&32&&(l=i.read_shift(16)),n&64&&(u=Mf(i)),i.l=t;var d=a||o||c||"";d&&h&&(d+="#"+h),d||(d="#"+h),n&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var f={Target:d};return l&&(f.guid=l),u&&(f.time=u),s&&(f.Tooltip=s),f}function AR(i){var e=_e(512),t=0,r=i.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var n=r.indexOf("#"),s=n>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(t=0;t<a.length;++t)e.write_shift(4,a[t]);if(s==28)r=r.slice(1),sm(r,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));var o=n>-1?r.slice(0,n):r;for(e.write_shift(4,2*(o.length+1)),t=0;t<o.length;++t)e.write_shift(2,o.charCodeAt(t));e.write_shift(2,0),s&8&&sm(n>-1?r.slice(n+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<a.length;++t)e.write_shift(1,parseInt(a[t],16));for(var c=0;r.slice(c*3,c*3+3)=="../"||r.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,r.length-3*c+1),t=0;t<r.length-3*c;++t)e.write_shift(1,r.charCodeAt(t+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function R_(i){var e=i.read_shift(1),t=i.read_shift(1),r=i.read_shift(1),n=i.read_shift(1);return[e,t,r,n]}function D_(i,e){var t=R_(i);return t[3]=0,t}function Qn(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2);return{r:e,c:t,ixfe:r}}function ya(i,e,t,r){return r||(r=_e(6)),r.write_shift(2,i),r.write_shift(2,e),r.write_shift(2,t||0),r}function kR(i){var e=i.read_shift(2),t=i.read_shift(2);return i.l+=8,{type:e,flags:t}}function OR(i,e,t){return e===0?"":Da(i,e,t)}function IR(i,e,t){var r=t.biff>8?4:2,n=i.read_shift(r),s=i.read_shift(r,"i"),a=i.read_shift(r,"i");return[n,s,a]}function F_(i){var e=i.read_shift(2),t=Ff(i);return[e,t]}function RR(i,e,t){i.l+=4,e-=4;var r=i.l+e,n=Nl(i,e,t),s=i.read_shift(2);if(r-=i.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return i.l+=s,n}function Bh(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2),n=i.read_shift(2);return{s:{c:r,r:e},e:{c:n,r:t}}}function P_(i,e){return e||(e=_e(8)),e.write_shift(2,i.s.r),e.write_shift(2,i.e.r),e.write_shift(2,i.s.c),e.write_shift(2,i.e.c),e}function N_(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(1),n=i.read_shift(1);return{s:{c:r,r:e},e:{c:n,r:t}}}var DR=N_;function M_(i){i.l+=4;var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2);return i.l+=12,[t,e,r]}function FR(i){var e={};return i.l+=4,i.l+=16,e.fSharedNote=i.read_shift(2),i.l+=4,e}function PR(i){var e={};return i.l+=4,i.cf=i.read_shift(2),e}function hr(i){i.l+=2,i.l+=i.read_shift(2)}var NR={0:hr,4:hr,5:hr,6:hr,7:PR,8:hr,9:hr,10:hr,11:hr,12:hr,13:FR,14:hr,15:hr,16:hr,17:hr,18:hr,19:hr,20:hr,21:M_};function MR(i,e){for(var t=i.l+e,r=[];i.l<t;){var n=i.read_shift(2);i.l-=2;try{r.push(NR[n](i,t-i.l))}catch{return i.l=t,r}}return i.l!=t&&(i.l=t),r}function _c(i,e){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=i.read_shift(2),e-=2,e>=2&&(t.dt=i.read_shift(2),i.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return i.read_shift(e),t}function Lf(i,e,t){var r=1536,n=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,n=8;break;case"biff4":r=4,n=6;break;case"biff3":r=3,n=6;break;case"biff2":r=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_e(n);return s.write_shift(2,r),s.write_shift(2,e),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function LR(i,e){return e===0||i.read_shift(2),1200}function BR(i,e,t){if(t.enc)return i.l+=e,"";var r=i.l,n=Da(i,0,t);return i.read_shift(e+r-i.l),n}function HR(i,e){var t=!e||e.biff==8,r=_e(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function VR(i,e,t){var r=t&&t.biff==8||e==2?i.read_shift(2):(i.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function UR(i,e,t){var r=i.read_shift(4),n=i.read_shift(1)&3,s=i.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Nl(i,0,t);return a.length===0&&(a="Sheet1"),{pos:r,hs:n,dt:s,name:a}}function WR(i,e){var t=!e||e.biff>=8?2:1,r=_e(8+t*i.name.length);r.write_shift(4,i.pos),r.write_shift(1,i.hs||0),r.write_shift(1,i.dt),r.write_shift(1,i.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*i.name.length,i.name,e.biff<8?"sbcs":"utf16le");var n=r.slice(0,r.l);return n.l=r.l,n}function zR(i,e){for(var t=i.l+e,r=i.read_shift(4),n=i.read_shift(4),s=[],a=0;a!=n&&i.l<t;++a)s.push(xR(i));return s.Count=r,s.Unique=n,s}function GR(i,e){var t=_e(8);t.write_shift(4,i.Count),t.write_shift(4,i.Unique);for(var r=[],n=0;n<i.length;++n)r[n]=wR(i[n]);var s=er([t].concat(r));return s.parts=[t.length].concat(r.map(function(a){return a.length})),s}function $R(i,e){var t={};return t.dsst=i.read_shift(2),i.l+=e-2,t}function YR(i){var e={};e.r=i.read_shift(2),e.c=i.read_shift(2),e.cnt=i.read_shift(2)-e.c;var t=i.read_shift(2);i.l+=4;var r=i.read_shift(1);return i.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=t/20),e}function XR(i){var e=kR(i);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var t=i.read_shift(4);return t!==0}function qR(i){return i.read_shift(2),i.read_shift(4)}function am(i,e,t){var r=0;t&&t.biff==2||(r=i.read_shift(2));var n=i.read_shift(2);t&&t.biff==2&&(r=1-(n>>15),n&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,n]}function KR(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(2),n=i.read_shift(2),s=i.read_shift(2),a=i.read_shift(2),o=i.read_shift(2),c=i.read_shift(2),h=i.read_shift(2);return{Pos:[e,t],Dim:[r,n],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:h}}function jR(){var i=_e(18);return i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,29280),i.write_shift(2,17600),i.write_shift(2,56),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,1),i.write_shift(2,500),i}function QR(i,e,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=i.read_shift(2);return{RTL:r&64}}function ZR(i){var e=_e(18),t=1718;return i&&i.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function JR(){}function eD(i,e,t){var r={dyHeight:i.read_shift(2),fl:i.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:i.l+=2;break;default:i.l+=10;break}return r.name=Nl(i,0,t),r}function tD(i,e){var t=i.name||"Arial",r=e&&e.biff==5,n=r?15+t.length:16+2*t.length,s=_e(n);return s.write_shift(2,i.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),s}function iD(i){var e=Qn(i);return e.isst=i.read_shift(4),e}function rD(i,e,t,r){var n=_e(10);return ya(i,e,r,n),n.write_shift(4,t),n}function nD(i,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=i.l+e,n=Qn(i);t.biff==2&&i.l++;var s=Ml(i,r-i.l,t);return n.val=s,n}function sD(i,e,t,r,n){var s=!n||n.biff==8,a=_e(8+ +s+(1+s)*t.length);return ya(i,e,r,a),a.write_shift(2,t.length),s&&a.write_shift(1,1),a.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),a}function aD(i,e,t){var r=i.read_shift(2),n=Da(i,0,t);return[r,n]}function oD(i,e,t,r){var n=t&&t.biff==5;r||(r=_e(n?3+e.length:5+2*e.length)),r.write_shift(2,i),r.write_shift(n?1:2,e.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}var lD=Da;function om(i,e,t){var r=i.l+e,n=t.biff==8||!t.biff?4:2,s=i.read_shift(n),a=i.read_shift(n),o=i.read_shift(2),c=i.read_shift(2);return i.l=r,{s:{r:s,c:o},e:{r:a,c}}}function cD(i,e){var t=e.biff==8||!e.biff?4:2,r=_e(2*t+6);return r.write_shift(t,i.s.r),r.write_shift(t,i.e.r+1),r.write_shift(2,i.s.c),r.write_shift(2,i.e.c+1),r.write_shift(2,0),r}function hD(i){var e=i.read_shift(2),t=i.read_shift(2),r=F_(i);return{r:e,c:t,ixfe:r[0],rknum:r[1]}}function uD(i,e){for(var t=i.l+e-2,r=i.read_shift(2),n=i.read_shift(2),s=[];i.l<t;)s.push(F_(i));if(i.l!==t)throw new Error("MulRK read error");var a=i.read_shift(2);if(s.length!=a-n+1)throw new Error("MulRK length mismatch");return{r,c:n,C:a,rkrec:s}}function dD(i,e){for(var t=i.l+e-2,r=i.read_shift(2),n=i.read_shift(2),s=[];i.l<t;)s.push(i.read_shift(2));if(i.l!==t)throw new Error("MulBlank read error");var a=i.read_shift(2);if(s.length!=a-n+1)throw new Error("MulBlank length mismatch");return{r,c:n,C:a,ixfe:s}}function fD(i,e,t,r){var n={},s=i.read_shift(4),a=i.read_shift(4),o=i.read_shift(4),c=i.read_shift(2);return n.patternType=XI[o>>26],r.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=a&15,n.dgRight=a>>4&15,n.dgTop=a>>8&15,n.dgBottom=a>>12&15,n.icvLeft=a>>16&127,n.icvRight=a>>23&127,n.grbitDiag=a>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function pD(i,e,t){var r={};return r.ifnt=i.read_shift(2),r.numFmtId=i.read_shift(2),r.flags=i.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=fD(i,e,r.fStyle,t),r}function lm(i,e,t,r){var n=t&&t.biff==5;r||(r=_e(n?16:20)),r.write_shift(2,0),i.style?(r.write_shift(2,i.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,i.numFmtId||0),r.write_shift(2,e<<4));var s=0;return i.numFmtId>0&&n&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),n||r.write_shift(4,0),r.write_shift(2,0),r}function mD(i){i.l+=4;var e=[i.read_shift(2),i.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function gD(i){var e=_e(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function cm(i,e,t){var r=Qn(i);(t.biff==2||e==9)&&++i.l;var n=ER(i);return r.val=n,r.t=n===!0||n===!1?"b":"e",r}function vD(i,e,t,r,n,s){var a=_e(8);return ya(i,e,r,a),O_(t,s,a),a}function _D(i,e,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=Qn(i),n=gr(i);return r.val=n,r}function ED(i,e,t,r){var n=_e(14);return ya(i,e,r,n),wa(t,n),n}var hm=OR;function xD(i,e,t){var r=i.l+e,n=i.read_shift(2),s=i.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ca(i,s),o=[];r>i.l;)o.push(Ml(i));return[s,n,a,o]}function um(i,e,t){var r=i.read_shift(2),n,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(n=RR(i,e-2,t)),s.body=n||i.read_shift(e-2),typeof n=="string"&&(s.Name=n),s}var wD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dm(i,e,t){var r=i.l+e,n=i.read_shift(2),s=i.read_shift(1),a=i.read_shift(1),o=i.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(i.l+=2),c=i.read_shift(2),t.biff==5&&(i.l+=2),i.l+=4);var h=Ca(i,a,t);n&32&&(h=wD[h.charCodeAt(0)]);var l=r-i.l;t&&t.biff==2&&--l;var u=r==i.l||o===0||!(l>0)?[]:MM(i,l,t,o);return{chKey:s,Name:h,itab:c,rgce:u}}function L_(i,e,t){if(t.biff<8)return CD(i,e,t);for(var r=[],n=i.l+e,s=i.read_shift(t.biff>8?4:2);s--!==0;)r.push(IR(i,t.biff>8?12:6,t));if(i.l!=n)throw new Error("Bad ExternSheet: "+i.l+" != "+n);return r}function CD(i,e,t){i[i.l+1]==3&&i[i.l]++;var r=Nl(i,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function yD(i,e,t){if(t.biff<8){i.l+=e;return}var r=i.read_shift(2),n=i.read_shift(2),s=Ca(i,r,t),a=Ca(i,n,t);return[s,a]}function SD(i,e,t){var r=N_(i);i.l++;var n=i.read_shift(1);return e-=8,[LM(i,e,t),n,r]}function fm(i,e,t){var r=DR(i);switch(t.biff){case 2:i.l++,e-=7;break;case 3:case 4:i.l+=2,e-=8;break;default:i.l+=6,e-=12}return[r,PM(i,e,t)]}function bD(i){var e=i.read_shift(4)!==0,t=i.read_shift(4)!==0,r=i.read_shift(4);return[e,t,r]}function TD(i,e,t){if(!(t.biff<8)){var r=i.read_shift(2),n=i.read_shift(2),s=i.read_shift(2),a=i.read_shift(2),o=Da(i,0,t);return t.biff<8&&i.read_shift(1),[{r,c:n},o,a,s]}}function AD(i,e,t){return TD(i,e,t)}function kD(i,e){for(var t=[],r=i.read_shift(2);r--;)t.push(Bh(i));return t}function OD(i){var e=_e(2+i.length*8);e.write_shift(2,i.length);for(var t=0;t<i.length;++t)P_(i[t],e);return e}function ID(i,e,t){if(t&&t.biff<8)return DD(i,e,t);var r=M_(i),n=MR(i,e-22,r[1]);return{cmo:r,ft:n}}var RD={8:function(i,e){var t=i.l+e;i.l+=10;var r=i.read_shift(2);i.l+=4,i.l+=2,i.l+=2,i.l+=2,i.l+=4;var n=i.read_shift(1);return i.l+=n,i.l=t,{fmt:r}}};function DD(i,e,t){i.l+=4;var r=i.read_shift(2),n=i.read_shift(2),s=i.read_shift(2);i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=2,i.l+=6,e-=36;var a=[];return a.push((RD[r]||Er)(i,e,t)),{cmo:[n,r,s],ft:a}}function FD(i,e,t){var r=i.l,n="";try{i.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?i.l+=6:a=CR(i,6,t);var o=i.read_shift(2);i.read_shift(2),$i(i,2);var c=i.read_shift(2);i.l+=c;for(var h=1;h<i.lens.length-1;++h){if(i.l-r!=i.lens[h])throw new Error("TxO: bad continue record");var l=i[i.l],u=Ca(i,i.lens[h+1]-i.lens[h]-1);if(n+=u,n.length>=(l?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return i.l=r+e,{t:n}}catch{return i.l=r+e,{t:n}}}function PD(i,e){var t=Bh(i);i.l+=16;var r=TR(i,e-24);return[t,r]}function ND(i){var e=_e(24),t=Ci(i[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)e.write_shift(1,parseInt(r[n],16));return er([e,AR(i[1])])}function MD(i,e){i.read_shift(2);var t=Bh(i),r=i.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(Or,""),[t,r]}function LD(i){var e=i[1].Tooltip,t=_e(10+2*(e.length+1));t.write_shift(2,2048);var r=Ci(i[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function BD(i){var e=[0,0],t;return t=i.read_shift(2),e[0]=Qp[t]||t,t=i.read_shift(2),e[1]=Qp[t]||t,e}function HD(i){return i||(i=_e(4)),i.write_shift(2,1),i.write_shift(2,1),i}function VD(i){for(var e=i.read_shift(2),t=[];e-- >0;)t.push(D_(i));return t}function UD(i){for(var e=i.read_shift(2),t=[];e-- >0;)t.push(D_(i));return t}function WD(i){i.l+=2;var e={cxfs:0,crc:0};return e.cxfs=i.read_shift(2),e.crc=i.read_shift(4),e}function B_(i,e,t){if(!t.cellStyles)return Er(i,e);var r=t&&t.biff>=12?4:2,n=i.read_shift(r),s=i.read_shift(r),a=i.read_shift(r),o=i.read_shift(r),c=i.read_shift(2);r==2&&(i.l+=2);var h={s:n,e:s,w:a,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(h.level=c>>8&7),h}function zD(i,e){var t=_e(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,i.width*256),t.write_shift(2,0);var r=0;return i.hidden&&(r|=1),t.write_shift(1,r),r=i.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function GD(i,e){var t={};return e<32||(i.l+=16,t.header=gr(i),t.footer=gr(i),i.l+=2),t}function $D(i,e,t){var r={area:!1};if(t.biff!=5)return i.l+=e,r;var n=i.read_shift(1);return i.l+=3,n&16&&(r.area=!0),r}function YD(i){for(var e=_e(2*i),t=0;t<i;++t)e.write_shift(2,t+1);return e}var XD=Qn,qD=k_,KD=Ml;function jD(i){var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(4),n={fmt:e,env:t,len:r,data:i.slice(i.l,i.l+r)};return i.l+=r,n}function QD(i,e,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=Qn(i);++i.l;var n=Da(i,e-7,t);return r.t="str",r.val=n,r}function ZD(i){var e=Qn(i);++i.l;var t=gr(i);return e.t="n",e.val=t,e}function JD(i,e,t){var r=_e(15);return Vl(r,i,e),r.write_shift(8,t,"f"),r}function eF(i){var e=Qn(i);++i.l;var t=i.read_shift(2);return e.t="n",e.val=t,e}function tF(i,e,t){var r=_e(9);return Vl(r,i,e),r.write_shift(2,t),r}function iF(i){var e=i.read_shift(1);return e===0?(i.l++,""):i.read_shift(e,"sbcs-cont")}function rF(i,e){i.l+=6,i.l+=2,i.l+=1,i.l+=3,i.l+=1,i.l+=e-13}function nF(i,e,t){var r=i.l+e,n=Qn(i),s=i.read_shift(2),a=Ca(i,s,t);return i.l=r,n.t="str",n.val=a,n}var sF=[2,3,48,49,131,139,140,245],Sd=function(){var i={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Nh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var h=[],l=Vs(1);switch(c.type){case"base64":l=Qr(sn(o));break;case"binary":l=Qr(o);break;case"buffer":case"array":l=o;break}sr(l,0);var u=l.read_shift(1),d=!!(u&136),f=!1,p=!1;switch(u){case 2:break;case 3:break;case 48:f=!0,d=!0;break;case 49:f=!0,d=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var m=0,v=521;u==2&&(m=l.read_shift(2)),l.l+=3,u!=2&&(m=l.read_shift(4)),m>1048576&&(m=1e6),u!=2&&(v=l.read_shift(2));var _=l.read_shift(2),x=c.codepage||1252;u!=2&&(l.l+=16,l.read_shift(1),l[l.l]!==0&&(x=i[l[l.l]]),l.l+=1,l.l+=2),p&&(l.l+=36);for(var E=[],C={},y=Math.min(l.length,u==2?521:v-10-(f?264:0)),b=p?32:11;l.l<y&&l[l.l]!=13;)switch(C={},C.name=cl.utils.decode(x,l.slice(l.l,l.l+b)).replace(/[\u0000\r\n].*$/g,""),l.l+=b,C.type=String.fromCharCode(l.read_shift(1)),u!=2&&!p&&(C.offset=l.read_shift(4)),C.len=l.read_shift(1),u==2&&(C.offset=l.read_shift(2)),C.dec=l.read_shift(1),C.name.length&&E.push(C),u!=2&&(l.l+=p?13:14),C.type){case"B":(!f||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(l[l.l]!==13&&(l.l=v-1),l.read_shift(1)!==13)throw new Error("DBF Terminator not found "+l.l+" "+l[l.l]);l.l=v;var T=0,R=0;for(h[0]=[],R=0;R!=E.length;++R)h[0][R]=E[R].name;for(;m-- >0;){if(l[l.l]===42){l.l+=_;continue}for(++l.l,h[++T]=[],R=0,R=0;R!=E.length;++R){var O=l.slice(l.l,l.l+E[R].len);l.l+=E[R].len,sr(O,0);var W=cl.utils.decode(x,O);switch(E[R].type){case"C":W.trim().length&&(h[T][R]=W.replace(/\s+$/,""));break;case"D":W.length===8?h[T][R]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):h[T][R]=W;break;case"F":h[T][R]=parseFloat(W.trim());break;case"+":case"I":h[T][R]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":h[T][R]=!0;break;case"N":case"F":h[T][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));h[T][R]="##MEMO##"+(p?parseInt(W.trim(),10):O.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(h[T][R]=+W||0);break;case"@":h[T][R]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":h[T][R]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":h[T][R]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[T][R]=-O.read_shift(-8,"f");break;case"B":if(f&&E[R].len==8){h[T][R]=O.read_shift(8,"f");break}case"G":case"P":O.l+=E[R].len;break;case"0":if(E[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[R].type)}}}if(u!=2&&l.l<l.length&&l[l.l++]!=26)throw new Error("DBF EOF Marker missing "+(l.l-1)+" of "+l.length+" "+l[l.l-1].toString(16));return c&&c.sheetRows&&(h=h.slice(0,c.sheetRows)),c.DBF=E,h}function r(o,c){var h=c||{};h.dateNF||(h.dateNF="yyyymmdd");var l=wo(t(o,h),h);return l["!cols"]=h.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete h.DBF,l}function n(o,c){try{return Ys(r(o,c),c)}catch(h){if(c&&c.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var h=c||{};if(+h.codepage>=0&&Dn(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var l=zr(),u=hh(o,{header:1,raw:!0,cellDates:!0}),d=u[0],f=u.slice(1),p=o["!cols"]||[],m=0,v=0,_=0,x=1;for(m=0;m<d.length;++m){if(((p[m]||{}).DBF||{}).name){d[m]=p[m].DBF.name,++_;continue}if(d[m]!=null){if(++_,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(v=0;v<1024;++v)if(d.indexOf(d[m]+"_"+v)==-1){d[m]+="_"+v;break}}}}var E=Ht(o["!ref"]),C=[],y=[],b=[];for(m=0;m<=E.e.c-E.s.c;++m){var T="",R="",O=0,W=[];for(v=0;v<f.length;++v)f[v][m]!=null&&W.push(f[v][m]);if(W.length==0||d[m]==null){C[m]="?";continue}for(v=0;v<W.length;++v){switch(typeof W[v]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=W[v]instanceof Date?"D":"C";break;default:R="C"}O=Math.max(O,String(W[v]).length),T=T&&T!=R?"C":R}O>250&&(O=250),R=((p[m]||{}).DBF||{}).type,R=="C"&&p[m].DBF.len>O&&(O=p[m].DBF.len),T=="B"&&R=="N"&&(T="N",b[m]=p[m].DBF.dec,O=p[m].DBF.len),y[m]=T=="C"||R=="N"?O:s[T]||0,x+=y[m],C[m]=T}var G=l.next(32);for(G.write_shift(4,318902576),G.write_shift(4,f.length),G.write_shift(2,296+32*_),G.write_shift(2,x),m=0;m<4;++m)G.write_shift(4,0);for(G.write_shift(4,0|(+e[Av]||3)<<8),m=0,v=0;m<d.length;++m)if(d[m]!=null){var Q=l.next(32),ne=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,ne,"sbcs"),Q.write_shift(1,C[m]=="?"?"C":C[m],"sbcs"),Q.write_shift(4,v),Q.write_shift(1,y[m]||s[C[m]]||0),Q.write_shift(1,b[m]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),v+=y[m]||s[C[m]]||0}var xe=l.next(264);for(xe.write_shift(4,13),m=0;m<65;++m)xe.write_shift(4,0);for(m=0;m<f.length;++m){var Ce=l.next(x);for(Ce.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(C[v]){case"L":Ce.write_shift(1,f[m][v]==null?63:f[m][v]?84:70);break;case"B":Ce.write_shift(8,f[m][v]||0,"f");break;case"N":var Fe="0";for(typeof f[m][v]=="number"&&(Fe=f[m][v].toFixed(b[v]||0)),_=0;_<y[v]-Fe.length;++_)Ce.write_shift(1,32);Ce.write_shift(1,Fe,"sbcs");break;case"D":f[m][v]?(Ce.write_shift(4,("0000"+f[m][v].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(f[m][v].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+f[m][v].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var ke=String(f[m][v]!=null?f[m][v]:"").slice(0,y[v]);for(Ce.write_shift(1,ke,"sbcs"),_=0;_<y[v]-ke.length;++_)Ce.write_shift(1,32);break}}return l.next(1).write_shift(1,26),l.end()}return{to_workbook:n,to_sheet:r,from_sheet:a}}(),H_=function(){var i={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Oi(i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(d,f){var p=i[f];return typeof p=="number"?Sp(p):p},r=function(d,f,p){var m=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return m==59?d:Sp(m)};i["|"]=254;function n(d,f){switch(f.type){case"base64":return s(sn(d),f);case"binary":return s(d,f);case"buffer":return s(Ot&&Buffer.isBuffer(d)?d.toString("binary"):$s(d),f);case"array":return s(xa(d),f)}throw new Error("Unrecognized type "+f.type)}function s(d,f){var p=d.split(/[\n\r]+/),m=-1,v=-1,_=0,x=0,E=[],C=[],y=null,b={},T=[],R=[],O=[],W=0,G;for(+f.codepage>=0&&Dn(+f.codepage);_!==p.length;++_){W=0;var Q=p[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),ne=Q.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),xe=ne[0],Ce;if(Q.length>0)switch(xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&C.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var Fe=!1,ke=!1,Ze=!1,ie=!1,Ee=-1,Pe=-1;for(x=1;x<ne.length;++x)switch(ne[x].charAt(0)){case"A":break;case"X":v=parseInt(ne[x].slice(1))-1,ke=!0;break;case"Y":for(m=parseInt(ne[x].slice(1))-1,ke||(v=0),G=E.length;G<=m;++G)E[G]=[];break;case"K":Ce=ne[x].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Pn(Ce))?isNaN(lo(Ce).getDate())||(Ce=ci(Ce)):(Ce=Pn(Ce),y!==null&&Eo(y)&&(Ce=Lh(Ce))),Fe=!0;break;case"E":ie=!0;var U=io(ne[x].slice(1),{r:m,c:v});E[m][v]=[E[m][v],U];break;case"S":Ze=!0,E[m][v]=[E[m][v],"S5S"];break;case"G":break;case"R":Ee=parseInt(ne[x].slice(1))-1;break;case"C":Pe=parseInt(ne[x].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+Q)}if(Fe&&(E[m][v]&&E[m][v].length==2?E[m][v][0]=Ce:E[m][v]=Ce,y=null),Ze){if(ie)throw new Error("SYLK shared formula cannot have own formula");var Z=Ee>-1&&E[Ee][Pe];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");E[m][v][1]=r1(Z[1],{r:m-Ee,c:v-Pe})}break;case"F":var q=0;for(x=1;x<ne.length;++x)switch(ne[x].charAt(0)){case"X":v=parseInt(ne[x].slice(1))-1,++q;break;case"Y":for(m=parseInt(ne[x].slice(1))-1,G=E.length;G<=m;++G)E[G]=[];break;case"M":W=parseInt(ne[x].slice(1))/20;break;case"F":break;case"G":break;case"P":y=C[parseInt(ne[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=ne[x].slice(1).split(" "),G=parseInt(O[0],10);G<=parseInt(O[1],10);++G)W=parseInt(O[2],10),R[G-1]=W===0?{hidden:!0}:{wch:W},Us(R[G-1]);break;case"C":v=parseInt(ne[x].slice(1))-1,R[v]||(R[v]={});break;case"R":m=parseInt(ne[x].slice(1))-1,T[m]||(T[m]={}),W>0?(T[m].hpt=W,T[m].hpx=ho(W)):W===0&&(T[m].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+Q)}q<1&&(y=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+Q)}}return T.length>0&&(b["!rows"]=T),R.length>0&&(b["!cols"]=R),f&&f.sheetRows&&(E=E.slice(0,f.sheetRows)),[E,b]}function a(d,f){var p=n(d,f),m=p[0],v=p[1],_=wo(m,f);return Oi(v).forEach(function(x){_[x]=v[x]}),_}function o(d,f){return Ys(a(d,f),f)}function c(d,f,p,m){var v="C;Y"+(p+1)+";X"+(m+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+zf(d.f,{r:p,c:m}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function h(d,f){f.forEach(function(p,m){var v="F;W"+(m+1)+" "+(m+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=vl(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=_l(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function l(d,f){f.forEach(function(p,m){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*El(p.hpx)+";"),v.length>2&&d.push(v+"R"+(m+1))})}function u(d,f){var p=["ID;PWXL;N;E"],m=[],v=Ht(d["!ref"]),_,x=Array.isArray(d),E=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),d["!cols"]&&h(p,d["!cols"]),d["!rows"]&&l(p,d["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var C=v.s.r;C<=v.e.r;++C)for(var y=v.s.c;y<=v.e.c;++y){var b=ut({r:C,c:y});_=x?(d[C]||[])[y]:d[b],!(!_||_.v==null&&(!_.f||_.F))&&m.push(c(_,d,C,y))}return p.join(E)+E+m.join(E)+E+"E"+E}return{to_workbook:o,to_sheet:a,from_sheet:u}}(),V_=function(){function i(s,a){switch(a.type){case"base64":return e(sn(s),a);case"binary":return e(s,a);case"buffer":return e(Ot&&Buffer.isBuffer(s)?s.toString("binary"):$s(s),a);case"array":return e(xa(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,h=-1,l=0,u=[];l!==o.length;++l){if(o[l].trim()==="BOT"){u[++c]=[],h=0;continue}if(!(c<0)){var d=o[l].trim().split(","),f=d[0],p=d[1];++l;for(var m=o[l]||"";(m.match(/["]/g)||[]).length&1&&l<o.length-1;)m+=`
`+o[++l];switch(m=m.trim(),+f){case-1:if(m==="BOT"){u[++c]=[],h=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?u[c][h]=!0:m==="FALSE"?u[c][h]=!1:isNaN(Pn(p))?isNaN(lo(p).getDate())?u[c][h]=p:u[c][h]=ci(p):u[c][h]=Pn(p),++h;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),u[c][h++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),u}function t(s,a){return wo(i(s,a),a)}function r(s,a){return Ys(t(s,a),a)}var n=function(){var s=function(c,h,l,u,d){c.push(h),c.push(l+","+u),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,h,l,u){c.push(h+","+l),c.push(h==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var h=[],l=Ht(c["!ref"]),u,d=Array.isArray(c);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,l.e.r-l.s.r+1,""),s(h,"TUPLES",0,l.e.c-l.s.c+1,""),s(h,"DATA",0,0,"");for(var f=l.s.r;f<=l.e.r;++f){a(h,-1,0,"BOT");for(var p=l.s.c;p<=l.e.c;++p){var m=ut({r:f,c:p});if(u=d?(c[f]||[])[p]:c[m],!u){a(h,1,0,"");continue}switch(u.t){case"n":var v=u.w;!v&&u.v!=null&&(v=u.v),v==null?u.f&&!u.F?a(h,1,0,"="+u.f):a(h,1,0,""):a(h,0,v,"V");break;case"b":a(h,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":a(h,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=_n(u.z||ht[14],Qi(ci(u.v)))),a(h,0,u.w,"V");break;default:a(h,1,0,"")}}}a(h,-1,0,"EOD");var _=`\r
`,x=h.join(_);return x}}();return{to_workbook:r,to_sheet:t,from_sheet:n}}(),U_=function(){function i(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(u,d){for(var f=u.split(`
`),p=-1,m=-1,v=0,_=[];v!==f.length;++v){var x=f[v].trim().split(":");if(x[0]==="cell"){var E=Ci(x[1]);if(_.length<=E.r)for(p=_.length;p<=E.r;++p)_[p]||(_[p]=[]);switch(p=E.r,m=E.c,x[2]){case"t":_[p][m]=i(x[3]);break;case"v":_[p][m]=+x[3];break;case"vtf":var C=x[x.length-1];case"vtc":switch(x[3]){case"nl":_[p][m]=!!+x[4];break;default:_[p][m]=+x[4];break}x[2]=="vtf"&&(_[p][m]=[_[p][m],C])}}}return d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),_}function r(u,d){return wo(t(u,d),d)}function n(u,d){return Ys(r(u,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function h(u){if(!u||!u["!ref"])return"";for(var d=[],f=[],p,m="",v=Gr(u["!ref"]),_=Array.isArray(u),x=v.s.r;x<=v.e.r;++x)for(var E=v.s.c;E<=v.e.c;++E)if(m=ut({r:x,c:E}),p=_?(u[x]||[])[E]:u[m],!(!p||p.v==null||p.t==="z")){switch(f=["cell",m,"t"],p.t){case"s":case"str":f.push(e(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=e(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var C=Qi(ci(p.v));f[2]="vtc",f[3]="nd",f[4]=""+C,f[5]=p.w||_n(p.z||ht[14],C);break;case"e":continue}d.push(f.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function l(u){return[s,a,o,a,h(u),c].join(`
`)}return{to_workbook:n,to_sheet:r,from_sheet:l}}(),co=function(){function i(l,u,d,f,p){p.raw?u[d][f]=l:l===""||(l==="TRUE"?u[d][f]=!0:l==="FALSE"?u[d][f]=!1:isNaN(Pn(l))?isNaN(lo(l).getDate())?u[d][f]=l:u[d][f]=ci(l):u[d][f]=Pn(l))}function e(l,u){var d=u||{},f=[];if(!l||l.length===0)return f;for(var p=l.split(/[\r\n]/),m=p.length-1;m>=0&&p[m].length===0;)--m;for(var v=10,_=0,x=0;x<=m;++x)_=p[x].indexOf(" "),_==-1?_=p[x].length:_++,v=Math.max(v,_);for(x=0;x<=m;++x){f[x]=[];var E=0;for(i(p[x].slice(0,v).trim(),f,x,E,d),E=1;E<=(p[x].length-v)/10+1;++E)i(p[x].slice(v+(E-1)*10,v+E*10).trim(),f,x,E,d)}return d.sheetRows&&(f=f.slice(0,d.sheetRows)),f}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(l){for(var u={},d=!1,f=0,p=0;f<l.length;++f)(p=l.charCodeAt(f))==34?d=!d:!d&&p in t&&(u[p]=(u[p]||0)+1);p=[];for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&p.push([u[f],f]);if(!p.length){u=r;for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&p.push([u[f],f])}return p.sort(function(m,v){return m[0]-v[0]||r[m[1]]-r[v[1]]}),t[p.pop()[1]]||44}function s(l,u){var d=u||{},f="",p=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};l.slice(0,4)=="sep="?l.charCodeAt(5)==13&&l.charCodeAt(6)==10?(f=l.charAt(4),l=l.slice(7)):l.charCodeAt(5)==13||l.charCodeAt(5)==10?(f=l.charAt(4),l=l.slice(6)):f=n(l.slice(0,1024)):d&&d.FS?f=d.FS:f=n(l.slice(0,1024));var v=0,_=0,x=0,E=0,C=0,y=f.charCodeAt(0),b=!1,T=0,R=l.charCodeAt(0);l=l.replace(/\r\n/mg,`
`);var O=d.dateNF!=null?$O(d.dateNF):null;function W(){var G=l.slice(E,C),Q={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)Q.t="z";else if(d.raw)Q.t="s",Q.v=G;else if(G.trim().length===0)Q.t="s",Q.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(Q.t="s",Q.v=G.slice(2,-1).replace(/""/g,'"')):xN(G)?(Q.t="n",Q.f=G.slice(1)):(Q.t="s",Q.v=G);else if(G=="TRUE")Q.t="b",Q.v=!0;else if(G=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(x=Pn(G)))Q.t="n",d.cellText!==!1&&(Q.w=G),Q.v=x;else if(!isNaN(lo(G).getDate())||O&&G.match(O)){Q.z=d.dateNF||ht[14];var ne=0;O&&G.match(O)&&(G=YO(G,d.dateNF,G.match(O)||[]),ne=1),d.cellDates?(Q.t="d",Q.v=ci(G,ne)):(Q.t="n",Q.v=Qi(ci(G,ne))),d.cellText!==!1&&(Q.w=_n(Q.z,Q.v instanceof Date?Qi(Q.v):Q.v)),d.cellNF||delete Q.z}else Q.t="s",Q.v=G;if(Q.t=="z"||(d.dense?(p[v]||(p[v]=[]),p[v][_]=Q):p[ut({c:_,r:v})]=Q),E=C+1,R=l.charCodeAt(E),m.e.c<_&&(m.e.c=_),m.e.r<v&&(m.e.r=v),T==y)++_;else if(_=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;C<l.length;++C)switch(T=l.charCodeAt(C)){case 34:R===34&&(b=!b);break;case y:case 10:case 13:if(!b&&W())break e;break}return C-E>0&&W(),p["!ref"]=Tt(m),p}function a(l,u){return!(u&&u.PRN)||u.FS||l.slice(0,4)=="sep="||l.indexOf("	")>=0||l.indexOf(",")>=0||l.indexOf(";")>=0?s(l,u):wo(e(l,u),u)}function o(l,u){var d="",f=u.type=="string"?[0,0,0,0]:Qf(l,u);switch(u.type){case"base64":d=sn(l);break;case"binary":d=l;break;case"buffer":u.codepage==65001?d=l.toString("utf8"):u.codepage&&typeof cl<"u"||(d=Ot&&Buffer.isBuffer(l)?l.toString("binary"):$s(l));break;case"array":d=xa(l);break;case"string":d=l;break;default:throw new Error("Unrecognized type "+u.type)}return f[0]==239&&f[1]==187&&f[2]==191?d=Qt(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=Qt(d):u.type=="binary"&&typeof cl<"u",d.slice(0,19)=="socialcalc:version:"?U_.to_sheet(u.type=="string"?d:Qt(d),u):a(d,u)}function c(l,u){return Ys(o(l,u),u)}function h(l){for(var u=[],d=Ht(l["!ref"]),f,p=Array.isArray(l),m=d.s.r;m<=d.e.r;++m){for(var v=[],_=d.s.c;_<=d.e.c;++_){var x=ut({r:m,c:_});if(f=p?(l[m]||[])[_]:l[x],!f||f.v==null){v.push("          ");continue}for(var E=(f.w||(_s(f),f.w)||"").slice(0,10);E.length<10;)E+=" ";v.push(E+(_===0?" ":""))}u.push(v.join(""))}return u.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:h}}();function aF(i,e){var t=e||{},r=!!t.WTF;t.WTF=!0;try{var n=H_.to_workbook(i,t);return t.WTF=r,n}catch(s){if(t.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return co.to_workbook(i,e)}}var ha=function(){function i(U,Z,q){if(U){sr(U,U.l||0);for(var X=q.Enum||Ee;U.l<U.length;){var de=U.read_shift(2),Ie=X[de]||X[65535],we=U.read_shift(2),Re=U.l+we,be=Ie.f&&Ie.f(U,we,q);if(U.l=Re,Z(be,Ie,de))return}}}function e(U,Z){switch(Z.type){case"base64":return t(Qr(sn(U)),Z);case"binary":return t(Qr(U),Z);case"buffer":case"array":return t(U,Z)}throw"Unsupported type "+Z.type}function t(U,Z){if(!U)return U;var q=Z||{},X=q.dense?[]:{},de="Sheet1",Ie="",we=0,Re={},be=[],ue=[],M={s:{r:0,c:0},e:{r:0,c:0}},it=q.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)q.Enum=Ee,i(U,function(Te,dt,wt){switch(wt){case 0:q.vers=Te,Te>=4096&&(q.qpro=!0);break;case 6:M=Te;break;case 204:Te&&(Ie=Te);break;case 222:Ie=Te;break;case 15:case 51:q.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:wt==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=q.dateNF||ht[14],q.cellDates&&(Te[1].t="d",Te[1].v=Lh(Te[1].v))),q.qpro&&Te[3]>we&&(X["!ref"]=Tt(M),Re[de]=X,be.push(de),X=q.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},we=Te[3],de=Ie||"Sheet"+(we+1),Ie="");var Gt=q.dense?(X[Te[0].r]||[])[Te[0].c]:X[ut(Te[0])];if(Gt){Gt.t=Te[1].t,Gt.v=Te[1].v,Te[1].z!=null&&(Gt.z=Te[1].z),Te[1].f!=null&&(Gt.f=Te[1].f);break}q.dense?(X[Te[0].r]||(X[Te[0].r]=[]),X[Te[0].r][Te[0].c]=Te[1]):X[ut(Te[0])]=Te[1];break}},q);else if(U[2]==26||U[2]==14)q.Enum=Pe,U[2]==14&&(q.qpro=!0,U.l=0),i(U,function(Te,dt,wt){switch(wt){case 204:de=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>we&&(X["!ref"]=Tt(M),Re[de]=X,be.push(de),X=q.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},we=Te[3],de="Sheet"+(we+1)),it>0&&Te[0].r>=it)break;q.dense?(X[Te[0].r]||(X[Te[0].r]=[]),X[Te[0].r][Te[0].c]=Te[1]):X[ut(Te[0])]=Te[1],M.e.c<Te[0].c&&(M.e.c=Te[0].c),M.e.r<Te[0].r&&(M.e.r=Te[0].r);break;case 27:Te[14e3]&&(ue[Te[14e3][0]]=Te[14e3][1]);break;case 1537:ue[Te[0]]=Te[1],Te[0]==we&&(de=Te[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(X["!ref"]=Tt(M),Re[Ie||de]=X,be.push(Ie||de),!ue.length)return{SheetNames:be,Sheets:Re};for(var et={},he=[],Qe=0;Qe<ue.length;++Qe)Re[be[Qe]]?(he.push(ue[Qe]||be[Qe]),et[ue[Qe]]=Re[ue[Qe]]||Re[be[Qe]]):(he.push(ue[Qe]),et[ue[Qe]]={"!ref":"A1"});return{SheetNames:he,Sheets:et}}function r(U,Z){var q=Z||{};if(+q.codepage>=0&&Dn(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var X=zr(),de=Ht(U["!ref"]),Ie=Array.isArray(U),we=[];Ue(X,0,s(1030)),Ue(X,6,c(de));for(var Re=Math.min(de.e.r,8191),be=de.s.r;be<=Re;++be)for(var ue=Ni(be),M=de.s.c;M<=de.e.c;++M){be===de.s.r&&(we[M]=wi(M));var it=we[M]+ue,et=Ie?(U[be]||[])[M]:U[it];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?Ue(X,13,f(be,M,et.v)):Ue(X,14,m(be,M,et.v));else{var he=_s(et);Ue(X,15,u(be,M,he.slice(0,239)))}}return Ue(X,1),X.end()}function n(U,Z){var q=Z||{};if(+q.codepage>=0&&Dn(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var X=zr();Ue(X,0,a(U));for(var de=0,Ie=0;de<U.SheetNames.length;++de)(U.Sheets[U.SheetNames[de]]||{})["!ref"]&&Ue(X,27,ie(U.SheetNames[de],Ie++));var we=0;for(de=0;de<U.SheetNames.length;++de){var Re=U.Sheets[U.SheetNames[de]];if(!(!Re||!Re["!ref"])){for(var be=Ht(Re["!ref"]),ue=Array.isArray(Re),M=[],it=Math.min(be.e.r,8191),et=be.s.r;et<=it;++et)for(var he=Ni(et),Qe=be.s.c;Qe<=be.e.c;++Qe){et===be.s.r&&(M[Qe]=wi(Qe));var Te=M[Qe]+he,dt=ue?(Re[et]||[])[Qe]:Re[Te];if(!(!dt||dt.t=="z"))if(dt.t=="n")Ue(X,23,W(et,Qe,we,dt.v));else{var wt=_s(dt);Ue(X,22,T(et,Qe,we,wt.slice(0,239)))}}++we}}return Ue(X,1),X.end()}function s(U){var Z=_e(2);return Z.write_shift(2,U),Z}function a(U){var Z=_e(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var q=0,X=0,de=0,Ie=0;Ie<U.SheetNames.length;++Ie){var we=U.SheetNames[Ie],Re=U.Sheets[we];if(!(!Re||!Re["!ref"])){++de;var be=Gr(Re["!ref"]);q<be.e.r&&(q=be.e.r),X<be.e.c&&(X=be.e.c)}}return q>8191&&(q=8191),Z.write_shift(2,q),Z.write_shift(1,de),Z.write_shift(1,X),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function o(U,Z,q){var X={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&q.qpro?(X.s.c=U.read_shift(1),U.l++,X.s.r=U.read_shift(2),X.e.c=U.read_shift(1),U.l++,X.e.r=U.read_shift(2),X):(X.s.c=U.read_shift(2),X.s.r=U.read_shift(2),Z==12&&q.qpro&&(U.l+=2),X.e.c=U.read_shift(2),X.e.r=U.read_shift(2),Z==12&&q.qpro&&(U.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function c(U){var Z=_e(8);return Z.write_shift(2,U.s.c),Z.write_shift(2,U.s.r),Z.write_shift(2,U.e.c),Z.write_shift(2,U.e.r),Z}function h(U,Z,q){var X=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(X[0].c=U.read_shift(1),X[3]=U.read_shift(1),X[0].r=U.read_shift(2),U.l+=2):(X[2]=U.read_shift(1),X[0].c=U.read_shift(2),X[0].r=U.read_shift(2)),X}function l(U,Z,q){var X=U.l+Z,de=h(U,Z,q);if(de[1].t="s",q.vers==20768){U.l++;var Ie=U.read_shift(1);return de[1].v=U.read_shift(Ie,"utf8"),de}return q.qpro&&U.l++,de[1].v=U.read_shift(X-U.l,"cstr"),de}function u(U,Z,q){var X=_e(7+q.length);X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,U),X.write_shift(1,39);for(var de=0;de<X.length;++de){var Ie=q.charCodeAt(de);X.write_shift(1,Ie>=128?95:Ie)}return X.write_shift(1,0),X}function d(U,Z,q){var X=h(U,Z,q);return X[1].v=U.read_shift(2,"i"),X}function f(U,Z,q){var X=_e(7);return X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,U),X.write_shift(2,q,"i"),X}function p(U,Z,q){var X=h(U,Z,q);return X[1].v=U.read_shift(8,"f"),X}function m(U,Z,q){var X=_e(13);return X.write_shift(1,255),X.write_shift(2,Z),X.write_shift(2,U),X.write_shift(8,q,"f"),X}function v(U,Z,q){var X=U.l+Z,de=h(U,Z,q);if(de[1].v=U.read_shift(8,"f"),q.qpro)U.l=X;else{var Ie=U.read_shift(2);C(U.slice(U.l,U.l+Ie),de),U.l+=Ie}return de}function _(U,Z,q){var X=Z&32768;return Z&=-32769,Z=(X?U:0)+(Z>=8192?Z-16384:Z),(X?"":"$")+(q?wi(Z):Ni(Z))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(U,Z){sr(U,0);for(var q=[],X=0,de="",Ie="",we="",Re="";U.l<U.length;){var be=U[U.l++];switch(be){case 0:q.push(U.read_shift(8,"f"));break;case 1:Ie=_(Z[0].c,U.read_shift(2),!0),de=_(Z[0].r,U.read_shift(2),!1),q.push(Ie+de);break;case 2:{var ue=_(Z[0].c,U.read_shift(2),!0),M=_(Z[0].r,U.read_shift(2),!1);Ie=_(Z[0].c,U.read_shift(2),!0),de=_(Z[0].r,U.read_shift(2),!1),q.push(ue+M+":"+Ie+de)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(U.read_shift(2));break;case 6:{for(var it="";be=U[U.l++];)it+=String.fromCharCode(be);q.push('"'+it.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:Re=q.pop(),we=q.pop(),q.push(["AND","OR"][be-20]+"("+we+","+Re+")");break;default:if(be<32&&E[be])Re=q.pop(),we=q.pop(),q.push(we+E[be]+Re);else if(x[be]){if(X=x[be][1],X==69&&(X=U[U.l++]),X>q.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+q.join("|")+"|");return}var et=q.slice(-X);q.length-=X,q.push(x[be][0]+"("+et.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}q.length==1?Z[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function y(U){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=U.read_shift(2),Z[3]=U[U.l++],Z[0].c=U[U.l++],Z}function b(U,Z){var q=y(U);return q[1].t="s",q[1].v=U.read_shift(Z-4,"cstr"),q}function T(U,Z,q,X){var de=_e(6+X.length);de.write_shift(2,U),de.write_shift(1,q),de.write_shift(1,Z),de.write_shift(1,39);for(var Ie=0;Ie<X.length;++Ie){var we=X.charCodeAt(Ie);de.write_shift(1,we>=128?95:we)}return de.write_shift(1,0),de}function R(U,Z){var q=y(U);q[1].v=U.read_shift(2);var X=q[1].v>>1;if(q[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return q[1].v=X,q}function O(U,Z){var q=y(U),X=U.read_shift(4),de=U.read_shift(4),Ie=U.read_shift(2);if(Ie==65535)return X===0&&de===3221225472?(q[1].t="e",q[1].v=15):X===0&&de===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var we=Ie&32768;return Ie=(Ie&32767)-16446,q[1].v=(1-we*2)*(de*Math.pow(2,Ie+32)+X*Math.pow(2,Ie)),q}function W(U,Z,q,X){var de=_e(14);if(de.write_shift(2,U),de.write_shift(1,q),de.write_shift(1,Z),X==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var Ie=0,we=0,Re=0,be=0;return X<0&&(Ie=1,X=-X),we=Math.log2(X)|0,X/=Math.pow(2,we-31),be=X>>>0,be&2147483648||(X/=2,++we,be=X>>>0),X-=be,be|=2147483648,be>>>=0,X*=Math.pow(2,32),Re=X>>>0,de.write_shift(4,Re),de.write_shift(4,be),we+=16383+(Ie?32768:0),de.write_shift(2,we),de}function G(U,Z){var q=O(U);return U.l+=Z-14,q}function Q(U,Z){var q=y(U),X=U.read_shift(4);return q[1].v=X>>6,q}function ne(U,Z){var q=y(U),X=U.read_shift(8,"f");return q[1].v=X,q}function xe(U,Z){var q=ne(U);return U.l+=Z-10,q}function Ce(U,Z){return U[U.l+Z-1]==0?U.read_shift(Z,"cstr"):""}function Fe(U,Z){var q=U[U.l++];q>Z-1&&(q=Z-1);for(var X="";X.length<q;)X+=String.fromCharCode(U[U.l++]);return X}function ke(U,Z,q){if(!(!q.qpro||Z<21)){var X=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var de=U.read_shift(Z-21,"cstr");return[X,de]}}function Ze(U,Z){for(var q={},X=U.l+Z;U.l<X;){var de=U.read_shift(2);if(de==14e3){for(q[de]=[0,""],q[de][0]=U.read_shift(2);U[U.l];)q[de][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return q}function ie(U,Z){var q=_e(5+U.length);q.write_shift(2,14e3),q.write_shift(2,Z);for(var X=0;X<U.length;++X){var de=U.charCodeAt(X);q[q.l++]=de>127?95:de}return q[q.l++]=0,q}var Ee={0:{n:"BOF",f:$i},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:l},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:l},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:Fe},65535:{n:""}},Pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ke},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:n,to_workbook:e}}();function oF(i){var e={},t=i.match(Cr),r=0,n=!1;if(t)for(;r!=t.length;++r){var s=gt(t[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=pf[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return e}var lF=function(){var i=dl("t"),e=dl("rPr");function t(s){var a=s.match(i);if(!a)return{t:"s",v:""};var o={t:"s",v:Bt(a[1])},c=s.match(e);return c&&(o.s=oF(c[1])),o}var r=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(a){return a.replace(r,"").split(n).map(t).filter(function(o){return o.v})}}(),cF=function(){var e=/(\r\n|\n)/g;function t(n,s,a){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),a.push("</b>")),n.i&&(s.push("<i>"),a.push("</i>")),n.strike&&(s.push("<s>"),a.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),n}function r(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),hF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uF=/<(?:\w+:)?r>/,dF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Bf(i,e){var t=e?e.cellHTML:!0,r={};return i?(i.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Bt(Qt(i.slice(i.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Qt(i),t&&(r.h=Sf(r.t))):i.match(uF)&&(r.r=Qt(i),r.t=Bt(Qt((i.replace(dF,"").match(hF)||[]).join("").replace(Cr,""))),t&&(r.h=cF(lF(r.r)))),r):{t:""}}var fF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,pF=/<(?:\w+:)?(?:si|sstItem)>/g,mF=/<\/(?:\w+:)?(?:si|sstItem)>/;function gF(i,e){var t=[],r="";if(!i)return t;var n=i.match(fF);if(n){r=n[2].replace(pF,"").split(mF);for(var s=0;s!=r.length;++s){var a=Bf(r[s].trim(),e);a!=null&&(t[t.length]=a)}n=gt(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}var vF=/^\s|\s$|[\t\n\r]/;function W_(i,e){if(!e.bookSST)return"";var t=[Mi];t[t.length]=Ve("sst",null,{xmlns:Aa[0],count:i.Count,uniqueCount:i.Unique});for(var r=0;r!=i.length;++r)if(i[r]!=null){var n=i[r],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(vF)&&(s+=' xml:space="preserve"'),s+=">"+jt(n.t)+"</t>"),s+="</si>",t[t.length]=s}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function _F(i){return[i.read_shift(4),i.read_shift(4)]}function EF(i,e){var t=[],r=!1;return ws(i,function(s,a,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function xF(i,e){return e||(e=_e(8)),e.write_shift(4,i.Count),e.write_shift(4,i.Unique),e}var wF=RI;function CF(i){var e=zr();De(e,159,xF(i));for(var t=0;t<i.length;++t)De(e,19,wF(i[t]));return De(e,160),e.end()}function z_(i){for(var e=[],t=i.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function fs(i,e){var t={};return t.Major=i.read_shift(2),t.Minor=i.read_shift(2),e>=4&&(i.l+=e-4),t}function yF(i){var e={};return e.id=i.read_shift(0,"lpp4"),e.R=fs(i,4),e.U=fs(i,4),e.W=fs(i,4),e}function SF(i){for(var e=i.read_shift(4),t=i.l+e-4,r={},n=i.read_shift(4),s=[];n-- >0;)s.push({t:i.read_shift(4),v:i.read_shift(0,"lpp4")});if(r.name=i.read_shift(0,"lpp4"),r.comps=s,i.l!=t)throw new Error("Bad DataSpaceMapEntry: "+i.l+" != "+t);return r}function bF(i){var e=[];i.l+=4;for(var t=i.read_shift(4);t-- >0;)e.push(SF(i));return e}function TF(i){var e=[];i.l+=4;for(var t=i.read_shift(4);t-- >0;)e.push(i.read_shift(0,"lpp4"));return e}function AF(i){var e={};return i.read_shift(4),i.l+=4,e.id=i.read_shift(0,"lpp4"),e.name=i.read_shift(0,"lpp4"),e.R=fs(i,4),e.U=fs(i,4),e.W=fs(i,4),e}function kF(i){var e=AF(i);if(e.ename=i.read_shift(0,"8lpp4"),e.blksz=i.read_shift(4),e.cmode=i.read_shift(4),i.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function G_(i,e){var t=i.l+e,r={};r.Flags=i.read_shift(4)&63,i.l+=4,r.AlgID=i.read_shift(4);var n=!1;switch(r.AlgID){case 26126:case 26127:case 26128:n=r.Flags==36;break;case 26625:n=r.Flags==4;break;case 0:n=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=i.read_shift(4),r.KeySize=i.read_shift(4),r.ProviderType=i.read_shift(4),i.l+=8,r.CSPName=i.read_shift(t-i.l>>1,"utf16le"),i.l=t,r}function $_(i,e){var t={},r=i.l+e;return i.l+=4,t.Salt=i.slice(i.l,i.l+16),i.l+=16,t.Verifier=i.slice(i.l,i.l+16),i.l+=16,i.read_shift(4),t.VerifierHash=i.slice(i.l,r),i.l=r,t}function OF(i){var e=fs(i);switch(e.Minor){case 2:return[e.Minor,IF(i)];case 3:return[e.Minor,RF()];case 4:return[e.Minor,DF(i)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function IF(i){var e=i.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var t=i.read_shift(4),r=G_(i,t),n=$_(i,i.length-i.l);return{t:"Std",h:r,v:n}}function RF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function DF(i){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];i.l+=4;var t=i.read_shift(i.length-i.l,"utf8"),r={};return t.replace(Cr,function(s){var a=gt(s);switch(jn(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){r[o]=a[o]});break;case"<dataIntegrity":r.encryptedHmacKey=a.encryptedHmacKey,r.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(a);break;default:throw a[0]}}),r}function FF(i,e){var t={},r=t.EncryptionVersionInfo=fs(i,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=i.read_shift(4),e-=4;var n=i.read_shift(4);return e-=4,t.EncryptionHeader=G_(i,n),e-=n,t.EncryptionVerifier=$_(i,e),t}function PF(i){var e={},t=e.EncryptionVersionInfo=fs(i,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return e.Salt=i.read_shift(16),e.EncryptedVerifier=i.read_shift(16),e.EncryptedVerifierHash=i.read_shift(16),e}function Hf(i){var e=0,t,r=z_(i),n=r.length+1,s,a,o,c,h;for(t=Vs(n),t[0]=r.length,s=1;s!=n;++s)t[s]=r[s-1];for(s=n-1;s>=0;--s)a=t[s],o=e&16384?1:0,c=e<<1&32767,h=o|c,e=h^a;return e^52811}var Y_=function(){var i=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(a){return(a/2|a*128)&255},n=function(a,o){return r(a^o)},s=function(a){for(var o=e[a.length-1],c=104,h=a.length-1;h>=0;--h)for(var l=a[h],u=0;u!=7;++u)l&64&&(o^=t[c]),l*=2,--c;return o};return function(a){for(var o=z_(a),c=s(o),h=o.length,l=Vs(16),u=0;u!=16;++u)l[u]=0;var d,f,p;for((h&1)===1&&(d=c>>8,l[h]=n(i[0],d),--h,d=c&255,f=o[o.length-1],l[h]=n(f,d));h>0;)--h,d=c>>8,l[h]=n(o[h],d),--h,d=c&255,l[h]=n(o[h],d);for(h=15,p=15-o.length;p>0;)d=c>>8,l[h]=n(i[p],d),--h,--p,d=c&255,l[h]=n(o[h],d),--h,--p;return l}}(),NF=function(i,e,t,r,n){n||(n=e),r||(r=Y_(i));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=r[t],a=(a>>5|a<<3)&255,n[s]=a,++t;return[n,t,r]},MF=function(i){var e=0,t=Y_(i);return function(r){var n=NF("",r,e,t);return e=n[1],n[0]}};function LF(i,e,t,r){var n={key:$i(i),verificationBytes:$i(i)};return t.password&&(n.verifier=Hf(t.password)),r.valid=n.verificationBytes===n.verifier,r.valid&&(r.insitu=MF(t.password)),n}function BF(i,e,t){var r=t||{};return r.Info=i.read_shift(2),i.l-=2,r.Info===1?r.Data=PF(i):r.Data=FF(i,e),r}function HF(i,e,t){var r={Type:t.biff>=8?i.read_shift(2):0};return r.Type?BF(i,e-2,r):LF(i,t.biff>=8?e:e-2,t,r),r}var X_=function(){function i(n,s){switch(s.type){case"base64":return e(sn(n),s);case"binary":return e(n,s);case"buffer":return e(Ot&&Buffer.isBuffer(n)?n.toString("binary"):$s(n),s);case"array":return e(xa(n),s)}throw new Error("Unrecognized type "+s.type)}function e(n,s){var a=s||{},o=a.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(l,u){Array.isArray(o)&&(o[u]=[]);for(var d=/\\\w+\b/g,f=0,p,m=-1;p=d.exec(l);){switch(p[0]){case"\\cell":var v=l.slice(f,d.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++m,v.length){var _={v,t:"s"};Array.isArray(o)?o[u][m]=_:o[ut({r:u,c:m})]=_}break}f=d.lastIndex}m>h.e.c&&(h.e.c=m)}),o["!ref"]=Tt(h),o}function t(n,s){return Ys(i(n,s),s)}function r(n){for(var s=["{\\rtf1\\ansi"],a=Ht(n["!ref"]),o,c=Array.isArray(n),h=a.s.r;h<=a.e.r;++h){s.push("\\trowd\\trautofit1");for(var l=a.s.c;l<=a.e.c;++l)s.push("\\cellx"+(l+1));for(s.push("\\pard\\intbl"),l=a.s.c;l<=a.e.c;++l){var u=ut({r:h,c:l});o=c?(n[h]||[])[l]:n[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(_s(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:i,from_sheet:r}}();function VF(i){var e=i.slice(i[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function gl(i){for(var e=0,t=1;e!=3;++e)t=t*256+(i[e]>255?255:i[e]<0?0:i[e]);return t.toString(16).toUpperCase().slice(1)}function UF(i){var e=i[0]/255,t=i[1]/255,r=i[2]/255,n=Math.max(e,t,r),s=Math.min(e,t,r),a=n-s;if(a===0)return[0,0,e];var o=0,c=0,h=n+s;switch(c=a/(h>1?2-h:h),n){case e:o=((t-r)/a+6)%6;break;case t:o=(r-e)/a+2;break;case r:o=(e-t)/a+4;break}return[o/6,c,h/2]}function WF(i){var e=i[0],t=i[1],r=i[2],n=t*2*(r<.5?r:1-r),s=r-n/2,a=[s,s,s],o=6*e,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,a[0]+=n,a[1]+=c;break;case 1:c=n*(2-o),a[0]+=c,a[1]+=n;break;case 2:c=n*(o-2),a[1]+=n,a[2]+=c;break;case 3:c=n*(4-o),a[1]+=c,a[2]+=n;break;case 4:c=n*(o-4),a[2]+=n,a[0]+=c;break;case 5:c=n*(6-o),a[2]+=c,a[0]+=n;break}for(var h=0;h!=3;++h)a[h]=Math.round(a[h]*255);return a}function lh(i,e){if(e===0)return i;var t=UF(VF(i));return e<0?t[2]=t[2]*(1+e):t[2]=1-(1-t[2])*(1-e),gl(WF(t))}var q_=6,zF=15,GF=1,mr=q_;function vl(i){return Math.floor((i+Math.round(128/mr)/256)*mr)}function _l(i){return Math.floor((i-5)/mr*100+.5)/100}function ch(i){return Math.round((i*mr+5)/mr*256)/256}function Wu(i){return ch(_l(vl(i)))}function Vf(i){var e=Math.abs(i-Wu(i)),t=mr;if(e>.005)for(mr=GF;mr<zF;++mr)Math.abs(i-Wu(i))<=e&&(e=Math.abs(i-Wu(i)),t=mr);mr=t}function Us(i){i.width?(i.wpx=vl(i.width),i.wch=_l(i.wpx),i.MDW=mr):i.wpx?(i.wch=_l(i.wpx),i.width=ch(i.wch),i.MDW=mr):typeof i.wch=="number"&&(i.width=ch(i.wch),i.wpx=vl(i.width),i.MDW=mr),i.customWidth&&delete i.customWidth}var $F=96,K_=$F;function El(i){return i*96/K_}function ho(i){return i*K_/96}var YF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function XF(i,e,t,r){e.Borders=[];var n={},s=!1;(i[0].match(Cr)||[]).forEach(function(a){var o=gt(a);switch(jn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=li(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=li(o.diagonalDown)),e.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function qF(i,e,t,r){e.Fills=[];var n={},s=!1;(i[0].match(Cr)||[]).forEach(function(a){var o=gt(a);switch(jn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},e.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function KF(i,e,t,r){e.Fonts=[];var n={},s=!1;(i[0].match(Cr)||[]).forEach(function(a){var o=gt(a);switch(jn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Qt(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?li(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?li(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?li(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?li(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?li(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?li(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?li(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=pf[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=li(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=la[n.color.index];n.color.index==81&&(c=la[1]),c||(c=la[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=lh(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function jF(i,e,t){e.NumberFmt=[];for(var r=Oi(ht),n=0;n<r.length;++n)e.NumberFmt[r[n]]=ht[r[n]];var s=i[0].match(Cr);if(s)for(n=0;n<s.length;++n){var a=gt(s[n]);switch(jn(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Bt(Qt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}ds(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function QF(i){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)i[r]!=null&&(e[e.length]=Ve("numFmt",null,{numFmtId:r,formatCode:jt(i[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ve("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Ec=["numFmtId","fillId","fontId","borderId","xfId"],xc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ZF(i,e,t){e.CellXf=[];var r,n=!1;(i[0].match(Cr)||[]).forEach(function(s){var a=gt(s),o=0;switch(jn(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=a,delete r[0],o=0;o<Ec.length;++o)r[Ec[o]]&&(r[Ec[o]]=parseInt(r[Ec[o]],10));for(o=0;o<xc.length;++o)r[xc[o]]&&(r[xc[o]]=li(r[xc[o]]));if(e.NumberFmt&&r.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[o]){r.numFmtId=o;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=li(a.wrapText)),r.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function JF(i){var e=[];return e[e.length]=Ve("cellXfs",null),i.forEach(function(t){e[e.length]=Ve("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ve("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var eP=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,h){var l={};if(!o)return l;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=o.match(e))&&jF(u,l,h),(u=o.match(n))&&KF(u,l,c,h),(u=o.match(r))&&qF(u,l,c,h),(u=o.match(s))&&XF(u,l,c,h),(u=o.match(t))&&ZF(u,l,h),l}}();function j_(i,e){var t=[Mi,Ve("styleSheet",null,{xmlns:Aa[0],"xmlns:vt":ji.vt})],r;return i.SSF&&(r=QF(i.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=JF(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function tP(i,e){var t=i.read_shift(2),r=vr(i);return[t,r]}function iP(i,e,t){t||(t=_e(6+4*e.length)),t.write_shift(2,i),tr(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function rP(i,e,t){var r={};r.sz=i.read_shift(2)/20;var n=BI(i);n.fItalic&&(r.italic=1),n.fCondense&&(r.condense=1),n.fExtend&&(r.extend=1),n.fShadow&&(r.shadow=1),n.fOutline&&(r.outline=1),n.fStrikeout&&(r.strike=1);var s=i.read_shift(2);switch(s===700&&(r.bold=1),i.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=i.read_shift(1);a!=0&&(r.underline=a);var o=i.read_shift(1);o>0&&(r.family=o);var c=i.read_shift(1);switch(c>0&&(r.charset=c),i.l++,r.color=LI(i),i.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=vr(i),r}function nP(i,e){e||(e=_e(25+4*32)),e.write_shift(2,i.sz*20),HI(i,e),e.write_shift(2,i.bold?700:400);var t=0;i.vertAlign=="superscript"?t=1:i.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,i.underline||0),e.write_shift(1,i.family||0),e.write_shift(1,i.charset||0),e.write_shift(1,0),sh(i.color,e);var r=0;return r=2,e.write_shift(1,r),tr(i.name,e),e.length>e.l?e.slice(0,e.l):e}var sP=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zu,aP=Er;function pm(i,e){e||(e=_e(4*3+8*7+16*1)),zu||(zu=Nh(sP));var t=zu[i.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(sh({auto:1},e),sh({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function oP(i,e){var t=i.l+e,r=i.read_shift(2),n=i.read_shift(2);return i.l=t,{ixfe:r,numFmtId:n}}function Q_(i,e,t){t||(t=_e(16)),t.write_shift(2,e||0),t.write_shift(2,i.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Ro(i,e){return e||(e=_e(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var lP=Er;function cP(i,e){return e||(e=_e(51)),e.write_shift(1,0),Ro(null,e),Ro(null,e),Ro(null,e),Ro(null,e),Ro(null,e),e.length>e.l?e.slice(0,e.l):e}function hP(i,e){return e||(e=_e(12+4*10)),e.write_shift(4,i.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),nh(i.name||"",e),e.length>e.l?e.slice(0,e.l):e}function uP(i,e,t){var r=_e(2052);return r.write_shift(4,i),nh(e,r),nh(t,r),r.length>r.l?r.slice(0,r.l):r}function dP(i,e,t){var r={};r.NumberFmt=[];for(var n in ht)r.NumberFmt[n]=ht[n];r.CellXf=[],r.Fonts=[];var s=[],a=!1;return ws(i,function(c,h,l){switch(l){case 44:r.NumberFmt[c[0]]=c[1],ds(c[1],c[0]);break;case 43:r.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=lh(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(l),a=!0;break;case 38:s.pop(),a=!1;break;default:if(h.T>0)s.push(l);else if(h.T<0)s.pop();else if(!a||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function fP(i,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&++t}),t!=0&&(De(i,615,Nn(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&De(i,44,iP(n,e[n]))}),De(i,616))}}function pP(i){var e=1;De(i,611,Nn(e)),De(i,43,nP({sz:12,color:{theme:1},name:"Calibri",family:2})),De(i,612)}function mP(i){var e=2;De(i,603,Nn(e)),De(i,45,pm({patternType:"none"})),De(i,45,pm({patternType:"gray125"})),De(i,604)}function gP(i){var e=1;De(i,613,Nn(e)),De(i,46,cP()),De(i,614)}function vP(i){var e=1;De(i,626,Nn(e)),De(i,47,Q_({numFmtId:0},65535)),De(i,627)}function _P(i,e){De(i,617,Nn(e.length)),e.forEach(function(t){De(i,47,Q_(t,0))}),De(i,618)}function EP(i){var e=1;De(i,619,Nn(e)),De(i,48,hP({xfId:0,name:"Normal"})),De(i,620)}function xP(i){var e=0;De(i,505,Nn(e)),De(i,506)}function wP(i){var e=0;De(i,508,uP(e,"TableStyleMedium9","PivotStyleMedium4")),De(i,509)}function CP(i,e){var t=zr();return De(t,278),fP(t,i.SSF),pP(t),mP(t),gP(t),vP(t),_P(t,e.cellXfs),EP(t),xP(t),wP(t),De(t,279),t.end()}var yP=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function SP(i,e,t){e.themeElements.clrScheme=[];var r={};(i[0].match(Cr)||[]).forEach(function(n){var s=gt(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[yP.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function bP(){}function TP(){}var AP=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kP=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,OP=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function IP(i,e,t){e.themeElements={};var r;[["clrScheme",AP,SP],["fontScheme",kP,bP],["fmtScheme",OP,TP]].forEach(function(n){if(!(r=i.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](r,e,t)})}var RP=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Z_(i,e){(!i||i.length===0)&&(i=Uf());var t,r={};if(!(t=i.match(RP)))throw new Error("themeElements not found in theme");return IP(t[0],r,e),r.raw=i,r}function Uf(i,e){if(e&&e.themeXLSX)return e.themeXLSX;if(i&&typeof i.raw=="string")return i.raw;var t=[Mi];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function DP(i,e,t){var r=i.l+e,n=i.read_shift(4);if(n!==124226){if(!t.cellStyles){i.l=r;return}var s=i.slice(i.l);i.l=r;var a;try{a=Gv(s,{type:"array"})}catch{return}var o=Zr(a,"theme/theme/theme1.xml",!0);if(o)return Z_(o,t)}}function FP(i){return i.read_shift(4)}function PP(i){var e={};switch(e.xclrType=i.read_shift(2),e.nTintShade=i.read_shift(2),e.xclrType){case 0:i.l+=4;break;case 1:e.xclrValue=NP(i,4);break;case 2:e.xclrValue=R_(i);break;case 3:e.xclrValue=FP(i);break;case 4:i.l+=4;break}return i.l+=8,e}function NP(i,e){return Er(i,e)}function MP(i,e){return Er(i,e)}function LP(i){var e=i.read_shift(2),t=i.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=PP(i);break;case 6:r[1]=MP(i,t);break;case 14:case 15:r[1]=i.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+t)}return r}function BP(i,e){var t=i.l+e;i.l+=2;var r=i.read_shift(2);i.l+=2;for(var n=i.read_shift(2),s=[];n-- >0;)s.push(LP(i,t-i.l));return{ixfe:r,ext:s}}function HP(i,e){e.forEach(function(t){switch(t[0]){}})}function VP(i,e){return{flags:i.read_shift(4),version:i.read_shift(4),name:vr(i)}}function UP(i){var e=_e(12+2*i.name.length);return e.write_shift(4,i.flags),e.write_shift(4,i.version),tr(i.name,e),e.slice(0,e.l)}function WP(i){for(var e=[],t=i.read_shift(4);t-- >0;)e.push([i.read_shift(4),i.read_shift(4)]);return e}function zP(i){var e=_e(4+8*i.length);e.write_shift(4,i.length);for(var t=0;t<i.length;++t)e.write_shift(4,i[t][0]),e.write_shift(4,i[t][1]);return e}function GP(i,e){var t=_e(8+2*e.length);return t.write_shift(4,i),tr(e,t),t.slice(0,t.l)}function $P(i){return i.l+=4,i.read_shift(4)!=0}function YP(i,e){var t=_e(8);return t.write_shift(4,i),t.write_shift(4,1),t}function XP(i,e,t){var r={Types:[],Cell:[],Value:[]},n=t||{},s=[],a=!1,o=2;return ws(i,function(c,h,l){switch(l){case 335:r.Types.push({name:c.name});break;case 51:c.forEach(function(u){o==1?r.Cell.push({type:r.Types[u[0]-1].name,index:u[1]}):o==0&&r.Value.push({type:r.Types[u[0]-1].name,index:u[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(l),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!h.T){if(!a||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function qP(){var i=zr();return De(i,332),De(i,334,Nn(1)),De(i,335,UP({name:"XLDAPR",version:12e4,flags:3496657072})),De(i,336),De(i,339,GP(1,"XLDAPR")),De(i,52),De(i,35,Nn(514)),De(i,4096,Nn(0)),De(i,4097,pn(1)),De(i,36),De(i,53),De(i,340),De(i,337,YP(1)),De(i,51,zP([[1,0]])),De(i,338),De(i,333),i.end()}function KP(i,e,t){var r={Types:[],Cell:[],Value:[]};if(!i)return r;var n=!1,s=2,a;return i.replace(Cr,function(o){var c=gt(o);switch(jn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==c.name&&(a=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[c.t-1].name,index:+c.v}):s==0&&r.Value.push({type:r.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),r}function J_(){var i=[Mi];return i.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),i.join("")}function jP(i){var e=[];if(!i)return e;var t=1;return(i.match(Cr)||[]).forEach(function(r){var n=gt(r);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,e.push(n);break}}),e}function QP(i){var e={};e.i=i.read_shift(4);var t={};t.r=i.read_shift(4),t.c=i.read_shift(4),e.r=ut(t);var r=i.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function ZP(i,e,t){var r=[];return ws(i,function(s,a,o){switch(o){case 63:r.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function JP(i,e,t,r){if(!i)return i;var n=r||{},s=!1;ws(i,function(o,c,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function eN(i,e){if(!i)return"??";var t=(i.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][t].Target}var Ya=1024;function e1(i,e){for(var t=[21600,21600],r=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),n=[Ve("xml",null,{"xmlns:v":Kr.v,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:mv":Kr.mv}).replace(/\/>/,">"),Ve("o:shapelayout",Ve("o:idmap",null,{"v:ext":"edit",data:i}),{"v:ext":"edit"}),Ve("v:shapetype",[Ve("v:stroke",null,{joinstyle:"miter"}),Ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:r})];Ya<i*1e3;)Ya+=1e3;return e.forEach(function(s){var a=Ci(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ve("v:fill",c,o),l={on:"t",obscured:"t"};++Ya,n=n.concat(["<v:shape"+fl({id:"_x0000_s"+Ya,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ve("v:shadow",null,l),Ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ar("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),ar("x:AutoFill","False"),ar("x:Row",String(a.r)),ar("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function mm(i,e,t,r){var n=Array.isArray(i),s;e.forEach(function(a){var o=Ci(a.ref);if(n?(i[o.r]||(i[o.r]=[]),s=i[o.r][o.c]):s=i[a.ref],!s){s={t:"z"},n?i[o.r][o.c]=s:i[a.ref]=s;var c=Ht(i["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var h=Tt(c);h!==i["!ref"]&&(i["!ref"]=h)}s.c||(s.c=[]);var l={a:a.author,t:a.t,r:a.r,T:t};a.h&&(l.h=a.h);for(var u=s.c.length-1;u>=0;--u){if(!t&&s.c[u].T)return;t&&!s.c[u].T&&s.c.splice(u,1)}if(t&&r){for(u=0;u<r.length;++u)if(l.a==r[u].id){l.a=r[u].name||l.a;break}}s.c.push(l)})}function tN(i,e){if(i.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],n=i.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=i.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=gt(o[0]),h={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},l=Ci(c.ref);if(!(e.sheetRows&&e.sheetRows<=l.r)){var u=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&Bf(u[1])||{r:"",t:"",h:""};h.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),h.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=d.h),r.push(h)}}}}),r}function t1(i){var e=[Mi,Ve("comments",null,{xmlns:Aa[0]})],t=[];return e.push("<authors>"),i.forEach(function(r){r[1].forEach(function(n){var s=jt(n.a);t.indexOf(s)==-1&&(t.push(s),e.push("<author>"+s+"</author>")),n.T&&n.ID&&t.indexOf("tc="+n.ID)==-1&&(t.push("tc="+n.ID),e.push("<author>tc="+n.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),i.forEach(function(r){var n=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?n=t.indexOf("tc="+r[1][0].ID):r[1].forEach(function(c){c.a&&(n=t.indexOf(jt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+n+'"><text>'),s.length<=1)e.push(ar("t",jt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(ar("t",jt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function iN(i,e){var t=[],r=!1,n={},s=0;return i.replace(Cr,function(o,c){var h=gt(o);switch(jn(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":n.t=i.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return o}),t}function rN(i,e,t){var r=[Mi,Ve("ThreadedComments",null,{xmlns:ji.TCMNT}).replace(/[\/]>/,">")];return i.forEach(function(n){var s="";(n[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),r.push(Ve("threadedComment",ar("text",a.t||""),c))})}),r.push("</ThreadedComments>"),r.join("")}function nN(i,e){var t=[],r=!1;return i.replace(Cr,function(s){var a=gt(s);switch(jn(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),t}function sN(i){var e=[Mi,Ve("personList",null,{xmlns:ji.TCMNT,"xmlns:x":Aa[0]}).replace(/[\/]>/,">")];return i.forEach(function(t,r){e.push(Ve("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function aN(i){var e={};e.iauthor=i.read_shift(4);var t=Ra(i);return e.rfx=t.s,e.ref=ut(t.s),i.l+=16,e}function oN(i,e){return e==null&&(e=_e(36)),e.write_shift(4,i[1].iauthor),Co(i[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var lN=vr;function cN(i){return tr(i.slice(0,54))}function hN(i,e){var t=[],r=[],n={},s=!1;return ws(i,function(o,c,h){switch(h){case 632:r.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=r[n.iauthor],delete n.iauthor,e.sheetRows&&n.rfx&&e.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}function uN(i){var e=zr(),t=[];return De(e,628),De(e,630),i.forEach(function(r){r[1].forEach(function(n){t.indexOf(n.a)>-1||(t.push(n.a.slice(0,54)),De(e,632,cN(n.a)))})}),De(e,631),De(e,633),i.forEach(function(r){r[1].forEach(function(n){n.iauthor=t.indexOf(n.a);var s={s:Ci(r[0]),e:Ci(r[0])};De(e,635,oN([s,n])),n.t&&n.t.length>0&&De(e,637,FI(n)),De(e,636),delete n.iauthor})}),De(e,634),De(e,629),e.end()}var dN="application/vnd.ms-office.vbaProject";function fN(i){var e=st.utils.cfb_new({root:"R"});return i.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(e,n,i.FileIndex[r].content)}}),st.write(e)}function pN(i,e){e.FullPaths.forEach(function(t,r){if(r!=0){var n=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&st.utils.cfb_add(i,n,e.FileIndex[r].content)}})}var i1=["xlsb","xlsm","xlam","biff8","xla"];function mN(){return{"!type":"dialog"}}function gN(){return{"!type":"dialog"}}function vN(){return{"!type":"macro"}}function _N(){return{"!type":"macro"}}var io=function(){var i=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,n,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,l=a.length>0?parseInt(a,10)|0:0;return o?l+=e.c:--l,c?h+=e.r:--h,n+(o?"":"$")+wi(l)+(c?"":"$")+Ni(h)}return function(n,s){return e=s,n.replace(i,t)}}(),Wf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zf=function(){return function(e,t){return e.replace(Wf,function(r,n,s,a,o,c){var h=Of(a)-(s?0:t.c),l=kf(c)-(o?0:t.r),u=l==0?"":o?l+1:"["+l+"]",d=h==0?"":s?h+1:"["+h+"]";return n+"R"+u+"C"+d})}}();function r1(i,e){return i.replace(Wf,function(t,r,n,s,a,o){return r+(n=="$"?n+s:wi(Of(s)+e.c))+(a=="$"?a+o:Ni(kf(o)+e.r))})}function EN(i,e,t){var r=Gr(e),n=r.s,s=Ci(t),a={r:s.r-n.r,c:s.c-n.c};return r1(i,a)}function xN(i){return i.length!=1}function gm(i){return i.replace(/_xlfn\./g,"")}function Wi(i){i.l+=1}function Ws(i,e){var t=i.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function n1(i,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return s1(i);t.biff==12&&(r=4)}var n=i.read_shift(r),s=i.read_shift(r),a=Ws(i),o=Ws(i);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function s1(i){var e=Ws(i),t=Ws(i),r=i.read_shift(1),n=i.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function wN(i,e,t){if(t.biff<8)return s1(i);var r=i.read_shift(t.biff==12?4:2),n=i.read_shift(t.biff==12?4:2),s=Ws(i),a=Ws(i);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:a[0],cRel:a[1],rRel:a[2]}}}function a1(i,e,t){if(t&&t.biff>=2&&t.biff<=5)return CN(i);var r=i.read_shift(t&&t.biff==12?4:2),n=Ws(i);return{r,c:n[0],cRel:n[1],rRel:n[2]}}function CN(i){var e=Ws(i),t=i.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function yN(i){var e=i.read_shift(2),t=i.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function SN(i,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return bN(i);var n=i.read_shift(r>=12?4:2),s=i.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:a,rRel:o}}function bN(i){var e=i.read_shift(2),t=i.read_shift(1),r=(e&32768)>>15,n=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),n==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:n,rRel:r}}function TN(i,e,t){var r=(i[i.l++]&96)>>5,n=n1(i,t.biff>=2&&t.biff<=5?6:8,t);return[r,n]}function AN(i,e,t){var r=(i[i.l++]&96)>>5,n=i.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:i.l+=12,s=6;break;case 12:s=12;break}var a=n1(i,s,t);return[r,n,a]}function kN(i,e,t){var r=(i[i.l++]&96)>>5;return i.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function ON(i,e,t){var r=(i[i.l++]&96)>>5,n=i.read_shift(2),s=8;if(t)switch(t.biff){case 5:i.l+=12,s=6;break;case 12:s=12;break}return i.l+=s,[r,n]}function IN(i,e,t){var r=(i[i.l++]&96)>>5,n=wN(i,e-1,t);return[r,n]}function RN(i,e,t){var r=(i[i.l++]&96)>>5;return i.l+=t.biff==2?6:t.biff==12?14:7,[r]}function vm(i){var e=i[i.l+1]&1,t=1;return i.l+=4,[e,t]}function DN(i,e,t){i.l+=2;for(var r=i.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=r;++s)n.push(i.read_shift(t&&t.biff==2?1:2));return n}function FN(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=2,[r,i.read_shift(t&&t.biff==2?1:2)]}function PN(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=2,[r,i.read_shift(t&&t.biff==2?1:2)]}function NN(i){var e=i[i.l+1]&255?1:0;return i.l+=2,[e,i.read_shift(2)]}function MN(i,e,t){var r=i[i.l+1]&255?1:0;return i.l+=t&&t.biff==2?3:4,[r]}function o1(i){var e=i.read_shift(1),t=i.read_shift(1);return[e,t]}function LN(i){return i.read_shift(2),o1(i)}function BN(i){return i.read_shift(2),o1(i)}function HN(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var n=a1(i,0,t);return[r,n]}function VN(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var n=SN(i,0,t);return[r,n]}function UN(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var n=i.read_shift(2);t&&t.biff==5&&(i.l+=12);var s=a1(i,0,t);return[r,n,s]}function WN(i,e,t){var r=(i[i.l]&96)>>5;i.l+=1;var n=i.read_shift(t&&t.biff<=3?1:2);return[$M[n],h1[n],r]}function zN(i,e,t){var r=i[i.l++],n=i.read_shift(1),s=t&&t.biff<=3?[r==88?-1:0,i.read_shift(1)]:GN(i);return[n,(s[0]===0?h1:GM)[s[1]]]}function GN(i){return[i[i.l+1]>>7,i.read_shift(2)&32767]}function $N(i,e,t){i.l+=t&&t.biff==2?3:4}function YN(i,e,t){if(i.l++,t&&t.biff==12)return[i.read_shift(4,"i"),0];var r=i.read_shift(2),n=i.read_shift(t&&t.biff==2?1:2);return[r,n]}function XN(i){return i.l++,Cs[i.read_shift(1)]}function qN(i){return i.l++,i.read_shift(2)}function KN(i){return i.l++,i.read_shift(1)!==0}function jN(i){return i.l++,gr(i)}function QN(i,e,t){return i.l++,Nl(i,e-1,t)}function ZN(i,e){var t=[i.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=Fi(i,1)?"TRUE":"FALSE",e!=12&&(i.l+=7);break;case 37:case 16:t[1]=Cs[i[i.l]],i.l+=e==12?4:8;break;case 0:i.l+=8;break;case 1:t[1]=gr(i);break;case 2:t[1]=Da(i,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function JN(i,e,t){for(var r=i.read_shift(t.biff==12?4:2),n=[],s=0;s!=r;++s)n.push((t.biff==12?Ra:Bh)(i));return n}function eM(i,e,t){var r=0,n=0;t.biff==12?(r=i.read_shift(4),n=i.read_shift(4)):(n=1+i.read_shift(1),r=1+i.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--n==0&&(n=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=n;++o)a[s][o]=ZN(i,t.biff);return a}function tM(i,e,t){var r=i.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=i.read_shift(n);switch(t.biff){case 2:i.l+=5;break;case 3:case 4:i.l+=8;break;case 5:i.l+=12;break}return[r,0,s]}function iM(i,e,t){if(t.biff==5)return rM(i);var r=i.read_shift(1)>>>5&3,n=i.read_shift(2),s=i.read_shift(4);return[r,n,s]}function rM(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2,"i");i.l+=8;var r=i.read_shift(2);return i.l+=12,[e,t,r]}function nM(i,e,t){var r=i.read_shift(1)>>>5&3;i.l+=t&&t.biff==2?3:4;var n=i.read_shift(t&&t.biff==2?1:2);return[r,n]}function sM(i,e,t){var r=i.read_shift(1)>>>5&3,n=i.read_shift(t&&t.biff==2?1:2);return[r,n]}function aM(i,e,t){var r=i.read_shift(1)>>>5&3;return i.l+=4,t.biff<8&&i.l--,t.biff==12&&(i.l+=2),[r]}function oM(i,e,t){var r=(i[i.l++]&96)>>5,n=i.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return i.l+=s,[r,n]}var lM=Er,cM=Er,hM=Er;function Ll(i,e,t){return i.l+=2,[yN(i)]}function Gf(i){return i.l+=6,[]}var uM=Ll,dM=Gf,fM=Gf,pM=Ll;function l1(i){return i.l+=2,[$i(i),i.read_shift(2)&1]}var mM=Ll,gM=l1,vM=Gf,_M=Ll,EM=Ll,xM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function wM(i){i.l+=2;var e=i.read_shift(2),t=i.read_shift(2),r=i.read_shift(4),n=i.read_shift(2),s=i.read_shift(2),a=xM[t>>2&31];return{ixti:e,coltype:t&3,rt:a,idx:r,c:n,C:s}}function CM(i){return i.l+=2,[i.read_shift(4)]}function yM(i,e,t){return i.l+=5,i.l+=2,i.l+=t.biff==2?1:4,["PTGSHEET"]}function SM(i,e,t){return i.l+=t.biff==2?4:5,["PTGENDSHEET"]}function bM(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2);return[e,t]}function TM(i){var e=i.read_shift(1)>>>5&3,t=i.read_shift(2);return[e,t]}function AM(i){return i.l+=4,[0,0]}var _m={1:{n:"PtgExp",f:YN},2:{n:"PtgTbl",f:hM},3:{n:"PtgAdd",f:Wi},4:{n:"PtgSub",f:Wi},5:{n:"PtgMul",f:Wi},6:{n:"PtgDiv",f:Wi},7:{n:"PtgPower",f:Wi},8:{n:"PtgConcat",f:Wi},9:{n:"PtgLt",f:Wi},10:{n:"PtgLe",f:Wi},11:{n:"PtgEq",f:Wi},12:{n:"PtgGe",f:Wi},13:{n:"PtgGt",f:Wi},14:{n:"PtgNe",f:Wi},15:{n:"PtgIsect",f:Wi},16:{n:"PtgUnion",f:Wi},17:{n:"PtgRange",f:Wi},18:{n:"PtgUplus",f:Wi},19:{n:"PtgUminus",f:Wi},20:{n:"PtgPercent",f:Wi},21:{n:"PtgParen",f:Wi},22:{n:"PtgMissArg",f:Wi},23:{n:"PtgStr",f:QN},26:{n:"PtgSheet",f:yM},27:{n:"PtgEndSheet",f:SM},28:{n:"PtgErr",f:XN},29:{n:"PtgBool",f:KN},30:{n:"PtgInt",f:qN},31:{n:"PtgNum",f:jN},32:{n:"PtgArray",f:RN},33:{n:"PtgFunc",f:WN},34:{n:"PtgFuncVar",f:zN},35:{n:"PtgName",f:tM},36:{n:"PtgRef",f:HN},37:{n:"PtgArea",f:TN},38:{n:"PtgMemArea",f:nM},39:{n:"PtgMemErr",f:lM},40:{n:"PtgMemNoMem",f:cM},41:{n:"PtgMemFunc",f:sM},42:{n:"PtgRefErr",f:aM},43:{n:"PtgAreaErr",f:kN},44:{n:"PtgRefN",f:VN},45:{n:"PtgAreaN",f:IN},46:{n:"PtgMemAreaN",f:bM},47:{n:"PtgMemNoMemN",f:TM},57:{n:"PtgNameX",f:iM},58:{n:"PtgRef3d",f:UN},59:{n:"PtgArea3d",f:AN},60:{n:"PtgRefErr3d",f:oM},61:{n:"PtgAreaErr3d",f:ON},255:{}},kM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},OM={1:{n:"PtgElfLel",f:l1},2:{n:"PtgElfRw",f:_M},3:{n:"PtgElfCol",f:uM},6:{n:"PtgElfRwV",f:EM},7:{n:"PtgElfColV",f:pM},10:{n:"PtgElfRadical",f:mM},11:{n:"PtgElfRadicalS",f:vM},13:{n:"PtgElfColS",f:dM},15:{n:"PtgElfColSV",f:fM},16:{n:"PtgElfRadicalLel",f:gM},25:{n:"PtgList",f:wM},29:{n:"PtgSxName",f:CM},255:{}},IM={0:{n:"PtgAttrNoop",f:AM},1:{n:"PtgAttrSemi",f:MN},2:{n:"PtgAttrIf",f:PN},4:{n:"PtgAttrChoose",f:DN},8:{n:"PtgAttrGoto",f:FN},16:{n:"PtgAttrSum",f:$N},32:{n:"PtgAttrBaxcel",f:vm},33:{n:"PtgAttrBaxcel",f:vm},64:{n:"PtgAttrSpace",f:LN},65:{n:"PtgAttrSpaceSemi",f:BN},128:{n:"PtgAttrIfError",f:NN},255:{}};function Bl(i,e,t,r){if(r.biff<8)return Er(i,e);for(var n=i.l+e,s=[],a=0;a!==t.length;++a)switch(t[a][0]){case"PtgArray":t[a][1]=eM(i,0,r),s.push(t[a][1]);break;case"PtgMemArea":t[a][2]=JN(i,t[a][1],r),s.push(t[a][2]);break;case"PtgExp":r&&r.biff==12&&(t[a][1][1]=i.read_shift(4),s.push(t[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[a][0]}return e=n-i.l,e!==0&&s.push(Er(i,e)),s}function Hl(i,e,t){for(var r=i.l+e,n,s,a=[];r!=i.l;)e=r-i.l,s=i[i.l],n=_m[s]||_m[kM[s]],(s===24||s===25)&&(n=(s===24?OM:IM)[i[i.l+1]]),!n||!n.f?Er(i,e):a.push([n.n,n.f(i,e,t)]);return a}function RM(i){for(var e=[],t=0;t<i.length;++t){for(var r=i[t],n=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:n.push('"'+a[1].replace(/"/g,'""')+'"');break;default:n.push(a[1])}else n.push("")}e.push(n.join(","))}return e.join(";")}var DM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FM(i,e){if(!i&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(i)?"'"+i+"'":i}function c1(i,e,t){if(!i)return"SH33TJSERR0";if(t.biff>8&&(!i.XTI||!i.XTI[e]))return i.SheetNames[e];if(!i.XTI)return"SH33TJSERR6";var r=i.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":i.XTI[e-1];if(!r)return"SH33TJSERR1";var n="";if(t.biff>8)switch(i[r[0]][0]){case 357:return n=r[1]==-1?"#REF":i.SheetNames[r[1]],r[1]==r[2]?n:n+":"+i.SheetNames[r[2]];case 358:return t.SID!=null?i.SheetNames[t.SID]:"SH33TJSSAME"+i[r[0]][0];case 355:default:return"SH33TJSSRC"+i[r[0]][0]}switch(i[r[0]][0][0]){case 1025:return n=r[1]==-1?"#REF":i.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?n:n+":"+i.SheetNames[r[2]];case 14849:return i[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return i[r[0]][0][3]?(n=r[1]==-1?"#REF":i[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?n:n+":"+i[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Em(i,e,t){var r=c1(i,e,t);return r=="#REF"?r:FM(r,t)}function pr(i,e,t,r,n){var s=n&&n.biff||8,a={s:{c:0,r:0}},o=[],c,h,l,u=0,d=0,f,p="";if(!i[0]||!i[0][0])return"";for(var m=-1,v="",_=0,x=i[0].length;_<x;++_){var E=i[0][_];switch(E[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),h=o.pop(),m>=0){switch(i[0][m][1][0]){case 0:v=bi(" ",i[0][m][1][1]);break;case 1:v=bi("\r",i[0][m][1][1]);break;default:if(v="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][m][1][0])}h=h+v,m=-1}o.push(h+DM[E[0]]+c);break;case"PtgIsect":c=o.pop(),h=o.pop(),o.push(h+" "+c);break;case"PtgUnion":c=o.pop(),h=o.pop(),o.push(h+","+c);break;case"PtgRange":c=o.pop(),h=o.pop(),o.push(h+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":l=Yo(E[1][1],a,n),o.push(Xo(l,s));break;case"PtgRefN":l=t?Yo(E[1][1],t,n):E[1][1],o.push(Xo(l,s));break;case"PtgRef3d":u=E[1][1],l=Yo(E[1][2],a,n),p=Em(r,u,n),o.push(p+"!"+Xo(l,s));break;case"PtgFunc":case"PtgFuncVar":var C=E[1][0],y=E[1][1];C||(C=0),C&=127;var b=C==0?[]:o.slice(-C);o.length-=C,y==="User"&&(y=b.shift()),o.push(y+"("+b.join(",")+")");break;case"PtgBool":o.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(E[1]);break;case"PtgNum":o.push(String(E[1]));break;case"PtgStr":o.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(E[1]);break;case"PtgAreaN":f=qp(E[1][1],t?{s:t}:a,n),o.push(Hu(f,n));break;case"PtgArea":f=qp(E[1][1],a,n),o.push(Hu(f,n));break;case"PtgArea3d":u=E[1][1],f=E[1][2],p=Em(r,u,n),o.push(p+"!"+Hu(f,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=E[1][2];var T=(r.names||[])[d-1]||(r[0]||[])[d],R=T?T.Name:"SH33TJSNAME"+String(d);R&&R.slice(0,6)=="_xlfn."&&!n.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var O=E[1][1];d=E[1][2];var W;if(n.biff<=5)O<0&&(O=-O),r[O]&&(W=r[O][d]);else{var G="";if(((r[O]||[])[0]||[])[0]==14849||(((r[O]||[])[0]||[])[0]==1025?r[O][d]&&r[O][d].itab>0&&(G=r.SheetNames[r[O][d].itab-1]+"!"):G=r.SheetNames[d-1]+"!"),r[O]&&r[O][d])G+=r[O][d].Name;else if(r[0]&&r[0][d])G+=r[0][d].Name;else{var Q=(c1(r,O,n)||"").split(";;");Q[d-1]?G=Q[d-1]:G+="SH33TJSERRX"}o.push(G);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var ne="(",xe=")";if(m>=0){switch(v="",i[0][m][1][0]){case 2:ne=bi(" ",i[0][m][1][1])+ne;break;case 3:ne=bi("\r",i[0][m][1][1])+ne;break;case 4:xe=bi(" ",i[0][m][1][1])+xe;break;case 5:xe=bi("\r",i[0][m][1][1])+xe;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][m][1][0])}m=-1}o.push(ne+o.pop()+xe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":l={c:E[1][1],r:E[1][0]};var Ce={c:t.c,r:t.r};if(r.sharedf[ut(l)]){var Fe=r.sharedf[ut(l)];o.push(pr(Fe,a,Ce,r,n))}else{var ke=!1;for(c=0;c!=r.arrayf.length;++c)if(h=r.arrayf[c],!(l.c<h[0].s.c||l.c>h[0].e.c)&&!(l.r<h[0].s.r||l.r>h[0].e.r)){o.push(pr(h[1],a,Ce,r,n)),ke=!0;break}ke||o.push(E[1])}break;case"PtgArray":o.push("{"+RM(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var Ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&m>=0&&Ze.indexOf(i[0][_][0])==-1){E=i[0][m];var ie=!0;switch(E[1][0]){case 4:ie=!1;case 0:v=bi(" ",E[1][1]);break;case 5:ie=!1;case 1:v=bi("\r",E[1][1]);break;default:if(v="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}o.push((ie?v:"")+o.pop()+(ie?"":v)),m=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function PM(i,e,t){var r=i.l+e,n=t.biff==2?1:2,s,a=i.read_shift(n);if(a==65535)return[[],Er(i,e-2)];var o=Hl(i,a,t);return e!==a+n&&(s=Bl(i,e-a-n,o,t)),i.l=r,[o,s]}function NM(i,e,t){var r=i.l+e,n=t.biff==2?1:2,s,a=i.read_shift(n);if(a==65535)return[[],Er(i,e-2)];var o=Hl(i,a,t);return e!==a+n&&(s=Bl(i,e-a-n,o,t)),i.l=r,[o,s]}function MM(i,e,t,r){var n=i.l+e,s=Hl(i,r,t),a;return n!==i.l&&(a=Bl(i,n-i.l,s,t)),[s,a]}function LM(i,e,t){var r=i.l+e,n,s=i.read_shift(2),a=Hl(i,s,t);return s==65535?[[],Er(i,e-2)]:(e!==s+2&&(n=Bl(i,r-s-2,a,t)),[a,n])}function BM(i){var e;if(rs(i,i.l+6)!==65535)return[gr(i),"n"];switch(i[i.l]){case 0:return i.l+=8,["String","s"];case 1:return e=i[i.l+2]===1,i.l+=8,[e,"b"];case 2:return e=i[i.l+2],i.l+=8,[e,"e"];case 3:return i.l+=8,["","s"]}return[]}function HM(i){if(i==null){var e=_e(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof i=="number")return wa(i);return wa(0)}function Gu(i,e,t){var r=i.l+e,n=Qn(i);t.biff==2&&++i.l;var s=BM(i),a=i.read_shift(1);t.biff!=2&&(i.read_shift(1),t.biff>=5&&i.read_shift(4));var o=NM(i,r-i.l,t);return{cell:n,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function VM(i,e,t,r,n){var s=ya(e,t,n),a=HM(i.v),o=_e(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var h=_e(i.bf.length),l=0;l<i.bf.length;++l)h[l]=i.bf[l];var u=er([s,a,o,h]);return u}function Hh(i,e,t){var r=i.read_shift(4),n=Hl(i,r,t),s=i.read_shift(4),a=s>0?Bl(i,s,n,t):null;return[n,a]}var UM=Hh,Vh=Hh,WM=Hh,zM=Hh,GM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},h1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$M={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xm(i){return i.slice(0,3)=="of:"&&(i=i.slice(3)),i.charCodeAt(0)==61&&(i=i.slice(1),i.charCodeAt(0)==61&&(i=i.slice(1))),i=i.replace(/COM\.MICROSOFT\./g,""),i=i.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")}),i=i.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),i.replace(/[;~]/g,",").replace(/\|/g,";")}function YM(i){var e="of:="+i.replace(Wf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function $u(i){var e=i.split(":"),t=e[0].split(".")[0];return[t,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function XM(i){return i.replace(/\./,"!")}var Ko={},ro={},jo=typeof Map<"u";function $f(i,e,t){var r=0,n=i.length;if(t){if(jo?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var s=jo?t.get(e):t[e];r<s.length;++r)if(i[s[r]].t===e)return i.Count++,s[r]}}else for(;r<n;++r)if(i[r].t===e)return i.Count++,r;return i[n]={t:e},i.Count++,i.Unique++,t&&(jo?(t.has(e)||t.set(e,[]),t.get(e).push(n)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(n))),n}function Uh(i,e){var t={min:i+1,max:i+1},r=-1;return e.MDW&&(mr=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=_l(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=ch(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function ua(i,e){if(i){var t=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(t=[1,1,1,1,.5,.5]),i.left==null&&(i.left=t[0]),i.right==null&&(i.right=t[1]),i.top==null&&(i.top=t[2]),i.bottom==null&&(i.bottom=t[3]),i.header==null&&(i.header=t[4]),i.footer==null&&(i.footer=t[5])}}function Xs(i,e,t){var r=t.revssf[e.z!=null?e.z:"General"],n=60,s=i.length;if(r==null&&t.ssf){for(;n<392;++n)if(t.ssf[n]==null){ds(e.z,n),t.ssf[n]=e.z,t.revssf[e.z]=r=n;break}}for(n=0;n!=s;++n)if(i[n].numFmtId===r)return n;return i[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function u1(i,e,t,r,n,s){try{r.cellNF&&(i.z=ht[e])}catch(o){if(r.WTF)throw o}if(!(i.t==="z"&&!r.cellStyles)){if(i.t==="d"&&typeof i.v=="string"&&(i.v=ci(i.v)),(!r||r.cellText!==!1)&&i.t!=="z")try{if(ht[e]==null&&ds(GO[e]||"General",e),i.t==="e")i.w=i.w||Cs[i.v];else if(e===0)if(i.t==="n")(i.v|0)===i.v?i.w=i.v.toString(10):i.w=ul(i.v);else if(i.t==="d"){var a=Qi(i.v);(a|0)===a?i.w=a.toString(10):i.w=ul(a)}else{if(i.v===void 0)return"";i.w=Ea(i.v,ro)}else i.t==="d"?i.w=_n(e,Qi(i.v),ro):i.w=_n(e,i.v,ro)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&t!=null)try{i.s=s.Fills[t],i.s.fgColor&&i.s.fgColor.theme&&!i.s.fgColor.rgb&&(i.s.fgColor.rgb=lh(n.themeElements.clrScheme[i.s.fgColor.theme].rgb,i.s.fgColor.tint||0),r.WTF&&(i.s.fgColor.raw_rgb=n.themeElements.clrScheme[i.s.fgColor.theme].rgb)),i.s.bgColor&&i.s.bgColor.theme&&(i.s.bgColor.rgb=lh(n.themeElements.clrScheme[i.s.bgColor.theme].rgb,i.s.bgColor.tint||0),r.WTF&&(i.s.bgColor.raw_rgb=n.themeElements.clrScheme[i.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&s.Fills)throw o}}}function qM(i,e,t){if(i&&i["!ref"]){var r=Ht(i["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+i["!ref"])}}function KM(i,e){var t=Ht(e);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(i["!ref"]=Tt(t))}var jM=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,QM=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ZM=/<(?:\w:)?hyperlink [^>]*>/mg,JM=/"(\w*:\w*)"/,eL=/<(?:\w:)?col\b[^>]*[\/]?>/g,tL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,iL=/<(?:\w:)?pageMargins[^>]*\/>/g,d1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,nL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function sL(i,e,t,r,n,s,a){if(!i)return i;r||(r={"!id":{}});var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",l="",u=i.match(QM);u?(h=i.slice(0,u.index),l=i.slice(u.index+u[0].length)):h=l=i;var d=h.match(d1);d?Yf(d[0],o,n,t):(d=h.match(rL))&&oL(d[0],d[1]||"",o,n,t);var f=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=h.slice(f,f+50).match(JM);p&&KM(o,p[1])}var m=h.match(nL);m&&m[1]&&xL(m[1],n);var v=[];if(e.cellStyles){var _=h.match(eL);_&&mL(v,_)}u&&yL(u[1],o,e,c,s,a);var x=l.match(tL);x&&(o["!autofilter"]=vL(x[0]));var E=[],C=l.match(jM);if(C)for(f=0;f!=C.length;++f)E[f]=Ht(C[f].slice(C[f].indexOf('"')+1));var y=l.match(ZM);y&&dL(o,y,r);var b=l.match(iL);if(b&&(o["!margins"]=fL(gt(b[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Tt(c)),e.sheetRows>0&&o["!ref"]){var T=Ht(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>c.e.r&&(T.e.r=c.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>c.e.c&&(T.e.c=c.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Tt(T))}return v.length>0&&(o["!cols"]=v),E.length>0&&(o["!merges"]=E),o}function aL(i){if(i.length===0)return"";for(var e='<mergeCells count="'+i.length+'">',t=0;t!=i.length;++t)e+='<mergeCell ref="'+Tt(i[t])+'"/>';return e+"</mergeCells>"}function Yf(i,e,t,r){var n=gt(i);t.Sheets[r]||(t.Sheets[r]={}),n.codeName&&(t.Sheets[r].CodeName=Bt(Qt(n.codeName)))}function oL(i,e,t,r,n){Yf(i.slice(0,i.indexOf(">")),t,r,n)}function lL(i,e,t,r,n){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[t];try{e.Workbook&&(c=e.Workbook.Sheets[t].CodeName||c)}catch{}s=!0,a.codeName=Gn(jt(c))}if(i&&i["!outline"]){var h={summaryBelow:1,summaryRight:1};i["!outline"].above&&(h.summaryBelow=0),i["!outline"].left&&(h.summaryRight=0),o=(o||"")+Ve("outlinePr",null,h)}!s&&!o||(n[n.length]=Ve("sheetPr",o,a))}var cL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function uL(i){var e={sheet:1};return cL.forEach(function(t){i[t]!=null&&i[t]&&(e[t]="1")}),hL.forEach(function(t){i[t]!=null&&!i[t]&&(e[t]="0")}),i.password&&(e.password=Hf(i.password).toString(16).toUpperCase()),Ve("sheetProtection",null,e)}function dL(i,e,t){for(var r=Array.isArray(i),n=0;n!=e.length;++n){var s=gt(Qt(e[n]),!0);if(!s.ref)return;var a=((t||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Bt(s.location))):(s.Target="#"+Bt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ht(s.ref),c=o.s.r;c<=o.e.r;++c)for(var h=o.s.c;h<=o.e.c;++h){var l=ut({c:h,r:c});r?(i[c]||(i[c]=[]),i[c][h]||(i[c][h]={t:"z",v:void 0}),i[c][h].l=s):(i[l]||(i[l]={t:"z",v:void 0}),i[l].l=s)}}}function fL(i){var e={};return["left","right","top","bottom","header","footer"].forEach(function(t){i[t]&&(e[t]=parseFloat(i[t]))}),e}function pL(i){return ua(i),Ve("pageMargins",null,i)}function mL(i,e){for(var t=!1,r=0;r!=e.length;++r){var n=gt(e[r],!0);n.hidden&&(n.hidden=li(n.hidden));var s=parseInt(n.min,10)-1,a=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,Vf(n.width)),Us(n);s<=a;)i[s++]=hi(n)}}function gL(i,e){for(var t=["<cols>"],r,n=0;n!=e.length;++n)(r=e[n])&&(t[t.length]=Ve("col",null,Uh(n,r)));return t[t.length]="</cols>",t.join("")}function vL(i){var e={ref:(i.match(/ref="([^"]*)"/)||[])[1]};return e}function _L(i,e,t,r){var n=typeof i.ref=="string"?i.ref:Tt(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,a=Gr(n);a.s.r==a.e.r&&(a.e.r=Gr(e["!ref"]).e.r,n=Tt(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+t.SheetNames[r]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+n}),Ve("autoFilter",null,{ref:n})}var EL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xL(i,e){e.Views||(e.Views=[{}]),(i.match(EL)||[]).forEach(function(t,r){var n=gt(t);e.Views[r]||(e.Views[r]={}),+n.zoomScale&&(e.Views[r].zoom=+n.zoomScale),li(n.rightToLeft)&&(e.Views[r].RTL=!0)})}function wL(i,e,t,r){var n={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ve("sheetViews",Ve("sheetView",null,n),{})}function CL(i,e,t,r){if(i.c&&t["!comments"].push([e,i.c]),i.v===void 0&&typeof i.f!="string"||i.t==="z"&&!i.f)return"";var n="",s=i.t,a=i.v;if(i.t!=="z")switch(i.t){case"b":n=i.v?"1":"0";break;case"n":n=""+i.v;break;case"e":n=Cs[i.v];break;case"d":r&&r.cellDates?n=ci(i.v,-1).toISOString():(i=hi(i),i.t="n",n=""+(i.v=Qi(ci(i.v)))),typeof i.z>"u"&&(i.z=ht[14]);break;default:n=i.v;break}var o=ar("v",jt(n)),c={r:e},h=Xs(r.cellXfs,i,r);switch(h!==0&&(c.s=h),i.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(i.v==null){delete i.t;break}if(i.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=ar("v",""+$f(r.Strings,i.v,r.revStrings)),c.t="s";break}c.t="str";break}if(i.t!=s&&(i.t=s,i.v=a),typeof i.f=="string"&&i.f){var l=i.F&&i.F.slice(0,e.length)==e?{t:"array",ref:i.F}:null;o=Ve("f",jt(i.f),l)+(i.v!=null?o:"")}return i.l&&t["!links"].push([e,i.l]),i.D&&(c.cm=1),Ve("c",o,c)}var yL=function(){var i=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=dl("v"),a=dl("f");return function(c,h,l,u,d,f){for(var p=0,m="",v=[],_=[],x=0,E=0,C=0,y="",b,T,R=0,O=0,W,G,Q=0,ne=0,xe=Array.isArray(f.CellXf),Ce,Fe=[],ke=[],Ze=Array.isArray(h),ie=[],Ee={},Pe=!1,U=!!l.sheetStubs,Z=c.split(e),q=0,X=Z.length;q!=X;++q){m=Z[q].trim();var de=m.length;if(de!==0){var Ie=0;e:for(p=0;p<de;++p)switch(m[p]){case">":if(m[p-1]!="/"){++p;break e}if(l&&l.cellStyles){if(T=gt(m.slice(Ie,p),!0),R=T.r!=null?parseInt(T.r,10):R+1,O=-1,l.sheetRows&&l.sheetRows<R)continue;Ee={},Pe=!1,T.ht&&(Pe=!0,Ee.hpt=parseFloat(T.ht),Ee.hpx=ho(Ee.hpt)),T.hidden=="1"&&(Pe=!0,Ee.hidden=!0),T.outlineLevel!=null&&(Pe=!0,Ee.level=+T.outlineLevel),Pe&&(ie[R-1]=Ee)}break;case"<":Ie=p;break}if(Ie>=p)break;if(T=gt(m.slice(Ie,p),!0),R=T.r!=null?parseInt(T.r,10):R+1,O=-1,!(l.sheetRows&&l.sheetRows<R)){u.s.r>R-1&&(u.s.r=R-1),u.e.r<R-1&&(u.e.r=R-1),l&&l.cellStyles&&(Ee={},Pe=!1,T.ht&&(Pe=!0,Ee.hpt=parseFloat(T.ht),Ee.hpx=ho(Ee.hpt)),T.hidden=="1"&&(Pe=!0,Ee.hidden=!0),T.outlineLevel!=null&&(Pe=!0,Ee.level=+T.outlineLevel),Pe&&(ie[R-1]=Ee)),v=m.slice(p).split(i);for(var we=0;we!=v.length&&v[we].trim().charAt(0)=="<";++we);for(v=v.slice(we),p=0;p!=v.length;++p)if(m=v[p].trim(),m.length!==0){if(_=m.match(t),x=p,E=0,C=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,_!=null&&_.length===2){for(x=0,y=_[1],E=0;E!=y.length&&!((C=y.charCodeAt(E)-64)<1||C>26);++E)x=26*x+C;--x,O=x}else++O;for(E=0;E!=m.length&&m.charCodeAt(E)!==62;++E);if(++E,T=gt(m.slice(0,E),!0),T.r||(T.r=ut({r:R-1,c:O})),y=m.slice(E),b={t:""},(_=y.match(s))!=null&&_[1]!==""&&(b.v=Bt(_[1])),l.cellFormula){if((_=y.match(a))!=null&&_[1]!==""){if(b.f=Bt(Qt(_[1])).replace(/\r\n/g,`
`),l.xlfn||(b.f=gm(b.f)),_[0].indexOf('t="array"')>-1)b.F=(y.match(n)||[])[1],b.F.indexOf(":")>-1&&Fe.push([Ht(b.F),b.F]);else if(_[0].indexOf('t="shared"')>-1){G=gt(_[0]);var Re=Bt(Qt(_[1]));l.xlfn||(Re=gm(Re)),ke[parseInt(G.si,10)]=[G,Re,T.r]}}else(_=y.match(/<f[^>]*\/>/))&&(G=gt(_[0]),ke[G.si]&&(b.f=EN(ke[G.si][1],ke[G.si][2],T.r)));var be=Ci(T.r);for(E=0;E<Fe.length;++E)be.r>=Fe[E][0].s.r&&be.r<=Fe[E][0].e.r&&be.c>=Fe[E][0].s.c&&be.c<=Fe[E][0].e.c&&(b.F=Fe[E][1])}if(T.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(U)b.t="z";else continue;else b.t=T.t||"n";switch(u.s.c>O&&(u.s.c=O),u.e.c<O&&(u.e.c=O),b.t){case"n":if(b.v==""||b.v==null){if(!U)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!U)continue;b.t="z"}else W=Ko[parseInt(b.v,10)],b.v=W.t,b.r=W.r,l.cellHTML&&(b.h=W.h);break;case"str":b.t="s",b.v=b.v!=null?Qt(b.v):"",l.cellHTML&&(b.h=Sf(b.v));break;case"inlineStr":_=y.match(r),b.t="s",_!=null&&(W=Bf(_[1]))?(b.v=W.t,l.cellHTML&&(b.h=W.h)):b.v="";break;case"b":b.v=li(b.v);break;case"d":l.cellDates?b.v=ci(b.v,1):(b.v=Qi(ci(b.v,1)),b.t="n");break;case"e":(!l||l.cellText!==!1)&&(b.w=b.v),b.v=p_[b.v];break}if(Q=ne=0,Ce=null,xe&&T.s!==void 0&&(Ce=f.CellXf[T.s],Ce!=null&&(Ce.numFmtId!=null&&(Q=Ce.numFmtId),l.cellStyles&&Ce.fillId!=null&&(ne=Ce.fillId))),u1(b,Q,ne,l,d,f),l.cellDates&&xe&&b.t=="n"&&Eo(ht[Q])&&(b.t="d",b.v=Lh(b.v)),T.cm&&l.xlmeta){var ue=(l.xlmeta.Cell||[])[+T.cm-1];ue&&ue.type=="XLDAPR"&&(b.D=!0)}if(Ze){var M=Ci(T.r);h[M.r]||(h[M.r]=[]),h[M.r][M.c]=b}else h[T.r]=b}}}}ie.length>0&&(h["!rows"]=ie)}}();function SL(i,e,t,r){var n=[],s=[],a=Ht(i["!ref"]),o="",c,h="",l=[],u=0,d=0,f=i["!rows"],p=Array.isArray(i),m={r:h},v,_=-1;for(d=a.s.c;d<=a.e.c;++d)l[d]=wi(d);for(u=a.s.r;u<=a.e.r;++u){for(s=[],h=Ni(u),d=a.s.c;d<=a.e.c;++d){c=l[d]+h;var x=p?(i[u]||[])[d]:i[c];x!==void 0&&(o=CL(x,c,i,e))!=null&&s.push(o)}(s.length>0||f&&f[u])&&(m={r:h},f&&f[u]&&(v=f[u],v.hidden&&(m.hidden=1),_=-1,v.hpx?_=El(v.hpx):v.hpt&&(_=v.hpt),_>-1&&(m.ht=_,m.customHeight=1),v.level&&(m.outlineLevel=v.level)),n[n.length]=Ve("row",s.join(""),m))}if(f)for(;u<f.length;++u)f&&f[u]&&(m={r:u+1},v=f[u],v.hidden&&(m.hidden=1),_=-1,v.hpx?_=El(v.hpx):v.hpt&&(_=v.hpt),_>-1&&(m.ht=_,m.customHeight=1),v.level&&(m.outlineLevel=v.level),n[n.length]=Ve("row","",m));return n.join("")}function f1(i,e,t,r){var n=[Mi,Ve("worksheet",null,{xmlns:Aa[0],"xmlns:r":ji.r})],s=t.SheetNames[i],a=0,o="",c=t.Sheets[s];c==null&&(c={});var h=c["!ref"]||"A1",l=Ht(h);if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575),h=Tt(l)}r||(r={}),c["!comments"]=[];var u=[];lL(c,t,i,e,n),n[n.length]=Ve("dimension",null,{ref:h}),n[n.length]=wL(c,e,i,t),e.sheetFormat&&(n[n.length]=Ve("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=gL(c,c["!cols"])),n[a=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=SL(c,e),o.length>0&&(n[n.length]=o)),n.length>a+1&&(n[n.length]="</sheetData>",n[a]=n[a].replace("/>",">")),c["!protect"]&&(n[n.length]=uL(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=_L(c["!autofilter"],c,t,i)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=aL(c["!merges"]));var d=-1,f,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(f={ref:m[0]},m[1].Target.charAt(0)!="#"&&(p=Kt(r,-1,jt(m[1].Target).replace(/#.*$/,""),Dt.HLINK),f["r:id"]="rId"+p),(d=m[1].Target.indexOf("#"))>-1&&(f.location=jt(m[1].Target.slice(d+1))),m[1].Tooltip&&(f.tooltip=jt(m[1].Tooltip)),n[n.length]=Ve("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=pL(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(n[n.length]=ar("ignoredErrors",Ve("ignoredError",null,{numberStoredAsText:1,sqref:h}))),u.length>0&&(p=Kt(r,-1,"../drawings/drawing"+(i+1)+".xml",Dt.DRAW),n[n.length]=Ve("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=u),c["!comments"].length>0&&(p=Kt(r,-1,"../drawings/vmlDrawing"+(i+1)+".vml",Dt.VML),n[n.length]=Ve("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function bL(i,e){var t={},r=i.l+e;t.r=i.read_shift(4),i.l+=4;var n=i.read_shift(2);i.l+=1;var s=i.read_shift(1);return i.l=r,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}function TL(i,e,t){var r=_e(145),n=(t["!rows"]||[])[i]||{};r.write_shift(4,i),r.write_shift(4,0);var s=320;n.hpx?s=El(n.hpx)*20:n.hpt&&(s=n.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;n.level&&(a|=n.level),n.hidden&&(a|=16),(n.hpx||n.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,c=r.l;r.l+=4;for(var h={r:i,c:0},l=0;l<16;++l)if(!(e.s.c>l+1<<10||e.e.c<l<<10)){for(var u=-1,d=-1,f=l<<10;f<l+1<<10;++f){h.c=f;var p=Array.isArray(t)?(t[h.r]||[])[h.c]:t[ut(h)];p&&(u<0&&(u=f),d=f)}u<0||(++o,r.write_shift(4,u),r.write_shift(4,d))}var m=r.l;return r.l=c,r.write_shift(4,o),r.l=m,r.length>r.l?r.slice(0,r.l):r}function AL(i,e,t,r){var n=TL(r,t,e);(n.length>17||(e["!rows"]||[])[r])&&De(i,0,n)}var kL=Ra,OL=Co;function IL(){}function RL(i,e){var t={},r=i[i.l];return++i.l,t.above=!(r&64),t.left=!(r&128),i.l+=18,t.name=PI(i),t}function DL(i,e,t){t==null&&(t=_e(84+4*i.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var n=1;n<3;++n)t.write_shift(1,0);return sh({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),c_(i,t),t.slice(0,t.l)}function FL(i){var e=wn(i);return[e]}function PL(i,e,t){return t==null&&(t=_e(8)),ka(e,t)}function NL(i){var e=Oa(i);return[e]}function ML(i,e,t){return t==null&&(t=_e(4)),Ia(e,t)}function LL(i){var e=wn(i),t=i.read_shift(1);return[e,t,"b"]}function BL(i,e,t){return t==null&&(t=_e(9)),ka(e,t),t.write_shift(1,i.v?1:0),t}function HL(i){var e=Oa(i),t=i.read_shift(1);return[e,t,"b"]}function VL(i,e,t){return t==null&&(t=_e(5)),Ia(e,t),t.write_shift(1,i.v?1:0),t}function UL(i){var e=wn(i),t=i.read_shift(1);return[e,t,"e"]}function WL(i,e,t){return t==null&&(t=_e(9)),ka(e,t),t.write_shift(1,i.v),t}function zL(i){var e=Oa(i),t=i.read_shift(1);return[e,t,"e"]}function GL(i,e,t){return t==null&&(t=_e(8)),Ia(e,t),t.write_shift(1,i.v),t.write_shift(2,0),t.write_shift(1,0),t}function $L(i){var e=wn(i),t=i.read_shift(4);return[e,t,"s"]}function YL(i,e,t){return t==null&&(t=_e(12)),ka(e,t),t.write_shift(4,e.v),t}function XL(i){var e=Oa(i),t=i.read_shift(4);return[e,t,"s"]}function qL(i,e,t){return t==null&&(t=_e(8)),Ia(e,t),t.write_shift(4,e.v),t}function KL(i){var e=wn(i),t=gr(i);return[e,t,"n"]}function jL(i,e,t){return t==null&&(t=_e(16)),ka(e,t),wa(i.v,t),t}function p1(i){var e=Oa(i),t=gr(i);return[e,t,"n"]}function QL(i,e,t){return t==null&&(t=_e(12)),Ia(e,t),wa(i.v,t),t}function ZL(i){var e=wn(i),t=Ff(i);return[e,t,"n"]}function JL(i,e,t){return t==null&&(t=_e(12)),ka(e,t),h_(i.v,t),t}function e4(i){var e=Oa(i),t=Ff(i);return[e,t,"n"]}function t4(i,e,t){return t==null&&(t=_e(8)),Ia(e,t),h_(i.v,t),t}function i4(i){var e=wn(i),t=If(i);return[e,t,"is"]}function r4(i){var e=wn(i),t=vr(i);return[e,t,"str"]}function n4(i,e,t){return t==null&&(t=_e(12+4*i.v.length)),ka(e,t),tr(i.v,t),t.length>t.l?t.slice(0,t.l):t}function s4(i){var e=Oa(i),t=vr(i);return[e,t,"str"]}function a4(i,e,t){return t==null&&(t=_e(8+4*i.v.length)),Ia(e,t),tr(i.v,t),t.length>t.l?t.slice(0,t.l):t}function o4(i,e,t){var r=i.l+e,n=wn(i);n.r=t["!row"];var s=i.read_shift(1),a=[n,s,"b"];if(t.cellFormula){i.l+=2;var o=Vh(i,r-i.l,t);a[3]=pr(o,null,n,t.supbooks,t)}else i.l=r;return a}function l4(i,e,t){var r=i.l+e,n=wn(i);n.r=t["!row"];var s=i.read_shift(1),a=[n,s,"e"];if(t.cellFormula){i.l+=2;var o=Vh(i,r-i.l,t);a[3]=pr(o,null,n,t.supbooks,t)}else i.l=r;return a}function c4(i,e,t){var r=i.l+e,n=wn(i);n.r=t["!row"];var s=gr(i),a=[n,s,"n"];if(t.cellFormula){i.l+=2;var o=Vh(i,r-i.l,t);a[3]=pr(o,null,n,t.supbooks,t)}else i.l=r;return a}function h4(i,e,t){var r=i.l+e,n=wn(i);n.r=t["!row"];var s=vr(i),a=[n,s,"str"];if(t.cellFormula){i.l+=2;var o=Vh(i,r-i.l,t);a[3]=pr(o,null,n,t.supbooks,t)}else i.l=r;return a}var u4=Ra,d4=Co;function f4(i,e){return e==null&&(e=_e(4)),e.write_shift(4,i),e}function p4(i,e){var t=i.l+e,r=Ra(i),n=Rf(i),s=vr(i),a=vr(i),o=vr(i);i.l=t;var c={rfx:r,relId:n,loc:s,display:o};return a&&(c.Tooltip=a),c}function m4(i,e){var t=_e(50+4*(i[1].Target.length+(i[1].Tooltip||"").length));Co({s:Ci(i[0]),e:Ci(i[0])},t),Df("rId"+e,t);var r=i[1].Target.indexOf("#"),n=r==-1?"":i[1].Target.slice(r+1);return tr(n||"",t),tr(i[1].Tooltip||"",t),tr("",t),t.slice(0,t.l)}function g4(){}function v4(i,e,t){var r=i.l+e,n=u_(i),s=i.read_shift(1),a=[n];if(a[2]=s,t.cellFormula){var o=UM(i,r-i.l,t);a[1]=o}else i.l=r;return a}function _4(i,e,t){var r=i.l+e,n=Ra(i),s=[n];if(t.cellFormula){var a=zM(i,r-i.l,t);s[1]=a,i.l=r}else i.l=r;return s}function E4(i,e,t){t==null&&(t=_e(18));var r=Uh(i,e);t.write_shift(-4,i),t.write_shift(-4,i),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var n=0;return e.hidden&&(n|=1),typeof r.width=="number"&&(n|=2),e.level&&(n|=e.level<<8),t.write_shift(2,n),t}var m1=["left","right","top","bottom","header","footer"];function x4(i){var e={};return m1.forEach(function(t){e[t]=gr(i)}),e}function w4(i,e){return e==null&&(e=_e(6*8)),ua(i),m1.forEach(function(t){wa(i[t],e)}),e}function C4(i){var e=i.read_shift(2);return i.l+=28,{RTL:e&32}}function y4(i,e,t){t==null&&(t=_e(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function S4(i){var e=_e(24);return e.write_shift(4,4),e.write_shift(4,1),Co(i,e),e}function b4(i,e){return e==null&&(e=_e(16*4+2)),e.write_shift(2,i.password?Hf(i.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,i[t[0]]!=null&&!i[t[0]]?1:0):e.write_shift(4,i[t[0]]!=null&&i[t[0]]?0:1)}),e}function T4(){}function A4(){}function k4(i,e,t,r,n,s,a){if(!i)return i;var o=e||{};r||(r={"!id":{}});var c=o.dense?[]:{},h,l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,f,p,m,v,_,x,E,C,y,b=[];o.biff=12,o["!row"]=0;var T=0,R=!1,O=[],W={},G=o.supbooks||n.supbooks||[[]];if(G.sharedf=W,G.arrayf=O,G.SheetNames=n.SheetNames||n.Sheets.map(function(Ze){return Ze.name}),!o.supbooks&&(o.supbooks=G,n.Names))for(var Q=0;Q<n.Names.length;++Q)G[0][Q+1]=n.Names[Q];var ne=[],xe=[],Ce=!1;xl[16]={n:"BrtShortReal",f:p1};var Fe;if(ws(i,function(ie,Ee,Pe){if(!d)switch(Pe){case 148:h=ie;break;case 0:f=ie,o.sheetRows&&o.sheetRows<=f.r&&(d=!0),C=Ni(v=f.r),o["!row"]=f.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=ho(ie.hpt)),xe[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:ie[2]},ie[2]){case"n":p.v=ie[1];break;case"s":E=Ko[ie[1]],p.v=E.t,p.r=E.r;break;case"b":p.v=!!ie[1];break;case"e":p.v=ie[1],o.cellText!==!1&&(p.w=Cs[p.v]);break;case"str":p.t="s",p.v=ie[1];break;case"is":p.t="s",p.v=ie[1].t;break}if((m=a.CellXf[ie[0].iStyleRef])&&u1(p,m.numFmtId,null,o,s,a),_=ie[0].c==-1?_+1:ie[0].c,o.dense?(c[v]||(c[v]=[]),c[v][_]=p):c[wi(_)+C]=p,o.cellFormula){for(R=!1,T=0;T<O.length;++T){var U=O[T];f.r>=U[0].s.r&&f.r<=U[0].e.r&&_>=U[0].s.c&&_<=U[0].e.c&&(p.F=Tt(U[0]),R=!0)}!R&&ie.length>3&&(p.f=ie[3])}if(l.s.r>f.r&&(l.s.r=f.r),l.s.c>_&&(l.s.c=_),l.e.r<f.r&&(l.e.r=f.r),l.e.c<_&&(l.e.c=_),o.cellDates&&m&&p.t=="n"&&Eo(ht[m.numFmtId])){var Z=aa(p.v);Z&&(p.t="d",p.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}Fe&&(Fe.type=="XLDAPR"&&(p.D=!0),Fe=void 0);break;case 1:case 12:if(!o.sheetStubs||u)break;p={t:"z",v:void 0},_=ie[0].c==-1?_+1:ie[0].c,o.dense?(c[v]||(c[v]=[]),c[v][_]=p):c[wi(_)+C]=p,l.s.r>f.r&&(l.s.r=f.r),l.s.c>_&&(l.s.c=_),l.e.r<f.r&&(l.e.r=f.r),l.e.c<_&&(l.e.c=_),Fe&&(Fe.type=="XLDAPR"&&(p.D=!0),Fe=void 0);break;case 176:b.push(ie);break;case 49:Fe=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var q=r["!id"][ie.relId];for(q?(ie.Target=q.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=q):ie.relId==""&&(ie.Target="#"+ie.loc),v=ie.rfx.s.r;v<=ie.rfx.e.r;++v)for(_=ie.rfx.s.c;_<=ie.rfx.e.c;++_)o.dense?(c[v]||(c[v]=[]),c[v][_]||(c[v][_]={t:"z",v:void 0}),c[v][_].l=ie):(x=ut({c:_,r:v}),c[x]||(c[x]={t:"z",v:void 0}),c[x].l=ie);break;case 426:if(!o.cellFormula)break;O.push(ie),y=o.dense?c[v][_]:c[wi(_)+C],y.f=pr(ie[1],l,{r:f.r,c:_},G,o),y.F=Tt(ie[0]);break;case 427:if(!o.cellFormula)break;W[ut(ie[0].s)]=ie[1],y=o.dense?c[v][_]:c[wi(_)+C],y.f=pr(ie[1],l,{r:f.r,c:_},G,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)ne[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},Ce||(Ce=!0,Vf(ie.w/256)),Us(ne[ie.e+1]);break;case 161:c["!autofilter"]={ref:Tt(ie)};break;case 476:c["!margins"]=ie;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),ie.name&&(n.Sheets[t].CodeName=ie.name),(ie.above||ie.left)&&(c["!outline"]={above:ie.above,left:ie.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),ie.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!Ee.T){if(!u||o.WTF)throw new Error("Unexpected record 0x"+Pe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(l.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(c["!ref"]=Tt(h||l)),o.sheetRows&&c["!ref"]){var ke=Ht(c["!ref"]);o.sheetRows<=+ke.e.r&&(ke.e.r=o.sheetRows-1,ke.e.r>l.e.r&&(ke.e.r=l.e.r),ke.e.r<ke.s.r&&(ke.s.r=ke.e.r),ke.e.c>l.e.c&&(ke.e.c=l.e.c),ke.e.c<ke.s.c&&(ke.s.c=ke.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tt(ke))}return b.length>0&&(c["!merges"]=b),ne.length>0&&(c["!cols"]=ne),xe.length>0&&(c["!rows"]=xe),c}function O4(i,e,t,r,n,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=hi(e),e.z=e.z||ht[14],e.v=Qi(ci(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r:t,c:r};switch(c.s=Xs(n.cellXfs,e,n),e.l&&s["!links"].push([ut(c),e.l]),e.c&&s["!comments"].push([ut(c),e.c]),e.t){case"s":case"str":return n.bookSST?(o=$f(n.Strings,e.v,n.revStrings),c.t="s",c.v=o,a?De(i,18,qL(e,c)):De(i,7,YL(e,c))):(c.t="str",a?De(i,17,a4(e,c)):De(i,6,n4(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?De(i,13,t4(e,c)):De(i,2,JL(e,c)):a?De(i,16,QL(e,c)):De(i,5,jL(e,c)),!0;case"b":return c.t="b",a?De(i,15,VL(e,c)):De(i,4,BL(e,c)),!0;case"e":return c.t="e",a?De(i,14,GL(e,c)):De(i,3,WL(e,c)),!0}return a?De(i,12,ML(e,c)):De(i,1,PL(e,c)),!0}function I4(i,e,t,r){var n=Ht(e["!ref"]||"A1"),s,a="",o=[];De(i,145);var c=Array.isArray(e),h=n.e.r;e["!rows"]&&(h=Math.max(n.e.r,e["!rows"].length-1));for(var l=n.s.r;l<=h;++l){a=Ni(l),AL(i,e,n,l);var u=!1;if(l<=n.e.r)for(var d=n.s.c;d<=n.e.c;++d){l===n.s.r&&(o[d]=wi(d)),s=o[d]+a;var f=c?(e[l]||[])[d]:e[s];if(!f){u=!1;continue}u=O4(i,f,l,d,r,e,u)}}De(i,146)}function R4(i,e){!e||!e["!merges"]||(De(i,177,f4(e["!merges"].length)),e["!merges"].forEach(function(t){De(i,176,d4(t))}),De(i,178))}function D4(i,e){!e||!e["!cols"]||(De(i,390),e["!cols"].forEach(function(t,r){t&&De(i,60,E4(r,t))}),De(i,391))}function F4(i,e){!e||!e["!ref"]||(De(i,648),De(i,649,S4(Ht(e["!ref"]))),De(i,650))}function P4(i,e,t){e["!links"].forEach(function(r){if(r[1].Target){var n=Kt(t,-1,r[1].Target.replace(/#.*$/,""),Dt.HLINK);De(i,494,m4(r,n))}}),delete e["!links"]}function N4(i,e,t,r){if(e["!comments"].length>0){var n=Kt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Dt.VML);De(i,551,Df("rId"+n)),e["!legacy"]=n}}function M4(i,e,t,r){if(e["!autofilter"]){var n=e["!autofilter"],s=typeof n.ref=="string"?n.ref:Tt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Gr(s);o.s.r==o.e.r&&(o.e.r=Gr(e["!ref"]).e.r,s=Tt(o));for(var c=0;c<a.length;++c){var h=a[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+t.SheetNames[r]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+s}),De(i,161,Co(Ht(s))),De(i,162)}}function L4(i,e,t){De(i,133),De(i,137,y4(e,t)),De(i,138),De(i,134)}function B4(i,e){e["!protect"]&&De(i,535,b4(e["!protect"]))}function H4(i,e,t,r){var n=zr(),s=t.SheetNames[i],a=t.Sheets[s]||{},o=s;try{t&&t.Workbook&&(o=t.Workbook.Sheets[i].CodeName||o)}catch{}var c=Ht(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],De(n,129),(t.vbaraw||a["!outline"])&&De(n,147,DL(o,a["!outline"])),De(n,148,OL(c)),L4(n,a,t.Workbook),D4(n,a),I4(n,a,i,e),B4(n,a),M4(n,a,t,i),R4(n,a),P4(n,a,r),a["!margins"]&&De(n,476,w4(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&F4(n,a),N4(n,a,i,r),De(n,130),n.end()}function V4(i){var e=[],t=i.match(/^<c:numCache>/),r;(i.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=t?+a[2]:a[2])});var n=Bt((i.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(i.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[e,n,r]}function U4(i,e,t,r,n,s){var a=s||{"!type":"chart"};if(!i)return s;var o=0,c=0,h="A",l={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(i.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=V4(u);l.s.r=l.s.c=0,l.e.c=o,h=wi(o),d[0].forEach(function(f,p){a[h+Ni(p)]={t:"n",v:f,z:d[1]},c=p}),l.e.r<c&&(l.e.r=c),++o}),o>0&&(a["!ref"]=Tt(l)),a}function W4(i,e,t,r,n){if(!i)return i;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=i.match(d1);return o&&Yf(o[0],s,n,t),(a=i.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function z4(i,e){i.l+=10;var t=vr(i);return{name:t}}function G4(i,e,t,r,n){if(!i)return i;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ws(i,function(c,h,l){switch(l){case 550:s["!rel"]=c;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),c.name&&(n.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}},e),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var Xf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$4=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Y4=[],X4=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wm(i,e){for(var t=0;t!=i.length;++t)for(var r=i[t],n=0;n!=e.length;++n){var s=e[n];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=li(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function Cm(i,e){for(var t=0;t!=e.length;++t){var r=e[t];if(i[r[0]]==null)i[r[0]]=r[1];else switch(r[2]){case"bool":typeof i[r[0]]=="string"&&(i[r[0]]=li(i[r[0]]));break;case"int":typeof i[r[0]]=="string"&&(i[r[0]]=parseInt(i[r[0]],10));break}}}function g1(i){Cm(i.WBProps,Xf),Cm(i.CalcPr,X4),wm(i.WBView,$4),wm(i.Sheets,Y4),ro.date1904=li(i.WBProps.date1904)}function q4(i){return!i.Workbook||!i.Workbook.WBProps?"false":li(i.Workbook.WBProps.date1904)?"true":"false"}var K4="][*?/\\".split("");function v1(i,e){if(i.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return K4.forEach(function(r){if(i.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function j4(i,e,t){i.forEach(function(r,n){v1(r);for(var s=0;s<n;++s)if(r==i[s])throw new Error("Duplicate Sheet Name: "+r);if(t){var a=e&&e[n]&&e[n].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Q4(i){if(!i||!i.SheetNames||!i.Sheets)throw new Error("Invalid Workbook");if(!i.SheetNames.length)throw new Error("Workbook is empty");var e=i.Workbook&&i.Workbook.Sheets||[];j4(i.SheetNames,e,!!i.vbaraw);for(var t=0;t<i.SheetNames.length;++t)qM(i.Sheets[i.SheetNames[t]],i.SheetNames[t],t)}var Z4=/<\w+:workbook/;function J4(i,e){if(!i)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,n="xmlns",s={},a=0;if(i.replace(Cr,function(c,h){var l=gt(c);switch(jn(l[0])){case"<?xml":break;case"<workbook":c.match(Z4)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=l[n];break;case"</workbook>":break;case"<fileVersion":delete l[0],t.AppVersion=l;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Xf.forEach(function(u){if(l[u[0]]!=null)switch(u[2]){case"bool":t.WBProps[u[0]]=li(l[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(l[u[0]],10);break;default:t.WBProps[u[0]]=l[u[0]]}}),l.codeName&&(t.WBProps.CodeName=Qt(l.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete l[0],t.WBView.push(l);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(l.state){case"hidden":l.Hidden=1;break;case"veryHidden":l.Hidden=2;break;default:l.Hidden=0}delete l.state,l.name=Bt(Qt(l.name)),delete l[0],t.Sheets.push(l);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Qt(l.name),l.comment&&(s.Comment=l.comment),l.localSheetId&&(s.Sheet=+l.localSheetId),li(l.hidden||"0")&&(s.Hidden=!0),a=h+c.length;break;case"</definedName>":s.Ref=Bt(Qt(i.slice(a,h))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete l[0],t.CalcPr=l;break;case"<calcPr/>":delete l[0],t.CalcPr=l;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in workbook")}return c}),Aa.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return g1(t),t}function _1(i){var e=[Mi];e[e.length]=Ve("workbook",null,{xmlns:Aa[0],"xmlns:r":ji.r});var t=i.Workbook&&(i.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};i.Workbook&&i.Workbook.WBProps&&(Xf.forEach(function(o){i.Workbook.WBProps[o[0]]!=null&&i.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=i.Workbook.WBProps[o[0]])}),i.Workbook.WBProps.CodeName&&(r.codeName=i.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Ve("workbookPr",null,r);var n=i.Workbook&&i.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=i.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==i.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=i.SheetNames.length;++s){var a={name:jt(i.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=Ve("sheet",null,a)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",i.Workbook&&i.Workbook.Names&&i.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=Ve("definedName",jt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function e3(i,e){var t={};return t.Hidden=i.read_shift(4),t.iTabID=i.read_shift(4),t.strRelID=_d(i),t.name=vr(i),t}function t3(i,e){return e||(e=_e(127)),e.write_shift(4,i.Hidden),e.write_shift(4,i.iTabID),Df(i.strRelID,e),tr(i.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function i3(i,e){var t={},r=i.read_shift(4);t.defaultThemeVersion=i.read_shift(4);var n=e>8?vr(i):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function r3(i,e){e||(e=_e(72));var t=0;return i&&i.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),c_(i&&i.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function n3(i,e){var t={};return i.read_shift(4),t.ArchID=i.read_shift(4),i.l+=e-8,t}function s3(i,e,t){var r=i.l+e;i.l+=4,i.l+=1;var n=i.read_shift(4),s=NI(i),a=WM(i,0,t),o=Rf(i);i.l=r;var c={Name:s,Ptg:a};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function a3(i,e){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],n=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],xl[16]={n:"BrtFRTArchID$",f:n3},ws(i,function(c,h,l){switch(l){case 156:a.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=pr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([l,c]):a[0]=[l,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(l),n=!0;break;case 36:r.pop(),n=!1;break;case 37:r.push(l),n=!0;break;case 38:r.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+l.toString(16))}}},e),g1(t),t.Names=s,t.supbooks=a,t}function o3(i,e){De(i,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,n={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};De(i,156,t3(n))}De(i,144)}function l3(i,e){e||(e=_e(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return tr("SheetJS",e),tr(Zc.version,e),tr(Zc.version,e),tr("7262",e),e.length>e.l?e.slice(0,e.l):e}function c3(i,e){e||(e=_e(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,i),e.write_shift(4,i);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function h3(i,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,n=-1,s=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&n==-1?n=r:t[r].Hidden==1&&s==-1&&(s=r);s>n||(De(i,135),De(i,158,c3(n)),De(i,136))}}function u3(i,e){var t=zr();return De(t,131),De(t,128,l3()),De(t,153,r3(i.Workbook&&i.Workbook.WBProps||null)),h3(t,i),o3(t,i),De(t,132),t.end()}function d3(i,e,t){return e.slice(-4)===".bin"?a3(i,t):J4(i,t)}function f3(i,e,t,r,n,s,a,o){return e.slice(-4)===".bin"?k4(i,r,t,n,s,a,o):sL(i,r,t,n,s,a,o)}function p3(i,e,t,r,n,s,a,o){return e.slice(-4)===".bin"?G4(i,r,t,n,s):W4(i,r,t,n,s)}function m3(i,e,t,r,n,s,a,o){return e.slice(-4)===".bin"?vN():_N()}function g3(i,e,t,r,n,s,a,o){return e.slice(-4)===".bin"?mN():gN()}function v3(i,e,t,r){return e.slice(-4)===".bin"?dP(i,t,r):eP(i,t,r)}function _3(i,e,t){return Z_(i,t)}function E3(i,e,t){return e.slice(-4)===".bin"?EF(i,t):gF(i,t)}function x3(i,e,t){return e.slice(-4)===".bin"?hN(i,t):tN(i,t)}function w3(i,e,t){return e.slice(-4)===".bin"?ZP(i):jP(i)}function C3(i,e,t,r){return t.slice(-4)===".bin"?JP(i,e,t,r):void 0}function y3(i,e,t){return e.slice(-4)===".bin"?XP(i,e,t):KP(i,e,t)}function S3(i,e,t){return(e.slice(-4)===".bin"?u3:_1)(i)}function b3(i,e,t,r,n){return(e.slice(-4)===".bin"?H4:f1)(i,t,r,n)}function T3(i,e,t){return(e.slice(-4)===".bin"?CP:j_)(i,t)}function A3(i,e,t){return(e.slice(-4)===".bin"?CF:W_)(i,t)}function k3(i,e,t){return(e.slice(-4)===".bin"?uN:t1)(i)}function O3(i){return(i.slice(-4)===".bin"?qP:J_)()}var E1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,x1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Tn(i,e){var t=i.split(/\s+/),r=[];if(r[0]=t[0],t.length===1)return r;var n=i.match(E1),s,a,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(x1),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}function I3(i){var e=i.split(/\s+/),t={};if(e.length===1)return t;var r=i.match(E1),n,s,a,o;if(r)for(o=0;o!=r.length;++o)n=r[o].match(x1),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?a="xmlns"+n[1].slice(6):a=n[1].slice(s+1),t[a]=n[2].slice(1,n[2].length-1));return t}var Qo;function R3(i,e){var t=Qo[i]||Bt(i);return t==="General"?Ea(e):_n(t,e)}function D3(i,e,t,r){var n=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=li(r);break;case"i2":case"int":n=parseInt(r,10);break;case"r4":case"float":n=parseFloat(r);break;case"date":case"dateTime.tz":n=ci(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}i[Bt(e)]=n}function F3(i,e,t){if(i.t!=="z"){if(!t||t.cellText!==!1)try{i.t==="e"?i.w=i.w||Cs[i.v]:e==="General"?i.t==="n"?(i.v|0)===i.v?i.w=i.v.toString(10):i.w=ul(i.v):i.w=Ea(i.v):i.w=R3(e||"General",i.v)}catch(s){if(t.WTF)throw s}try{var r=Qo[e]||e||"General";if(t.cellNF&&(i.z=r),t.cellDates&&i.t=="n"&&Eo(r)){var n=aa(i.v);n&&(i.t="d",i.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function P3(i,e,t){if(t.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=YF[r.Pattern]||r.Pattern)}i[e.ID]=e}function N3(i,e,t,r,n,s,a,o,c,h){var l="General",u=r.StyleID,d={};h=h||{};var f=[],p=0;for(u===void 0&&o&&(u=o.StyleID),u===void 0&&a&&(u=a.StyleID);s[u]!==void 0&&(s[u].nf&&(l=s[u].nf),s[u].Interior&&f.push(s[u].Interior),!!s[u].Parent);)u=s[u].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=li(i);break;case"String":r.t="s",r.r=Hp(Bt(i)),r.v=i.indexOf("<")>-1?Bt(e||i).replace(/<.*?>/g,""):r.r;break;case"DateTime":i.slice(-1)!="Z"&&(i+="Z"),r.v=(ci(i)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Bt(i):r.v<60&&(r.v=r.v-1),(!l||l=="General")&&(l="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+i),r.t||(r.t="n");break;case"Error":r.t="e",r.v=p_[i],h.cellText!==!1&&(r.w=i);break;default:i==""&&e==""?r.t="z":(r.t="s",r.v=Hp(e||i));break}if(F3(r,l,h),h.cellFormula!==!1)if(r.Formula){var m=Bt(r.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),r.f=io(m,n),delete r.Formula,r.ArrayRange=="RC"?r.F=io("RC:RC",n):r.ArrayRange&&(r.F=io(r.ArrayRange,n),c.push([Ht(r.F),r.F]))}else for(p=0;p<c.length;++p)n.r>=c[p][0].s.r&&n.r<=c[p][0].e.r&&n.c>=c[p][0].s.c&&n.c<=c[p][0].e.c&&(r.F=c[p][1]);h.cellStyles&&(f.forEach(function(v){!d.patternType&&v.patternType&&(d.patternType=v.patternType)}),r.s=d),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function M3(i){i.t=i.v||"",i.t=i.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),i.v=i.w=i.ixfe=void 0}function Yu(i,e){var t=e||{};xo();var r=Mo(bf(i));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(r=Qt(r));var n=r.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var a=hi(t);return a.type="string",co.to_workbook(r,a)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(dt){n.indexOf("<"+dt)>=0&&(s=!0)}),s)return wB(r,t);Qo={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],h,l={},u=[],d=t.dense?[]:{},f="",p={},m={},v=Tn('<Data ss:Type="String">'),_=0,x=0,E=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},y={},b={},T="",R=0,O=[],W={},G={},Q=0,ne=[],xe=[],Ce={},Fe=[],ke,Ze=!1,ie=[],Ee=[],Pe={},U=0,Z=0,q={Sheets:[],WBProps:{date1904:!1}},X={};pl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";o=pl.exec(r);)switch(o[3]=(de=o[3]).toLowerCase()){case"data":if(de=="data"){if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?N3(r.slice(_,o.index),T,v,c[c.length-1][0]=="comment"?Ce:p,{c:x,r:E},y,Fe[x],m,ie,t):(T="",v=Tn(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(xe.length>0&&(p.c=xe),(!t.sheetRows||t.sheetRows>E)&&p.v!==void 0&&(t.dense?(d[E]||(d[E]=[]),d[E][x]=p):d[wi(x)+Ni(E)]=p),p.HRef&&(p.l={Target:Bt(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(U=x+(parseInt(p.MergeAcross,10)|0),Z=E+(parseInt(p.MergeDown,10)|0),O.push({s:{c:x,r:E},e:{c:U,r:Z}})),!t.sheetStubs)p.MergeAcross?x=U+1:++x;else if(p.MergeAcross||p.MergeDown){for(var Ie=x;Ie<=U;++Ie)for(var we=E;we<=Z;++we)(Ie>x||we>E)&&(t.dense?(d[we]||(d[we]=[]),d[we][Ie]={t:"z"}):d[wi(Ie)+Ni(we)]={t:"z"});x=U+1}else++x;else p=I3(o[0]),p.Index&&(x=+p.Index-1),x<C.s.c&&(C.s.c=x),x>C.e.c&&(C.e.c=x),o[0].slice(-2)==="/>"&&++x,xe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(E<C.s.r&&(C.s.r=E),E>C.e.r&&(C.e.r=E),o[0].slice(-2)==="/>"&&(m=Tn(o[0]),m.Index&&(E=+m.Index-1)),x=0,++E):(m=Tn(o[0]),m.Index&&(E=+m.Index-1),Pe={},(m.AutoFitHeight=="0"||m.Height)&&(Pe.hpx=parseInt(m.Height,10),Pe.hpt=El(Pe.hpx),Ee[E]=Pe),m.Hidden=="1"&&(Pe.hidden=!0,Ee[E]=Pe));break;case"worksheet":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));u.push(f),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(d["!ref"]=Tt(C),t.sheetRows&&t.sheetRows<=C.e.r&&(d["!fullref"]=d["!ref"],C.e.r=t.sheetRows-1,d["!ref"]=Tt(C))),O.length&&(d["!merges"]=O),Fe.length>0&&(d["!cols"]=Fe),Ee.length>0&&(d["!rows"]=Ee),l[f]=d}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=x=0,c.push([o[3],!1]),h=Tn(o[0]),f=Bt(h.Name),d=t.dense?[]:{},O=[],ie=[],Ee=[],X={name:f,Hidden:0},q.Sheets.push(X);break;case"table":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Fe=[],Ze=!1}break;case"style":o[1]==="/"?P3(y,b,t):b=Tn(o[0]);break;case"numberformat":b.nf=Bt(Tn(o[0]).Format||"General"),Qo[b.nf]&&(b.nf=Qo[b.nf]);for(var Re=0;Re!=392&&ht[Re]!=b.nf;++Re);if(Re==392){for(Re=57;Re!=392;++Re)if(ht[Re]==null){ds(b.nf,Re);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ke=Tn(o[0]),ke.Hidden&&(ke.hidden=!0,delete ke.Hidden),ke.Width&&(ke.wpx=parseInt(ke.Width,10)),!Ze&&ke.wpx>10){Ze=!0,mr=q_;for(var be=0;be<Fe.length;++be)Fe[be]&&Us(Fe[be])}Ze&&Us(ke),Fe[ke.Index-1||Fe.length]=ke;for(var ue=0;ue<+ke.Span;++ue)Fe[Fe.length]=hi(ke);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var M=gt(o[0]),it={Name:M.Name,Ref:io(M.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(it.Sheet=q.Sheets.length-1),q.Names.push(it);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=r.slice(R,o.index):R=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;b.Interior=Tn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?aR(W,de,r.slice(Q,o.index)):Q=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"));M3(Ce),xe.push(Ce)}else c.push([o[3],!1]),h=Tn(o[0]),Ce={a:h.Author};break;case"autofilter":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var et=Tn(o[0]);d["!autofilter"]={ref:io(et.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((h=c.pop())[0]!==o[3])throw new Error("Bad state: "+h.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Am(r,t);var he=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:he=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:he=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:he=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:he=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(r.slice(Q,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else Q=o.index+o[0].length;break;case"header":d["!margins"]||ua(d["!margins"]={},"xlml"),isNaN(+gt(o[0]).Margin)||(d["!margins"].header=+gt(o[0]).Margin);break;case"footer":d["!margins"]||ua(d["!margins"]={},"xlml"),isNaN(+gt(o[0]).Margin)||(d["!margins"].footer=+gt(o[0]).Margin);break;case"pagemargins":var Qe=gt(o[0]);d["!margins"]||ua(d["!margins"]={},"xlml"),isNaN(+Qe.Top)||(d["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(d["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(d["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(d["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:he=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:he=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:he=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:he=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:he=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:he=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:he=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:he=!1}break;case"smarttags":break;default:he=!1;break}if(he||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?D3(G,de,ne,r.slice(Q,o.index)):(ne=o,Q=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Te={};return!t.bookSheets&&!t.bookProps&&(Te.Sheets=l),Te.SheetNames=u,Te.Workbook=q,Te.SSF=hi(ht),Te.Props=W,Te.Custprops=G,Te}function bd(i,e){switch(Kf(e=e||{}),e.type||"base64"){case"base64":return Yu(sn(i),e);case"binary":case"buffer":case"file":return Yu(i,e);case"array":return Yu($s(i),e)}}function L3(i,e){var t=[];return i.Props&&t.push(oR(i.Props,e)),i.Custprops&&t.push(lR(i.Props,i.Custprops)),t.join("")}function B3(){return""}function H3(i,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,n){var s=[];s.push(Ve("NumberFormat",null,{"ss:Format":jt(ht[r.numFmtId])}));var a={"ss:ID":"s"+(21+n)};t.push(Ve("Style",s.join(""),a))}),Ve("Styles",t.join(""))}function w1(i){return Ve("NamedRange",null,{"ss:Name":i.Name,"ss:RefersTo":"="+zf(i.Ref,{r:0,c:0})})}function V3(i){if(!((i||{}).Workbook||{}).Names)return"";for(var e=i.Workbook.Names,t=[],r=0;r<e.length;++r){var n=e[r];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||t.push(w1(n)))}return Ve("Names",t.join(""))}function U3(i,e,t,r){if(!i||!((r||{}).Workbook||{}).Names)return"";for(var n=r.Workbook.Names,s=[],a=0;a<n.length;++a){var o=n[a];o.Sheet==t&&(o.Name.match(/^_xlfn\./)||s.push(w1(o)))}return s.join("")}function W3(i,e,t,r){if(!i)return"";var n=[];if(i["!margins"]&&(n.push("<PageSetup>"),i["!margins"].header&&n.push(Ve("Header",null,{"x:Margin":i["!margins"].header})),i["!margins"].footer&&n.push(Ve("Footer",null,{"x:Margin":i["!margins"].footer})),n.push(Ve("PageMargins",null,{"x:Bottom":i["!margins"].bottom||"0.75","x:Left":i["!margins"].left||"0.7","x:Right":i["!margins"].right||"0.7","x:Top":i["!margins"].top||"0.75"})),n.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)n.push(Ve("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==t&&n.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),i["!protect"]&&(n.push(ar("ProtectContents","True")),i["!protect"].objects&&n.push(ar("ProtectObjects","True")),i["!protect"].scenarios&&n.push(ar("ProtectScenarios","True")),i["!protect"].selectLockedCells!=null&&!i["!protect"].selectLockedCells?n.push(ar("EnableSelection","NoSelection")):i["!protect"].selectUnlockedCells!=null&&!i["!protect"].selectUnlockedCells&&n.push(ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){i["!protect"][a[0]]&&n.push("<"+a[1]+"/>")})),n.length==0?"":Ve("WorksheetOptions",n.join(""),{xmlns:Kr.x})}function z3(i){return i.map(function(e){var t=hI(e.t||""),r=Ve("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ve("Comment",r,{"ss:Author":e.a})}).join("")}function G3(i,e,t,r,n,s,a){if(!i||i.v==null&&i.f==null)return"";var o={};if(i.f&&(o["ss:Formula"]="="+jt(zf(i.f,a))),i.F&&i.F.slice(0,e.length)==e){var c=Ci(i.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(i.l&&i.l.Target&&(o["ss:HRef"]=jt(i.l.Target),i.l.Tooltip&&(o["x:HRefScreenTip"]=jt(i.l.Tooltip))),t["!merges"])for(var h=t["!merges"],l=0;l!=h.length;++l)h[l].s.c!=a.c||h[l].s.r!=a.r||(h[l].e.c>h[l].s.c&&(o["ss:MergeAcross"]=h[l].e.c-h[l].s.c),h[l].e.r>h[l].s.r&&(o["ss:MergeDown"]=h[l].e.r-h[l].s.r));var u="",d="";switch(i.t){case"z":if(!r.sheetStubs)return"";break;case"n":u="Number",d=String(i.v);break;case"b":u="Boolean",d=i.v?"1":"0";break;case"e":u="Error",d=Cs[i.v];break;case"d":u="DateTime",d=new Date(i.v).toISOString(),i.z==null&&(i.z=i.z||ht[14]);break;case"s":u="String",d=cI(i.v||"");break}var f=Xs(r.cellXfs,i,r);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=a.c+1;var p=i.v!=null?d:"",m=i.t=="z"?"":'<Data ss:Type="'+u+'">'+p+"</Data>";return(i.c||[]).length>0&&(m+=z3(i.c)),Ve("Cell",m,o)}function $3(i,e){var t='<Row ss:Index="'+(i+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=ho(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Y3(i,e,t,r){if(!i["!ref"])return"";var n=Ht(i["!ref"]),s=i["!merges"]||[],a=0,o=[];i["!cols"]&&i["!cols"].forEach(function(v,_){Us(v);var x=!!v.width,E=Uh(_,v),C={"ss:Index":_+1};x&&(C["ss:Width"]=vl(E.width)),v.hidden&&(C["ss:Hidden"]="1"),o.push(Ve("Column",null,C))});for(var c=Array.isArray(i),h=n.s.r;h<=n.e.r;++h){for(var l=[$3(h,(i["!rows"]||[])[h])],u=n.s.c;u<=n.e.c;++u){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>u)&&!(s[a].s.r>h)&&!(s[a].e.c<u)&&!(s[a].e.r<h)){(s[a].s.c!=u||s[a].s.r!=h)&&(d=!0);break}if(!d){var f={r:h,c:u},p=ut(f),m=c?(i[h]||[])[u]:i[p];l.push(G3(m,p,i,e,t,r,f))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}function X3(i,e,t){var r=[],n=t.SheetNames[i],s=t.Sheets[n],a=s?U3(s,e,i,t):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?Y3(s,e,i,t):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(W3(s,e,i,t)),r.join("")}function q3(i,e){e||(e={}),i.SSF||(i.SSF=hi(ht)),i.SSF&&(xo(),Ph(i.SSF),e.revssf=Mh(i.SSF),e.revssf[i.SSF[65535]]=0,e.ssf=i.SSF,e.cellXfs=[],Xs(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(L3(i,e)),t.push(B3()),t.push(""),t.push("");for(var r=0;r<i.SheetNames.length;++r)t.push(Ve("Worksheet",X3(r,e,i),{"ss:Name":jt(i.SheetNames[r])}));return t[2]=H3(i,e),t[3]=V3(i),Mi+Ve("Workbook",t.join(""),{xmlns:Kr.ss,"xmlns:o":Kr.o,"xmlns:x":Kr.x,"xmlns:ss":Kr.ss,"xmlns:dt":Kr.dt,"xmlns:html":Kr.html})}function K3(i){var e={},t=i.content;if(t.l=28,e.AnsiUserType=t.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=VI(t),t.length-t.l<=4)return e;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,e.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=UI(t),r=t.read_shift(4),r==0||r>40))return e;t.l-=4,e.Reserved2=t.read_shift(0,"lpwstr")}var j3=[60,1084,2066,2165,2175];function Q3(i,e,t,r,n){var s=r,a=[],o=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(i){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}a.push(o),t.l+=s;for(var c=rs(t,t.l),h=Td[c],l=0;h!=null&&j3.indexOf(c)>-1;)s=rs(t,t.l+2),l=t.l+4,c==2066?l+=4:(c==2165||c==2175)&&(l+=12),o=t.slice(l,t.l+4+s),a.push(o),t.l+=4+s,h=Td[c=rs(t,t.l)];var u=er(a);sr(u,0);var d=0;u.lens=[];for(var f=0;f<a.length;++f)u.lens.push(d),d+=a[f].length;if(u.length<r)throw"XLS Record 0x"+i.toString(16)+" Truncated: "+u.length+" < "+r;return e.f(u,u.length,n)}function Hn(i,e,t){if(i.t!=="z"&&i.XF){var r=0;try{r=i.z||i.XF.numFmtId||0,e.cellNF&&(i.z=ht[r])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{i.t==="e"?i.w=i.w||Cs[i.v]:r===0||r=="General"?i.t==="n"?(i.v|0)===i.v?i.w=i.v.toString(10):i.w=ul(i.v):i.w=Ea(i.v):i.w=_n(r,i.v,{date1904:!!t,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&r&&i.t=="n"&&Eo(ht[r]||String(r))){var n=aa(i.v);n&&(i.t="d",i.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function wc(i,e,t){return{v:i,ixfe:e,t}}function Z3(i,e){var t={opts:{}},r={},n=e.dense?[]:{},s={},a={},o=null,c=[],h="",l={},u,d="",f,p,m,v,_={},x=[],E,C,y=[],b=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},O=function(vt){return vt<8?la[vt]:vt<64&&b[vt-8]||la[vt]},W=function(vt,rt,fi){var _t=rt.XF.data;if(!(!_t||!_t.patternType||!fi||!fi.cellStyles)){rt.s={},rt.s.patternType=_t.patternType;var Wt;(Wt=gl(O(_t.icvFore)))&&(rt.s.fgColor={rgb:Wt}),(Wt=gl(O(_t.icvBack)))&&(rt.s.bgColor={rgb:Wt})}},G=function(vt,rt,fi){if(!(Pe>1)&&!(fi.sheetRows&&vt.r>=fi.sheetRows)){if(fi.cellStyles&&rt.XF&&rt.XF.data&&W(vt,rt,fi),delete rt.ixfe,delete rt.XF,u=vt,d=ut(vt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),vt.r<a.s.r&&(a.s.r=vt.r),vt.c<a.s.c&&(a.s.c=vt.c),vt.r+1>a.e.r&&(a.e.r=vt.r+1),vt.c+1>a.e.c&&(a.e.c=vt.c+1),fi.cellFormula&&rt.f){for(var _t=0;_t<x.length;++_t)if(!(x[_t][0].s.c>vt.c||x[_t][0].s.r>vt.r)&&!(x[_t][0].e.c<vt.c||x[_t][0].e.r<vt.r)){rt.F=Tt(x[_t][0]),(x[_t][0].s.c!=vt.c||x[_t][0].s.r!=vt.r)&&delete rt.f,rt.f&&(rt.f=""+pr(x[_t][1],a,vt,ie,Q));break}}fi.dense?(n[vt.r]||(n[vt.r]=[]),n[vt.r][vt.c]=rt):n[d]=rt}},Q={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(Q.password=e.password);var ne,xe=[],Ce=[],Fe=[],ke=[],Ze=!1,ie=[];ie.SheetNames=Q.snames,ie.sharedf=Q.sharedf,ie.arrayf=Q.arrayf,ie.names=[],ie.XTI=[];var Ee=0,Pe=0,U=0,Z=[],q=[],X;Q.codepage=1200,Dn(1200);for(var de=!1;i.l<i.length-1;){var Ie=i.l,we=i.read_shift(2);if(we===0&&Ee===10)break;var Re=i.l===i.length?0:i.read_shift(2),be=Td[we];if(be&&be.f){if(e.bookSheets&&Ee===133&&we!==133)break;if(Ee=we,be.r===2||be.r==12){var ue=i.read_shift(2);if(Re-=2,!Q.enc&&ue!==we&&((ue&255)<<8|ue>>8)!==we)throw new Error("rt mismatch: "+ue+"!="+we);be.r==12&&(i.l+=10,Re-=10)}var M={};if(we===10?M=be.f(i,Re,Q):M=Q3(we,be,i,Re,Q),Pe==0&&[9,521,1033,2057].indexOf(Ee)===-1)continue;switch(we){case 34:t.opts.Date1904=T.WBProps.date1904=M;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Q.enc||(i.l=0),Q.enc=M,!e.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=M;break;case 66:var it=Number(M);switch(it){case 21010:it=1200;break;case 32768:it=1e4;break;case 32769:it=1252;break}Dn(Q.codepage=it),de=!0;break;case 317:Q.rrtabid=M;break;case 25:Q.winlocked=M;break;case 439:t.opts.RefreshAll=M;break;case 12:t.opts.CalcCount=M;break;case 16:t.opts.CalcDelta=M;break;case 17:t.opts.CalcIter=M;break;case 13:t.opts.CalcMode=M;break;case 14:t.opts.CalcPrecision=M;break;case 95:t.opts.CalcSaveRecalc=M;break;case 15:Q.CalcRefMode=M;break;case 2211:t.opts.FullCalc=M;break;case 129:M.fDialog&&(n["!type"]="dialog"),M.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),M.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:y.push(M);break;case 430:ie.push([M]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(M);break;case 24:case 536:X={Name:M.Name,Ref:pr(M.rgce,a,null,ie,Q)},M.itab>0&&(X.Sheet=M.itab-1),ie.names.push(X),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(q[M.itab-1]={ref:Tt(M.rgce[0][0][1][2])});break;case 22:Q.ExternCount=M;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(M),ie.XTI=ie.XTI.concat(M);break;case 2196:if(Q.biff<8)break;X!=null&&(X.Comment=M[1]);break;case 18:n["!protect"]=M;break;case 19:M!==0&&Q.WTF&&console.error("Password verifier: "+M);break;case 133:s[M.pos]=M,Q.snames.push(M.name);break;case 10:{if(--Pe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,n["!ref"]=Tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var et=a.e.r;a.e.r=e.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Tt(a),a.e.r=et}a.e.r++,a.e.c++}xe.length>0&&(n["!merges"]=xe),Ce.length>0&&(n["!objects"]=Ce),Fe.length>0&&(n["!cols"]=Fe),ke.length>0&&(n["!rows"]=ke),T.Sheets.push(R)}h===""?l=n:r[h]=n,n=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),Q.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(Q.biff=5,de=!0,Dn(Q.codepage=28591)),Q.biff==8&&M.BIFFVer==0&&M.dt==16&&(Q.biff=2),Pe++)break;if(n=e.dense?[]:{},Q.biff<8&&!de&&(de=!0,Dn(Q.codepage=e.codepage||1252)),Q.biff<5||M.BIFFVer==0&&M.dt==4096){h===""&&(h="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:i.l-Re,name:h};s[he.pos]=he,Q.snames.push(h)}else h=(s[Ie]||{name:""}).name;M.dt==32&&(n["!type"]="chart"),M.dt==64&&(n["!type"]="macro"),xe=[],Ce=[],Q.arrayf=x=[],Fe=[],ke=[],Ze=!1,R={Hidden:(s[Ie]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(e.dense?(n[M.r]||[])[M.c]:n[ut({c:M.c,r:M.r})])&&++M.c,E={ixfe:M.ixfe,XF:y[M.ixfe]||{},v:M.val,t:"n"},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e);break;case 5:case 517:E={ixfe:M.ixfe,XF:y[M.ixfe],v:M.val,t:M.t},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e);break;case 638:E={ixfe:M.ixfe,XF:y[M.ixfe],v:M.rknum,t:"n"},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e);break;case 189:for(var Qe=M.c;Qe<=M.C;++Qe){var Te=M.rkrec[Qe-M.c][0];E={ixfe:Te,XF:y[Te],v:M.rkrec[Qe-M.c][1],t:"n"},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:Qe,r:M.r},E,e)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(E=wc(M.val,M.cell.ixfe,M.tt),E.XF=y[E.ixfe],e.cellFormula){var dt=M.formula;if(dt&&dt[0]&&dt[0][0]&&dt[0][0][0]=="PtgExp"){var wt=dt[0][0][1][0],Gt=dt[0][0][1][1],Ri=ut({r:wt,c:Gt});_[Ri]?E.f=""+pr(M.formula,a,M.cell,ie,Q):E.F=((e.dense?(n[wt]||[])[Gt]:n[Ri])||{}).F}else E.f=""+pr(M.formula,a,M.cell,ie,Q)}U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G(M.cell,E,e),o=M}break;case 7:case 519:if(o)o.val=M,E=wc(M,o.cell.ixfe,"s"),E.XF=y[E.ixfe],e.cellFormula&&(E.f=""+pr(o.formula,a,o.cell,ie,Q)),U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G(o.cell,E,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{x.push(M);var or=ut(M[0].s);if(f=e.dense?(n[M[0].s.r]||[])[M[0].s.c]:n[or],e.cellFormula&&f){if(!o||!or||!f)break;f.f=""+pr(M[1],a,M[0],ie,Q),f.F=Tt(M[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;_[ut(o.cell)]=M[0],f=e.dense?(n[o.cell.r]||[])[o.cell.c]:n[ut(o.cell)],(f||{}).f=""+pr(M[0],a,u,ie,Q)}}break;case 253:E=wc(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(E.h=c[M.isst].h),E.XF=y[E.ixfe],U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e);break;case 513:e.sheetStubs&&(E={ixfe:M.ixfe,XF:y[M.ixfe],t:"z"},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e));break;case 190:if(e.sheetStubs)for(var lr=M.c;lr<=M.C;++lr){var ni=M.ixfe[lr-M.c];E={ixfe:ni,XF:y[ni],t:"z"},U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:lr,r:M.r},E,e)}break;case 214:case 516:case 4:E=wc(M.val,M.ixfe,"s"),E.XF=y[E.ixfe],U>0&&(E.z=Z[E.ixfe>>8&63]),Hn(E,e,t.opts.Date1904),G({c:M.c,r:M.r},E,e);break;case 0:case 512:Pe===1&&(a=M);break;case 252:c=M;break;case 1054:if(Q.biff==4){Z[U++]=M[1];for(var $t=0;$t<U+163&&ht[$t]!=M[1];++$t);$t>=163&&ds(M[1],U+163)}else ds(M[1],M[0]);break;case 30:{Z[U++]=M;for(var He=0;He<U+163&&ht[He]!=M;++He);He>=163&&ds(M,U+163)}break;case 229:xe=xe.concat(M);break;case 93:Ce[M.cmo[0]]=Q.lastobj=M;break;case 438:Q.lastobj.TxO=M;break;case 127:Q.lastobj.ImData=M;break;case 440:for(v=M[0].s.r;v<=M[0].e.r;++v)for(m=M[0].s.c;m<=M[0].e.c;++m)f=e.dense?(n[v]||[])[m]:n[ut({c:m,r:v})],f&&(f.l=M[1]);break;case 2048:for(v=M[0].s.r;v<=M[0].e.r;++v)for(m=M[0].s.c;m<=M[0].e.c;++m)f=e.dense?(n[v]||[])[m]:n[ut({c:m,r:v})],f&&f.l&&(f.l.Tooltip=M[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;f=e.dense?(n[M[0].r]||[])[M[0].c]:n[ut(M[0])];var Di=Ce[M[2]];f||(e.dense?(n[M[0].r]||(n[M[0].r]=[]),f=n[M[0].r][M[0].c]={t:"z"}):f=n[ut(M[0])]={t:"z"},a.e.r=Math.max(a.e.r,M[0].r),a.s.r=Math.min(a.s.r,M[0].r),a.e.c=Math.max(a.e.c,M[0].c),a.s.c=Math.min(a.s.c,M[0].c)),f.c||(f.c=[]),p={a:M[1],t:Di.TxO.t},f.c.push(p)}break;case 2173:HP(y[M.ixfe],M.ext);break;case 125:{if(!Q.cellStyles)break;for(;M.e>=M.s;)Fe[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},Ze||(Ze=!0,Vf(M.w/256)),Us(Fe[M.e+1])}break;case 520:{var Nt={};M.level!=null&&(ke[M.r]=Nt,Nt.level=M.level),M.hidden&&(ke[M.r]=Nt,Nt.hidden=!0),M.hpt&&(ke[M.r]=Nt,Nt.hpt=M.hpt,Nt.hpx=ho(M.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ua(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=M;break;case 161:n["!margins"]||ua(n["!margins"]={}),n["!margins"].header=M.header,n["!margins"].footer=M.footer;break;case 574:M.RTL&&(T.Views[0].RTL=!0);break;case 146:b=M;break;case 2198:ne=M;break;case 140:C=M;break;case 442:h?R.CodeName=M||R.name:T.WBProps.CodeName=M||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+we.toString(16)),i.l+=Re}return t.SheetNames=Oi(s).sort(function(Li,vt){return Number(Li)-Number(vt)}).map(function(Li){return s[Li].name}),e.bookSheets||(t.Sheets=r),!t.SheetNames.length&&l["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=l)):t.Preamble=l,t.Sheets&&q.forEach(function(Li,vt){t.Sheets[t.SheetNames[vt]]["!autofilter"]=Li}),t.Strings=c,t.SSF=hi(ht),Q.enc&&(t.Encryption=Q.enc),ne&&(t.Themes=ne),t.Metadata={},C!==void 0&&(t.Metadata.Country=C),ie.names.length>0&&(T.Names=ie.names),t.Workbook=T,t}var Zo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function J3(i,e,t){var r=st.find(i,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var n=rm(r,Ed,Zo.DSI);for(var s in n)e[s]=n[s]}catch(h){if(t.WTF)throw h}var a=st.find(i,"/!SummaryInformation");if(a&&a.size>0)try{var o=rm(a,xd,Zo.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(h){if(t.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(x_(e.HeadingPairs,e.TitlesOfParts,e,t),delete e.HeadingPairs,delete e.TitlesOfParts)}function eB(i,e){var t=[],r=[],n=[],s=0,a,o=Fp(Ed,"n"),c=Fp(xd,"n");if(i.Props)for(a=Oi(i.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?r:n).push([a[s],i.Props[a[s]]]);if(i.Custprops)for(a=Oi(i.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(i.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?t:Object.prototype.hasOwnProperty.call(c,a[s])?r:n).push([a[s],i.Custprops[a[s]]]);var h=[];for(s=0;s<n.length;++s)A_.indexOf(n[s][0])>-1||E_.indexOf(n[s][0])>-1||n[s][1]!=null&&h.push(n[s]);r.length&&st.utils.cfb_add(e,"/SummaryInformation",nm(r,Zo.SI,c,xd)),(t.length||h.length)&&st.utils.cfb_add(e,"/DocumentSummaryInformation",nm(t,Zo.DSI,o,Ed,h.length?h:null,Zo.UDI))}function C1(i,e){e||(e={}),Kf(e),gf(),e.codepage&&mf(e.codepage);var t,r;if(i.FullPaths){if(st.find(i,"/encryption"))throw new Error("File is password-protected");t=st.find(i,"!CompObj"),r=st.find(i,"/Workbook")||st.find(i,"/Book")}else{switch(e.type){case"base64":i=Qr(sn(i));break;case"binary":i=Qr(i);break;case"buffer":break;case"array":Array.isArray(i)||(i=Array.prototype.slice.call(i));break}sr(i,0),r={content:i}}var n,s;if(t&&K3(t),e.bookProps&&!e.bookSheets)n={};else{var a=Ot?"buffer":"array";if(r&&r.content)n=Z3(r.content,e);else if((s=st.find(i,"PerfectOffice_MAIN"))&&s.content)n=ha.to_workbook(s.content,(e.type=a,e));else if((s=st.find(i,"NativeContent_MAIN"))&&s.content)n=ha.to_workbook(s.content,(e.type=a,e));else throw(s=st.find(i,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&i.FullPaths&&st.find(i,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=fN(i))}var o={};return i.FullPaths&&J3(i,o,e),n.Props=n.Custprops=o,e.bookFiles&&(n.cfb=i),n}function tB(i,e){var t=e||{},r=st.utils.cfb_new({root:"R"}),n="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":n="/Workbook",t.biff=8;break;case"biff5":n="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return st.utils.cfb_add(r,n,y1(i,t)),t.biff==8&&(i.Props||i.Custprops)&&eB(i,r),t.biff==8&&i.vbaraw&&pN(r,st.read(i.vbaraw,{type:typeof i.vbaraw=="string"?"binary":"buffer"})),r}var xl={0:{f:bL},1:{f:FL},2:{f:ZL},3:{f:UL},4:{f:LL},5:{f:KL},6:{f:r4},7:{f:$L},8:{f:h4},9:{f:c4},10:{f:o4},11:{f:l4},12:{f:NL},13:{f:e4},14:{f:zL},15:{f:HL},16:{f:p1},17:{f:s4},18:{f:XL},19:{f:If},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:s3},40:{},42:{},43:{f:rP},44:{f:tP},45:{f:aP},46:{f:lP},47:{f:oP},48:{},49:{f:kI},50:{},51:{f:WP},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:B_},62:{f:i4},63:{f:QP},64:{f:T4},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:C4},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RL},148:{f:kL,p:16},151:{f:g4},152:{},153:{f:i3},154:{},155:{},156:{f:e3},157:{},158:{},159:{T:1,f:_F},160:{T:-1},161:{T:1,f:Ra},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:u4},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:VP},336:{T:-1},337:{f:$P,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_d},357:{},358:{},359:{},360:{T:1},361:{},362:{f:L_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:v4},427:{f:_4},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:x4},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:p4},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_d},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:lN},633:{T:1},634:{T:-1},635:{T:1,f:aN},636:{T:-1},637:{f:DI},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:z4},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:A4},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Td={6:{f:Gu},10:{f:As},12:{f:$i},13:{f:$i},14:{f:Fi},15:{f:Fi},16:{f:gr},17:{f:Fi},18:{f:Fi},19:{f:$i},20:{f:hm},21:{f:hm},23:{f:L_},24:{f:dm},25:{f:Fi},26:{},27:{},28:{f:AD},29:{},34:{f:Fi},35:{f:um},38:{f:gr},39:{f:gr},40:{f:gr},41:{f:gr},42:{f:Fi},43:{f:Fi},47:{f:HF},49:{f:eD},51:{f:$i},60:{},61:{f:KR},64:{f:Fi},65:{f:JR},66:{f:$i},77:{},80:{},81:{},82:{},85:{f:$i},89:{},90:{},91:{},92:{f:BR},93:{f:ID},94:{},95:{f:Fi},96:{},97:{},99:{f:Fi},125:{f:B_},128:{f:mD},129:{f:VR},130:{f:$i},131:{f:Fi},132:{f:Fi},133:{f:UR},134:{},140:{f:BD},141:{f:$i},144:{},146:{f:UD},151:{},152:{},153:{},154:{},155:{},156:{f:$i},157:{},158:{},160:{f:qD},161:{f:GD},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uD},190:{f:dD},193:{f:As},197:{},198:{},199:{},200:{},201:{},202:{f:Fi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$i},220:{},221:{f:Fi},222:{},224:{f:pD},225:{f:LR},226:{f:As},227:{},229:{f:kD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zR},253:{f:iD},255:{f:$R},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:k_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Fi},353:{f:As},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xD},431:{f:Fi},432:{},433:{},434:{},437:{},438:{f:FD},439:{f:Fi},440:{f:PD},441:{},442:{f:Ml},443:{},444:{f:$i},445:{},446:{},448:{f:As},449:{f:qR,r:2},450:{f:As},512:{f:om},513:{f:XD},515:{f:_D},516:{f:nD},517:{f:cm},519:{f:KD},520:{f:YR},523:{},545:{f:fm},549:{f:am},566:{},574:{f:QR},638:{f:hD},659:{},1048:{},1054:{f:aD},1084:{},1212:{f:SD},2048:{f:MD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_c},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:As},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:WD,r:12},2173:{f:BP,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Fi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yD,r:12},2197:{},2198:{f:DP,r:12},2199:{},2200:{},2201:{},2202:{f:bD,r:12},2203:{f:As},2204:{},2205:{},2206:{},2207:{},2211:{f:XR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$i},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:$D},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:VD},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:om},1:{},2:{f:eF},3:{f:ZD},4:{f:QD},5:{f:cm},7:{f:iF},8:{},9:{f:_c},11:{},22:{f:$i},30:{f:lD},31:{},32:{},33:{f:fm},36:{},37:{f:am},50:{f:rF},62:{},52:{},67:{},68:{f:$i},69:{},86:{},126:{},127:{f:jD},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nF},223:{},234:{},354:{},421:{},518:{f:Gu},521:{f:_c},536:{f:dm},547:{f:um},561:{},579:{},1030:{f:Gu},1033:{f:_c},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(i,e,t,r){var n=e;if(!isNaN(n)){var s=r||(t||[]).length||0,a=i.next(4);a.write_shift(2,n),a.write_shift(2,s),s>0&&Af(t)&&i.push(t)}}function iB(i,e,t,r){var n=(t||[]).length||0;if(n<=8224)return Ue(i,e,t,n);var s=e;if(!isNaN(s)){for(var a=t.parts||[],o=0,c=0,h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;var l=i.next(4);for(l.write_shift(2,s),l.write_shift(2,h),i.push(t.slice(c,c+h)),c+=h;c<n;){for(l=i.next(4),l.write_shift(2,60),h=0;h+(a[o]||8224)<=8224;)h+=a[o]||8224,o++;l.write_shift(2,h),i.push(t.slice(c,c+h)),c+=h}}}function Vl(i,e,t){return i||(i=_e(7)),i.write_shift(2,e),i.write_shift(2,t),i.write_shift(2,0),i.write_shift(1,0),i}function rB(i,e,t,r){var n=_e(9);return Vl(n,i,e),O_(t,r||"b",n),n}function nB(i,e,t){var r=_e(8+2*t.length);return Vl(r,i,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function sB(i,e,t,r){if(e.v!=null)switch(e.t){case"d":case"n":var n=e.t=="d"?Qi(ci(e.v)):e.v;n==(n|0)&&n>=0&&n<65536?Ue(i,2,tF(t,r,n)):Ue(i,3,JD(t,r,n));return;case"b":case"e":Ue(i,5,rB(t,r,e.v,e.t));return;case"s":case"str":Ue(i,4,nB(t,r,(e.v||"").slice(0,255)));return}Ue(i,1,Vl(null,t,r))}function aB(i,e,t,r){var n=Array.isArray(e),s=Ht(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Tt(s)}for(var h=s.s.r;h<=s.e.r;++h){o=Ni(h);for(var l=s.s.c;l<=s.e.c;++l){h===s.s.r&&(c[l]=wi(l)),a=c[l]+o;var u=n?(e[h]||[])[l]:e[a];u&&sB(i,u,h,l)}}}function oB(i,e){for(var t=e||{},r=zr(),n=0,s=0;s<i.SheetNames.length;++s)i.SheetNames[s]==t.sheet&&(n=s);if(n==0&&t.sheet&&i.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ue(r,t.biff==4?1033:t.biff==3?521:9,Lf(i,16,t)),aB(r,i.Sheets[i.SheetNames[n]],n,t),Ue(r,10),r.end()}function lB(i,e,t){Ue(i,49,tD({sz:12,name:"Arial"},t))}function cB(i,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&Ue(i,1054,oD(n,e[n],t))})}function hB(i,e){var t=_e(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ue(i,2151,t),t=_e(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),P_(Ht(e["!ref"]||"A1"),t),t.write_shift(4,4),Ue(i,2152,t)}function uB(i,e){for(var t=0;t<16;++t)Ue(i,224,lm({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Ue(i,224,lm(r,0,e))})}function dB(i,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];Ue(i,440,ND(r)),r[1].Tooltip&&Ue(i,2048,LD(r))}delete e["!links"]}function fB(i,e){if(e){var t=0;e.forEach(function(r,n){++t<=256&&r&&Ue(i,125,zD(Uh(n,r),n))})}}function pB(i,e,t,r,n){var s=16+Xs(n.cellXfs,e,n);if(e.v==null&&!e.bf){Ue(i,513,ya(t,r,s));return}if(e.bf)Ue(i,6,VM(e,t,r,n,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Qi(ci(e.v)):e.v;Ue(i,515,ED(t,r,a,s));break;case"b":case"e":Ue(i,517,vD(t,r,e.v,s,n,e.t));break;case"s":case"str":if(n.bookSST){var o=$f(n.Strings,e.v,n.revStrings);Ue(i,253,rD(t,r,o,s))}else Ue(i,516,sD(t,r,(e.v||"").slice(0,255),s,n));break;default:Ue(i,513,ya(t,r,s))}}function mB(i,e,t){var r=zr(),n=t.SheetNames[i],s=t.Sheets[n]||{},a=(t||{}).Workbook||{},o=(a.Sheets||[])[i]||{},c=Array.isArray(s),h=e.biff==8,l,u="",d=[],f=Ht(s["!ref"]||"A1"),p=h?65536:16384;if(f.e.c>255||f.e.r>=p){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}Ue(r,2057,Lf(t,16,e)),Ue(r,13,pn(1)),Ue(r,12,pn(100)),Ue(r,15,Ar(!0)),Ue(r,17,Ar(!1)),Ue(r,16,wa(.001)),Ue(r,95,Ar(!0)),Ue(r,42,Ar(!1)),Ue(r,43,Ar(!1)),Ue(r,130,pn(1)),Ue(r,128,gD()),Ue(r,131,Ar(!1)),Ue(r,132,Ar(!1)),h&&fB(r,s["!cols"]),Ue(r,512,cD(f,e)),h&&(s["!links"]=[]);for(var m=f.s.r;m<=f.e.r;++m){u=Ni(m);for(var v=f.s.c;v<=f.e.c;++v){m===f.s.r&&(d[v]=wi(v)),l=d[v]+u;var _=c?(s[m]||[])[v]:s[l];_&&(pB(r,_,m,v,e),h&&_.l&&s["!links"].push([l,_.l]))}}var x=o.CodeName||o.name||n;return h&&Ue(r,574,ZR((a.Views||[])[0])),h&&(s["!merges"]||[]).length&&Ue(r,229,OD(s["!merges"])),h&&dB(r,s),Ue(r,442,I_(x)),h&&hB(r,s),Ue(r,10),r.end()}function gB(i,e,t){var r=zr(),n=(i||{}).Workbook||{},s=n.Sheets||[],a=n.WBProps||{},o=t.biff==8,c=t.biff==5;if(Ue(r,2057,Lf(i,5,t)),t.bookType=="xla"&&Ue(r,135),Ue(r,225,o?pn(1200):null),Ue(r,193,vR(2)),c&&Ue(r,191),c&&Ue(r,192),Ue(r,226),Ue(r,92,HR("SheetJS",t)),Ue(r,66,pn(o?1200:1252)),o&&Ue(r,353,pn(0)),o&&Ue(r,448),Ue(r,317,YD(i.SheetNames.length)),o&&i.vbaraw&&Ue(r,211),o&&i.vbaraw){var h=a.CodeName||"ThisWorkbook";Ue(r,442,I_(h))}Ue(r,156,pn(17)),Ue(r,25,Ar(!1)),Ue(r,18,Ar(!1)),Ue(r,19,pn(0)),o&&Ue(r,431,Ar(!1)),o&&Ue(r,444,pn(0)),Ue(r,61,jR()),Ue(r,64,Ar(!1)),Ue(r,141,pn(0)),Ue(r,34,Ar(q4(i)=="true")),Ue(r,14,Ar(!0)),o&&Ue(r,439,Ar(!1)),Ue(r,218,pn(0)),lB(r,i,t),cB(r,i.SSF,t),uB(r,t),o&&Ue(r,352,Ar(!1));var l=r.end(),u=zr();o&&Ue(u,140,HD()),o&&t.Strings&&iB(u,252,GR(t.Strings)),Ue(u,10);var d=u.end(),f=zr(),p=0,m=0;for(m=0;m<i.SheetNames.length;++m)p+=(o?12:11)+(o?2:1)*i.SheetNames[m].length;var v=l.length+p+d.length;for(m=0;m<i.SheetNames.length;++m){var _=s[m]||{};Ue(f,133,WR({pos:v,hs:_.Hidden||0,dt:0,name:i.SheetNames[m]},t)),v+=e[m].length}var x=f.end();if(p!=x.length)throw new Error("BS8 "+p+" != "+x.length);var E=[];return l.length&&E.push(l),x.length&&E.push(x),d.length&&E.push(d),er(E)}function vB(i,e){var t=e||{},r=[];i&&!i.SSF&&(i.SSF=hi(ht)),i&&i.SSF&&(xo(),Ph(i.SSF),t.revssf=Mh(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jf(t),t.cellXfs=[],Xs(t.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={});for(var n=0;n<i.SheetNames.length;++n)r[r.length]=mB(n,t,i);return r.unshift(gB(i,r,t)),er(r)}function y1(i,e){for(var t=0;t<=i.SheetNames.length;++t){var r=i.Sheets[i.SheetNames[t]];if(!(!r||!r["!ref"])){var n=Gr(r["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+i.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return vB(i,e);case 4:case 3:case 2:return oB(i,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function ym(i,e){var t=e||{},r=t.dense?[]:{};i=i.replace(/<!--.*?-->/g,"");var n=i.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=i.match(/<\/table/i),a=n.index,o=s&&s.index||i.length,c=tI(i.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,l=0,u=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(a=0;a<c.length;++a){var m=c[a].trim(),v=m.slice(0,3).toLowerCase();if(v=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}l=0;continue}if(!(v!="<td"&&v!="<th")){var _=m.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var x=_[o].trim();if(x.match(/<t[dh]/i)){for(var E=x,C=0;E.charAt(0)=="<"&&(C=E.indexOf(">"))>-1;)E=E.slice(C+1);for(var y=0;y<p.length;++y){var b=p[y];b.s.c==l&&b.s.r<h&&h<=b.e.r&&(l=b.e.c+1,y=-1)}var T=gt(x.slice(0,x.indexOf(">")));d=T.colspan?+T.colspan:1,((u=+T.rowspan)>1||d>1)&&p.push({s:{r:h,c:l},e:{r:h+(u||1)-1,c:l+d-1}});var R=T.t||T["data-t"]||"";if(!E.length){l+=d;continue}if(E=Xv(E),f.s.r>h&&(f.s.r=h),f.e.r<h&&(f.e.r=h),f.s.c>l&&(f.s.c=l),f.e.c<l&&(f.e.c=l),!E.length){l+=d;continue}var O={t:"s",v:E};t.raw||!E.trim().length||R=="s"||(E==="TRUE"?O={t:"b",v:!0}:E==="FALSE"?O={t:"b",v:!1}:isNaN(Pn(E))?isNaN(lo(E).getDate())||(O={t:"d",v:ci(E)},t.cellDates||(O={t:"n",v:Qi(O.v)}),O.z=t.dateNF||ht[14]):O={t:"n",v:Pn(E)}),t.dense?(r[h]||(r[h]=[]),r[h][l]=O):r[ut({r:h,c:l})]=O,l+=d}}}}return r["!ref"]=Tt(f),p.length&&(r["!merges"]=p),r}function _B(i,e,t,r){for(var n=i["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,h=0;h<n.length;++h)if(!(n[h].s.r>t||n[h].s.c>a)&&!(n[h].e.r<t||n[h].e.c<a)){if(n[h].s.r<t||n[h].s.c<a){o=-1;break}o=n[h].e.r-n[h].s.r+1,c=n[h].e.c-n[h].s.c+1;break}if(!(o<0)){var l=ut({r:t,c:a}),u=r.dense?(i[t]||[])[a]:i[l],d=u&&u.v!=null&&(u.h||Sf(u.w||(_s(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),c>1&&(f.colspan=c),r.editable?d='<span contenteditable="true">'+d+"</span>":u&&(f["data-t"]=u&&u.t||"z",u.v!=null&&(f["data-v"]=u.v),u.z!=null&&(f["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),f.id=(r.id||"sjs")+"-"+l,s.push(Ve("td",d,f))}}var p="<tr>";return p+s.join("")+"</tr>"}var EB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xB="</body></html>";function wB(i,e){var t=i.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ys(ym(t[0],e),e);var r=Jf();return t.forEach(function(n,s){e0(r,ym(n,e),"Sheet"+(s+1))}),r}function CB(i,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function S1(i,e){var t=e||{},r=t.header!=null?t.header:EB,n=t.footer!=null?t.footer:xB,s=[r],a=Gr(i["!ref"]);t.dense=Array.isArray(i),s.push(CB(i,a,t));for(var o=a.s.r;o<=a.e.r;++o)s.push(_B(i,a,o,t));return s.push("</table>"+n),s.join("")}function b1(i,e,t){var r=t||{},n=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")n=r.origin;else{var a=typeof r.origin=="string"?Ci(r.origin):r.origin;n=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,o.length),h={s:{r:0,c:0},e:{r:n,c:s}};if(i["!ref"]){var l=Gr(i["!ref"]);h.s.r=Math.min(h.s.r,l.s.r),h.s.c=Math.min(h.s.c,l.s.c),h.e.r=Math.max(h.e.r,l.e.r),h.e.c=Math.max(h.e.c,l.e.c),n==-1&&(h.e.r=n=l.e.r+1)}var u=[],d=0,f=i["!rows"]||(i["!rows"]=[]),p=0,m=0,v=0,_=0,x=0,E=0;for(i["!cols"]||(i["!cols"]=[]);p<o.length&&m<c;++p){var C=o[p];if(Sm(C)){if(r.display)continue;f[m]={hidden:!0}}var y=C.children;for(v=_=0;v<y.length;++v){var b=y[v];if(!(r.display&&Sm(b))){var T=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):Xv(b.innerHTML),R=b.getAttribute("data-z")||b.getAttribute("z");for(d=0;d<u.length;++d){var O=u[d];O.s.c==_+s&&O.s.r<m+n&&m+n<=O.e.r&&(_=O.e.c+1-s,d=-1)}E=+b.getAttribute("colspan")||1,((x=+b.getAttribute("rowspan")||1)>1||E>1)&&u.push({s:{r:m+n,c:_+s},e:{r:m+n+(x||1)-1,c:_+s+(E||1)-1}});var W={t:"s",v:T},G=b.getAttribute("data-t")||b.getAttribute("t")||"";T!=null&&(T.length==0?W.t=G||"z":r.raw||T.trim().length==0||G=="s"||(T==="TRUE"?W={t:"b",v:!0}:T==="FALSE"?W={t:"b",v:!1}:isNaN(Pn(T))?isNaN(lo(T).getDate())||(W={t:"d",v:ci(T)},r.cellDates||(W={t:"n",v:Qi(W.v)}),W.z=r.dateNF||ht[14]):W={t:"n",v:Pn(T)})),W.z===void 0&&R!=null&&(W.z=R);var Q="",ne=b.getElementsByTagName("A");if(ne&&ne.length)for(var xe=0;xe<ne.length&&!(ne[xe].hasAttribute("href")&&(Q=ne[xe].getAttribute("href"),Q.charAt(0)!="#"));++xe);Q&&Q.charAt(0)!="#"&&(W.l={Target:Q}),r.dense?(i[m+n]||(i[m+n]=[]),i[m+n][_+s]=W):i[ut({c:_+s,r:m+n})]=W,h.e.c<_+s&&(h.e.c=_+s),_+=E}}++m}return u.length&&(i["!merges"]=(i["!merges"]||[]).concat(u)),h.e.r=Math.max(h.e.r,m-1+n),i["!ref"]=Tt(h),m>=c&&(i["!fullref"]=Tt((h.e.r=o.length-p+m-1+n,h))),i}function T1(i,e){var t=e||{},r=t.dense?[]:{};return b1(r,i,e)}function yB(i,e){return Ys(T1(i,e),e)}function Sm(i){var e="",t=SB(i);return t&&(e=t(i).getPropertyValue("display")),e||(e=i.style&&i.style.display),e==="none"}function SB(i){return i.ownerDocument.defaultView&&typeof i.ownerDocument.defaultView.getComputedStyle=="function"?i.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function bB(i){var e=i.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Bt(e.replace(/<[^>]*>/g,""));return[t]}var bm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function A1(i,e){var t=e||{},r=bf(i),n=[],s,a,o={name:""},c="",h=0,l,u,d={},f=[],p=t.dense?[]:{},m,v,_={value:""},x="",E=0,C=[],y=-1,b=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,O={},W=[],G={},Q=0,ne=0,xe=[],Ce=1,Fe=1,ke=[],Ze={Names:[]},ie={},Ee=["",""],Pe=[],U={},Z="",q=0,X=!1,de=!1,Ie=0;for(pl.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=pl.exec(r);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?p["!ref"]=Tt(T):p["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=T.e.r&&(p["!fullref"]=p["!ref"],T.e.r=t.sheetRows-1,p["!ref"]=Tt(T)),W.length&&(p["!merges"]=W),xe.length&&(p["!rows"]=xe),l.name=l.||l.name,typeof JSON<"u"&&JSON.stringify(l),f.push(l.name),d[l.name]=p,de=!1):m[0].charAt(m[0].length-2)!=="/"&&(l=gt(m[0],!1),y=b=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,p=t.dense?[]:{},W=[],xe=[],de=!0);break;case"table-row-group":m[1]==="/"?--R:++R;break;case"table-row":case"":if(m[1]==="/"){y+=Ce,Ce=1;break}if(u=gt(m[0],!1),u.?y=u.-1:y==-1&&(y=0),Ce=+u["number-rows-repeated"]||1,Ce<10)for(Ie=0;Ie<Ce;++Ie)R>0&&(xe[y+Ie]={level:R});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,t.sheetStubs&&(t.dense?(p[y]||(p[y]=[]),p[y][b]={t:"z"}):p[ut({r:y,c:b})]={t:"z"}),x="",C=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,_=gt(m[0],!1),Fe=parseInt(_["number-columns-repeated"]||"1",10),v={t:"z",v:null},_.formula&&t.cellFormula!=!1&&(v.f=xm(Bt(_.formula))),(_.||_["value-type"])=="string"&&(v.t="s",v.v=Bt(_["string-value"]||""),t.dense?(p[y]||(p[y]=[]),p[y][b]=v):p[ut({r:y,c:b})]=v),b+=Fe-1;else if(m[1]!=="/"){++b,x="",E=0,C=[],Fe=1;var we=Ce?y+Ce-1:y;if(b>T.e.c&&(T.e.c=b),b<T.s.c&&(T.s.c=b),y<T.s.r&&(T.s.r=y),we>T.e.r&&(T.e.r=we),_=gt(m[0],!1),Pe=[],U={},v={t:_.||_["value-type"],v:null},t.cellFormula)if(_.formula&&(_.formula=Bt(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(Q=parseInt(_["number-matrix-rows-spanned"],10)||0,ne=parseInt(_["number-matrix-columns-spanned"],10)||0,G={s:{r:y,c:b},e:{r:y+Q-1,c:b+ne-1}},v.F=Tt(G),ke.push([G,v.F])),_.formula)v.f=xm(_.formula);else for(Ie=0;Ie<ke.length;++Ie)y>=ke[Ie][0].s.r&&y<=ke[Ie][0].e.r&&b>=ke[Ie][0].s.c&&b<=ke[Ie][0].e.c&&(v.F=ke[Ie][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(Q=parseInt(_["number-rows-spanned"],10)||0,ne=parseInt(_["number-columns-spanned"],10)||0,G={s:{r:y,c:b},e:{r:y+Q-1,c:b+ne-1}},W.push(G)),_["number-columns-repeated"]&&(Fe=parseInt(_["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=li(_["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(_.value);break;case"percentage":v.t="n",v.v=parseFloat(_.value);break;case"currency":v.t="n",v.v=parseFloat(_.value);break;case"date":v.t="d",v.v=ci(_["date-value"]),t.cellDates||(v.t="n",v.v=Qi(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=ZO(_["time-value"])/86400,t.cellDates&&(v.t="d",v.v=Lh(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(_.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",_["string-value"]!=null&&(x=Bt(_["string-value"]),C=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(X=!1,v.t==="s"&&(v.v=x||"",C.length&&(v.R=C),X=E==0),ie.Target&&(v.l=ie),Pe.length>0&&(v.c=Pe,Pe=[]),x&&t.cellText!==!1&&(v.w=x),X&&(v.t="z",delete v.v),(!X||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=y))for(var Re=0;Re<Ce;++Re){if(Fe=parseInt(_["number-columns-repeated"]||"1",10),t.dense)for(p[y+Re]||(p[y+Re]=[]),p[y+Re][b]=Re==0?v:hi(v);--Fe>0;)p[y+Re][b+Fe]=hi(v);else for(p[ut({r:y+Re,c:b})]=v;--Fe>0;)p[ut({r:y+Re,c:b+Fe})]=hi(v);T.e.c<=b&&(T.e.c=b)}Fe=parseInt(_["number-columns-repeated"]||"1",10),b+=Fe-1,Fe=0,v={},x="",C=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s;U.t=x,C.length&&(U.R=C),U.a=Z,Pe.push(U)}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);Z="",q=0,x="",E=0,C=[];break;case"creator":m[1]==="/"?Z=r.slice(q,m.index):q=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&n.push([m[3],!1]);x="",E=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(O[o.name]=c,(s=n.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=gt(m[0],!1),n.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":a=gt(m[0],!1),c+=bm[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":a=gt(m[0],!1),c+=bm[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=r.slice(h,m.index);break}else h=m.index+m[0].length;break;case"named-range":a=gt(m[0],!1),Ee=$u(a["cell-range-address"]);var be={Name:a.name,Ref:Ee[0]+"!"+Ee[1]};de&&(be.Sheet=f.length),Ze.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(m[1]==="/"&&(!_||!_["string-value"])){var ue=bB(r.slice(E,m.index));x=(x.length>0?x+`
`:"")+ue[0]}else gt(m[0],!1),E=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{Ee=$u(gt(m[0])["target-range-address"]),d[Ee[0]]["!autofilter"]={ref:Ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(ie=gt(m[0],!1),!ie.href)break;ie.Target=Bt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ee=$u(ie.Target.slice(1)),ie.Target="#"+Ee[0]+"!"+Ee[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(m)}}var M={Sheets:d,SheetNames:f,Workbook:Ze};return t.bookSheets&&delete M.Sheets,M}function Tm(i,e){e=e||{},fn(i,"META-INF/manifest.xml")&&ZI(Gi(i,"META-INF/manifest.xml"),e);var t=Zr(i,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=A1(Qt(t),e);return fn(i,"meta.xml")&&(r.Props=v_(Gi(i,"meta.xml"))),r}function Am(i,e){return A1(i,e)}var TB=function(){var i=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+fl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+i+"</office:document-styles>";return function(){return Mi+e}}(),km=function(){var i=function(s){return jt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,r=function(s,a,o){var c=[];c.push('      <table:table table:name="'+jt(a.SheetNames[o])+`" table:style-name="ta1">
`);var h=0,l=0,u=Gr(s["!ref"]||"A1"),d=s["!merges"]||[],f=0,p=Array.isArray(s);if(s["!cols"])for(l=0;l<=u.e.c;++l)c.push("        <table:table-column"+(s["!cols"][l]?' table:style-name="co'+s["!cols"][l].ods+'"':"")+`></table:table-column>
`);var m="",v=s["!rows"]||[];for(h=0;h<u.s.r;++h)m=v[h]?' table:style-name="ro'+v[h].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;h<=u.e.r;++h){for(m=v[h]?' table:style-name="ro'+v[h].ods+'"':"",c.push("        <table:table-row"+m+`>
`),l=0;l<u.s.c;++l)c.push(e);for(;l<=u.e.c;++l){var _=!1,x={},E="";for(f=0;f!=d.length;++f)if(!(d[f].s.c>l)&&!(d[f].s.r>h)&&!(d[f].e.c<l)&&!(d[f].e.r<h)){(d[f].s.c!=l||d[f].s.r!=h)&&(_=!0),x["table:number-columns-spanned"]=d[f].e.c-d[f].s.c+1,x["table:number-rows-spanned"]=d[f].e.r-d[f].s.r+1;break}if(_){c.push(t);continue}var C=ut({r:h,c:l}),y=p?(s[h]||[])[l]:s[C];if(y&&y.f&&(x["table:formula"]=jt(YM(y.f)),y.F&&y.F.slice(0,C.length)==C)){var b=Gr(y.F);x["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,x["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!y){c.push(e);continue}switch(y.t){case"b":E=y.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=y.v?"true":"false";break;case"n":E=y.w||String(y.v||0),x["office:value-type"]="float",x["office:value"]=y.v||0;break;case"s":case"str":E=y.v==null?"":y.v,x["office:value-type"]="string";break;case"d":E=y.w||ci(y.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=ci(y.v).toISOString(),x["table:style-name"]="ce1";break;default:c.push(e);continue}var T=i(E);if(y.l&&y.l.Target){var R=y.l.Target;R=R.charAt(0)=="#"?"#"+XM(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),T=Ve("text:a",T,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+Ve("table:table-cell",Ve("text:p",T,{}),x)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var l=0;l<h["!cols"].length;++l)if(h["!cols"][l]){var u=h["!cols"][l];if(u.width==null&&u.wpx==null&&u.wch==null)continue;Us(u),u.ods=o;var d=h["!cols"][l].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(h){return a.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var l=0;l<h["!rows"].length;++l)if(h["!rows"][l]){h["!rows"][l].ods=c;var u=h["!rows"][l].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Mi],h=fl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),l=fl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+h+l+`>
`),c.push(g_().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+h+`>
`),n(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var u=0;u!=a.SheetNames.length;++u)c.push(r(a.Sheets[a.SheetNames[u]],a,u));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function k1(i,e){if(e.bookType=="fods")return km(i,e);var t=wf(),r="",n=[],s=[];return r="mimetype",At(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",At(t,r,km(i,e)),n.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",At(t,r,TB(i,e)),n.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",At(t,r,Mi+g_()),n.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",At(t,r,tR(s)),n.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",At(t,r,JI(n)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Sa(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}function Ad(i){return typeof TextDecoder<"u"?new TextDecoder().decode(i):Qt($s(i))}function AB(i){return typeof TextEncoder<"u"?new TextEncoder().encode(i):Qr(Gn(i))}function kB(i,e){e:for(var t=0;t<=i.length-e.length;++t){for(var r=0;r<e.length;++r)if(i[t+r]!=e[r])continue e;return!0}return!1}function zs(i){var e=i.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(e),r=0;return i.forEach(function(n){t.set(n,r),r+=n.length}),t}function Om(i){return i-=i>>1&1431655765,i=(i&858993459)+(i>>2&858993459),(i+(i>>4)&252645135)*16843009>>>24}function OB(i,e){for(var t=(i[e+15]&127)<<7|i[e+14]>>1,r=i[e+14]&1,n=e+13;n>=e;--n)r=r*256+i[n];return(i[e+15]&128?-r:r)*Math.pow(10,t-6176)}function IB(i,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,n=t/Math.pow(10,r-6176);i[e+15]|=r>>7,i[e+14]|=(r&127)<<1;for(var s=0;n>=1;++s,n/=256)i[e+s]=n&255;i[e+15]|=t>=0?0:128}function wl(i,e){var t=e?e[0]:0,r=i[t]&127;e:if(i[t++]>=128&&(r|=(i[t]&127)<<7,i[t++]<128||(r|=(i[t]&127)<<14,i[t++]<128)||(r|=(i[t]&127)<<21,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,28),++t,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,35),++t,i[t++]<128)||(r+=(i[t]&127)*Math.pow(2,42),++t,i[t++]<128)))break e;return e&&(e[0]=t),r}function qt(i){var e=new Uint8Array(7);e[0]=i&127;var t=1;e:if(i>127){if(e[t-1]|=128,e[t]=i>>7&127,++t,i<=16383||(e[t-1]|=128,e[t]=i>>14&127,++t,i<=2097151)||(e[t-1]|=128,e[t]=i>>21&127,++t,i<=268435455)||(e[t-1]|=128,e[t]=i/256>>>21&127,++t,i<=34359738367)||(e[t-1]|=128,e[t]=i/65536>>>21&127,++t,i<=4398046511103))break e;e[t-1]|=128,e[t]=i/16777216>>>21&127,++t}return e.slice(0,t)}function Ai(i){var e=0,t=i[e]&127;e:if(i[e++]>=128){if(t|=(i[e]&127)<<7,i[e++]<128||(t|=(i[e]&127)<<14,i[e++]<128)||(t|=(i[e]&127)<<21,i[e++]<128))break e;t|=(i[e]&127)<<28}return t}function Ut(i){for(var e=[],t=[0];t[0]<i.length;){var r=t[0],n=wl(i,t),s=n&7;n=Math.floor(n/8);var a=0,o;if(n==0)break;switch(s){case 0:{for(var c=t[0];i[t[0]++]>=128;);o=i.slice(c,t[0])}break;case 5:a=4,o=i.slice(t[0],t[0]+a),t[0]+=a;break;case 1:a=8,o=i.slice(t[0],t[0]+a),t[0]+=a;break;case 2:a=wl(i,t),o=i.slice(t[0],t[0]+a),t[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(r))}var h={data:o,type:s};e[n]==null?e[n]=[h]:e[n].push(h)}return e}function nr(i){var e=[];return i.forEach(function(t,r){t.forEach(function(n){n.data&&(e.push(qt(r*8+n.type)),n.type==2&&e.push(qt(n.data.length)),e.push(n.data))})}),zs(e)}function qf(i,e){return(i==null?void 0:i.map(function(t){return e(t.data)}))||[]}function cn(i){for(var e,t=[],r=[0];r[0]<i.length;){var n=wl(i,r),s=Ut(i.slice(r[0],r[0]+n));r[0]+=n;var a={id:Ai(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Ut(o.data),h=Ai(c[3][0].data);a.messages.push({meta:c,data:i.slice(r[0],r[0]+h)}),r[0]+=h}),(e=s[3])!=null&&e[0]&&(a.merge=Ai(s[3][0].data)>>>0>0),t.push(a)}return t}function Ua(i){var e=[];return i.forEach(function(t){var r=[];r[1]=[{data:qt(t.id),type:0}],r[2]=[],t.merge!=null&&(r[3]=[{data:qt(+!!t.merge),type:0}]);var n=[];t.messages.forEach(function(a){n.push(a.data),a.meta[3]=[{type:0,data:qt(a.data.length)}],r[2].push({data:nr(a.meta),type:2})});var s=nr(r);e.push(qt(s.length)),e.push(s),n.forEach(function(a){return e.push(a)})}),zs(e)}function RB(i,e){if(i!=0)throw new Error("Unexpected Snappy chunk type ".concat(i));for(var t=[0],r=wl(e,t),n=[];t[0]<e.length;){var s=e[t[0]]&3;if(s==0){var a=e[t[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[t[0]],o>1&&(a|=e[t[0]+1]<<8),o>2&&(a|=e[t[0]+2]<<16),o>3&&(a|=e[t[0]+3]<<24),a>>>=0,a++,t[0]+=o}n.push(e.slice(t[0],t[0]+a)),t[0]+=a;continue}else{var c=0,h=0;if(s==1?(h=(e[t[0]]>>2&7)+4,c=(e[t[0]++]&224)<<3,c|=e[t[0]++]):(h=(e[t[0]++]>>2)+1,s==2?(c=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(c=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),n=[zs(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(h>=c)for(n.push(n[0].slice(-c)),h-=c;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-c,-c+h))}}var l=zs(n);if(l.length!=r)throw new Error("Unexpected length: ".concat(l.length," != ").concat(r));return l}function hn(i){for(var e=[],t=0;t<i.length;){var r=i[t++],n=i[t]|i[t+1]<<8|i[t+2]<<16;t+=3,e.push(RB(r,i.slice(t,t+n))),t+=n}if(t!==i.length)throw new Error("data is not a valid framed stream!");return zs(e)}function Wa(i){for(var e=[],t=0;t<i.length;){var r=Math.min(i.length-t,268435455),n=new Uint8Array(4);e.push(n);var s=qt(r),a=s.length;e.push(s),r<=60?(a++,e.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(i.slice(t,t+r)),a+=r,n[0]=0,n[1]=a&255,n[2]=a>>8&255,n[3]=a>>16&255,t+=r}return zs(e)}function DB(i,e,t,r){var n=Sa(i),s=n.getUint32(4,!0),a=(r>1?12:8)+Om(s&(r>1?3470:398))*4,o=-1,c=-1,h=NaN,l=new Date(2001,0,1);s&512&&(o=n.getUint32(a,!0),a+=4),a+=Om(s&(r>1?12288:4096))*4,s&16&&(c=n.getUint32(a,!0),a+=4),s&32&&(h=n.getFloat64(a,!0),a+=8),s&64&&(l.setTime(l.getTime()+n.getFloat64(a,!0)*1e3),a+=8);var u;switch(i[2]){case 0:break;case 2:u={t:"n",v:h};break;case 3:u={t:"s",v:e[c]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:h>0};break;case 7:u={t:"n",v:h/86400};break;case 8:u={t:"e",v:0};break;case 9:if(o>-1)u={t:"s",v:t[o]};else if(c>-1)u={t:"s",v:e[c]};else if(!isNaN(h))u={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(i.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(i.slice(0,4)))}return u}function FB(i,e,t){var r=Sa(i),n=r.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,h=NaN,l=new Date(2001,0,1);n&1&&(c=OB(i,s),s+=16),n&2&&(h=r.getFloat64(s,!0),s+=8),n&4&&(l.setTime(l.getTime()+r.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=r.getUint32(s,!0),s+=4),n&16&&(a=r.getUint32(s,!0),s+=4);var u;switch(i[1]){case 0:break;case 2:u={t:"n",v:c};break;case 3:u={t:"s",v:e[o]};break;case 5:u={t:"d",v:l};break;case 6:u={t:"b",v:h>0};break;case 7:u={t:"n",v:h/86400};break;case 8:u={t:"e",v:0};break;case 9:if(a>-1)u={t:"s",v:t[a]};else throw new Error("Unsupported cell type ".concat(i[1]," : ").concat(n&31," : ").concat(i.slice(0,4)));break;case 10:u={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(i[1]," : ").concat(n&31," : ").concat(i.slice(0,4)))}return u}function Xu(i,e){var t=new Uint8Array(32),r=Sa(t),n=12,s=0;switch(t[0]=5,i.t){case"n":t[1]=2,IB(t,n,i.v),s|=1,n+=16;break;case"b":t[1]=6,r.setFloat64(n,i.v?1:0,!0),s|=2,n+=8;break;case"s":if(e.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));t[1]=3,r.setUint32(n,e.indexOf(i.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+i.t}return r.setUint32(8,s,!0),t.slice(0,n)}function qu(i,e){var t=new Uint8Array(32),r=Sa(t),n=12,s=0;switch(t[0]=3,i.t){case"n":t[2]=2,r.setFloat64(n,i.v,!0),s|=32,n+=8;break;case"b":t[2]=6,r.setFloat64(n,i.v?1:0,!0),s|=32,n+=8;break;case"s":if(e.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));t[2]=3,r.setUint32(n,e.indexOf(i.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+i.t}return r.setUint32(4,s,!0),t.slice(0,n)}function PB(i,e,t){switch(i[0]){case 0:case 1:case 2:case 3:return DB(i,e,t,i[0]);case 5:return FB(i,e,t);default:throw new Error("Unsupported payload version ".concat(i[0]))}}function fr(i){var e=Ut(i);return wl(e[1][0].data)}function Im(i,e){var t=Ut(e.data),r=Ai(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(a){var o=Ut(a.data),c=Ai(o[1][0].data)>>>0;switch(r){case 1:s[c]=Ad(o[3][0].data);break;case 8:{var h=i[fr(o[9][0].data)][0],l=Ut(h.data),u=i[fr(l[1][0].data)][0],d=Ai(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var f=Ut(u.data);s[c]=f[3].map(function(p){return Ad(p.data)}).join("")}break}}),s}function NB(i,e){var t,r,n,s,a,o,c,h,l,u,d,f,p,m,v=Ut(i),_=Ai(v[1][0].data)>>>0,x=Ai(v[2][0].data)>>>0,E=((r=(t=v[8])==null?void 0:t[0])==null?void 0:r.data)&&Ai(v[8][0].data)>0||!1,C,y;if((s=(n=v[7])==null?void 0:n[0])!=null&&s.data&&e!=0)C=(o=(a=v[7])==null?void 0:a[0])==null?void 0:o.data,y=(h=(c=v[6])==null?void 0:c[0])==null?void 0:h.data;else if((u=(l=v[4])==null?void 0:l[0])!=null&&u.data&&e!=1)C=(f=(d=v[4])==null?void 0:d[0])==null?void 0:f.data,y=(m=(p=v[3])==null?void 0:p[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var b=E?4:1,T=Sa(C),R=[],O=0;O<C.length/2;++O){var W=T.getUint16(O*2,!0);W<65535&&R.push([O,W])}if(R.length!=x)throw"Expected ".concat(x," cells, found ").concat(R.length);var G=[];for(O=0;O<R.length-1;++O)G[R[O][0]]=y.subarray(R[O][1]*b,R[O+1][1]*b);return R.length>=1&&(G[R[R.length-1][0]]=y.subarray(R[R.length-1][1]*b)),{R:_,cells:G}}function MB(i,e){var t,r=Ut(e.data),n=(t=r==null?void 0:r[7])!=null&&t[0]?Ai(r[7][0].data)>>>0>0?1:0:-1,s=qf(r[5],function(a){return NB(a,n)});return{nrows:Ai(r[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,h){if(a[o.R][h])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(h));a[o.R][h]=c}),a},[])}}function LB(i,e,t){var r,n=Ut(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ai(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Ai(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Tt(s);var a=Ut(n[4][0].data),o=Im(i,i[fr(a[4][0].data)][0]),c=(r=a[17])!=null&&r[0]?Im(i,i[fr(a[17][0].data)][0]):[],h=Ut(a[3][0].data),l=0;h[1].forEach(function(u){var d=Ut(u.data),f=i[fr(d[2][0].data)][0],p=Ai(f.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var m=MB(i,f);m.data.forEach(function(v,_){v.forEach(function(x,E){var C=ut({r:l+_,c:E}),y=PB(x,o,c);y&&(t[C]=y)})}),l+=m.nrows})}function BB(i,e){var t=Ut(e.data),r={"!ref":"A1"},n=i[fr(t[2][0].data)],s=Ai(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return LB(i,n[0],r),r}function HB(i,e){var t,r=Ut(e.data),n={name:(t=r[1])!=null&&t[0]?Ad(r[1][0].data):"",sheets:[]},s=qf(r[2],fr);return s.forEach(function(a){i[a].forEach(function(o){var c=Ai(o.meta[1][0].data);c==6e3&&n.sheets.push(BB(i,o))})}),n}function VB(i,e){var t=Jf(),r=Ut(e.data),n=qf(r[1],fr);if(n.forEach(function(s){i[s].forEach(function(a){var o=Ai(a.meta[1][0].data);if(o==2){var c=HB(i,a);c.sheets.forEach(function(h,l){e0(t,h,l==0?c.name:c.name+"_"+l,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Ku(i){var e,t,r,n,s={},a=[];if(i.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),i.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var h;try{h=hn(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}var l;try{l=cn(h)}catch(u){return console.log("## "+(u.message||u))}l.forEach(function(u){s[u.id]=u.messages,a.push(u.id)})}}),!a.length)throw new Error("File has no messages");var o=((n=(r=(t=(e=s==null?void 0:s[1])==null?void 0:e[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:n[0].data)&&Ai(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(h){var l=Ai(h.meta[1][0].data)>>>0;if(l==1)if(!o)o=h;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return VB(s,o)}function UB(i,e,t){var r,n,s,a;if(!((r=i[6])!=null&&r[0])||!((n=i[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=i[8])==null?void 0:s[0])==null?void 0:a.data)&&Ai(i[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,h=Sa(i[7][0].data),l=0,u=[],d=Sa(i[4][0].data),f=0,p=[],m=0;m<e.length;++m){if(e[m]==null){h.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}h.setUint16(m*2,l,!0),d.setUint16(m*2,f,!0);var v,_;switch(typeof e[m]){case"string":v=Xu({t:"s",v:e[m]},t),_=qu({t:"s",v:e[m]},t);break;case"number":v=Xu({t:"n",v:e[m]},t),_=qu({t:"n",v:e[m]},t);break;case"boolean":v=Xu({t:"b",v:e[m]},t),_=qu({t:"b",v:e[m]},t);break;default:throw new Error("Unsupported value "+e[m])}u.push(v),l+=v.length,p.push(_),f+=_.length,++c}for(i[2][0].data=qt(c);m<i[7][0].data.length/2;++m)h.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return i[6][0].data=zs(u),i[3][0].data=zs(p),c}function WB(i,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=i.Sheets[i.SheetNames[0]];i.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Gr(t["!ref"]);r.s.r=r.s.c=0;var n=!1;r.e.c>9&&(n=!0,r.e.c=9),r.e.r>49&&(n=!0,r.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Tt(r)));var s=hh(t,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(Z){return Z.forEach(function(q){typeof q=="string"&&a.push(q)})});var o={},c=[],h=st.read(e.numbers,{type:"base64"});h.FileIndex.map(function(Z,q){return[Z,h.FullPaths[q]]}).forEach(function(Z){var q=Z[0],X=Z[1];if(q.type==2&&q.name.match(/\.iwa/)){var de=q.content,Ie=hn(de),we=cn(Ie);we.forEach(function(Re){c.push(Re.id),o[Re.id]={deps:[],location:X,type:Ai(Re.messages[0].meta[1][0].data)}})}}),c.sort(function(Z,q){return Z-q});var l=c.filter(function(Z){return Z>1}).map(function(Z){return[Z,qt(Z)]});h.FileIndex.map(function(Z,q){return[Z,h.FullPaths[q]]}).forEach(function(Z){var q=Z[0];if(Z[1],!!q.name.match(/\.iwa/)){var X=cn(hn(q.content));X.forEach(function(de){de.messages.forEach(function(Ie){l.forEach(function(we){de.messages.some(function(Re){return Ai(Re.meta[1][0].data)!=11006&&kB(Re.data,we[1])})&&o[we[0]].deps.push(de.id)})})})}});for(var u=st.find(h,o[1].location),d=cn(hn(u.content)),f,p=0;p<d.length;++p){var m=d[p];m.id==1&&(f=m)}var v=fr(Ut(f.messages[0].data)[1][0].data);for(u=st.find(h,o[v].location),d=cn(hn(u.content)),p=0;p<d.length;++p)m=d[p],m.id==v&&(f=m);for(v=fr(Ut(f.messages[0].data)[2][0].data),u=st.find(h,o[v].location),d=cn(hn(u.content)),p=0;p<d.length;++p)m=d[p],m.id==v&&(f=m);for(v=fr(Ut(f.messages[0].data)[2][0].data),u=st.find(h,o[v].location),d=cn(hn(u.content)),p=0;p<d.length;++p)m=d[p],m.id==v&&(f=m);var _=Ut(f.messages[0].data);{_[6][0].data=qt(r.e.r+1),_[7][0].data=qt(r.e.c+1);var x=fr(_[46][0].data),E=st.find(h,o[x].location),C=cn(hn(E.content));{for(var y=0;y<C.length&&C[y].id!=x;++y);if(C[y].id!=x)throw"Bad ColumnRowUIDMapArchive";var b=Ut(C[y].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var T=0;T<=r.e.c;++T){var R=[];R[1]=R[2]=[{type:0,data:qt(T+420690)}],b[1].push({type:2,data:nr(R)}),b[2].push({type:0,data:qt(T)}),b[3].push({type:0,data:qt(T)})}b[4]=[],b[5]=[],b[6]=[];for(var O=0;O<=r.e.r;++O)R=[],R[1]=R[2]=[{type:0,data:qt(O+726270)}],b[4].push({type:2,data:nr(R)}),b[5].push({type:0,data:qt(O)}),b[6].push({type:0,data:qt(O)});C[y].messages[0].data=nr(b)}E.content=Wa(Ua(C)),E.size=E.content.length,delete _[46];var W=Ut(_[4][0].data);{W[7][0].data=qt(r.e.r+1);var G=Ut(W[1][0].data),Q=fr(G[2][0].data);E=st.find(h,o[Q].location),C=cn(hn(E.content));{if(C[0].id!=Q)throw"Bad HeaderStorageBucket";var ne=Ut(C[0].messages[0].data);for(O=0;O<s.length;++O){var xe=Ut(ne[2][0].data);xe[1][0].data=qt(O),xe[4][0].data=qt(s[O].length),ne[2][O]={type:ne[2][0].type,data:nr(xe)}}C[0].messages[0].data=nr(ne)}E.content=Wa(Ua(C)),E.size=E.content.length;var Ce=fr(W[2][0].data);E=st.find(h,o[Ce].location),C=cn(hn(E.content));{if(C[0].id!=Ce)throw"Bad HeaderStorageBucket";for(ne=Ut(C[0].messages[0].data),T=0;T<=r.e.c;++T)xe=Ut(ne[2][0].data),xe[1][0].data=qt(T),xe[4][0].data=qt(r.e.r+1),ne[2][T]={type:ne[2][0].type,data:nr(xe)};C[0].messages[0].data=nr(ne)}E.content=Wa(Ua(C)),E.size=E.content.length;var Fe=fr(W[4][0].data);(function(){for(var Z=st.find(h,o[Fe].location),q=cn(hn(Z.content)),X,de=0;de<q.length;++de){var Ie=q[de];Ie.id==Fe&&(X=Ie)}var we=Ut(X.messages[0].data);{we[3]=[];var Re=[];a.forEach(function(M,it){Re[1]=[{type:0,data:qt(it)}],Re[2]=[{type:0,data:qt(1)}],Re[3]=[{type:2,data:AB(M)}],we[3].push({type:2,data:nr(Re)})})}X.messages[0].data=nr(we);var be=Ua(q),ue=Wa(be);Z.content=ue,Z.size=Z.content.length})();var ke=Ut(W[3][0].data);{var Ze=ke[1][0];delete ke[2];var ie=Ut(Ze.data);{var Ee=fr(ie[2][0].data);(function(){for(var Z=st.find(h,o[Ee].location),q=cn(hn(Z.content)),X,de=0;de<q.length;++de){var Ie=q[de];Ie.id==Ee&&(X=Ie)}var we=Ut(X.messages[0].data);{delete we[6],delete ke[7];var Re=new Uint8Array(we[5][0].data);we[5]=[];for(var be=0,ue=0;ue<=r.e.r;++ue){var M=Ut(Re);be+=UB(M,s[ue],a),M[1][0].data=qt(ue),we[5].push({data:nr(M),type:2})}we[1]=[{type:0,data:qt(r.e.c+1)}],we[2]=[{type:0,data:qt(r.e.r+1)}],we[3]=[{type:0,data:qt(be)}],we[4]=[{type:0,data:qt(r.e.r+1)}]}X.messages[0].data=nr(we);var it=Ua(q),et=Wa(it);Z.content=et,Z.size=Z.content.length})()}Ze.data=nr(ie)}W[3][0].data=nr(ke)}_[4][0].data=nr(W)}f.messages[0].data=nr(_);var Pe=Ua(d),U=Wa(Pe);return u.content=U,u.size=u.content.length,h}function O1(i){return function(t){for(var r=0;r!=i.length;++r){var n=i[r];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function Kf(i){O1([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(i)}function jf(i){O1([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(i)}function zB(i){return Dt.WS.indexOf(i)>-1?"sheet":i==Dt.CS?"chart":i==Dt.DS?"dialog":i==Dt.MS?"macro":i&&i.length?i:"sheet"}function GB(i,e){if(!i)return 0;try{i=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,i["!id"][r.id].Target,zB(i["!id"][r.id].Type)]})}catch{return null}return!i||i.length===0?null:i}function $B(i,e,t,r,n,s,a,o,c,h,l,u){try{s[r]=qo(Zr(i,t,!0),e);var d=Gi(i,e),f;switch(o){case"sheet":f=f3(d,e,n,c,s[r],h,l,u);break;case"chart":if(f=p3(d,e,n,c,s[r],h,l,u),!f||!f["!drawel"])break;var p=Bo(f["!drawel"].Target,e),m=ml(p),v=eN(Zr(i,p,!0),qo(Zr(i,m,!0),p)),_=Bo(v,p),x=ml(_);f=U4(Zr(i,_,!0),_,c,qo(Zr(i,x,!0),_),h,f);break;case"macro":f=m3(d,e,n,c,s[r],h,l,u);break;case"dialog":f=g3(d,e,n,c,s[r],h,l,u);break;default:throw new Error("Unrecognized sheet type "+o)}a[r]=f;var E=[];s&&s[r]&&Oi(s[r]).forEach(function(C){var y="";if(s[r][C].Type==Dt.CMNT){y=Bo(s[r][C].Target,e);var b=x3(Gi(i,y,!0),y,c);if(!b||!b.length)return;mm(f,b,!1)}s[r][C].Type==Dt.TCMNT&&(y=Bo(s[r][C].Target,e),E=E.concat(iN(Gi(i,y,!0),c)))}),E&&E.length&&mm(f,E,!0,c.people||[])}catch(C){if(c.WTF)throw C}}function on(i){return i.charAt(0)=="/"?i.slice(1):i}function YB(i,e){if(xo(),e=e||{},Kf(e),fn(i,"META-INF/manifest.xml")||fn(i,"objectdata.xml"))return Tm(i,e);if(fn(i,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ku<"u"){if(i.FileIndex)return Ku(i);var t=st.utils.cfb_new();return Mp(i).forEach(function(xe){At(t,xe,rI(i,xe))}),Ku(t)}throw new Error("Unsupported NUMBERS file")}if(!fn(i,"[Content_Types].xml"))throw fn(i,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fn(i,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Mp(i),n=jI(Zr(i,"[Content_Types].xml")),s=!1,a,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Gi(i,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Gi(i,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},h={};if(!e.bookSheets&&!e.bookProps){if(Ko=[],n.sst)try{Ko=E3(Gi(i,on(n.sst)),n.sst,e)}catch(xe){if(e.WTF)throw xe}e.cellStyles&&n.themes.length&&(c=_3(Zr(i,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],e)),n.style&&(h=v3(Gi(i,on(n.style)),n.style,c,e))}n.links.map(function(xe){try{var Ce=qo(Zr(i,ml(on(xe))),xe);return C3(Gi(i,on(xe)),Ce,xe,e)}catch{}});var l=d3(Gi(i,on(n.workbooks[0])),n.workbooks[0],e),u={},d="";n.coreprops.length&&(d=Gi(i,on(n.coreprops[0]),!0),d&&(u=v_(d)),n.extprops.length!==0&&(d=Gi(i,on(n.extprops[0]),!0),d&&rR(d,u,e)));var f={};(!e.bookSheets||e.bookProps)&&n.custprops.length!==0&&(d=Zr(i,on(n.custprops[0]),!0),d&&(f=sR(d,e)));var p={};if((e.bookSheets||e.bookProps)&&(l.Sheets?a=l.Sheets.map(function(Ce){return Ce.name}):u.Worksheets&&u.SheetNames.length>0&&(a=u.SheetNames),e.bookProps&&(p.Props=u,p.Custprops=f),e.bookSheets&&typeof a<"u"&&(p.SheetNames=a),e.bookSheets?p.SheetNames:e.bookProps))return p;a={};var m={};e.bookDeps&&n.calcchain&&(m=w3(Gi(i,on(n.calcchain)),n.calcchain));var v=0,_={},x,E;{var C=l.Sheets;u.Worksheets=C.length,u.SheetNames=[];for(var y=0;y!=C.length;++y)u.SheetNames[y]=C[y].name}var b=s?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),R=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");fn(i,R)||(R="xl/_rels/workbook."+b+".rels");var O=qo(Zr(i,R,!0),R.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(e.xlmeta=y3(Gi(i,on(n.metadata[0])),n.metadata[0],e)),(n.people||[]).length>=1&&(e.people=nN(Gi(i,on(n.people[0])),e)),O&&(O=GB(O,l.Sheets));var W=Gi(i,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=u.Worksheets;++v){var G="sheet";if(O&&O[v]?(x="xl/"+O[v][1].replace(/[\/]?xl\//,""),fn(i,x)||(x=O[v][1]),fn(i,x)||(x=R.replace(/_rels\/.*$/,"")+O[v][1]),G=O[v][2]):(x="xl/worksheets/sheet"+(v+1-W)+"."+b,x=x.replace(/sheet0\./,"sheet.")),E=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(v!=e.sheets)continue e;break;case"string":if(u.SheetNames[v].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var Q=!1,ne=0;ne!=e.sheets.length;++ne)typeof e.sheets[ne]=="number"&&e.sheets[ne]==v&&(Q=1),typeof e.sheets[ne]=="string"&&e.sheets[ne].toLowerCase()==u.SheetNames[v].toLowerCase()&&(Q=1);if(!Q)continue e}}$B(i,x,E,u.SheetNames[v],v,_,a,G,e,l,c,h)}return p={Directory:n,Workbook:l,Props:u,Custprops:f,Deps:m,Sheets:a,SheetNames:u.SheetNames,Strings:Ko,Styles:h,Themes:c,SSF:hi(ht)},e&&e.bookFiles&&(i.files?(p.keys=r,p.files=i.files):(p.keys=[],p.files={},i.FullPaths.forEach(function(xe,Ce){xe=xe.replace(/^Root Entry[\/]/,""),p.keys.push(xe),p.files[xe]=i.FileIndex[Ce]}))),e&&e.bookVBA&&(n.vba.length>0?p.vbaraw=Gi(i,on(n.vba[0]),!0):n.defaults&&n.defaults.bin===dN&&(p.vbaraw=Gi(i,"xl/vbaProject.bin",!0))),p}function XB(i,e){var t=e||{},r="Workbook",n=st.find(i,r);try{if(r="/!DataSpaces/Version",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(yF(n.content),r="/!DataSpaces/DataSpaceMap",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=bF(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=TF(n.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);kF(n.content)}catch{}if(r="/EncryptionInfo",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=OF(n.content);if(r="/EncryptedPackage",n=st.find(i,r),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function qB(i,e){return e.bookType=="ods"?k1(i,e):e.bookType=="numbers"?WB(i,e):e.bookType=="xlsb"?KB(i,e):jB(i,e)}function KB(i,e){Ya=1024,i&&!i.SSF&&(i.SSF=hi(ht)),i&&i.SSF&&(xo(),Ph(i.SSF),e.revssf=Mh(i.SSF),e.revssf[i.SSF[65535]]=0,e.ssf=i.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,jo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",r=i1.indexOf(e.bookType)>-1,n=Nf();jf(e=e||{});var s=wf(),a="",o=0;if(e.cellXfs=[],Xs(e.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),a="docProps/core.xml",At(s,a,__(i.Props,e)),n.coreprops.push(a),Kt(e.rels,2,a,Dt.CORE_PROPS),a="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var c=[],h=0;h<i.SheetNames.length;++h)(i.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(i.SheetNames[h]);i.Props.SheetNames=c}for(i.Props.Worksheets=i.Props.SheetNames.length,At(s,a,w_(i.Props)),n.extprops.push(a),Kt(e.rels,3,a,Dt.EXT_PROPS),i.Custprops!==i.Props&&Oi(i.Custprops||{}).length>0&&(a="docProps/custom.xml",At(s,a,C_(i.Custprops)),n.custprops.push(a),Kt(e.rels,4,a,Dt.CUST_PROPS)),o=1;o<=i.SheetNames.length;++o){var l={"!id":{}},u=i.Sheets[i.SheetNames[o-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,At(s,a,b3(o-1,a,e,i,l)),n.sheets.push(a),Kt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Dt.WS[0])}if(u){var f=u["!comments"],p=!1,m="";f&&f.length>0&&(m="xl/comments"+o+"."+t,At(s,m,k3(f,m)),n.comments.push(m),Kt(l,-1,"../comments"+o+"."+t,Dt.CMNT),p=!0),u["!legacy"]&&p&&At(s,"xl/drawings/vmlDrawing"+o+".vml",e1(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}l["!id"].rId1&&At(s,ml(a),to(l))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,At(s,a,A3(e.Strings,a,e)),n.strs.push(a),Kt(e.wbrels,-1,"sharedStrings."+t,Dt.SST)),a="xl/workbook."+t,At(s,a,S3(i,a)),n.workbooks.push(a),Kt(e.rels,1,a,Dt.WB),a="xl/theme/theme1.xml",At(s,a,Uf(i.Themes,e)),n.themes.push(a),Kt(e.wbrels,-1,"theme/theme1.xml",Dt.THEME),a="xl/styles."+t,At(s,a,T3(i,a,e)),n.styles.push(a),Kt(e.wbrels,-1,"styles."+t,Dt.STY),i.vbaraw&&r&&(a="xl/vbaProject.bin",At(s,a,i.vbaraw),n.vba.push(a),Kt(e.wbrels,-1,"vbaProject.bin",Dt.VBA)),a="xl/metadata."+t,At(s,a,O3(a)),n.metadata.push(a),Kt(e.wbrels,-1,"metadata."+t,Dt.XLMETA),At(s,"[Content_Types].xml",m_(n,e)),At(s,"_rels/.rels",to(e.rels)),At(s,"xl/_rels/workbook."+t+".rels",to(e.wbrels)),delete e.revssf,delete e.ssf,s}function jB(i,e){Ya=1024,i&&!i.SSF&&(i.SSF=hi(ht)),i&&i.SSF&&(xo(),Ph(i.SSF),e.revssf=Mh(i.SSF),e.revssf[i.SSF[65535]]=0,e.ssf=i.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,jo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=i1.indexOf(e.bookType)>-1,n=Nf();jf(e=e||{});var s=wf(),a="",o=0;if(e.cellXfs=[],Xs(e.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),a="docProps/core.xml",At(s,a,__(i.Props,e)),n.coreprops.push(a),Kt(e.rels,2,a,Dt.CORE_PROPS),a="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var c=[],h=0;h<i.SheetNames.length;++h)(i.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(i.SheetNames[h]);i.Props.SheetNames=c}i.Props.Worksheets=i.Props.SheetNames.length,At(s,a,w_(i.Props)),n.extprops.push(a),Kt(e.rels,3,a,Dt.EXT_PROPS),i.Custprops!==i.Props&&Oi(i.Custprops||{}).length>0&&(a="docProps/custom.xml",At(s,a,C_(i.Custprops)),n.custprops.push(a),Kt(e.rels,4,a,Dt.CUST_PROPS));var l=["SheetJ5"];for(e.tcid=0,o=1;o<=i.SheetNames.length;++o){var u={"!id":{}},d=i.Sheets[i.SheetNames[o-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+t,At(s,a,f1(o-1,e,i,u)),n.sheets.push(a),Kt(e.wbrels,-1,"worksheets/sheet"+o+"."+t,Dt.WS[0])}if(d){var p=d["!comments"],m=!1,v="";if(p&&p.length>0){var _=!1;p.forEach(function(x){x[1].forEach(function(E){E.T==!0&&(_=!0)})}),_&&(v="xl/threadedComments/threadedComment"+o+"."+t,At(s,v,rN(p,l,e)),n.threadedcomments.push(v),Kt(u,-1,"../threadedComments/threadedComment"+o+"."+t,Dt.TCMNT)),v="xl/comments"+o+"."+t,At(s,v,t1(p)),n.comments.push(v),Kt(u,-1,"../comments"+o+"."+t,Dt.CMNT),m=!0}d["!legacy"]&&m&&At(s,"xl/drawings/vmlDrawing"+o+".vml",e1(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&At(s,ml(a),to(u))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+t,At(s,a,W_(e.Strings,e)),n.strs.push(a),Kt(e.wbrels,-1,"sharedStrings."+t,Dt.SST)),a="xl/workbook."+t,At(s,a,_1(i)),n.workbooks.push(a),Kt(e.rels,1,a,Dt.WB),a="xl/theme/theme1.xml",At(s,a,Uf(i.Themes,e)),n.themes.push(a),Kt(e.wbrels,-1,"theme/theme1.xml",Dt.THEME),a="xl/styles."+t,At(s,a,j_(i,e)),n.styles.push(a),Kt(e.wbrels,-1,"styles."+t,Dt.STY),i.vbaraw&&r&&(a="xl/vbaProject.bin",At(s,a,i.vbaraw),n.vba.push(a),Kt(e.wbrels,-1,"vbaProject.bin",Dt.VBA)),a="xl/metadata."+t,At(s,a,J_()),n.metadata.push(a),Kt(e.wbrels,-1,"metadata."+t,Dt.XLMETA),l.length>1&&(a="xl/persons/person.xml",At(s,a,sN(l)),n.people.push(a),Kt(e.wbrels,-1,"persons/person.xml",Dt.PEOPLE)),At(s,"[Content_Types].xml",m_(n,e)),At(s,"_rels/.rels",to(e.rels)),At(s,"xl/_rels/workbook."+t+".rels",to(e.wbrels)),delete e.revssf,delete e.ssf,s}function Qf(i,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];case"base64":t=sn(i.slice(0,12));break;case"binary":t=i;break;case"array":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function QB(i,e){return st.find(i,"EncryptedPackage")?XB(i,e):C1(i,e)}function ZB(i,e){var t,r=i,n=e||{};return n.type||(n.type=Ot&&Buffer.isBuffer(i)?"buffer":"base64"),t=Gv(r,n),YB(t,n)}function I1(i,e){var t=0;e:for(;t<i.length;)switch(i.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return bd(i.slice(t),e);default:break e}return co.to_workbook(i,e)}function JB(i,e){var t="",r=Qf(i,e);switch(e.type){case"base64":t=sn(i);break;case"binary":t=i;break;case"buffer":t=i.toString("binary");break;case"array":t=xa(i);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=Qt(t)),e.type="binary",I1(t,e)}function e6(i,e){var t=i;return e.type=="base64"&&(t=sn(t)),t=cl.utils.decode(1200,t.slice(2),"str"),e.type="binary",I1(t,e)}function t6(i){return i.match(/[^\x00-\x7F]/)?Gn(i):i}function ju(i,e,t,r){return r?(t.type="string",co.to_workbook(i,t)):co.to_workbook(e,t)}function kd(i,e){gf();var t=e||{};if(typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer)return kd(new Uint8Array(i),(t=hi(t),t.type="array",t));typeof Uint8Array<"u"&&i instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=i,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ro={},t.dateNF&&(ro.dateNF=t.dateNF),t.type||(t.type=Ot&&Buffer.isBuffer(i)?"buffer":"base64"),t.type=="file"&&(t.type=Ot?"buffer":"binary",r=KO(i),typeof Uint8Array<"u"&&!Ot&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,r=t6(i)),t.type=="array"&&typeof Uint8Array<"u"&&i instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return t=hi(t),t.type="array",kd(vf(r),t)}switch((n=Qf(r,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return QB(st.read(r,t),t);break;case 9:if(n[1]<=8)return C1(r,t);break;case 60:return bd(r,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return aF(r,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return V_.to_workbook(r,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?ZB(r,t):ju(i,r,t,s);case 239:return n[3]===60?bd(r,t):ju(i,r,t,s);case 255:if(n[1]===254)return e6(r,t);if(n[1]===0&&n[2]===2&&n[3]===0)return ha.to_workbook(r,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ha.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return Sd.to_workbook(r,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return X_.to_workbook(r,t);break;case 10:case 13:case 32:return JB(r,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return sF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Sd.to_workbook(r,t):ju(i,r,t,s)}function R1(i,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Fl(e.file,st.write(i,{type:Ot?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return st.write(i,e)}function i6(i,e){var t=hi(e||{}),r=qB(i,t);return r6(r,t)}function r6(i,e){var t={},r=Ot?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var n=i.FullPaths?st.write(i,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):i.generate(t);if(typeof Deno<"u"&&typeof n=="string"){if(e.type=="binary"||e.type=="base64")return n;n=new Uint8Array(Fh(n))}return e.password&&typeof encrypt_agile<"u"?R1(encrypt_agile(n,e.password),e):e.type==="file"?Fl(e.file,n):e.type=="string"?Qt(n):n}function n6(i,e){var t=e||{},r=tB(i,t);return R1(r,t)}function Wn(i,e,t){t||(t="");var r=t+i;switch(e.type){case"base64":return hl(Gn(r));case"binary":return Gn(r);case"string":return i;case"file":return Fl(e.file,r,"utf8");case"buffer":return Ot?xs(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Wn(r,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function s6(i,e){switch(e.type){case"base64":return hl(i);case"binary":return i;case"string":return i;case"file":return Fl(e.file,i,"binary");case"buffer":return Ot?xs(i,"binary"):i.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Cc(i,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<i.length;++r)t+=String.fromCharCode(i[r]);return e.type=="base64"?hl(t):e.type=="string"?Qt(t):t;case"file":return Fl(e.file,i);case"buffer":return i;default:throw new Error("Unrecognized type "+e.type)}}function D1(i,e){gf(),Q4(i);var t=hi(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=D1(i,t);return t.type="array",Fh(r)}var n=0;if(t.sheet&&(typeof t.sheet=="number"?n=t.sheet:n=i.SheetNames.indexOf(t.sheet),!i.SheetNames[n]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Wn(q3(i,t),t);case"slk":case"sylk":return Wn(H_.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"htm":case"html":return Wn(S1(i.Sheets[i.SheetNames[n]],t),t);case"txt":return s6(F1(i.Sheets[i.SheetNames[n]],t),t);case"csv":return Wn(Zf(i.Sheets[i.SheetNames[n]],t),t,"\uFEFF");case"dif":return Wn(V_.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"dbf":return Cc(Sd.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"prn":return Wn(co.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"rtf":return Wn(X_.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"eth":return Wn(U_.from_sheet(i.Sheets[i.SheetNames[n]],t),t);case"fods":return Wn(k1(i,t),t);case"wk1":return Cc(ha.sheet_to_wk1(i.Sheets[i.SheetNames[n]],t),t);case"wk3":return Cc(ha.book_to_wk3(i,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Cc(y1(i,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),n6(i,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return i6(i,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function a6(i,e,t,r,n,s,a,o){var c=Ni(t),h=o.defval,l=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:t,enumerable:!1})}catch{d.__rowNum__=t}else d.__rowNum__=t;if(!a||i[t])for(var f=e.s.c;f<=e.e.c;++f){var p=a?i[t][f]:i[r[f]+c];if(p===void 0||p.t===void 0){if(h===void 0)continue;s[f]!=null&&(d[s[f]]=h);continue}var m=p.v;switch(p.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[f]!=null){if(m==null)if(p.t=="e"&&m===null)d[s[f]]=null;else if(h!==void 0)d[s[f]]=h;else if(l&&m===null)d[s[f]]=null;else continue;else d[s[f]]=l&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?m:_s(p,m,o);m!=null&&(u=!1)}}return{row:d,isempty:u}}function hh(i,e){if(i==null||i["!ref"]==null)return[];var t={t:"n",v:0},r=0,n=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},l=h.range!=null?h.range:i["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof l){case"string":c=Ht(l);break;case"number":c=Ht(i["!ref"]),c.s.r=l;break;default:c=l}r>0&&(n=0);var u=Ni(c.s.r),d=[],f=[],p=0,m=0,v=Array.isArray(i),_=c.s.r,x=0,E={};v&&!i[_]&&(i[_]=[]);var C=h.skipHidden&&i["!cols"]||[],y=h.skipHidden&&i["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(C[x]||{}).hidden)switch(d[x]=wi(x),t=v?i[_][x]:i[d[x]+u],r){case 1:s[x]=x-c.s.c;break;case 2:s[x]=d[x];break;case 3:s[x]=h.header[x-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=a=_s(t,null,h),m=E[a]||0,!m)E[a]=1;else{do o=a+"_"+m++;while(E[o]);E[a]=m,E[o]=1}s[x]=o}for(_=c.s.r+n;_<=c.e.r;++_)if(!(y[_]||{}).hidden){var b=a6(i,c,_,d,r,s,v,h);(b.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(f[p++]=b.row)}return f.length=p,f}var Rm=/"/g;function o6(i,e,t,r,n,s,a,o){for(var c=!0,h=[],l="",u=Ni(t),d=e.s.c;d<=e.e.c;++d)if(r[d]){var f=o.dense?(i[t]||[])[d]:i[r[d]+u];if(f==null)l="";else if(f.v!=null){c=!1,l=""+(o.rawNumbers&&f.t=="n"?f.v:_s(f,null,o));for(var p=0,m=0;p!==l.length;++p)if((m=l.charCodeAt(p))===n||m===s||m===34||o.forceQuotes){l='"'+l.replace(Rm,'""')+'"';break}l=="ID"&&(l='"ID"')}else f.f!=null&&!f.F?(c=!1,l="="+f.f,l.indexOf(",")>=0&&(l='"'+l.replace(Rm,'""')+'"')):l="";h.push(l)}return o.blankrows===!1&&c?null:h.join(a)}function Zf(i,e){var t=[],r=e??{};if(i==null||i["!ref"]==null)return"";var n=Ht(i["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,c=o.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),l="",u=[];r.dense=Array.isArray(i);for(var d=r.skipHidden&&i["!cols"]||[],f=r.skipHidden&&i["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(d[p]||{}).hidden||(u[p]=wi(p));for(var m=0,v=n.s.r;v<=n.e.r;++v)(f[v]||{}).hidden||(l=o6(i,n,v,u,a,c,s,r),l!=null&&(r.strip&&(l=l.replace(h,"")),(l||r.blankrows!==!1)&&t.push((m++?o:"")+l)));return delete r.dense,t.join("")}function F1(i,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Zf(i,e);return t}function l6(i){var e="",t,r="";if(i==null||i["!ref"]==null)return[];var n=Ht(i["!ref"]),s="",a=[],o,c=[],h=Array.isArray(i);for(o=n.s.c;o<=n.e.c;++o)a[o]=wi(o);for(var l=n.s.r;l<=n.e.r;++l)for(s=Ni(l),o=n.s.c;o<=n.e.c;++o)if(e=a[o]+s,t=h?(i[l]||[])[o]:i[e],r="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;r=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}c[c.length]=e+"="+r}return c}function P1(i,e,t){var r=t||{},n=+!r.skipHeader,s=i||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var c=typeof r.origin=="string"?Ci(r.origin):r.origin;a=c.r,o=c.c}var h,l={s:{c:0,r:0},e:{c:o,r:a+e.length-1+n}};if(s["!ref"]){var u=Ht(s["!ref"]);l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),a==-1&&(a=u.e.r+1,l.e.r=a+e.length-1+n)}else a==-1&&(a=0,l.e.r=e.length-1+n);var d=r.header||[],f=0;e.forEach(function(m,v){Oi(m).forEach(function(_){(f=d.indexOf(_))==-1&&(d[f=d.length]=_);var x=m[_],E="z",C="",y=ut({c:o+f,r:a+v+n});h=Cl(s,y),x&&typeof x=="object"&&!(x instanceof Date)?s[y]=x:(typeof x=="number"?E="n":typeof x=="boolean"?E="b":typeof x=="string"?E="s":x instanceof Date?(E="d",r.cellDates||(E="n",x=Qi(x)),C=r.dateNF||ht[14]):x===null&&r.nullError&&(E="e",x=0),h?(h.t=E,h.v=x,delete h.w,delete h.R,C&&(h.z=C)):s[y]=h={t:E,v:x},C&&(h.z=C))})}),l.e.c=Math.max(l.e.c,o+d.length-1);var p=Ni(a);if(n)for(f=0;f<d.length;++f)s[wi(f+o)+p]={t:"s",v:d[f]};return s["!ref"]=Tt(l),s}function c6(i,e){return P1(null,i,e)}function Cl(i,e,t){if(typeof e=="string"){if(Array.isArray(i)){var r=Ci(e);return i[r.r]||(i[r.r]=[]),i[r.r][r.c]||(i[r.r][r.c]={t:"z"})}return i[e]||(i[e]={t:"z"})}return typeof e!="number"?Cl(i,ut(e)):Cl(i,ut({r:e,c:t||0}))}function h6(i,e){if(typeof e=="number"){if(e>=0&&i.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=i.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Jf(){return{SheetNames:[],Sheets:{}}}function e0(i,e,t,r){var n=1;if(!t)for(;n<=65535&&i.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||i.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&i.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var a=s&&s[1]||t;for(++n;n<=65535&&i.SheetNames.indexOf(t=a+n)!=-1;++n);}if(v1(t),i.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return i.SheetNames.push(t),i.Sheets[t]=e,t}function u6(i,e,t){i.Workbook||(i.Workbook={}),i.Workbook.Sheets||(i.Workbook.Sheets=[]);var r=h6(i,e);switch(i.Workbook.Sheets[r]||(i.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}i.Workbook.Sheets[r].Hidden=t}function d6(i,e){return i.z=e,i}function N1(i,e,t){return e?(i.l={Target:e},t&&(i.l.Tooltip=t)):delete i.l,i}function f6(i,e,t){return N1(i,"#"+e,t)}function p6(i,e,t){i.c||(i.c=[]),i.c.push({t:e,a:t||"SheetJS"})}function m6(i,e,t,r){for(var n=typeof e!="string"?e:Ht(e),s=typeof e=="string"?e:Tt(e),a=n.s.r;a<=n.e.r;++a)for(var o=n.s.c;o<=n.e.c;++o){var c=Cl(i,a,o);c.t="n",c.F=s,delete c.v,a==n.s.r&&o==n.s.c&&(c.f=t,r&&(c.D=!0))}return i}var Rc={encode_col:wi,encode_row:Ni,encode_cell:ut,encode_range:Tt,decode_col:Of,decode_row:kf,split_cell:AI,decode_cell:Ci,decode_range:Gr,format_cell:_s,sheet_add_aoa:l_,sheet_add_json:P1,sheet_add_dom:b1,aoa_to_sheet:wo,json_to_sheet:c6,table_to_sheet:T1,table_to_book:yB,sheet_to_csv:Zf,sheet_to_txt:F1,sheet_to_json:hh,sheet_to_html:S1,sheet_to_formulae:l6,sheet_to_row_object_array:hh,sheet_get_cell:Cl,book_new:Jf,book_append_sheet:e0,book_set_sheet_visibility:u6,cell_set_number_format:d6,cell_set_hyperlink:N1,cell_set_internal_link:f6,cell_add_comment:p6,sheet_set_array_formula:m6,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class g6{static export(e){const t=Rc.book_new();e.sheets.forEach(n=>{const s=Math.max(...n.rows.map(c=>parseInt(c.id.replace("row-",""))),0),a=[];for(let c=0;c<=s;c++)a[c]=[];n.rows.forEach(c=>{const h=parseInt(c.id.replace("row-",""));Object.entries(c.cells).forEach(([l,u])=>{const d=l.charCodeAt(0)-65;a[h][d]=u.formula?u.formula:u.value})});const o=Rc.aoa_to_sheet(a);Rc.book_append_sheet(t,o,n.name)});const r=D1(t,{type:"array",bookType:"xlsx"});return new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}}class v6{static async import(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=s=>{var h;const a=new Uint8Array((h=s.target)==null?void 0:h.result),o=kd(a,{type:"array"}),c={version:1,workbook:{name:e.name,activeSheetId:"sheet-0"},sheets:[]};o.SheetNames.forEach((l,u)=>{const d=o.Sheets[l],f=Rc.sheet_to_json(d,{header:1}),p={id:`sheet-${u}`,name:l,order:u,columns:[],rows:[],gridState:{},merges:[],styles:{}};f.forEach((m,v)=>{const _=`row-${v}`,x={};m.forEach((E,C)=>{const y=String.fromCharCode(65+C);x[y]={value:E,formula:typeof E=="string"&&E.startsWith("=")?E:void 0}}),p.rows.push({id:_,order:v,cells:x})}),c.sheets.push(p)}),t(c)},n.onerror=r,n.readAsArrayBuffer(e)})}}document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("grid-container"),e=document.getElementById("tabs-container"),t=document.getElementById("add-sheet"),r=document.getElementById("export-json"),n=document.getElementById("export-xlsx"),s=document.getElementById("import-xlsx"),a=document.getElementById("xlsx-file"),o=document.getElementById("formula-input"),c=document.getElementById("cell-ref"),h=document.getElementById("bold-btn");if(!i||!e||!t||!r||!o||!c)return;let l=new Cp,u=null;const d=(_,x)=>{let E="",C=_+1;for(;C>0;){let y=(C-1)%26;E=String.fromCharCode(65+y)+E,C=Math.floor((C-y)/26)}return E+(x+1)},f=_=>{var E,C;u&&(u.dispose(),i.innerHTML=""),l.setActiveSheet(_);const x=l.getActiveSheet();if(x){if(x.getColumns().length===0){const y=[];for(let b=0;b<26;b++){const T=String.fromCharCode(65+b);y.push({id:T,name:T,field:T,width:100,editor:{model:(C=(E=window.Slick)==null?void 0:E.Editors)==null?void 0:C.Text}})}x.setColumns(y)}try{u=Xg.createGrid(i,x.getColumns()),u.dataset=x.getDataModel().toSlickGridDataset(x.getStyleStore()),setTimeout(()=>{if(u&&u.slickGrid){const y=u.slickGrid;y.resizeCanvas(),y.render(),console.log("Grid rendered and resized."),y.onActiveCellChanged.subscribe((b,T)=>{var ne;const R=T.row,O=T.cell,W=y.getColumns()[O].id,G=y.getDataItem(R).id;c.innerText=d(O,R);const Q=(ne=x.getDataModel().getRows().find(xe=>xe.id===G))==null?void 0:ne.cells[W];o.value=(Q==null?void 0:Q.formula)||(Q==null?void 0:Q.value)||""}),y.onCellChange.subscribe((b,T)=>{p(T.item,T.column)})}else console.error("Grid bundle created but slickGrid instance is missing.")},100)}catch(y){console.error("Failed to create SlickGrid:",y)}m()}},p=(_,x)=>{const E=l.getActiveSheet();if(!E)return;const C=_[x.id];typeof C=="string"&&C.startsWith("=")?E.setCellFormula(_.id,x.id,C):(E.getDataModel().setCellValue(_.id,x.id,C),E.notifyValueChange(_.id,x.id)),u&&(u.dataset=E.getDataModel().toSlickGridDataset(E.getStyleStore()))},m=()=>{e.innerHTML="",l.getSheets().forEach(_=>{const x=document.createElement("button");x.innerText=_.getName(),x.style.marginRight="5px",x.style.padding="5px 15px",x.onclick=()=>f(_.getId()),x.style.background=_.getId()===l.getSnapshot().workbook.activeSheetId?"#1a73e8":"#fff",x.style.color=_.getId()===l.getSnapshot().workbook.activeSheetId?"#fff":"#000",e.appendChild(x)})};o.onkeydown=_=>{if(_.key==="Enter"){const x=u==null?void 0:u.slickGrid;if(!x)return;const E=x.getActiveCell();if(E){const C=x.getDataItem(E.row),y=x.getColumns()[E.cell];C[y.id]=o.value,p(C,y),x.focus()}}},t.onclick=()=>{const _=prompt("Sheet Name:",`Sheet ${l.getSheets().length+1}`);if(_){const x=l.addSheet(_);f(x.getId())}},r.onclick=()=>{console.log("SNAPSHOT:",JSON.stringify(l.getSnapshot(),null,2))},n==null||n.addEventListener("click",()=>{const _=l.getSnapshot(),x=g6.export(_),E=URL.createObjectURL(x),C=document.createElement("a");C.href=E,C.download=`${_.workbook.name||"workbook"}.xlsx`,C.click()}),s==null||s.addEventListener("click",()=>a.click()),a.onchange=async _=>{const x=_.target.files[0];if(x){const E=await v6.import(x);l=new Cp(E),f(l.getSnapshot().workbook.activeSheetId)}},h==null||h.addEventListener("click",()=>{const _=l.getActiveSheet(),x=u==null?void 0:u.slickGrid;if(_&&x&&x.getSelectionModel()){const E=x.getSelectionModel().getSelectedRanges();E&&E.length>0&&(E.forEach(C=>_.getStyleApplier().applyStyle(C,{bold:!0})),u.dataset=_.getDataModel().toSlickGridDataset(_.getStyleStore()))}});const v=l.addSheet("Finance");v.getDataModel().setCellValue("row-0","A",1500),v.getDataModel().setCellValue("row-1","A",2500),v.setCellFormula("row-2","A","=SUM(A1, A2)"),f(v.getId()),console.log("Tabular Sandbox v6.1 - Robust UX Ready.")});
