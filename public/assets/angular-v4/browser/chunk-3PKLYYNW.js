import{a as rt}from"./chunk-4REX6LI6.js";import{a as it,b as nt}from"./chunk-F4RF2OIR.js";import"./chunk-FV7S3SIL.js";import"./chunk-A2Z7GNRS.js";import{a as F}from"./chunk-OP6M3LK7.js";import{a as Ke,b as Xe}from"./chunk-3NG6G7DU.js";import{a as Ze,b as et,c as tt}from"./chunk-WGGER5HX.js";import{a as $}from"./chunk-DL4SMTXP.js";import"./chunk-V4GBUP5U.js";import{E as Le,H as Oe,I as Be,J as Ve,L as je,M as $e,O as qe,P as He,R as Ge,S as We,U as Ye,W as Qe,c as ne,ea as ze,ha as j,j as Me,ja as Je,k as Pe,n as ye,o as De,p as Ne,q as ke}from"./chunk-H5SZDBVN.js";import"./chunk-XE6VZSAJ.js";import{a as k}from"./chunk-KX634QZQ.js";import{C as Ce,D as Ee,F as xe,G as Ie,H as be,I as Ue,J as Re,L as ie}from"./chunk-3O3IKF6A.js";import{ia as M,ja as P,ma as Fe,na as Ae}from"./chunk-TR4MAYT5.js";import{p as D,t as N}from"./chunk-AWIVOLPG.js";import"./chunk-J2LIJEQH.js";import"./chunk-AGIEFCW2.js";import"./chunk-F5F27R7A.js";import{B as te,C as we,D as Te,c as z,e as x,h as J,i as K,o as X,r as Z,u as ee}from"./chunk-6EN4EXPL.js";import{$a as ve,$b as h,Ba as _e,Ca as H,Cb as f,Ea as fe,Fc as m,Gb as p,Gc as l,Ka as w,Kd as Q,La as G,M as ue,Md as B,Nd as V,Pd as ae,Qb as a,Rb as r,Sb as v,Ta as I,Tb as A,Ua as b,Ub as y,Wb as U,Zb as C,cd as W,dd as Y,kc as ge,mc as s,nc as S,ob as i,oc as u,pb as _,pc as he,pd as Se,yc as O,zb as T}from"./chunk-SXJN2XK6.js";var ft=()=>["/users"];function vt(e,c){e&1&&(a(0,"span",27),s(1),m(2,"translate"),r()),e&2&&(i(),S(l(2,1,"ADD_USER")))}function gt(e,c){e&1&&(a(0,"span",27),s(1),m(2,"translate"),r()),e&2&&(i(),S(l(2,1,"EDIT_USER")))}function ht(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"FIRST_NAME_IS_REQUIRED")," "))}function St(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"LAST_NAME_IS_REQUIRED")," "))}function Ct(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"MOBILE_IS_REQUIRED")," "))}function Et(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"EMAIL_IS_REQUIRED")," "))}function xt(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"PLEASE_ENTER_VALID_EMAIL")," "))}function It(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"PASSWORD_IS_REQUIRED")," "))}function bt(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"YOU_HAVE_TO_ENTER_AT_LEAST_DIGIT")," "))}function Ut(e,c){if(e&1&&(a(0,"div",13)(1,"label",14),s(2),m(3,"translate"),r(),v(4,"input",29),f(5,It,3,3,"div",16)(6,bt,3,3,"div",16),r()),e&2){let t,o=h();i(2),S(l(3,3,"PASSWORD")),i(3),p("ngIf",o.userForm.get("password").touched&&o.userForm.get("password").hasError("required")),i(),p("ngIf",o.userForm.get("password").touched&&((t=o.userForm.get("password"))==null?null:t.hasError("minlength")))}}function Rt(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"CONFIRM_PASSWORD_IS_REQUIRED")," "))}function wt(e,c){e&1&&(a(0,"div",28),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"PASSWORDS_DO_NOT_MATCH")," "))}function Tt(e,c){if(e&1&&(a(0,"div",13)(1,"label",14),s(2),m(3,"translate"),r(),v(4,"input",30),f(5,Rt,3,3,"div",16)(6,wt,3,3,"div",16),r()),e&2){let t=h();i(2),S(l(3,3,"CONFIRM_PASSWORD")),i(3),p("ngIf",t.userForm.get("confirmPassword").touched&&t.userForm.get("confirmPassword").hasError("required")),i(),p("ngIf",t.userForm.get("confirmPassword").touched&&t.userForm.get("confirmPassword").touched&&t.userForm.hasError("notSame"))}}function Mt(e,c){if(e&1&&(a(0,"ng-option",31),s(1),r()),e&2){let t=c.$implicit;p("value",t),i(),S(t.name)}}function Pt(e,c){if(e&1){let t=U();a(0,"button",33),C("click",function(){I(t);let n=h(2);return b(n.saveUser())}),v(1,"i-feather",34),s(2),m(3,"translate"),r()}e&2&&(i(2),u(" ",l(3,1,"SAVE"),""))}function Ft(e,c){e&1&&(A(0),f(1,Pt,4,3,"button",32),y()),e&2&&(i(),p("hasClaim","USER_EDIT_USER"))}function At(e,c){if(e&1){let t=U();a(0,"button",33),C("click",function(){I(t);let n=h(2);return b(n.saveUser())}),v(1,"i-feather",34),s(2),m(3,"translate"),r()}e&2&&(i(2),u(" ",l(3,1,"SAVE"),""))}function yt(e,c){e&1&&(A(0),f(1,At,4,3,"button",32),y()),e&2&&(i(),p("hasClaim","USER_CREATE_USER"))}var ce=(()=>{class e extends M{constructor(t,o,n,d,g,E,R){super(),this.fb=t,this.router=o,this.activeRoute=n,this.userService=d,this.toastrService=g,this.commonService=E,this.translationService=R,this.isEditMode=!1}ngOnInit(){this.createUserForm(),this.sub$.sink=this.activeRoute.data.subscribe(t=>{t.user?(this.isEditMode=!0,this.userForm.patchValue(t.user),this.user=t.user,this.userForm.get("email").disable()):(this.userForm.get("password").setValidators([x.required,x.minLength(6)]),this.userForm.get("confirmPassword").setValidators([x.required]))}),this.getRoles()}createUserForm(){this.userForm=this.fb.group({id:[""],firstName:["",[x.required]],lastName:["",[x.required]],email:["",[x.required,x.email]],phoneNumber:["",[x.required]],password:[""],confirmPassword:[""],selectedRoles:[]},{validator:this.checkPasswords})}checkPasswords(t){let o=t.get("password").value,n=t.get("confirmPassword").value;return o===n?null:{notSame:!0}}saveUser(){if(this.userForm.valid){let t=this.createBuildObject();this.isEditMode?this.sub$.sink=this.userService.updateUser(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_UPDATED_SUCCESSFULLY")),this.router.navigate(["/users"])}):this.sub$.sink=this.userService.addUser(t).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_CREATED_SUCCESSFULLY")),this.router.navigate(["/users"])})}else this.toastrService.error(this.translationService.getValue("PLEASE_ENTER_PROPER_DATA"))}createBuildObject(){return{id:this.userForm.get("id").value,firstName:this.userForm.get("firstName").value,lastName:this.userForm.get("lastName").value,email:this.userForm.get("email").value,phoneNumber:this.userForm.get("phoneNumber").value,password:this.userForm.get("password").value,userName:this.userForm.get("email").value,roleIds:this.getSelectedRoles()}}getSelectedRoles(){return(this.userForm.get("selectedRoles").value??[]).map(o=>o.id)}getRoles(){this.sub$.sink=this.commonService.getRolesForDropdown().subscribe(t=>{if(this.roleList=t,this.isEditMode){let o=this.user.userRoles.map(d=>d.roleId),n=this.roleList.filter(d=>o.indexOf(d.id)>-1);this.userForm.get("selectedRoles").setValue(n)}})}static{this.\u0275fac=function(o){return new(o||e)(_(te),_(B),_(Q),_(F),_(D),_(ie),_(P))}}static{this.\u0275cmp=w({type:e,selectors:[["app-manage-user"]],features:[T],decls:55,vars:35,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row","align-items-center"],[1,"col-md-6","mb-2"],["class","mb-0 page-title",4,"ngIf"],[3,"code"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"body"],[3,"formGroup"],[1,"col-md-6"],[1,"form-label"],["formControlName","firstName","type","text",1,"form-control"],["class","text-danger",4,"ngIf"],["formControlName","lastName","type","text",1,"form-control"],["formControlName","phoneNumber","type","text",1,"form-control"],["formControlName","email","type","email",1,"form-control"],["class","col-md-6",4,"ngIf"],["formControlName","selectedRoles",3,"multiple"],[3,"value",4,"ngFor","ngForOf"],[1,"m-t-10","col-md-12"],[4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"routerLink"],["name","x-circle",1,"small-icon"],[1,"mb-0","page-title"],[1,"text-danger"],["autocomplete","new-password","formControlName","password","type","password",1,"form-control"],["autocomplete","new-password","formControlName","confirmPassword","type","password",1,"form-control"],[3,"value"],["class","btn btn-success btn-sm m-r-10","cdkFocusInitial","",3,"click",4,"hasClaim"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["name","save",1,"small-icon"]],template:function(o,n){if(o&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),f(6,vt,3,3,"span",6)(7,gt,3,3,"span",6),v(8,"app-page-help-text",7),r()()()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"form",12)(14,"div",8)(15,"div",13)(16,"label",14),s(17),m(18,"translate"),r(),v(19,"input",15),f(20,ht,3,3,"div",16),r(),a(21,"div",13)(22,"label",14),s(23),m(24,"translate"),r(),v(25,"input",17),f(26,St,3,3,"div",16),r(),a(27,"div",13)(28,"label",14),s(29),m(30,"translate"),r(),v(31,"input",18),f(32,Ct,3,3,"div",16),r(),a(33,"div",13)(34,"label",14),s(35),m(36,"translate"),r(),v(37,"input",19),f(38,Et,3,3,"div",16)(39,xt,3,3,"div",16),r(),f(40,Ut,7,5,"div",20)(41,Tt,7,5,"div",20),a(42,"div",13)(43,"label",14),s(44),m(45,"translate"),r(),a(46,"ng-select",21),f(47,Mt,2,2,"ng-option",22),r()(),a(48,"div",23),f(49,Ft,2,1,"ng-container",24)(50,yt,2,1,"ng-container",24),a(51,"button",25),v(52,"i-feather",26),s(53),m(54,"translate"),r()()()()()()()()()()),o&2){let d,g,E,R,de;i(6),p("ngIf",!n.isEditMode),i(),p("ngIf",n.isEditMode),i(),p("code","MANAGE_USER"),i(5),p("formGroup",n.userForm),i(4),S(l(18,22,"FIRST_NAME")),i(3),p("ngIf",((d=n.userForm.get("firstName"))==null?null:d.touched)&&((d=n.userForm.get("firstName"))==null?null:d.hasError("required"))),i(3),S(l(24,24,"LAST_NAME")),i(3),p("ngIf",n.userForm.get("lastName").touched&&((g=n.userForm.get("lastName"))==null?null:g.hasError("required"))),i(3),S(l(30,26,"MOBILE_NUMBER")),i(3),p("ngIf",n.userForm.get("phoneNumber").touched&&((E=n.userForm.get("phoneNumber"))==null?null:E.hasError("required"))),i(3),S(l(36,28,"EMAIL")),i(3),p("ngIf",n.userForm.get("email").touched&&((R=n.userForm.get("email"))==null?null:R.hasError("required"))),i(),p("ngIf",n.userForm.get("email").touched&&((de=n.userForm.get("email"))==null?null:de.hasError("email"))),i(),p("ngIf",!n.isEditMode),i(),p("ngIf",!n.isEditMode),i(3),S(l(45,30,"ROLES")),i(2),p("multiple",!0),i(),p("ngForOf",n.roleList),i(2),p("ngIf",n.isEditMode),i(),p("ngIf",!n.isEditMode),i(),p("routerLink",O(34,ft)),i(2),u(" ",l(54,32,"CANCEL"),"")}},dependencies:[W,Y,V,X,z,J,K,Z,ee,k,ne,j,et,Ze,N],styles:[".example-additional-selection[_ngcontent-%COMP%]{opacity:.75;font-size:.75em}"]})}}return e})();var q=(()=>{class e{constructor(t){this.userService=t}resolve(t,o){let n=t.paramMap.get("id");return this.userService.getUser(n)}static{this.\u0275fac=function(o){return new(o||e)(fe(F))}}static{this.\u0275prov=_e({token:e,factory:e.\u0275fac})}}return e})();function Nt(e,c){e&1&&(a(0,"div",17),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"PASSWORD_IS_REQUIRED")," "))}function kt(e,c){e&1&&(a(0,"div",17),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"YOU_HAVE_TO_ENTER_AT_LEAST_DIGIT")," "))}function Lt(e,c){if(e&1&&(a(0,"div"),f(1,Nt,3,3,"div",11)(2,kt,3,3,"div",11),r()),e&2){let t,o,n=h();i(),p("ngIf",(t=n.resetPasswordForm.get("password").errors)==null?null:t.required),i(),p("ngIf",(o=n.resetPasswordForm.get("password").errors)==null?null:o.minlength)}}function Ot(e,c){e&1&&(a(0,"div",17),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"CONFIRM_PASSWORD_IS_REQUIRED")," "))}function Bt(e,c){if(e&1&&(a(0,"div"),f(1,Ot,3,3,"div",11),r()),e&2){let t,o=h();i(),p("ngIf",(t=o.resetPasswordForm.get("confirmPassword").errors)==null?null:t.required)}}function Vt(e,c){e&1&&(a(0,"div",17),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"PASSWORDS_DO_NOT_MATCH")," "))}var st=(()=>{class e extends M{constructor(t,o,n,d,g,E){super(),this.userService=t,this.fb=o,this.dialogRef=n,this.data=d,this.toastrService=g,this.translationService=E}ngOnInit(){this.createResetPasswordForm(),this.resetPasswordForm.get("email").setValue(this.data.userName)}createResetPasswordForm(){this.resetPasswordForm=this.fb.group({email:[{value:"",disabled:!0}],password:["",[x.required,x.minLength(6)]],confirmPassword:["",[x.required]]},{validator:this.checkPasswords})}checkPasswords(t){let o=t.get("password").value,n=t.get("confirmPassword").value;return o===n?null:{notSame:!0}}resetPassword(){this.resetPasswordForm.valid?this.sub$.sink=this.userService.resetPassword(this.createBuildObject()).subscribe(t=>{this.toastrService.success(this.translationService.getValue("SUCCESSFULLY_RESET_PASSWORD")),this.dialogRef.close()}):this.resetPasswordForm.markAllAsTouched()}createBuildObject(){return{email:this.resetPasswordForm.get("email").value,password:this.resetPasswordForm.get("password").value,userName:this.resetPasswordForm.get("email").value}}onNoClick(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||e)(_(F),_(te),_(Ce),_(Ee),_(D),_(P))}}static{this.\u0275cmp=w({type:e,selectors:[["app-reset-password"]],features:[T],decls:33,vars:22,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],[1,"col-md-12","m-b-10"],[1,"form-label"],["formControlName","email","type","email",1,"form-control"],["autocomplete","new-password","formControlName","password","type","password",1,"form-control"],[4,"ngIf"],[1,"col-md-12"],[1,"form-group"],["autocomplete","new-password","formControlName","confirmPassword","type","password",1,"form-control"],["class","text-danger",4,"ngIf"],["mat-dialog-actions",""],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["name","save",1,"small-icon"],[1,"btn","btn-danger","btn-sm",3,"click"],["name","x-circle",1,"small-icon"],[1,"text-danger"]],template:function(o,n){o&1&&(a(0,"h1",0),s(1),m(2,"translate"),r(),a(3,"div",1)(4,"form",2)(5,"div",3)(6,"label",4),s(7),m(8,"translate"),r(),v(9,"input",5),r(),a(10,"div",3)(11,"label",4),s(12),m(13,"translate"),r(),v(14,"input",6),f(15,Lt,3,2,"div",7),r(),a(16,"div",8)(17,"div",9)(18,"label"),s(19),m(20,"translate"),r(),v(21,"input",10),f(22,Bt,2,1,"div",7)(23,Vt,3,3,"div",11),r()()()(),a(24,"div",12)(25,"button",13),C("click",function(){return n.resetPassword()}),v(26,"i-feather",14),s(27),m(28,"translate"),r(),a(29,"button",15),C("click",function(){return n.onNoClick()}),v(30,"i-feather",16),s(31),m(32,"translate"),r()()),o&2&&(i(),S(l(2,10,"RESET_PASSWORD")),i(3),p("formGroup",n.resetPasswordForm),i(3),S(l(8,12,"EMAIL")),i(5),S(l(13,14,"PASSWORD")),i(3),p("ngIf",n.resetPasswordForm.get("password").touched&&n.resetPasswordForm.get("password").errors),i(4),S(l(20,16,"CONFIRM_PASSWORD")),i(3),p("ngIf",n.resetPasswordForm.get("confirmPassword").touched&&n.resetPasswordForm.get("confirmPassword").errors),i(),p("ngIf",n.resetPasswordForm.get("confirmPassword").touched&&n.resetPasswordForm.hasError("notSame")),i(4),u(" ",l(28,18,"SAVE"),""),i(4),u(" ",l(32,20,"CANCEL"),""))},dependencies:[Y,X,z,J,K,Z,ee,Ie,Ue,be,k,N]})}}return e})();var jt=()=>["/users/manage"];function $t(e,c){e&1&&(a(0,"div",25)(1,"ul",26)(2,"li",27)(3,"button",28),v(4,"i-feather",29),a(5,"span",30),s(6),m(7,"translate"),r()()()()()),e&2&&(i(3),p("routerLink",O(4,jt)),i(3),u(" ",l(7,2,"ADD_USER"),""))}function qt(e,c){e&1&&(a(0,"th",31)(1,"span"),s(2),m(3,"translate"),r()()),e&2&&(i(2),u(" ",l(3,1,"ACTION")," "))}function Ht(e,c){if(e&1){let t=U();a(0,"button",36),C("click",function(){I(t);let n=h().$implicit,d=h();return b(d.editUser(n.id))}),a(1,"mat-icon"),s(2,"edit"),r(),s(3),m(4,"translate"),r()}e&2&&(i(3),u(" ",l(4,1,"EDIT")," "))}function Gt(e,c){if(e&1){let t=U();a(0,"button",36),C("click",function(){I(t);let n=h().$implicit,d=h();return b(d.deleteUser(n))}),a(1,"mat-icon"),s(2,"delete"),r(),s(3),m(4,"translate"),r()}e&2&&(i(3),u(" ",l(4,1,"DELETE")," "))}function Wt(e,c){if(e&1){let t=U();a(0,"button",36),C("click",function(){I(t);let n=h().$implicit,d=h();return b(d.userPermission(n.id))}),a(1,"mat-icon"),s(2,"people"),r(),s(3),m(4,"translate"),r()}e&2&&(i(3),u(" ",l(4,1,"PERMISSION")," "))}function Yt(e,c){if(e&1){let t=U();a(0,"button",36),C("click",function(){I(t);let n=h().$implicit,d=h();return b(d.resetPassword(n))}),a(1,"mat-icon"),s(2,"key"),r(),s(3),m(4,"translate"),r()}e&2&&(i(3),u(" ",l(4,1,"RESET_PASSWORD")," "))}function Qt(e,c){if(e&1&&(a(0,"td",32)(1,"button",33)(2,"mat-icon"),s(3,"more_vert"),r()(),a(4,"mat-menu",null,0),f(6,Ht,5,3,"button",34)(7,Gt,5,3,"button",35)(8,Wt,5,3,"button",35)(9,Yt,5,3,"button",35),r()()),e&2){let t=ge(5);i(),p("matMenuTriggerFor",t),i(5),p("hasClaim","USER_EDIT_USER"),i(),p("hasClaim","USER_DELETE_USER"),i(),p("hasClaim","USER_ASSIGN_PERMISSION"),i(),p("hasClaim","USER_RESET_PASSWORD")}}function zt(e,c){e&1&&(a(0,"th",31),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"EMAIL")," "))}function Jt(e,c){if(e&1&&(a(0,"td",32),s(1),r()),e&2){let t=c.$implicit;i(),u(" ",t.email," ")}}function Kt(e,c){e&1&&(a(0,"th",31),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"FIRST_NAME")," "))}function Xt(e,c){if(e&1&&(a(0,"td",32),s(1),r()),e&2){let t=c.$implicit;i(),u(" ",t.firstName," ")}}function Zt(e,c){e&1&&(a(0,"th",31),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"LAST_NAME")," "))}function ei(e,c){if(e&1&&(a(0,"td",32),s(1),r()),e&2){let t=c.$implicit;i(),u(" ",t.lastName," ")}}function ti(e,c){e&1&&(a(0,"th",31),s(1),m(2,"translate"),r()),e&2&&(i(),u(" ",l(2,1,"MOBILE_NUMBER")," "))}function ii(e,c){if(e&1&&(a(0,"td",32),s(1),r()),e&2){let t=c.$implicit;i(),u(" ",t.phoneNumber," ")}}function ni(e,c){e&1&&v(0,"tr",37)}function ri(e,c){e&1&&v(0,"tr",38)}var mt=(()=>{class e extends M{constructor(t,o,n,d,g,E,R){super(),this.userService=t,this.toastrService=o,this.commonService=n,this.commonDialogService=d,this.dialog=g,this.router=E,this.translationService=R,this.users=[],this.displayedColumns=["action","email","firstName","lastName","phoneNumber"]}ngOnInit(){this.getUsers()}deleteUser(t){this.sub$.sink=this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE"),t.userName).subscribe(o=>{o&&(this.sub$.sink=this.userService.deleteUser(t.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_DELETED_SUCCESSFULLY")),this.getUsers()}))})}getUsers(){this.sub$.sink=this.commonService.getUsers().subscribe(t=>{this.users=t},t=>{t.messages.forEach(o=>{this.toastrService.error(o)})})}resetPassword(t){this.dialog.open(st,{width:"350px",data:Object.assign({},t)})}editUser(t){this.router.navigate(["/users/manage",t])}userPermission(t){this.router.navigate(["/users/permission",t])}static{this.\u0275fac=function(o){return new(o||e)(_(F),_(D),_(ie),_(ze),_(xe),_(B),_(P))}}static{this.\u0275cmp=w({type:e,selectors:[["app-user-list"]],features:[T],decls:34,vars:9,consts:[["menu","matMenu"],[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row","align-items-center"],[1,"col"],[1,"page-title"],[3,"code"],["class","col-auto",4,"hasClaim"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"body","table-responsive"],[1,"grid-height-large"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","firstName"],["matColumnDef","lastName"],["matColumnDef","phoneNumber"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"col-auto"],[1,"breadcrumb-list"],[1,"breadcrumb-item","bcrumb-1"],[1,"btn","btn-success","btn-sm",3,"routerLink"],["name","Plus",1,"btn-success","small-icon"],[1,"d-none","d-sm-inline"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor"],["mat-menu-item","","class","btn btn-light btn-sm",3,"click",4,"hasClaim"],["class","btn btn-light btn-sm","mat-menu-item","",3,"click",4,"hasClaim"],["mat-menu-item","",1,"btn","btn-light","btn-sm",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,n){o&1&&(a(0,"section",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"span",7),s(7),m(8,"translate"),r(),v(9,"app-page-help-text",8),r(),f(10,$t,8,5,"div",9),r()()(),a(11,"div",10)(12,"div",11)(13,"div",12)(14,"div",13)(15,"div",14)(16,"table",15),A(17,16),f(18,qt,4,3,"th",17)(19,Qt,10,5,"td",18),y(),A(20,19),f(21,zt,3,3,"th",17)(22,Jt,2,1,"td",18),y(),A(23,20),f(24,Kt,3,3,"th",17)(25,Xt,2,1,"td",18),y(),A(26,21),f(27,Zt,3,3,"th",17)(28,ei,2,1,"td",18),y(),A(29,22),f(30,ti,3,3,"th",17)(31,ii,2,1,"td",18),y(),f(32,ni,1,0,"tr",23)(33,ri,1,0,"tr",24),r()()()()()()()()),o&2&&(i(7),S(l(8,7,"USERS")),i(2),p("code","USERS"),i(),p("hasClaim","USER_CREATE_USER"),i(6),p("dataSource",n.users),i(16),p("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),i(),p("matRowDefColumns",n.displayedColumns))},dependencies:[V,Oe,Ve,He,je,Be,Ge,$e,qe,We,Ye,Fe,Me,De,ye,Ne,k,ne,j,N]})}}return e})();var oi=()=>["/users"];function ai(e,c){if(e&1){let t=U();a(0,"div",26)(1,"mat-checkbox",27),C("change",function(n){let d=I(t).$implicit,g=h().$implicit,E=h();return b(E.onPermissionChange(n,g,d))}),s(2),m(3,"translate"),r()()}if(e&2){let t=c.$implicit,o=h(2);i(),p("checked",o.checkPermission(t.id)),i(),u(" ",l(3,2,t.name.replaceAll(" ","_").toUpperCase())," ")}}function si(e,c){if(e&1){let t=U();a(0,"div",22)(1,"div",23)(2,"mat-checkbox",14),C("change",function(n){let d=I(t).$implicit,g=h();return b(g.onPageSelect(n,d))}),a(3,"b"),s(4),m(5,"translate"),r()()(),a(6,"div",24),f(7,ai,4,4,"div",25),r()()}if(e&2){let t=c.$implicit;i(4),u(" ",l(5,2,t.name.replaceAll(" ","_").toUpperCase()),""),i(3),p("ngForOf",t.pageActions)}}var lt=(()=>{class e extends M{constructor(t){super(),this.translationService=t,this.manageUserClaimAction=new ve,this.step=0}checkPermission(t){return!!this.user.userClaims.find(n=>n.actionId===t)}onPermissionChange(t,o,n){if(t.checked)this.user.userClaims.push({userId:this.user.id,claimType:n.code,claimValue:"",actionId:n.id});else{let d=this.user.userClaims.find(E=>E.actionId===n.id),g=this.user.userClaims.indexOf(d,0);g>-1&&this.user.userClaims.splice(g,1)}}onPageSelect(t,o){if(t.checked)o.pageActions.forEach(n=>{this.checkPermission(n.id)||this.user.userClaims.push({userId:this.user.id,claimType:n.code,claimValue:"",actionId:n.id})});else{let n=o.pageActions?.map(d=>d.id);this.user.userClaims=this.user.userClaims.filter(d=>n.indexOf(d.actionId)<0)}}saveUserClaim(){this.manageUserClaimAction.emit(this.user)}selecetAll(t){t.checked?this.pages.forEach(o=>{o.pageActions.forEach(n=>{this.checkPermission(n.id)||this.user.userClaims.push({userId:this.user.id,claimType:n.code,claimValue:"",actionId:n.id})})}):this.user.userClaims=[]}static{this.\u0275fac=function(o){return new(o||e)(_(P))}}static{this.\u0275cmp=w({type:e,selectors:[["app-user-permission-presentation"]],inputs:{pages:"pages",user:"user"},outputs:{manageUserClaimAction:"manageUserClaimAction"},features:[T],decls:37,vars:20,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row"],[1,"col-md-6","mb-2"],[1,"mb-0","page-title"],["code","USER_PAGE_PERMISSION_TO"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"body"],[1,"row","margin-2"],[1,"col-sm-12"],[1,"widget-title"],["color","primary",3,"change"],[1,"col-sm-12","alt-bg"],["fxLayout","row wrap","class","wrap",4,"ngFor","ngForOf"],[1,"col-sm-12","mt-2"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["name","save",1,"small-icon"],[1,"btn","btn-danger","btn-sm",3,"routerLink"],["name","x-circle",1,"small-icon"],["fxLayout","row wrap",1,"wrap"],["fxFlex","100","fxFlex.sm","100"],[1,"row","m-l-15"],["class","col-sm-3 row",4,"ngFor","ngForOf"],[1,"col-sm-3","row"],["color","primary",3,"change","checked"]],template:function(o,n){o&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),s(7),m(8,"translate"),a(9,"span"),s(10),v(11,"app-page-help-text",7),r()()()()()(),a(12,"div",4)(13,"div",8)(14,"div",9)(15,"div",10)(16,"div",11)(17,"div",12)(18,"h4",13),s(19),m(20,"translate"),r(),a(21,"mat-checkbox",14),C("change",function(g){return n.selecetAll(g)}),s(22),m(23,"translate"),r()()(),a(24,"div",4)(25,"div",15),f(26,si,8,4,"div",16),r()(),a(27,"div",4)(28,"div",17)(29,"button",18),C("click",function(){return n.saveUserClaim()}),v(30,"i-feather",19),s(31),m(32,"translate"),r(),a(33,"button",20),v(34,"i-feather",21),s(35),m(36,"translate"),r()()()()()()()()()),o&2&&(i(7),u("",l(8,9,"USER_PAGE_PERMISSION_TO")," "),i(3),he("",n.user==null?null:n.user.firstName," ",n.user==null?null:n.user.lastName," "),i(9),S(l(20,11,"PERMISSION")),i(3),u(" ",l(23,13,"SELECT_ALL")," "),i(4),p("ngForOf",n.pages),i(5),u(" ",l(32,15,"SAVE")," "),i(2),p("routerLink",O(19,oi)),i(2),u(" ",l(36,17,"CANCEL")," "))},dependencies:[W,V,k,j,Ke,N]})}}return e})();var pt=(()=>{class e extends M{constructor(t,o,n,d,g,E,R){super(),this.activeRoute=t,this.router=o,this.toastrService=n,this.pageService=d,this.actionService=g,this.userService=E,this.translationService=R}ngOnInit(){this.sub$.sink=this.activeRoute.data.subscribe(n=>{this.user=n.user});let t=this.actionService.getAll(),o=this.pageService.getAll();ue({getActionRequest:t,getPageRequest:o}).subscribe(n=>{this.pages=n.getPageRequest,this.pages=this.pages.map(d=>{let g=n.getActionRequest.filter(R=>R.pageId==d.id);return Object.assign({},d,{pageActions:g})})})}manageUserClaimAction(t){this.sub$.sink=this.userService.updateUserClaim(t.userClaims,t.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("USER_PERMISSION_UPDATED_SUCCESSFULLY")),this.router.navigate(["/users"])},o=>{this.toastrService.error(o.error.message)})}static{this.\u0275fac=function(o){return new(o||e)(_(Q),_(B),_(D),_(it),_(nt),_(F),_(P))}}static{this.\u0275cmp=w({type:e,selectors:[["app-user-permission"]],features:[T],decls:1,vars:2,consts:[[3,"manageUserClaimAction","pages","user"]],template:function(o,n){o&1&&(a(0,"app-user-permission-presentation",0),C("manageUserClaimAction",function(g){return n.manageUserClaimAction(g)}),r()),o&2&&p("pages",n.pages)("user",n.user)},dependencies:[lt]})}}return e})();var li=[{path:"",component:mt,data:{claimType:"USER_VIEW_USERS"},canActivate:[$]},{path:"manage/:id",component:ce,resolve:{user:q},data:{claimType:"USER_EDIT_USER"},canActivate:[$]},{path:"manage",component:ce,data:{claimType:"USER_CREATE_USER"},canActivate:[$]},{path:"permission/:id",component:pt,resolve:{user:q},data:{claimType:"USER_ASSIGN_PERMISSION"},canActivate:[$]}],ct=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=G({type:e})}static{this.\u0275inj=H({imports:[ae.forChild(li),ae]})}}return e})();var Cn=(()=>{class e{static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275mod=G({type:e})}static{this.\u0275inj=H({providers:[q],imports:[Se,ct,we,Te,Qe,Re,Le,Je,ke,Ae,rt,Xe,Pe,tt]})}}return e})();export{Cn as UserModule};
