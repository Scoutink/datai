import{a as Fe}from"./chunk-DWTLO2NW.js";import{a as Ne}from"./chunk-CZA53JXZ.js";import{a as je}from"./chunk-EDFYBFRY.js";import{H as de,I as ue,J as ge,K as he,L as fe,M as be,N as Ce,O as _e,P as Se,Q as xe,R as Le,S as Je,T as Te,U as we,V as ve,W as ye,Y as T,Z as De,_ as Ee,ba as w,c as ce,ca as Re,f as pe,ha as Me,ja as Ie}from"./chunk-H5SZDBVN.js";import"./chunk-XE6VZSAJ.js";import{a as me}from"./chunk-KX634QZQ.js";import{F as te}from"./chunk-3O3IKF6A.js";import{ia as re}from"./chunk-TR4MAYT5.js";import{t as le}from"./chunk-AWIVOLPG.js";import"./chunk-J2LIJEQH.js";import{b as se}from"./chunk-AGIEFCW2.js";import"./chunk-F5F27R7A.js";import{C as ae,c as oe,h as ie,n as ne}from"./chunk-6EN4EXPL.js";import{$ as A,$b as C,B,Ba as V,Cb as l,Ea as D,Fc as u,Gb as b,Gc as h,Hc as O,Ka as Q,Q as k,Qb as a,Rb as s,Sb as g,Ta as x,Tb as p,Ua as L,Ub as d,W as S,Wb as J,Zb as W,dd as K,fa as z,fc as R,gc as M,ha as P,hc as I,mc as m,nc as G,o as H,ob as n,oc as c,p as _,pb as E,pd as Y,sc as j,tc as N,td as Z,uc as F,wa as $,xc as q,xd as ee,yc as X,zb as U}from"./chunk-SXJN2XK6.js";var v=class{get count(){return this._count}constructor(o){this.cronJobLogService=o,this.cronJobSubject=new _([]),this.responseHeaderSubject=new _(null),this.loadingSubject=new _(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}connect(){return this.cronJobSubject.asObservable()}disconnect(){this.cronJobSubject.complete(),this.loadingSubject.complete()}loadCronJobLogs(o){this.loadingSubject.next(!0),this.cronJobLogService.getCronJobLogs(o).pipe(S(()=>B([])),P(()=>this.loadingSubject.next(!1))).subscribe(t=>{if(t&&t.headers){let i=new Ne;i.pageSize=parseInt(t.headers.get("pageSize")),i.totalCount=parseInt(t.headers.get("totalCount")),i.skip=parseInt(t.headers.get("skip")),this.responseHeaderSubject.next(i);let r=[...t.body];this._count=r.length,this.cronJobSubject.next(r)}})}};var y=class extends je{constructor(){super(...arguments),this.jobName="",this.output=""}};var Oe=(()=>{class e{constructor(t,i){this.httpClient=t,this.commonHttpErrorService=i}getCronJobLogs(t){let i="cron-job-logs",r=new Z().set("fields",t.fields).set("orderBy",t.orderBy).set("pageSize",t.pageSize.toString()).set("skip",t.skip.toString()).set("searchQuery",t.searchQuery).set("jobName",t.jobName).set("output",t.output);return this.httpClient.get(i,{params:r,observe:"response"}).pipe(S(this.commonHttpErrorService.handleError))}static{this.\u0275fac=function(i){return new(i||e)(D(ee),D(se))}}static{this.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ke=()=>[10,20,30];function Ae(e,o){if(e&1){let t=J();a(0,"button",39),W("click",function(){x(t);let r=C();return L(r.manageLogsRetention())}),g(1,"i-feather",40),a(2,"span",41),m(3),u(4,"translate"),s()()}e&2&&(n(3),c(" ",h(4,1,"SETTINGS"),""))}function ze(e,o){e&1&&(a(0,"th",42),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"STARTED_AT")," "))}function Pe(e,o){if(e&1&&(a(0,"td",43),m(1),u(2,"utcToLocalTime"),s()),e&2){let t=o.$implicit;n(),c(" ",O(2,1,t==null?null:t.startedAt,"short")," ")}}function $e(e,o){e&1&&(a(0,"th",44),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"EXECUTION_TIME")," "))}function Ve(e,o){if(e&1&&(a(0,"td",45),m(1),s()),e&2){let t=o.$implicit;n(),c(" ",t.executionTime==0?"1":t.executionTime," seconds ")}}function Qe(e,o){e&1&&(a(0,"th",42),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"ENDED_AT")," "))}function Ue(e,o){if(e&1&&(a(0,"td",43),m(1),u(2,"utcToLocalTime"),s()),e&2){let t=o.$implicit;n(),c(" ",O(2,1,t.endedAt,"short")," ")}}function We(e,o){e&1&&(a(0,"th",44),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"JOB_NAME")," "))}function Ge(e,o){if(e&1&&(a(0,"td",45),m(1),s()),e&2){let t=o.$implicit;n(),c(" ",t.jobName," ")}}function qe(e,o){e&1&&(a(0,"th",44),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"STATUS")," "))}function Xe(e,o){e&1&&(a(0,"span",48),m(1),u(2,"translate"),s()),e&2&&(n(),G(h(2,1,"SUCCESS")))}function Ke(e,o){e&1&&(a(0,"span",49),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"FAILED")," "))}function Ye(e,o){if(e&1&&(a(0,"td",45),l(1,Xe,3,3,"span",46)(2,Ke,3,3,"span",47),s()),e&2){let t=o.$implicit;n(),b("ngIf",(t==null?null:t.status.toLocaleLowerCase())=="success"),n(),b("ngIf",(t==null?null:t.status.toLocaleLowerCase())=="failed")}}function Ze(e,o){e&1&&(a(0,"th",44),m(1),u(2,"translate"),s()),e&2&&(n(),c(" ",h(2,1,"ERROR")," "))}function et(e,o){if(e&1&&(a(0,"td",45),m(1),s()),e&2){let t=o.$implicit;n(),c(" ",t.output," ")}}function tt(e,o){e&1&&g(0,"th",50)}function ot(e,o){e&1&&g(0,"th",50)}function it(e,o){e&1&&g(0,"th",50)}function nt(e,o){if(e&1){let t=J();a(0,"th",50)(1,"input",51),F("ngModelChange",function(r){x(t);let f=C();return N(f.JobNameFilter,r)||(f.JobNameFilter=r),L(r)}),s()()}if(e&2){let t=C();n(),j("ngModel",t.JobNameFilter)}}function at(e,o){e&1&&g(0,"th",50)}function rt(e,o){if(e&1){let t=J();a(0,"th",50)(1,"input",51),F("ngModelChange",function(r){x(t);let f=C();return N(f.OutputFilter,r)||(f.OutputFilter=r),L(r)}),s()()}if(e&2){let t=C();n(),j("ngModel",t.OutputFilter)}}function st(e,o){if(e&1&&(a(0,"td",52),g(1,"mat-paginator",53),s()),e&2){let t=C();n(),b("length",t.cronJobLogResource.totalCount)("pageSize",t.cronJobLogResource.pageSize)("pageSizeOptions",X(3,ke))}}function lt(e,o){e&1&&(a(0,"tr")(1,"td",54)(2,"span",55)(3,"b"),m(4),u(5,"translate"),s()()()()),e&2&&(n(4),c(" ",h(5,1,"NO_DATA_FOUND"),""))}function mt(e,o){e&1&&g(0,"tr",56)}function ct(e,o){e&1&&g(0,"tr",57)}function pt(e,o){e&1&&g(0,"tr",58)}function dt(e,o){e&1&&g(0,"tr",59)}var Qt=(()=>{class e extends re{get JobNameFilter(){return this._jobNameFilter}set JobNameFilter(t){this._jobNameFilter=t;let i=`jobName##${t}`;this.filterObservable$.next(i)}get OutputFilter(){return this._outputFilter}set OutputFilter(t){this._outputFilter=t;let i=`output##${t}`;this.filterObservable$.next(i)}constructor(t,i){super(),this.cronJobLogService=t,this.dialog=i,this.cronJobLogs=[],this.displayedColumns=["startedAt","executionTime","endedAt","jobName","status","output"],this.displayedSearchColumns=["startedAt-search","executionTime-search","endedAt-search","jobName-search","status-search","output-search"],this.footerToDisplayed=["footer"],this.filterObservable$=new H,this.cronJobLogResource=new y,this.cronJobLogResource.pageSize=10,this.cronJobLogResource.orderBy="startedAt desc"}ngOnInit(){this.dataSource=new v(this.cronJobLogService),this.dataSource.loadCronJobLogs(this.cronJobLogResource),this.getResourceParameter(),this.sub$.sink=this.filterObservable$.pipe(A(1e3),z()).subscribe(t=>{this.cronJobLogResource.skip=0,this.paginator.pageIndex=0;let i=t.split("##");i[0]==="jobName"?this.cronJobLogResource.jobName=i[1]:i[0]==="output"&&(this.cronJobLogResource.output=i[1]),this.dataSource.loadCronJobLogs(this.cronJobLogResource)})}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=k(this.sort.sortChange,this.paginator.page).pipe($(t=>{this.cronJobLogResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.cronJobLogResource.pageSize=this.paginator.pageSize,this.cronJobLogResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadCronJobLogs(this.cronJobLogResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(t=>{t&&(this.cronJobLogResource.pageSize=t.pageSize,this.cronJobLogResource.skip=t.skip,this.cronJobLogResource.totalCount=t.totalCount)})}manageLogsRetention(){this.dialog.open(Fe,{width:"35vw",maxHeight:"70vh",data:{type:"cron-job-log-setting"}})}static{this.\u0275fac=function(i){return new(i||e)(E(Oe),E(te))}}static{this.\u0275cmp=Q({type:e,selectors:[["app-cron-job-logs"]],viewQuery:function(i,r){if(i&1&&(R(w,5),R(T,5)),i&2){let f;M(f=I())&&(r.paginator=f.first),M(f=I())&&(r.sort=f.first)}},standalone:!0,features:[U,q],decls:54,vars:10,consts:[[1,"content"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col","mb-2"],[1,"mb-0","page-title"],["code","CRON_JOB_LOGS"],[1,"col-auto"],[1,"breadcrumb-list"],[1,"breadcrumb-item","bcrumb-1"],["class","btn btn-primary btn-sm",3,"click",4,"hasClaim"],[1,"card"],[1,"body"],[1,"table-responsive"],[1,"grid-height-large"],["mat-table","","matSortDisableClear","","matSort","","matSortActive","startedAt","matSortDirection","asc",3,"dataSource"],["matColumnDef","startedAt"],["class","table-column-190","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-190","mat-cell","",4,"matCellDef"],["matColumnDef","executionTime"],["class","table-column-150","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-150","mat-cell","",4,"matCellDef"],["matColumnDef","endedAt"],["matColumnDef","jobName"],["matColumnDef","status"],["matColumnDef","output"],["matColumnDef","startedAt-search","sticky",""],["class","pr-5","mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","executionTime-search","sticky",""],["matColumnDef","endedAt-search","sticky",""],["matColumnDef","jobName-search","sticky",""],["matColumnDef","status-search","sticky",""],["matColumnDef","output-search","sticky",""],["matColumnDef","footer"],["mat-footer-cell","","colspan","6",4,"matFooterCellDef"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-row","","class","example-second-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-footer-row","",4,"matFooterRowDef"],[1,"btn","btn-primary","btn-sm",3,"click"],["name","settings",1,"small-icon","me-1"],[1,"d-none","d-sm-inline"],["mat-header-cell","","mat-sort-header","",1,"table-column-190"],["mat-cell","",1,"table-column-190"],["mat-header-cell","","mat-sort-header","",1,"table-column-150"],["mat-cell","",1,"table-column-150"],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"badge","bg-success"],[1,"badge","bg-danger"],["mat-header-cell","",1,"pr-5"],["type","text",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],["mat-footer-cell","","colspan","6"],[3,"length","pageSize","pageSizeOptions"],["colspan","9"],[1,"p-4","mt-4"],["mat-header-row",""],["mat-row",""],["mat-header-row","",1,"example-second-header-row"],["mat-footer-row",""]],template:function(i,r){i&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),m(5),u(6,"translate"),g(7,"app-page-help-text",5),s()(),a(8,"div",6)(9,"ul",7)(10,"li",8),l(11,Ae,5,3,"button",9),s()()()(),a(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13)(16,"table",14),p(17,15),l(18,ze,3,3,"th",16)(19,Pe,3,4,"td",17),d(),p(20,18),l(21,$e,3,3,"th",19)(22,Ve,2,1,"td",20),d(),p(23,21),l(24,Qe,3,3,"th",16)(25,Ue,3,4,"td",17),d(),p(26,22),l(27,We,3,3,"th",19)(28,Ge,2,1,"td",20),d(),p(29,23),l(30,qe,3,3,"th",19)(31,Ye,3,2,"td",20),d(),p(32,24),l(33,Ze,3,3,"th",19)(34,et,2,1,"td",20),d(),p(35,25),l(36,tt,1,0,"th",26),d(),p(37,27),l(38,ot,1,0,"th",26),d(),p(39,28),l(40,it,1,0,"th",26),d(),p(41,29),l(42,nt,2,1,"th",26),d(),p(43,30),l(44,at,1,0,"th",26),d(),p(45,31),l(46,rt,2,1,"th",26),d(),p(47,32),l(48,st,2,4,"td",33),d(),l(49,lt,6,3,"tr",34)(50,mt,1,0,"tr",35)(51,ct,1,0,"tr",36)(52,pt,1,0,"tr",37)(53,dt,1,0,"tr",38),s()()()()()()()),i&2&&(n(5),c("",h(6,8,"CRON_JOB_LOGS")," "),n(6),b("hasClaim","CRON_JOB_LOG_SET_RETENTION_PERIOD"),n(5),b("dataSource",r.dataSource),n(34),b("matHeaderRowDef",r.displayedColumns),n(),b("matRowDefColumns",r.displayedColumns),n(),b("matHeaderRowDef",r.displayedSearchColumns)("matHeaderRowDefSticky",!0),n(),b("matFooterRowDef",r.footerToDisplayed))},dependencies:[Y,K,ae,oe,ie,ne,Ie,de,ge,Se,fe,ue,Le,he,xe,be,_e,Ce,Je,we,Te,ve,T,De,w,me,ce,Me,le,pe,ye,Re,Ee]})}}return e})();export{Qt as CronJobLogsComponent};
