import{b as _e}from"./chunk-AOB66FZH.js";import{a as ue}from"./chunk-BCPCIHCF.js";import{e as de}from"./chunk-BA7IEC3F.js";import{a as pe,b as fe}from"./chunk-HCZMPLJU.js";import"./chunk-BPDXJVZ2.js";import{A as ie,C as ne,W as re,b as A,ca as ae,ea as me,f as Z,ha as ce,i as ee,ja as se,k as te}from"./chunk-H5SZDBVN.js";import{c as Y,d as X,e as le}from"./chunk-XE6VZSAJ.js";import{a as J,b as Q}from"./chunk-KX634QZQ.js";import{F as B,L as H}from"./chunk-3O3IKF6A.js";import{ia as K,ja as z,na as oe}from"./chunk-TR4MAYT5.js";import{p as j,t as G,u as q}from"./chunk-AWIVOLPG.js";import"./chunk-J2LIJEQH.js";import"./chunk-AGIEFCW2.js";import"./chunk-F5F27R7A.js";import{C as $,D as U}from"./chunk-6EN4EXPL.js";import{$b as u,Cb as v,Fa as p,Fc as c,Gb as g,Gc as s,Hc as P,Ka as I,Mb as W,Pd as L,Qb as r,Rb as n,Sb as k,Ta as _,Tb as b,Ua as w,Ub as S,Wb as M,Xa as h,Zb as x,bd as N,cd as R,dc as O,mc as a,nc as E,ob as o,oc as m,pc as F,pd as V,rc as y,xc as D,zb as T}from"./chunk-SXJN2XK6.js";function we(i,f){i&1&&(r(0,"div",8)(1,"h6",10),a(2),c(3,"translate"),n()()),i&2&&(o(2),E(s(3,1,"NO_WORKFLOW_ASSIGNED")))}function ve(i,f){if(i&1){let e=M();b(0),r(1,"button",28),x("click",function(){let l=_(e).$implicit,d=u().$implicit,C=u(2);return w(C.performTransition(l,d))}),a(2),n(),S()}if(i&2){let e=f.$implicit;o(),O("ngClass","workflow_",e.color,""),o(),F(" ",e.name," (",e.fromToStepName,") ")}}function ge(i,f){if(i&1){let e=M();r(0,"div",9)(1,"div",12)(2,"span",13),a(3),c(4,"translate"),n()(),r(5,"div",14)(6,"div",15)(7,"div",16)(8,"div",17)(9,"label",13),a(10),c(11,"translate"),n(),r(12,"a",18),x("click",function(){let l=_(e).$implicit,d=u(2);return w(d.onDocumentView(l.documentId))}),a(13),n()()(),r(14,"div",19)(15,"div",17)(16,"label",13),a(17),c(18,"translate"),n(),r(19,"span",20),a(20),n()()(),r(21,"div",21)(22,"div",17)(23,"label",13),a(24),c(25,"translate"),n(),r(26,"span",22),a(27),n()()(),r(28,"div",21)(29,"div",17)(30,"label",13),a(31),c(32,"translate"),n(),r(33,"span",22),a(34),c(35,"utcToLocalTime"),n()()()(),r(36,"div",15)(37,"div",23)(38,"div",17)(39,"label",13),a(40),c(41,"translate"),n(),r(42,"div",24)(43,"button",25),x("click",function(){let l=_(e).$implicit,d=u(2);return w(d.viewVisualWorkflow(l))}),k(44,"i-feather",26),a(45),c(46,"translate"),n(),b(47),v(48,ve,3,4,"ng-container",27),S(),n()()()()()()}if(i&2){let e=f.$implicit,t=f.index;o(3),y(" ",t+1," ",")"," \xA0 ",s(4,16,"WORKFLOW_NAME")," - ",e==null?null:e.workflowName," "),o(7),m(" ",s(11,18,"DOCUMENT"),""),o(3),m(" ",e==null?null:e.documentName," "),o(4),m(" ",s(18,20,"WORKFLOW_STATUS"),""),o(2),g("workflowstatuscolor",e.status),o(),m(" ",e==null?null:e.status," "),o(4),m(" ",s(25,22,"INITIATED_BY"),""),o(3),m(" ",e==null?null:e.initiatedBy," "),o(4),m(" ",s(32,24,"WORKFLOW_INITIATED_AT")," "),o(3),m(" ",P(35,26,e==null?null:e.createdDate,"short")," "),o(6),m(" ",s(41,29,"PERFORM_TRANSITION"),""),o(5),m(" ",s(46,31,"VIEW_WORKFLOW")," "),o(3),g("ngForOf",e.nextTransitions)}}function xe(i,f){if(i&1&&v(0,ge,49,33,"div",11),i&2){let e=u();g("ngForOf",e.workflowInstances)}}var ot=(()=>{class i extends K{constructor(){super(...arguments),this.workflowInstances=[],this.displayedColumns=["transition","updatedAt","workflowname","workflowstatus","workflowInitiatedDate","initiatedUser","documentname","lastTransition","updatedAt","performBy"],this.footerToDisplayed=["footer"],this.dialog=p(B),this.overlay=p(Y),this.documentWorkflowService=p(pe),this.commonDialogService=p(me),this.translationService=p(z),this.commonService=p(H),this.toastrService=p(j),this.documentService=p(le),this.positionOptions=["below","above","left","right"]}ngOnInit(){this.getWorkflows()}getWorkflows(){this.sub$.sink=this.documentWorkflowService.getMyWorkflow().subscribe({next:e=>{this.workflowInstances=e},error:()=>{}})}performTransition(e,t){this.commonDialogService.deleteConfirmWithCommentDialog(`${this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_PROCEED_WITH_THIS_WORKFLOW_TRANSITION")}:: ${e.name} ?`).subscribe(l=>{if(l.flag){let d={transitionId:e.id,comment:l.comment,documentId:t.documentId,documentWorkflowId:t.documentWorkflowId};this.documentWorkflowService.performNextTransition(d).subscribe({next:()=>{this.toastrService.success(`${e.name} ${this.translationService.getValue("HAS_BEEN_SUCCESSFULLY_COMPLETED")}`),this.getWorkflows()},error:()=>{}})}})}viewVisualWorkflow(e){this.documentWorkflowService.getRunningVisualWorkflow(e.documentWorkflowId).subscribe({next:t=>{t.documentId=e.documentId,t.documentName=e.documentName,this.dialog.open(fe,{width:"90vw",data:Object.assign({},t)})}})}onDocumentView(e){this.documentService.getDocument(e).subscribe(t=>{let d=t.url.split(".")[1],C={documentId:t.id,name:t.name,extension:d,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1};this.overlay.open(X,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:C})})}static{this.\u0275fac=(()=>{let e;return function(l){return(e||(e=h(i)))(l||i)}})()}static{this.\u0275cmp=I({type:i,selectors:[["app-manage-current-workflow"]],standalone:!0,features:[T,D],decls:12,vars:4,consts:[[1,"content"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-md-6","mb-2"],[1,"mb-0","page-title"],["code","CURRENT_WORKFLOWS"],[1,"card"],[1,"body"],[1,"text-left","mt-1"],[1,"card","p-2","mb-1",2,"border","1px solid #d3d4d6"],[1,"text-muted"],["class","card p-2 mb-1","style","border: 1px solid #d3d4d6;",4,"ngFor","ngForOf"],[1,"card-header"],[1,"fw-bold"],[1,"card-body"],[1,"row"],[1,"col-sm-4"],[1,"form-group"],[1,"doc-link","form-control-plaintext","form-control-sm",3,"click"],[1,"col-sm-2"],[1,"form-control-plaintext","form-control-sm",3,"workflowstatuscolor"],[1,"col-sm-3"],[1,"form-control-plaintext","form-control-sm"],[1,"col"],[1,"d-flex","flex-column","flex-md-row","gap-2"],[1,"btn","btn-sm","mb-1","mt-1","btn-primary",3,"click"],["name","eye",1,"small-icon"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","mb-1","mt-1",3,"click","ngClass"]],template:function(t,l){t&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),a(5),c(6,"translate"),k(7,"app-page-help-text",5),n()()(),r(8,"div",6)(9,"div",7),v(10,we,4,3,"div",8)(11,xe,1,1,"div",9),n()()()()),t&2&&(o(5),m(" ",s(6,2,"MY_WORKFLOWS")," "),o(5),W((l.workflowInstances==null?null:l.workflowInstances.length)===0?10:11))},dependencies:[$,q,G,V,N,R,L,oe,U,Q,J,te,de,ue,ie,re,ne,_e,se,ce,Z,ee,ae,A],styles:[".transition-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.transition-item[_ngcontent-%COMP%]{background-color:#f1f1f1;padding:4px 8px;border-radius:4px}  .mat-mdc-table{display:block;width:100%;overflow-x:auto}.workflow_approved[_ngcontent-%COMP%]{color:#000!important;background-color:#28a745!important}.workflow_rejected[_ngcontent-%COMP%]{color:#fff!important;background-color:#dc3545!important}.workflow_pending[_ngcontent-%COMP%]{color:#000!important;background-color:#ffc107!important}.workflow_inprogress[_ngcontent-%COMP%]{color:#fff!important;background-color:#6777ef!important}.workflow_onhold[_ngcontent-%COMP%]{color:#000!important;background-color:#6c757d!important}.workflow_cancelled[_ngcontent-%COMP%]{color:#fff!important;background-color:#343a40!important}.workflow_escalated[_ngcontent-%COMP%]{color:#fff!important;background-color:#fd7e14!important}.workflow_completed[_ngcontent-%COMP%]{color:#fff!important;background-color:#198754!important}"]})}}return i})();export{ot as ManageCurrentWorkflowComponent};
