import{a as Ce,b as E}from"./chunk-BFIBOEJN.js";import{b as ge}from"./chunk-6RIQ7ZPY.js";import{b as ve}from"./chunk-6KAN7QFK.js";import{b as he}from"./chunk-I5DMEMR4.js";import"./chunk-DDGV2SYP.js";import"./chunk-4PLUQBVO.js";import{a as Ee,b as Ie,c as Se}from"./chunk-WGGER5HX.js";import"./chunk-V4GBUP5U.js";import{A as se,C as ce,aa as ue,j as pe,ja as fe,k as le}from"./chunk-H5SZDBVN.js";import"./chunk-XE6VZSAJ.js";import"./chunk-KX634QZQ.js";import"./chunk-3O3IKF6A.js";import{ia as ie,ja as oe,ka as de,na as me}from"./chunk-TR4MAYT5.js";import{p as re,t as ae,u as ne}from"./chunk-AWIVOLPG.js";import"./chunk-J2LIJEQH.js";import"./chunk-AGIEFCW2.js";import"./chunk-F5F27R7A.js";import{B as Z,C as ee,D as te,c as U,e as y,h as W,i as $,o as z,r as K,u as X}from"./chunk-6EN4EXPL.js";import{$b as _,Ca as I,Cb as u,Fa as S,Fc as p,Gb as m,Gc as l,Hb as A,Ka as D,Kd as q,La as C,Md as J,Nd as Q,Pd as P,Qb as a,Rb as r,Sb as x,Ta as B,Ua as O,Wb as w,Zb as T,a as b,b as N,cc as h,cd as V,dd as Y,fc as k,gc as j,h as F,hc as L,mc as n,nc as g,ob as t,oc as s,pb as v,pd as H,yc as G,zb as R}from"./chunk-SXJN2XK6.js";var M=function(e){return e.DOC="DOC",e.SHEET="SHEET",e.WHITEBOARD="WHITEBOARD",e.WYSIWYG="WYSIWYG",e}(M||{});var Pe=()=>["/papers"];function be(e,c){e&1&&(a(0,"div",30),n(1),p(2,"translate"),r()),e&2&&(t(),s(" ",l(2,1,"NAME_IS_REQUIRED")," "))}function Ne(e,c){if(e&1&&(a(0,"div",15)(1,"label",16),n(2),p(3,"translate"),r(),a(4,"ng-select",31)(5,"ng-option",32)(6,"mat-icon",33),n(7,"description"),r(),n(8),p(9,"translate"),r(),a(10,"ng-option",32)(11,"mat-icon",33),n(12,"grid_on"),r(),n(13),p(14,"translate"),r()()()),e&2){let i=_();t(2),s("",l(3,6,"CONTENT_TYPE")," *"),t(2),m("clearable",!1),t(),m("value",i.paperContentType.DOC),t(3),s(" ",l(9,8,"DOCUMENT")," "),t(2),m("value",i.paperContentType.SHEET),t(3),s(" ",l(14,10,"SHEET")," ")}}function Fe(e,c){if(e&1&&(a(0,"ng-option",32),n(1),r()),e&2){let i=c.$implicit;m("value",i.id),t(),s(" ",i.name," ")}}function De(e,c){e&1&&(a(0,"div",30),n(1),p(2,"translate"),r()),e&2&&(t(),s(" ",l(2,1,"CATEGORY_IS_REQUIRED")," "))}function Be(e,c){if(e&1&&(a(0,"ng-option",32),n(1),r()),e&2){let i=c.$implicit;m("value",i.id),t(),s(" ",i.companyName," ")}}function Oe(e,c){if(e&1&&(a(0,"ng-option",32)(1,"span"),n(2),r()()),e&2){let i=c.$implicit;m("value",i.id),t(),A("color",i.colorCode),t(),g(i.name)}}function Re(e,c){if(e&1){let i=w();a(0,"app-paper-editor",34),T("onChange",function(o){B(i);let f=_();return O(f.onEditorChange(o))}),r()}if(e&2){let i=_();m("data",i.editorData)("paperId",i.paperId)("mode",i.paperForm.value.contentType===i.paperContentType.DOC?"DOC":"SHEET")}}var ye=(()=>{class e extends ie{constructor(i,d,o,f,xe,Te){super(),this.fb=i,this.route=d,this.router=o,this.paperService=f,this.toastrService=xe,this.translationService=Te,this.isEditMode=!1,this.paperContentType=M,this.categoryStore=S(he),this.clientStore=S(ve),this.documentStatusStore=S(ge),this.createForm()}ngOnInit(){this.paperId=this.route.snapshot.params.id,this.paperId&&(this.isEditMode=!0,this.getPaper())}createForm(){this.paperForm=this.fb.group({name:["",[y.required]],contentType:[M.DOC,[y.required]],categoryId:["",[y.required]],clientId:[""],statusId:[""],description:[""]})}getPaper(){this.sub$.sink=this.paperService.getPaper(this.paperId).subscribe(i=>{if(this.paperData=i,this.paperForm.patchValue(i),i.contentJson)try{this.editorData=JSON.parse(i.contentJson)}catch(d){console.error("Failed to parse paper content JSON:",d),this.editorData=null}})}onEditorChange(i){this.editorData=i}savePaper(){return F(this,null,function*(){if(this.paperForm.invalid){this.paperForm.markAllAsTouched();return}let i=yield this.editor.save(),d=N(b({},this.paperForm.value),{contentJson:JSON.stringify(i)});this.isEditMode?this.sub$.sink=this.paperService.updatePaper(this.paperId,d).subscribe(()=>{this.toastrService.success("Paper updated successfully"),this.router.navigate(["/papers/assigned"])}):this.sub$.sink=this.paperService.addPaper(d).subscribe(()=>{this.toastrService.success("Paper created successfully"),this.router.navigate(["/papers/assigned"])})})}static{this.\u0275fac=function(d){return new(d||e)(v(Z),v(q),v(J),v(Ce),v(re),v(oe))}}static{this.\u0275cmp=D({type:e,selectors:[["app-paper-manage"]],viewQuery:function(d,o){if(d&1&&k(E,5),d&2){let f;j(f=L())&&(o.editor=f.first)}},features:[R],decls:70,vars:53,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row"],[1,"col-6"],[1,"page-title"],[1,"col-6","text-right"],["mat-raised-button","","color","primary",1,"m-r-10",3,"click"],["mat-flat-button","","color","warn",3,"routerLink"],[1,"col-xl-3","col-lg-4","col-md-12","col-sm-12"],[1,"card"],[1,"header"],[1,"body"],[3,"formGroup"],[1,"col-12","m-b-10"],[1,"form-label"],["formControlName","name","type","text",1,"form-control",3,"placeholder"],["class","text-danger",4,"ngIf"],["class","col-12 m-b-10",4,"ngIf"],["formControlName","categoryId",3,"placeholder","clearable"],[3,"value",4,"ngFor","ngForOf"],["formControlName","clientId",3,"placeholder"],["formControlName","statusId",3,"placeholder"],[1,"col-12"],["formControlName","description","rows","4",1,"form-control",3,"placeholder"],[1,"col-xl-9","col-lg-8","col-md-12","col-sm-12"],[1,"card","shadow-sm"],[1,"body","bg-white","p-4",2,"min-height","80vh"],[3,"data","paperId","mode","onChange",4,"ngIf"],[1,"text-danger"],["formControlName","contentType",3,"clearable"],[3,"value"],[1,"align-middle"],[3,"onChange","data","paperId","mode"]],template:function(d,o){d&1&&(a(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),n(7),p(8,"translate"),r()(),a(9,"div",7)(10,"button",8),T("click",function(){return o.savePaper()}),a(11,"mat-icon"),n(12,"save"),r(),n(13),p(14,"translate"),r(),a(15,"button",9)(16,"mat-icon"),n(17,"close"),r(),n(18),p(19,"translate"),r()()()()(),a(20,"div",4)(21,"div",10)(22,"div",11)(23,"div",12)(24,"h2"),n(25),p(26,"translate"),r()(),a(27,"div",13)(28,"form",14)(29,"div",4)(30,"div",15)(31,"label",16),n(32),p(33,"translate"),r(),x(34,"input",17),p(35,"translate"),u(36,be,3,3,"div",18),r(),u(37,Ne,15,12,"div",19),a(38,"div",15)(39,"label",16),n(40),p(41,"translate"),r(),a(42,"ng-select",20),p(43,"translate"),u(44,Fe,2,2,"ng-option",21),r(),u(45,De,3,3,"div",18),r(),a(46,"div",15)(47,"label",16),n(48),p(49,"translate"),r(),a(50,"ng-select",22),p(51,"translate"),u(52,Be,2,2,"ng-option",21),r()(),a(53,"div",15)(54,"label",16),n(55),p(56,"translate"),r(),a(57,"ng-select",23),p(58,"translate"),u(59,Oe,3,4,"ng-option",21),r()(),a(60,"div",24)(61,"label",16),n(62),p(63,"translate"),r(),x(64,"textarea",25),p(65,"translate"),r()()()()()(),a(66,"div",26)(67,"div",27)(68,"div",28),u(69,Re,1,3,"app-paper-editor",29),r()()()()()()),d&2&&(t(7),g(l(8,24,o.isEditMode?"EDIT_PAPER":"ADD_PAPER")),t(6),s(" ",l(14,26,"SAVE")," "),t(2),m("routerLink",G(52,Pe)),t(3),s(" ",l(19,28,"CANCEL")," "),t(7),g(l(26,30,"METADATA")),t(3),m("formGroup",o.paperForm),t(4),s("",l(33,32,"NAME")," *"),t(2),h("placeholder",l(35,34,"ENTER_PAPER_NAME")),t(2),m("ngIf",o.paperForm.get("name").touched&&o.paperForm.get("name").hasError("required")),t(),m("ngIf",!o.isEditMode),t(3),s("",l(41,36,"CATEGORY")," *"),t(2),h("placeholder",l(43,38,"SELECT_CATEGORY")),m("clearable",!1),t(2),m("ngForOf",o.categoryStore.categories()),t(),m("ngIf",o.paperForm.get("categoryId").touched&&o.paperForm.get("categoryId").hasError("required")),t(3),g(l(49,40,"CLIENT")),t(2),h("placeholder",l(51,42,"SELECT_CLIENT")),t(2),m("ngForOf",o.clientStore.clients()),t(3),g(l(56,44,"STATUS")),t(2),h("placeholder",l(58,46,"SELECT_STATUS")),t(2),m("ngForOf",o.documentStatusStore.statusList()),t(3),g(l(63,48,"DESCRIPTION")),t(2),h("placeholder",l(65,50,"BRIEF_DESCRIPTION")),t(5),m("ngIf",!o.isEditMode||o.isEditMode&&o.editorData))},dependencies:[V,Y,Q,z,U,W,$,K,X,de,pe,Ie,Ee,E,ae]})}}return e})();var Ae=[{path:"",component:ye}],Me=(()=>{class e{static{this.\u0275fac=function(d){return new(d||e)}}static{this.\u0275mod=C({type:e})}static{this.\u0275inj=I({imports:[P.forChild(Ae),P]})}}return e})();var Ct=(()=>{class e{static{this.\u0275fac=function(d){return new(d||e)}}static{this.\u0275mod=C({type:e})}static{this.\u0275inj=I({imports:[H,Me,fe,te,ee,me,le,ue,se,ce,Se,ne,E]})}}return e})();export{Ct as PaperManageModule};
