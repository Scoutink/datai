import{d as ue,l as xe,m as ge}from"./chunk-2RZGI2GI.js";import{d as re,f as le,i as pe,j as de,k as ce}from"./chunk-VNAU6AHI.js";import{c as K,d as ae,e as fe}from"./chunk-2GYG6N64.js";import{a as ne,b as oe}from"./chunk-YTVNRIZ3.js";import{C as U,D as Y,G as Z,H as X,J as q}from"./chunk-3XAX4OT5.js";import{ma as se,na as me}from"./chunk-NF46UI75.js";import{t as te,u as ie}from"./chunk-SIUWMJOE.js";import{b as J,c as ee}from"./chunk-FGSJTZPD.js";import{$b as V,Ab as m,Ac as s,Bb as B,Bc as w,Dc as k,Ea as W,Gb as y,Kb as a,Lb as n,Mb as v,Na as b,Oa as O,Pa as C,Qb as N,S as _,Tb as P,Vb as u,Xc as $,Yc as I,Zc as S,ac as G,bc as A,gc as o,hc as f,ib as i,ic as r,jb as h,jd as j,nd as H,qc as R,rc as F,rd as Q,sc as L,tc as z,va as D,wb as x,ya as M,zb as E,zc as d}from"./chunk-EOQA7B6X.js";var ze=(()=>{class t{constructor(e,p){this.httpClient=e,this.commonHttpErrorService=p}addDocumentWorkflow(e){return this.httpClient.post("documentWorkflow",e).pipe(_(this.commonHttpErrorService.handleError))}getMyWorkflow(){return this.httpClient.get("my-workflow").pipe(_(this.commonHttpErrorService.handleError))}getRunningVisualWorkflow(e){let p=`documentWorkflow/${e}/visualWorkflow`;return this.httpClient.get(p).pipe(_(this.commonHttpErrorService.handleError))}performNextTransition(e){return this.httpClient.post("documentWorkflow/performNextTransition",e).pipe(_(this.commonHttpErrorService.handleError))}getAllWorkflowInstances(e){let p="documentWorkflow",l=new H().set("fields",e.fields).set("orderBy",e.orderBy).set("pageSize",e.pageSize.toString()).set("skip",e.skip.toString()).set("searchQuery",e.searchQuery).set("documentName",e.documentName??"").set("workflowName",e.workflowName??"").set("status",e.status??"");return this.httpClient.get(p,{params:l,observe:"response"}).pipe(_(this.commonHttpErrorService.handleError))}cancelWOrkflow(e,p){let l=`documentWorkflow/${e}/cancel`;return this.httpClient.post(l,{comment:p}).pipe(_(this.commonHttpErrorService.handleError))}static{this.\u0275fac=function(p){return new(p||t)(M(Q),M(J))}}static{this.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var _e=["graph"],he=()=>({orientation:"TB"}),we=t=>({"col-md-12":t});function Ce(t,c){t&1&&(C(),a(0,"marker",24),v(1,"path",25),n())}function Ee(t,c){if(t&1&&(C(),a(0,"g",26),v(1,"rect"),a(2,"text",27),o(3),n()()),t&2){let e=c.$implicit;i(),E("width",(e.dimension==null?null:e.dimension.width)||100)("height",(e.dimension==null?null:e.dimension.height)||50)("fill",(e.data==null?null:e.data.color)||"#ccc"),i(),E("fill","#fff")("x",10)("y",((e.dimension==null?null:e.dimension.height)||50)/2),i(),r(" ",e.label," ")}}function ke(t,c){if(t&1&&(C(),a(0,"g",29),v(1,"path",30),a(2,"text",31)(3,"textPath",32),o(4),n()()()),t&2){let e=u().$implicit;i(3),B("dominant-baseline",e.dominantBaseline),E("fill",e.status===1?"green":"black")("href","#"+e.id),i(),r(" ",e.label," ")}}function Ie(t,c){if(t&1&&x(0,ke,5,5,"g",28),t&2){let e=c.$implicit;m("ngIf",e.source&&e.target)}}function Se(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u();i(2),r("",s(3,2,"DESCRIPTION"),":"),i(2),f(e.data.workflowDescription)}}function Te(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u();i(2),r(" ",s(3,2,"CREATED_BY"),":"),i(2),r(" ",e.data.createdBy," ")}}function Me(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),d(5,"utcToLocalTime"),n()),t&2){let e=u();i(2),r("",s(3,2,"INITIATED_DATE"),":"),i(2),r(" ",w(5,4,e.data.initiatedDate,"full")," ")}}function be(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u().$implicit;i(2),r("",s(3,2,"ASSIGNED_TO_ROLES"),":"),i(2),r(" ",e.assignRoles," ")}}function Oe(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u().$implicit;i(2),r("",s(3,2,"ASSIGNED_TO_USERS"),":"),i(2),r(" ",e.assignUsers," ")}}function ye(t,c){if(t&1&&(a(0,"div",14)(1,"div",36),v(2,"i-feather",37),a(3,"div")(4,"span",38),o(5),n(),a(6,"small",39),o(7),d(8,"translate"),n()()(),a(9,"div",17)(10,"div",40)(11,"div",41)(12,"span",42),o(13),n()(),a(14,"div",43),v(15,"i-feather",44),a(16,"small",45),o(17),d(18,"translate"),n()(),a(19,"div",46)(20,"span",42),o(21),n()()(),x(22,be,5,4,"p",20)(23,Oe,5,4,"p",20),n()()),t&2){let e=c.$implicit;i(5),f(e.name),i(2),r(" ",s(8,7,"PENDING"),""),i(6),f(e.fromStepName),i(4),f(s(18,9,"PENDING")),i(4),f(e.toStepName),i(),m("ngIf",e==null?null:e.assignRoles),i(),m("ngIf",e==null?null:e.assignUsers)}}function Pe(t,c){if(t&1&&(a(0,"div",33)(1,"div",8)(2,"div",13)(3,"span",34),o(4),d(5,"translate"),n()()(),x(6,ye,24,11,"div",35),n()),t&2){let e=u();i(4),f(s(5,2,"PENDING_TRANSITIONS")),i(2),m("ngForOf",e.data==null?null:e.data.pendingWorkflowTransitions)}}function De(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),n(),o(3),d(4,"utcToLocalTime"),n()),t&2){let e=u().$implicit;i(2),r("","CREATED_DATE",":"),i(),r(" ",w(4,2,e.createdAt,"full"),"")}}function We(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),d(5,"utcToLocalTime"),n()),t&2){let e=u().$implicit;i(2),r("",s(3,2,"COMPLETED_DATE"),":"),i(2),r(" ",w(5,4,e.createdDate,"full"),"")}}function Be(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u().$implicit;i(2),r("",s(3,2,"PERFORM_BY"),":"),i(2),r(" ",e.createdBy," ")}}function Ne(t,c){if(t&1&&(a(0,"p",19)(1,"strong"),o(2),d(3,"translate"),n(),o(4),n()),t&2){let e=u().$implicit;i(2),r("",s(3,2,"COMMENT"),":"),i(2),r(" ",e.comment," ")}}function Ve(t,c){if(t&1&&(a(0,"div",14)(1,"div",36),v(2,"i-feather",49),a(3,"div")(4,"span",16),o(5),n(),a(6,"small",50),o(7),d(8,"translate"),n()()(),a(9,"div",17)(10,"div",40)(11,"div",41)(12,"span",42),o(13),n()(),a(14,"div",43),v(15,"i-feather",51),a(16,"small",52),o(17),d(18,"translate"),n()(),a(19,"div",46)(20,"span",42),o(21),n()()(),x(22,De,5,5,"p",20)(23,We,6,7,"p",20)(24,Be,5,4,"p",20)(25,Ne,5,4,"p",20),n()()),t&2){let e=c.$implicit;i(5),f(e.name),i(2),r(" ",s(8,9,"COMPLETED")," "),i(6),f(e.fromStepName),i(4),f(s(18,11,"COMPLETED")),i(4),f(e.toStepName),i(),m("ngIf",e.createdAt),i(),m("ngIf",e.createdDate),i(),m("ngIf",e.createdBy),i(),m("ngIf",e.comment)}}function Ge(t,c){if(t&1&&(a(0,"div",47)(1,"div",8)(2,"div",13)(3,"span",48),o(4),d(5,"translate"),n()()(),x(6,Ve,26,13,"div",35),n()),t&2){let e=u();m("ngClass",z(5,we,(e.data==null?null:e.data.pendingWorkflowTransitions.length)==0)),i(4),f(s(5,3,"COMPLETED_TRANSTIONS")),i(2),m("ngForOf",e.data==null?null:e.data.completedWorkflowTransitions)}}var mt=(()=>{class t{constructor(e,p,l,g,T){this.dialogRef=e,this.data=p,this.clonerService=l,this.documentService=g,this.overlay=T,this.nodes=[],this.links=[],this.curve=ue,this.customColors=[],this.nodes=this.clonerService.deepClone(p.nodes),this.links=this.clonerService.deepClone(p.links),this.customColors=this.clonerService.deepClone(p.customColors)}onDocumentCancel(){this.dialogRef.close()}onDocumentView(){this.documentService.getDocument(this.data.documentId).subscribe(e=>{let l=e.url.split(".")[1],g={documentId:e.id,name:e.name,extension:l,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1};this.overlay.open(ae,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:g})})}ngAfterViewInit(){setTimeout(()=>{this.graph})}static{this.\u0275fac=function(p){return new(p||t)(h(U),h(Y),h(ee),h(fe),h(K))}}static{this.\u0275cmp=W({type:t,selectors:[["app-visual-workflow-graph"]],viewQuery:function(p,l){if(p&1&&V(_e,5),p&2){let g;G(g=A())&&(l.graph=g.first)}},standalone:!0,features:[R([I,S]),F],decls:59,vars:40,consts:[["graph",""],["defsTemplate",""],["nodeTemplate",""],["linkTemplate",""],[1,"d-flex"],["mat-dialog-title","",1,"dialog-title"],["mat-icon-button","",1,"ms-auto",3,"click"],["color","warn",1,"close-icon"],[1,"row"],[1,"col-sm-3"],[1,"ngx-graph-height"],[1,"chart-container",3,"layoutSettings","links","nodes","layout","curve","panOnZoom","autoCenter","autoZoom"],[1,"col-sm-9"],[1,"col"],[1,"card","shadow","mt-2"],[1,"card-header"],[1,"px-2","h5","font-weight-bold","mb-0"],[1,"card-body"],[1,"col-6"],[1,"h6"],["class","h6",4,"ngIf"],[1,"doc-link",3,"click"],["class","col-md-6 col-sm-12",4,"ngIf"],["class","col-md-6 col-sm-12",3,"ngClass",4,"ngIf"],["id","arrow","viewBox","0 -5 10 10","refX","8","refY","0","markerWidth","4","markerHeight","4","orient","auto"],["d","M0,-5L10,0L0,5",1,"arrow-head"],[1,"node"],["alignment-baseline","central"],["class","edge",4,"ngIf"],[1,"edge"],["stroke-width","2","marker-end","url(#arrow)",1,"line"],["text-anchor","middle",1,"edge-label"],["startOffset","50%",1,"text-path"],[1,"col-md-6","col-sm-12"],[1,"px-2","h5","font-weight-bold","mb-0","text-danger"],["class","card shadow  mt-2",4,"ngFor","ngForOf"],[1,"card-header","d-flex","align-items-center"],["name","clock",1,"text-danger"],[1,"px-2","h6","font-weight-bold","mb-0"],[1,"text-danger"],[1,"d-flex","align-items-center","justify-content-left"],[1,"text-center","me-3"],[1,"h6","mb-1"],[1,"text-center","me-3","pt-3"],["name","arrow-right",1,"text-danger"],[1,"d-block","text-danger","font-size-8"],[1,"text-center"],[1,"col-md-6","col-sm-12",3,"ngClass"],[1,"px-2","h5","font-weight-bold","mb-0","text-success"],["name","check-circle",1,"text-success"],[1,"text-success"],["name","arrow-right",1,"text-success"],[1,"d-block","text-success","font-size-8"]],template:function(p,l){if(p&1){let g=N();a(0,"div",4)(1,"span",5),o(2),d(3,"limitTo"),n(),a(4,"button",6),P("click",function(){return b(g),O(l.onDocumentCancel())}),a(5,"mat-icon",7),o(6,"close"),n()()(),a(7,"mat-dialog-content")(8,"div",8)(9,"div",9)(10,"div",10)(11,"ngx-graph",11,0),x(13,Ce,2,0,"ng-template",null,1,k)(15,Ee,4,7,"ng-template",null,2,k)(17,Ie,1,1,"ng-template",null,3,k),n()()(),a(19,"div",12)(20,"div",8)(21,"div",13)(22,"div",14)(23,"div",15)(24,"span",16),o(25),d(26,"translate"),n()(),a(27,"div",17)(28,"div",8)(29,"div",18)(30,"p",19)(31,"strong"),o(32),d(33,"translate"),n(),o(34),n(),x(35,Se,5,4,"p",20)(36,Te,5,4,"p",19),a(37,"p",19)(38,"strong"),o(39),d(40,"translate"),n(),o(41),d(42,"utcToLocalTime"),n()(),a(43,"div",18)(44,"p",19)(45,"strong"),o(46),d(47,"translate"),n(),a(48,"a",21),P("click",function(){return b(g),O(l.onDocumentView())}),o(49),n()(),x(50,Me,6,7,"p",19),a(51,"p",19)(52,"strong"),o(53),d(54,"translate"),n(),o(55),n()()()()()()(),a(56,"div",8),x(57,Pe,7,4,"div",22)(58,Ge,7,7,"div",23),n()()()()}p&2&&(i(2),r("",w(3,23,l.data.workflowName,"100")," "),i(9),m("layoutSettings",L(39,he))("links",l.links)("nodes",l.nodes)("layout","dagre")("curve",l.curve)("panOnZoom",!0)("autoCenter",!1)("autoZoom",!0),i(14),f(s(26,26,"WORKFLOW_DETAILS")),i(7),r("",s(33,28,"NAME"),":"),i(2),r(" ",l.data.workflowName,""),i(),m("ngIf",l.data.workflowDescription),i(),y(l.data.createdBy?36:-1),i(3),r("",s(40,30,"CREATED_DATE"),":"),i(2),r(" ",w(42,32,l.data.createdDate,"full")," "),i(5),r("",s(47,35,"DOCUMENT"),": "),i(3),f(l.data.documentName),i(),y(l.data.initiatedDate?50:-1),i(3),r("",s(54,37,"INITIATED_BY"),":"),i(2),r(" ",l.data.initiatedBy," "),i(2),m("ngIf",(l.data==null?null:l.data.pendingWorkflowTransitions.length)>0),i(),m("ngIf",(l.data==null?null:l.data.completedWorkflowTransitions.length)>0))},dependencies:[ge,xe,me,se,ce,de,q,Z,X,j,$,I,S,pe,re,le,oe,ne,ie,te],styles:[".node-details[_ngcontent-%COMP%]{background:#f9f9f9;border:1px solid #ddd;border-radius:8px;padding:8px;text-align:center;box-shadow:0 2px 4px #0000001a}.node-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px}.node-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#555}.text-path-green[_ngcontent-%COMP%]{fill:none;stroke:#0f0;stroke-width:2px}.text-path-red[_ngcontent-%COMP%]{fill:none;stroke:red;stroke-width:2px}.workflow-timeline[_ngcontent-%COMP%]{padding:16px;font-family:Arial,sans-serif}.workflow-timeline[_ngcontent-%COMP%]   .timeline-step[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:8px;padding:12px;margin-bottom:16px;background:#f9f9f9;box-shadow:0 2px 4px #0000001a}.workflow-timeline[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.workflow-timeline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:14px;color:#555}.workflow-timeline[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#000}.workflow[_ngcontent-%COMP%]{display:flex;align-items:center}.step[_ngcontent-%COMP%]{padding:5px;background-color:#f0f0f0;border:1px solid #ccc;border-radius:5px}.arrow[_ngcontent-%COMP%]{margin:0 10px;font-size:1.5em}.step-box[_ngcontent-%COMP%]{border-radius:2px;font-size:14px;background-color:#f8f9fa;border:1px solid #dee2e6}.step-box.complete[_ngcontent-%COMP%]{background-color:#d4edda;border-color:#c3e6cb;color:#155724}.font-size-8[_ngcontent-%COMP%]{font-size:8px}.ngx-graph-height[_ngcontent-%COMP%]{width:100%;height:100%}@media (max-width: 768px){.graph-container[_ngcontent-%COMP%]{width:100%;overflow:auto}.dialog-title[_ngcontent-%COMP%]{font-size:1rem;word-break:break-word}.edge-label[_ngcontent-%COMP%]{font-size:12px}.ngx-graph-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.ngx-graph-height[_ngcontent-%COMP%]{width:100%;height:100%}}"]})}}return t})();export{ze as a,mt as b};
