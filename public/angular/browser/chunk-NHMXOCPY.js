import{a as je}from"./chunk-5DGY2OXT.js";import{a as Ue}from"./chunk-VBYTSXUA.js";import"./chunk-EDFYBFRY.js";import{a as V,b as He,c as Be}from"./chunk-MDTWJNMV.js";import{d as Pe,e as ze}from"./chunk-UQDQDCM7.js";import{a as F,b as Ge}from"./chunk-FUBOQZYU.js";import{b as $e}from"./chunk-5OA3UTKR.js";import{a as We,b as Je,c as Ke,d as Ze,e as et,f as tt,g as it,h as nt,i as ot,j as at,k as rt,l as mt,m as ct,n as st,o as lt,p as pt}from"./chunk-ZQ2PWCHX.js";import{b as Le}from"./chunk-54YXYWWQ.js";import{b as Qe}from"./chunk-SLA72EXZ.js";import"./chunk-PSHPNFJ6.js";import"./chunk-EST3G7IM.js";import"./chunk-TNLJ7CAF.js";import{a as Ye,b as Xe,c as qe}from"./chunk-UX7VFZY4.js";import"./chunk-5HUZTPPR.js";import{D as Oe,F as ke,G as Ae,J as Ve,K as Fe,c as De,f as Ee,j as xe,k as be,n as Re,o as Ie,p as Me,q as we}from"./chunk-VNAU6AHI.js";import{b as L,c as ue,d as ve,e as Ne}from"./chunk-2GYG6N64.js";import"./chunk-YTVNRIZ3.js";import{F as ce,J as se,L as fe,f as me}from"./chunk-3XAX4OT5.js";import{ia as de,ja as Ce,ma as Te,na as ye}from"./chunk-NF46UI75.js";import{p as ge,t as Se}from"./chunk-SIUWMJOE.js";import"./chunk-GTE6R5NX.js";import{b as he,c as _e}from"./chunk-FGSJTZPD.js";import"./chunk-73F4PDV3.js";import{C as le,D as pe}from"./chunk-TMWBOQE5.js";import{$ as j,$b as R,Ab as p,Ac as d,B as Y,Bc as ee,Ea as W,Kb as a,L as B,Lb as r,Mb as g,Na as D,Nb as S,O as X,Oa as E,Ob as C,Qb as y,S as b,Tb as x,Vb as _,W as U,Yb as T,Yc as te,Zc as ie,a as Q,ac as I,ba as q,bc as M,bd as ne,ec as K,gc as c,hc as A,ib as i,ic as u,jb as f,jd as oe,nd as ae,p as k,qa as N,rc as Z,rd as re,sc as z,tb as J,tc as w,va as G,wb as h,ya as $,za as P,zc as l}from"./chunk-EOQA7B6X.js";var H=class{get count(){return this._count}get data(){return this._data}set data(n){this._data=n}constructor(n){this.expireDocumentService=n,this.documentsSubject=new k([]),this.responseHeaderSubject=new k(null),this.loadingSubject=new k(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this.responseHeaderSubject.asObservable()}connect(n){return this.documentsSubject.asObservable()}disconnect(n){this.documentsSubject.complete(),this.loadingSubject.complete()}loadDocuments(n){this.loadingSubject.next(!0),this.expireDocumentService.getExpireDocuments(n).pipe(b(()=>Y([])),q(()=>this.loadingSubject.next(!1))).subscribe(e=>{let o=new je;o.pageSize=parseInt(e.headers.get("pageSize")),o.totalCount=parseInt(e.headers.get("totalCount")),o.skip=parseInt(e.headers.get("skip")),this.responseHeaderSubject.next(Q({},o)),this._data=[...e.body],this._count=this._data.length,this.documentsSubject.next(this._data)})}};var dt=(()=>{class t{constructor(e,o){this.httpClient=e,this.commonHttpErrorService=o}getExpireDocuments(e){let o="expired-documents",m=new ae().set("fields",e.fields).set("orderBy",e.orderBy).set("deletedDateString",e.deletedDate?e.deletedDate.toString():"").set("pageSize",e.pageSize.toString()).set("skip",e.skip.toString()).set("searchQuery",e.searchQuery).set("categoryId",e.categoryId).set("name",e.name).set("metaTags",e.metaTags).set("id",e.id.toString()).set("location",e.location).set("statusId",e.statusId);return this.httpClient.get(o,{params:m,observe:"response"}).pipe(b(this.commonHttpErrorService.handleError))}activeDocument(e){let o=`expired-documents/${e}/active`;return this.httpClient.put(o,{}).pipe(b(this.commonHttpErrorService.handleError))}archiveDocument(e){let o=`expired-documents/${e}/archive`;return this.httpClient.delete(o,{}).pipe(b(this.commonHttpErrorService.handleError))}static{this.\u0275fac=function(o){return new(o||t)($(re),$(he))}}static{this.\u0275prov=G({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ct=["input"],vt=["metatag"],Dt=t=>({"margin-right.px":t}),Et=t=>({"margin-left.px":t}),ut=t=>({color:t}),xt=()=>["EXPIRED_DOCUMENTS_ACTIVATE_DOCUMENT","EXPIRED_DOCUMENTS_ARCHIVE_DOCUMENT"],bt=()=>[10,20,30];function Tt(t,n){if(t&1&&(a(0,"div")(1,"b"),c(2),r()()),t&2){let e=_().$implicit;i(2),u(" ",e.name,"")}}function yt(t,n){if(t&1&&(a(0,"div"),c(1),r()),t&2){let e=_().$implicit;i(),u(" ",e.name," ")}}function Rt(t,n){if(t&1&&(a(0,"ng-option",21)(1,"div",40),h(2,Tt,3,1,"div",41)(3,yt,2,1,"div",41),r()()),t&2){let e=n.$implicit,o=_();p("value",e.id),i(),p("ngStyle",o.direction==="rtl"?w(4,Dt,e.deafLevel*20):w(6,Et,e.deafLevel*20)),i(),p("ngIf",!e.parentId),i(),p("ngIf",e.parentId)}}function It(t,n){if(t&1&&(a(0,"ng-option",21)(1,"span",42),c(2),r()()),t&2){let e=n.$implicit;p("value",e.id),i(),p("ngStyle",w(3,ut,e==null?null:e.colorCode)),i(),u(" ",e.name," ")}}function Mt(t,n){t&1&&(a(0,"th",43),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"ACTION")," "))}function wt(t,n){if(t&1&&(a(0,"button",48)(1,"mat-icon"),c(2,"more_vert"),r()()),t&2){_();let e=K(3);p("matMenuTriggerFor",e)}}function Ot(t,n){if(t&1){let e=y();a(0,"button",49),x("click",function(){D(e);let m=_().$implicit,s=_();return E(s.activeDocument(m.id))}),a(1,"mat-icon"),c(2,"history"),r(),c(3),l(4,"translate"),r()}t&2&&(i(3),u(" ",d(4,1,"ACTIVATE_DOCUMENT")," "))}function kt(t,n){if(t&1){let e=y();a(0,"button",50),x("click",function(){D(e);let m=_().$implicit,s=_();return E(s.archiveDocument(m))}),a(1,"mat-icon"),c(2,"delete"),r(),c(3),l(4,"translate"),r()}t&2&&(i(3),u(" ",d(4,1,"ARCHIVE")," "))}function Nt(t,n){t&1&&(a(0,"td",44),h(1,wt,3,1,"button",45),a(2,"mat-menu",null,2),h(4,Ot,5,3,"button",46)(5,kt,5,3,"button",47),r()()),t&2&&(i(),p("hasClaim",z(3,xt)),i(3),p("hasClaim","EXPIRED_DOCUMENTS_ACTIVATE_DOCUMENT"),i(),p("hasClaim","EXPIRED_DOCUMENTS_ARCHIVE_DOCUMENT"))}function At(t,n){t&1&&(a(0,"th",51),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"NAME")," "))}function Vt(t,n){if(t&1){let e=y();a(0,"td",44)(1,"a",52),x("click",function(){let m=D(e).$implicit,s=_();return E(s.onDocumentView(m))}),c(2),r()()}if(t&2){let e=n.$implicit;i(2),A(e.name)}}function Ft(t,n){t&1&&(a(0,"th",51),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"DOCUMENT_CATEGORY")," "))}function Ht(t,n){if(t&1&&(a(0,"td",44),c(1),r()),t&2){let e=n.$implicit;i(),u(" ",e.categoryName," ")}}function Bt(t,n){t&1&&(a(0,"th",51),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"STORAGE")," "))}function Ut(t,n){if(t&1&&(a(0,"td",44),c(1),l(2,"translate"),r()),t&2){let e=n.$implicit;i(),u(" ",d(2,1,e==null||e.location==null?null:e.location.toUpperCase())," ")}}function jt(t,n){t&1&&(a(0,"th",51),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"STATUS")," "))}function $t(t,n){if(t&1&&(a(0,"td",44)(1,"span",42),c(2),l(3,"translate"),r()()),t&2){let e=n.$implicit;i(),p("ngStyle",w(4,ut,e==null?null:e.colorCode)),i(),u(" ",d(3,2,e==null?null:e.statusName)," ")}}function Pt(t,n){t&1&&(a(0,"th",51),c(1),l(2,"translate"),r()),t&2&&(i(),u(" ",d(2,1,"EXPIRED_DATE")," "))}function zt(t,n){if(t&1&&(a(0,"td",44),c(1),l(2,"utcToLocalTime"),r()),t&2){let e=n.$implicit;i(),u(" ",ee(2,1,e==null?null:e.expiredDate,"shortDate")," ")}}function Lt(t,n){if(t&1&&(a(0,"td",53),g(1,"mat-paginator",54),r()),t&2){let e=_();i(),p("length",e.documentResource.totalCount)("pageSize",e.documentResource.pageSize)("pageSizeOptions",z(3,bt))}}function Qt(t,n){t&1&&g(0,"tr",55)}function Yt(t,n){t&1&&g(0,"tr",56)}function Xt(t,n){t&1&&g(0,"tr",57)}function qt(t,n){t&1&&(a(0,"tr")(1,"td",58)(2,"div",59)(3,"b"),c(4),l(5,"translate"),r()()()()),t&2&&(i(4),u(" ",d(5,1,"NO_DATA_FOUND"),""))}var Ji=(()=>{class t extends de{constructor(e,o,m,s,O,v,ht,_t,ft){super(),this.expireDocumentService=e,this.documentService=o,this.overlay=m,this.clonerService=s,this.commonDialogService=O,this.translationService=v,this.commonService=ht,this.toastrService=_t,this.dialog=ft,this.documents=[],this.displayedColumns=["action","name","categoryName","location","statusName","expiredDate"],this.footerToDisplayed=["footer"],this.selection=new me(!0,[]),this.max=new Date,this.documentStatusStore=P(Le),this.categoryStore=P(Qe),this.documentResource=new Ue,this.documentResource.pageSize=10,this.documentResource.orderBy="expiredDate desc"}ngOnInit(){this.dataSource=new H(this.expireDocumentService),this.dataSource.loadDocuments(this.documentResource),this.getResourceParameter(),this.getLangDir()}getLangDir(){this.sub$.sink=this.translationService.lanDir$.subscribe(e=>this.direction=e)}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=X(this.sort.sortChange,this.paginator.page).pipe(N(()=>{this.documentResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.documentResource.pageSize=this.paginator.pageSize,this.documentResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadDocuments(this.documentResource),this.selection.clear()})).subscribe(),this.sub$.sink=B(this.input.nativeElement,"keyup").pipe(U(1e3),j(),N(()=>{this.paginator.pageIndex=0,this.documentResource.skip=0,this.documentResource.name=this.input.nativeElement.value,this.dataSource.loadDocuments(this.documentResource),this.selection.clear()})).subscribe(),this.sub$.sink=B(this.metatag.nativeElement,"keyup").pipe(U(1e3),j(),N(()=>{this.paginator.pageIndex=0,this.documentResource.skip=0,this.documentResource.metaTags=this.metatag.nativeElement.value,this.dataSource.loadDocuments(this.documentResource)})).subscribe()}onCategoryChange(e){e?this.documentResource.categoryId=e:this.documentResource.categoryId="",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocuments(this.documentResource)}onStorageChange(e){e?this.documentResource.location=e:this.documentResource.location="",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocuments(this.documentResource)}onDocumentStatusChange(e){e?this.documentResource.statusId=e:this.documentResource.statusId="",this.documentResource.skip=0,this.paginator.pageIndex=0,this.dataSource.loadDocuments(this.documentResource)}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(e=>{e&&(this.documentResource.pageSize=e.pageSize,this.documentResource.skip=e.skip,this.documentResource.totalCount=e.totalCount)})}addDocumentTrail(e,o){let m={documentId:e,operationName:o};this.sub$.sink=this.commonService.addDocumentAuditTrail(m).subscribe()}archiveDocument(e){this.sub$.sink=this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_ARCHIVE"),e.name).subscribe(o=>{o&&(this.sub$.sink=this.documentService.archiveDocument(e.id).subscribe(()=>{this.addDocumentTrail(e.id,L.Archived.toString()),this.toastrService.success(this.translationService.getValue("DOCUMENT_ARCHIVED_SUCCESSFULLY")),this.dataSource.loadDocuments(this.documentResource)}))})}activeDocument(e){this.sub$.sink=this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_RESOTRE")).subscribe(o=>{o&&(this.sub$.sink=this.expireDocumentService.activeDocument(e).subscribe(()=>{this.addDocumentTrail(e,L.Restored.toString()),this.toastrService.success(this.translationService.getValue("DOCUMENT_RESTORED_SUCCESSFULLY")),this.dataSource.loadDocuments(this.documentResource)}))})}onDocumentView(e){let m=e.url.split(".")[1],s={documentId:e.id,name:e.name,extension:m,isVersion:!1,isFromPublicPreview:!1,isPreviewDownloadEnabled:!1,isFromFileRequest:!1};this.overlay.open(ve,{position:"center",origin:"global",panelClass:["file-preview-overlay-container","white-background"],data:s})}static{this.\u0275fac=function(o){return new(o||t)(f(dt),f(Ne),f(ue),f(_e),f(Ae),f(Ce),f(fe),f(ge),f(ce))}}static{this.\u0275cmp=W({type:t,selectors:[["app-expired-document"]],viewQuery:function(o,m){if(o&1&&(R(F,5),R(V,5),R(Ct,5),R(vt,5)),o&2){let s;I(s=M())&&(m.paginator=s.first),I(s=M())&&(m.sort=s.first),I(s=M())&&(m.input=s.first),I(s=M())&&(m.metatag=s.first)}},standalone:!0,features:[J,Z],decls:71,vars:37,consts:[["input",""],["metatag",""],["menu","matMenu"],[1,"content"],[1,"content-block"],[1,"block-header"],[1,"breadcrumb-main"],[1,"row","align-items-center"],[1,"col"],[1,"page-title"],["code","EXPIRED_DOCUMENTS"],[1,"row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"card"],[1,"body"],[1,"row","margin-2"],[1,"col-md-3"],["type","text",1,"form-control",3,"placeholder"],[1,"form-control",3,"placeholder"],[3,"change","placeholder"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"grid-height-medium"],[1,"table-responsive"],["mat-table","","matSort","","matSortActive","deletedAt","matSortDirection","desc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","action"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","categoryName"],["matColumnDef","location"],["matColumnDef","statusName"],["matColumnDef","expiredDate"],["matColumnDef","footer"],["mat-footer-cell","","colspan","7",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[4,"matNoDataRow"],[1,"country-item",3,"ngStyle"],[4,"ngIf"],[3,"ngStyle"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor",4,"hasClaim"],["class","btn btn-light btn-sm","mat-menu-item","","type","button",3,"click",4,"hasClaim"],["mat-menu-item","","class","btn btn-light btn-sm",3,"click",4,"hasClaim"],["mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor"],["mat-menu-item","","type","button",1,"btn","btn-light","btn-sm",3,"click"],["mat-menu-item","",1,"btn","btn-light","btn-sm",3,"click"],["mat-header-cell","","mat-sort-header",""],[1,"doc-link",3,"click"],["mat-footer-cell","","colspan","7"],[3,"length","pageSize","pageSizeOptions"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["colspan","7"],[1,"m-2"]],template:function(o,m){if(o&1){let s=y();a(0,"section",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div",8)(6,"span",9),c(7),l(8,"translate"),g(9,"app-page-help-text",10),r()()()()(),a(10,"div",11)(11,"div",12)(12,"div",13)(13,"div",14)(14,"div",15)(15,"div",16),g(16,"input",17,0),l(18,"translate"),r(),a(19,"div",16),g(20,"input",18,1),l(22,"translate"),r(),a(23,"div",16)(24,"ng-select",19),l(25,"translate"),x("change",function(v){return D(s),E(m.onCategoryChange(v))}),h(26,Rt,4,8,"ng-option",20),r()(),a(27,"div",16)(28,"ng-select",19),l(29,"translate"),x("change",function(v){return D(s),E(m.onStorageChange(v))}),a(30,"ng-option",21),c(31),l(32,"translate"),r(),a(33,"ng-option",21),c(34),l(35,"translate"),r(),a(36,"ng-option",21),c(37),l(38,"translate"),r()()(),a(39,"div",16)(40,"ng-select",19),l(41,"translate"),x("change",function(v){return D(s),E(m.onDocumentStatusChange(v))}),h(42,It,3,5,"ng-option",20),r()()(),a(43,"div",11)(44,"div",22)(45,"div",23)(46,"table",24),S(47,25),h(48,Mt,3,3,"th",26)(49,Nt,6,4,"td",27),C(),S(50,28),h(51,At,3,3,"th",29)(52,Vt,3,1,"td",27),C(),S(53,30),h(54,Ft,3,3,"th",29)(55,Ht,2,1,"td",27),C(),S(56,31),h(57,Bt,3,3,"th",29)(58,Ut,3,3,"td",27),C(),S(59,32),h(60,jt,3,3,"th",29)(61,$t,4,6,"td",27),C(),S(62,33),h(63,Pt,3,3,"th",29)(64,zt,3,4,"td",27),C(),S(65,34),h(66,Lt,2,4,"td",35),C(),h(67,Qt,1,0,"tr",36)(68,Yt,1,0,"tr",37)(69,Xt,1,0,"tr",38)(70,qt,6,3,"tr",39),r()()()()()()()()()()}o&2&&(i(7),u("",d(8,19,"EXPIRED_DOCUMENTS")," "),i(9),T("placeholder",d(18,21,"SEARCH_DOCUMENT_BY_NAME_OR_DESCRIPTION")),i(4),T("placeholder",d(22,23,"SEARCH_DOCUMENT_BY_META_TAGS")),i(4),T("placeholder",d(25,25,"SELECT_CATEGORY")),i(2),p("ngForOf",m.categoryStore.categories()),i(2),T("placeholder",d(29,27,"STORAGE")),i(3),u("-- ",d(32,29,"NONE")," --"),i(2),p("value","local"),i(),A(d(35,31,"LOCAL")),i(2),p("value","s3"),i(),A(d(38,33,"S3")),i(3),T("placeholder",d(41,35,"SELECT_STATUS")),i(2),p("ngForOf",m.documentStatusStore.statusList()),i(4),p("dataSource",m.dataSource),i(21),p("matHeaderRowDef",m.displayedColumns)("matHeaderRowDefSticky",!0),i(),p("matRowDefColumns",m.displayedColumns),i(),p("matFooterRowDef",m.footerToDisplayed)("matFooterRowDefSticky",!0))},dependencies:[oe,te,ie,ne,Fe,Te,xe,Ie,Re,Me,De,Ve,Se,Ee,le,pe,pt,We,Ke,ot,et,Je,rt,Ze,at,tt,nt,it,mt,st,ct,lt,se,$e,Ge,F,Be,V,He,we,Oe,ke,be,ye,Pe,ze,qe,Xe,Ye]})}}return t})();export{Ji as ExpiredDocumentComponent};
