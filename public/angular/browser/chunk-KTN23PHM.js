import{a as Pe}from"./chunk-C22BUVQ6.js";import{b as Re}from"./chunk-54YXYWWQ.js";import{b as Be}from"./chunk-JB4URTUB.js";import{b as Ue}from"./chunk-SLA72EXZ.js";import{a as je,b as Le}from"./chunk-UX7VFZY4.js";import{J as W,c as Ve,g as Oe,j as H}from"./chunk-VNAU6AHI.js";import{b as ke,e as Q}from"./chunk-2GYG6N64.js";import{a as Y}from"./chunk-YTVNRIZ3.js";import{C as V,D as O,F as Ie,G as B,H as R,L as G}from"./chunk-3XAX4OT5.js";import{P as De,ia as X,ja as q,ma as Z}from"./chunk-NF46UI75.js";import{p as z,t as $}from"./chunk-SIUWMJOE.js";import{B as L,c as Te,e as I,h as Se,i as U,o as P,p as Ae,r as j,s as Fe,t as Me,u as Ne,y as we}from"./chunk-TMWBOQE5.js";import{Ab as s,Ac as u,Bb as ee,Cb as ge,Db as fe,Ea as T,Fa as se,Gb as _e,Jc as N,Kb as a,Lb as o,Mb as f,Mc as te,Na as y,Nb as he,Oa as E,Ob as ve,Qb as D,Tb as v,Va as me,Vb as b,Wa as le,Yb as F,Yc as Ce,Za as ce,Zc as w,bb as de,bd as xe,ec as be,gc as m,hc as C,ib as n,ic as _,jb as d,rc as ye,rd as k,sc as Ee,tb as A,tc as M,va as ne,vb as pe,wa as re,wb as g,xa as oe,ya as ae,za as S,zb as ue,zc as p}from"./chunk-EOQA7B6X.js";function $e(t,l){t&1&&f(0,"div",2)}var qe=new oe("MAT_PROGRESS_BAR_DEFAULT_OPTIONS");var Ge=(()=>{class t{constructor(e,i,r,c,h){this._elementRef=e,this._ngZone=i,this._changeDetectorRef=r,this._animationMode=c,this._isNoopAnimation=!1,this._defaultColor="primary",this._value=0,this._bufferValue=0,this.animationEnd=new me,this._mode="determinate",this._transitionendHandler=x=>{this.animationEnd.observers.length===0||!x.target||!x.target.classList.contains("mdc-linear-progress__primary-bar")||(this.mode==="determinate"||this.mode==="buffer")&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))},this._isNoopAnimation=c==="NoopAnimations",h&&(h.color&&(this.color=this._defaultColor=h.color),this.mode=h.mode||this.mode)}get color(){return this._color||this._defaultColor}set color(e){this._color=e}get value(){return this._value}set value(e){this._value=Xe(e||0),this._changeDetectorRef.markForCheck()}get bufferValue(){return this._bufferValue||0}set bufferValue(e){this._bufferValue=Xe(e||0),this._changeDetectorRef.markForCheck()}get mode(){return this._mode}set mode(e){this._mode=e,this._changeDetectorRef.markForCheck()}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{this._elementRef.nativeElement.addEventListener("transitionend",this._transitionendHandler)})}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._transitionendHandler)}_getPrimaryBarTransform(){return`scaleX(${this._isIndeterminate()?1:this.value/100})`}_getBufferBarFlexBasis(){return`${this.mode==="buffer"?this.bufferValue:100}%`}_isIndeterminate(){return this.mode==="indeterminate"||this.mode==="query"}static{this.\u0275fac=function(i){return new(i||t)(d(ce),d(le),d(N),d(de,8),d(qe,8))}}static{this.\u0275cmp=T({type:t,selectors:[["mat-progress-bar"]],hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-mdc-progress-bar","mdc-linear-progress"],hostVars:10,hostBindings:function(i,r){i&2&&(ue("aria-valuenow",r._isIndeterminate()?null:r.value)("mode",r.mode),fe("mat-"+r.color),ge("_mat-animation-noopable",r._isNoopAnimation)("mdc-linear-progress--animation-ready",!r._isNoopAnimation)("mdc-linear-progress--indeterminate",r._isIndeterminate()))},inputs:{color:"color",value:[2,"value","value",te],bufferValue:[2,"bufferValue","bufferValue",te],mode:"mode"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],standalone:!0,features:[pe,ye],decls:7,vars:5,consts:[["aria-hidden","true",1,"mdc-linear-progress__buffer"],[1,"mdc-linear-progress__buffer-bar"],[1,"mdc-linear-progress__buffer-dots"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__primary-bar"],[1,"mdc-linear-progress__bar-inner"],["aria-hidden","true",1,"mdc-linear-progress__bar","mdc-linear-progress__secondary-bar"]],template:function(i,r){i&1&&(a(0,"div",0),f(1,"div",1),g(2,$e,1,0,"div",2),o(),a(3,"div",3),f(4,"span",4),o(),a(5,"div",5),f(6,"span",4),o()),i&2&&(n(),ee("flex-basis",r._getBufferBarFlexBasis()),n(),_e(r.mode==="buffer"?2:-1),n(),ee("transform",r._getPrimaryBarTransform()))},styles:[`.mat-mdc-progress-bar{display:block;text-align:start}.mat-mdc-progress-bar[mode=query]{transform:scaleX(-1)}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-dots,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__secondary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__bar-inner.mdc-linear-progress__bar-inner{animation:none}.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__primary-bar,.mat-mdc-progress-bar._mat-animation-noopable .mdc-linear-progress__buffer-bar{transition:transform 1ms}.mdc-linear-progress{position:relative;width:100%;transform:translateZ(0);outline:1px solid rgba(0,0,0,0);overflow-x:hidden;transition:opacity 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:max(var(--mdc-linear-progress-track-height),var(--mdc-linear-progress-active-indicator-height))}.cdk-high-contrast-active .mdc-linear-progress{outline-color:CanvasText}.mdc-linear-progress__bar{position:absolute;top:0;bottom:0;margin:auto 0;width:100%;animation:none;transform-origin:top left;transition:transform 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);height:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}[dir=rtl] .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top-style:solid;border-color:var(--mdc-linear-progress-active-indicator-color, var(--mat-app-primary));border-top-width:var(--mdc-linear-progress-active-indicator-height)}.mdc-linear-progress__buffer{display:flex;position:absolute;top:0;bottom:0;margin:auto 0;width:100%;overflow:hidden;height:var(--mdc-linear-progress-track-height);border-radius:var(--mdc-linear-progress-track-shape, var(--mat-app-corner-none))}.mdc-linear-progress__buffer-dots{-webkit-mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='xMinYMin slice'%3E%3Ccircle cx='1' cy='1' r='1'/%3E%3C/svg%3E");background-repeat:repeat-x;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear;background-color:var(--mdc-linear-progress-track-color, var(--mat-app-surface-variant))}.cdk-high-contrast-active .mdc-linear-progress__buffer-dots{background-color:ButtonBorder}[dir=rtl] .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;transform:rotate(0)}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0ms cubic-bezier(0.4, 0, 0.6, 1);background-color:var(--mdc-linear-progress-track-color, var(--mat-app-surface-variant))}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress__secondary-bar{display:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;display:block}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}[dir=rtl] .mdc-linear-progress.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(calc(var(--mdc-linear-progress-track-height) * -2.5))}}@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.205028, 0.057051, 0.57661, 0.453971);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.152313, 0.196432, 0.648374, 1.004315);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.257759, -0.003163, 0.211762, 1.38179);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(-83.67142%)}100%{transform:translateX(-200.611057%)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(-37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(-84.386165%)}100%{transform:translateX(-160.277782%)}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}`],encapsulation:2,changeDetection:0})}}return t})();function Xe(t,l=0,e=100){return Math.max(l,Math.min(e,t))}var Pt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=se({type:t})}static{this.\u0275inj=re({imports:[De]})}}return t})();var at=()=>["ALL_DOCUMENTS_EDIT_DOCUMENT","ASSIGNED_DOCUMENTS_EDIT_DOCUMENT"],st=t=>({"margin-right.px":t}),mt=t=>({"margin-left.px":t}),lt=t=>({color:t});function ct(t,l){t&1&&(a(0,"div",29),m(1),p(2,"translate"),o()),t&2&&(n(),_(" ",u(2,1,"NAME_IS_REQUIRED")," "))}function dt(t,l){if(t&1&&(a(0,"div")(1,"b"),m(2),o()()),t&2){let e=b().$implicit;n(2),_(" ",e.name,"")}}function pt(t,l){if(t&1&&(a(0,"div"),m(1),o()),t&2){let e=b().$implicit;n(),_(" ",e.name," ")}}function ut(t,l){if(t&1&&(a(0,"ng-option",30)(1,"div",31),g(2,dt,3,1,"div",32)(3,pt,2,1,"div",32),o()()),t&2){let e=l.$implicit,i=b();s("value",e.id),n(),s("ngStyle",i.direction==="rtl"?M(4,st,e.deafLevel*20):M(6,mt,e.deafLevel*20)),n(),s("ngIf",!e.parentId),n(),s("ngIf",e.parentId)}}function gt(t,l){if(t&1){let e=D();a(0,"div",33)(1,"button",34),v("click",function(){y(e);let r=b();return E(r.onAddCategory())}),f(2,"i-feather",35),o()()}}function ft(t,l){t&1&&(a(0,"div",29),m(1),p(2,"translate"),o()),t&2&&(n(),_(" ",u(2,1,"CATEGORY_NAME_IS_REQUIRED")," "))}function _t(t,l){if(t&1&&(a(0,"ng-option",30)(1,"span"),m(2),o()()),t&2){let e=l.$implicit;s("value",e.id),n(2),_(" ",e.companyName," ")}}function ht(t,l){if(t&1&&(a(0,"ng-option",30),m(1),p(2,"translate"),o()),t&2){let e=l.$implicit;s("value",e.value),n(),_(" ",u(2,2,e.key)," ")}}function vt(t,l){if(t&1&&(a(0,"ng-option",30)(1,"span",36),m(2),o()()),t&2){let e=l.$implicit;s("value",e.id),n(),s("ngStyle",M(3,lt,e==null?null:e.colorCode)),n(),_(" ",e.name," ")}}function bt(t,l){t&1&&(a(0,"label",9),m(1),p(2,"translate"),o()),t&2&&(n(),_(" ",u(2,1,"META_TAGS")," "))}function yt(t,l){if(t&1){let e=D();a(0,"button",44),v("click",function(){y(e);let r=b(2);return E(r.onAddAnotherMetaTag())}),f(1,"i-feather",45),o()}}function Et(t,l){if(t&1){let e=D();a(0,"button",46),v("click",function(){y(e);let r=b().index,c=b();return E(c.onDeleteMetaTag(r))}),f(1,"i-feather",47),o()}}function Ct(t,l){if(t&1){let e=D();a(0,"div",37),he(1,38),g(2,bt,3,3,"label",39),a(3,"div",40)(4,"input",41),v("change",function(r){let c=y(e).index,h=b();return E(h.onMetatagChange(r,c))}),o(),g(5,yt,2,0,"button",42)(6,Et,2,0,"button",43),o(),ve(),o()}if(t&2){let e=l.index;n(),s("formGroupName",e),n(),s("ngIf",e===0),n(3),s("ngIf",e===0),n(),s("ngIf",e!==0)}}function xt(t,l){if(t&1){let e=D();a(0,"button",48),v("click",function(){y(e);let r=b();return E(r.SaveDocument())}),f(1,"i-feather",49),m(2),p(3,"translate"),o()}t&2&&(n(2),_(" ",u(3,1,"SAVE"),""))}var ti=(()=>{class t extends X{get documentMetaTagsArray(){return this.documentForm.get("documentMetaTags")}constructor(e,i,r,c,h,x,J,K){super(),this.fb=e,this.dialogRef=i,this.data=r,this.toastrService=c,this.documentService=h,this.commonService=x,this.translationService=J,this.mtDialog=K,this.extension="",this.documentstatusStore=S(Re),this.categoryStore=S(Ue),this.retentionActions=[],this.clientStore=S(Be)}ngOnInit(){this.retentionActions=this.getEnumValues(Oe),this.createDocumentForm(),this.pushValuesDocumentMetatagArray(),this.patchDocumentForm(),this.getLangDir()}getLangDir(){this.sub$.sink=this.translationService.lanDir$.subscribe(e=>this.direction=e)}patchDocumentForm(){this.documentForm.patchValue(this.data.document,this.data.documentMetaDatas)}getEnumValues(e){return Object.keys(e).filter(i=>isNaN(Number(i))).map(i=>({key:i,value:e[i]}))}createDocumentForm(){this.documentForm=this.fb.group({name:["",[I.required]],description:[""],categoryId:["",[I.required]],documentMetaTags:this.fb.array([]),retentionPeriod:[""],retentionAction:[""],clientId:[""],statusId:[""]})}SaveDocument(){this.documentForm.valid?this.sub$.sink=this.documentService.updateDocument(this.buildDocumentObject()).subscribe(e=>{this.toastrService.success(this.translationService.getValue("DOCUMENT_UPDATE_SUCCESSFULLY")),this.addDocumentTrail()}):this.markFormGroupTouched(this.documentForm)}addDocumentTrail(){let e={documentId:this.data.document.id,operationName:ke.Modified.toString()};this.sub$.sink=this.commonService.addDocumentAuditTrail(e).subscribe(()=>{this.dialogRef.close("loaded")})}closeDialog(){this.dialogRef.close()}markFormGroupTouched(e){Object.values(e.controls).forEach(i=>{i.markAsTouched(),i.controls&&this.markFormGroupTouched(i)})}buildDocumentObject(){let e=this.documentMetaTagsArray.value;return{id:this.data.document.id,categoryId:this.documentForm.get("categoryId").value,clientId:this.documentForm.get("clientId").value,statusId:this.documentForm.get("statusId").value,retentionPeriod:this.documentForm.get("retentionPeriod").value,retentionAction:this.documentForm.get("retentionAction").value,description:this.documentForm.get("description").value,name:this.documentForm.get("name").value,documentMetaDatas:[...e]}}onDocumentCancel(){this.dialogRef.close("canceled")}onAddAnotherMetaTag(){let e={id:"",documentId:this.document&&this.document.id?this.document.id:"",metatag:""};this.documentMetaTagsArray.insert(0,this.editDocmentMetaData(e))}onDeleteMetaTag(e){this.documentMetaTagsArray.removeAt(e)}buildDocumentMetaTag(){return this.fb.group({id:[""],documentId:[""],metatag:[""]})}pushValuesDocumentMetatagArray(){this.sub$.sink=this.documentService.getdocumentMetadataById(this.data.document.id).subscribe(e=>{e.length>0?e.map(i=>{this.documentMetaTagsArray.push(this.editDocmentMetaData(i))}):this.documentMetaTagsArray.push(this.buildDocumentMetaTag())})}onMetatagChange(e,i){if(!this.documentMetaTagsArray.at(i).get("metatag").value)return;let c=this.documentMetaTagsArray.at(i).get("metatag");c.setValidators([I.required]),c.updateValueAndValidity()}editDocmentMetaData(e){return this.fb.group({id:[e.id],documentId:[e.documentId],metatag:[e.metatag]})}onAddCategory(){this.mtDialog.open(Pe,{width:"400px"}).afterClosed().subscribe(i=>{i&&setTimeout(()=>{this.documentForm.get("categoryId").setValue(this.categoryStore.currentCategoryId())},1e3)})}static{this.\u0275fac=function(i){return new(i||t)(d(L),d(V),d(O),d(z),d(Q),d(G),d(q),d(Ie))}}static{this.\u0275cmp=T({type:t,selectors:[["app-document-edit"]],inputs:{categories:"categories",documentInfo:"documentInfo"},features:[A],decls:66,vars:50,consts:[[1,"d-flex"],["mat-dialog-title","",1,"dialog-title"],["code","ADD_DOCUMENT"],["mat-icon-button","",1,"close-button","ms-auto",3,"click"],["color","warn",1,"close-icon"],["mat-dialog-content",""],[3,"formGroup"],[1,"row"],[1,"col-sm-12","m-b-10"],[1,"form-label"],["formControlName","name","type","text",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"col-md-6"],[1,"input-group"],["formControlName","categoryId",1,"flex-grow-1",3,"placeholder","clearable"],[3,"value",4,"ngFor","ngForOf"],["class","input-group-append",4,"hasClaim"],[1,"col-sm-6","m-b-10"],["formControlName","clientId",3,"placeholder"],[1,"col-sm-6"],["formControlName","retentionPeriod","type","number","min","1",1,"form-control"],["formControlName","retentionAction",3,"clearable"],["formControlName","description",1,"form-control"],["formControlName","statusId",3,"searchable","placeholder"],["formArrayName","documentMetaTags",4,"ngFor","ngForOf"],[1,"m-t-10","col-md-12"],["class","btn btn-success btn-sm m-r-10","cdkFocusInitial","",3,"click",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["name","x-circle",1,"small-icon"],[1,"text-danger"],[3,"value"],[1,"country-item",3,"ngStyle"],[4,"ngIf"],[1,"input-group-append"],["type","button","aria-label","Add category",1,"btn","btn-primary","add-category-button",3,"click"],["name","plus",1,"small-icon"],[3,"ngStyle"],["formArrayName","documentMetaTags"],[3,"formGroupName"],["class","form-label",4,"ngIf"],[1,"input-group","m-b-5"],["formControlName","metatag","type","text",1,"form-control",3,"change"],["class","btn btn-success","type","button",3,"click",4,"ngIf"],["class","btn btn-outline-danger","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success",3,"click"],["name","Plus",1,"btn-success","btn-sm","small-icon"],["type","button",1,"btn","btn-outline-danger",3,"click"],["name","trash",1,"btn-danger","btn-sm","small-icon"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["name","save",1,"small-icon"]],template:function(i,r){i&1&&(a(0,"div",0)(1,"span",1),m(2),p(3,"translate"),f(4,"app-page-help-text",2),o(),a(5,"button",3),v("click",function(){return r.closeDialog()}),a(6,"mat-icon",4),m(7,"close"),o()()(),a(8,"div",5)(9,"form",6)(10,"div",7)(11,"div",8)(12,"label",9),m(13),p(14,"translate"),o(),f(15,"input",10),g(16,ct,3,3,"div",11),o(),a(17,"div",12)(18,"label",9),m(19),p(20,"translate"),o(),a(21,"div",13)(22,"ng-select",14),p(23,"translate"),g(24,ut,4,8,"ng-option",15),o(),g(25,gt,3,0,"div",16),o(),g(26,ft,3,3,"div",11),o(),a(27,"div",17)(28,"label",9),m(29),p(30,"translate"),o(),a(31,"ng-select",18),p(32,"translate"),g(33,_t,3,2,"ng-option",15),o()(),a(34,"div",19)(35,"label",9),m(36),p(37,"translate"),o(),f(38,"input",20),o(),a(39,"div",19)(40,"label",9),m(41),p(42,"translate"),o(),a(43,"ng-select",21),g(44,ht,3,4,"ng-option",15),o()(),a(45,"div",8)(46,"label",9),m(47),p(48,"translate"),o(),a(49,"textarea",22),m(50,"        "),o()(),a(51,"div",12)(52,"label",9),m(53),p(54,"translate"),o(),a(55,"ng-select",23),p(56,"translate"),g(57,vt,3,5,"ng-option",15),o()(),a(58,"div",19),g(59,Ct,7,4,"div",24),o(),a(60,"div",25),g(61,xt,4,3,"button",26),a(62,"button",27),v("click",function(){return r.onDocumentCancel()}),f(63,"i-feather",28),m(64),p(65,"translate"),o()()()()()),i&2&&(n(2),_("",u(3,25,"EDIT_DOCUMENT")," "),n(7),s("formGroup",r.documentForm),n(4),C(u(14,27,"NAME")),n(3),s("ngIf",r.documentForm.get("name").touched&&r.documentForm.get("name").hasError("required")),n(3),C(u(20,29,"CATEGORY")),n(3),F("placeholder",u(23,31,"CATEGORY")),s("clearable",!1),n(2),s("ngForOf",r.categoryStore.categories()),n(),s("hasClaim","DOCUMENT_CATEGORY_MANAGE_DOCUMENT_CATEGORY"),n(),s("ngIf",r.documentForm.get("categoryId").touched&&r.documentForm.get("categoryId").hasError("required")),n(3),C(u(30,33,"CLIENT")),n(2),F("placeholder",u(32,35,"CLIENT")),n(2),s("ngForOf",r.clientStore.clients()),n(3),C(u(37,37,"RETENTION_PERIOD")),n(5),C(u(42,39,"RETENTION_ACTION")),n(2),s("clearable",!0),n(),s("ngForOf",r.retentionActions),n(3),C(u(48,41,"DESCRIPTION")),n(6),C(u(54,43,"DOCUMENT_STATUS")),n(2),F("placeholder",u(56,45,"NONE")),s("searchable",!0),n(2),s("ngForOf",r.documentstatusStore.statusList()),n(2),s("ngForOf",r.documentMetaTagsArray.controls),n(2),s("hasClaim",Ee(49,at)),n(3),_(" ",u(65,47,"CANCEL"),""))},dependencies:[Ce,w,xe,P,Te,Ae,Se,U,we,j,Ne,Fe,Me,B,R,H,Z,Y,Ve,W,Le,je,$]})}}return t})();function It(t,l){t&1&&(a(0,"div",18),m(1),p(2,"translate"),o()),t&2&&(n(),_(" ",u(2,1,"DOCUMENT_IS_REQUIRED")," "))}function Tt(t,l){t&1&&(a(0,"div",18),m(1),p(2,"translate"),o()),t&2&&(n(),_(" ",u(2,1,"DOCUMENT_TYPE_IS_NOT_ALLOWED")," "))}function St(t,l){if(t&1&&(a(0,"div"),g(1,Tt,3,3,"div",10),o()),t&2){let e,i=b();n(),s("ngIf",(e=i.documentForm.get("extension").errors)==null?null:e.required)}}function At(t,l){if(t&1&&f(0,"mat-progress-bar",19),t&2){let e=b();s("value",e.progress)}}var ai=(()=>{class t extends X{constructor(e,i,r,c,h,x,J,K,ze){super(),this.fb=e,this.data=i,this.httpClient=r,this.cd=c,this.dialogRef=h,this.documentService=x,this.toastrService=J,this.commonService=K,this.translationService=ze,this.allowFileExtension=[],this.extension="",this.isFileUpload=!1,this.showProgress=!1,this.progress=0}ngOnInit(){this.createDocumentForm(),this.getAllAllowFileExtension()}createDocumentForm(){this.documentForm=this.fb.group({url:["",[I.required]],extension:["",[I.required]]})}getAllAllowFileExtension(){this.sub$.sink=this.commonService.allowFileExtension$.subscribe(e=>{e&&(this.allowFileExtension=e)})}upload(e){if(e.length!==0){if(this.extension=e[0].name.split(".").pop(),this.documentForm.get("url").setValue(e[0].name),this.fileExtesionValidation(this.extension))this.fileUploadExtensionValidation("valid");else{this.fileUploadExtensionValidation(""),this.cd.markForCheck();return}this.fileData=e[0]}}fileUploadValidation(e){this.documentForm.patchValue({url:e}),this.documentForm.get("url").markAsTouched(),this.documentForm.updateValueAndValidity()}fileUploadExtensionValidation(e){this.documentForm.patchValue({extension:e}),this.documentForm.get("extension").markAsTouched(),this.documentForm.updateValueAndValidity()}fileExtesionValidation(e){return!!this.allowFileExtension.find(r=>r.extensions.split(",").some(c=>c.toLowerCase()===e.toLowerCase()))}SaveDocument(){if(this.documentForm.invalid){this.documentForm.markAllAsTouched();return}let e={documentId:this.data.id,url:this.fileData.fileName,fileData:this.fileData,extension:this.extension,location:this.data.location};this.sub$.sink=this.documentService.saveNewVersionDocument(e).subscribe(()=>{this.toastrService.success(this.translationService.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),this.dialogRef.close(!0)})}closeDialog(){this.dialogRef.close(!1)}static{this.\u0275fac=function(i){return new(i||t)(d(L),d(O),d(k),d(N),d(V),d(Q),d(z),d(G),d(q))}}static{this.\u0275cmp=T({type:t,selectors:[["app-document-upload-new-version"]],features:[A],decls:29,vars:16,consts:[["file",""],[1,"d-flex"],["mat-dialog-title","",1,"dialog-title"],["code","UPLOAD_NEW_VERSION"],["mat-icon-button","",1,"close-button","ms-auto",3,"click"],["color","warn",1,"close-icon"],["mat-dialog-content",""],[3,"formGroup"],[1,"col-md-12"],["type","file",1,"form-control",3,"change"],["class","text-danger",4,"ngIf"],[4,"ngIf"],["mode","determinate",3,"value",4,"ngIf"],[1,"m-t-10","col-md-12","m-b-2"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","m-r-10",3,"click"],["name","save",1,"small-icon"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["name","x-circle",1,"small-icon"],[1,"text-danger"],["mode","determinate",3,"value"]],template:function(i,r){if(i&1){let c=D();a(0,"div",1)(1,"span",2),m(2),p(3,"translate"),f(4,"app-page-help-text",3),o(),a(5,"button",4),v("click",function(){return y(c),E(r.closeDialog())}),a(6,"mat-icon",5),m(7,"close"),o()()(),a(8,"div",6)(9,"form",7)(10,"div",8)(11,"label"),m(12),p(13,"translate"),o(),a(14,"input",9,0),v("change",function(){y(c);let x=be(15);return E(r.upload(x.files))}),o(),g(16,It,3,3,"div",10)(17,St,2,1,"div",11),o(),a(18,"div",8),g(19,At,1,1,"mat-progress-bar",12),o(),a(20,"div",13)(21,"button",14),v("click",function(){return y(c),E(r.SaveDocument())}),f(22,"i-feather",15),m(23),p(24,"translate"),o(),a(25,"button",16),v("click",function(){return y(c),E(r.closeDialog())}),f(26,"i-feather",17),m(27),p(28,"translate"),o()()()()}if(i&2){let c,h;n(2),_("",u(3,8,"UPLOAD_NEW_VERSION_FILE")," "),n(7),s("formGroup",r.documentForm),n(3),C(u(13,10,"DOCUMENT_UPLOAD")),n(4),s("ngIf",r.documentForm.get("url").touched&&((c=r.documentForm.get("url").errors)==null?null:c.required)),n(),s("ngIf",(r.documentForm.get("extension").touched||r.documentForm.get("extension").dirty)&&r.documentForm.get("extension").errors&&!((h=r.documentForm.get("url").errors)!=null&&h.required)),n(2),s("ngIf",r.showProgress),n(4),_(" ",u(24,12,"SAVE")," "),n(4),_(" ",u(28,14,"CANCEL")," ")}},dependencies:[w,P,U,j,B,R,H,Z,Y,W,Ge,$],styles:[".row[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}"]})}}return t})();var mi=(()=>{class t{constructor(e){this.httpClient=e}getDocumentComment(e){let i=`documentComment/${e}`;return this.httpClient.get(i)}deleteDocumentComment(e){let i=`documentComment/${e}`;return this.httpClient.delete(i)}saveDocumentComment(e){return this.httpClient.post("documentComment",e)}static{this.\u0275fac=function(i){return new(i||t)(ae(k))}}static{this.\u0275prov=ne({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{mi as a,Ge as b,Pt as c,ti as d,ai as e};
