import{a as he,b as Se,c as xe}from"./chunk-Z4CJWSTO.js";import{a as ie}from"./chunk-FUBOQZYU.js";import{a as ne,b as oe,c as se,d as ae,e as re,f as me,g as le,h as ce,i as pe,j as de,k as ue,l as _e,m as fe,n as De,o as Ce,q as I}from"./chunk-ZQ2PWCHX.js";import{G as ee,J as te,f as J,j as K,v as Z}from"./chunk-VNAU6AHI.js";import{a as q}from"./chunk-YTVNRIZ3.js";import{C as N,D as $,F,G as V,H,L as W}from"./chunk-3XAX4OT5.js";import{ia as Y,ja as z,ma as X}from"./chunk-NF46UI75.js";import{p as Q,t as G}from"./chunk-SIUWMJOE.js";import{$b as y,Ab as p,Ac as u,Bc as b,Ea as w,Ed as j,Kb as s,Lb as o,Mb as S,Na as x,Nb as f,Oa as P,Ob as D,Qb as E,Tb as v,Vb as C,Zc as B,ac as M,bc as k,gc as a,hc as A,ib as i,ic as r,jb as h,jc as U,sc as O,tb as R,wb as _,zc as l}from"./chunk-EOQA7B6X.js";var ge=["userPermissionsPaginator"],Ee=()=>[10,20,50,100];function Te(e,n){if(e&1&&(s(0,"div",38)(1,"p")(2,"b"),a(3),l(4,"translate"),o(),a(5),o()()),e&2){let t=C(2);i(3),r("",u(4,2,"DESCRIPTION"),":"),i(2),r(" ",t.document.description,"")}}function be(e,n){if(e&1&&(s(0,"div",35)(1,"div",36)(2,"p")(3,"b"),a(4),l(5,"translate"),o(),a(6),o()(),_(7,Te,6,4,"div",37),o()),e&2){let t=C();i(4),r("",u(5,3,"DOCUMENT_NAME"),":"),i(2),r(" ",t.document.name,""),i(),p("ngIf",t.document.description)}}function Ie(e,n){e&1&&(s(0,"th",39),a(1),l(2,"translate"),o()),e&2&&(i(),r("",u(2,1,"ACTION")," "))}function Le(e,n){if(e&1){let t=E();s(0,"button",42),v("click",function(){x(t);let d=C().$implicit,c=C();return P(c.deleteDocumentUserPermission(d))}),S(1,"i-feather",43),a(2),l(3,"translate"),o()}e&2&&(i(2),r(" ",u(3,1,"DELETE"),""))}function we(e,n){if(e&1){let t=E();s(0,"button",42),v("click",function(){x(t);let d=C().$implicit,c=C();return P(c.deleteDocumentRolePermission(d))}),S(1,"i-feather",43),a(2),l(3,"translate"),o()}e&2&&(i(2),r(" ",u(3,1,"DELETE"),""))}function Re(e,n){if(e&1&&(s(0,"td",40),_(1,Le,4,3,"button",41)(2,we,4,3,"button",41),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.type==="User"),i(),p("ngIf",t.type==="Role")}}function ye(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r("",u(2,1,"ALLOW_DOWNLOAD")," "))}function Me(e,n){e&1&&(f(0),a(1),l(2,"translate"),D()),e&2&&(i(),r(" ",u(2,1,"YES")," "))}function ke(e,n){e&1&&(f(0),a(1),l(2,"translate"),D()),e&2&&(i(),r(" ",u(2,1,"NO")," "))}function Ae(e,n){if(e&1&&(s(0,"td",45),_(1,Me,3,3,"ng-container",46)(2,ke,3,3,"ng-container",46),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.isAllowDownload),i(),p("ngIf",!t.isAllowDownload)}}function Ue(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r("",u(2,1,"TYPE")," "))}function Oe(e,n){if(e&1&&(s(0,"td",45),a(1),o()),e&2){let t=n.$implicit;i(),r(" ",t.type," ")}}function Be(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r(" ",u(2,1,"USER_ROLE_NAME")," "))}function Ne(e,n){if(e&1&&(s(0,"span"),a(1),o()),e&2){let t=C().$implicit;i(),U(" ",t.user==null?null:t.user.firstName," ",t.user==null?null:t.user.lastName," ")}}function $e(e,n){if(e&1&&(s(0,"span"),a(1),o()),e&2){let t=C().$implicit;i(),r(" ",t.role==null?null:t.role.name," ")}}function Fe(e,n){if(e&1&&(s(0,"td",45),_(1,Ne,2,2,"span",46)(2,$e,2,1,"span",46),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.type==="User"),i(),p("ngIf",t.type==="Role")}}function Ve(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r(" ",u(2,1,"EMAIL")," "))}function He(e,n){if(e&1&&(s(0,"span"),a(1),o()),e&2){let t=C().$implicit;i(),r(" ",t.user==null?null:t.user.email," ")}}function je(e,n){e&1&&(s(0,"span"),a(1," -- "),o())}function Ye(e,n){if(e&1&&(s(0,"td",45),_(1,He,2,1,"span",46)(2,je,2,0,"span",46),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.type==="User"),i(),p("ngIf",t.type==="Role")}}function We(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r(" ",u(2,1,"START_DATE")," "))}function Qe(e,n){if(e&1&&(f(0),a(1),l(2,"utcToLocalTime"),D()),e&2){let t=C().$implicit;i(),r(" ",b(2,1,t.startDate,"shortDate")," ")}}function Ge(e,n){e&1&&(f(0),a(1," -- "),D())}function ze(e,n){if(e&1&&(s(0,"td",45),_(1,Qe,3,4,"ng-container",46)(2,Ge,2,0,"ng-container",46),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.isTimeBound),i(),p("ngIf",!t.isTimeBound)}}function qe(e,n){e&1&&(s(0,"th",44),a(1),l(2,"translate"),o()),e&2&&(i(),r(" ",u(2,1,"END_DATE")," "))}function Je(e,n){if(e&1&&(f(0),a(1),l(2,"utcToLocalTime"),D()),e&2){let t=C().$implicit;i(),r(" ",b(2,1,t.endDate,"shortDate")," ")}}function Ke(e,n){e&1&&(f(0),a(1," -- "),D())}function Xe(e,n){if(e&1&&(s(0,"td",45),_(1,Je,3,4,"ng-container",46)(2,Ke,2,0,"ng-container",46),o()),e&2){let t=n.$implicit;i(),p("ngIf",t.isTimeBound),i(),p("ngIf",!t.isTimeBound)}}function Ze(e,n){e&1&&(s(0,"td",47),S(1,"mat-paginator",48,1),o()),e&2&&(i(),p("pageSizeOptions",O(1,Ee)))}function et(e,n){e&1&&(s(0,"tr")(1,"td",49)(2,"div",50)(3,"b"),a(4),l(5,"translate"),o()()()()),e&2&&(i(4),r(" ",u(5,1,"NO_DATA_FOUND"),""))}function tt(e,n){e&1&&S(0,"tr",51)}function it(e,n){e&1&&S(0,"tr",52)}function nt(e,n){e&1&&S(0,"tr",53)}var It=(()=>{class e extends Y{constructor(t,m,d,c,g,T,L,Pe,ve){super(),this.documentPermissionService=t,this.route=m,this.commonDialogService=d,this.toastrService=c,this.dialog=g,this.commonService=T,this.data=L,this.dialogRef=Pe,this.translationService=ve,this.documentPermissions=[],this.users=[],this.roles=[],this.documentPermissionsColumns=["action","type","isAllowDownload","name","email","startDate","endDate"],this.footerToDisplayed=["footer"],this.document=L}ngOnInit(){this.sub$.sink=this.route.params.subscribe(()=>{this.getDocumentPrmission(),this.getUsers(),this.getRoles()})}getDocumentPrmission(){this.sub$.sink=this.documentPermissionService.getDoucmentPermission(this.document.id).subscribe(t=>{this.documentPermissions=t,this.permissionsDataSource=new I(this.documentPermissions),this.permissionsDataSource.paginator=this.userPermissionsPaginator})}getUsers(){this.sub$.sink=this.commonService.getUsersForDropdown().subscribe(t=>this.users=t)}getRoles(){this.sub$.sink=this.commonService.getRolesForDropdown().subscribe(t=>this.roles=t)}deleteDocumentUserPermission(t){this.sub$.sink=this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(m=>{m&&(this.sub$.sink=this.documentPermissionService.deleteDocumentUserPermission(t.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getDocumentPrmission()}))})}deleteDocumentRolePermission(t){this.sub$.sink=this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(m=>{m&&(this.sub$.sink=this.documentPermissionService.deleteDocumentRolePermission(t.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PERMISSION_DELETED_SUCCESSFULLY")),this.getDocumentPrmission()}))})}addDocumentUserPermission(){let t=this.dialog.open(xe,{width:"600px",data:Object.assign({users:this.users,documentId:this.document.id})});this.sub$.sink=t.afterClosed().subscribe(m=>{m&&this.getDocumentPrmission()})}addDocumentRolePermission(){let t=this.dialog.open(Se,{width:"600px",data:Object.assign({roles:this.roles,documentId:this.document.id})});this.sub$.sink=t.afterClosed().subscribe(m=>{m&&this.getDocumentPrmission()})}applyPermissionFilter(t){let m=t.target.value.trim(),d=this.documentPermissions.filter(c=>c.type=="User"&&(c.user.firstName.toLocaleLowerCase().includes(m)||c.user.lastName.toLocaleLowerCase().includes(m)||c.user.email.toLocaleLowerCase().includes(m))||c.type=="Role"&&c.role.name.toLocaleLowerCase().includes(m));this.permissionsDataSource=new I(d),this.permissionsDataSource.paginator=this.userPermissionsPaginator}closeDialog(){this.dialogRef.close()}static{this.\u0275fac=function(m){return new(m||e)(h(he),h(j),h(ee),h(Q),h(F),h(W),h($),h(N),h(z))}}static{this.\u0275cmp=w({type:e,selectors:[["app-document-permission-list"]],viewQuery:function(m,d){if(m&1&&y(ge,5),m&2){let c;M(c=k())&&(d.userPermissionsPaginator=c.first)}},features:[R],decls:57,vars:19,consts:[["input1",""],["userPermissionsPaginator",""],[1,"d-flex"],["mat-dialog-title","",1,"page-title"],["code","SHARE_DOCUMENT"],["mat-icon-button","",1,"close-button","ms-auto",3,"click"],["color","warn",1,"close-icon"],["mat-dialog-content",""],[1,"row"],["class","col-md-12 row pl-0",4,"ngIf"],[1,"col"],["type","button",1,"btn","btn-success","btn-sm","m-r-10","m-t-10",3,"click"],["name","plus",1,"small-icon"],["type","button",1,"btn","btn-success","btn-sm","m-r-10","m-t-10","ml-3",3,"click"],[1,"col","m-t-10","mb-2"],[1,"form-control",3,"keyup"],[1,"grid-height-permission"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","action"],["style","width:20%","mat-header-cell","",4,"matHeaderCellDef"],["style","width:20%","mat-cell","",4,"matCellDef"],["matColumnDef","isAllowDownload"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","type"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","footer"],["mat-footer-cell","","colspan","7",4,"matFooterCellDef"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],[1,"col-md-12","row","pl-0"],[1,"col-md-4"],["class","col-md-8",4,"ngIf"],[1,"col-md-8"],["mat-header-cell","",2,"width","20%"],["mat-cell","",2,"width","20%"],["class","btn btn-danger btn-sm","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["name","trash",1,"small-icon"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["mat-footer-cell","","colspan","7"],[3,"pageSizeOptions"],["colspan","5"],[1,"m-2"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(m,d){if(m&1){let c=E();s(0,"div",2)(1,"span",3),a(2),l(3,"translate"),S(4,"app-page-help-text",4),o(),s(5,"button",5),v("click",function(){return x(c),P(d.closeDialog())}),s(6,"mat-icon",6),a(7,"close"),o()()(),s(8,"div",7)(9,"div",8),_(10,be,8,5,"div",9),o(),s(11,"div",8)(12,"div",10)(13,"button",11),v("click",function(){return x(c),P(d.addDocumentUserPermission())}),S(14,"i-feather",12),a(15),l(16,"translate"),o(),s(17,"button",13),v("click",function(){return x(c),P(d.addDocumentRolePermission())}),S(18,"i-feather",12),a(19),l(20,"translate"),o()()(),s(21,"div",8)(22,"div",14)(23,"mat-label"),a(24),l(25,"translate"),o(),s(26,"input",15,0),v("keyup",function(T){return x(c),P(d.applyPermissionFilter(T))}),o()()(),s(28,"div",16)(29,"table",17),f(30,18),_(31,Ie,3,3,"th",19)(32,Re,3,2,"td",20),D(),f(33,21),_(34,ye,3,3,"th",22)(35,Ae,3,2,"td",23),D(),f(36,24),_(37,Ue,3,3,"th",22)(38,Oe,2,1,"td",23),D(),f(39,25),_(40,Be,3,3,"th",22)(41,Fe,3,2,"td",23),D(),f(42,26),_(43,Ve,3,3,"th",22)(44,Ye,3,2,"td",23),D(),f(45,27),_(46,We,3,3,"th",22)(47,ze,3,2,"td",23),D(),f(48,28),_(49,qe,3,3,"th",22)(50,Xe,3,2,"td",23),D(),f(51,29),_(52,Ze,3,2,"td",30),D(),_(53,et,6,3,"tr",31)(54,tt,1,0,"tr",32)(55,it,1,0,"tr",33)(56,nt,1,0,"tr",34),o()()()}m&2&&(i(2),r("",u(3,11,"SHARE_DOCUMENT")," "),i(8),p("ngIf",d.document),i(5),r(" ",u(16,13,"ASSIGN_SHARE_WITH_USERS")," "),i(4),r(" ",u(20,15,"ASSIGN_SHARE_WITH_ROLES")," "),i(5),A(u(25,17,"FILTER")),i(5),p("dataSource",d.permissionsDataSource),i(25),p("matHeaderRowDef",d.documentPermissionsColumns)("matHeaderRowDefSticky",!0),i(),p("matRowDefColumns",d.documentPermissionsColumns),i(),p("matFooterRowDef",d.footerToDisplayed)("matFooterRowDefSticky",!0))},dependencies:[B,X,Z,K,q,te,ne,se,pe,re,oe,ue,ae,de,me,ce,le,_e,De,fe,Ce,V,H,ie,G,J]})}}return e})();export{It as a};
