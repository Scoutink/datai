import{a as Be}from"./chunk-M3FQE2TU.js";import{a as Qe,b as Ze,c as de}from"./chunk-BA6HV3TP.js";import{a as Ke}from"./chunk-C22BUVQ6.js";import{p as Je}from"./chunk-ZQ2PWCHX.js";import{b as je}from"./chunk-54YXYWWQ.js";import{b as Ue}from"./chunk-JB4URTUB.js";import{b as He}from"./chunk-SLA72EXZ.js";import"./chunk-PSHPNFJ6.js";import"./chunk-EST3G7IM.js";import{a as Ye,b as qe}from"./chunk-TNLJ7CAF.js";import{a as We,b as ze,c as $e}from"./chunk-UX7VFZY4.js";import"./chunk-5HUZTPPR.js";import{J as ae,K as re,c as we,j as ke,k as W}from"./chunk-VNAU6AHI.js";import{b as Fe,e as Ge,f as dt,g as Ve,h as Le}from"./chunk-2GYG6N64.js";import{a as ie,b as K}from"./chunk-YTVNRIZ3.js";import{C as ye,D as Ie,F as J,G as Ce,H as Ae,J as be,L as Pe}from"./chunk-3XAX4OT5.js";import{aa as xe,ca as Te,ia as Ne,ja as H,ma as Re,na as oe}from"./chunk-NF46UI75.js";import{p as L,q as B,t as U,u as j}from"./chunk-SIUWMJOE.js";import{a as ne}from"./chunk-GTE6R5NX.js";import{a as Me}from"./chunk-FGSJTZPD.js";import{c as Oe}from"./chunk-73F4PDV3.js";import{A as G,C as te,D as V,c as Z,e as y,h as P,i as O,o as w,p as De,r as k,s as X,t as ee,u as R}from"./chunk-TMWBOQE5.js";import{Ab as l,Ac as c,Ea as D,Jd as Q,Kb as i,Lb as e,Mb as S,Na as C,Nb as z,Oa as A,Ob as $,Qb as b,Tb as _,Va as se,Vb as h,Yb as T,Yc as q,Zb as fe,Zc as M,bd as he,eb as ue,ed as _e,g as lt,gc as n,h as ce,hc as E,ib as r,ic as u,jb as x,jc as ge,jd as N,rc as F,rd as Se,tb as ve,tc as Y,wb as v,za as f,zc as p,zd as Ee}from"./chunk-EOQA7B6X.js";var rt=lt(dt());var st=o=>({"margin-right.px":o}),ut=o=>({"margin-left.px":o}),vt=o=>({color:o});function ft(o,d){o&1&&(i(0,"div",31),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"NAME_IS_REQUIRED")," "))}function gt(o,d){if(o&1&&(i(0,"div"),v(1,ft,3,3,"div",15),e()),o&2){let t,m=h();r(),l("ngIf",(t=m.documentForm.get("name").errors)==null?null:t.required)}}function ht(o,d){if(o&1&&(i(0,"div")(1,"b"),n(2),e()()),o&2){let t=h().$implicit;r(2),u(" ",t.name,"")}}function _t(o,d){if(o&1&&(i(0,"div"),n(1),e()),o&2){let t=h().$implicit;r(),u(" ",t.name," ")}}function St(o,d){if(o&1&&(i(0,"ng-option",17)(1,"div",32),v(2,ht,3,1,"div",10)(3,_t,2,1,"div",10),e()()),o&2){let t=d.$implicit,m=h();l("value",t.id),r(),l("ngStyle",m.direction==="rtl"?Y(4,st,t.deafLevel*20):Y(6,ut,t.deafLevel*20)),r(),l("ngIf",!t.parentId),r(),l("ngIf",t.parentId)}}function Et(o,d){if(o&1){let t=b();i(0,"div",33)(1,"button",34),_("click",function(){C(t);let a=h();return A(a.onAddCategory())}),S(2,"i-feather",35),e()()}}function xt(o,d){o&1&&(i(0,"div",31),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"CATEGORY_IS_REQUIRED")," "))}function Tt(o,d){o&1&&(i(0,"ng-option",17),n(1),p(2,"translate"),e()),o&2&&(l("value","s3"),r(),E(c(2,2,"S3")))}function yt(o,d){if(o&1&&(i(0,"ng-option",17)(1,"span"),n(2),e()()),o&2){let t=d.$implicit;l("value",t.id),r(2),u(" ",t.companyName," ")}}function It(o,d){if(o&1&&(i(0,"ng-option",17)(1,"span",36),n(2),e()()),o&2){let t=d.$implicit;l("value",t.id),r(),l("ngStyle",Y(3,vt,t==null?null:t.colorCode)),r(),u(" ",t.name," ")}}function Ct(o,d){o&1&&(i(0,"label"),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"META_TAGS")," "))}function At(o,d){if(o&1){let t=b();i(0,"button",44),_("click",function(){C(t);let a=h(2);return A(a.onAddAnotherMetaTag())}),S(1,"i-feather",45),e()}}function bt(o,d){if(o&1){let t=b();i(0,"button",46),_("click",function(){C(t);let a=h().index,s=h();return A(s.onDeleteMetaTag(a))}),S(1,"i-feather",47),e()}}function Dt(o,d){if(o&1){let t=b();i(0,"div",37),z(1,38),v(2,Ct,3,3,"label",10),i(3,"div",6)(4,"div",39)(5,"input",40),_("change",function(a){let s=C(t).index,g=h();return A(g.onMetatagChange(a,s))}),e()(),i(6,"div",41),v(7,At,2,0,"button",42)(8,bt,2,0,"button",43),e()(),$(),e()}if(o&2){let t=d.index;r(),l("formGroupName",t),r(),l("ngIf",t==0),r(5),l("ngIf",t==0),r(),l("ngIf",t!=0)}}var nt=(()=>{class o extends Ne{get documentMetaTagsArray(){return this.documentForm.get("documentMetaTags")}constructor(t,m,a,s,g,I,me,le,mt){super(),this.fb=t,this.dialogRef=m,this.data=a,this.toastrService=s,this.documentService=g,this.translationService=I,this.securityService=me,this.commonService=le,this.mtDialog=mt,this.extension="",this.isS3Supported=!1,this.categoryStore=f(He),this.documentstatusStore=f(je),this.clientStore=f(Ue)}ngOnInit(){this.getCompanyProfile(),this.createDocumentForm(),this.documentMetaTagsArray.push(this.buildDocumentMetaTag())}getCompanyProfile(){this.securityService.companyProfile.subscribe(t=>{t&&(this.isS3Supported=t.location=="s3")})}createDocumentForm(){this.documentForm=this.fb.group({name:["",[y.required]],description:[""],categoryId:[{value:"",disabled:!1},[y.required]],clientId:[""],location:[""],statusId:[""],documentMetaTags:this.fb.array([])}),this.companyProfileSubscription()}companyProfileSubscription(){this.securityService.companyProfile.subscribe(t=>{t&&this.documentForm.get("location").setValue(t.location??"local")})}saveDocument(){this.documentForm.valid?this.documentService.addDocument(this.buildDocumentObject()).subscribe(t=>{this.document=t,this.toastrService.success(this.translationService.getValue("DOCUMENT_SAVE_SUCCESSFULLY")),this.addDocumentTrail()}):this.documentForm.markAllAsTouched()}addDocumentTrail(){let t={documentId:this.document.id,operationName:Fe.Created.toString()};this.sub$.sink=this.commonService.addDocumentAuditTrail(t).subscribe(m=>{this.dialogRef.close(!0)})}markFormGroupTouched(t){Object.values(t.controls).forEach(m=>{m.markAsTouched(),m.controls&&this.markFormGroupTouched(m)})}onMetatagChange(t,m){if(!this.documentMetaTagsArray.at(m).get("metatag").value)return;let s=this.documentMetaTagsArray.at(m).get("metatag");s.setValidators([y.required]),s.updateValueAndValidity()}buildMetaTagObject(){return(this.documentMetaTagsArray.getRawValue().length>0?this.documentMetaTagsArray.getRawValue():[]).map(a=>({id:a.id,documentId:a.documentId,documentMetaTagId:a.documentMetaTagId,metatag:a.metatag,metaTagDate:a.metaTagDate?.toString()==="Invalid Date"?null:a.metaTagDate?new Date(a.metaTagDate).toISOString():null,metaTagType:a.metaTagType}))}buildDocumentObject(){return{categoryId:this.documentForm.get("categoryId").value,description:this.documentForm.get("description").value,name:this.documentForm.get("name").value,statusId:this.documentForm.get("statusId").value,extension:"pdf",location:this.documentForm.get("location").value,clientId:this.documentForm.get("clientId").value??"",documentMetaDatas:[...this.buildMetaTagObject()],html_content:this.data.html_content}}onDocumentCancel(){this.dialogRef.close("canceled")}onAddAnotherMetaTag(){let t={id:"",documentId:this.document&&this.document.id?this.document.id:"",metatag:""};this.documentMetaTagsArray.insert(0,this.editDocmentMetaData(t))}onDeleteMetaTag(t){this.documentMetaTagsArray.removeAt(t)}editDocmentMetaData(t){return this.fb.group({id:[t.id],documentId:[t.documentId],metatag:[t.metatag]})}buildDocumentMetaTag(){return this.fb.group({id:[""],documentId:[""],documentMetaTagId:[""],metatag:[""],metaTagDate:[null],metaTagType:[0]})}onAddCategory(){this.mtDialog.open(Ke,{width:"400px"}).afterClosed().subscribe(m=>{m&&setTimeout(()=>{this.documentForm.get("categoryId").setValue(this.categoryStore.currentCategoryId())},1e3)})}static{this.\u0275fac=function(m){return new(m||o)(x(G),x(ye),x(Ie),x(L),x(Ge),x(H),x(ne),x(Pe),x(J))}}static{this.\u0275cmp=D({type:o,selectors:[["app-add-document"]],standalone:!0,features:[ve,F],decls:72,vars:52,consts:[[1,"d-flex"],["mat-dialog-title","",1,"dialog-title"],["code","ADD_DOCUMENT"],["mat-icon-button","",1,"ms-auto",3,"click"],["color","warn",1,"close-icon"],[3,"formGroup"],[1,"row"],[1,"col-md-4"],[1,"form-group"],["formControlName","name","type","text",1,"form-control"],[4,"ngIf"],[1,"input-group"],["formControlName","categoryId",1,"flex-grow-1",3,"placeholder","clearable"],[3,"value",4,"ngFor","ngForOf"],["class","input-group-append",4,"hasClaim"],["class","text-danger",4,"ngIf"],["formControlName","location",3,"clearable"],[3,"value"],[3,"value",4,"ngIf"],[1,"form-label"],["formControlName","clientId",3,"placeholder"],["formControlName","statusId",3,"searchable","placeholder"],[1,"col-md-4","mt-2"],["class","","formArrayName","documentMetaTags",4,"ngFor","ngForOf"],[1,"col-md-12","mt-2"],["formControlName","description",1,"form-control"],[1,"mt-2","col-md-12"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","me-2",3,"click"],["name","save",1,"small-icon"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],["name","x-circle",1,"small-icon"],[1,"text-danger"],[1,"country-item",3,"ngStyle"],[1,"input-group-append"],["type","button","aria-label","Add category",1,"btn","btn-primary","add-category-button",3,"click"],["name","plus",1,"small-icon"],[3,"ngStyle"],["formArrayName","documentMetaTags",1,""],[3,"formGroupName"],[1,"form-group","col-md","mb-1","col"],["formControlName","metatag","type","text",1,"form-control",3,"change"],[1,"form-group","col-md-auto","col-auto","mb-1","pl-3","ps-0"],["class","btn btn-success","type","button",3,"click",4,"ngIf"],["class","btn btn-outline-danger","type","button",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success",3,"click"],["name","plus-circle",1,"small-icon"],["type","button",1,"btn","btn-outline-danger",3,"click"],["name","trash-2",1,"small-icon"]],template:function(m,a){m&1&&(i(0,"div",0)(1,"span",1),n(2),p(3,"translate"),S(4,"app-page-help-text",2),e(),i(5,"button",3),_("click",function(){return a.onDocumentCancel()}),i(6,"mat-icon",4),n(7,"close"),e()()(),i(8,"mat-dialog-content")(9,"form",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"label"),n(14),p(15,"translate"),e(),S(16,"input",9),v(17,gt,2,1,"div",10),e()(),i(18,"div",7)(19,"div",8)(20,"label"),n(21),p(22,"translate"),e(),i(23,"div",11)(24,"ng-select",12),p(25,"translate"),v(26,St,4,8,"ng-option",13),e(),v(27,Et,3,0,"div",14),e(),v(28,xt,3,3,"div",15),e()(),i(29,"div",7)(30,"div",8)(31,"label"),n(32),p(33,"translate"),e(),i(34,"ng-select",16)(35,"ng-option",17),n(36),p(37,"translate"),e(),v(38,Tt,3,4,"ng-option",18),e()()(),i(39,"div",7)(40,"div",8)(41,"label",19),n(42),p(43,"translate"),e(),i(44,"ng-select",20),p(45,"translate"),v(46,yt,3,2,"ng-option",13),e()()(),i(47,"div",7)(48,"label",19),n(49),p(50,"translate"),e(),i(51,"ng-select",21),p(52,"translate"),v(53,It,3,5,"ng-option",13),e()(),i(54,"div",22),v(55,Dt,9,4,"div",23),e(),i(56,"div",24)(57,"div",8)(58,"label"),n(59),p(60,"translate"),e(),i(61,"textarea",25),n(62,"                    "),e()()(),i(63,"div",26)(64,"button",27),_("click",function(){return a.saveDocument()}),S(65,"i-feather",28),n(66),p(67,"translate"),e(),i(68,"button",29),_("click",function(){return a.onDocumentCancel()}),S(69,"i-feather",30),n(70),p(71,"translate"),e()()()()()),m&2&&(r(2),u("",c(3,26,"ADD_DOCUMENT")," "),r(7),l("formGroup",a.documentForm),r(5),E(c(15,28,"NAME")),r(3),l("ngIf",a.documentForm.get("name").touched&&a.documentForm.get("name").errors),r(4),E(c(22,30,"CATEGORY")),r(3),T("placeholder",c(25,32,"CATEGORY")),l("clearable",!1),r(2),l("ngForOf",a.categoryStore.categories()),r(),l("hasClaim","DOCUMENT_CATEGORY_MANAGE_DOCUMENT_CATEGORY"),r(),l("ngIf",a.documentForm.get("categoryId").touched&&a.documentForm.get("categoryId").hasError("required")),r(4),E(c(33,34,"STORAGE")),r(2),l("clearable",!1),r(),l("value","local"),r(),E(c(37,36,"LOCAL")),r(2),l("ngIf",a.isS3Supported),r(4),E(c(43,38,"CLIENT")),r(2),T("placeholder",c(45,40,"CLIENT")),r(2),l("ngForOf",a.clientStore.clients()),r(3),E(c(50,42,"DOCUMENT_STATUS")),r(2),T("placeholder",c(52,44,"NONE")),l("searchable",!0),r(2),l("ngForOf",a.documentstatusStore.statusList()),r(2),l("ngForOf",a.documentMetaTagsArray.controls),r(4),E(c(60,46,"DESCRIPTION")),r(7),u(" ",c(67,48,"SAVE"),""),r(4),E(c(71,50,"CANCEL")))},dependencies:[V,w,Z,P,O,k,R,X,ee,j,U,B,N,q,M,he,K,ie,re,Re,ke,we,ae,W,be,Ce,Ae,oe,$e,ze,We]})}}return o})();function ot(o){return d=>(d.value||"").includes(o)?{keywordExists:!0}:null}function Ft(o,d){if(o&1&&(i(0,"mat-option",8),n(1),e()),o&2){let t=d.$implicit;l("value",t.id),r(),u(" ",t.name," ")}}function Mt(o,d){if(o&1){let t=b();i(0,"div",82),z(1,83),i(2,"div",6)(3,"label"),n(4),p(5,"titlecase"),e(),i(6,"input",84),_("input",function(a){let s=C(t).index,g=h();return A(g.onInputChange(s,a))}),e()(),$(),e()}if(o&2){let t=d.$implicit,m=d.index;r(),l("formGroupName",m),r(3),u(" ",c(5,2,t.get("keyword").value)," ")}}function Nt(o,d){o&1&&(i(0,"div",11),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"REPLACE_WORD")," "))}function Pt(o,d){if(o&1&&(i(0,"div"),v(1,Nt,3,3,"div",85),e()),o&2){let t=h();r(),l("ngIf",t.aiPromtForm.get("promptInput").hasError("required"))}}function Ot(o,d){o&1&&(i(0,"div",11),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"REPLACE_WORD")," "))}function wt(o,d){if(o&1&&(i(0,"div"),v(1,Ot,3,3,"div",85),e()),o&2){let t=h();r(),l("ngIf",t.aiPromtForm.get("promptInput").hasError("keywordExists"))}}function kt(o,d){if(o&1&&(i(0,"mat-option",8),n(1),e()),o&2){let t=d.$implicit;l("value",t.id),r(),ge(" ",t.label," \u2014 ",t.description," ")}}function Rt(o,d){if(o&1&&(z(0),i(1,"mat-optgroup",86),v(2,kt,2,3,"mat-option",9),e(),$()),o&2){let t=d.$implicit,m=h();r(),l("label",t),r(),l("ngForOf",m.groupedModels[t])}}var at=(()=>{class o{get keywords(){return this.aiPromtForm.get("keywords")}get providers(){return Object.keys(this.groupedModels)}constructor(){this.aiPromptTemplates=[],this.aIPromptTemplateService=f(Be),this.translationService=f(H),this.toastrService=f(L),this.securityService=f(ne),this.fb=f(G),this.generateHandler=new se,this.models=Ze,this.groupedModels={},this.isLoading=!1,this.groupedModels=this.models.reduce((t,m)=>((t[m.provider]=t[m.provider]||[]).push(m),t),{})}ngOnInit(){this.getAiPromtTemplateSettings(),this.createAiPromptTemplateForm()}createAiPromptTemplateForm(){this.aiPromtForm=this.fb.group({aIPromptTemplateId:[],promptInput:["",[y.required,ot("**")]],language:["en-US"],maximumLength:[1e3],creativity:["0.25"],keywords:this.fb.array([]),toneOfVoice:["Professional"],selectedModel:["gpt-3.5-turbo"]})}getAiPromtTemplateSettings(){this.aIPromptTemplateService.getAIPromptTemplates().subscribe({next:t=>{this.aiPromptTemplates=t},error:t=>{}})}onAiPromptTemplateChange(t){if(t.value&&(this.selectedAiPromptTemplate=this.aiPromptTemplates.find(m=>m.id===t.value),this.selectedAiPromptTemplate)){this.patchAiPromptTemplateData(this.selectedAiPromptTemplate),this.keywords.clear();let m=this.findSpecialKeywords(this.selectedAiPromptTemplate.promptInput);m.length>0&&this.addKeyword(m)}}findSpecialKeywords(t){let m=/\*\*(.*?)\*\*/g,a=[],s;for(;(s=m.exec(t))!==null;)a.push(s[1]);return a}addKeyword(t){for(let m of t){let a=this.fb.group({keyword:[m],keywordValue:[""]});this.keywords.push(a)}}onInputChange(t,m){this.replaceArrayKeywordValue()}replaceArrayKeywordValue(){let t=this.selectedAiPromptTemplate?.promptInput??"";for(let m=0;m<this.keywords.length;m++){let a=this.keywords.at(m).get("keywordValue")?.value;if(a){let s=this.keywords.at(m).get("keyword")?.value;t=t?.replace(`**${s}**`,a)}}t&&this.aiPromtForm.patchValue({promptInput:t})}patchAiPromptTemplateData(t){this.aiPromtForm.patchValue({aIPromptTemplateId:t?.id,promptInput:t?.promptInput})}buildUserAIPromptTemplate(){return{title:this.getTitle(),promptInput:this.aiPromtForm.get("promptInput")?.value,language:this.aiPromtForm.get("language")?.value,maximumLength:this.aiPromtForm.get("maximumLength")?.value,creativity:this.aiPromtForm.get("creativity")?.value,toneOfVoice:this.aiPromtForm.get("toneOfVoice")?.value,selectedModel:this.aiPromtForm.get("selectedModel")?.value}}getTitle(){let t=this.aiPromtForm.get("aIPromptTemplateId")?.value;return t&&this.aiPromptTemplates.find(a=>a.id===t)?.name||""}generate(){if(this.aiPromtForm.valid){let t=this.buildUserAIPromptTemplate();this.generateHandler.emit(t)}else this.aiPromtForm.markAllAsTouched()}static{this.\u0275fac=function(m){return new(m||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-ai-document-generator-form"]],inputs:{isLoading:"isLoading"},outputs:{generateHandler:"generateHandler"},standalone:!0,features:[F],decls:189,vars:50,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"body"],[3,"formGroup"],[1,"col-sm-12"],[1,"form-group"],["panelClass","mat-select-control","formControlName","aIPromptTemplateId",1,"form-control",3,"selectionChange","placeholder"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["class","","formArrayName","keywords",4,"ngFor","ngForOf"],[1,"text-danger"],["formControlName","promptInput","rows","6",1,"form-control","form-control-sm"],[4,"ngIf"],[1,"col-sm-6"],["panelClass","mat-select-control","formControlName","language",1,"form-control",3,"placeholder"],["value","az-AZ"],["value","ar-AE"],["value","cmn-CN"],["value","hr-HR"],["value","cs-CZ"],["value","da-DK"],["value","nl-NL"],["value","en-US"],["value","en-GB"],["value","et-EE"],["value","fi-FI"],["value","fr-FR"],["value","de-DE"],["value","el-GR"],["value","he-IL"],["value","hi-IN"],["value","hu-HU"],["value","is-IS"],["value","id-ID"],["value","it-IT"],["value","ja-JP"],["value","kk-KZ"],["value","ko-KR"],["value","lt-LT"],["value","ms-MY"],["value","nb-NO"],["value","fa_IR"],["value","pl-PL"],["value","pt-BR"],["value","pt-PT"],["value","ro-RO"],["value","ru-RU"],["value","sk-SK"],["value","sl-SI"],["value","es-ES"],["value","es-MX"],["value","sw-KE"],["value","sv-SE"],["value","tr-TR"],["value","th-TH"],["value","vi-VN"],["formControlName","maximumLength","type","number",1,"form-control","form-control-sm"],["panelClass","mat-select-control","formControlName","creativity",1,"form-control",3,"placeholder"],["value","0.25"],["value","0.5"],["value","0.75"],["value","1"],["panelClass","mat-select-control","formControlName","toneOfVoice",1,"form-control",3,"placeholder"],["value","Professional","selected",""],["value","Funny"],["value","Casual"],["value","Excited"],["value","Witty"],["value","Sarcastic"],["value","Feminine"],["value","Masculine"],["value","Bold"],["value","Dramatic"],["value","Grumpy"],["value","Secretive"],["value","other"],["panelClass","mat-select-control","formControlName","selectedModel",1,"form-control"],[4,"ngFor","ngForOf"],[1,"mt-2","col-md-12"],["cdkFocusInitial","",1,"btn","btn-success","btn-sm","me-2",3,"click","disabled"],["name","save",1,"small-icon"],["formArrayName","keywords",1,""],[3,"formGroupName"],["formControlName","keywordValue",1,"form-control","form-control-sm",3,"input"],["class","text-danger",4,"ngIf"],[3,"label"]],template:function(m,a){if(m&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4)(5,"div",0)(6,"div",5)(7,"div",6)(8,"label"),n(9),p(10,"translate"),e(),i(11,"mat-select",7),p(12,"translate"),_("selectionChange",function(g){return a.onAiPromptTemplateChange(g)}),i(13,"mat-option",8),n(14),p(15,"translate"),e(),v(16,Ft,2,2,"mat-option",9),e()()()(),i(17,"div",0)(18,"div",5),v(19,Mt,7,4,"div",10),e()(),i(20,"div",0)(21,"div",5)(22,"div",6)(23,"label",11),n(24),p(25,"translate"),i(26,"span",11),n(27),p(28,"translate"),e()(),S(29,"textarea",12),v(30,Pt,2,1,"div",13)(31,wt,2,1,"div",13),e()()(),i(32,"div",0)(33,"div",14)(34,"div",6)(35,"label"),n(36),p(37,"translate"),e(),i(38,"mat-select",15),p(39,"translate"),i(40,"mat-option",16),n(41,"Azerbaijani (Azerbaijan)"),e(),i(42,"mat-option",17),n(43,"Arabic"),e(),i(44,"mat-option",18),n(45,"Chinese (Mandarin)"),e(),i(46,"mat-option",19),n(47,"Croatian (Croatia)"),e(),i(48,"mat-option",20),n(49,"Czech (Czech Republic)"),e(),i(50,"mat-option",21),n(51,"Danish (Denmark)"),e(),i(52,"mat-option",22),n(53,"Dutch (Netherlands)"),e(),i(54,"mat-option",23),n(55,"English (USA)"),e(),i(56,"mat-option",24),n(57,"English (UK)"),e(),i(58,"mat-option",25),n(59,"Estonian (Estonia)"),e(),i(60,"mat-option",26),n(61,"Finnish (Finland)"),e(),i(62,"mat-option",27),n(63,"French (France)"),e(),i(64,"mat-option",28),n(65,"German (Germany)"),e(),i(66,"mat-option",29),n(67,"Greek (Greece)"),e(),i(68,"mat-option",30),n(69,"Hebrew (Israel)"),e(),i(70,"mat-option",31),n(71,"Hindi (India)"),e(),i(72,"mat-option",32),n(73,"Hungarian (Hungary)"),e(),i(74,"mat-option",33),n(75,"Icelandic (Iceland)"),e(),i(76,"mat-option",34),n(77,"Indonesian (Indonesia)"),e(),i(78,"mat-option",35),n(79,"Italian (Italy)"),e(),i(80,"mat-option",36),n(81,"Japanese (Japan)"),e(),i(82,"mat-option",37),n(83,"Kazakh (Kazakhistan)"),e(),i(84,"mat-option",38),n(85,"Korean (South Korea)"),e(),i(86,"mat-option",39),n(87,"Lithuanian (Lithuania)"),e(),i(88,"mat-option",40),n(89,"Malay (Malaysia)"),e(),i(90,"mat-option",41),n(91,"Norwegian (Norway)"),e(),i(92,"mat-option",42),n(93,"Persian"),e(),i(94,"mat-option",43),n(95,"Polish (Poland)"),e(),i(96,"mat-option",44),n(97,"Portuguese (Brazil)"),e(),i(98,"mat-option",45),n(99,"Portuguese (Portugal)"),e(),i(100,"mat-option",46),n(101,"Romanian (Romania)"),e(),i(102,"mat-option",47),n(103,"Russian (Russia)"),e(),i(104,"mat-option",48),n(105,"Slovak (Slovakia)"),e(),i(106,"mat-option",49),n(107,"Slovenian (Slovenia)"),e(),i(108,"mat-option",50),n(109,"Spanish (Spain)"),e(),i(110,"mat-option",51),n(111,"Spanish (Mexico)"),e(),i(112,"mat-option",52),n(113,"Swahili (Kenya)"),e(),i(114,"mat-option",53),n(115,"Swedish (Sweden)"),e(),i(116,"mat-option",54),n(117,"Turkish (Turkey)"),e(),i(118,"mat-option",55),n(119,"Thai (Thailand)"),e(),i(120,"mat-option",56),n(121,"Vietnamese (Vietnam)"),e()()()(),i(122,"div",14)(123,"div",6)(124,"label"),n(125),p(126,"translate"),e(),S(127,"input",57),e()()(),i(128,"div",0)(129,"div",14)(130,"label"),n(131),p(132,"translate"),e(),i(133,"mat-select",58),p(134,"translate"),i(135,"mat-option",59),n(136," Economic "),e(),i(137,"mat-option",60),n(138," Average "),e(),i(139,"mat-option",61),n(140," Good "),e(),i(141,"mat-option",62),n(142," Premium "),e()()(),i(143,"div",14)(144,"label"),n(145),p(146,"translate"),e(),i(147,"mat-select",63),p(148,"translate"),i(149,"mat-option",64),n(150," Professional "),e(),i(151,"mat-option",65),n(152," Funny "),e(),i(153,"mat-option",66),n(154," Casual "),e(),i(155,"mat-option",67),n(156," Excited "),e(),i(157,"mat-option",68),n(158," Witty "),e(),i(159,"mat-option",69),n(160," Sarcastic "),e(),i(161,"mat-option",70),n(162," Feminine "),e(),i(163,"mat-option",71),n(164," Masculine "),e(),i(165,"mat-option",72),n(166," Bold "),e(),i(167,"mat-option",73),n(168," Dramatic "),e(),i(169,"mat-option",74),n(170," Grumpy "),e(),i(171,"mat-option",75),n(172," Secretive "),e(),i(173,"mat-option",76),n(174," other "),e()()()(),i(175,"div",0)(176,"div",5)(177,"div",6)(178,"label"),n(179),p(180,"translate"),e(),i(181,"mat-select",77),v(182,Rt,3,2,"ng-container",78),e()()()(),i(183,"div",0)(184,"div",79)(185,"button",80),_("click",function(){return a.generate()}),S(186,"i-feather",81),n(187),p(188,"translate"),e()()()()()()()()),m&2){let s;r(4),l("formGroup",a.aiPromtForm),r(5),u(" ",c(10,22,"SELECT_AI_PROMPT_TEMPLATE")," "),r(2),T("placeholder",c(12,24,"SELECT_AI_PROMPT_TEMPLATE")),r(3),u("-- ",c(15,26,"NONE")," --"),r(2),l("ngForOf",a.aiPromptTemplates),r(3),l("ngForOf",a.keywords.controls),r(5),u(" ",c(25,28,"PROMPT_INPUT")," * "),r(3),u(" ",c(28,30,"REPLACE_WORD")," "),r(3),l("ngIf",((s=a.aiPromtForm.get("promptInput"))==null?null:s.dirty)&&a.aiPromtForm.get("promptInput").touched),r(),l("ngIf",a.aiPromtForm.get("promptInput").touched),r(5),u(" ",c(37,32,"AI_LANGUAGE")," "),r(2),fe("placeholder"," ",c(39,34,"SELECT_LANGUAGE"),""),r(87),u(" ",c(126,36,"MAXIMUM_LENGTH")," "),r(6),u(" ",c(132,38,"CREATIVITY")," "),r(2),T("placeholder",c(134,40,"CREATIVITY")),r(12),u(" ",c(146,42,"TONE_OF_VOICE")," "),r(2),T("placeholder",c(148,44,"TONE_OF_VOICE")),r(32),u(" ",c(180,46,"SELECT_MODEL")," "),r(3),l("ngForOf",a.providers),r(3),l("disabled",a.isLoading),r(2),u(" ",c(188,48,"GENERATE")," ")}},dependencies:[qe,Ye,Te,xe,oe,V,w,Z,De,P,O,k,R,X,ee,te,K,ie,W,N,q,M,_e,Q,j,U,B]})}}return o})();function Gt(o,d){o&1&&(i(0,"div",28),n(1),p(2,"translate"),e()),o&2&&(r(),u(" ",c(2,1,"DESCRIPTION_IS_REQUIRED")," "))}function Vt(o,d){if(o&1&&(i(0,"div"),v(1,Gt,3,3,"div",27),e()),o&2){let t=h();r(),l("ngIf",t.aiEditorForm.get("editorData").hasError("required"))}}function Lt(o,d){o&1&&(i(0,"div",29)(1,"div",30)(2,"span",31),n(3,"Loading..."),e()()())}var ln=(()=>{class o{constructor(){this.editor=rt.default,this.fb=f(G),this.http=f(Se),this.toastrService=f(L),this.translationService=f(H),this.sanitizer=f(Ee),this.dialog=f(J),this.openAIStreamService=f(Qe),this.licenseValidatorService=f(Oe),this.isLoading=!1,this.buffer=""}ngOnInit(){this.createAiEditorForm()}createAiEditorForm(){this.aiEditorForm=this.fb.group({editorData:["",[y.required]]})}onReady(t){t.plugins.get("FileRepository").createUploadAdapter=m=>new pe(m,this.http,this.toastrService,this.translationService)}generateAiDocument(t){this.buffer="",this.isLoading=!0;let m=this.licenseValidatorService.getBearerToken();fetch(`${Me.apiUrl}api/ai/stream-document`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${m}`},body:JSON.stringify(t)}).then(a=>ce(this,null,function*(){if(!a.ok){this.isLoading=!1;let I=JSON.parse(yield a.text())?.message;this.toastrService.error(I);return}let s=a.body?.getReader(),g=new TextDecoder("utf-8");for(;;){let{done:I,value:me}=yield s.read();if(I)break;let le=g.decode(me,{stream:!0});this.appendStreamedText(le)}})).catch(a=>{this.isLoading=!1,this.toastrService.error(this.translationService.getValue("ERROR_WHILE_GENERATING_DOCUMENT"))})}appendStreamedText(t){let m=t.split(`
`).filter(a=>a.startsWith("data: "));for(let a of m){let s=a.replace("data: ","");try{let g=JSON.parse(s);if(g.text==="##[[DONE]]##"){this.buffer="",this.isLoading=!1;return}let I=this.addChunk(g.text);this.aiEditorForm.patchValue({editorData:I})}catch{this.isLoading=!1}}}addChunk(t){let m=de.parse(this.buffer);return this.buffer+=t,this.buffer.trim()&&(m=de.parse(this.buffer)),m}saveDocument(){this.aiEditorForm.valid?this.openAddDocumentDialog():this.aiEditorForm.markAllAsTouched()}openAddDocumentDialog(){let m=window.innerWidth<768?"90vw":"60vw";this.dialog.open(nt,{maxWidth:m,data:Object.assign({},{html_content:this.aiEditorForm.get("editorData")?.value})}).afterClosed().subscribe(s=>{s===!0&&this.aiEditorForm.patchValue({editorData:""})})}static{this.\u0275fac=function(m){return new(m||o)}}static{this.\u0275cmp=D({type:o,selectors:[["app-ai-document-generator"]],standalone:!0,features:[F],decls:35,vars:16,consts:[[1,"content"],[1,"container-fluid"],[1,"row","align-items-center"],[1,"col-md-6","col","mb-2"],[1,"mb-0","page-title"],[3,"code"],[1,"card"],[1,"body"],[1,"row"],[1,"col-md-5"],[3,"generateHandler","isLoading"],[1,"col-md-7"],[3,"formGroup"],[1,"col-md-12"],[1,"form-group"],[1,"font-weight-bold"],[1,"NgxEditor__Wrapper"],["formControlName","editorData",3,"ready","editor"],[4,"ngIf"],[1,"m-top-10","col-md-12"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[2,"position","absolute","left","-15420px"],[2,"width","100%","display","flex"],["id","pdfDocument"],[1,"container",2,"width","95%","margin-right","auto","margin-left","auto"],[3,"innerHTML"],["class","spinner-container",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"spinner-container"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(m,a){m&1&&(i(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),n(5),p(6,"translate"),e(),S(7,"app-page-help-text",5),e()(),i(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"app-ai-document-generator-form",10),_("generateHandler",function(g){return a.generateAiDocument(g)}),e()(),i(13,"div",11)(14,"form",12)(15,"div",8)(16,"div",13)(17,"div",14)(18,"label",15),n(19),p(20,"translate"),e(),i(21,"div",16)(22,"ckeditor",17),_("ready",function(g){return a.onReady(g)}),e()(),v(23,Vt,2,1,"div",18),e()()(),i(24,"div",8)(25,"div",19)(26,"button",20),_("click",function(){return a.saveDocument()}),n(27),p(28,"translate"),e()()(),i(29,"div",21)(30,"div",22)(31,"div",23)(32,"div",24),S(33,"div",25),e()()()()()()()()()(),v(34,Lt,4,0,"div",26),e()),m&2&&(r(5),E(c(6,10,"AI_DOCUMENT_GENERATOR")),r(2),l("code","AI_DOCUMENT_GENERATOR"),r(5),l("isLoading",a.isLoading),r(2),l("formGroup",a.aiEditorForm),r(5),u(" ",c(20,12,"DOCUMENT_SUMMARY")," "),r(3),l("editor",a.editor),r(),l("ngIf",a.aiEditorForm.get("editorData").touched&&a.aiEditorForm.get("editorData").errors),r(4),u(" ",c(28,14,"SAVE_AS_PDF")," "),r(6),T("innerHTML",a.aiEditorForm.get("editorData").value,ue),r(),l("ngIf",a.isLoading))},dependencies:[Q,j,U,Je,N,M,te,w,P,O,W,K,re,k,R,ae,Le,Ve,V,B,at],styles:[".ck-editor__editable_inline{min-height:60vh;max-height:60vh;overflow-y:auto}.spinner-container[_ngcontent-%COMP%]{position:absolute;inset:0 0 56px;z-index:1001;display:flex;align-items:center;justify-content:center;color:#6777ef!important}"]})}}return o})(),pe=class{constructor(d,t,m,a){this.loader=d,this.http=t,this.toastrService=m,this.translationService=a}upload(){return this.loader.file.then(d=>new Promise((t,m)=>{this.convertToBase64(d).then(a=>{t({default:a})}).catch(a=>{this.toastrService.error(this.translationService.getValue("ERROR_WHILE_UPLOADING_IMAGE")),m()})}))}convertToBase64(d){return new Promise((t,m)=>{let a=new FileReader;a.readAsDataURL(d),a.onload=()=>t(a.result),a.onerror=s=>m(s)})}};export{ln as AiDocumentGeneratorComponent};
